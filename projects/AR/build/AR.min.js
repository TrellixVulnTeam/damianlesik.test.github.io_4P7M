(function(C){function t(R){if(e[R])return e[R].exports;var V=e[R]={i:R,l:!1,exports:{}};C[R].call(V.exports,V,V.exports,t);V.l=!0;return V.exports}var e={};t.m=C;t.c=e;t.d=function(e,V,n){t.o(e,V)||Object.defineProperty(e,V,{configurable:!1,enumerable:!0,get:n})};t.n=function(e){var R=e&&e.__esModule?function(){return e["default"]}:function(){return e};t.d(R,"a",R);return R};t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};t.p="";return t(t.s=84)})([function(C,t,e){var R=e(32),
V={};t.a=function(e,y,d){function k(){return function(d){d=d||"__b4w_default";if(void 0!==n[d])return n[d];n[d]=A?{}:k();y(d,n[d]);return n[d]}}var n={},A="__"==e.split("").slice(0,2).join("");if(void 0!==V[e])return V[e];d=A?k():k()();return R.a._n_module[e]=V[e]=d}},function(C,t,e){function R(e,n){function y(a,d){var l=[];-1<a[0].indexOf("%c")?l.push(a[0].replace("%c","%c"+d+": ")):l.push(d+": "+a[0]);for(var c=1;c<a.length;c++)l.push(a[c]);return l}function d(){r++;var a=y(arguments,"B4W ERROR");
console.error.apply(console,a)}function k(a){a in u||(u[a]=a,d([a]))}function I(a,d){k(a+"() is deprecated, use "+d+"() instead.")}var A=!1,r=0,p=0,u={};n.set_verbose=function(a){A=a};n.log_raw=function(){console.log.apply(console,arguments)};n.log=function(){if(A){var a=y(arguments,"B4W LOG");console.log.apply(console,a)}};n.compose_args_prefix=y;n.error=d;n.error_once=k;n.error_deprecated=I;n.error_deprecated_arr=function(a,d){switch(1<d.length){case !0:k(a+"() is deprecated, use "+d.slice(0,-1).join("(), ")+
"() or "+d[d.length-1]+"() instead.");break;case !1:I(a,d[0])}};n.error_deprecated_cfg=function(a,d){void 0===d?k('Config option "'+a+'" is deprecated.'):k('Config option "'+a+'" is deprecated, use "'+d+'" instead.')};n.warn=function(){p++;var a=y(arguments,"B4W WARN");console.warn.apply(console,a)};n.info=function(){var a=y(arguments,"B4W INFO");console.info.apply(console,a)};n.export_error=function(){r++;var a=y(arguments,"B4W EXPORT ERROR");console.error.apply(console,a)};n.export_warn=function(){p++;
var a=y(arguments,"B4W EXPORT WARNING");console.warn.apply(console,a)};n.time=function(){A&&console.time.apply(console,arguments)};n.timeEnd=function(){A&&console.timeEnd.apply(console,arguments)};n.group=function(){console.group.apply(console,arguments)};n.groupCollapsed=function(){console.groupCollapsed.apply(console,arguments)};n.groupEnd=function(){console.groupEnd.apply(console,arguments)};n.clear=function(){"function"==typeof console.clear&&console.clear.apply(console,arguments)};n.get_warning_count=
function(){return p};n.get_error_count=function(){return r};n.clear_errors_warnings=function(){r=p=0}}C=e(0);e=Object(C.a)("print",R);Object(C.a)("__print",R);t.a=e},function(C,t,e){function R(g){return 0<g?1:0>g?-1:0}function V(g,b,h){var c=g[0],f=g[1];g=g[2];var a=Math.cos(c/2),l=Math.cos(f/2),d=Math.cos(g/2),m=Math.sin(c/2),f=Math.sin(f/2),v=Math.sin(g/2);if(-1<na.indexOf(b))var w=Math.cos((c+g)/2),q=Math.sin((c+g)/2),D=Math.cos((c-g)/2),z=Math.sin((c-g)/2),k=Math.cos((g-c)/2),L=Math.sin((g-c)/
2);switch(b){case ta:h[0]=l*q;h[1]=f*D;h[2]=f*z;h[3]=l*w;break;case X:h[0]=f*z;h[1]=l*q;h[2]=f*D;h[3]=l*w;break;case pa:h[0]=f*D;h[1]=f*z;h[2]=l*q;h[3]=l*w;break;case ka:h[0]=l*q;h[1]=f*L;h[2]=f*k;h[3]=l*w;break;case Ca:h[0]=f*k;h[1]=l*q;h[2]=f*L;h[3]=l*w;break;case Ma:h[0]=f*L;h[1]=f*k;h[2]=l*q;h[3]=l*w;break;case Aa:h[0]=m*l*d+a*f*v;h[1]=a*f*d-m*l*v;h[2]=a*l*v+m*f*d;h[3]=a*l*d-m*f*v;break;case xa:h[0]=a*l*v+m*f*d;h[1]=m*l*d+a*f*v;h[2]=a*f*d-m*l*v;h[3]=a*l*d-m*f*v;break;case ga:h[0]=a*f*d-m*l*v;
h[1]=a*l*v+m*f*d;h[2]=m*l*d+a*f*v;h[3]=a*l*d-m*f*v;break;case ya:h[0]=m*l*d-a*f*v;h[1]=a*l*v-m*f*d;h[2]=a*f*d+m*l*v;h[3]=a*l*d+m*f*v;break;case O:h[0]=a*f*d+m*l*v;h[1]=m*l*d-a*f*v;h[2]=a*l*v-m*f*d;h[3]=a*l*d+m*f*v;break;case wa:h[0]=a*l*v-m*f*d,h[1]=a*f*d+m*l*v,h[2]=m*l*d-a*f*v,h[3]=a*l*d+m*f*v}return h}function n(g,h,b){var c=g[0],f=g[1],a=g[2];g=g[3];switch(h){case ta:b[0]=Math.atan2(c*f+a*g,f*g-c*a);b[1]=Math.acos(1-2*(f*f+a*a));b[2]=Math.atan2(c*f-a*g,c*a+f*g);break;case X:b[0]=Math.atan2(c*g+
f*a,a*g-c*f);b[1]=Math.acos(1-2*(c*c+a*a));b[2]=Math.atan2(f*a-c*g,c*f+a*g);break;case pa:b[0]=Math.atan2(c*a+f*g,c*g-f*a);b[1]=Math.acos(1-2*(c*c+f*f));b[2]=Math.atan2(c*a-f*g,c*g+f*a);break;case ka:b[0]=Math.atan2(c*a-f*g,c*f+a*g);b[1]=Math.acos(1-2*(f*f+a*a));b[2]=Math.atan2(c*a+f*g,a*g-c*f);break;case Ca:b[0]=Math.atan2(c*f-a*g,c*g+f*a);b[1]=Math.acos(1-2*(c*c+a*a));b[2]=Math.atan2(c*f+a*g,c*g-f*a);break;case Ma:b[0]=Math.atan2(f*a-c*g,c*a+f*g);b[1]=Math.acos(1-2*(c*c+f*f));b[2]=Math.atan2(c*
g+f*a,f*g-c*a);break;case Aa:b[0]=Math.atan2(2*(c*g-f*a),1-2*(c*c+f*f));b[1]=Math.asin(2*(c*a+f*g));b[2]=Math.atan2(2*(a*g-c*f),1-2*(f*f+a*a));break;case xa:h=c*f+a*g;.499999<h?(b[0]=0,b[1]=Math.PI/2,b[2]=2*Math.atan2(c,g)):-.499999>h?(b[0]=0,b[1]=-Math.PI/2,b[2]=-2*Math.atan2(c,g)):(b[0]=Math.atan2(2*(f*g-c*a),1-2*(f*f+a*a)),b[1]=Math.asin(2*(c*f+a*g)),b[2]=Math.atan2(2*(c*g-f*a),1-2*(c*c+a*a)));break;case ga:b[0]=Math.atan2(2*(a*g-c*f),1-2*(c*c+a*a));b[1]=Math.asin(2*(c*g+f*a));b[2]=Math.atan2(2*
(f*g-c*a),1-2*(c*c+f*f));break;case ya:b[0]=Math.atan2(2*(c*g+f*a),1-2*(c*c+a*a));b[1]=Math.asin(2*(a*g-c*f));b[2]=Math.atan2(2*(c*a+f*g),1-2*(f*f+a*a));break;case O:b[0]=Math.atan2(2*(c*a+f*g),1-2*(c*c+f*f));b[1]=Math.asin(2*(c*g-f*a));b[2]=Math.atan2(2*(c*f+a*g),1-2*(c*c+a*a));break;case wa:h=f*g-c*a,.499999<h?(b[0]=0,b[1]=Math.PI/2,b[2]=-2*Math.atan2(a,g)):-.499999>h?(b[0]=0,b[1]=-Math.PI/2,b[2]=2*Math.atan2(a,g)):(b[0]=Math.atan2(2*(c*f+a*g),1-2*(f*f+a*a)),b[1]=Math.asin(2*(f*g-c*a)),b[2]=Math.atan2(2*
(c*g+f*a),1-2*(c*c+f*f)))}return b}function y(g,b){var h=Math.cos(g[0]),c=Math.cos(g[1]),f=Math.cos(g[2]),a=Math.sin(g[0]),l=Math.sin(g[1]),d=Math.sin(g[2]),m=h*f,v=h*d,w=a*f,q=a*d;b[0]=c*f;b[1]=c*d;b[2]=-l;b[3]=l*w-v;b[4]=l*q+m;b[5]=c*a;b[6]=l*m+q;b[7]=l*v-w;b[8]=c*h;return b}function d(g,b,h){h||(h=new Float32Array(3));M.transformQuat(b,g,h);return h}function k(g){if(!(g instanceof Object))return g;var b;b=g.constructor;switch(b){case Int8Array:case Uint8Array:case Uint8ClampedArray:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:b=
new b(g);break;case Array:b=new b(g.length);for(var h=0;h<g.length;h++)b[h]=k(g[h]);break;default:for(h in b=new b,g)g.hasOwnProperty(h)&&(b[h]=k(g[h]))}return b}function I(g){var b=g[0],h=g[1],c=g[2],f=g[3],a=Math.sqrt(b*b+h*h+c*c),a=1/a;g[0]=b*a;g[1]=h*a;g[2]=c*a;g[3]=f*a}function A(g,b,h,c){if(c<h)return h;var f=h+Math.floor((c-h)/2);return g[f]>b?A(g,b,h,f-1):g[f]<b?A(g,b,f+1,c):f}function r(g){return(34*g+1)*g%289}function p(g){return g-Math.floor(g)}function u(g){return a((34*g+5)*g)}function a(g){return g-
289*Math.floor(g/289)}function B(g){return g-7*Math.floor(g/7)}function l(g,b,h){g<b&&(g=b);g>h&&(g=h);return g}function c(g,b,h){g-=b;h-=b;return b+(g-Math.floor(g/h)*h)}function m(g){return c(g,0,2*Math.PI)}function b(g,b){if(g&&b){var h=g instanceof Array;if(h!=b instanceof Array)return!1;var c=g.buffer instanceof ArrayBuffer&&"undefined"!==g.byteLength;if(c!=(b.buffer instanceof ArrayBuffer&&"undefined"!==b.byteLength))return!1;if(h){if(g.length!=b.length)return!1;for(h=0;h<g.length;h++)if(!f(g[h],
b[h]))return!1}else if(c){if(g.length!=b.length)return!1;for(h=0;h<g.length;h++)if(g[h]!=b[h])return!1}else{switch(g.constructor){case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLRenderbuffer:case WebGLTexture:case WebGLBuffer:return g==b}for(var a in g)if(!f(g[a],b[a]))return!1;for(a in b)if(!(a in g))return!1}return!0}return!(g||b)}function f(g,h){if(typeof g!=typeof h)return!1;switch(typeof g){case "number":case "string":case "boolean":return g==h;case "object":return b(g,
h);default:return!0}}function T(g,b,h){var c=U,f=M.dot(g,b);-.9999999>f?(M.cross(da,g,c),1E-6>M.length(c)&&M.cross(ja,g,c),M.normalize(c,c),J.setAxisAngle(c,Math.PI,h)):(M.cross(g,b,c),h.set(c),h[3]=1+f,J.normalize(h,h));return h}function fa(g,b,h){var c=Math.sqrt(g[0]*g[0]+g[1]*g[1]);1E-6<c?(b[0]=Math.atan2(g[5],g[8]),b[1]=Math.atan2(-g[2],c),b[2]=Math.atan2(g[1],g[0]),h[0]=Math.atan2(-g[5],-g[8]),h[1]=Math.atan2(-g[2],-c),h[2]=Math.atan2(-g[1],-g[0])):(b[0]=Math.atan2(-g[7],g[4]),b[1]=Math.atan2(-g[2],
c),b[2]=0,M.copy(b,h))}e.d(t,"m",function(){return P});e.d(t,"k",function(){return oa});e.d(t,"n",function(){return Q});e.d(t,"d",function(){return da});e.d(t,"e",function(){return ja});e.d(t,"f",function(){return va});e.d(t,"a",function(){return Ga});e.d(t,"b",function(){return ba});e.d(t,"c",function(){return Ea});e.d(t,"o",function(){return ta});e.d(t,"v",function(){return X});e.d(t,"x",function(){return pa});e.d(t,"q",function(){return ka});e.d(t,"s",function(){return Ca});e.d(t,"z",function(){return Ma});
e.d(t,"p",function(){return Aa});e.d(t,"u",function(){return xa});e.d(t,"w",function(){return ga});e.d(t,"r",function(){return ya});e.d(t,"t",function(){return O});e.d(t,"y",function(){return wa});t._15=function(g){return qa.test(Object.prototype.toString.call(g))};e.d(t,"j",function(){return ma});e.d(t,"g",function(){return fb});e.d(t,"l",function(){return La});e.d(t,"h",function(){return Xa});e.d(t,"i",function(){return Wa});t._17=function(g){return"undefined"!=typeof g};t._18=function(g,b,h){for(var c=
[],f=h.length,a=0;a<f;a++){var l=h[a];l[g]==b&&c.push(l)}return c};t._1=function(g){return new Float32Array(g)};t._2=function(g,b){var h=g.length,c=new Float32Array(h+b.length);c.set(g);c.set(b,h);return c};t._67=function(g,b){var h=g.length,c=new Uint32Array(h+b.length);c.set(g);c.set(b,h);return c};t.K=function(){var g=new Uint16Array([255]);return 255==(new DataView(g.buffer)).getUint16(0,!0)};t.D=function(g,b){var h=[],c={},f=b.length,a,l;for(a=0;a<f;a++)c[b[a]]=!0;f=g.length;for(a=0;a<f;a++)l=
g[a],l in c&&h.push(l);return h};t._50=R;t._19=function(g,b,h){for(var c=0;c<h.length;c++){var f=h[c];if(f[g]===b)return f}return null};t._9=function(g,b,h){for(var c=0;c<g.length;c++)if(g[c][b]==h)return c;return-1};t.C=function(g,b){for(var h=0;h<g.length;h++)if(g[h]==b)return;g.push(b)};t._60=function(g,b,h,c){c||(c=new Float32Array(16));G.identity(c);c[12]=g;c[13]=b;c[14]=h;return c};t._40=function(b){var h=b[0]%Ta*g-Ba*Math.floor(b[0]/Ta);b[0]=0<h?h:h+Da;return(b[0]-1)/(Da-1)};t._13=function(g,
b){b||(b=[]);b[0]=Ja+Math.floor(g);return b};t.Y=function(g,b){var h=U;h[0]=g[2];h[1]=g[1];h[2]=g[0];V(h,wa,b);return b};t._27=V;t._37=n;t.Z=y;t._36=function(g,b){var h=n(g,wa,U);b[0]=h[2];b[1]=h[1];b[2]=h[0];return b};t._34=d;t.U=function(g,b,h){h||(h=new Float32Array(4));g=M.normalize(g,U);var c=M.dot(b,g);g=M.cross(b,g,K);c=Math.acos(c);h[0]=g[0]*Math.sin(c/2);h[1]=g[1]*Math.sin(c/2);h[2]=g[2]*Math.sin(c/2);h[3]=Math.cos(c/2);return h};t._61=function(g,b,h,c){c||(c=new Float32Array(4));M.transformQuat(h,
b,c);c[3]=-M.dot(g,c);return c};t.G=function(g,b,h,c){if(0==h)return g;c=c||[];for(var f=0;f<g.length;f++)c[f]=(1-h)*g[f]+h*b[f];return c};t.O=k;t.N=function(g){var b=g instanceof Array?[]:{},h;for(h in g)if(g.hasOwnProperty(h))if(g[h]instanceof Object){var c=g[h].constructor;switch(c){case Int8Array:case Uint8Array:case Uint8ClampedArray:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:b[h]=new c(g[h]);break;case Array:b[h]=g[h].slice(0);break;
default:b[h]=g[h]}}else b[h]=g[h];return b};t._24=function(g,h){h||(h=new Float32Array(4));z.fromMat4(g,ea);var b=ea[0],c=ea[3],f=ea[6],a=ea[1],l=ea[4],d=ea[7],m=ea[2],v=ea[5],w=ea[8],b=Math.sqrt(b*b+c*c+f*f)||1,a=Math.sqrt(a*a+l*l+d*d)||1,m=Math.sqrt(m*m+v*v+w*w)||1;ea[0]/=b;ea[3]/=b;ea[6]/=b;ea[1]/=a;ea[4]/=a;ea[7]/=a;ea[2]/=m;ea[5]/=m;ea[8]/=m;J.fromMat3(ea,h);J.normalize(h,h);return h};t._26=function(g,h){h||(h=new Float32Array(3));h[0]=g[12];h[1]=g[13];h[2]=g[14];return h};t._25=function(g,h){q[0]=
.577350269189626;q[1]=.577350269189626;q[2]=.577350269189626;q[3]=0;F.transformMat4(q,g,q);var b=F.length(q);return h?M.set(b,b,b,h):b};t._0=function(g,h){var b=h.left,c=h.right,f=h.top,a=h.bottom,l=h.near,m=h.far;b[0]=g[3]+g[0];b[1]=g[7]+g[4];b[2]=g[11]+g[8];b[3]=g[15]+g[12];c[0]=g[3]-g[0];c[1]=g[7]-g[4];c[2]=g[11]-g[8];c[3]=g[15]-g[12];f[0]=g[3]-g[1];f[1]=g[7]-g[5];f[2]=g[11]-g[9];f[3]=g[15]-g[13];a[0]=g[3]+g[1];a[1]=g[7]+g[5];a[2]=g[11]+g[9];a[3]=g[15]+g[13];l[0]=g[3]+g[2];l[1]=g[7]+g[6];l[2]=
g[11]+g[10];l[3]=g[15]+g[14];m[0]=g[3]-g[2];m[1]=g[7]-g[6];m[2]=g[11]-g[10];m[3]=g[15]-g[14];I(b);I(c);I(f);I(a);I(l);I(m);return h};t._56=function(g,h,b){return b<-E.P(g,h.near)||b<-E.P(g,h.left)||b<-E.P(g,h.right)||b<-E.P(g,h.top)||b<-E.P(g,h.bottom)||b<-E.P(g,h.far)?!0:!1};t.X=function(g,h,b,c,f){var a=M.dot(b,h.far),l=M.dot(c,h.far),m=M.dot(f,h.far),a=Math.sqrt(a*a+l*l+m*m);if(a<-E.P(g,h.near)||a<-E.P(g,h.far))return!0;a=M.dot(b,h.left);l=M.dot(c,h.left);m=M.dot(f,h.left);if(Math.sqrt(a*a+l*l+
m*m)<-E.P(g,h.left))return!0;a=M.dot(b,h.right);l=M.dot(c,h.right);m=M.dot(f,h.right);if(Math.sqrt(a*a+l*l+m*m)<-E.P(g,h.right))return!0;a=M.dot(b,h.top);l=M.dot(c,h.top);m=M.dot(f,h.top);if(Math.sqrt(a*a+l*l+m*m)<-E.P(g,h.top))return!0;a=M.dot(b,h.bottom);l=M.dot(c,h.bottom);m=M.dot(f,h.bottom);return Math.sqrt(a*a+l*l+m*m)<-E.P(g,h.bottom)?!0:!1};t._28=function(g,h,b,c){c||(c=0);for(var f=g.length,a=0;a<f;a+=3){var l=g[a],m=g[a+1],d=g[a+2];b[c+a]=h[0]*l+h[4]*m+h[8]*d+h[12];b[c+a+1]=h[1]*l+h[5]*
m+h[9]*d+h[13];b[c+a+2]=h[2]*l+h[6]*m+h[10]*d+h[14]}return b};t._38=function(g,h,b,c){c=c||0;for(var a=g.length,f=ra,l=0;l<a;l+=4){f[0]=g[l];f[1]=g[l+1];f[2]=g[l+2];f[3]=g[l+3];var m=0<f[3];J.multiply(h,f,f);(m&&0>f[3]||!m&&0<f[3])&&F.scale(f,-1,f);b[c+l]=f[0];b[c+l+1]=f[1];b[c+l+2]=f[2];b[c+l+3]=f[3]}return b};t._68=function(g,h,b){b||(b=new Float32Array(3));var c=q;c[0]=g[0];c[1]=g[1];c[2]=g[2];c[3]=0;F.transformMat4(c,h,c);b[0]=c[0];b[1]=c[1];b[2]=c[2]};t._69=function(g,h){h||(h=[]);for(var b=
0;b<g.length;b+=3){var c=new Float32Array([g[b],g[b+1],g[b+2]]);h[b/3]=c}return h};t.F=A;t.P=function(g,h){for(var b=0;b<g.length;b++)if(g[b]!=h[b])return!1;return!0};t._63=function(g,b,c,f,a){a||(a=new Float32Array(3));c=G.fromRotationTranslation(c,f,h);1!==b&&(f=G.identity(ia),b=M.set(b,b,b,U),G.scale(f,b,f),G.multiply(c,f,c));M.transformMat4(g,c,a);return a};t._46=function(g,h,b,c){c||(c=new Float32Array(3));var f=U;M.subtract(h,g,f);M.transformQuat(f,b,f);M.subtract(h,f,c)};t._5=function(){var g=
U;g[0]=0;g[1]=0;g[2]=0;var h=new Float32Array(16),b=new Float32Array(16),c=new Float32Array(16),f=new Float32Array(16),a=new Float32Array(16),l=new Float32Array(16);G.lookAt(g,[-1,0,0],[0,-1,0],h);G.scale(h,[-1,1,1],h);G.scale(h,[-1,1,-1],b);G.lookAt(g,[0,-1,0],[0,0,-1],c);G.scale(c,[1,1,-1],c);G.scale(c,[1,-1,-1],f);G.lookAt(g,[0,0,-1],[0,-1,0],a);G.scale(a,[-1,1,1],a);G.scale(a,[-1,1,-1],l);return[h,b,c,f,a,l]};t._6=function(){var g=U;g[0]=0;g[1]=0;g[2]=0;var h=new Float32Array(16),b=new Float32Array(16),
c=new Float32Array(16),f=new Float32Array(16),a=new Float32Array(16),l=new Float32Array(16);G.lookAt(g,[1,0,0],[0,-1,0],h);G.scale(h,[-1,1,-1],b);G.lookAt(g,[0,1,0],[0,0,1],c);G.scale(c,[1,-1,-1],f);G.lookAt(g,[0,0,1],[0,-1,0],a);G.scale(a,[-1,1,-1],l);return[h,b,c,f,a,l]};t._11=function(g,h){for(var b=h,c=0;c<g.length;c++)var f=g.charCodeAt(c),b=(b<<5)-b+f,b=b&b;return b};t._23=function(g,h){h[15]=1;h[14]=0;h[13]=0;h[12]=0;h[11]=0;h[10]=g[8];h[9]=g[7];h[8]=g[6];h[7]=0;h[6]=g[5];h[5]=g[4];h[4]=g[3];
h[3]=0;h[2]=g[2];h[1]=g[1];h[0]=g[0];return h};t._33=function(g,h){h||(h=g);var b=g[0]*g[0]+g[1]*g[1]+g[2]*g[2];0<b?(h[3]=2*Math.acos(g[3]),b=1/Math.sqrt(b),h[0]=g[0]*b,h[1]=g[1]*b,h[2]=g[2]*b):(h[3]=0,h[0]=1,h[1]=0,h[2]=0);return h};t._64=function(g){return isNaN(g)||"undefined"==typeof g?NaN:g|0};t.T=function(g){return g*Math.PI/180};t._39=function(g){return 180*g/Math.PI};t._55=function(g){var h=.366025403784439*g[0]+.366025403784439*g[1],b=Math.floor(g[0]+h),c=Math.floor(g[1]+h),f=.211324865405187*
b+.211324865405187*c,h=g[0]-b+f;g=g[1]-c+f;var a=h>g?1:0,l=1-a,f=h+.211324865405187-a,m=g+.211324865405187-l,d=h+-.577350269189626,v=g+-.577350269189626,b=b%289,c=c%289,w=r(r(c)+b),l=r(r(c+l)+b+a),q=r(r(c+1)+b+1),b=Math.max(.5-(h*h+g*g),0),c=Math.max(.5-(f*f+m*m),0),a=Math.max(.5-(d*d+v*v),0),b=b*b*b*b,c=c*c*c*c,a=a*a*a*a,D=2*p(.024390243902439*w)-1,z=2*p(.024390243902439*l)-1,k=2*p(.024390243902439*q)-1,w=Math.abs(D)-.5,l=Math.abs(z)-.5,q=Math.abs(k)-.5,D=D-Math.floor(D+.5),z=z-Math.floor(z+.5),
k=k-Math.floor(k+.5);return 130*(b*(1.79284291400159-.85373472095314*(D*D+w*w))*(D*h+w*g)+c*(1.79284291400159-.85373472095314*(z*z+l*l))*(z*f+l*m)+a*(1.79284291400159-.85373472095314*(k*k+q*q))*(k*d+q*v))};t.J=function(g){var h=1/7,b=h/2,c=a(Math.floor(g[0])),f=a(Math.floor(g[1])),l=p(g[0]);g=p(g[1]);var m=l-.5,d=l-1.5,l=g-.5;g-=1.5;var v=u(c),c=u(c+1),w=v,q=c,v=u(v+f),c=u(c+f),w=u(w+f+1),q=u(q+f+1),D=B(v)*h+b,z=B(c)*h+b,k=B(w)*h+b,f=B(q)*h+b,v=B(Math.floor(v*h))*h+b,c=B(Math.floor(c*h))*h+b,w=B(Math.floor(w*
h))*h+b,h=B(Math.floor(q*h))*h+b,b=m+.7*D,z=d+.7*z,m=m+.7*k,d=d+.7*f,f=l+.7*v,l=l+.7*c,v=g+.7*w;g+=.7*h;return Math.min(b*b+f*f,z*z+l*l,m*m+v*v,d*d+g*g)};t._30=function(g,h,b,c,f){f||(f=new Float32Array(4));g=M.transformQuat(h,g,U);h=b[0];var a=b[1];b=b[2];var l=ea;l[0]=a*a+b*b;l[1]=-a*h;l[2]=-b*h;l[3]=-h*a;l[4]=h*h+b*b;l[5]=-b*a;l[6]=-h*b;l[7]=-a*b;l[8]=h*h+a*a;M.transformMat3(g,l,g);M.normalize(g,g);J.rotationTo(c,g,f);return f};t.I=function(g,h){h||(h=new Float32Array(4));var b,c;b=J.setAxisAngle([0,
0,1],Math.PI,J.create());c=J.setAxisAngle([1,0,0],Math.PI/2,J.create());J.multiply(b,c,b);J.multiply(g,b,h);return h};t.M=l;t._51=function(g,h,b,c){return c?(b=Math.exp(-b/c),(1-b)*g+b*h):g};t._54=function(g,h,b,c,f){f||(f=new Float32Array(g.length));if(c)for(b=Math.exp(-b/c),c=0;c<f.length;c++)f[c]=(1-b)*g[c]+b*h[c];else M.copy(g,f);return f};t._52=function(g,h,b,c,f){f||(f=new Float32Array(g.length));c?J.slerp(g,h,Math.exp(-b/c),f):J.copy(g,f);return f};t._14=function(g){return"object"===typeof g&&
g.buffer&&g.buffer instanceof ArrayBuffer?!0:!1};t._16=function(g,h){if(g instanceof Array||g.buffer&&g.buffer instanceof ArrayBuffer)if(h&&h==g.length||!h)return!0;return!1};t.R=function(g,h){var b=z.fromQuat(g,ea),c=U;c[0]=b[6];c[1]=b[7];c[2]=b[8];c=M.cross(va,c,c);M.normalize(c,c);var f=b[4];!h&&0<f&&(c[0]*=-1,c[1]*=-1,c[2]*=-1);f=K;f[0]=b[0];f[1]=b[1];f[2]=b[2];M.normalize(f,f);b=w;J.rotationTo(f,c,b);J.multiply(b,g,g)};t._7=function(g,h,b,c){b=b*h-.5;c=c*h-.5;var f=b-Math.floor(b),a=c-Math.floor(c);
b=Math.floor(b);c=Math.floor(c);var l=h-1;return(g[c*h+b]*(1-f)+g[c*h+Math.min(b+1,l)]*f)*(1-a)+(g[Math.min(c+1,l)*h+b]*(1-f)+g[Math.min(c+1,l)*h+Math.min(b+1,l)]*f)*a};t._43=function(g){for(var h=0,b=0;3>b;b++)0<(g&1<<b)&&h++;return h};t._44=function(g){for(var h=[0,0,0],b=0;3>b;b++)0<(g&1<<b)&&(h[2-b]=1);return h};t._42=function(g,h){var b=0;(1==h||2==h)&&0<(g&4)&&b++;2==h&&0<(g&2)&&b++;return b};t._4=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(g){var h=16*Math.random()|
0;return("x"==g?h:h&3|8).toString(16)})};t._8=function(g){var h=0,b;for(b in g)g.hasOwnProperty(b)&&h++;return h};t._41=function(g){return g.length?g[Math.floor(Math.random()*g.length)]:null};t._12=function(g,h,b){b||(b=new Float32Array(3));b[0]=g[0]-h[0];b[1]=g[1]-h[1];b[2]=0;M.normalize(b,b)};t._62=function(g,h,b){var c=g[0],f=g[1];g=g[2];var a=h[0],l=h[1],m=h[2];h=h[3];var d=l*g-m*f,v=m*c-a*g,w=a*f-l*c;b[0]=c+2*d*h+2*(l*w-m*v);b[1]=f+2*v*h+2*(m*d-a*w);b[2]=g+2*w*h+2*(a*v-l*d);return b};t.B=c;t.A=
m;t._59=function(g,h){for(var c in g){var f=!0,a=g[c],l=h[c];switch(typeof a){case "number":case "string":case "boolean":f=a==l;break;case "object":f=b(a,l)}if(!f)return!1}return!0};t._29=function(g,h){var b=g[0],c=g[2],f=g[3];h[0]=g[1];h[1]=c;h[2]=f;h[3]=b;return h};t._22=function(g,h,b,c){var f=q;f.set(g);f[3]=h;g=w;U[0]=b[3];U[1]=b[4];U[2]=b[5];g.set(U);g[3]=0;g=F.dot(f,g);if(0==g)return null;h=w;M.copy(b,U);h.set(U);h[3]=1;f=-F.dot(f,h)/g;c[0]=b[0]+f*b[3];c[1]=b[1]+f*b[4];c[2]=b[2]+f*b[5];return c};
t._10=function(g,h,b,c){var f=h[0]-g[0],a=b[0]-g[0],l=h[1]-g[1],m=b[1]-g[1];h=h[2]-g[2];g=b[2]-g[2];c[0]=l*g-h*m;c[1]=a*h-f*g;c[2]=f*m-l*a;return c};t._48=T;t.H=function(g,h,b){if(h==b)return b-g;g=m(g);h=m(h);b=m(b);h=2*Math.PI-h;b=m(b+h);g=m(g+h);return g>b?(b-=g,g=2*Math.PI-g,-b>g?g:b):0};t._53=function(g,h,b){isFinite(h)&&isFinite(b)&&(g=l(g,h,b));return g*g*(3-2*g)};t._20=function(g,h,b){return h+g*(b-h)};t.E=function(g,h){for(var b=0;b<g.length;b++)for(var c=0;c<h.length;c++)if(h[c]==g[b])return!0;
return!1};t._70=function(g,h){for(var b=Math.max(g.length,h.length),c=0;c<b;c++){var f=R((c>=g.length?0:g[c])-(c>=h.length?0:h[c]));if(f)return f}return 0};t._71=function(g){return g.join(".")};t._58=function(g){return g.split(".").map(function(g){return g|0})};t._57=function(g,h){h[0]=Math.pow(g[0],Ka);h[1]=Math.pow(g[1],Ka);h[2]=Math.pow(g[2],Ka);return h};t._21=function(g,h){h[0]=Math.pow(g[0],1/Ka);h[1]=Math.pow(g[1],1/Ka);h[2]=Math.pow(g[2],1/Ka);return h};t.L=function(g){return 0!=parseInt(g.toString(2).substr(1),
2)};t.W=function(g,h,b,c){c[0]=g[0];c[1]=h[0];c[2]=b[0];c[3]=g[1];c[4]=h[1];c[5]=b[1];c[6]=g[2];c[7]=h[2];c[8]=b[2];return c};t.S=function(){var g=[{}];g.length=0;return g};t._3=function(g){g=Math.round(32767.5*(g+1)-32768);return l(g?g:0,-32768,32767)};t._49=function(g){return l((g+32768)/32767.5-1,-1,1)};t._66=function(g){return l(Math.round(255*g),0,255)};t._65=function(g){return l(g/255,0,1)};t.V=function(g,h,b,c){var f=M.subtract(b,h,U),a=M.subtract(c,b,K),m=M.subtract(h,c,sa);h=M.subtract(g,
h,v);b=M.subtract(g,b,Y);g=M.subtract(g,c,ha);c=M.cross(f,a,S);if(0<=M.dot(M.cross(c,f,L),h)&&0<=M.dot(M.cross(c,a,L),b)&&0<=M.dot(M.cross(c,m,L),g))return m=M.length(c),a=M.dot(c,h),Math.abs(a/m);f=M.scale(f,l(M.dot(f,h)/M.length(f),0,1),L);h=M.length(M.subtract(h,f,L));a=M.scale(a,l(M.dot(a,b)/M.length(a),0,1),L);a=M.length(M.subtract(b,a,L));m=M.scale(m,l(M.dot(m,g)/M.length(m),0,1),L);m=M.length(M.subtract(g,m,L));return Math.min(Math.min(h,a),m)};t._47=function(g,h,b,c,f){if(b||c){var a=J.identity(ra);
b&&(h=J.setAxisAngle(h,b,za),J.multiply(a,h,a));g=J.copy(g,f);c&&(f=d(g,da,U),c=J.setAxisAngle(f,c,za),J.normalize(c,c),J.multiply(a,c,a));J.multiply(a,g,g);J.normalize(g,g)}};t._31=function(g,h,b,c){var f=K;d(h,c,f);M.normalize(f,f);c=sa;M.subtract(b,g,c);M.normalize(c,c);g=T(f,c,q);J.multiply(g,h,h);J.normalize(h,h)};t._32=function(g,h,b,c){h=M.transformQuat(h,g,K);var f=M.dot(c,b);c=M.scale(c,f,sa);b=M.subtract(b,c,sa);c=J.identity(ra);M.normalize(b,b);.999999>Math.abs(M.dot(h,b))&&T(h,b,c);J.normalize(c,
c);J.multiply(c,g,g)};t.Q=function(g,h){for(var b=2*Math.PI,c=[],f=0;3>f;f++)c[f]=g[f]-h[f],5.1<c[f]?(g[f]-=c[f]/b*b,c[f]=g[f]-h[f]):-5.1>c[f]&&(g[f]+=-c[f]/b*b,c[f]=g[f]-h[f]);3.2<Math.abs(c[0])&&1.6>Math.abs(c[1])&&1.6>Math.abs(c[2])&&(g[0]=0<c[0]?g[0]-b:g[0]+b);3.2<Math.abs(c[1])&&1.6>Math.abs(c[2])&&1.6>Math.abs(c[0])&&(g[1]=0<c[1]?g[1]-b:g[1]+b);3.2<Math.abs(c[2])&&1.6>Math.abs(c[0])&&1.6>Math.abs(c[1])&&(g[2]=0<c[2]?g[2]-b:g[2]+b)};t._45=function(g,h,b){h=y(h,ea);g=y(g,H);g=z.multiply(g,h,D);
h=U;var c=K;fa(g,h,c);M.copy(Math.abs(h[0])+Math.abs(h[1])+Math.abs(h[2])>Math.abs(c[0])+Math.abs(c[1])+Math.abs(c[2])?c:h,b);return b};t._35=function(g,h,b){g=z.fromQuat(g,ea);var c=U,f=K;fa(g,c,f);M.copy(Math.abs(c[0]-h[0])+Math.abs(c[1]-h[1])+Math.abs(c[2]-h[2])>Math.abs(f[0]-h[0])+Math.abs(f[1]-h[1])+Math.abs(f[2]-h[2])?f:c,b);return b};var z=e(27),G=e(21),E=e(42),J=e(8);C=e(6);var M=e(3),F=e(7),U=new Float32Array(3),K=new Float32Array(3),sa=new Float32Array(3),v=new Float32Array(3),Y=new Float32Array(3),
ha=new Float32Array(3),S=new Float32Array(3),L=new Float32Array(3),q=new Float32Array(4),w=new Float32Array(4),ea=new Float32Array(9),H=new Float32Array(9),D=new Float32Array(9),h=new Float32Array(16),ia=new Float32Array(16),ra=J.create(),za=J.create(),P=new Float32Array([0,0,0]),oa=new Float32Array([0,0,0,1]);C.b();C.b();var Q=new Float32Array([1,1,1]),da=new Float32Array([1,0,0]),ja=new Float32Array([0,1,0]),va=new Float32Array([0,0,1]),Ga=new Float32Array([-1,0,0]),ba=new Float32Array([0,-1,0]),
Ea=new Float32Array([0,0,-1]),ta=0,X=1,pa=2,ka=3,Ca=4,Ma=5,Aa=6,xa=7,ga=8,ya=9,O=10,wa=11,qa=/object .*Array/,na=[ta,X,pa,Ca,Ma],Ja=5E4,g=48271,Da=2147483647,Ba=Da%g,Ta=Math.floor(Da/g),ma=[new Float32Array([0,0,-1,0,0,-1,0,0,-1,0,0,0,0,0,0,1]),new Float32Array([0,0,1,0,0,-1,0,0,1,0,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,-1,0,0,1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,-1,0,0,0,0,-1,0,0,0,0,1]),new Float32Array([-1,0,0,0,0,-1,0,0,0,0,1,0,
0,0,0,1])],Ka=2.2,fb=1,La=2,Xa=4,Wa=4},function(C,t,e){function R(){var c=new a(3);c[0]=0;c[1]=0;c[2]=0;return c}function V(c,l,b){var f=new a(3);f[0]=c;f[1]=l;f[2]=b;return f}function n(c,a,b){b[0]=c[0]-a[0];b[1]=c[1]-a[1];b[2]=c[2]-a[2];return b}function y(c,a,b){b[0]=c[0]*a[0];b[1]=c[1]*a[1];b[2]=c[2]*a[2];return b}function d(c,a,b){b[0]=c[0]/a[0];b[1]=c[1]/a[1];b[2]=c[2]/a[2];return b}function k(c,a){var b=a[0]-c[0],f=a[1]-c[1],l=a[2]-c[2];return Math.sqrt(b*b+f*f+l*l)}function I(c,a){var b=a[0]-
c[0],f=a[1]-c[1],l=a[2]-c[2];return b*b+f*f+l*l}function A(c){var a=c[0],b=c[1];c=c[2];return Math.sqrt(a*a+b*b+c*c)}function r(c){var a=c[0],b=c[1];c=c[2];return a*a+b*b+c*c}function p(c,a){var b=c[0],f=c[1],l=c[2],b=b*b+f*f+l*l;0<b&&(b=1/Math.sqrt(b),a[0]=c[0]*b,a[1]=c[1]*b,a[2]=c[2]*b);return a}function u(c,a){return c[0]*a[0]+c[1]*a[1]+c[2]*a[2]}Object.defineProperty(t,"__esModule",{value:!0});t.create=R;t.clone=function(c){var l=new a(3);l[0]=c[0];l[1]=c[1];l[2]=c[2];return l};t.fromValues=V;
t.copy=function(c,a){a[0]=c[0];a[1]=c[1];a[2]=c[2];return a};t.set=function(c,a,b,f){f[0]=c;f[1]=a;f[2]=b;return f};t.add=function(c,a,b){b[0]=c[0]+a[0];b[1]=c[1]+a[1];b[2]=c[2]+a[2];return b};t.subtract=n;e.d(t,"sub",function(){return n});t.multiply=y;e.d(t,"mul",function(){return y});t.divide=d;e.d(t,"div",function(){return d});t.min=function(c,a,b){b[0]=Math.min(c[0],a[0]);b[1]=Math.min(c[1],a[1]);b[2]=Math.min(c[2],a[2]);return b};t.max=function(c,a,b){b[0]=Math.max(c[0],a[0]);b[1]=Math.max(c[1],
a[1]);b[2]=Math.max(c[2],a[2]);return b};t.scale=function(c,a,b){b[0]=c[0]*a;b[1]=c[1]*a;b[2]=c[2]*a;return b};t.scaleAndAdd=function(c,a,b,f){f[0]=c[0]+a[0]*b;f[1]=c[1]+a[1]*b;f[2]=c[2]+a[2]*b;return f};t.distance=k;e.d(t,"dist",function(){return k});t.squaredDistance=I;e.d(t,"sqrDist",function(){return I});t.length=A;e.d(t,"len",function(){return A});t.squaredLength=r;e.d(t,"sqrLen",function(){return r});t.negate=function(c,a){a[0]=-c[0];a[1]=-c[1];a[2]=-c[2];return a};t.inverse=function(c,a){a[0]=
1/c[0];a[1]=1/c[1];a[2]=1/c[2];return a};t.normalize=p;t.dot=u;t.cross=function(c,a,b){var f=c[0],l=c[1];c=c[2];var d=a[0],m=a[1];a=a[2];b[0]=l*a-c*m;b[1]=c*d-f*a;b[2]=f*m-l*d;return b};t.lerp=function(c,a,b,f){var l=c[0],d=c[1];c=c[2];f[0]=l+b*(a[0]-l);f[1]=d+b*(a[1]-d);f[2]=c+b*(a[2]-c);return f};t.hermite=function(c,a,b,f,l,d){var m=l*l,k=m*(2*l-3)+1,B=m*(l-2)+l,e=m*(l-1);l=m*(3-2*l);d[0]=c[0]*k+a[0]*B+b[0]*e+f[0]*l;d[1]=c[1]*k+a[1]*B+b[1]*e+f[1]*l;d[2]=c[2]*k+a[2]*B+b[2]*e+f[2]*l;return d};t.bezier=
function(c,a,b,f,l,d){var m=1-l,k=m*m,B=l*l,e=k*m,k=3*l*k,m=3*B*m;l*=B;d[0]=c[0]*e+a[0]*k+b[0]*m+f[0]*l;d[1]=c[1]*e+a[1]*k+b[1]*m+f[1]*l;d[2]=c[2]*e+a[2]*k+b[2]*m+f[2]*l;return d};t.random=function(c,a){var b=2*B()*Math.PI,f=2*B()-1,l=Math.sqrt(1-f*f)*c;a[0]=Math.cos(b)*l;a[1]=Math.sin(b)*l;a[2]=f*c;return a};t.transformMat4=function(c,a,b){var f=c[0],l=c[1];c=c[2];var d=a[3]*f+a[7]*l+a[11]*c+a[15],d=d||1;b[0]=(a[0]*f+a[4]*l+a[8]*c+a[12])/d;b[1]=(a[1]*f+a[5]*l+a[9]*c+a[13])/d;b[2]=(a[2]*f+a[6]*l+
a[10]*c+a[14])/d;return b};t.transformMat3=function(c,a,b){var f=c[0],l=c[1];c=c[2];b[0]=f*a[0]+l*a[3]+c*a[6];b[1]=f*a[1]+l*a[4]+c*a[7];b[2]=f*a[2]+l*a[5]+c*a[8];return b};t.transformQuat=function(c,a,b){var f=c[0],l=c[1],d=c[2];c=a[0];var m=a[1],k=a[2];a=a[3];var B=a*f+m*d-k*l,e=a*l+k*f-c*d,p=a*d+c*l-m*f,f=-c*f-m*l-k*d;b[0]=B*a+f*-c+e*-k-p*-m;b[1]=e*a+f*-m+p*-c-B*-k;b[2]=p*a+f*-k+B*-m-e*-c;return b};t.rotateX=function(c,a,b,f){var l=[],d=[];l[0]=c[0]-a[0];l[1]=c[1]-a[1];l[2]=c[2]-a[2];d[0]=l[0];
d[1]=l[1]*Math.cos(b)-l[2]*Math.sin(b);d[2]=l[1]*Math.sin(b)+l[2]*Math.cos(b);f[0]=d[0]+a[0];f[1]=d[1]+a[1];f[2]=d[2]+a[2];return f};t.rotateY=function(c,a,b,f){var l=[],d=[];l[0]=c[0]-a[0];l[1]=c[1]-a[1];l[2]=c[2]-a[2];d[0]=l[2]*Math.sin(b)+l[0]*Math.cos(b);d[1]=l[1];d[2]=l[2]*Math.cos(b)-l[0]*Math.sin(b);f[0]=d[0]+a[0];f[1]=d[1]+a[1];f[2]=d[2]+a[2];return f};t.rotateZ=function(c,a,b,f){var l=[],d=[];l[0]=c[0]-a[0];l[1]=c[1]-a[1];l[2]=c[2]-a[2];d[0]=l[0]*Math.cos(b)-l[1]*Math.sin(b);d[1]=l[0]*Math.sin(b)+
l[1]*Math.cos(b);d[2]=l[2];f[0]=d[0]+a[0];f[1]=d[1]+a[1];f[2]=d[2]+a[2];return f};e.d(t,"forEach",function(){return l});t.angle=function(c,a){var b=V(c[0],c[1],c[2]),f=V(a[0],a[1],a[2]);p(b,b);p(f,f);b=u(b,f);return 1<b?0:Math.acos(b)};t.str=function(c){return"vec3("+c[0]+", "+c[1]+", "+c[2]+")"};var a="undefined"!==typeof Float32Array?Float32Array:Array,B=Math.random,l=function(){var c=R();return function(a,b,f,l,d,z){b||(b=3);f||(f=0);for(l=l?Math.min(l*b+f,a.length):a.length;f<l;f+=b)c[0]=a[f],
c[1]=a[f+1],c[2]=a[f+2],d(c,z,c),a[f]=c[0],a[f+1]=c[1],a[f+2]=c[2];return a}}()},function(C,t,e){C=e(0);var R=e(32),V=e(5),n=e(1),y=e(2);e=Object(C.a)("__config",function(d,k){function e(){return R.a.module_check(k.paths.built_in_data_module)}function A(){for(var d=k.paths,a=null,B=!1,l=document.getElementsByTagName("script"),c=0;c<l.length;c++){for(var m=l[c].src,b=0;b<d.js_src_search_paths.length;b++)if(0<=m.indexOf(d.js_src_search_paths[b])&&(a=m,l[c].attributes["b4w-offset"])){a=a.substring(0,
a.lastIndexOf("/"))+"/"+l[c].attributes["b4w-offset"].value;B=!0;break}if(B)break}a||(p.warn("Couldn't determine path to ancillary resources, fallback to the current page directory"),a=document.location.href);d=a.indexOf("?");0<=d&&(a=a.substring(0,d));return a.substring(0,a.lastIndexOf("/"))}var r=Object(V.a)(d),p=Object(n.a)(d);k.P_LOW=1;k.P_HIGH=2;k.P_ULTRA=3;k.P_CUSTOM=4;k.P_AUTO=5;k.context={alpha:!0,antialias:!1,premultipliedAlpha:!0};k.context_save=y.O(k.context);k.defaults={alpha_sort:!0,
alpha_sort_threshold:.1,min_format_version:[6,3],max_fps:1E4,console_verbose:!1,do_not_load_resources:!1,use_min50:!1,enable_texture_cache:!0,fps_measurement_interval:1,fps_callback_interval:5,background_color:[0,0,0,0],canvas_resolution_factor:1,texture_min_filter:3,allow_cors:!1,force_low_quality_nodes:!1,anisotropic_available:!0,anisotropic_filtering:!0,texture_lod_available:!1,tex_float_available:!1,tex_hfloat_available:!1,tex_float_lin_available:!1,tex_hfloat_lin_available:!1,cbuffer_float_available:!1,
cbuffer_hfloat_available:!1,show_hud_debug_info:!1,depth_tex_available:!0,shadows:!0,stereo:"NONE",reflections:!0,refractions:!0,ssao:!0,dof:!0,god_rays:!0,bloom:!0,motion_blur:!0,compositing:!0,antialiasing:!0,smaa:!1,debug_view:!1,water_wireframe_debug:!1,foam:!0,parallax:!0,dynamic_grass:!0,water_dynamic:!0,shore_smoothing:!0,shore_distance:!0,use_compression:!0,precision:"highp",quality:k.P_HIGH,allow_vertex_textures:!0,lod_leap_smooth_threshold:3,assets_gzip_available:!1,no_phy_interp_hack:!1,
shader_constants_hack:!1,disable_blend_shadows_hack:!1,vert_anim_mix_normals_hack:!1,is_mobile_device:!1,init_wa_context_hack:!1,clear_procedural_sky_hack:!1,sky_update_hack:!1,seq_video_fallback:!1,allow_hidpi:!1,shadows_color_slink_hack:!1,mobile_firefox_media_hack:!1,ipad_video_hack:!1,enable_selectable:!0,enable_outlining:!0,lod_smooth_transitions:!0,glow_materials:!0,ie11_edge_touchscreen_hack:!1,firefox_tex_reuse_hack:!1,loaded_data_version:[0,0],quality_aa_method:!0,skinning_hack:!1,url_params:null,
webgl2:!0,msaa_samples:4,compared_mode_depth:!1,safari_canvas_alpha_hack:!1,safari_glow_hack:!1,resize_cubemap_canvas_hack:!1,resize_texture_canvas_hack:!1,chrome_html_bkg_music_hack:!1,ie_edge_anchors_floor_hack:!1,ie11_edge_mouseoffset_hack:!1,media_auto_activation:!0,max_cast_lamps:4,mac_os_shadow_hack:!1,gl_debug:!1,check_framebuffer_hack:!1,allow_instanced_arrays_ext:!1,allow_vao_ext:!1,compress_format:"dds",shadow_blur_samples:"",reflection_quality:"",srgb_type:"SRGB_SIMPLE",ios_copy_tex_hack:!1,
rgba_fallback_shadows:!1,debug_loading:!1,mali_alpha_antialias_hack:!1,mali4_lamps_hack:!1,chrome_csm_blend_hack:!1,reuse_depth_optimization:!0};k.defaults_save=y.O(k.defaults);k.animation={framerate:-1,frames_blending_hack:!1,frame_steps:1};k.controls={mouse_wheel_notch_multiplier:1/120};k.assets={path:"",path_default:"B4W_ASSETS_PATH=__JS__/../../assets\/",proj_path_default:"B4W_PROJ_ASSETS_PATH=__JS__/../assets\/",max_requests:15,prevent_caching:!0,min50_available:!1,dds_available:!1,
pvr_available:!1};k.assets_save=y.O(k.assets);k.paths={shaders_path:"",shaders_path_default:"../shaders/",shaders_include_dir:"include/",shaders_postp_dir:"postprocessing/",built_in_data_module:"built_in_data",js_src_search_paths:"b4w.js b4w.min.js b4w.simple.min.js b4w.whitespace.min.js b4w_app_bundle.js AR.min.js".split(" "),smaa_search_texture_path:"smaa_search_texture.png",smaa_area_texture_path:"smaa_area_texture.png"};k.hmd_params={webvr:{distortion_coefs:[.22,.28],chromatic_aberration_coefs:[-.015,
.02,.025,.02]},nonwebvr:{distor_scale:.8,inter_lens_dist:.064,base_line_dist:.035,screen_to_lens_dist:.039,distortion_coefs:[.34,.55],chromatic_aberration_coefs:[0,0,0,0],width_dist:.11,height_dist:.062,bevel_size:.004}};k.physics={enabled:!0,max_fps:60,uranium_path:"",uranium_bin:"",uranium_path_default:"B4W_URANIUM_PATH=uranium/",asmjs_file:"uranium.js",wasmjs_file:"uranium_wasm.js",mem_file:"uranium.js.mem",wasm_file:"uranium_wasm.wasm",uranium_dir:"/dist/uranium",calc_fps:!1,ping:!1,use_workers:!0,
use_wasm:!0};k.physics_save=y.O(k.physics);k.scenes={grass_tex_size:1024,cubemap_tex_size:256,cube_reflect_low:32,cube_reflect_medium:128,cube_reflect_high:256,plane_reflect_low:.25,plane_reflect_medium:.5,plane_reflect_high:1};k.scenes_save=y.O(k.scenes);k.sfx={webaudio:!0,mix_mode:!1,audio_loading_hack:!1,clamp_playback_rate_hack:!1,disable_playback_rate_hack:!1};k.sfx_save=y.O(k.sfx);k.outlining={outlining_overview_mode:!1,outline_color:[1,.4,.05],outline_duration:.2,outline_period:3.8,outline_relapses:1};
k.debug_subs={enabled:!1,subs_type:39,subs_number:0,slink_type:"COLOR"};k.debug_subs_save=y.O(k.debug_subs);k.context_limits={max_combined_texture_image_units:8,max_fragment_uniform_vectors:64,max_texture_image_units:8,max_varying_vectors:8,max_vertex_attribs:15,max_vertex_texture_image_units:0,max_vertex_uniform_vectors:128,max_cube_map_texture_size:1024,max_renderbuffer_size:4096,max_texture_size:4096,max_viewport_dims:[4096,4096],depth_bits:24};k.context_limits_save=y.O(k.context_limits);k.apply_quality=
function(){var d=k.defaults,a=k.physics,B=k.scenes;switch(d.quality){case k.P_ULTRA:d.shadows=!0;d.shore_smoothing=!0;d.ssao=!0;d.dof=!0;d.god_rays=!0;d.bloom=!0;d.reflections=!0;d.refractions=!0;d.foam=!0;d.parallax=!0;d.dynamic_grass=!0;B.grass_tex_size=2048;B.cubemap_tex_size=512;d.texture_min_filter=3;d.anisotropic_filtering=!0;d.use_min50=!1;d.water_dynamic=!0;d.shore_distance=!0;d.antialiasing=!0;d.smaa=!1;d.compositing=!0;d.motion_blur=!0;d.allow_hidpi=!0;d.enable_outlining=!0;d.glow_materials=
!0;d.msaa_samples=16;d.srgb_type="SRGB_PROPER";a.max_fps=120;d.lod_smooth_transitions=!0;break;case k.P_HIGH:d.shadows=!0;d.shore_smoothing=!0;d.ssao=!0;d.dof=!0;d.god_rays=!0;d.bloom=!0;d.reflections=!0;d.refractions=!0;d.foam=!0;d.parallax=!0;d.dynamic_grass=!0;B.grass_tex_size=1024;B.cubemap_tex_size=256;d.texture_min_filter=3;d.anisotropic_filtering=!0;d.use_min50=!1;d.water_dynamic=!0;d.shore_distance=!0;d.antialiasing=!0;d.smaa=!1;d.compositing=!0;d.motion_blur=!0;d.allow_hidpi=!1;d.enable_outlining=
!0;d.glow_materials=!0;d.srgb_type="SRGB_SIMPLE";d.msaa_samples=4;a.max_fps=60;d.lod_smooth_transitions=!0;break;case k.P_LOW:d.shadows=!1;d.shore_smoothing=!1;d.ssao=!1;d.dof=!1;d.god_rays=!1;d.bloom=!1;d.reflections=!1;d.refractions=!1;d.foam=!1;d.parallax=!1;d.dynamic_grass=!1;B.grass_tex_size=512;B.cubemap_tex_size=256;d.texture_min_filter=2;d.anisotropic_filtering=!1;d.use_min50=!0;d.water_dynamic=!1;d.shore_distance=!1;d.antialiasing=!1;d.smaa=!1;d.compositing=!1;d.motion_blur=!1;d.allow_hidpi=
!1;d.enable_outlining=!1;d.glow_materials=!1;d.srgb_type="SRGB_SIMPLE";d.msaa_samples=1;a.max_fps=60;d.lod_smooth_transitions=!1;break;case k.P_AUTO:r.panic("Direct AUTO quality profile setting is forbidden")}};k.set=function(d,a){switch(d){case "allow_cors":k.defaults.allow_cors=a;break;case "allow_hidpi":k.defaults.allow_hidpi=a;break;case "alpha":k.context.alpha=a;break;case "alpha_sort":k.defaults.alpha_sort=a;break;case "alpha_sort_threshold":k.defaults.alpha_sort_threshold=a;break;case "anaglyph_use":p.error_deprecated_cfg("anaglyph_use",
"stereo");k.defaults.stereo=a?"ANAGLYPH":k.defaults.stereo;break;case "animation_framerate":k.animation.framerate=a;break;case "anisotropic_filtering":k.defaults.anisotropic_filtering=a;break;case "antialiasing":k.defaults.antialiasing=a;break;case "assets_dir":case "assets_path":k.assets.path=a;break;case "assets_dds_available":k.assets.dds_available=a;break;case "assets_pvr_available":k.assets.pvr_available=a;break;case "assets_min50_available":k.assets.min50_available=a;break;case "audio":k.sfx.webaudio=
a;break;case "background_color":k.defaults.background_color=a;break;case "bloom":k.defaults.bloom=a;break;case "built_in_module_name":k.paths.built_in_data_module=a;break;case "canvas_resolution_factor":k.defaults.canvas_resolution_factor=a;break;case "console_verbose":k.defaults.console_verbose=a;break;case "compositing":k.defaults.compositing=a;break;case "dof":k.defaults.dof=a;break;case "do_not_load_resources":k.defaults.do_not_load_resources=a;break;case "god_rays":k.defaults.god_rays=a;break;
case "stereo":k.defaults.stereo=a;break;case "lod_leap_smooth_threshold":k.defaults.lod_leap_smooth_threshold=a;break;case "lod_smooth_transitions":k.defaults.lod_smooth_transitions=a;break;case "max_fps":k.defaults.max_fps=a;break;case "max_fps_physics":k.physics.max_fps=a;break;case "media_auto_activation":k.defaults.media_auto_activation=a;break;case "motion_blur":k.defaults.motion_blur=a;break;case "physics_enabled":k.physics.enabled=a;break;case "physics_uranium_path":k.physics.use_wasm&&window.WebAssembly?
(k.physics.uranium_path=a+k.physics.wasmjs_file,k.physics.uranium_bin=a+k.physics.wasm_file):(k.physics.uranium_path=a+k.physics.asmjs_file,k.physics.uranium_bin=a+k.physics.mem_file);k.physics.uranium_dir=a;break;case "physics_use_wasm":k.physics.use_wasm=a;break;case "physics_calc_fps":k.physics.calc_fps=a;break;case "physics_use_workers":k.physics.use_workers=a;break;case "precision":k.defaults.precision=a;break;case "prevent_caching":k.assets.prevent_caching=a;break;case "quality":k.defaults.quality=
a;break;case "reflections":k.defaults.reflections=a;break;case "refractions":k.defaults.refractions=a;break;case "sfx_mix_mode":k.sfx.mix_mode=a;break;case "shaders_dir":case "shaders_path":k.paths.shaders_path=a;break;case "shadows":k.defaults.shadows=a;break;case "show_hud_debug_info":k.defaults.show_hud_debug_info=a;break;case "smaa":p.error_deprecated_cfg("smaa");k.defaults.smaa=a;break;case "smaa_search_texture_path":p.error_deprecated_cfg("smaa_search_texture_path");k.paths.smaa_search_texture_path=
a;break;case "smaa_area_texture_path":p.error_deprecated_cfg("smaa_area_texture_path");k.paths.smaa_area_texture_path=a;break;case "ssao":k.defaults.ssao=a;break;case "debug_view":k.defaults.debug_view=a;break;case "enable_selectable":k.defaults.enable_selectable=a;break;case "enable_outlining":k.defaults.enable_outlining=a;break;case "outlining_overview_mode":k.outlining.outlining_overview_mode=a;break;case "glow_materials":k.defaults.glow_materials=a;break;case "url_params":k.defaults.url_params=
a;break;case "use_min50":k.defaults.use_min50=a;break;case "enable_texture_cache":k.defaults.enable_texture_cache=a;break;case "gl_debug":k.defaults.gl_debug=a;break;case "srgb_type":k.defaults.srgb_type=a;break;case "shadow_blur_samples":k.defaults.shadow_blur_samples=a;break;case "reflection_quality":k.defaults.reflection_quality=a;break;case "assets_gzip_available":k.defaults.assets_gzip_available=a;break;case "debug_loading":k.defaults.debug_loading=a;break;case "msaa_samples":k.defaults.msaa_samples=
a;break;default:p.error("Unknown config property: "+d)}};k.get=function(d){switch(d){case "allow_cors":return k.defaults.allow_cors;case "allow_hidpi":return k.defaults.allow_hidpi;case "alpha":return k.context.alpha;case "alpha_sort":return k.defaults.alpha_sort;case "alpha_sort_threshold":return k.defaults.alpha_sort_threshold;case "anaglyph_use":return"ANAGLYPH"==k.defaults.stereo;case "animation_framerate":return k.animation.framerate;case "anisotropic_filtering":return k.defaults.anisotropic_filtering;
case "antialiasing":return k.defaults.antialiasing;case "assets_dir":case "assets_path":return k.assets.path;case "assets_dds_available":return k.assets.dds_available;case "assets_pvr_available":return k.assets.pvr_available;case "assets_min50_available":return k.assets.min50_available;case "audio":return k.sfx.webaudio;case "background_color":return k.defaults.background_color;case "bloom":return k.defaults.bloom;case "built_in_module_name":return k.paths.built_in_data_module;case "canvas_resolution_factor":return k.defaults.canvas_resolution_factor;
case "console_verbose":return k.defaults.console_verbose;case "compositing":return k.defaults.compositing;case "dof":return k.defaults.dof;case "do_not_load_resources":return k.defaults.do_not_load_resources;case "is_mobile_device":return k.defaults.is_mobile_device;case "god_rays":return k.defaults.god_rays;case "stereo":return k.defaults.stereo;case "lod_leap_smooth_threshold":return k.defaults.lod_leap_smooth_threshold;case "lod_smooth_transitions":return k.defaults.lod_smooth_transitions;case "max_fps":return k.defaults.max_fps;
case "max_fps_physics":return k.physics.max_fps;case "media_auto_activation":return k.defaults.media_auto_activation;case "motion_blur":return k.defaults.motion_blur;case "physics_enabled":return k.physics.enabled;case "physics_uranium_path":return k.physics.uranium_dir;case "physics_uranium_bin":return k.physics.uranium_bin;case "physics_use_wasm":return k.physics.use_wasm;case "physics_calc_fps":return k.physics.calc_fps;case "physics_use_workers":return k.physics.use_workers;case "precision":return k.defaults.precision;
case "prevent_caching":return k.assets.prevent_caching;case "quality":return k.defaults.quality;case "reflections":return k.defaults.reflections;case "refractions":return k.defaults.refractions;case "sfx_mix_mode":return k.sfx.mix_mode;case "shaders_dir":case "shaders_path":return k.paths.shaders_path;case "shadows":return k.defaults.shadows;case "show_hud_debug_info":return k.defaults.show_hud_debug_info;case "smaa":return k.defaults.smaa;case "smaa_search_texture_path":return k.paths.smaa_search_texture_path;
case "smaa_area_texture_path":return k.paths.smaa_area_texture_path;case "ssao":return k.defaults.ssao;case "debug_view":return k.defaults.debug_view;case "enable_selectable":return k.defaults.enable_selectable;case "enable_outlining":return k.defaults.enable_outlining;case "outlining_overview_mode":return k.outlining.outlining_overview_mode;case "glow_materials":return k.defaults.glow_materials;case "url_params":return k.defaults.url_params;case "use_min50":return k.defaults.use_min50;case "enable_texture_cache":return k.defaults.enable_texture_cache;
case "gl_debug":return k.defaults.gl_debug;case "srgb_type":return k.defaults.srgb_type;case "shadow_blur_samples":return k.defaults.shadow_blur_samples;case "reflection_quality":return k.defaults.reflection_quality;case "assets_gzip_available":return k.defaults.assets_gzip_available;case "debug_loading":return k.defaults.debug_loading;case "msaa_samples":return k.defaults.msaa_samples;default:p.error("Unknown config property: "+d)}};k.reset=function(){for(var d in k.context_save)k.context[d]=k.context_save[d];
for(d in k.defaults_save)k.defaults[d]=k.defaults_save[d];for(d in k.assets_save)k.assets[d]=k.assets_save[d];for(d in k.physics_save)k.physics[d]=k.physics_save[d];for(d in k.scenes_save)k.scenes[d]=k.scenes_save[d];for(d in k.sfx_save)k.sfx[d]=k.sfx_save[d];for(d in k.debug_subs_save)k.debug_subs[d]=k.debug_subs_save[d]};k.reset_limits=function(){var d=k.context_limits.depth_bits,a;for(a in k.context_limits_save)k.context_limits[a]=k.context_limits_save[a];k.context_limits.depth_bits=d};k.is_built_in_data=
e;k.set_paths=function(){var d=k.paths,a=k.physics;e()||""!=d.shaders_path||(d.shaders_path=A()+"/"+d.shaders_path_default);if(k.physics.use_wasm&&window.WebAssembly)var d=a.uranium_path_default+a.wasmjs_file,B=a.uranium_path_default+a.wasm_file;else d=a.uranium_path_default+a.asmjs_file,B=a.uranium_path_default+a.mem_file;a.enabled&&""==a.uranium_path&&(a.uranium_path=d.replace("B4W_URANIUM_PATH=",""),a.uranium_bin=B.replace("B4W_URANIUM_PATH=",""))};k.get_assets_path=function(d){var a=k.assets;
if(a.path)return a.path;var B=a.path_default,l="B4W_ASSETS_PATH=";d&&(B=a.proj_path_default,l="B4W_PROJ_ASSETS_PATH=",B=B.replace("__NAME__",d));B=B.replace(l,"");return B=B.replace("__JS__",A())}});t.a=e},function(C,t,e){C=e(0);var R=e(2),V=e(1);e=Object(C.a)("assert",function(e,y){function d(a){a&&r.error.apply(r,arguments);throw"engine panic:\nThe engine tried to perform an invalid operation and halted.\nPlease copy the console contents above and submit it to the Blend4Web forum at\nhttps://www.blend4web.com/en/forums/forum/17/";
}function k(a,k){n(a)||d("Structure assertion failed: invalid first object value");n(k)||d("Structure assertion failed: invalid second object value");A(a,k)||d("Structure assertion failed: incompatible types");if(!(null==a||null==k||"object"!=typeof a||R._14(a)||a instanceof Array)){for(var l in a)n(a[l])||d("Structure assertion failed: invalid value for key in the first object: "+l),l in k||d("Structure assertion failed: missing key in the first object: "+l);for(l in k)n(k[l])||d("Structure assertion failed: invalid value for key in the second object: "+
l),l in a||d("Structure assertion failed: missing key in the second object: "+l),A(a[l],k[l])||d("Structure assertion failed: incompatible types for key "+l)}}function n(a){return"undefined"==typeof a?!1:"number"==typeof a&&isNaN(a)?!1:!0}function A(a,d){if(typeof a!=typeof d)return!1;if(null!=a&&null!=d&&"object"==typeof a){var l=a instanceof Array,c=d instanceof Array;if(l&&!c||!l&&c)return!1;l=R._14(a);c=R._14(d);if(l&&!c||!l&&c)return!1}return!0}var r=Object(V.a)(e),p=null,u=!1;y.panic=d;y.assert=
function(a){a||d("Assertion failed")};y.is_constructor=function(a,k){a.constructor!=k&&d("Type assertion failed: value <"+a+"> has type <"+a.constructor+">, required <"+k+">")};y.equal=k;y.equal_seq=function(a){u?k(a,p):u=!0;p=null!=a&&"object"==typeof a?R.N(a):a}});t.a=e},function(C,t,e){function R(){var b=new Float32Array(9);b[3]=1;b[4]=1;b[5]=1;return b}function V(b,c){if(b[8]!=b[8])throw Error(b);c[0]=b[0];c[1]=b[1];c[2]=b[2];c[3]=b[3];c[4]=b[4];c[5]=b[5];c[6]=b[6];c[7]=b[7];c[8]=b[8];return c}
function n(b,c){if(b[0]!=b[0])throw Error(b);c[0]=b[0];c[1]=b[1];c[2]=b[2];return c}function y(b,c){u._15(b)?(c[3]=b[0],c[4]=b[1],c[5]=b[2]):(c[3]=b,c[4]=b,c[5]=b);return c}function d(b,c){if(b[0]!=b[0])throw Error(b);var a=0>b[3]?-1:1;c[6]=a*b[0];c[7]=a*b[1];c[8]=a*b[2];return c}function k(b,c){c[0]=b[0];c[1]=b[1];c[2]=b[2];return c}function I(b,c){return c?(c[0]=b[3],c[1]=b[4],c[2]=b[5],c):b[3]}function A(b,c){c[0]=b[6];c[1]=b[7];c[2]=b[8];c[3]=Math.sqrt(Math.abs(1-b[6]*b[6]-b[7]*b[7]-b[8]*b[8]));
return c}t.b=R;t.e=function(b,c,a,f,l,d,m,w){var q=R();q[0]=b;q[1]=c;q[2]=a;q[3]=f;q[4]=f;q[5]=f;b=0>w?-1:1;q[6]=b*l;q[7]=b*d;q[8]=b*m;return q};t.c=function(){var b=new Float32Array(9);b[3]=1;b[4]=1;b[5]=1;return b};t.a=V;t.m=function(b){b[0]=0;b[1]=0;b[2]=0;b[3]=1;b[4]=1;b[5]=1;b[6]=0;b[7]=0;b[8]=0;return b};t.t=function(b,c,a,f){f[0]=b[0];f[1]=b[1];f[2]=b[2];u._15(c)?(f[3]=c[0],f[4]=c[1],f[5]=c[2]):(f[3]=c,f[4]=c,f[5]=c);b=0>a[3]?-1:1;f[6]=b*a[0];f[7]=b*a[1];f[8]=b*a[2];return f};t.v=n;t.s=y;t.w=
function(b,c){c[0]=b[0];c[1]=b[1];c[2]=b[2];c[3]=b[3];return c};t.r=d;t.k=function(b){return k(b,p.create())};t.j=k;t.i=I;t.l=function(b,c){c[0]=b[0];c[1]=b[1];c[2]=b[2];c[3]=b[3];return c};t.h=function(b){return A(b,p.create())};t.g=A;e.d(t,"p",function(){return c});e.d(t,"x",function(){return m});e.d(t,"d",function(){return b});e.d(t,"q",function(){return f});e.d(t,"D",function(){return T});e.d(t,"E",function(){return fa});e.d(t,"F",function(){return z});e.d(t,"z",function(){return G});e.d(t,"y",
function(){return E});e.d(t,"C",function(){return J});t.A=function(b,c,a){A(c,a);return p.multiply(a,b,a)};e.d(t,"B",function(){return M});e.d(t,"G",function(){return F});e.d(t,"o",function(){return U});e.d(t,"n",function(){return K});t.f=function(b,c,a){a[0]=b[9*c];a[1]=b[9*c+1];a[2]=b[9*c+2];a[3]=b[9*c+3];a[4]=b[9*c+4];a[5]=b[9*c+5];a[6]=b[9*c+6];a[7]=b[9*c+7];a[8]=b[9*c+8];return a};t.u=function(b,c,a){c[9*a]=b[0];c[9*a+1]=b[1];c[9*a+2]=b[2];c[9*a+3]=b[3];c[9*a+4]=b[4];c[9*a+5]=b[5];c[9*a+6]=b[6];
c[9*a+7]=b[7];c[9*a+8]=b[8];return c};var r=e(21),p=e(8),u=e(2),a=e(3),B=Math.sin(-Math.PI/4),l=-B;new Float32Array(3);new Float32Array(4);new Float32Array(16);var c=function(){var b=a.create(),c=a.create(),f=p.create();return function(l,m){var z=I(l,b);a.inverse(z,z);if(!z[0])return null;var q=k(l,c),w=A(l,f);p.invert(w,w);a.multiply(q,z,q);a.transformQuat(q,w,q);a.negate(q,q);n(q,m);y(z,m);d(w,m);return m}}(),m=function(){var b=a.create(),c=a.create(),f=p.create();return function(a,l){var d=k(a,
b),m=I(a,c),w=A(a,f);r.fromRotationTranslation(w,d,l);r.scale(l,m,l);return l}}(),b=function(){var b=a.create(),c=a.create(),f=p.create();return function(a,l){var m=u._26(a,b),q=u._25(a,c),w=u._24(a,f);n(m,l);y(q,l);d(w,l);return l}}(),f=function(){var b=a.create(),c=a.create(),f=p.create(),l=p.create();return function(m,z,q){var w=k(z,b);T(w,m,w);n(w,q);var w=I(m,b),v=I(z,c),w=a.multiply(w,v,b);y(w,q);m=A(m,f);z=A(z,l);z=p.multiply(m,z,f);d(z,q);return q}}();(function(){var b=r.create();return function(c,
a,f){a=m(a,b);r.multiply(a,c,f);return f}})();var T=function(){var b=a.create(),c=a.create(),f=p.create();return function(l,d,m){var q=k(d,b),w=I(d,c);d=A(d,f);a.multiply(l,w,m);a.transformQuat(m,d,m);a.add(m,q,m);return m}}(),fa=function(){var b=a.create(),c=a.create(),f=p.create();return function(l,d,m){var q=k(d,b),w=I(d,c);d=A(d,f);a.subtract(l,q,m);p.invert(d,d);a.transformQuat(m,d,m);a.inverse(w,w);a.multiply(m,w,m);return m}}(),z=function(){var b=a.create(),c=a.create(),f=a.create(),l=p.create();
return function(d,m,q,w){w|=0;var z=d.length,v=k(m,b),D=I(m,c);m=A(m,l);for(var h=0;h<z;h+=3)f[0]=d[h],f[1]=d[h+1],f[2]=d[h+2],a.multiply(f,D,f),a.transformQuat(f,m,f),a.add(f,v,f),q[w+h]=f[0],q[w+h+1]=f[1],q[w+h+2]=f[2];return q}}(),G=function(){var b=a.create(),c=a.create(),f=p.create();return function(l,d,m,q){q|=0;var w=l.length,z=I(d,b);d=A(d,f);for(var v=0;v<w;v+=3)c[0]=l[v],c[1]=l[v+1],c[2]=l[v+2],a.multiply(c,z,c),a.transformQuat(c,d,c),m[q+v]=c[0],m[q+v+1]=c[1],m[q+v+2]=c[2];return m}}(),
E=function(){var b=a.create(),c=p.create();return function(f,l,d){var m=I(l,b);l=A(l,c);a.multiply(f,m,d);a.transformQuat(d,l,d);return d}}(),J=function(){var b=a.create();a.create();var c=p.create();return function(f,l,d,m){m|=0;var q=f.length,w=I(l,b);l=A(l,c);for(var z,v=0;v<q;v+=4)z=f[v+2],a.scale(z,w,z),a.transformQuat(z,l,z),d[m+v]=z[0],d[m+v+1]=z[1],d[m+v+2]=z[2],d[m+v+3]=f[v+3];return d}}(),M=function(){var b=p.create();return function(c,a,f,l){l|=0;a=A(a,b);u._38(c,a,f,l);return f}}(),F=
function(){var b=a.create(),c=a.create(),f=p.create();return function(l,d,m){var q=k(l,b),w=I(l,c),z=A(l,f);d=a.multiply(d,w,c);a.transformQuat(d,z,d);a.add(q,d,q);V(l,m);n(q,m);return m}}(),U=function(){var b=a.create(),c=a.create(),f=p.create(),l=p.create();return function(m,z,q,w){var v=k(m,b),B=k(z,c),D=a.lerp(v,B,q,b);n(D,w);I(m,b);I(z,c);v=a.lerp(v,B,q,b);y(v,w);m=A(m,f);z=A(z,l);q=p.slerp(m,z,q,f);d(q,w);return w}}();(function(){var b=a.create(),c=a.create(),f=p.create(),l=p.create();return function(a,
m,q,w){var z=k(a,b),v=k(m,c);b[0]=v[0]*(q+1)-z[0]*q;b[1]=v[1]*(q+1)-z[1]*q;b[2]=v[2]*(q+1)-z[2]*q;n(b,w);z=I(a,b);v=I(m,c);b[0]=v[0]*(q+1)-z[0]*q;b[1]=v[1]*(q+1)-z[1]*q;b[2]=v[2]*(q+1)-z[2]*q;y(b,w);a=A(a,f);m=A(m,l);f[0]=m[0]*(q+1)-a[0]*q;f[1]=m[1]*(q+1)-a[1]*q;f[2]=m[2]*(q+1)-a[2]*q;f[3]=m[3]*(q+1)-a[3]*q;p.normalize(f,f);d(f,w);return w}})();var K=function(){var b=a.create();a.create();var c=p.create(),f=p.create();return function(a,l,m,q,w){var z=k(a,b);z[0]+=l*m[0];z[1]+=l*m[1];z[2]+=l*m[2];
n(z,w);m=I(a,b);y(m,w);a=A(a,c);m=q[0];z=q[1];q=q[2];f[0]=.5*(m*a[3]+z*a[2]-q*a[1]);f[1]=.5*(z*a[3]+q*a[0]-m*a[2]);f[2]=.5*(q*a[3]+m*a[1]-z*a[0]);f[3]=.5*(-m*a[0]-z*a[1]-q*a[2]);a[0]+=f[0]*l;a[1]+=f[1]*l;a[2]+=f[2]*l;a[3]+=f[3]*l;p.normalize(a,a);d(a,w);return w}}();(function(){var b=a.create(),c=a.create(),f=p.create(),m=p.create();return function(a,z){var q=k(a,b);n(q,z);q=I(a,c);y(q,z);q=A(a,f);m[0]=q[0]*l+q[3]*B;m[1]=q[1]*l+q[2]*B;m[2]=q[2]*l-q[1]*B;m[3]=q[3]*l-q[0]*B;d(m,z);return z}})();(function(){var b=
a.create(),c=p.create();return function(a,f){var l=k(a,b);l[0]=l[0];l[1]=-l[2];l[2]=l[1];n(l,f);l=I(a,b);y(l,f);l=A(a,c);l[0]=l[0];l[1]=-l[1];l[2]=l[2];l[3]=l[3];d(l,f);return f}})()},function(C,t,e){function R(){var a=new p(4);a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a}function V(a,l,c){c[0]=a[0]-l[0];c[1]=a[1]-l[1];c[2]=a[2]-l[2];c[3]=a[3]-l[3];return c}function n(a,l,c){c[0]=a[0]*l[0];c[1]=a[1]*l[1];c[2]=a[2]*l[2];c[3]=a[3]*l[3];return c}function y(a,l,c){c[0]=a[0]/l[0];c[1]=a[1]/l[1];c[2]=a[2]/l[2];
c[3]=a[3]/l[3];return c}function d(a,l){var c=l[0]-a[0],d=l[1]-a[1],b=l[2]-a[2],f=l[3]-a[3];return Math.sqrt(c*c+d*d+b*b+f*f)}function k(a,l){var c=l[0]-a[0],d=l[1]-a[1],b=l[2]-a[2],f=l[3]-a[3];return c*c+d*d+b*b+f*f}function I(a){var l=a[0],c=a[1],d=a[2];a=a[3];return Math.sqrt(l*l+c*c+d*d+a*a)}function A(a){var l=a[0],c=a[1],d=a[2];a=a[3];return l*l+c*c+d*d+a*a}function r(a,l){var c=a[0],d=a[1],b=a[2],f=a[3],k=c*c+d*d+b*b+f*f;0<k&&(k=1/Math.sqrt(k),l[0]=c*k,l[1]=d*k,l[2]=b*k,l[3]=f*k);return l}
Object.defineProperty(t,"__esModule",{value:!0});t.create=R;t.clone=function(a){var l=new p(4);l[0]=a[0];l[1]=a[1];l[2]=a[2];l[3]=a[3];return l};t.fromValues=function(a,l,c,d){var b=new p(4);b[0]=a;b[1]=l;b[2]=c;b[3]=d;return b};t.copy=function(a,l){l[0]=a[0];l[1]=a[1];l[2]=a[2];l[3]=a[3];return l};t.set=function(a,l,c,d,b){b[0]=a;b[1]=l;b[2]=c;b[3]=d;return b};t.add=function(a,l,c){c[0]=a[0]+l[0];c[1]=a[1]+l[1];c[2]=a[2]+l[2];c[3]=a[3]+l[3];return c};t.subtract=V;e.d(t,"sub",function(){return V});
t.multiply=n;e.d(t,"mul",function(){return n});t.divide=y;e.d(t,"div",function(){return y});t.min=function(a,l,c){c[0]=Math.min(a[0],l[0]);c[1]=Math.min(a[1],l[1]);c[2]=Math.min(a[2],l[2]);c[3]=Math.min(a[3],l[3]);return c};t.max=function(a,l,c){c[0]=Math.max(a[0],l[0]);c[1]=Math.max(a[1],l[1]);c[2]=Math.max(a[2],l[2]);c[3]=Math.max(a[3],l[3]);return c};t.scale=function(a,l,c){c[0]=a[0]*l;c[1]=a[1]*l;c[2]=a[2]*l;c[3]=a[3]*l;return c};t.scaleAndAdd=function(a,l,c,d){d[0]=a[0]+l[0]*c;d[1]=a[1]+l[1]*
c;d[2]=a[2]+l[2]*c;d[3]=a[3]+l[3]*c;return d};t.distance=d;e.d(t,"dist",function(){return d});t.squaredDistance=k;e.d(t,"sqrDist",function(){return k});t.length=I;e.d(t,"len",function(){return I});t.squaredLength=A;e.d(t,"sqrLen",function(){return A});t.negate=function(a,l){l[0]=-a[0];l[1]=-a[1];l[2]=-a[2];l[3]=-a[3];return l};t.inverse=function(a,l){l[0]=1/a[0];l[1]=1/a[1];l[2]=1/a[2];l[3]=1/a[3];return l};t.normalize=r;t.dot=function(a,l){return a[0]*l[0]+a[1]*l[1]+a[2]*l[2]+a[3]*l[3]};t.lerp=function(a,
l,c,d){var b=a[0],f=a[1],m=a[2];a=a[3];d[0]=b+c*(l[0]-b);d[1]=f+c*(l[1]-f);d[2]=m+c*(l[2]-m);d[3]=a+c*(l[3]-a);return d};t.random=function(a,l){l[0]=u();l[1]=u();l[2]=u();l[3]=u();r(l,l);a(l,a,l);return l};t.transformMat4=function(a,l,c){var d=a[0],b=a[1],f=a[2];a=a[3];c[0]=l[0]*d+l[4]*b+l[8]*f+l[12]*a;c[1]=l[1]*d+l[5]*b+l[9]*f+l[13]*a;c[2]=l[2]*d+l[6]*b+l[10]*f+l[14]*a;c[3]=l[3]*d+l[7]*b+l[11]*f+l[15]*a;return c};t.transformQuat=function(a,l,c){var d=a[0],b=a[1],f=a[2],k=l[0],e=l[1],z=l[2];l=l[3];
var p=l*d+e*f-z*b,r=l*b+z*d-k*f,B=l*f+k*b-e*d,d=-k*d-e*b-z*f;c[0]=p*l+d*-k+r*-z-B*-e;c[1]=r*l+d*-e+B*-k-p*-z;c[2]=B*l+d*-z+p*-e-r*-k;c[3]=a[3];return c};e.d(t,"forEach",function(){return a});t.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};var p="undefined"!==typeof Float32Array?Float32Array:Array,u=Math.random,a=function(){var a=R();return function(l,c,d,b,f,k){c||(c=4);d||(d=0);for(b=b?Math.min(b*c+d,l.length):l.length;d<b;d+=c)a[0]=l[d],a[1]=l[d+1],a[2]=l[d+2],a[3]=l[d+3],
f(a,k,a),l[d]=a[0],l[d+1]=a[1],l[d+2]=a[2],l[d+3]=a[3];return l}}()},function(C,t,e){function R(){var a=new r(4);a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a}function V(a,d,c){d*=.5;var l=Math.sin(d);c[0]=l*a[0];c[1]=l*a[1];c[2]=l*a[2];c[3]=Math.cos(d);return c}function n(a,d,c){var l=a[0],b=a[1],f=a[2];a=a[3];var k=d[0],e=d[1],z=d[2];d=d[3];c[0]=l*d+a*k+b*z-f*e;c[1]=b*d+a*e+f*k-l*z;c[2]=f*d+a*z+l*e-b*k;c[3]=a*d-l*k-b*e-f*z;return c}function y(a,d,c,m){var b=a[0],f=a[1],l=a[2];a=a[3];var k=d[0],z=d[1],e=
d[2];d=d[3];var p,r,B;r=b*k+f*z+l*e+a*d;0>r&&(r=-r,k=-k,z=-z,e=-e,d=-d);1E-6<1-r?(p=Math.acos(r),B=Math.sin(p),r=Math.sin((1-c)*p)/B,c=Math.sin(c*p)/B):r=1-c;m[0]=r*b+c*k;m[1]=r*f+c*z;m[2]=r*l+c*e;m[3]=r*a+c*d;return m}function d(a,d){var c=a[0]+a[4]+a[8];if(0<c)c=Math.sqrt(c+1),d[3]=.5*c,c=.5/c,d[0]=(a[5]-a[7])*c,d[1]=(a[6]-a[2])*c,d[2]=(a[1]-a[3])*c;else{var l=0;a[4]>a[0]&&(l=1);a[8]>a[3*l+l]&&(l=2);var b=(l+1)%3,f=(l+2)%3,c=Math.sqrt(a[3*l+l]-a[3*b+b]-a[3*f+f]+1);d[l]=.5*c;c=.5/c;d[3]=(a[3*b+f]-
a[3*f+b])*c;d[b]=(a[3*b+l]+a[3*l+b])*c;d[f]=(a[3*f+l]+a[3*l+f])*c}return d}Object.defineProperty(t,"__esModule",{value:!0});t.create=R;e.d(t,"rotationTo",function(){return p});e.d(t,"setAxes",function(){return u});t.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};t.setAxisAngle=V;t.multiply=n;e.d(t,"mul",function(){return n});t.rotateX=function(a,d,c){d*=.5;var l=a[0],b=a[1],f=a[2];a=a[3];var k=Math.sin(d);d=Math.cos(d);c[0]=l*d+a*k;c[1]=b*d+f*k;c[2]=f*d-b*k;c[3]=a*d-l*k;return c};t.rotateY=
function(a,d,c){d*=.5;var l=a[0],b=a[1],f=a[2];a=a[3];var k=Math.sin(d);d=Math.cos(d);c[0]=l*d-f*k;c[1]=b*d+a*k;c[2]=f*d+l*k;c[3]=a*d-b*k;return c};t.rotateZ=function(a,d,c){d*=.5;var l=a[0],b=a[1],f=a[2];a=a[3];var k=Math.sin(d);d=Math.cos(d);c[0]=l*d+b*k;c[1]=b*d-l*k;c[2]=f*d+a*k;c[3]=a*d-f*k;return c};t.calculateW=function(a,d){var c=a[0],l=a[1],b=a[2];d[0]=c;d[1]=l;d[2]=b;d[3]=Math.sqrt(Math.abs(1-c*c-l*l-b*b));return d};t.slerp=y;e.d(t,"sqlerp",function(){return a});t.invert=function(a,d){var c=
a[0],l=a[1],b=a[2],f=a[3],k=c*c+l*l+b*b+f*f,k=k?1/k:0;d[0]=-c*k;d[1]=-l*k;d[2]=-b*k;d[3]=f*k;return d};t.conjugate=function(a,d){d[0]=-a[0];d[1]=-a[1];d[2]=-a[2];d[3]=a[3];return d};t.fromMat3=d;t.str=function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};var k=e(3),I=e(7),A=e(27);e.d(t,"clone",function(){return I.clone});e.d(t,"fromValues",function(){return I.fromValues});e.d(t,"copy",function(){return I.copy});e.d(t,"set",function(){return I.set});e.d(t,"add",function(){return I.add});
e.d(t,"scale",function(){return I.scale});e.d(t,"dot",function(){return I.dot});e.d(t,"lerp",function(){return I.lerp});e.d(t,"length",function(){return I.length});e.d(t,"len",function(){return I.length});e.d(t,"squaredLength",function(){return I.squaredLength});e.d(t,"sqrLen",function(){return I.squaredLength});e.d(t,"normalize",function(){return I.normalize});var r="undefined"!==typeof Float32Array?Float32Array:Array,p=function(){var a=k.create(),d=k.fromValues(1,0,0),c=k.fromValues(0,1,0);return function(l,
b,f){var m=k.dot(l,b);if(-.9999999>m)return k.cross(d,l,a),1E-6>k.length(a)&&k.cross(c,l,a),k.normalize(a,a),V(a,Math.PI,f),f;if(.9999999<m)return f[0]=0,f[1]=0,f[2]=0,f[3]=1,f;k.cross(l,b,a);f[0]=a[0];f[1]=a[1];f[2]=a[2];f[3]=1+m;return I.normalize(f,f)}}(),u=function(){var a=A.create();return function(l,c,m,b){a[0]=c[0];a[3]=c[1];a[6]=c[2];a[1]=m[0];a[4]=m[1];a[7]=m[2];a[2]=-l[0];a[5]=-l[1];a[8]=-l[2];return I.normalize(d(a,b),b)}}(),a=function(){var a=R(),d=R();return function(c,l,b,f,k,e){y(c,
f,k,a);y(l,b,k,d);y(a,d,2*k*(1-k),e);return e}}()},function(C,t,e){C=e(0);var R=e(25),V=e(4),n=e(6),y=e(2),d=e(3),k=e(7);e=Object(C.a)("__obj_util",function(e,A){function r(a){a={type:a,data_id:0,world_tsr:n.c(),world_tsr_inv:n.c(),pivot:new Float32Array(3),hover_pivot:new Float32Array(3),init_dist:0,init_fov:0,is_copied:!1,is_copied_deep:!1,color_id:null,outline_intensity:0,target_cam_upside_down:!1,vertical_axis:d.create(),use_panning:!1,move_style:0,velocity_trans:1,velocity_rot:1,velocity_zoom:1,
dof_distance:0,dof_front_start:0,dof_front_end:0,dof_rear_start:0,dof_rear_end:0,dof_power:0,dof_bokeh_intensity:0,dof_bokeh:!1,dof_foreground_blur:!1,dof_object:null,horizontal_limits:null,vertical_limits:null,distance_limits:null,hover_vert_trans_limits:null,hover_horiz_trans_limits:null,pivot_limits:null,enable_hover_hor_rotation:!0,outline_anim_settings_default:{outline_duration:1,outline_period:1,outline_relapses:0},cube_reflection_id:-1,plane_reflection_id:-1,reflection_plane:new Float32Array(4),
friction:0,elasticity:0,is_lod:!1,lod_center:new Float32Array(3),main_lod_offset:new Float32Array(3),lod_dist_min:0,lod_dist_max:Infinity,lod_lower_border_range:0,lod_upper_border_range:0,do_not_render:!1,shadow_cast:!1,shadow_receive:!1,shadow_cast_only:!1,reflexible:!1,reflexible_only:!1,reflective:!1,reflection_type:"",wind_bending:!1,dynamic_geometry:!1,dynamic_grass:!1,hide:!1,hide_children:!1,selectable:!1,origin_selectable:!1,outlining:!1,origin_outlining:!1,outline_on_select:!1,is_hair_particles:!1,
is_visible:!1,force_zsort:!1,wind_bending_angle:0,wind_bending_amp:0,wind_bending_freq:0,detail_bending_freq:0,detail_bending_amp:0,branch_bending_amp:0,main_bend_col:"",detail_bend_col:{leaves_stiffness:"",leaves_phase:"",overall_stiffness:""},bend_center_only:!1,center_pos:new Float32Array(3),billboard:!1,billboard_pres_glob_orientation:!1,billboard_type:"",billboard_spherical:!1,frame_factor:0,va_frame:0,va_frame_factor:0,max_bones:0,frames_blending:!1,vertex_anim:!1,use_shape_keys:!1,shape_keys_values:[],
is_skinning:!1,anim_mixing:!1,anim_mix_factor:1,anim_mix_factor_change_speed:0,anim_destination_mix_factor:1,anim_mix_cb:null,mix_with_current:!1,blend_skel_slots:new Int8Array([-1,-1]),skinned_renders:[],mesh_to_arm_bone_maps:[],skinning_data_cache:[],quats_before:null,quats_after:null,trans_before:null,trans_after:null,trans_curr:null,quats_curr:null,bone_pointers:null,bone_skinning_info:null,pose_data:null,arm_rel_trans:null,arm_rel_quat:null,bb_original:R.w(),bb_local:R.w(),bb_world:R.w(),bs_local:R.A(),
bs_world:R.A(),be_local:R.y(),be_world:R.y(),bbr_local:R.C(),bbr_world:R.C(),bcyl_local:R.K(),bcap_local:R.I(),bcon_local:R.J(),pass_index:0};d.copy(y.f,a.vertical_axis);return a}function p(a){return{scene:a,is_active:!1,batches:[],batch_world_bounds:[],plane_refl_subs:[],cube_refl_subs:null,shadow_subscenes:[],light_index:0,obj_has_nla_on_scene:!1,cameras:[],shadow_cameras:[]}}function u(a){if(!(a instanceof Object))return a;var b=null,c=null,f=null,d=null,l=null,m=null;a.textures&&(b=a.textures,
a.textures=null);a.texture_names&&(c=a.texture_names,a.texture_names=null);a.bpy_tex_names&&(f=a.bpy_tex_names,a.bpy_tex_names=null);a.shape_keys&&(d=a.shape_keys,a.shape_keys=null);a.shader&&(l=a.shader,a.shader=null);a.vaos&&(m=a.vaos,a.vaos=null);var k;k=a.constructor;switch(k){case Int8Array:case Uint8Array:case Uint8ClampedArray:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:k=new k(a);break;case Array:k=new k(a.length);for(var z=0;z<a.length;z++)k[z]=
u(a[z]);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:k=a;break;case WebGLFramebuffer:case WebGLRenderbuffer:case WebGLTexture:case WebGLBuffer:k=null;break;case Function:k=a;break;default:for(z in k=new k,a)k[z]=u(a[z])}b&&(k.textures=b,a.textures=b);c&&(k.texture_names=c,a.texture_names=c);f&&(k.bpy_tex_names=f,a.bpy_tex_names=f);d&&(k.shape_keys=d,a.shape_keys=d);l&&(k.shader=l,a.shader=l);m&&(k.vaos=y.S(),a.vaos=m);return k}function a(a,b){R.o(b,a.bb_local);R.h(a.bb_local,
a.world_tsr,a.bb_world)}function B(a,b,c){a.bs_local=R.l(b,c);R.k(a.bs_local,a.world_tsr,a.bs_world)}function l(a,b,c,f,l,m){a.be_local=R.e(b,c,f,m);d.scale(a.be_local.axis_x,l[0],a.be_local.axis_x);d.scale(a.be_local.axis_y,l[1],a.be_local.axis_y);d.scale(a.be_local.axis_z,l[2],a.be_local.axis_z);R.i(a.be_local,a.world_tsr,a.be_world)}function c(a,b,c,f){a.bcyl_local=R.d(b,f);a.bcap_local=R.b(c,f);a.bcon_local=R.c(b,f)}function m(a,b,c,f,d,l){a.bbr_local=R.O(l,b,c,f,d);R.j(a.bbr_local,a.world_tsr,
a.bbr_world)}function b(a,b,c){R.h(a.bounds_local.bb,b,c.bb);a.use_be&&R.i(a.bounds_local.be,b,c.be);R.k(a.bounds_local.bs,b,c.bs)}function f(a,b){for(var c=a.scenes_data,f=0;f<c.length;f++){var d=c[f];if(d.scene==b)return d}return null}function I(a){return a.parent_is_dupli?a.parent:a.parent?I(a.parent):null}var fa=Object(V.a)(e).defaults;A.LOD_DIST_MAX_INFINITY=Infinity;A.create_render=r;A.clone_render=function(a){var b=r(a.type);b.data_id=a.data_id;n.a(a.world_tsr,b.world_tsr);n.a(a.world_tsr_inv,
b.world_tsr_inv);d.copy(a.pivot,b.pivot);d.copy(a.hover_pivot,b.hover_pivot);b.init_dist=a.init_dist;b.init_fov=a.init_fov;b.is_copied=a.is_copied;b.is_copied_deep=a.is_copied_deep;a.color_id&&(b.color_id=d.clone(a.color_id));b.outline_intensity=a.outline_intensity;b.target_cam_upside_down=a.target_cam_upside_down;d.copy(a.vertical_axis,b.vertical_axis);b.use_panning=a.use_panning;b.move_style=a.move_style;b.velocity_trans=a.velocity_trans;b.velocity_rot=a.velocity_rot;b.velocity_zoom=a.velocity_zoom;
b.dof_distance=a.dof_distance;b.dof_front_start=a.dof_front_start;b.dof_front_end=a.dof_front_end;b.dof_rear_start=a.dof_rear_start;b.dof_rear_end=a.dof_rear_end;b.dof_power=a.dof_power;b.dof_bokeh_intensity=a.dof_bokeh_intensity;b.dof_bokeh=a.dof_bokeh;b.dof_foreground_blur=a.dof_foreground_blur;b.dof_object=a.dof_object;b.horizontal_limits=y.O(a.horizontal_limits);b.vertical_limits=y.O(a.vertical_limits);b.distance_limits=y.O(a.distance_limits);b.hover_vert_trans_limits=y.O(a.hover_vert_trans_limits);
b.hover_horiz_trans_limits=y.O(a.hover_horiz_trans_limits);b.pivot_limits=a.pivot_limits;b.enable_hover_hor_rotation=a.enable_hover_hor_rotation;b.outline_anim_settings_default.outline_duration=a.outline_anim_settings_default.outline_duration;b.outline_anim_settings_default.outline_period=a.outline_anim_settings_default.outline_period;b.outline_anim_settings_default.outline_relapses=a.outline_anim_settings_default.outline_relapses;b.cube_reflection_id=a.cube_reflection_id;b.plane_reflection_id=a.plane_reflection_id;
b.reflection_plane=a.reflection_plane;b.friction=a.friction;b.elasticity=a.elasticity;b.is_lod=a.is_lod;d.copy(a.lod_center,b.lod_center);d.copy(a.main_lod_offset,b.main_lod_offset);b.lod_dist_min=a.lod_dist_min;b.lod_dist_max=a.lod_dist_max;b.lod_lower_border_range=a.lod_lower_border_range;b.lod_upper_border_range=a.lod_upper_border_range;b.do_not_render=a.do_not_render;b.shadow_cast=a.shadow_cast;b.shadow_receive=a.shadow_receive;b.shadow_cast_only=a.shadow_cast_only;b.reflexible=a.reflexible;b.reflexible_only=
a.reflexible_only;b.reflective=a.reflective;b.reflection_type=a.reflection_type;b.wind_bending=a.wind_bending;b.dynamic_geometry=a.dynamic_geometry;b.dynamic_grass=a.dynamic_grass;b.hide=a.hide;b.selectable=a.selectable;b.origin_selectable=a.origin_selectable;b.outlining=a.outlining;b.origin_outlining=a.origin_outlining;b.outline_on_select=a.outline_on_select;b.is_hair_particles=a.is_hair_particles;b.is_visible=a.is_visible;b.force_zsort=a.force_zsort;b.wind_bending_angle=a.wind_bending_angle;b.wind_bending_amp=
a.wind_bending_amp;b.wind_bending_freq=a.wind_bending_freq;b.detail_bending_freq=a.detail_bending_freq;b.detail_bending_amp=a.detail_bending_amp;b.branch_bending_amp=a.branch_bending_amp;b.main_bend_col=a.main_bend_col;b.detail_bend_col=a.detail_bend_col;b.bend_center_only=a.bend_center_only;d.copy(a.center_pos,b.center_pos);b.billboard=a.billboard;b.billboard_pres_glob_orientation=a.billboard_pres_glob_orientation;b.billboard_type=a.billboard_type;b.billboard_spherical=a.billboard_spherical;b.frame_factor=
a.frame_factor;b.va_frame=a.va_frame;b.va_frame_factor=a.va_frame_factor;b.max_bones=a.max_bones;b.frames_blending=a.frames_blending;b.vertex_anim=a.vertex_anim;b.use_shape_keys=a.use_shape_keys;b.shape_keys_values=y.O(a.shape_keys_values);b.is_skinning=a.is_skinning;b.anim_mixing=a.anim_mixing;b.anim_mix_factor=a.anim_mix_factor;b.anim_mix_factor_change_speed=a.anim_mix_factor_change_speed;b.anim_destination_mix_factor=a.anim_destination_mix_factor;b.blend_skel_slots.set(a.blend_skel_slots);b.skinned_renders=
y.O(a.skinned_renders);b.mesh_to_arm_bone_maps=y.O(a.mesh_to_arm_bone_maps);b.skinning_data_cache=y.O(a.skinning_data_cache);b.quats_before=y.O(a.quats_before);b.quats_after=y.O(a.quats_after);b.trans_before=y.O(a.trans_before);b.trans_after=y.O(a.trans_after);b.bone_pointers=y.O(a.bone_pointers);b.bone_skinning_info=y.O(a.bone_skinning_info);b.pose_data=y.O(a.pose_data);b.arm_rel_trans=y.O(a.arm_rel_trans);b.arm_rel_quat=y.O(a.arm_rel_quat);R.o(a.bb_original,b.bb_original);R.o(a.bb_local,b.bb_local);
R.o(a.bb_world,b.bb_world);R.u(a.bs_local,b.bs_local);R.u(a.bs_world,b.bs_world);R.s(a.be_local,b.be_local);R.s(a.be_world,b.be_world);R.p(a.bcap_local,b.bcap_local);R.r(a.bcyl_local,b.bcyl_local);R.q(a.bcon_local,b.bcon_local);b.pass_index=a.pass_index;return b};A.create_object=function(a,b,c){c||(c=a);return{name:a,uuid:y._4(),origin_name:c,type:b,materials:[],is_meta:!0,_bpy_obj:null,mat_inheritance_data:{original_mat_names:[],is_disabled:[]},is_dynamic:!1,is_hair_dupli:!1,use_default_animation:!1,
is_boundings_overridden:!1,render:null,constraint:null,sfx:null,light:null,armobj:null,anchor:null,field:null,metatags:null,custom_prop:null,scenes_data:[],vertex_anim:[],cons_descends:y.S(),cons_armat_bone_descends:y.S(),anim_slots:[],reflective_objs:[],nla_events:[],action_anim_cache:[],sensor_manifolds:null,sensor_manifolds_arr:[],parent:null,parent_is_dupli:!1,parent_bone:"",viewport_alignment:null,pinverse_tsr:null,use_obj_physics:!1,collision_id:"",correct_bounding_offset:"AUTO",is_vehicle:!1,
is_character:!1,is_floating:!1,bob_synchronize_pos:!1,physics:null,vehicle:null,floater:null,vehicle_settings:null,floating_settings:null,character_settings:null,physics_constraints:[],physics_settings:{physics_type:"NO_COLLISION",use_ghost:!1,use_sleep:!1,mass:0,velocity_min:0,velocity_max:0,damping:0,rotation_damping:0,lock_location_x:!1,lock_location_y:!1,lock_location_z:!1,lock_rotation_x:!1,lock_rotation_y:!1,lock_rotation_z:!1,collision_margin:0,collision_group:0,collision_mask:0,use_collision_bounds:!1,
collision_bounds_type:"BOX",use_collision_compound:!1},outline_animation:{time_start:0,outline_time:0,period:0,relapses:0},anim_behavior_def:0,def_action_slots:[],need_update_transform:!1,need_inv_zup_tsr:!1,meta_objects:[]}};A.init_scene_data=p;A.copy_bpy_object_props_by_link=function(a){return a instanceof Array?a.slice():a};A.copy_object_props_by_value=u;A.is_dynamic=function(a){return a.is_dynamic};A.is_dynamic_mesh=function(a){return"MESH"==a.type&&a.is_dynamic};A.append_scene_data=function(a,
b){var c=p(b);a.scenes_data.push(c)};A.append_batch=function(a,c,d){var l=a.render;a=f(a,c);a.batches.push(d);c=R.L();b(d,l.world_tsr,c);a.batch_world_bounds.push(c)};A.update_render_bounds_billboard=function(b,f){var d=b.render,k=Math.max(Math.abs(f.max_x),Math.abs(f.min_x)),e=Math.max(Math.abs(f.max_y),Math.abs(f.min_y)),z=Math.max(Math.abs(f.max_z),Math.abs(f.min_z)),z=Math.sqrt(k*k+e*e+z*z),k=Math.sqrt(k*k+e*e),e=R.w();e.max_x=e.max_y=e.max_z=z;e.min_x=e.min_y=e.min_z=-z;a(d,e);B(d,z,[0,0,0]);
l(d,[1,0,0],[0,1,0],[0,0,1],[z,z,z],[0,0,0]);b.is_dynamic?c(d,k,k,e):m(d,[1,0,0],[0,1,0],[0,0,1],[z,z,z],[0,0,0])};A.update_render_bounds_from_bpy=function(b,f,d){var k=b.render,e=d.bs_rad,z=d.bc_rad,p=d.bs_cen,r=d.be_cen,n=d.caxis_x,v=d.caxis_y,Y=d.caxis_z,E=d.be_ax,S=d.rbb.rbb_c;d=d.rbb.rbb_s;a(k,f);B(k,e,p);f=b.is_dynamic;l(k,f?n:[1,0,0],f?v:[0,1,0],f?Y:[0,0,1],E,r);b.is_dynamic?c(k,z,z,k.bb_local):m(k,n,v,Y,d,S)};A.update_render_bounds_from_pos_arrays=function(b,f,d){for(var k=b.render,e=f.max_x-
f.min_x,z=f.max_y-f.min_y,p=f.max_z-f.min_z,r=(f.max_x+f.min_x)/2,n=(f.max_y+f.min_y)/2,v=(f.max_z+f.min_z)/2,Y=r,E=n,S=Math.max(e,Math.max(z,p))/2,L=Math.max(e,z)/2,q=[r/(e?e:1),n/(z?z:1),v/(p?p:1)],w=.5,ea=0;ea<d.length;ea++)for(var H=d[ea],D=0;D<H.length;D+=3){var h=H[D],u=H[D+1],G=H[D+2],A=Math.sqrt((r-h)*(r-h)+(n-u)*(n-u)+(v-G)*(v-G));if(A>S)var I=r-S*(h-r)/A,T=n-S*(u-n)/A,A=v-S*(G-v)/A,r=(I+h)/2,n=(T+u)/2,v=(A+G)/2,S=Math.sqrt((r-h)*(r-h)+(n-u)*(n-u)+(v-G)*(v-G));T=Math.sqrt((Y-h)*(Y-h)+(E-
u)*(E-u));T>L&&(I=Y-L*(h-Y)/T,T=E-L*(u-E)/T,Y=(I+h)/2,E=(T+u)/2,L=Math.sqrt((Y-h)*(Y-h)+(E-u)*(E-u)));h/=e?e:1;u/=z?z:1;G/=p?p:1;A=Math.sqrt((q[0]-h)*(q[0]-h)+(q[1]-u)*(q[1]-u)+(q[2]-G)*(q[2]-G));A>w&&(I=q[0]-w*(h-q[0])/A,T=q[1]-w*(u-q[1])/A,A=q[2]-w*(G-q[2])/A,q[0]=(I+h)/2,q[1]=(T+u)/2,q[2]=(A+G)/2,w=Math.sqrt((q[0]-h)*(q[0]-h)+(q[1]-u)*(q[1]-u)+(q[2]-G)*(q[2]-G)))}d=e?e*q[0]:f.max_x;Y=z?z*q[1]:f.max_y;q=p?p*q[2]:f.max_z;e*=w;z*=w;p*=w;a(k,f);B(k,S,[r,n,v]);l(k,[1,0,0],[0,1,0],[0,0,1],[e,z,p],[d,
Y,q]);b.is_dynamic?c(k,L,L,k.bb_local):m(k,[(k.bb_local.max_x-k.bb_local.min_x)/2,0,0],[0,(k.bb_local.max_y-k.bb_local.min_y)/2,0],[0,0,(k.bb_local.max_z-k.bb_local.min_z)/2],[1,1,1],[(k.bb_local.max_x+k.bb_local.min_x)/2,(k.bb_local.max_y+k.bb_local.min_y)/2,(k.bb_local.max_z+k.bb_local.min_z)/2])};A.update_world_bounds_from_batch_tsr=b;A.remove_scene_data=function(a,b){for(var c=a.scenes_data,f=0;f<c.length;f++)if(c[f].scene==b){c.splice(f,1);break}};A.get_scene_data=f;A.update_refl_objects=function(a,
b){for(var c=0;c<a.length;c++)k.copy(b,a[c].render.reflection_plane)};A.scene_data_set_active=function(a,b,c){for(var f=0;f<a.scenes_data.length;f++){var d=a.scenes_data[f];c&&d.scene!=c||(d.is_active=b)}};A.scene_data_remove_batch=function(a,b){a.batches.splice(b,1);a.batch_world_bounds.splice(b,1)};A.get_shadow_lamps=function(a,b){for(var c=[],f=b?fa.max_cast_lamps-1:fa.max_cast_lamps,d=0;d<a.length;d++){var l=a[d];l.light.generate_shadows&&c.length<f&&c.push(l)}return c.length?c:a[0]?[a[0]]:[]};
A.meta_obj_append_render=function(a,b){n.m(b.world_tsr);b.color_id=null;a.render=b};A.check_obj_soft_particles_accessibility=function(a,b){if(b.b4w_enable_soft_particles&&0<b.b4w_particles_softness){var c=b.material-1,f=a.materials;if(0<=c&&c<f.length&&("ADD"==f[c].blend_mode||"ALPHA"==f[c].blend_mode||"ALPHA_SORT"==f[c].blend_mode))return!0}return!1};A.check_inv_zup_tsr_is_needed=function(a){a=a.scenes_data;for(var b=0;b<a.length;b++)for(var c=a[b].batches,f=0;f<c.length;f++)for(var d=c[f].shaders_info.directives,
l=0;l<d.length;l++){var m=d[l];if("USE_MODEL_TSR_INVERSE"==m[0]&&"1"==m[1])return!0}return!1};A.gen_dupli_name=function(a,b){return a+"*"+b};A.get_parent=function(a){return a.parent_is_dupli?null:a.parent};A.get_dg_parent=I;A.get_dg_objects=function(a,b){for(var c=[],f=0;f<b.length;f++){var d=b[f];I(d)==a&&c.push(d)}return c};A.get_object_data_id=function(a){return a.render.data_id};A.is_mesh=function(a){return"MESH"===a.type};A.is_armature=function(a){return"ARMATURE"===a.type};A.is_speaker=function(a){return"SPEAKER"===
a.type};A.is_camera=function(a){return"CAMERA"===a.type};A.is_lamp=function(a){return"LAMP"===a.type};A.is_empty=function(a){return"EMPTY"===a.type};A.is_line=function(a){return"LINE"===a.type};A.is_world=function(a){return"WORLD"===a.type}});t.a=e},function(C,t,e){C=e(0);var R=e(5),V=e(16),n=e(25),y=e(14),d=e(4),k=e(15),I=e(46),A=e(31),r=e(51),p=e(39),u=e(21),a=e(61),B=e(12),l=e(17),c=e(9),m=e(90),b=e(63),f=e(1),T=e(8),fa=e(22),z=e(64),G=e(23),E=e(34),J=e(11),M=e(6),F=e(2),U=e(3),K=e(7),sa=e(37);
e=Object(C.a)("__scenes",function(v,e){function Y(){cb||(cb=S(nb));return cb}function S(a){for(var g=0;g<a.length;g++){var b=a[g];if(!b._render_to_textures||!b._render_to_textures.length)return b}return null}function L(){tb||yb.panic("No active scene available");return tb}function q(a,g,b){if(!w(a,g,b))return null;b=a.b4w_shadow_settings;var c={};b.csm_resolution>jb.max_texture_size?(c.csm_resolution=jb.max_texture_size,Bb.error("Shadow map texture has unsupported size. Changed to "+jb.max_texture_size+
".")):c.csm_resolution=b.csm_resolution;db.shadow_blur_samples=db.shadow_blur_samples?db.shadow_blur_samples:b.blur_samples;c.soft_shadows=b.soft_shadows;a=qb.get_shadow_lamps(g,db.ssao&&a.b4w_enable_ssao);c.self_shadow_polygon_offset=b.self_shadow_polygon_offset;c.self_shadow_normal_offset=b.self_shadow_normal_offset;c.enable_csm=b.b4w_enable_csm&&1==a.length;b.b4w_enable_csm&&1<b.csm_num&&1<a.length&&Bb.warn("Disabling Cascaded Shadow Maps because of multiple shadow casting lamps.");c.lamp_types=
[];c.spot_sizes=[];c.clip_start=[];c.clip_end=[];for(g=0;g<a.length;g++)c.lamp_types.push(a[g].light.type),c.spot_sizes.push(a[g].light.spot_size),c.clip_start.push(a[g].light.clip_start),c.clip_end.push(a[g].light.clip_end),"SPOT"!=c.lamp_types[g]&&"POINT"!=c.lamp_types[g]||!c.enable_csm||(Bb.warn("Generating shadows for SPOT or POINT light. Disabling Cascaded Shadow Maps"),c.enable_csm=!1);c.enable_csm?(c.csm_num=b.csm_num,c.csm_first_cascade_border=b.csm_first_cascade_border,c.first_cascade_blur_radius=
b.first_cascade_blur_radius,c.csm_last_cascade_border=b.csm_last_cascade_border,c.last_cascade_blur_radius=b.last_cascade_blur_radius,c.fade_last_cascade=b.fade_last_cascade,c.blend_between_cascades=b.blend_between_cascades):(c.csm_num=1,c.csm_first_cascade_border=b.csm_first_cascade_border,c.first_cascade_blur_radius=b.first_cascade_blur_radius,c.csm_last_cascade_border=b.csm_last_cascade_border,c.last_cascade_blur_radius=b.last_cascade_blur_radius,c.fade_last_cascade=!1,c.blend_between_cascades=
!1);return c}function w(a,g,b){if(0!=g.length&&db.shadows)switch(a.b4w_render_shadows){case "OFF":return!1;case "ON":return!0}else return!1;var c=!1,h=!1;a=db.ssao&&a.b4w_enable_ssao;if(0==g.length&&!a)return!1;for(g=0;g<b.length;g++){var f=b[g];f.b4w_shadow_cast&&(c=!0);f.b4w_shadow_receive&&(h=!0);if((a||c)&&h)return!0}return!1}function ea(a){for(var g=0;g<a.length;g++)if("SUN"==a[g].light.type)return!0;return!1}function H(a){if(!db.shore_smoothing)return!1;a=W(a);for(var g=0;g<a.length;g++){var b=
a[g];if(b.water_settings.is_water&&b.water_settings.shore_smoothing)return!0}return!1}function D(a){for(var g=0;g<a.length;g++)for(var b=a[g].particle_systems,c=0;c<b.length;c++)if(qb.check_obj_soft_particles_accessibility(a[g]._object,b[c].settings))return!0;return!1}function h(a){for(var g=W(a),b=[],c=0;c<g.length;c++){var h=g[c];if(h.water_settings.is_water){for(var f={},N=0;N<a.length;N++)for(var d=a[N],l=d._object.materials,m=0;m<l.length;m++)l[m]==h&&(f.water_level=d.location[2]);f.fog_color_density=
new Float32Array(4);f.fog_color_density.set(h.water_settings.fog_color);f.fog_color_density[3]=h.water_settings.fog_density;h.water_settings.is_dynamic?(f.dynamic=!0,f.waves_height=h.water_settings.waves_height,f.waves_length=h.water_settings.waves_length,f.dst_noise_scale0=h.water_settings.dst_noise_scale0,f.dst_noise_scale1=h.water_settings.dst_noise_scale1,f.dst_noise_freq0=h.water_settings.dst_noise_freq0,f.dst_noise_freq1=h.water_settings.dst_noise_freq1,f.dir_min_shore_fac=h.water_settings.dir_min_shore_fac,
f.dir_freq=h.water_settings.dir_freq,f.dir_noise_scale=h.water_settings.dir_noise_scale,f.dir_noise_freq=h.water_settings.dir_noise_freq,f.dir_min_noise_fac=h.water_settings.dir_min_noise_fac,f.dst_min_fac=h.water_settings.dst_min_fac,f.waves_hor_fac=h.water_settings.waves_hor_fac):(f.dynamic=!1,f.waves_height=0,f.waves_length=0);f.caustics=h.water_settings.enable_caust;f.caustic_scale=h.water_settings.caust_scale;f.caustic_brightness=h.water_settings.caust_brightness;f.caustic_speed=new Float32Array([.3,
.7]);f.shoremap_image=null;h=h.texture_slots;for(N=0;N<h.length;N++)d=h[N].texture,!0===d.b4w_shore_dist_map&&"FILE"==d.image.source&&(f.shoremap_image=d.image,f.shoremap_tex_size=d.image.size[0],f.max_shore_dist=d.b4w_max_shore_dist,d=d.b4w_shore_boundings,f.shoremap_center=[(d[0]+d[1])/2,(d[2]+d[3])/2],f.shoremap_size=[d[0]-d[1],d[2]-d[3]]);b.push(f)}}if(0<b.length){f=b[0];if(!f.dynamic)for(c=0;c<b.length;c++)b[c].dynamic&&(f=b[c]);return f}return null}function ia(a){var g={refractions:!1};a=W(a);
for(var b=function(a,c){if(a)for(var h=a.nodes,f=0;f<h.length;f++){var N=h[f];"GROUP"==N.type&&N.node_group&&b(N.node_group.node_tree,c);"GROUP"==N.type&&"B4W_REFRACTION"==N.node_tree_name&&(g.refractions=!0);"BSDF_TRANSPARENT"==N.type&&(N.b4w_use_alpha?c.blend_mode="ALPHA_SORT":g.refractions=!0);"BSDF_PRINCIPLED"==N.type&&(g.refractions=!0)}},c=0;c<a.length;c++){var h=a[c];h.is_refractive&&(g.refractions=!0);h.node_tree&&b(h.node_tree,h)}return g}function ra(a,g,b){if(db.reflections)switch(a.b4w_render_reflections){case "OFF":return!1}else return!1;
a=[];for(var c=0,h=!1,f=!1,N=!1,d=0;d<g.length;d++){var l=g[d];l.render.reflective&&"CUBE"==l.render.reflection_type&&c++;l.render.reflective&&"PBR"==l.render.reflection_type&&(f=!0);if(l.reflective_objs.length){for(var m=null,k=0;k<a.length;k++)if(a[k]==l){m=k;break}null==m&&a.push(l)}}for(d=0;d<b.length;d++){g=b[d];g.b4w_reflexible&&(h=!0);a:if(g.b4w_reflexible){g=g._object.materials;for(l=0;l<g.length;l++)if(m=g[l].blend_mode,"OPAQUE"!=m&&"CLIP"!=m&&"ALPHA_ANTIALIASING"!=m){g=!0;break a}g=!1}else g=
void 0;g&&(N=!0)}return{refl_plane_objs:a,num_cube_refl:c,cube_refl_subs:[],cube_refl_subs_blend:[],plane_refl_subs:[],plane_refl_subs_blend:[],has_reflexible:h,has_pbr_reflexible:f,has_blend_reflexible:N}}function za(a,g){var b=a.b4w_sky_settings,c={};c.render_sky=b.render_sky||b.procedural_skydome;c.procedural_skydome=b.procedural_skydome;c.use_as_environment_lighting=b.use_as_environment_lighting;c.sky_color=b.color;c.rayleigh_brightness=b.rayleigh_brightness;c.mie_brightness=b.mie_brightness;
c.spot_brightness=b.spot_brightness;c.scatter_strength=b.scatter_strength;c.rayleigh_strength=b.rayleigh_strength;c.mie_strength=b.mie_strength;c.rayleigh_collection_power=b.rayleigh_collection_power;c.mie_collection_power=b.mie_collection_power;c.mie_distribution=b.mie_distribution;c.reflexible=b.reflexible;c.reflexible_only=b.reflexible_only;!g&&b.procedural_skydome&&Bb.warn("There is no sun on the scene. Procedural sky will use a default sun position.");return c}function P(a){var g={};a=a.b4w_ssao_settings;
g.radius_increase=a.radius_increase;g.hemisphere=a.hemisphere;g.blur_depth=a.blur_depth;g.blur_discard_value=a.blur_discard_value;g.influence=a.influence;g.dist_factor=a.dist_factor;g.samples=a.samples;return g}function t(a){if(!db.bloom||!a.b4w_enable_bloom)return null;var g={};a=a.b4w_bloom_settings;g.blur=a.blur;g.edge_lum=a.edge_lum;g.key=a.key;g.adaptive=a.adaptive;g.average_luminance=a.average_luminance;return g}function Q(a){var g={};a=a.b4w_motion_blur_settings;g.mb_decay_threshold=a.motion_blur_decay_threshold;
g.mb_factor=a.motion_blur_factor;return g}function da(a){var g={};a=a.b4w_color_correction_settings;g.brightness=a.brightness;g.contrast=a.contrast;g.exposure=a.exposure;g.saturation=a.saturation;return g}function ja(a){var g={};a=a.b4w_god_rays_settings;g.intensity=a.intensity;g.max_ray_length=a.max_ray_length;g.steps_per_pass=a.steps_per_pass;return g}function va(a){var g={};g.outline_color=a.b4w_outline_color;g.outline_factor=a.b4w_outline_factor;return g}function Ga(a){var g={};a=a.b4w_glow_settings;
g.small_glow_mask_coeff=a.small_glow_mask_coeff;g.large_glow_mask_coeff=a.large_glow_mask_coeff;g.small_glow_mask_width=a.small_glow_mask_width;g.large_glow_mask_width=a.large_glow_mask_width;return g}function ba(a,g){var b=a.light_settings,c={};c.environment_energy=b.environment_energy;c.use_environment_light=b.use_environment_light;c.environment_color=b.environment_color;c.horizon_color=a.horizon_color.slice(0);c.zenith_color=a.zenith_color.slice(0);c.use_sky_paper=a.use_sky_paper;c.use_sky_blend=
a.use_sky_blend;c.use_sky_real=a.use_sky_real;c.sky_texture_slot=null;c.sky_texture_param=null;c.environment_texture_slot=null;c.ngraph_proxy_id="";g.render_sky&&a.use_nodes&&a.node_tree&&(b=Ac.compose_ngraph_proxy(a.node_tree,a.uuid,!1,a.name+"(World)",a.name,"MAIN",null,[]),c.ngraph_proxy_id=b.id);b=!0;if(c.use_environment_light&&"SKY_TEXTURE"==c.environment_color&&(!g.procedural_skydome||!g.use_as_environment_lighting)){for(var h=null,f=0;f<a.texture_slots.length;f++)if(a.texture_slots[f].texture.b4w_use_as_environment_lighting&&
!a.texture_slots[f].texture.b4w_use_as_skydome){h=a.texture_slots[f];break}h?c.environment_texture_slot=h:b=!1}for(f=0;f<a.texture_slots.length;f++)if(a.texture_slots[f].texture.b4w_use_as_skydome){h=a.texture_slots[f];h.texture.image&&(b=!0,c.sky_texture_slot=h,f=Math.min(jb.max_cube_map_texture_size,bb.calc_pot_size(h.texture.image.size[0]/3)),c.sky_texture_param={tex_size:f,blend_factor:h.blend_factor,horizon_factor:h.horizon_factor,zenith_up_factor:h.zenith_up_factor,zenith_down_factor:h.zenith_down_factor,
color:h.color,default_value:h.default_value,invert:h.invert,use_rgb_to_intensity:h.use_rgb_to_intensity,blend_type:h.blend_type,use_map_blend:h.use_map_blend,use_map_horizon:h.use_map_horizon,use_map_zenith_up:h.use_map_zenith_up,use_map_zenith_down:h.use_map_zenith_down});break}c.use_environment_light=c.use_environment_light?b:!1;return c}function Ea(a){var g=a.fog_settings,b={};b.use_fog=g.use_fog;b.intensity=g.intensity;b.depth=g.depth;b.start=g.start;b.height=g.height;b.falloff=g.falloff;b.color=
g.use_custom_color?g.color.slice(0):a.horizon_color.slice(0);a=b.color;b.fog_color_density=new Float32Array([a[0],a[1],a[2],1/b.depth]);b.fog_params=new Float32Array([b.intensity,b.depth,b.start,b.height]);return b}function ta(a,g){if(!db.dynamic_grass)return!1;switch(a.b4w_render_dynamic_grass){case "OFF":return!1;case "ON":return!0}for(var b=!1,c=!1,h=0;h<g.length;h++){for(var f=g[h],N=f._object.materials,d=0;d<N.length;d++)N[d].terrain_settings.is_terrain&&(b=!0);f=f.particle_systems;for(d=0;d<
f.length;d++)N=f[d].settings,"HAIR"==N.type&&N.b4w_dynamic_grass&&(c=!0);if(b&&c)return!0}return!1}function X(a,g){if(Ub.outlining_overview_mode)return!0;if(db.enable_selectable)switch(a.b4w_enable_object_selection){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var b=0;b<g.length;b++)if(g[b]._object.render.selectable)return!0;return!1}else return!1}function pa(a,g){if(Ub.outlining_overview_mode)return!0;if(db.enable_outlining)switch(a.b4w_enable_outlining){case "OFF":return!1;case "ON":return!0;
case "AUTO":for(var b=0;b<g.length;b++)if(g[b]._object.render.outlining)return!0;return!1}else return!1}function ka(a,g){if(db.glow_materials)switch(a.b4w_enable_glow_materials){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var b=0;b<g.length;b++)for(var c=g[b]._object.materials,h=0;h<c.length;h++)if(Ac.check_material_glow_output(c[h]))return!0;return!1}else return!1}function Ca(a,g){if(db.refractions)switch(a.b4w_render_refractions){case "OFF":return!1;case "ON":return!0;case "AUTO":return g.refractions}else return!1}
function C(a){for(var g=0;g<a.length;g++)for(var b=a[g]._object.materials,c=0;c<b.length;c++){var h=b[c];if(h.render_above_all&&"OPAQUE"!=h.blend_mode&&"CLIP"!=h.blend_mode&&"ALPHA_ANTIALIASING"!=h.blend_mode)return!0}return!1}function Aa(a,g){switch(a.b4w_enable_anchors_visibility){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var b=0;b<g.length;b++){var c=g[b]._object;if(c.anchor&&c.anchor.detect_visibility)return!0}return!1}}function xa(a,g){for(var b=Z(a,[aa.MAIN_OPAQUE,aa.MAIN_BLEND,
aa.MAIN_GLOW]),c=0;c<b.length;c++)b[c].bsdf_cube_sky_dim=g}function ga(a,g,b,c,h,f){for(var N=g.render,d=qb.get_scene_data(g,h),l=d.batches,m=0;m<l.length;m++){var k=l[m];if(!(k.shadow_cast_only||k.reflexible_only||"MAIN"!=k.type&&"NODES_GLOW"!=k.type&&"PARTICLES"!=k.type&&"LINE"!=k.type)&&("OPAQUE"==k.subtype&&"OPAQUE"==c||"BLEND"==k.subtype&&"BLEND"==c||"XRAY"==k.subtype&&"XRAY"==c||"NODES_GLOW"==k.type&&"GLOW"==c)){if(!f&&(O(k,a,g,b,c,h),!ua.update_shader(k)))if("DEBUG"===Object(sa.d)())ua.apply_shader(k,
"error.glslv","error.glslf"),ua.update_shader(k);else continue;var la=aa.init_bundle(k,N,d.batch_world_bounds[m]);aa.append_draw_data(a,la);ma(b,a,k,!1);qa(k)}}}function ya(a){a.lod_settings.use_smoothing&&ua.set_batch_directive(a,"USE_LOD_SMOOTHING",1)}function O(a,g,b,c,h,f){var d=b.render,l=f._render,m=qb.get_scene_data(b,f),k="NO_SHADOWS";b=Z(f,[aa.SHADOW_CAST]);if(b.length&&a.shadow_receive){switch(h){case "OPAQUE":k="SHADOW_MAPPING_OPAQUE";break;case "BLEND":case "XRAY":k="SHADOW_MAPPING_BLEND";
break;case "COLOR_ID":case "REFLECT":case "GLOW":k="NO_SHADOWS";break;case "SHADOW":k="SHADOW_MASK_GENERATION";break;default:yb.panic("Wrong subscene type")}for(var la=0;la<b.length;la++)ua.assign_shadow_receive_dirs(a,f._render.shadow_params,b[la])}la="NO_SOFT_SHADOWS";if(l.shadow_params&&l.shadow_params.soft_shadows)switch(db.shadow_blur_samples){case "16x":la="POISSON_X_16";break;case "8x":la="POISSON_X_8";break;case "4x":la="POISSON_X_4"}b=a.shaders_info;Fa.set_directive(b,"SHADOW_USAGE",k);Fa.set_directive(b,
"POISSON_DISK_NUM",la);ya(a);a.dynamic_grass&&(la=Ha.find_subs(c,aa.GRASS_MAP))&&na(a,la,d);wa(b,g.camera);if("SHADOW"!=a.type&&"COLOR_ID"!=h||a.has_nodes){h=g.num_lights;Fa.set_directive(b,"NUM_LIGHTS",h);Fa.set_directive(b,"NUM_LFACTORS",0==h%2?h/2:Math.floor(h/2)+1);Fa.set_directive(b,"REFLECTION_PASS","REFL_PASS_NONE");Fa.set_directive(b,"SSAO_ONLY",0);if(h=l.water_params)Fa.set_directive(b,"WATER_EFFECTS",1),Fa.set_directive(b,"WAVES_HEIGHT",Fa.glsl_value(h.waves_height)),Fa.set_directive(b,
"WAVES_LENGTH",Fa.glsl_value(h.waves_length)),Fa.set_directive(b,"WATER_LEVEL",Fa.glsl_value(h.water_level));if(g.caustics&&a.caustics){Fa.set_directive(b,"CAUSTICS",1);if(la=l.shadow_params){d=la.lamp_types;for(la=k=0;la<d.length;la++)"SUN"==d[la]&&(k=la);Fa.set_directive(b,"SUN_NUM",k)}Fa.set_directive(b,"CAUST_SCALE",Fa.glsl_value(g.caust_scale));Fa.set_directive(b,"CAUST_SPEED",Fa.glsl_value(g.caust_speed,2));Fa.set_directive(b,"CAUST_BRIGHT",Fa.glsl_value(g.caust_brightness))}la=m.cube_refl_subs;
d=m.plane_refl_subs;m=Ha.find_subs(c,aa.SKY);g=Ha.find_subs(c,aa.IRRADIANCE);k=Ha.find_subs(c,aa.ROUGHNESS_CONVOLUTION);if(-1!==a.texture_names.indexOf("u_mirrormap"))Fa.set_directive(b,"REFLECTION_TYPE","REFL_MIRRORMAP");else if(a.reflective&&g&&k&&!la&&!d.length)ua.append_texture(a,g.camera.color_attachment,"u_cube_irradiance"),ua.append_texture(a,k.camera.color_attachment,"u_cube_r_convolution"),Fa.set_directive(b,"REFLECTION_TYPE","REFL_PBR_STANDARD");else if(!a.reflective||la||d.length||db.quality==
N.P_LOW)if(a.reflective&&la)g=la.camera.color_attachment,l.reflection_params.has_reflexible||(la.force_do_not_render=!0,m&&(g=m.camera.color_attachment)),ua.append_texture(a,g,"u_cube_reflection"),Fa.set_directive(b,"REFLECTION_TYPE","REFL_CUBE");else if(a.reflective&&d)for(la=0;la<d.length;la++)g=d[la].camera.color_attachment,ua.append_texture(a,g,"u_plane_reflection"),Fa.set_directive(b,"REFLECTION_TYPE","REFL_PLANE");else Fa.set_directive(b,"REFLECTION_TYPE","REFL_NONE");else m?(ua.append_texture(a,
m.camera.color_attachment,"u_sky_reflection"),Fa.set_directive(b,"REFLECTION_TYPE","REFL_PBR_SIMPLE")):Fa.set_directive(b,"REFLECTION_TYPE","REFL_NONE");m?a.draw_proc_sky?(g=m.camera.color_attachment,ua.append_texture(a,g,"u_sky")):m.procedural_skydome&&(a.cube_fog=m.cube_fog,Fa.set_directive(b,"PROCEDURAL_FOG",1)):Fa.set_directive(b,"PROCEDURAL_FOG",0);g=l.world_light_set;g.use_environment_light&&(Fa.set_directive(b,"USE_ENVIRONMENT_LIGHT",1),"SKY_TEXTURE"==g.environment_color?(g.environment_texture_slot?
(m=g.environment_texture_slot.texture,g=bb.get_batch_texture(g.environment_texture_slot),ua.append_texture(a,g,"u_sky_texture",m.name)):m&&(g=m.camera.color_attachment,ua.append_texture(a,g,"u_sky_texture")),Fa.set_directive(b,"SKY_TEXTURE",1)):"SKY_COLOR"==g.environment_color&&Fa.set_directive(b,"SKY_COLOR",1));g=l.world_fog_set;g.use_fog&&(Fa.set_directive(b,"USE_FOG",1),Fa.set_directive(b,"FOG_TYPE",g.falloff));a.refractive&&a.blend?(db.depth_tex_available&&Fa.set_directive(b,"USE_REFRACTION_CORRECTION",
1),"MAIN"==a.type&&a.has_nodes||"NODES_GLOW"==a.type?(Fa.set_directive(b,"REFRACTIVE",1),l.refractions?Fa.set_directive(b,"USE_REFRACTION",1):Fa.set_directive(b,"USE_REFRACTION",0)):l.refractions?Fa.set_directive(b,"REFRACTIVE",1):Fa.set_directive(b,"REFRACTIVE",0),(l.materials_params.refractions||l.refractions)&&Fa.set_directive(b,"HAS_REFRACT_TEXTURE",1)):(Fa.set_directive(b,"REFRACTIVE",0),Fa.set_directive(b,"USE_REFRACTION",0),Fa.set_directive(b,"USE_REFRACTION_CORRECTION",0));a.water&&(db.shore_smoothing&&
a.water_shore_smoothing&&Ha.find_subs(c,aa.DEPTH_PACK)?Fa.set_directive(b,"SHORE_SMOOTHING",1):Fa.set_directive(b,"SHORE_SMOOTHING",0),a.water_dynamic&&h&&h.waves_height?Fa.set_directive(b,"DYNAMIC",1):Fa.set_directive(b,"DYNAMIC",0));"PARTICLES"==a.type&&Fa.set_directive(b,"COLOR_RAMP_LENGTH",a.particles_data.color_ramp_length);if(!a.forked_batch)for(a=a.textures,c=0;c<a.length;c++)if(g=a[c],"SCENE"==g.source)for(l=0;l<nb.length;l++)for(b=nb[l],h=nb[l]._render_to_textures,m=0;m<h.length;m++)h[m]==
g&&Pa.append_edge_attr(xb,b,f,null)}}function wa(a,g){g.type==Ra.TYPE_ORTHO||g.type==Ra.TYPE_ORTHO_ASPECT||g.type==Ra.TYPE_ORTHO_ASYMMETRIC?Fa.set_directive(a,"CAMERA_TYPE","CAM_TYPE_ORTHO"):Fa.set_directive(a,"CAMERA_TYPE","CAM_TYPE_PERSP")}function qa(a){8<a.textures.length&&Bb.warn(a.type,"too many textures used - "+a.textures.length+' (max 8), materials "'+a.material_names.join(", ")+'"')}function na(a,g,b){a.grass_map_dim=g.grass_map_dim;var c=g.grass_map_dim[0],h=g.grass_map_dim[1],f=g.grass_map_dim[2];
b=b.bb_local;b=Math.max(b.max_x-b.min_x,b.max_y-b.min_y);f=0==f?b:Math.max(f,b);g.grass_map_dim[2]=f;g=g.camera;Ra.set_frustum2(g,f/2,f/2,-h,-c);Ra.set_projection(g,!1);c=a.grass_size||0;c=0==c?b:Math.max(c,b);a.grass_size=c}function Ja(a,g,b,c,h,f){for(var N=g.render,d=qb.get_scene_data(g,h),l=d.batches,m=0;m<l.length;m++){var k=l[m];if(("MAIN"==k.type||"PARTICLES"==k.type||"LINE"==k.type)&&"REFLECT"==k.subtype&&k.blend==c){if(a.type==aa.MAIN_PLANE_REFLECT||a.type==aa.MAIN_PLANE_REFLECT_BLEND){var la;
a:{var w=h._render.reflection_params.plane_refl_subs;for(la=0;la<w.length;la++)for(var q=0;q<w[la].length;q++)if(w[la][q]==a)break a;w=h._render.reflection_params.plane_refl_subs_blend;for(la=0;la<w.length;la++)for(q=0;q<w[la].length;q++)if(w[la][q]==a)break a;la=null}if(la==N.plane_reflection_id)continue}else if(la=ib(h,a),la==N.cube_reflection_id)continue;if(!f&&(O(k,a,g,b,"REFLECT",h),la=k.shaders_info,Fa.set_directive(la,"WATER_EFFECTS",0),a.type==aa.MAIN_PLANE_REFLECT||a.type==aa.MAIN_PLANE_REFLECT_BLEND?
Fa.set_directive(la,"REFLECTION_PASS","REFL_PASS_PLANE"):Fa.set_directive(la,"REFLECTION_PASS","REFL_PASS_CUBE"),Fa.set_directive(la,"TEXTURE_NORM",0),!ua.update_shader(k)))if("DEBUG"===Object(sa.d)())ua.apply_shader(k,"error.glslv","error.glslf"),ua.update_shader(k);else continue;la=aa.init_bundle(k,N,d.batch_world_bounds[m]);aa.append_draw_data(a,la);ma(b,a,k,!1);qa(k)}}}function g(a){La(a);var g=Oa(a,aa.MAIN_OPAQUE),b=!0,c=a._render.shadow_params;Pa.traverse(a._render.graph,function(h,f){f.type===
aa.SHADOW_CAST&&(Ba(f,a,g.camera,c,b),b=!1)})}function Da(a){Pa.traverse(a._render.graph,function(a,g){g.type===aa.OUTLINE&&(g.draw_outline_flag=1)})}function Ba(a,g,b,c,h){if(0!=a.draw_data.length){var f=a.camera;M.a(b.world_tsr,f.world_tsr);M.a(b.view_tsr,f.shadow_cast_billboard_view_tsr);if("SUN"===c.lamp_types[a.shadow_lamp_index]||"HEMI"===c.lamp_types[a.shadow_lamp_index]){var N=b.world_tsr,d=Kc;n.P(d);for(var l=0;l<a.draw_data.length;l++)for(var m=a.draw_data[l].bundles,k=0;k<m.length;k++){var la=
m[k].batch,w=m[k].obj_render;if(la.dynamic_grass){var q=M.g(N,Sb),D=U.transformQuat(F.c,q,zb),q=-D[0],D=D[1],v=M.j(N,zb),q=v[0]-la.grass_size*(1+q)/2,D=v[1]-la.grass_size*(1-D)/2,w=n.h(la.bounds_local.bb,w.world_tsr,Cb),w=w.max_z-w.min_z,v=Cb;v.min_x=q;v.min_y=D;v.min_z=la.grass_map_dim[0]-w;v.max_x=q+la.grass_size;v.max_y=D+la.grass_size;v.max_z=la.grass_map_dim[1]+w}else v=w.bb_world;0==l&&0==k?n.o(v,d):n.D(d,v)}N=n.F(d,gd);F._28(N,f.view_matrix,N);if(c.enable_csm){g=U.copy(b.csm_centers[a.csm_index],
kc);c=u.invert(b.view_matrix,Vc);F._28(g,c,g);F._28(g,f.view_matrix,g);a=b.csm_radii[a.csm_index];if(h)for(Tb=0,Zb=-Infinity,h=2;h<N.length;h+=3)Tb=Math.min(Tb,N[h]),Zb=Math.max(Zb,N[h]);h=Kc;h.max_x=g[0]+a;h.max_y=g[1]+a;h.max_z=Zb;h.min_x=g[0]-a;h.min_y=g[1]-a;h.min_z=Tb}else{b=h=Kc;c=lc;c.set(N);N=vc/9;d=u.identity(Vc);u.rotate(d,N,F.c,d);m=l=-1;for(k=0;10>k;k++){la=n.a(c,0,c.length,Cb);w=(la.max_x-la.min_x)*(la.max_y-la.min_y);if(-1==l||.1<l-w)l=w,m=k,n.o(la,b);F._28(c,d,c)}b=m*N;0<b&&(c=u.identity(Vc),
u.rotate(c,b,F.c,c),u.multiply(c,f.view_matrix,f.view_matrix),M.d(f.view_matrix,f.view_tsr));b=h.max_x-h.min_x;c=h.max_y-h.min_y;b&&c&&(N=Math.abs(b-c)/2,2<b/c?(h.max_y+=N,h.min_y-=N):2<c/b&&(h.max_x+=N,h.min_x-=N));h.max_x+=.005;h.max_y+=.005;h.max_z+=.005;h.min_x-=.005;h.min_y-=.005;h.min_z-=.005;Ec(a,g._render.graph)}Ra.set_frustum_asymmetric(f,h.min_x,h.max_x,h.min_y,h.max_y,-h.max_z,-h.min_z);Ra.set_projection(f,!1)}else"SPOT"!==c.lamp_types[a.shadow_lamp_index]&&"POINT"!==c.lamp_types[a.shadow_lamp_index]||
Ra.set_projection(f,!1)}}function Ta(a,g,b,c,h){for(var f=g.render,N=qb.get_scene_data(g,c),d=N.batches,l=0;l<d.length;l++){var m=d[l];if("COLOR_ID"==m.type&&(a.type==aa.COLOR_PICKING&&"COLOR_ID"==m.subtype||a.type==aa.COLOR_PICKING_XRAY&&"COLOR_ID_XRAY"==m.subtype)){if(!h&&(O(m,a,g,b,"COLOR_ID",c),ua.set_batch_directive(m,"USE_OUTLINE",0),!ua.update_shader(m)))continue;m=aa.init_bundle(m,f,N.batch_world_bounds[l]);aa.append_draw_data(a,m)}}}function ma(a,g,b,c){var h=Pa.node_by_attr(a,g);Pa.traverse_inputs(a,
h,function(a,g,h){if(h.active){switch(h.from){case "COLOR":case "CUBEMAP":var f=g.camera.color_attachment;break;case "DEPTH":f=g.camera.depth_attachment;break;case "SCREEN":f=null;break;case aa.MAIN_CUBE_REFLECT:return;default:yb.panic("Wrong slink")}switch(h.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":case "u_cube_reflection":case "u_plane_reflection":break;default:if(!f)if(c)break;else yb.panic("Connection of SCREEN is forbidden");
f.w_renderbuffer&&yb.panic("Batch texture can't use renderbuffer");Fa.check_uniform(b.shader,h.to)&&(c?ua.replace_texture(b,f,h.to):ua.append_texture(b,f,h.to))}}});for(a=0;a<g.slinks_internal.length;a++){var h=g.slinks_internal[a],f=g.textures_internal[a];switch(h.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":break;default:f.w_renderbuffer&&yb.panic("Batch texture can't use renderbuffer"),Fa.check_uniform(b.shader,h.to)&&(c?ua.replace_texture(b,
f,h.to):ua.append_texture(b,f,h.to))}}}function Ka(a,g){fb(a,g);for(var b=0;b<a.cons_descends.length;b++)a.cons_descends[b].parent==a&&Ka(a.cons_descends[b],g)}function fb(a,g){a.render.hide=g;if(qb.is_lamp(a))for(var b=0;b<a.scenes_data.length;b++)for(var c=a.scenes_data[b],h=Z(c.scene,eb),f=0;f<h.length;f++){var N=h[f],d=a.render,l=a.light,m=c.light_index,k=l.use_diffuse&&!d.hide?1:0;N.light_positions[4*m+3]=k;k=l.use_specular&&!d.hide?1:0;N.light_color_intensities[4*m+3]=k;N.need_perm_uniforms_update=
!0}}function La(a){var g=Vb.get_scene_objs(a,"LAMP",Vb.DATA_ID_ALL),g=qb.get_shadow_lamps(g,db.ssao&&a.b4w_enable_ssao);if(g.length)for(var b=0;b<g.length;b++)for(var c=g[b],h=c.render,f=M.j(h.world_tsr,kc),h=M.g(h.world_tsr,Sb),N=0;N<c.scenes_data.length;N++){var d=c.scenes_data[N],l=d.shadow_subscenes;if(d.scene==a)for(d=0;d<l.length;d++)Ra.set_view_trans_quat(l[d].camera,f,h)}}function Xa(a){var g=Oa(a,aa.SKY);g&&Wa(a,g)}function Wa(a,g){Za.prerender_subs(g);Wb.draw(g);if(g.need_fog_update)for(var b=
Z(a,fc),c=0;c<b.length;c++)for(var h=b[c].draw_data,f=0;f<h.length;f++)for(var N=h[f].bundles,d=0;d<N.length;d++){var l=N[d];l.do_render&&(l=l.batch,ua.check_batch_perm_uniform(l,"u_cube_fog")&&Wb.update_batch_permanent_uniform(l,"u_cube_fog"))}if(b=Oa(a,aa.IRRADIANCE))Za.prerender_subs(b),Wb.draw(b);if(b=Oa(a,aa.ROUGHNESS_CONVOLUTION))Za.prerender_subs(b),Wb.draw(b);if(b=Oa(a,aa.BRDF))Za.prerender_subs(b),Wb.draw(b)}function W(a){for(var g=[],b=0;b<a.length;b++)for(var c=a[b]._object.materials,h=
0;h<c.length;h++){var f=c[h];-1==g.indexOf(f)&&g.push(f)}return g}function Ia(a,g,b,c){la.is_hidpi()&&(g*=window.devicePixelRatio,b*=window.devicePixelRatio);var h=Y();h&&(h=h._render,g*=h.resolution_factor,b*=h.resolution_factor);g*=a.size_mult_x;b*=a.size_mult_y;c[0]=Math.floor(g);c[1]=Math.floor(b);return c}function Ua(a,g,b){a=Ia(a,g,b,mc);return a[0]>jb.max_texture_size||a[1]>jb.max_texture_size?(Bb.warn("Texture size exceeds platform limits, downscaling"),Math.min(jb.max_texture_size/a[0],jb.max_texture_size/
a[0])):1}function Na(a,g,b){for(var c=a._render,h=qb.get_scene_data(a._camera,a).cameras,f=0!=b?g/b:1,N=0;N<h.length;N++){var d=h[N];Ra.set_aspect(d,f);Ra.set_projection(d,!1);c.shadow_params&&Ra.update_camera_shadows(d,c.shadow_params)}if(c.shadow_params){c.need_shadow_update=!0;c=Z(a,[aa.SHADOW_RECEIVE]);for(N=0;N<c.length;N++)c[N].need_perm_uniforms_update=!0;c=Z(a,[aa.MAIN_BLEND]);for(N=0;N<c.length;N++)c[N].need_perm_uniforms_update=!0}Va(a,g,b)}function Va(a,g,b){var c=a._render.graph,h=Infinity;
Ha.traverse_slinks(c,function(a,c,f,N){a.update_dim&&(h=Math.min(h,Ua(a,g,b)))});Ha.traverse_slinks(c,function(f,N,d,l){if(f.update_dim){var m,k;l&&l.type==aa.SINK||d.is_pp&&!f.apply_resolution_factors?(m=g*f.size_mult_x,k=b*f.size_mult_y):(k=Ia(f,g,b,mc),m=k[0]*h,k=k[1]*h);if(N)for(N=0;N<d.slinks_internal.length;N++)d.slinks_internal[N]==f&&bb.resize(f.texture,m,k);else switch(bb.is_texture(f.texture)&&(bb.resize(f.texture,m,k),f.texture.use_mipmap&&(l.last_mip_map_ind=f.texture.mipmap_count)),f=
d.camera,f.width=m,f.height=k,d.type){case aa.DOF:$a(a,{dof_power:d.camera.dof_power});break;case aa.GLOW_COMBINE:ob(a,{small_glow_mask_width:d.small_glow_mask_width,large_glow_mask_width:d.large_glow_mask_width});break;case aa.BLOOM:rb(a,{blur:d.bloom_blur});break;case aa.RESIZE:f.width=f.color_attachment.width;f.height=f.color_attachment.height;break;case aa.OUTLINE:d=Ha.find_input(c,d,aa.POSTPROCESSING);f=Ha.find_input(c,d,aa.POSTPROCESSING);k=Ha.find_input(c,f,aa.POSTPROCESSING);N=Ha.find_input(c,
k,aa.POSTPROCESSING);Ha.set_texel_size(d,1/m,1/m);Ha.set_texel_size(f,1/m,1/m);Ha.set_texel_size(k,1/m,1/m);Ha.set_texel_size(N,1/m,1/m);break;default:Ha.set_texel_size(d,1/m,1/k)}}})}function Z(a,g){for(var b=[],c=0;c<g.length;c++){var h=g[c];a._render.graph&&Pa.traverse(a._render.graph,function(a,g){g.type==h&&b.push(g)})}return b}function Oa(a,g){return Ha.find_subs(a._render.graph,g)}function Qa(a){var g=Y();g&&Pa.traverse(g._render.graph,function(g,b){var c=b.camera;c&&c.type==Ra.TYPE_HMD_RIGHT&&
(b.force_do_not_render=a)})}function $a(a,g){var b=Z(a,[aa.DOF]);if(!b.length)return Bb.error("DOF is not enabled on the scene. Check camera settings"),0;for(var c=0;c<b.length;c++){var h=b[c],f=g,N=a,d=h.dof_bokeh,l=d?Z(N,[aa.COC]):[],N=N._render.graph;if("boolean"==typeof f.dof_on&&(h.camera.dof_on=f.dof_on,d))for(var m=0;m<l.length;m++)l[m].camera.dof_on=f.dof_on;if("number"==typeof f.dof_distance&&(h.camera.dof_distance=f.dof_distance,d))for(m=0;m<l.length;m++)l[m].camera.dof_distance=f.dof_distance;
if("number"==typeof f.dof_front_start&&(h.camera.dof_front_start=f.dof_front_start,d))for(m=0;m<l.length;m++)l[m].camera.dof_front_start=f.dof_front_start;if("number"==typeof f.dof_front_end&&(h.camera.dof_front_end=f.dof_front_end,d))for(m=0;m<l.length;m++)l[m].camera.dof_front_end=f.dof_front_end;if("number"==typeof f.dof_rear_start&&(h.camera.dof_rear_start=f.dof_rear_start,d))for(m=0;m<l.length;m++)l[m].camera.dof_rear_start=f.dof_rear_start;if("number"==typeof f.dof_rear_end&&(h.camera.dof_rear_end=
f.dof_rear_end,d))for(m=0;m<l.length;m++)l[m].camera.dof_rear_end=f.dof_rear_end;"number"==typeof f.dof_bokeh_intensity&&(h.camera.dof_bokeh_intensity=f.dof_bokeh_intensity,d&&(l=Ha.get_inputs_by_type(N,h,aa.POSTPROCESSING),l[0].camera.dof_bokeh_intensity=f.dof_bokeh_intensity,l[1].camera.dof_bokeh_intensity=f.dof_bokeh_intensity,l[0]=Ha.find_input(N,l[0],aa.POSTPROCESSING),l[0].camera.dof_bokeh_intensity=f.dof_bokeh_intensity));if("number"==typeof f.dof_power)if(d){f=f.dof_power;h.camera.dof_power=
f;var f=f/2,d=h.camera.width,m=h.camera.height,k=[1/d,0],la=[1/d*.5,1/m*.866],w=[-1/d*.5,1/m*.866],l=Ha.get_inputs_by_type(N,h,aa.POSTPROCESSING);Ha.set_texel_size_mult(l[0],f);Ha.set_texel_size(l[0],w[0],w[1]);Ha.set_texel_size_mult(l[1],f);Ha.set_texel_size(l[1],la[0],la[1]);l[0]=Ha.find_input(N,l[0],aa.POSTPROCESSING);Ha.set_texel_size_mult(l[0],f);Ha.set_texel_size(l[0],k[0],k[1]);h.camera.dof_foreground_blur&&(l[0]=Ha.find_input(N,l[0],aa.COC),l[0]=Ha.find_input(N,l[0],aa.POSTPROCESSING),Ha.set_texel_size(l[0],
1/d,1/m),l[0]=Ha.find_input(N,l[0],aa.POSTPROCESSING),Ha.set_texel_size(l[0],1/d,1/m))}else h.camera.dof_power=f.dof_power,l=Ha.find_input(N,h,aa.POSTPROCESSING),N=Ha.find_input(N,l,aa.POSTPROCESSING),Ha.set_texel_size_mult(l,h.camera.dof_power),Ha.set_texel_size(l,1/h.camera.width,1/h.camera.height),Ha.set_texel_size_mult(N,h.camera.dof_power),Ha.set_texel_size(N,1/h.camera.width,1/h.camera.height)}}function rb(a,g){var b=Z(a,[aa.LUMINANCE_TRUNCED]),c=Z(a,[aa.BLOOM]);if(!b.length||!c.length)return Bb.error("Bloom is not enabled on the scene"),
0;if("number"==typeof g.key)for(var h=0;h<b.length;h++)b[h].bloom_key=g.key,b[h].need_perm_uniforms_update=!0;if("number"==typeof g.edge_lum)for(h=0;h<b.length;h++)b[h].bloom_edge_lum=g.edge_lum,b[h].need_perm_uniforms_update=!0;if("number"==typeof g.blur)for(h=0;h<c.length;h++){c[h].bloom_blur=g.blur;for(var f=a._render.graph,N=c[h].camera.width/.5,d=c[h].camera.height/.5,l=Ha.get_inputs_by_type(f,c[h],aa.POSTPROCESSING),m=0;m<l.length;++m){var k=l[m],la=Ha.find_input(f,k,aa.POSTPROCESSING),w=N*
k.bloom_blur_scale,q=d*k.bloom_blur_scale;Ha.set_texel_size_mult(k,g.blur);Ha.set_texel_size(k,1/w,1/q);Ha.set_texel_size_mult(la,g.blur);Ha.set_texel_size(la,1/w,1/q)}}if("number"==typeof g.average_luminance)for(h=0;h<b.length;h++)b[h].adaptive_bloom||(b[h].average_luminance=g.average_luminance,b[h].need_perm_uniforms_update=!0)}function ob(a,g){var b=Z(a,[aa.GLOW_COMBINE]);if(!b.length)return Bb.error("Glow is not enabled on the scene"),null;for(var c=0;c<b.length;c++){for(var h=b[c],f=g,N=a._render.graph,
d=Ha.get_inputs(N,h),l=0;l<d.length;++l){var m=d[l];if(m.type==aa.POSTPROCESSING&&"GLOW_MASK_LARGE"==m.subtype)var k=m;if(m.type==aa.POSTPROCESSING&&"GLOW_MASK_SMALL"==m.subtype)var la=m}d=Ha.find_input(N,k,aa.POSTPROCESSING);N=Ha.find_input(N,la,aa.POSTPROCESSING);"number"==typeof f.small_glow_mask_coeff&&(h.small_glow_mask_coeff=f.small_glow_mask_coeff,h.need_perm_uniforms_update=!0);"number"==typeof f.large_glow_mask_coeff&&(h.large_glow_mask_coeff=f.large_glow_mask_coeff,h.need_perm_uniforms_update=
!0);"number"==typeof f.small_glow_mask_width&&(h.small_glow_mask_width=f.small_glow_mask_width,Ha.set_texel_size_mult(la,f.small_glow_mask_width),Ha.set_texel_size(la,1/h.camera.width,1/h.camera.height),la.need_perm_uniforms_update=!0,Ha.set_texel_size_mult(N,f.small_glow_mask_width),Ha.set_texel_size(N,1/h.camera.width,1/h.camera.height),N.need_perm_uniforms_update=!0);"number"==typeof f.large_glow_mask_width&&(h.large_glow_mask_width=f.large_glow_mask_width,Ha.set_texel_size_mult(k,f.large_glow_mask_width),
Ha.set_texel_size(k,1/h.camera.width,1/h.camera.height),k.need_perm_uniforms_update=!0,Ha.set_texel_size_mult(d,f.large_glow_mask_width),Ha.set_texel_size(d,1/h.camera.width,1/h.camera.height),d.need_perm_uniforms_update=!0)}}function gb(a,g,b){var c=a._render,h=c.water_params;if(!h.dynamic)return h.water_level;var f=h.waves_height,N=h.waves_length,d=h.water_level,l=U.length(c.wind)||1;a=Oa(a,aa.MAIN_OPAQUE).time;a*=l;var m=mc;m[0]=20/N*(g-.25*a);m[1]=20/N*(b-.25*a);l=F.J(m);m[0]=17/N*(b+.1*a);m[1]=
17/N*(g+.1*a);var m=F.J(m),l=l+m-1,k=h.dst_noise_scale0,m=h.dst_noise_scale1,la=h.dst_noise_freq0,w=h.dst_noise_freq1,q=mc;q[0]=k*(g+la*a);q[1]=k*(b+la*a);k=F._55(q);q[0]=m*(b-w*a);q[1]=m*(g-w*a);m=F._55(q);m*=f*k;if(h.shoremap_image)if(q=h.shoremap_size[1],k=h.shoremap_center[1],w=(g-h.shoremap_center[0])/h.shoremap_size[0]+.5,q=(k+b)/q+.5,1<w||0>w||1<q||0>q)g=m;else{var c=F._7(c.shore_distances,h.shoremap_tex_size,w,q),k=h.dir_noise_scale,la=h.dir_noise_freq,D=h.dir_min_noise_fac,w=h.dst_min_fac,
q=Math.sqrt(c);g=f*Math.max(c,h.dir_min_shore_fac)*Math.sin(q/(N/h.max_shore_dist/Math.PI)+h.dir_freq*a)*Math.max(F._55([k/N*(g+la*a),k/N*(b+la*a)]),D);b=Math.max(q,w);g=g*(1-b)+m*b;l*=c}else g=m;return d+(g+.05*l)}function Ya(a,g,b){g.is_for_outline&&g.type==aa.POSTPROCESSING&&b.do_render!=g.do_render&&(g.do_render=b.do_render);b.do_render||g.type!=aa.OUTLINE||(g.draw_outline_flag=0)}function sb(a,g,b,c){var h=Pa.get_node_attr(a,g);Ra.set_attachment(h.camera,b,c);h.assign_texture=!0;Pa.traverse_outputs(a,
g,function(g,h,f){f.active&&f.from==b&&Ha.check_slink_tex_conn(f)&&Mb(a,g,f.to,c)});Pa.traverse_inputs(a,g,function(g,h,f){f.active&&f.from==b&&f.from==f.to&&sb(a,g,b,c)})}function Mb(a,g,b,c){a=Pa.get_node_attr(a,g).draw_data;for(g=0;g<a.length;g++)for(var h=a[g].bundles,f=0;f<h.length;f++)ua.replace_texture(h[f].batch,c,b)}function Fb(a){for(var g=Z(a,[aa.GRASS_MAP]),b=0;b<g.length;b++){var c=g[b],h=c.camera,f=a._camera.render,N=M.j(f.world_tsr,kc),d=zb;d[0]=0;d[1]=0;d[2]=-c.grass_map_dim[2]/2;
c=M.g(f.world_tsr,Sb);U.transformQuat(d,c,d);d[0]+=N[0];d[1]+=N[1];d[2]=0;T.identity(c);Ra.set_view_trans_quat(h,d,c)}}function mb(a,g){Pa.traverse(a,function(b,c){if(c.type==aa.MOTION_BLUR){c.slinks_internal[0]&&c.textures_internal[0]||yb.panic("Wrong MOTION_BLUR subscene");var h=c.slinks_internal[0],f=c.textures_internal[0];c.textures_internal[0]=c.camera.color_attachment;Pa.traverse_outputs(a,b,function(g,b,c){c.active&&Mb(a,g,c.to,f)});sb(a,b,h.from,f);Mb(a,b,h.to,c.textures_internal[0]);c.motion_blur_exp=
Math.exp(-g/c.mb_factor)}})}function Sa(a){return a._render.wind}function ib(a,g){if(!a._render.reflection_params)return null;for(var b=a._render.reflection_params.cube_refl_subs,c=0;c<b.length;c++)if(b[c]==g)return c;b=a._render.reflection_params.cube_refl_subs_blend;for(c=0;c<b.length;c++)if(b[c]==g)return c;return null}var yb=Object(R.a)(v),ua=Object(V.a)(v),Ra=Object(y.a)(v),N=Object(d.a)(v),la=Object(k.a)(v),Db=Object(I.a)(v),Pa=Object(A.a)(v),zc=Object(r.a)(v),gc=Object(p.a)(v),Ac=Object(a.a)(v),
Vb=Object(B.a)(v),wb=Object(l.a)(v),qb=Object(c.a)(v),Za=Object(m.a)(v),Eb=Object(b.a)(v),Bb=Object(f.a)(v),Wb=Object(fa.a)(v),Ha=Object(z.a)(v),pb=Object(G.a)(v),Fa=Object(E.a)(v),aa=Object(J.a)(v),bb=Object(l.a)(v),Wc=N.debug_subs,db=N.defaults,jb=N.context_limits,Ub=N.outlining,dc=N.scenes,nc=[aa.GRASS_MAP,aa.SHADOW_CAST,aa.MAIN_OPAQUE,aa.MAIN_BLEND,aa.MAIN_XRAY,aa.MAIN_GLOW,aa.MAIN_PLANE_REFLECT,aa.MAIN_CUBE_REFLECT,aa.MAIN_PLANE_REFLECT_BLEND,aa.MAIN_CUBE_REFLECT_BLEND,aa.COLOR_PICKING,aa.COLOR_PICKING_XRAY,
aa.SHADOW_RECEIVE,aa.OUTLINE_MASK,aa.DEBUG_VIEW];e.OBJECT_SUBSCENE_TYPES=nc;var eb=[aa.MAIN_OPAQUE,aa.MAIN_BLEND,aa.MAIN_XRAY,aa.MAIN_GLOW,aa.MAIN_PLANE_REFLECT,aa.MAIN_CUBE_REFLECT,aa.GOD_RAYS,aa.GOD_RAYS_COMBINE,aa.SKY,aa.MAIN_PLANE_REFLECT_BLEND,aa.MAIN_CUBE_REFLECT_BLEND,aa.LUMINANCE_TRUNCED,aa.SHADOW_RECEIVE,aa.SHADOW_CAST,aa.COLOR_PICKING,aa.COLOR_PICKING_XRAY,aa.OUTLINE_MASK],fc=[aa.MAIN_OPAQUE,aa.SSAO,aa.MAIN_BLEND,aa.MAIN_XRAY,aa.MAIN_GLOW,aa.MAIN_PLANE_REFLECT,aa.MAIN_CUBE_REFLECT,aa.MAIN_PLANE_REFLECT_BLEND,
aa.MAIN_CUBE_REFLECT_BLEND],Bc=[aa.SHADOW_CAST,aa.MAIN_OPAQUE,aa.MAIN_BLEND,aa.MAIN_XRAY,aa.MAIN_GLOW,aa.MAIN_PLANE_REFLECT,aa.MAIN_CUBE_REFLECT,aa.MAIN_PLANE_REFLECT_BLEND,aa.MAIN_CUBE_REFLECT_BLEND,aa.COLOR_PICKING,aa.COLOR_PICKING_XRAY,aa.SHADOW_RECEIVE,aa.GOD_RAYS,aa.OUTLINE_MASK,aa.DEBUG_VIEW],Xc=[aa.MAIN_OPAQUE,aa.MAIN_BLEND,aa.MAIN_XRAY,aa.MAIN_GLOW,aa.MAIN_PLANE_REFLECT,aa.MAIN_CUBE_REFLECT,aa.MAIN_PLANE_REFLECT_BLEND,aa.MAIN_CUBE_REFLECT_BLEND],cb=null,tb=null,nb=[],xb=null,vc=Math.PI/2,
mc=new Float32Array(2),kc=new Float32Array(3),zb=new Float32Array(3),Sb=new Float32Array(4);new Float32Array(4);var Vc=new Float32Array(16),gd=new Float32Array(24),lc=new Float32Array(24),Kc=n.w(),Cb=n.w(),Tb=0,Zb=-Infinity,qc=new Uint8Array(4);e.create_scene_render=function(){return{}};e.set_active=function(a){tb=a;pb.set_active_scene(a)};e.prepare_rendering=function(a,g){var b=a._render,c=Ha.create_rendering_queue(b.graph);if(a==g){Na(a,la.get_viewport_width(),la.get_viewport_height());for(var h=
0;h<c.length;h++)a._render.queue.push(c[h])}else for(h=a._render_to_textures[0],Na(a,h.source_size,h.source_size),h=0;h<c.length;h++)g._render.queue.push(c[h]);c=Z(a,Bc);for(h=0;h<c.length;h++)c[h].wind.set(b.wind);for(h=0;h<b.queue.length;h++)b.queue[h].type==aa.SHADOW_CAST&&Wb.draw(b.queue[h])};e.get_main=Y;e.find_main_scene=S;e.get_active=L;e.check_active=function(){return tb?!0:!1};e.get_camera=function(a){return a._camera};e.get_all_scenes=function(){return nb};e.get_rendered_scenes=function(){if(1==
nb.length)return nb;for(var a=0;a<nb.length;a++){var g=nb[a]._render.graph;Pa.traverse(g,function(g,b){for(var c=b.draw_data,h=0;h<c.length;h++)for(var f=c[h].bundles,N=0;N<f.length;N++){for(var d=f[N],l=d.batch.textures,m=d.batch.bpy_tex_names,k=null,la=0;la<l.length;la++)if("SCENE"==l[la].source&&l[la].source_id==nb[a].name&&b.type!=aa.COPY){Bb.error('Texture-scene loop detected. A scene is rendered to texture "'+m[la]+'" yet this texture belongs to the same scene.');k=d.batch;break}if(k)for(l=
k.textures,k.textures=[],k.texture_names=[],ua.update_batch_material_error(k,null),ua.update_shader(k),aa.append_draw_data(b,d),la=0;la<l.length;la++)wb.cleanup_unused(l[la])}})}for(var b=[],a=0;a<nb.length;a++)if(g=nb[a],!g._render_to_textures.length){g=Pa.node_by_attr(xb,g);Pa.enforce_acyclic(xb,g);g=Pa.subgraph_node_conn(xb,g,Pa.BACKWARD_DIR);g=Pa.topsort(g);Pa.traverse(g,function(a,g){b.push(g)});break}return b};e.append_scene=function(a,g,b,c,f){a._render_to_textures=a._render_to_textures||[];
a._nla=null;var d=a._render,l=qb.get_scene_data(a._camera,a),m=a._camera.render;d.video_textures=[];var k=a.world;d.lamps_number=b.length;d.sun_exist=ea(b);d.sky_params=za(k,d.sun_exist);d.world_light_set=ba(k,d.sky_params);d.world_fog_set=Ea(k);if(k=!a._render_to_textures.length)a:{if("HMD"==db.stereo){if(l.cameras[0].type!=Ra.TYPE_PERSP){Bb.warn("Head-mounted display stereo is disabled for the non-perspective camera");db.stereo="NONE";k=!1;break a}if(!gc.can_use_device(gc.DEVICE_HMD)){Bb.warn("Head-mounted display stereo is disabled for the non-WebVR and non-mobile devices");
db.stereo="NONE";k=!1;break a}}k="HMD"==db.stereo}d.hmd_stereo_use=k;if(k=!a._render_to_textures.length)l.cameras[0].type!=Ra.TYPE_PERSP&&"ANAGLYPH"==db.stereo?(Bb.warn("Anaglyph stereo is disabled for the non-perspective camera"),db.stereo="NONE",k=!1):k="ANAGLYPH"==db.stereo;d.anaglyph_use=k;if(k=!a._render_to_textures.length)l.cameras[0].type!=Ra.TYPE_PERSP&&"SIDEBYSIDE"==db.stereo?(Bb.warn("Side-by-side stereo is disabled for the non-perspective camera"),db.stereo="NONE",k=!1):k="SIDEBYSIDE"==
db.stereo;d.sidebyside_use=k;d.anchor_visibility=!d.anaglyph_use&&!d.sidebyside_use&&Aa(a,f);d.reflection_params=ra(a,g,c);d.bloom_params=t(a);d.mb_params=Q(a);d.cc_params=da(a);d.god_rays_params=ja(a);d.outline_params=va(a);d.glow_params=Ga(a);d.dof=db.dof&&(0<m.dof_distance||m.dof_object);d.motion_blur=db.motion_blur&&a.b4w_enable_motion_blur;d.compositing=db.compositing&&a.b4w_enable_color_correction;d.antialiasing=db.antialiasing&&1==db.msaa_samples&&"NONE"!=a.b4w_antialiasing_quality;d.ssao=
db.ssao&&a.b4w_enable_ssao;d.god_rays=db.god_rays&&a.b4w_enable_god_rays&&d.sun_exist;d.depth_tex=db.depth_tex_available;d.glow_over_blend=a.b4w_glow_settings.render_glow_over_blend;d.ssao_params=P(a);f=ia(c);d.materials_params=f;d.refractions=Ca(a,f);d.shadow_params=q(a,b,c);d.water_params=h(c);d.xray=C(c);d.soft_particles=D(c);d.shore_smoothing=H(c);d.dynamic_grass=ta(a,c);d.color_picking=X(a,c);d.outline=pa(a,c);d.glow_materials=ka(a,c);d.lod_smooth_type=a.b4w_lod_smooth_type;d.lod_hyst_interval=
a.b4w_lod_hyst_interval;switch(db.reflection_quality?db.reflection_quality:a.b4w_reflection_quality){case "LOW":d.cubemap_refl_size=dc.cube_reflect_low;d.plane_refl_size=dc.plane_reflect_low;break;case "MEDIUM":d.cubemap_refl_size=dc.cube_reflect_medium;d.plane_refl_size=dc.plane_reflect_medium;break;case "HIGH":d.cubemap_refl_size=dc.cube_reflect_high;d.plane_refl_size=dc.plane_reflect_high;break;default:d.cubemap_refl_size=dc.cube_reflect_low,d.plane_refl_size=dc.plane_reflect_low}la.is_hidpi()?
(Bb.log("%cENABLE HIDPI MODE","color: #00a"),d.aa_quality="AA_QUALITY_LOW",d.resolution_factor=1,db.msaa_samples=1):1<db.msaa_samples?(Bb.log("%cENABLE MSAA RENDERING: "+db.msaa_samples+"x","color: #00a"),d.resolution_factor=1):(d.aa_quality="AA_QUALITY_"+a.b4w_antialiasing_quality,d.resolution_factor=db.quality===N.P_ULTRA?1.33:1);b=a._render_to_textures.sort(function(a,g){return g.source_size-a.source_size});d.graph=Ha.create_rendering_graph(d,l,m,b);d.queue=[];d.need_shadow_update=!1;d.need_grass_map_update=
!1;d.need_outline=!1;d.wind=new Float32Array(3);nb.push(a);xb||(xb=Pa.create());Pa.append_node_attr(xb,a);for(d=0;d<g.length;d++)qb.scene_data_set_active(g[d],!0,a);a=la.get_container();la.resize(a.clientWidth,a.clientHeight,!0)};e.append_scene_vtex=function(a,g,b){for(var c=0;c<g.length;c++){var h=g[c]._render;h&&h.is_movie&&(h.vtex_data_id=b,a._render.video_textures.push(g[c]))}};e.get_graph=function(a){return a._render.graph};e.generate_auxiliary_batches=function(a,g){Pa.traverse(g,function(b,
c){var h=null;switch(c.type){case aa.POSTPROCESSING:h=ua.create_postprocessing_batch(c.pp_effect);break;case aa.SSAO:h=ua.create_ssao_batch(c);break;case aa.SSAO_BLUR:h=ua.create_ssao_blur_batch(c);break;case aa.DEPTH_PACK:h=ua.create_depth_pack_batch();break;case aa.GOD_RAYS:h=ua.create_god_rays_batch(c.pack,c.water,c.steps_per_pass);break;case aa.GOD_RAYS_COMBINE:h=ua.create_god_rays_combine_batch();break;case aa.MOTION_BLUR:h=ua.create_motion_blur_batch(c.mb_decay_threshold);break;case aa.COC:h=
ua.create_coc_batch(c.coc_type);break;case aa.DOF:var h=ua.create_dof_batch(c),f=c.camera.dof_power;if(c.dof_bokeh){var f=f/2,d=Ha.get_inputs_by_type(g,c,aa.POSTPROCESSING);Ha.set_texel_size_mult(d[0],f);Ha.set_texel_size_mult(d[1],f);d[0]=Ha.find_input(g,d[0],aa.POSTPROCESSING);Ha.set_texel_size_mult(d[0],f)}else{var d=Ha.find_input(g,c,aa.POSTPROCESSING),N=Ha.find_input(g,d,aa.POSTPROCESSING);Ha.set_texel_size_mult(d,f);Ha.set_texel_size_mult(N,f)}break;case aa.OUTLINE:var h=ua.create_outline_batch(),
f=Ha.find_input(g,c,aa.POSTPROCESSING),d=Ha.find_input(g,f,aa.POSTPROCESSING),N=Ha.find_input(g,d,aa.POSTPROCESSING),l=Ha.find_input(g,N,aa.POSTPROCESSING);Ha.set_texel_size_mult(d,c.blur_texel_size_mult);Ha.set_texel_size_mult(f,c.blur_texel_size_mult);Ha.set_texel_size_mult(l,c.ext_texel_size_mult*c.outline_factor);Ha.set_texel_size_mult(N,c.ext_texel_size_mult*c.outline_factor);break;case aa.GLOW_COMBINE:h=ua.create_glow_combine_batch();break;case aa.COMPOSITING:h=ua.create_compositing_batch();
break;case aa.ANTIALIASING:h=ua.create_antialiasing_batch(c);break;case aa.SMAA_RESOLVE:case aa.SMAA_EDGE_DETECTION:case aa.SMAA_BLENDING_WEIGHT_CALCULATION:case aa.SMAA_NEIGHBORHOOD_BLENDING:h=ua.create_smaa_batch(c.type);break;case aa.STEREO:h=ua.create_stereo_batch(c.subtype);break;case aa.SKY:h=ua.create_cube_sky_batch(a,c);break;case aa.IRRADIANCE:h=ua.create_cube_irradiance_batch(a,c);break;case aa.ROUGHNESS_CONVOLUTION:h=ua.create_cube_roughness_convolution_batch(a,c);break;case aa.BRDF:h=
ua.create_brdf_batch(a,c);break;case aa.LUMINANCE:h=ua.create_luminance_batch();break;case aa.AVERAGE_LUMINANCE:h=ua.create_average_luminance_batch();break;case aa.LUMINANCE_TRUNCED:h=ua.create_luminance_truncated_batch(c.adaptive_bloom);break;case aa.BLOOM:h=ua.create_bloom_combine_batch(c.bloom_blur_num);break;case aa.RESIZE:h=ua.create_postprocessing_batch("NONE");break;case aa.VELOCITY:h=ua.create_velocity_batch();break;case aa.ANCHOR_VISIBILITY:h=ua.create_anchor_visibility_batch();break;case aa.PERFORMANCE:h=
ua.create_performance_batch()}h&&(f=aa.init_bundle(h,qb.create_render("NONE")),aa.append_draw_data(c,f),ma(g,c,h,!1),qa(h))})};var Ib=function(){var a=T.create(),g=U.create();return function(b,c){for(var h=Z(c,eb),f=b.light,d=b.render,N=qb.get_scene_data(b,c),l=M.j(d.world_tsr,g),d=M.g(d.world_tsr,a),m=0;m<h.length;m++){var k=h[m];Nb(b,N,k);switch(f.type){case "SUN":k.sun_quaternion.set(d);k.sun_intensity=f.color_intensity;U.copy(f.direction,k.sun_direction);k.type==aa.SKY&&k.procedural_skydome&&
(k.need_fog_update=f.need_sun_fog_update,Wa(c,k));break;case "HEMI":case "POINT":case "SPOT":break;default:Bb.error("Unknown light type: "+f.type+'".')}for(var k=k.draw_data,la=0;la<k.length;la++)for(var w=k[la].bundles,q=0;q<w.length;q++){var D=w[q].batch;D.lamp_uuid_indexes&&ua.set_lamp_data(D,b)}}h=Oa(c,aa.MAIN_OPAQUE).camera;N=N.shadow_subscenes;f=c._render.shadow_params;for(m=0;m<N.length;m++)k=N[m],Ra.set_view_trans_quat(k.camera,l,d),Ba(k,c,h,f,!0),Ec(k,c._render.graph)}}();e.update_lamp_scene=
Ib;e.append_object=function(a,g,b){switch(g.type){case "MESH":case "LINE":case "WORLD":var c=a._render.graph,h=g.render;!Ha.find_subs(c,aa.SHADOW_CAST)&&h.shadow_receive&&(h.shadow_receive=!1);for(var h=Z(a,nc),f=0;f<h.length;f++){var d=h[f],N=g,l=c,m=a,k=b;switch(d.type){case aa.MAIN_OPAQUE:ga(d,N,l,"OPAQUE",m,k);break;case aa.MAIN_BLEND:ga(d,N,l,"BLEND",m,k);break;case aa.MAIN_XRAY:ga(d,N,l,"XRAY",m,k);break;case aa.MAIN_GLOW:ga(d,N,l,"GLOW",m,k);break;case aa.MAIN_PLANE_REFLECT:case aa.MAIN_CUBE_REFLECT:Ja(d,
N,l,!1,m,k);break;case aa.MAIN_PLANE_REFLECT_BLEND:case aa.MAIN_CUBE_REFLECT_BLEND:Ja(d,N,l,!0,m,k);break;case aa.SHADOW_RECEIVE:for(var la=qb.get_scene_data(N,m),w=la.batches,q=0;q<w.length;q++){var D=w[q];if("SHADOW"==D.type&&"RECEIVE"==D.subtype&&D.shadow_receive){if(!k&&(O(D,d,N,l,"SHADOW",m),!ua.update_shader(D)))continue;var v=aa.init_bundle(D,N.render,la.batch_world_bounds[q]);aa.append_draw_data(d,v);ma(l,d,D,!1);qa(D)}}break;case aa.SHADOW_CAST:la=!1;w=N.render;N=qb.get_scene_data(N,m);q=
N.batches;D=Ha.find_subs(l,aa.GRASS_MAP);for(v=0;v<q.length;v++){var e=q[v];if("SHADOW"==e.type&&"CAST"==e.subtype){la=!0;if(!k){ya(e);var Ya=d.num_lights;ua.set_batch_directive(e,"NUM_LIGHTS",Ya);ua.set_batch_directive(e,"NUM_LFACTORS",0==Ya%2?Ya/2:Math.floor(Ya/2)+1);wa(e.shaders_info,d.camera);Fa.set_directive(e.shaders_info,"SHADOW_USAGE","SHADOW_CASTING");e.dynamic_grass&&D&&na(e,D,w);ua.set_batch_directive(e,"SHADOW_TEX_RES",Fa.glsl_value(m._render.shadow_params.csm_resolution));if(!ua.update_shader(e))continue}e.dynamic_grass&&
(m._render.shadow_params.dynamic_grass_cast=!0);Ya=aa.init_bundle(e,w,N.batch_world_bounds[v]);aa.append_draw_data(d,Ya);ma(l,d,e,!1);qa(e)}}la&&(N=m._render.shadow_params,k=Ha.find_subs(l,aa.MAIN_OPAQUE),Ba(d,m,k.camera,N,!0));break;case aa.COLOR_PICKING:Ta(d,N,l,m,k);break;case aa.COLOR_PICKING_XRAY:Ta(d,N,l,m,k);break;case aa.OUTLINE_MASK:la=N.render;w=qb.get_scene_data(N,m);q=w.batches;for(D=0;D<q.length;D++)if(v=q[D],"COLOR_ID"==v.type&&"OUTLINE"==v.subtype){if(!k&&(O(v,d,N,l,"COLOR_ID",m),ua.set_batch_directive(v,
"USE_OUTLINE",1),!ua.update_shader(v)))continue;v=aa.init_bundle(v,la,w.batch_world_bounds[D]);aa.append_draw_data(d,v)}break;case aa.GRASS_MAP:l=N.render;N=qb.get_scene_data(N,m);m=N.batches;for(la=0;la<m.length;la++)if(w=m[la],"GRASS_MAP"==w.type){if(!k&&!ua.update_shader(w))if("DEBUG"===Object(sa.d)())ua.apply_shader(w,"error.glslv","error.glslf"),ua.update_shader(w);else continue;w=aa.init_bundle(w,l,N.batch_world_bounds[la]);aa.append_draw_data(d,w);w=d.camera;e=l.bb_world;q=d.grass_map_dim[0];
D=d.grass_map_dim[1];v=d.grass_map_dim[2];0==q&&0==D?(q=e.min_z,D=e.max_z):(q=Math.min(q,e.min_z),D=Math.max(D,e.max_z));e=1E-4*(D-q);q-=e;D+=e;d.grass_map_dim[0]=q;d.grass_map_dim[1]=D;Ra.set_frustum2(w,v/2,v/2,-D,-q);Ra.set_projection(w,!1)}break;case aa.DEBUG_VIEW:for(la=N.render,N=qb.get_scene_data(N,m),m=N.batches,w=0;w<m.length;w++)if(q=m[w],"DEBUG_VIEW"==q.type){if(!k&&(q.dynamic_grass&&(D=Ha.find_subs(l,aa.GRASS_MAP))&&na(q,D,la),!ua.update_shader(q)))if("DEBUG"===Object(sa.d)())ua.apply_shader(q,
"error.glslv","error.glslf"),ua.update_shader(q);else break;D=aa.init_bundle(q,la,N.batch_world_bounds[w]);aa.append_draw_data(d,D);ma(l,d,q,!1);qa(q)}}}break;case "LAMP":Ib(g,a)}b=qb.get_scene_data(g,a);c=b.batches;for(h=0;h<c.length;h++)null==c[h].shader&&"PHYSICS"!=c[h].type&&(qb.scene_data_remove_batch(b,h),h--);qb.scene_data_set_active(g,!0,a)};e.init_cube_sky_dim=function(a,g){if(a&&a._render&&a._render.graph){var b=a._render.graph,c=Ha.find_subs(a._render.graph,aa.SKY);if(c){var h=null;Ha.traverse_slinks(b,
function(a,g,b,c){if("CUBEMAP"==a.from&&b.type==aa.SKY&&c.type==aa.SINK)return h=a.texture,!0});if(h){var f=dc.cubemap_tex_size,d=ua.get_batch_by_type(g,"SKY",a);if(d&&d.has_nodes)d=Ac.get_ngraph_proxy_cached(d.ngraph_proxy_id).graph,d=Ac.get_max_env_texture_height(d),-1!=d&&(f=wb.calc_pot_size(d/2));else if(d=a._render.world_light_set.sky_texture_param)f=d.tex_size;f=Math.min(f,jb.max_cube_map_texture_size);c.camera.width=f;c.camera.height=f;bb.set_cubemap_tex_size(h,f);xa(a,f);if(c=Ha.find_subs(a._render.graph,
aa.IRRADIANCE)){c.camera.width=32;c.camera.height=32;var N=null;Ha.traverse_slinks(b,function(a,g,b,c){if("CUBEMAP"==a.from&&b.type==aa.IRRADIANCE&&c.type==aa.MAIN_OPAQUE)return N=a.texture,!0});N&&bb.set_cubemap_tex_size(N,32)}if(c=Ha.find_subs(a._render.graph,aa.ROUGHNESS_CONVOLUTION)){c.camera.width=128;c.camera.height=128;var l=null;Ha.traverse_slinks(b,function(a,g,b,c){if("CUBEMAP"==a.from&&b.type==aa.ROUGHNESS_CONVOLUTION&&c.type==aa.MAIN_OPAQUE)return l=a.texture,!0});l&&bb.set_cubemap_tex_size(l,
128)}}}}};e.update_cube_sky_dim=function(a,g){for(var b=a.scenes_data,c=0;c<b.length;c++){var h=b[c].scene,f=h._render.graph,d=Ha.find_subs(h._render.graph,aa.SKY);if(d){var N=null;Ha.traverse_slinks(f,function(a,g,b,c){if("CUBEMAP"==a.from&&b.type==aa.SKY&&c.type==aa.IRRADIANCE)return N=a.texture,!0});N&&(f=wb.calc_pot_size(g.height/2),f=Math.min(f,jb.max_cube_map_texture_size),d.camera.width=f,d.camera.height=f,bb.set_cubemap_tex_size(N,f),xa(h,f))}}};e.schedule_shadow_update=function(a){a._render.need_shadow_update=
!0};e.update_shadow_billboard_view=function(a,g){Pa.traverse(g,function(g,b){b.type===aa.SHADOW_CAST&&(M.a(a.world_tsr,b.camera.world_tsr),M.a(a.view_tsr,b.camera.shadow_cast_billboard_view_tsr))})};var Ec=function(){var a=T.create(),g=U.create(),b=K.create();return function(c,h){for(var f=c.camera,d=Ha.get_outputs(h,c),N=0;N<d.length;N++){var l=d[N];if(l.type==aa.MAIN_OPAQUE||l.type==aa.SHADOW_RECEIVE||l.type==aa.MAIN_BLEND||l.type==aa.MAIN_XRAY)if(db.mac_os_shadow_hack)l.v_light_tsr.set(f.view_tsr,
9*c.shadow_lamp_index);else{var m=M.j(f.view_tsr,g),k=M.i(f.view_tsr),la=M.g(f.view_tsr,a);K.set(m[0],m[1],m[2],k,b);l.v_light_ts.set(b,4*c.shadow_lamp_index);l.v_light_r.set(la,4*c.shadow_lamp_index)}}}}();e.update_shadow_receive_subs=Ec;e.get_csm_borders=function(a,g){for(var b=a._render.shadow_params,c=new Float32Array(b.csm_num),h=0;h<b.csm_num;h++)c[h]=Ra.csm_far_plane(b,g,h);return c};e.connect_render_targets_batch=ma;e.change_visibility_rec=Ka;e.change_visibility=fb;e.is_hidden=function(a){return a.render.hide};
e.remove_object_bundles=function(a,g){for(var b=0;b<a.scenes_data.length;b++)for(var c=Z(a.scenes_data[b].scene,nc),h=0;h<c.length;h++)for(var f=c[h].draw_data,d=0;d<f.length;d++)for(var N=f[d].bundles,l=N.length-1;0<=l;l--){var m=N[l];if(m.obj_render==a.render)if(m.batch){if("undefined"==typeof g||-1!=m.batch.material_names.indexOf(g)||0==m.batch.material_names.length)ua.clear_batch(m.batch),N.splice(l,1)}else N.splice(l,1)}};e.update_lamp_scene_color_intensity=function(a,g){for(var b=a.light,c=
qb.get_scene_data(a,g).light_index,h=Z(g,eb),f=0;f<h.length;f++){var d=h[f];d.light_color_intensities.set(b.color_intensity,4*c);d.need_perm_uniforms_update=!0}};var Nb=function(){var a=U.create(),g=K.create();return function(b,c,h){var f=b.render,d=b.light;c=c.light_index;b=M.j(b.render.world_tsr,a);var N=d.color_intensity;h.light_directions.set(d.direction,3*c);g[0]=b[0];g[1]=b[1];g[2]=b[2];g[3]=d.use_diffuse&&!f.hide?1:0;h.light_positions.set(g,4*c);g[0]=N[0];g[1]=N[1];g[2]=N[2];g[3]=d.use_specular&&
!f.hide?1:0;h.light_color_intensities.set(g,4*c);h.need_perm_uniforms_update=!0}}();e.update_sky_texture=function(a){a=a.scenes_data;for(var g=0;g<a.length;g++)Xa(a[g].scene)};e.update_world_texture=Xa;e.update_sky=Wa;e.cleanup=function(){for(var a=0;a<nb.length;a++){var g=nb[a];Pa.traverse(g._render.graph,function(a,g){if(g.type!=aa.SINK){var b=g.camera;Wb.render_target_cleanup(b.framebuffer,b.color_attachment,b.depth_attachment,b.width,b.height);for(var b=g.draw_data,c=0;c<b.length;c++)for(var h=
b[c].bundles,f=0;f<h.length;f++){var d=h[f].batch;d&&ua.clear_batch(d)}}});g._render.graph=null;g._render.queue=[]}tb=cb=null;nb.length=0;xb=null};e.make_frustum_shot=function(a,g,b){a=Ra.extract_frustum_corners(a,a.near,a.far,null,!0);var c=Eb.generate_frustum(a);a=qb.create_render("DYNAMIC");a.bb_world=a.bb_local=n.f();a.bs_world=a.bs_local=n.g();var h=a.bs_world.radius;a.be_world=a.be_local=n.e([h,0,0],[0,h,0],[0,0,h],a.bs_world.center);b=ua.create_shadeless_batch(c,b,.5);b.do_not_cull=!0;b=aa.init_bundle(b,
a);aa.append_draw_data(g,b)};e.get_scene_timeline=function(a){return[a.frame_start,a.frame_end]};e.setup_dim=function(a,g,b){la.setup_viewport_dim(a,g,b);tb&&Na(tb,a,g)};e.subs_array=Z;e.get_subs=Oa;e.render_both_eyes=function(){Qa(!1)};e.render_one_eye=function(){Qa(!0)};e.get_environment_colors=function(a){a=Oa(a,aa.MAIN_OPAQUE);var g=a.horizon_color,b=a.zenith_color,c=[],h=[];c[0]=g[0];c[1]=g[1];c[2]=g[2];h[0]=b[0];h[1]=b[1];h[2]=b[2];return[a.environment_energy,c,h]};e.set_environment_colors=
function(a,g,b,c){for(var h=Z(a,eb),f=0;f<h.length;f++){var d=h[f];d.horizon_color.set(b);d.zenith_color.set(c);d.environment_energy=g;d.need_perm_uniforms_update=!0}(g=Ha.find_subs(a._render.graph,aa.SKY))&&Wa(a,g)};e.get_sky_params=function(a){if((a=Oa(a,aa.SKY))&&a.procedural_skydome){var g={};g.color=Array(3);U.copy(a.sky_color,g.color);g.procedural_skydome=a.procedural_skydome;g.use_as_environment_lighting=a.use_as_environment_lighting;g.rayleigh_brightness=a.rayleigh_brightness;g.mie_brightness=
a.mie_brightness;g.spot_brightness=a.spot_brightness;g.scatter_strength=a.scatter_strength;g.rayleigh_strength=a.rayleigh_strength;g.mie_strength=a.mie_strength;g.rayleigh_collection_power=a.rayleigh_collection_power;g.mie_collection_power=a.mie_collection_power;g.mie_distribution=a.mie_distribution;return g}return null};e.get_fog_intensity=function(a){return Z(a,fc)[0].fog_params[0]};e.get_fog_depth=function(a){return Z(a,fc)[0].fog_params[1]};e.get_fog_start=function(a){return Z(a,fc)[0].fog_params[2]};
e.get_fog_height=function(a){return Z(a,fc)[0].fog_params[3]};e.set_fog_intensity=function(a,g){for(var b=Z(a,fc),c=0;c<b.length;c++){var h=b[c];h.fog_params[0]=g;h.need_perm_uniforms_update=!0}};e.set_fog_depth=function(a,g){for(var b=Z(a,fc),c=0;c<b.length;c++){var h=b[c];h.fog_params[1]=g;h.need_perm_uniforms_update=!0}};e.set_fog_start=function(a,g){for(var b=Z(a,fc),c=0;c<b.length;c++){var h=b[c];h.fog_params[2]=g;h.need_perm_uniforms_update=!0}};e.set_fog_height=function(a,g){for(var b=Z(a,
fc),c=0;c<b.length;c++){var h=b[c];h.fog_params[3]=g;h.need_perm_uniforms_update=!0}};e.get_fog_color_density=function(a,g){var b=g||[],c=Z(a,fc)[0].fog_color_density;b[0]=c[0];b[1]=c[1];b[2]=c[2];b[3]=c[3];return b};e.set_fog_color_density=function(a,g){for(var b=Z(a,fc),c=0;c<b.length;c++){var h=b[c];h.fog_color_density.set(g);h.need_perm_uniforms_update=!0}};e.get_ssao_params=function(a){var g=Oa(a,aa.SSAO),b=Oa(a,aa.SSAO_BLUR);a=Oa(a,aa.MAIN_OPAQUE);if(!g)return null;var c={};c.quality=g.ssao_samples;
c.use_hemisphere=g.ssao_hemisphere;c.use_blur_depth=b.ssao_blur_depth;c.blur_discard_value=b.ssao_blur_discard_value;c.radius_increase=g.ssao_radius_increase;c.influence=g.ssao_influence;c.dist_factor=g.ssao_dist_factor;c.ssao_only=a.ssao_only;c.ssao_white=g.ssao_white;return c};e.get_dof_params=function(a){a=Oa(a,aa.DOF);if(!a)return null;var g={};g.dof_on=a.camera.dof_on;g.dof_bokeh=a.dof_bokeh;g.dof_distance=a.camera.dof_distance;g.dof_front_start=a.camera.dof_front_start;g.dof_front_end=a.camera.dof_front_end;
g.dof_rear_start=a.camera.dof_rear_start;g.dof_rear_end=a.camera.dof_rear_end;g.dof_power=a.camera.dof_power;g.dof_bokeh_intensity=a.camera.dof_bokeh_intensity;g.dof_object=a.camera.dof_object;return g};e.set_dof_params=$a;e.get_god_rays_params=function(a){var g=Z(a,[aa.GOD_RAYS]);a=Oa(a,aa.GOD_RAYS_COMBINE);if(!g||!a)return null;var b={};b.god_rays_max_ray_length=g[0].max_ray_length;b.god_rays_intensity=a.god_rays_intensity;b.god_rays_steps=ua.get_batch_directive(g[0].draw_data[0].bundles[0].batch,
"STEPS_PER_PASS")[1];return b};e.set_god_rays_params=function(a,g){var b=Z(a,[aa.GOD_RAYS]),c=Z(a,[aa.GOD_RAYS_COMBINE]);if(!b.length||!c.length)return Bb.error("God Rays are not enabled on the scene"),0;if("number"==typeof g.god_rays_intensity)for(var h=0;h<c.length;h++)c[h].god_rays_intensity=g.god_rays_intensity;if("number"==typeof g.god_rays_max_ray_length)for(var f=g.god_rays_max_ray_length,h=0;h<b.length;h++)b[h].max_ray_length=f,b[h].radial_blur_step=f/b[h].steps_per_pass/(h+1),b[h].need_perm_uniforms_update=
!0;if("number"==typeof g.god_rays_steps)for(var d=Fa.glsl_value(g.god_rays_steps,1),f=b[0].max_ray_length,h=0;h<b.length;h++){b[h].steps_per_pass=d;b[h].radial_blur_step=f/d/(h+1);b[h].need_perm_uniforms_update=!0;var N=b[h].draw_data[0].bundles[0],l=N.batch;ua.set_batch_directive(l,"STEPS_PER_PASS",d);ua.update_shader(l);aa.append_draw_data(b[h],N)}for(h=0;h<c.length;h++)c.need_perm_uniforms_update=!0};e.get_bloom_params=function(a){var g=Oa(a,aa.LUMINANCE_TRUNCED);a=Oa(a,aa.BLOOM);if(!g||!a)return null;
var b={};b.key=g.bloom_key;b.edge_lum=g.bloom_edge_lum;b.blur=a.bloom_blur;b.adaptive=g.adaptive_bloom;b.average_luminance=g.average_luminance;return b};e.set_bloom_params=rb;e.get_glow_material_params=function(a){a=Oa(a,aa.GLOW_COMBINE);if(!a)return null;var g={};g.small_glow_mask_coeff=a.small_glow_mask_coeff;g.large_glow_mask_coeff=a.large_glow_mask_coeff;g.small_glow_mask_width=a.small_glow_mask_width;g.large_glow_mask_width=a.large_glow_mask_width;return g};e.set_glow_material_params=ob;e.get_wind_params=
function(a){var g=Sa(a);a=U.length(g);if(0==a)return null;var g=F._39(Math.atan2(g[0],-g[1])),b={};b.wind_dir=g;b.wind_strength=a;return b};e.schedule_grass_map_update=function(a){a._render.need_grass_map_update=!0};e.get_water_surface_level=gb;e.get_water_mat_params=function(a,g){var b=a._render.water_params,c=Oa(a,aa.MAIN_OPAQUE);c&&b&&(g.waves_height=b.waves_height,g.waves_length=b.waves_length,g.water_fog_density=c.water_fog_color_density[3],b=g.water_fog_color=[],b[0]=c.water_fog_color_density[0],
b[1]=c.water_fog_color_density[1],b[2]=c.water_fog_color_density[2])};e.set_water_params=function(a,g){var b=a._render.water_params;if(!b)return Bb.error("set_water_params() - no water parameters on the scene"),null;"number"==typeof g.dst_noise_scale0&&(b.dst_noise_scale0=g.dst_noise_scale0);"number"==typeof g.dst_noise_scale1&&(b.dst_noise_scale1=g.dst_noise_scale1);"number"==typeof g.dst_noise_freq0&&(b.dst_noise_freq0=g.dst_noise_freq0);"number"==typeof g.dst_noise_freq1&&(b.dst_noise_freq1=g.dst_noise_freq1);
"number"==typeof g.dir_min_shore_fac&&(b.dir_min_shore_fac=g.dir_min_shore_fac);"number"==typeof g.dir_freq&&(b.dir_freq=g.dir_freq);"number"==typeof g.dir_noise_scale&&(b.dir_noise_scale=g.dir_noise_scale);"number"==typeof g.dir_noise_freq&&(b.dir_noise_freq=g.dir_noise_freq);"number"==typeof g.dir_min_noise_fac&&(b.dir_min_noise_fac=g.dir_min_noise_fac);"number"==typeof g.dst_min_fac&&(b.dst_min_fac=g.dst_min_fac);"number"==typeof g.waves_hor_fac&&(b.waves_hor_fac=g.waves_hor_fac);"number"==typeof g.water_dynamic&&
(b.dynamic=g.water_dynamic);for(var c=Z(a,Xc),h=0;h<c.length;h++){var f=c[h];"number"==typeof g.water_fog_density&&b.fog_color_density&&(f.water_fog_color_density[3]=g.water_fog_density);"object"==typeof g.water_fog_color&&b.fog_color_density&&f.water_fog_color_density.set(g.water_fog_color);f.need_perm_uniforms_update=!0}};e.get_shore_dist=function(a,g,b){var c=a._render.water_params;if(!c.shoremap_image)return 100;var h=c.max_shore_dist;a=c.water_level;var f=(g[0]-c.shoremap_center[0])/c.shoremap_size[0],
d=(c.shoremap_center[1]+g[1])/c.shoremap_size[1],f=f+.5,d=d+.5;if(!(1<f||0>f||1<d||0>d))return c=h*F._7(tb._render.shore_distances,c.shoremap_tex_size,f,d),g=(a-g[2])*b,g=Math.sqrt(c*c+g*g)};e.update=function(a,b){Wb.clear();for(var c=L()._camera.render,h=0;h<nb.length;h++){var f=nb[h],d=f._render.graph,N=f._render;if(N.water_params){var l=M.j(c.world_tsr,kc),m=l[2]-gb(f,l[0],l[1]);M.v(l,c.world_tsr)}for(l=0;l<N.video_textures.length;l++){var k=N.video_textures[l]._render,la=k.video_file,w=k.seq_video;
if(!(f.b4w_use_nla&&k.use_nla||!la&&!w)&&bb.video_is_played(k)){var q=bb.video_get_current_frame(k),D=bb.video_get_start_frame(k);la&&db.is_mobile_device&&(D-=5);var v=bb.video_get_end_frame(k);q>=v&&k.use_cyclic||q<D?(bb.reset_video(k),w&&(k.seq_last_discrete_mark=bb.seq_video_get_discrete_timemark(k,a))):q>=v&&!k.use_cyclic?bb.pause_video(k):bb.video_update_is_available(k)&&(la?bb.update_video_texture(k):(la=bb.seq_video_get_discrete_timemark(k,a),la!=k.seq_last_discrete_mark&&(bb.update_seq_video_texture(k),
k.seq_cur_frame++),k.seq_last_discrete_mark=la))}}Pa.traverse(d,function(g,b){-1<Bc.indexOf(b.type)&&(b.time=a);N.water_params&&(b.cam_water_depth=m)})}for(h=0;h<nb.length;h++)if(f=nb[h],N=f._render,d=N.graph,c=N.queue,c.length)for(N.need_shadow_update&&(g(f),N.need_shadow_update=!1),N.need_grass_map_update&&(Fb(f),N.need_grass_map_update=!1),N.need_outline&&(Da(f),N.need_outline=!1),N.motion_blur&&mb(d,b),f=Ha.find_subs(d,aa.OUTLINE_MASK),l=0;l<c.length;l++)k=c[l],Za.prerender_subs(k),f&&Ya(d,k,
f),Wb.draw(k);db.show_hud_debug_info&&zc.show_debug_info(nb,b)};e.request_outline=function(a){a._render.need_outline=!0};e.get_all_subscenes=function(a){var g=[];Pa.traverse(a._render.graph,function(a,b){g.push(b)});return g};e.get_cam_water_depth=function(){var a=Oa(tb,aa.MAIN_BLEND),g=tb;return a||g._render.water_params?a.cam_water_depth:null};e.update_scene_permanent_uniforms=function(a){Pa.traverse(a._render.graph,function(a,g){g.need_perm_uniforms_update=!0})};e.set_debug_view_mode=function(a,
g){a.debug_view_mode=g;a.do_render=g!=Db.DV_NONE;a.blend=g==Db.DV_TRANSPARENT_WIREFRAME;a.need_perm_uniforms_update=!0;for(var b=L(),c=0;c<Xc.length;c++)for(var h=Z(b,[Xc[c]]),f=0;f<h.length;f++)h[f].do_not_debug=g==Db.DV_RENDER_TIME};e.set_debug_colors_seed=function(a,g){a.debug_colors_seed=g;a.need_perm_uniforms_update=!0};e.set_render_time_threshold=function(a,g){a.debug_render_time_threshold=g;a.need_perm_uniforms_update=!0};e.set_wireframe_edge_color=function(a,g){for(var b=a.draw_data,c=0;c<
b.length;c++)for(var h=b[c].bundles,f=0;f<h.length;f++){var d=h[f].batch;U.copy(g,d.wireframe_edge_color);d.shader.need_uniforms_update=!0}};e.update_force_scene=function(){var a=T.create();return function(g,b){var c=b.field,h=g._render.wind;if(c&&"WIND"==c.type&&h){var f=M.g(b.render.world_tsr,a);U.transformQuat(F.f,f,h);U.normalize(h,h);U.scale(h,c.strength,h);c=Z(g,Bc);for(f=0;f<c.length;f++)c[f].wind.set(h);return!0}return!1}}();e.pick_color=function(a,g,b){var c=Oa(a,aa.COLOR_PICKING);if(c){var h=
Wc.enabled&&(Wc.subs_type===aa.COLOR_PICKING||Wc.subs_type===aa.COLOR_PICKING_XRAY);if(h)var f=la.canvas_to_viewport_coords(g,b,mc,c.camera);else{var d=la.get_canvas();Ra.set_color_pick_proj(c.camera,g,b,d.clientWidth,d.clientHeight)}Za.prerender_subs(c);c.do_render&&Wb.draw(c);(a=Oa(a,aa.COLOR_PICKING_XRAY))?(u.copy(c.camera.proj_matrix,a.camera.proj_matrix),u.copy(c.camera.view_proj_matrix,a.camera.view_proj_matrix),F._0(a.camera.view_proj_matrix,a.camera.frustum_planes),Za.prerender_subs(a),a.do_render&&
Wb.draw(a),g=a.camera):g=c.camera;if(c.do_render||a&&a.do_render)return h?(f[1]=g.height-f[1],Wb.read_pixels(g.framebuffer,f[0],f[1],1,1,qc)):Wb.read_pixels(a?a.camera.framebuffer:c.camera.framebuffer,0,0,1,1,qc)}else Bb.error("Object Selection is not available on the scene");return null};e.set_outline_color=function(a){for(var g=L(),g=Z(g,[aa.OUTLINE]),b=0;b<g.length;b++){var c=g[b];c.outline_color.set(a);c.need_perm_uniforms_update=!0}};e.get_wind=Sa;e.get_meta_tags=function(a){var g={title:"",
description:""};a.b4w_tags&&(g.title=a.b4w_tags.title,g.description=a.b4w_tags.description);return g};e.get_custom_prop=function(a){return a.b4w_custom_prop};e.update_cube_reflect_subs=function(a,g){var b=kc;U.negate(g,b);for(var c=0;6>c;c++){var h=a.cube_view_matrices[c],f=a.cube_cam_frustums[c],d=a.camera;u.translate(F.j[c],b,h);u.multiply(d.proj_matrix,h,d.view_proj_matrix);F._0(d.view_proj_matrix,f)}};e.update_plane_reflect_subs=function(a,g,b){F._61(g,b,F.f,a.camera.reflection_plane)};e.assign_scene_data_subs=
function(a,g,b){var c=a._render.reflection_params;if(c&&g)for(var h=0;h<g.length;h++){var f=g[h],d=qb.get_scene_data(f,a);if(-1!=f.render.plane_reflection_id){var N=c.plane_refl_subs,l=c.plane_refl_subs_blend,f=f.render.plane_reflection_id;l.length&&f<l.length?d.plane_refl_subs=l[f]:N.length&&f<N.length&&(d.plane_refl_subs=N[f])}else-1!=f.render.cube_reflection_id&&(N=c.cube_refl_subs,l=c.cube_refl_subs_blend,f=f.render.cube_reflection_id,l.length?d.cube_refl_subs=l[f]:N.length&&(d.cube_refl_subs=
N[f]))}if(b)for(g=qb.get_shadow_lamps(b,db.ssao&&a.b4w_enable_ssao),b=a._render.shadow_params,h=0;h<g.length;h++)if(d=qb.get_scene_data(g[h],a),b)for(c=Z(a,[aa.SHADOW_CAST]),f=0;f<c.length;f++)h==c[f].shadow_lamp_index&&d.shadow_subscenes.push(c[f])};e.marker_frame=function(a,g){return a.timeline_markers[g]};e.set_hmd_params=function(a){var g=L();if(g=Oa(g,aa.STEREO))a.distortion_coefs&&(g.distortion_params[0]=a.distortion_coefs[0],g.distortion_params[1]=a.distortion_coefs[1],g.need_perm_uniforms_update=
!0),a.chromatic_aberration_coefs&&(g.chromatic_aberration_coefs[0]=a.chromatic_aberration_coefs[0],g.chromatic_aberration_coefs[1]=a.chromatic_aberration_coefs[1],g.chromatic_aberration_coefs[2]=a.chromatic_aberration_coefs[2],g.chromatic_aberration_coefs[3]=a.chromatic_aberration_coefs[3],g.need_perm_uniforms_update=!0),a.base_line_factor&&(g.distortion_params[2]=a.base_line_factor,g.need_perm_uniforms_update=!0),a.inter_lens_factor&&(g.distortion_params[3]=a.inter_lens_factor,g.need_perm_uniforms_update=
!0),null!=a.enable_hmd_stereo&&(g.enable_hmd_stereo=a.enable_hmd_stereo,g.need_perm_uniforms_update=!0)};e.multiply_size_mult=function(a,g){for(var b=nb,c=0;c<b.length;c++){var h=e.get_graph(b[c]);Ha.multiply_size_mult_by_graph(h,a,g)}};e.update_all_mesh_shaders=function(a){for(var g=Vb.get_scene_objs(a,"LAMP",Vb.DATA_ID_ALL),b=Z(a,nc),c=0;c<b.length;c++)for(var h=b[c],f=h.draw_data,d=0;d<f.length;d++)for(var N=f[d].bundles,l=0;l<N.length;l++){var m=N[l],k=m.batch;"MAIN"==k.type&&(ua.update_batch_lights(k,
g,a),ua.update_shader(k),aa.append_draw_data(h,m))}};e.recalculate_draw_data=function(a){for(var g=0;g<nb.length;g++)Pa.traverse(nb[g]._render.graph,function(g,b){for(var c=b.draw_data,h=0;h<c.length;h++)for(var f=c[h].bundles,d=0;d<f.length;d++){var N=f[d];N.batch==a&&aa.append_draw_data(b,N)}})}});t.a=e},function(C,t,e){C=e(0);var R=e(5),V=e(14),n=e(4),y=e(2),d=e(25);e=Object(C.a)("__subscene",function(k,e){function A(a,d){a.num_lights=d;a.light_directions=new Float32Array(3*d);a.light_positions=
new Float32Array(4*d);a.light_color_intensities=new Float32Array(4*d)}function r(a){a={type:a,subtype:"",force_do_not_render:!1,blend:!1,pack:!1,assign_texture:!1,need_fog_update:!1,debug_render_calls:0,debug_render_time:0,debug_render_time_queries:[],debug_view_mode:0,debug_colors_seed:0,debug_render_time_threshold:1,do_not_debug:!1,time:0,camera:null,cube_view_matrices:null,cube_cam_frustums:[],draw_data:[],slinks_internal:[],textures_internal:[],wind:new Float32Array(3),grass_map_dim:new Float32Array(3),
fog_color_density:new Float32Array(4),fog_params:new Float32Array(4),cube_fog:new Float32Array(16),sky_tex_default_value:0,environment_energy:0,num_lights:0,light_directions:null,light_positions:null,light_color_intensities:null,light_factors:null,horizon_color:new Float32Array(3),zenith_color:new Float32Array(3),sky_tex_fac:new Float32Array(4),sun_intensity:new Float32Array(3),sun_direction:new Float32Array([0,0,1]),sun_quaternion:new Float32Array(4),sky_tex_color:new Float32Array(3),sky_ngraph_proxy_id:"",
bsdf_cube_sky_dim:0,outline_factor:0,draw_outline_flag:0,is_for_outline:!1,outline_color:new Float32Array(3),water:!1,cam_water_depth:0,water_fog_color_density:new Float32Array(4),water_level:0,caustics:!1,caust_scale:0,caust_speed:new Float32Array(2),caust_brightness:0,procedural_skydome:!1,use_as_environment_lighting:!1,mie_brightness:0,rayleigh_brightness:0,spot_brightness:0,mie_strength:0,rayleigh_strength:0,scatter_strength:0,mie_collection_power:0,rayleigh_collection_power:0,mie_distribution:0,
sky_color:new Float32Array(3),ssao_hemisphere:!1,ssao_blur_depth:!1,ssao_blur_discard_value:0,ssao_radius_increase:0,ssao_influence:0,ssao_dist_factor:0,ssao_samples:0,ssao_only:!1,ssao_white:!1,brightness:0,contrast:0,exposure:0,saturation:0,god_rays_intensity:0,max_ray_length:0,radial_blur_step:0,steps_per_pass:0,csm_index:0,self_shadow_polygon_offset:0,self_shadow_normal_offset:0,v_light_ts:null,v_light_r:null,v_light_tsr:null,p_light_matrix:null,is_pp:!1,fxaa_quality:"",bloom_key:0,bloom_blur:0,
bloom_edge_lum:0,adaptive_bloom:!0,average_luminance:0,blur_texel_size_mult:0,ext_texel_size_mult:0,mb_decay_threshold:0,mb_factor:0,motion_blur_exp:0,pp_effect:"",dof_bokeh:!1,coc_type:"",jitter_projection_space:new Float32Array(2),last_mip_map_ind:0,bloom_blur_num:2,bloom_blur_scale:.5,small_glow_mask_width:0,large_glow_mask_width:0,small_glow_mask_coeff:0,large_glow_mask_coeff:0,texel_size:new Float32Array(2),texel_mask:new Float32Array(2),distortion_params:new Float32Array(4),chromatic_aberration_coefs:new Float32Array(4),
enable_hmd_stereo:!1,shadow_lamp_index:0,need_draw_data_sort:!0,sky_invert:!1,sky_use_rgb_to_intensity:!1,sky_use_map_blend:!1,sky_use_map_horizon:!1,sky_use_map_zenith_up:!1,sky_use_map_zenith_down:!1,sky_blend_type:"",use_sky_blend:!1,use_sky_paper:!1,use_sky_real:!1,do_render:!0,enqueue:!0,clear_color:!0,clear_depth:!0,depth_test:!0,need_perm_uniforms_update:!0,texel_size_multiplier:1};a.texel_mask[0]=1;a.texel_mask[1]=1;a.distortion_params[2]=.5;a.distortion_params[3]=.5;a.ssao_samples=8;return a}
function p(a,d){return a==d?0:a>d?1:-1}function u(a,d){return p(a.alpha_antialiasing,d.alpha_antialiasing)||p(a.is_sky,d.is_sky)||p(a.offset_z,d.offset_z)||p(a.shader.has_discard,d.shader.has_discard)||p(a.z_index,d.z_index)}var a=Object(R.a)(k),B=Object(V.a)(k),l=Object(n.a)(k).outlining;e.MAIN_OPAQUE=0;e.MAIN_BLEND=1;e.MAIN_XRAY=2;e.MAIN_PLANE_REFLECT=3;e.MAIN_CUBE_REFLECT=4;e.MAIN_PLANE_REFLECT_BLEND=5;e.MAIN_CUBE_REFLECT_BLEND=6;e.MAIN_GLOW=7;e.SHADOW_CAST=8;e.SHADOW_RECEIVE=9;e.GRASS_MAP=10;
e.POSTPROCESSING=11;e.GLOW_COMBINE=13;e.RESOLVE=14;e.COLOR_PICKING=15;e.COLOR_PICKING_XRAY=16;e.DEBUG_VIEW=17;e.ANCHOR_VISIBILITY=18;e.DEPTH_PACK=19;e.SSAO=20;e.SSAO_BLUR=21;e.ANTIALIASING=22;e.SMAA_BLENDING_WEIGHT_CALCULATION=23;e.SMAA_EDGE_DETECTION=24;e.SMAA_RESOLVE=25;e.SMAA_NEIGHBORHOOD_BLENDING=26;e.COMPOSITING=27;e.MOTION_BLUR=28;e.COC=29;e.DOF=30;e.OUTLINE_MASK=31;e.OUTLINE=32;e.GOD_RAYS=33;e.GOD_RAYS_COMBINE=34;e.SKY=35;e.COPY=36;e.STEREO=37;e.LUMINANCE=38;e.AVERAGE_LUMINANCE=39;e.LUMINANCE_TRUNCED=
40;e.BLOOM=41;e.VELOCITY=42;e.SINK=43;e.PERFORMANCE=44;e.RESIZE=45;e.IRRADIANCE=46;e.ROUGHNESS_CONVOLUTION=47;e.BRDF=48;e.create_subs_shadow_cast=function(a,d,b,f){var c=r(8);c.csm_index=a;c.self_shadow_polygon_offset=b.self_shadow_polygon_offset;c.shadow_lamp_index=d;switch(b.lamp_types[d]){case "SPOT":case "POINT":c.camera=B.create_camera(B.TYPE_PERSP);B.set_frustum(c.camera,b.spot_sizes[d],b.clip_start[d],b.clip_end[d]);break;default:c.camera=B.create_camera(B.TYPE_ORTHO_ASYMMETRIC)}A(c,f);return c};
e.clone_subs=function(a){var c=r(a.type);c.subtype=a.subtype;c.force_do_not_render=a.force_do_not_render;c.do_render=a.do_render;c.enqueue=a.enqueue;c.clear_color=a.clear_color;c.clear_depth=a.clear_depth;c.depth_test=a.depth_test;c.blend=a.blend;c.pack=a.pack;c.assign_texture=a.assign_texture;c.need_fog_update=a.need_fog_update;c.need_perm_uniforms_update=a.need_perm_uniforms_update;c.debug_render_calls=0;c.debug_render_time=0;c.debug_render_time_queries=[];c.debug_view_mode=a.debug_view_mode;c.debug_colors_seed=
a.debug_colors_seed;c.debug_render_time_threshold=a.debug_render_time_threshold;c.do_not_debug=a.do_not_debug;c.time=a.time;c.camera=B.clone_camera(a.camera,!0);c.cube_view_matrices=y.O(a.cube_view_matrices);c.cube_cam_frustums=y.O(a.cube_cam_frustums);c.draw_data=y.O(a.draw_data);c.slinks_internal=y.O(a.slinks_internal);c.textures_internal=y.O(a.textures_internal);c.wind.set(a.wind);c.grass_map_dim.set(a.grass_map_dim);c.fog_color_density.set(a.fog_color_density);c.fog_params.set(a.fog_params);c.cube_fog.set(a.cube_fog);
c.sky_tex_default_value=a.sky_tex_default_value;c.environment_energy=a.environment_energy;c.num_lights=a.num_lights;c.light_directions=y.O(a.light_directions);c.light_positions=y.O(a.light_positions);c.light_color_intensities=y.O(a.light_color_intensities);c.light_factors=y.O(a.light_factors);c.horizon_color.set(a.horizon_color);c.zenith_color.set(a.zenith_color);c.sky_tex_fac.set(a.sky_tex_fac);c.sun_intensity.set(a.sun_intensity);c.sun_direction.set(a.sun_direction);c.sun_quaternion.set(a.sun_quaternion);
c.sky_tex_color.set(a.sky_tex_color);c.sky_ngraph_proxy_id=a.sky_ngraph_proxy_id;c.bsdf_cube_sky_dim=a.bsdf_cube_sky_dim;c.outline_factor=a.outline_factor;c.draw_outline_flag=a.draw_outline_flag;c.is_for_outline=a.is_for_outline;c.outline_color.set(a.outline_color);c.water=a.water;c.cam_water_depth=a.cam_water_depth;c.water_fog_color_density.set(a.water_fog_color_density);c.water_level=a.water_level;c.caustics=a.caustics;c.caust_scale=a.caust_scale;c.caust_speed.set(a.caust_speed);c.caust_brightness=
a.caust_brightness;c.procedural_skydome=a.procedural_skydome;c.use_as_environment_lighting=a.use_as_environment_lighting;c.mie_brightness=a.mie_brightness;c.rayleigh_brightness=a.rayleigh_brightness;c.spot_brightness=a.spot_brightness;c.mie_strength=a.mie_strength;c.rayleigh_strength=a.rayleigh_strength;c.scatter_strength=a.scatter_strength;c.mie_collection_power=a.mie_collection_power;c.rayleigh_collection_power=a.rayleigh_collection_power;c.mie_distribution=a.mie_distribution;c.sky_color.set(a.sky_color);
c.ssao_hemisphere=a.ssao_hemisphere;c.ssao_blur_depth=a.ssao_blur_depth;c.ssao_blur_discard_value=a.ssao_blur_discard_value;c.ssao_radius_increase=a.ssao_radius_increase;c.ssao_influence=a.ssao_influence;c.ssao_dist_factor=a.ssao_dist_factor;c.ssao_samples=a.ssao_samples;c.ssao_only=a.ssao_only;c.ssao_white=a.ssao_white;c.brightness=a.brightness;c.contrast=a.contrast;c.exposure=a.exposure;c.saturation=a.saturation;c.god_rays_intensity=a.god_rays_intensity;c.max_ray_length=a.max_ray_length;c.radial_blur_step=
a.radial_blur_step;c.steps_per_pass=a.steps_per_pass;c.csm_index=a.csm_index;c.self_shadow_polygon_offset=a.self_shadow_polygon_offset;c.self_shadow_normal_offset=a.self_shadow_normal_offset;c.v_light_ts=y.O(a.v_light_ts);c.v_light_r=y.O(a.v_light_r);c.v_light_tsr=y.O(a.v_light_tsr);c.p_light_matrix=y.O(a.p_light_matrix);c.is_pp=a.is_pp;c.fxaa_quality=a.fxaa_quality;c.bloom_key=a.bloom_key;c.bloom_blur=a.bloom_blur;c.bloom_edge_lum=a.bloom_edge_lum;c.adaptive_bloom=a.adaptive_bloom;c.average_luminance=
a.average_luminance;c.blur_texel_size_mult=a.blur_texel_size_mult;c.ext_texel_size_mult=a.ext_texel_size_mult;c.mb_decay_threshold=a.mb_decay_threshold;c.mb_factor=a.mb_factor;c.motion_blur_exp=a.motion_blur_exp;c.pp_effect=a.pp_effect;c.coc_type=a.coc_type;c.dof_bokeh=a.dof_bokeh;c.jitter_projection_space.set(a.jitter_projection_space);c.last_mip_map_ind=a.last_mip_map_ind;c.bloom_blur_num=a.bloom_blur_num;c.bloom_blur_scale=a.bloom_blur_scale;c.small_glow_mask_width=a.small_glow_mask_width;c.large_glow_mask_width=
a.large_glow_mask_width;c.small_glow_mask_coeff=a.small_glow_mask_coeff;c.large_glow_mask_coeff=a.large_glow_mask_coeff;c.texel_size_multiplier=a.texel_size_multiplier;c.texel_size.set(a.texel_size);c.texel_mask.set(a.texel_mask);c.distortion_params.set(a.distortion_params);c.chromatic_aberration_coefs.set(a.chromatic_aberration_coefs);c.enable_hmd_stereo=a.enable_hmd_stereo;c.shadow_lamp_index=a.shadow_lamp_index;c.need_draw_data_sort=a.need_draw_data_sort;c.sky_invert=a.sky_invert;c.sky_use_rgb_to_intensity=
a.sky_use_rgb_to_intensity;c.sky_use_map_blend=a.sky_use_map_blend;c.sky_use_map_horizon=a.sky_use_map_horizon;c.sky_use_map_zenith_up=a.sky_use_map_zenith_up;c.sky_use_map_zenith_down=a.sky_use_map_zenith_down;c.sky_blend_type=a.sky_blend_type;c.use_sky_blend=a.use_sky_blend;c.use_sky_paper=a.use_sky_paper;c.use_sky_real=a.use_sky_real;return c};e.create_subs_grass_map=function(){var a=r(10);a.camera=B.create_camera(B.TYPE_ORTHO_ASPECT);return a};e.create_subs_postprocessing=function(c){var d=r(11);
d.clear_color=!1;d.clear_depth=!1;d.depth_test=!1;d.is_pp=!0;d.camera=B.create_camera(B.TYPE_NONE);d.pp_effect=c;switch(c){case "NONE":d.texel_mask[0]=1;d.texel_mask[1]=1;break;case "GRAYSCALE":d.texel_mask[0]=1;d.texel_mask[1]=1;break;case "X_BLUR":d.texel_mask[0]=1;d.texel_mask[1]=0;break;case "Y_BLUR":d.texel_mask[0]=0;d.texel_mask[1]=1;break;case "X_GLOW_BLUR":d.texel_mask[0]=1;d.texel_mask[1]=0;break;case "Y_GLOW_BLUR":d.texel_mask[0]=0;d.texel_mask[1]=1;break;case "X_BLOOM_BLUR":d.texel_mask[0]=
1;d.texel_mask[1]=0;break;case "Y_BLOOM_BLUR":d.texel_mask[0]=0;d.texel_mask[1]=1;break;case "X_DOF_BLUR":d.texel_mask[0]=1;d.texel_mask[1]=1;break;case "Y_DOF_BLUR":d.texel_mask[0]=1;d.texel_mask[1]=1;break;case "X_ALPHA_BLUR":d.texel_mask[0]=1;d.texel_mask[1]=0;d.texel_size_multiplier=3;break;case "Y_ALPHA_BLUR":d.texel_mask[0]=0;d.texel_mask[1]=1;d.texel_size_multiplier=3;break;case "X_EXTEND":d.texel_mask[0]=1;d.texel_mask[1]=0;break;case "Y_EXTEND":d.texel_mask[0]=0;d.texel_mask[1]=1;break;default:a.panic("Wrong postprocessing effect: "+
c)}return d};e.create_subs_glow_combine=function(a,d){var b=r(13);b.clear_color=!1;b.clear_depth=!1;b.depth_test=!1;b.small_glow_mask_coeff=d.glow_params.small_glow_mask_coeff;b.large_glow_mask_coeff=d.glow_params.large_glow_mask_coeff;b.small_glow_mask_width=d.glow_params.small_glow_mask_width;b.large_glow_mask_width=d.glow_params.large_glow_mask_width;b.camera=a;b.is_pp=!0;return b};e.create_subs_main=function(c,d,b,f,l,k,e,p,n){var m=r(c);0==c?(m.clear_color=!0,m.clear_depth=b,m.blend=!1):1==c?
(m.clear_color=!1,m.clear_depth=!1,m.blend=!0):2==c?(m.clear_color=!1,m.clear_depth=!0,m.blend=!0):3==c||4==c?(m.clear_color=!0,m.clear_depth=!0,m.blend=!1):5==c||6==c?(m.clear_color=!1,m.clear_depth=!1,m.blend=!0):7==c?(m.clear_color=!0,m.clear_depth=!1,m.blend=!0):a.panic("wrong main subscene type");m.blend&&p&&(m.self_shadow_normal_offset=p.self_shadow_normal_offset);m.camera=d;if(c=e.sky_texture_param)m.sky_tex_fac.set([c.blend_factor,c.horizon_factor,c.zenith_up_factor,c.zenith_down_factor]),
m.sky_tex_color.set(c.color),m.sky_tex_default_value=c.default_value;m.horizon_color.set(e.horizon_color);m.zenith_color.set(e.zenith_color);m.environment_energy=e.environment_energy;m.fog_color_density=k.fog_color_density;m.fog_params=k.fog_params;f&&(f.fog_color_density&&m.water_fog_color_density.set(f.fog_color_density),m.water_level=f.water_level,f.caustics&&n&&(m.caustics=!0,m.caust_scale=f.caustic_scale,m.caust_brightness=f.caustic_brightness,m.caust_speed.set(f.caustic_speed)));A(m,l);return m};
e.create_subs_resolve=function(){var a=r(14);a.is_pp=!0;a.camera=B.create_camera(B.TYPE_NONE);return a};e.create_subs_color_picking=function(a,d,b){var c=r(15);d&&(c.type=16,c.clear_color=!1,c.clear_depth=!0);c.enqueue=!1;c.camera=a;A(c,b);return c};e.create_subs_debug_view=function(a){var c=r(17);c.do_render=!1;c.clear_color=!1;c.clear_depth=!1;c.camera=a;return c};e.create_subs_anchor_visibility=function(a){var c=r(18);c.clear_color=!0;c.clear_depth=!1;c.camera=a;return c};e.create_subs_shadow_receive=
function(a,d,b){a=r(9);a.camera=d;A(a,b);return a};e.create_subs_depth_pack=function(a){var c=r(19);c.clear_color=!1;c.clear_depth=!1;c.camera=a;c.is_pp=!0;return c};e.create_subs_ssao=function(a,d,b){var c=r(20);c.clear_color=!1;c.clear_depth=!1;c.depth_test=!1;c.camera=a;c.fog_color_density=d.fog_color_density;c.water_fog_color_density.set(d.fog_color_density);c.ssao_radius_increase=b.radius_increase;c.ssao_hemisphere=b.hemisphere;c.ssao_influence=b.influence;c.ssao_dist_factor=b.dist_factor;c.ssao_samples=
b.samples;c.is_pp=!0;return c};e.create_subs_ssao_blur=function(a,d){var b=r(21);b.clear_color=!1;b.clear_depth=!1;b.depth_test=!1;b.camera=a;b.ssao_blur_depth=d.blur_depth;b.ssao_blur_discard_value=d.blur_discard_value;b.is_pp=!0;return b};e.create_subs_aa=function(a){var c=r(22);c.clear_color=!1;c.clear_depth=!1;c.depth_test=!1;c.texel_size_multiplier=1/a.resolution_factor;c.fxaa_quality=a.aa_quality;c.camera=B.create_camera(B.TYPE_NONE);c.is_pp=!0;return c};e.create_subs_smaa=function(a,d){var b=
r(a);b.clear_color=23==a||24==a?!0:!1;b.clear_depth=!1;b.depth_test=!1;b.texel_size_multiplier=1/d.resolution_factor;b.camera=B.create_camera(B.TYPE_NONE);23==a&&(b.jitter_subsample_ind=new Float32Array(4));b.is_pp=!0;return b};e.create_subs_compositing=function(a,d,b,f){var c=r(27);c.clear_color=!1;c.clear_depth=!1;c.depth_test=!1;c.camera=B.create_camera(B.TYPE_NONE);c.brightness=a;c.contrast=d;c.exposure=b;c.saturation=f;c.is_pp=!0;return c};e.create_subs_motion_blur=function(a,d){var b=r(28);
b.clear_color=!1;b.clear_depth=!1;b.depth_test=!1;b.camera=B.create_camera(B.TYPE_NONE);b.assign_texture=!0;b.mb_decay_threshold=a;b.mb_factor=d;b.is_pp=!0;return b};e.create_subs_coc=function(a,d){var b=r(29);b.clear_color=!1;b.clear_depth=!1;b.depth_test=!1;b.camera=a;b.texel_size_multiplier=b.camera.dof_power;b.coc_type=d;b.is_pp=!0;return b};e.create_subs_dof=function(a,d){var b=r(30);b.clear_color=!1;b.clear_depth=!1;b.depth_test=!1;b.camera=a;b.texel_size_multiplier=a.dof_power;b.dof_bokeh=
d;b.is_pp=!0;return b};e.create_subs_outline_mask=function(a,d){var b=r(31);b.depth_test=!1;b.camera=a;A(b,d);return b};e.create_subs_outline=function(a){var c=r(32);l.outlining_overview_mode?c.outline_color.set(l.outline_color):c.outline_color.set(a.outline_color);c.outline_factor=a.outline_factor;c.ext_texel_size_mult=5;c.blur_texel_size_mult=3;c.depth_test=!1;c.camera=B.create_camera(B.TYPE_NONE);c.is_pp=!0;return c};e.create_subs_god_rays=function(a,d,b,f,l,k,e){var c=r(33);c.clear_color=!1;c.clear_depth=
!1;c.depth_test=!1;c.horizon_color=new Float32Array([1,1,1]);c.zenith_color=new Float32Array([1,1,1]);c.environment_energy=1;c.pack=f;c.water=d;c.radial_blur_step=l;c.max_ray_length=b;c.steps_per_pass=e;c.camera=a;A(c,k);return c};e.create_subs_god_rays_comb=function(a,d){var b=r(34);b.clear_color=!1;b.clear_depth=!1;b.depth_test=!1;b.camera=B.create_camera(B.TYPE_NONE);b.god_rays_intensity=a;A(b,d);b.is_pp=!0;return b};e.create_subs_sky=function(a,d,b,f){var c=r(35);c.enqueue=!1;c.clear_color=!1;
c.clear_depth=!1;c.depth_test=!1;var l=B.create_camera(B.TYPE_NONE);l.width=f;l.height=f;c.camera=l;c.cube_view_matrices=y._5();A(c,d);c.horizon_color=new Float32Array([1,1,1]);c.zenith_color=new Float32Array([1,1,1]);c.environment_energy=1;c.sky_color.set(b.sky_color);c.procedural_skydome=b.procedural_skydome;c.use_as_environment_lighting=b.use_as_environment_lighting;c.rayleigh_brightness=b.rayleigh_brightness;c.mie_brightness=b.mie_brightness;c.spot_brightness=b.spot_brightness;c.scatter_strength=
b.scatter_strength;c.rayleigh_strength=b.rayleigh_strength;c.mie_strength=b.mie_strength;c.rayleigh_collection_power=b.rayleigh_collection_power;c.mie_collection_power=b.mie_collection_power;c.mie_distribution=b.mie_distribution;if(a){c.horizon_color.set(a.horizon_color);c.zenith_color.set(a.zenith_color);c.environment_energy=a.environment_energy;if(d=a.sky_texture_param)c.sky_tex_fac.set([d.blend_factor,d.horizon_factor,d.zenith_up_factor,d.zenith_down_factor]),c.sky_tex_color.set(d.color),c.sky_tex_default_value=
d.default_value,c.sky_invert=d.invert,c.sky_use_rgb_to_intensity=d.use_rgb_to_intensity,c.sky_use_map_blend=d.use_map_blend,c.sky_use_map_horizon=d.use_map_horizon,c.sky_use_map_zenith_up=d.use_map_zenith_up,c.sky_use_map_zenith_down=d.use_map_zenith_down,c.sky_blend_type=d.blend_type;c.use_sky_blend=a.use_sky_blend;c.use_sky_paper=a.use_sky_paper;c.use_sky_real=a.use_sky_real;c.sky_ngraph_proxy_id=a.ngraph_proxy_id}return c};e.create_subs_irradiance=function(a,d){var b=r(46);b.enqueue=!1;b.clear_color=
!1;b.clear_depth=!1;b.depth_test=!1;var c=B.create_camera(B.TYPE_NONE);c.width=d;c.height=d;b.camera=c;b.cube_view_matrices=y._5();A(b,a);return b};e.create_subs_rougness_convolution=function(a){var c=r(47);c.enqueue=!1;c.clear_color=!1;c.clear_depth=!1;c.depth_test=!1;var b=B.create_camera(B.TYPE_NONE);b.width=128;b.height=128;c.camera=b;c.cube_view_matrices=y._5();A(c,a);return c};e.create_subs_brdf=function(){var a=r(48);a.enqueue=!1;a.clear_color=!1;a.clear_depth=!1;a.depth_test=!1;var d=B.create_camera(B.TYPE_NONE);
d.width=512;d.height=512;a.camera=d;return a};e.create_subs_copy=function(){var a=r(36);a.clear_color=!1;a.clear_depth=!1;a.camera=B.create_camera(B.TYPE_NONE);a.is_pp=!0;return a};e.create_subs_stereo=function(a,d){var b=r(37);b.clear_color=!1;b.clear_depth=!1;b.subtype=a?"HMD":d?"ANAGLYPH":"SIDEBYSIDE";b.camera=B.create_camera(B.TYPE_NONE);b.is_pp=!0;return b};e.create_subs_luminance=function(){var a=r(38);a.clear_color=!1;a.clear_depth=!1;a.camera=B.create_camera(B.TYPE_NONE);a.is_pp=!0;return a};
e.create_subs_av_luminance=function(){var a=r(39);a.clear_color=!1;a.clear_depth=!1;a.camera=B.create_camera(B.TYPE_NONE);a.is_pp=!0;return a};e.create_resize_subs=function(){var a=r(45);a.clear_color=!1;a.clear_depth=!1;a.camera=B.create_camera(B.TYPE_NONE);a.is_pp=!0;return a};e.create_subs_luminance_truncated=function(a,d,b,f){var c=r(40);c.clear_color=!1;c.clear_depth=!1;c.bloom_key=a;c.bloom_edge_lum=d;c.camera=f;A(c,b);c.is_pp=!0;return c};e.create_subs_bloom_combine=function(a,d){var b=r(41);
b.clear_color=!1;b.clear_depth=!1;b.camera=B.create_camera(B.TYPE_NONE);b.bloom_blur=a;b.bloom_blur_num=d;b.is_pp=!0;return b};e.create_subs_veloctity=function(a){var c=r(42);c.clear_color=!1;c.clear_depth=!1;c.camera=a;c.is_pp=!0;return c};e.create_subs_sink=function(){var a=r(43);a.enqueue=!1;return a};e.create_subs_perf=function(){var a=r(44);a.is_pp=!0;return a};e.subs_label=function(a){switch(a.type){case 0:return"MAIN OPAQUE";case 1:return"MAIN BLEND";case 2:return"MAIN XRAY";case 3:return"MAIN PLANE REFLECT";
case 4:return"MAIN CUBE REFLECT";case 5:return"MAIN PLANE REFLECT BLEND";case 6:return"MAIN CUBE REFLECT BLEND";case 7:return"MAIN GLOW";case 8:return"SHADOW CAST";case 9:return"SHADOW RECEIVE";case 10:return"GRASS MAP";case 11:return"POSTPROCESSING ("+a.pp_effect.replace(/_/g," ")+")";case 13:return"GLOW COMBINE";case 14:return"RESOLVE";case 15:return"COLOR PICKING";case 16:return"COLOR PICKING XRAY";case 17:return"DEBUG VIEW";case 18:return"ANCHOR VISIBILITY";case 19:return"DEPTH PACK";case 20:return"SSAO";
case 21:return"SSAO BLUR";case 22:return"ANTIALIASING";case 23:return"SMAA BLENDING WEIGHT CALCULATION";case 24:return"SMAA EDGE DETECTION";case 25:return"SMAA RESOLVE";case 26:return"SMAA NEIGHBORHOOD BLENDING";case 27:return"COMPOSITING";case 28:return"MOTION BLUR";case 29:return"COC";case 30:return"DOF";case 31:return"OUTLINE MASK";case 32:return"OUTLINE";case 33:return"GOD RAYS";case 34:return"GOD RAYS COMBINE";case 35:return"SKY";case 46:return"IRRADIANCE";case 47:return"ROUGHNESS_CONVOLUTION";
case 48:return"PRE-COMPUTE_BRDF";case 36:return"COPY";case 37:return"STEREO";case 38:return"LUMINANCE";case 39:return"AVERAGE LUMINANCE";case 40:return"LUMINANCE TRUNCED";case 41:return"BLOOM";case 42:return"VELOCITY";case 44:return"PERFORMANCE";case 43:return"SINK";case 45:return"RESIZE";default:return"UNKNOWN"}};e.append_draw_data=function(a,d){for(var b=d.batch,c=b.shader,l=b.alpha_antialiasing,k=0;k<a.draw_data.length;k++){var e=a.draw_data[k].bundles,m=e.indexOf(d);if(-1!=m&&(e.splice(m,1),!e.length)){a.draw_data.splice(k,
1);break}}k=a.blend?b.offset_z:0;a:{e=a.draw_data;for(m=0;m<e.length;m++){var p=e[m];if(p.shader==c&&p.alpha_antialiasing==l&&p.offset_z==k&&p.is_sky==b.is_sky){e=p;break a}}e=null}e?e.bundles.push(d):(a.draw_data.push({shader:c,bundles:[d],alpha_antialiasing:l,offset_z:k,is_sky:b.is_sky,do_render:!0,z_index:Infinity}),a.need_draw_data_sort=!0)};e.init_bundle=function(a,l,b){l={do_render:!0,do_render_cube:[!0,!0,!0,!0,!0,!0],obj_render:l,batch:a,world_bounds:b||null,info_for_z_sort_updates:null,z_index:Infinity};
a.z_sort&&a.bufs_data.ibo_array&&(b=a.bufs_data.ibo_array,l.info_for_z_sort_updates={median_cache:new Float32Array(b.length),median_world_cache:new Float32Array(b.length),dist_cache:new Float32Array(b.length/3),zsort_eye_last:new Float32Array(3),bb_min_side:d.m(a.bounds_local.bb)});return l};e.sort_draw_data=function(a){a.draw_data.sort(u);a.need_draw_data_sort=!1}});t.a=e},function(C,t,e){C=e(0);var R=e(38),V=e(5),n=e(16),y=e(25),d=e(14),k=e(4),I=e(58),A=e(15),r=e(30),p=e(20),u=e(57),a=e(74),B=e(52),
l=e(9),c=e(47),m=e(19),b=e(1),f=e(63),T=e(8),fa=e(10),z=e(11),G=e(23),E=e(17),J=e(18),M=e(13),F=e(6),U=e(2),K=e(3),sa=e(56),v=e(55),Y=e(22);e=Object(C.a)("__objects",function(e,S){function L(a){var g=a.scenes_data;a=a.render;for(var b=0;b<g.length;b++){var c=g[b].scene;c._render.outline&&a.outline_intensity&&Ba.request_outline(c)}}function q(a){a.render.outline_intensity=0;a=Oa.indexOf(a);-1!=a&&Oa.splice(a,1)}function w(a){if(a.field)for(var g=a.scenes_data,b=0;b<g.length;b++)Ba.update_force_scene(g[b].scene,
a)}function ea(a,g){for(var b=a.scenes_data,c=g.scenes_data,h=0;h<b.length;h++){for(var f=!1,d=0;d<c.length;d++)if(b[h].scene==c[d].scene){f=!0;break}f||H(g,b[h].scene)&&qa.append_scene_data(g,b[h].scene)}}function H(a,g){return!g._is_main&&"SPEAKER"==a.type||!g._is_primary_thread&&"LAMP"==a.type?!1:!0}function D(a){var g=pa.bpy_mesh_empty_is_animatable(a),b=a.b4w_do_not_batch,c=a.b4w_collision,f=a.b4w_vehicle,d=a.b4w_floating,l=a.b4w_character,k=na.has_dynamic_grass_particles(a),e=wa.bpy_obj_has_nla(a),
w=0<a.data.b4w_shape_keys.length,q=a.b4w_dynamic_geometry,D=h(a);if(!(g=g||b||c||f||w||d||k||l||e||q))a:{a=a.data;for(g=0;g<a.materials.length;g++)if(b=a.materials[g],b.water_settings.is_water||b.is_lens_flares||ra(b.node_tree)){g=!0;break a}g=!1}return g||D}function h(a){var g=!1,b=a.constraints.length;if(b){for(var c=null,b=b-1;0<=b;b--){var h=a.constraints[b];if("LOCKED_TRACK"!=h.type||"REFLECTION PLANE"!=h.name){c=h;break}}if(!c||!c.target)return!1;a=c.target;c=a.type;if(a.parent)return c=a.parent.type,
g="MESH"==c?g||D(a.parent):"EMPTY"==c?g||ha(a.parent):!0;g="MESH"==c?g||D(a):"EMPTY"==c?g||ha(a):!0}return g}function ha(a){var g=pa.bpy_mesh_empty_is_animatable(a),b=wa.bpy_obj_has_nla(a),c=a.b4w_do_not_batch,f=!!a.b4w_anchor;a=h(a);return g||b||c||f||a}function ra(a){if(!a)return!1;a=a.nodes;for(var g=0;g<a.length;g++){var b=a[g];if("VECT_TRANSFORM"==b.type){var c=b.convert_from,h=b.convert_to,f=b.outputs[0];if(!(!f.is_linked||"WORLD"==c&&"CAMERA"==h||"CAMERA"==c&&"WORLD"==h||"OBJECT"==c&&"OBJECT"==
h))return!0}if("NORMAL_MAP"==b.type&&(c=b.space,f=b.outputs[0],f.is_linked&&("OBJECT"==c||"BLENDER_OBJECT"==c))||"TEX_COORD"==b.type&&b.outputs[3].is_linked||"OBJECT_INFO"==b.type&&(f=b.outputs[1],c=b.outputs[3],b.outputs[0].is_linked||f.is_linked||c.is_linked))return!0}return!1}function za(a){if(da(a,Ua.ALL,!1,-1)){for(var b=1,c;;){c="."+(3>String(b).length?("000"+String(b)).slice(-3):String(b));if(!da(a+c,Ua.ALL,!1,-1))break;b++}g.error('Object "'+a+'" already exists. Name was replaced by "'+a+
c+'".');return c}return""}function P(a,g,b){g=Ua[g]||[];for(var c=[],h=0;h<g.length;h++){var f=g[h];if(f.render.data_id==b||-1==b)for(var d=f.scenes_data,l=0;l<d.length;l++)d[l].scene==a&&c.push(f)}return c}function t(a,g){var b=Ua[a]||[];if(-1==g)return b;for(var c=[],h=0;h<b.length;h++){var f=b[h];f.render.data_id==g&&c.push(f)}return c}function Q(a,g,b,c){for(var h=0;h<a.scenes_data.length;h++)for(var f=a.scenes_data[h].batches,d=0;d<f.length;d++){var l=f[d];l.bufs_data&&(l.bufs_data.cleanup_gl_data_on_unload=
g);l.cleanup_gl_data_on_unload=g;l.shader&&(l.shader.cleanup_gl_data_on_unload=b);Ca.set_cleanup_nodemat(c)}}function da(a,g,b,c,h){for(var f=null,d=0;d<g.length;d++){var l=g[d];if(!((b?l.origin_name:l.name)!=a||l.render.data_id!=c&&-1!=c||h&&l.is_meta||(f=l,qa.get_dg_parent(f))))break}return f}function ja(a){Ua.ALL.push(a);Ua[a.type]||(Ua[a.type]=[]);Ua[a.type].push(a);var g=a.render.plane_reflection_id;if(null!=g)for(var b=0;b<Z.length;b++){var c=Z[b];c.render.plane_reflection_id==g&&c.reflective_objs.push(a)}}
function va(a,g,b){if(!g.is_lod)return!0;a=a.lod_settings;if(a.dest_coverage!=a.coverage)if(a.use_smoothing){var c=U._50(a.dest_coverage-a.coverage);a.coverage+=c*fb.get_delta()/.4;a.coverage=U.M(a.coverage,0,1)}else a.coverage=a.dest_coverage;c="STATIC"==g.type?g.lod_center:K.add(g.bs_world.center,g.main_lod_offset,Qa);b=K.dist(c,b);0==a.hyst_prev_state?(c=Math.max(g.lod_dist_min-a.hyst_interval_min/2,0),g=g.lod_dist_max+a.hyst_interval_max/2):-1==a.hyst_prev_state?(c=g.lod_dist_min+a.hyst_interval_min/
2,g=g.lod_dist_max+a.hyst_interval_max/2):(c=Math.max(g.lod_dist_min-a.hyst_interval_min/2,0),g=Math.max(g.lod_dist_max-a.hyst_interval_max/2,0));a.hyst_prev_state=b<c?-1:b<g?0:1;a.dest_coverage=b<c||b>g?0:1;a.cmp_logic=0==a.dest_coverage?-1:1;Math.abs(b-a.prev_dist)>W.lod_leap_smooth_threshold&&(0==a.coverage||1==a.coverage)&&(a.coverage=a.dest_coverage);a.prev_dist=b;return 0!=a.dest_coverage||0!=a.coverage}function Ga(a,g){Q(a,!0,!1,!0);for(var b=t("ALL",-1),c=0;c<b.length;c++){var h=b[c];h!=a&&
Q(h,!1,!1,!1)}Ba.remove_object_bundles(a,g);for(c=0;c<a.scenes_data.length;c++)for(h=a.scenes_data[c].batches.length-1;0<=h;h--){var f=a.scenes_data[c].batches[h];0!=f.material_names.length&&-1==f.material_names.indexOf(g)||qa.scene_data_remove_batch(a.scenes_data[c],h)}Ja.obj_has_physics(a)&&Ja.remove_object(a);for(c=0;c<b.length;c++)b[c]!=a&&Q(b[c],!0,!0,!0);pa.delete_cached_anim_data_by_mat(a,g);b=a._bpy_obj._object;a._bpy_obj._object=a;return b}function ba(a,g){a._bpy_obj._object=g;Q(a,!0,!0,
!0)}function Ea(a,g,b,c){var h=a.mat_inheritance_data.original_mat_names.indexOf(g);g=b.mat_inheritance_data.original_mat_names.indexOf(c);h=a.materials[h];b.materials[g]=h;a=h.name;h.name=c;for(c=0;c<b.materials.length;c++)b.mat_inheritance_data.is_disabled[c]=c!=g;return a}function ta(a,g,b,c){for(var h=0;h<b.materials.length;h++)b.mat_inheritance_data.is_disabled[h]=!1;g=a.mat_inheritance_data.original_mat_names.indexOf(g);a.materials[g].name=c}function X(a,g,b,c,h){for(var f=1;f<a.render.shape_keys_values.length;f++)O.apply_shape_key(a,
a.render.shape_keys_values[f].name,a.render.shape_keys_values[f].value);if(pa.is_animated(a))for(f=0;f<a.anim_slots.length;f++){var d=a.anim_slots[f];if(d)switch(d.type){case pa.OBJ_ANIM_TYPE_PARTICLES:d=pa.get_current_frame_float(a,f);pa.set_frame(a,d,f);break;case pa.OBJ_ANIM_TYPE_MATERIAL:if(d.node_batches)for(var l=d.node_batches.length-1;0<=l;l--)-1!=d.node_batches[l].material_names.indexOf(g)&&d.node_batches.splice(l,1)}}c&&Ca.iterate_batches_by_mat(a,g,function(g){if(g.particles_data){var b=
g.particles_data.name;if(c[b]){var h=g.particles_data.count_factor!=c[b].count_factor;g.particles_data=na.clone_particles_data(c[b]);h&&na.set_factor(a,b,g.particles_data.count_factor)}}},"PARTICLES");h&&(f=Ca.find_batch_material(a,g,"MAIN"))&&(f.diffuse_color.set(h.diffuse_color),f.diffuse_intensity=h.diffuse_intensity,f.diffuse_color_factor=h.diffuse_color_factor,f.diffuse_params.set(h.diffuse_params),f.specular_color.set(h.specular_color),f.specular_color_factor=h.specular_color_factor,f.specular_params.set(h.specular_params),
f.specular_alpha=h.specular_alpha,f.emit=h.emit,f.ambient=h.ambient,f.alpha_factor=h.alpha_factor,f.mirror_factor=h.mirror_factor,f.normal_factor=h.normal_factor,f.reflect_factor=h.reflect_factor,f.refr_bump=h.refr_bump,f.fresnel_params.set(h.fresnel_params),f.parallax_scale=h.parallax_scale,f.texture_scale.set(h.texture_scale),f.shallow_water_col.set(h.shallow_water_col),f.shallow_water_col_fac=h.shallow_water_col_fac,f.shore_water_col.set(h.shore_water_col),f.shore_water_col_fac=h.shore_water_col_fac,
f.foam_factor=h.foam_factor,f.water_norm_uv_velocity=h.water_norm_uv_velocity,f.node_values=h.node_values.slice(),f.node_rgbs=h.node_rgbs.slice());Ca.iterate_batches_by_mat(a,g,function(g){for(var c=0;c<g.bpy_tex_names.length;c++){var h=g.bpy_tex_names[c],f=g.textures[c];if("IMAGE"==f.source||"ENVIRONMENT"==f.source){var d=Ka.get_texture_by_name(b,h);d&&f.img_full_filepath!=d.img_full_filepath&&Ka.set_texture_by_name(a,h,d)}}})}var pa=Object(R.a)(e),ka=Object(V.a)(e),Ca=Object(n.a)(e),C=Object(d.a)(e),
Aa=Object(k.a)(e),xa=Object(I.a)(e),ga=Object(A.a)(e),ya=Object(r.a)(e),O=Object(p.a)(e),wa=Object(B.a)(e),qa=Object(l.a)(e),na=Object(c.a)(e),Ja=Object(m.a)(e),g=Object(b.a)(e),Da=Object(f.a)(e),Ba=Object(fa.a)(e),Ta=Object(z.a)(e),ma=Object(G.a)(e),Ka=Object(E.a)(e),fb=Object(J.a)(e),La=Object(M.a)(e),Xa=Object(v.a)(e),Wa=Object(Y.a)(e),W=Aa.defaults,Ia=Aa.outlining,Ua={ALL:[]},Na=0,Va=0,Z=[],Oa=[],Qa=new Float32Array(3),$a=new Float32Array(4);S.GET_OBJECT_BY_NAME=0;S.GET_OBJECT_BY_DUPLI_NAME=1;
S.GET_OBJECT_BY_DUPLI_NAME_LIST=2;S.DATA_ID_ALL=-1;S.update=function(a,g){for(var b=0;b<Oa.length;b++){var c=Oa[b];var h=c,f=a,d=0,l=h.outline_animation;0==l.time_start&&(l.time_start=f);f-=l.time_start;if(l.relapses&&f/l.period>=l.relapses)q(h);else{f%=l.period;if(f<l.outline_time)switch(l=f/(l.outline_time/5),f=Math.floor(l),f){case 0:d=(l-f)/2;break;case 1:d=(l-f)/2+.5;break;case 2:d=1;break;case 3:d=1-(l-f)/2;break;case 4:d=.5-(l-f)/2}h.render.outline_intensity=d}c.render.outline_intensity&&L(c)}if(c=
Ua.ARMATURE)for(b=0;b<c.length;b++)h=c[b],h.need_update_transform&&(La.update_transform(h),h.need_update_transform=!1)};S.set_outline_intensity=function(a,g){a.render.outline_intensity=g;L(a)};S.apply_outline_anim=function(a,g,b,c){var h=a.outline_animation;h.time_start=0;h.outline_time=g;h.period=b;h.relapses=c;-1==Oa.indexOf(a)&&Oa.push(a)};S.clear_outline_anim=q;S.create_object_from_bpy=function(a,g){var b=qa.create_object(g?"%meta_world%"+a.name:a.name,g?"WORLD":a.type,g?"%meta_world%"+a.name:
a.origin_name);if("MESH"==b.type)for(var c=0;c<a.data.materials.length;c++)b.materials.push(a.data.materials[c]);for(c=0;c<a._scenes.length;c++)qa.append_scene_data(b,a._scenes[c]);a._object=b;if(g)b.uuid=a.uuid,b.is_meta=!1,b.def_action_slots=a._def_action_slots,b.is_dynamic=a._is_dynamic,b.render=qa.create_render(b.type),b.use_default_animation=a.b4w_use_default_animation,b.anim_behavior_def=pa.anim_behavior_bpy_b4w(a.b4w_anim_behavior);else{b.uuid=a.uuid;b.is_meta=!1;b.def_action_slots=a._def_action_slots;
b.is_dynamic=a._is_dynamic;b.is_hair_dupli=a._is_hair_dupli||!1;b.is_vehicle=a.b4w_vehicle;b.is_character=a.b4w_character;b.is_floating=a.b4w_floating;b.use_obj_physics=a.b4w_collision;b.collision_id=a.b4w_collision_id;b.correct_bounding_offset=a.b4w_correct_bounding_offset;c=a.game;b.physics_settings={physics_type:c.physics_type,use_ghost:c.use_ghost,use_sleep:c.use_sleep,mass:c.mass,velocity_min:c.velocity_min,velocity_max:c.velocity_max,damping:c.damping,rotation_damping:c.rotation_damping,lock_location_x:c.lock_location_x,
lock_location_y:c.lock_location_y,lock_location_z:c.lock_location_z,lock_rotation_x:c.lock_rotation_x,lock_rotation_y:c.lock_rotation_y,lock_rotation_z:c.lock_rotation_z,collision_margin:c.collision_margin,collision_group:c.collision_group,collision_mask:c.collision_mask,use_collision_bounds:c.use_collision_bounds,collision_bounds_type:c.collision_bounds_type,use_collision_compound:c.use_collision_compound};if(c=a.b4w_vehicle_settings)b.vehicle_settings={name:c.name,part:c.part,suspension_rest_length:c.suspension_rest_length,
suspension_compression:c.suspension_compression,suspension_stiffness:c.suspension_stiffness,suspension_damping:c.suspension_damping,wheel_friction:c.wheel_friction,roll_influence:c.roll_influence,max_suspension_travel_cm:c.max_suspension_travel_cm,force_max:c.force_max,brake_max:c.brake_max,steering_max:c.steering_max,max_speed_angle:c.max_speed_angle,delta_tach_angle:c.delta_tach_angle,speed_ratio:c.speed_ratio,steering_ratio:c.steering_ratio,inverse_control:c.inverse_control,floating_factor:c.floating_factor,
water_lin_damp:c.water_lin_damp,water_rot_damp:c.water_rot_damp,synchronize_position:c.synchronize_position};if(c=a.b4w_floating_settings)b.floating_settings={name:c.name,part:c.part,floating_factor:c.floating_factor,water_lin_damp:c.water_lin_damp,water_rot_damp:c.water_rot_damp,synchronize_position:c.synchronize_position};if(c=a.b4w_character_settings)b.character_settings={walk_speed:c.walk_speed,run_speed:c.run_speed,step_height:c.step_height,jump_strength:c.jump_strength,waterline:c.waterline};
for(c=0;c<a.constraints.length;c++){var h=a.constraints[c];"RIGID_BODY_JOINT"==h.type&&b.physics_constraints.push({target:h.target._object,pivot_type:h.pivot_type,pivot_x:h.pivot_x,pivot_y:h.pivot_y,pivot_z:h.pivot_z,axis_x:h.axis_x,axis_y:h.axis_y,axis_z:h.axis_z,use_limit_x:h.use_limit_x,use_limit_y:h.use_limit_y,use_limit_z:h.use_limit_z,use_angular_limit_x:h.use_angular_limit_x,use_angular_limit_y:h.use_angular_limit_y,use_angular_limit_z:h.use_angular_limit_z,limit_max_x:h.limit_max_x,limit_max_y:h.limit_max_y,
limit_max_z:h.limit_max_z,limit_min_x:h.limit_min_x,limit_min_y:h.limit_min_y,limit_min_z:h.limit_min_z,limit_angle_max_x:h.limit_angle_max_x,limit_angle_max_y:h.limit_angle_max_y,limit_angle_max_z:h.limit_angle_max_z,limit_angle_min_x:h.limit_angle_min_x,limit_angle_min_y:h.limit_angle_min_y,limit_angle_min_z:h.limit_angle_min_z})}c=b.render=qa.create_render("MESH"===b.type?b.is_dynamic?"DYNAMIC":"STATIC":b.type);if(a.parent){if(b.parent=a.parent._object,"BONE"==a.parent_type&&"ARMATURE"==a.parent.type&&
(b.parent_bone=a.parent_bone),a.pinverse_tsr)if(9===a.pinverse_tsr.length)b.pinverse_tsr=F.a(a.pinverse_tsr,F.b());else{b.pinverse_tsr=F.b();var h=K.set(a.pinverse_tsr[0],a.pinverse_tsr[1],a.pinverse_tsr[2],Qa),f=a.pinverse_tsr[3],d=T.set(a.pinverse_tsr[4],a.pinverse_tsr[5],a.pinverse_tsr[6],a.pinverse_tsr[7],$a);F.t(h,f,d,b.pinverse_tsr)}}else a.dg_parent&&(b.parent=a.dg_parent._object,b.parent_is_dupli=!0);h=a.location;f=a.scale;U._29(a.rotation_quaternion,$a);La.set_translation(b,h);La.set_rotation(b,
$a);La.set_scale(b,f);b.use_default_animation=a.b4w_use_default_animation;b.anim_behavior_def=pa.anim_behavior_bpy_b4w(a.b4w_anim_behavior);a.b4w_object_tags&&(b.metatags={title:a.b4w_object_tags.title,description:a.b4w_object_tags.description,category:a.b4w_object_tags.category});b.custom_prop=a.b4w_custom_prop;a.b4w_viewport_alignment&&(b.viewport_alignment={alignment:a.b4w_viewport_alignment.alignment,distance:a.b4w_viewport_alignment.distance});c.hide=a.b4w_hidden_on_load;c.hide_children=a.b4w_hide_chldr_on_load;
switch(a.type){case "ARMATURE":sa.e(a,b);h=c.bone_pointers;f=pa.calc_pose_data(h);a.b4w_animation_mixing?(c.quats_before=new Float32Array(f.quats),c.quats_after=new Float32Array(f.quats),c.trans_before=new Float32Array(f.trans),c.trans_after=new Float32Array(f.trans)):(c.quats_before=f.quats,c.quats_after=f.quats,c.trans_before=f.trans,c.trans_after=f.trans);for(var l in h)d=h[l],1==d.chain.length&&sa.d(d,!0,f.trans,f.quats);c.pose_data=f;c.frame_factor=0;c.anim_mixing=a.b4w_animation_mixing;break;
case "MESH":c.bb_original=Ca.bb_bpy_to_b4w(a.data.b4w_boundings.bb);b.is_boundings_overridden=a.data.is_boundings_overridden;c.do_not_render=a.b4w_do_not_render;c.selectable=Ia.outlining_overview_mode||a.b4w_selectable;c.origin_selectable=a.b4w_selectable;c.outlining=Ia.outlining_overview_mode||a.b4w_outlining;c.origin_outlining=a.b4w_outlining;c.outline_on_select=Ia.outlining_overview_mode||a.b4w_outline_on_select;c.billboard=a.b4w_billboard;c.billboard_pres_glob_orientation=a.b4w_pres_glob_orientation;
c.billboard_type="BASIC";c.billboard_spherical="SPHERICAL"==a.b4w_billboard_geometry;l=c.outline_anim_settings_default;l.outline_duration=a.b4w_outline_settings.outline_duration;l.outline_period=a.b4w_outline_settings.outline_period;l.outline_relapses=a.b4w_outline_settings.outline_relapses;c.selectable&&(c.color_id=ya.gen_color_id(Na),Na++);for(l=0;l<a.data.b4w_vertex_anim.length;l++)h=a.data.b4w_vertex_anim[l],b.vertex_anim.push({name:h.name,frame_start:h.frame_start,frame_end:h.frame_end,averaging:h.averaging,
averaging_interval:h.averaging_interval,allow_nla:h.allow_nla});b.render.vertex_anim=b.vertex_anim.length?!0:!1;"MESH"!=a.type&&ka.panic("Wrong object type: "+a.name);l=b.render;if(a.data.b4w_shape_keys.length)for(l.use_shape_keys=!0,h=0;h<a.data.b4w_shape_keys.length;h++)f={},f.value=a.data.b4w_shape_keys[h].value,f.name=a.data.b4w_shape_keys[h].name,l.shape_keys_values.push(f);else l.use_shape_keys=!1;c.shadow_cast=a.b4w_shadow_cast;c.shadow_receive=a.b4w_shadow_receive;c.shadow_cast_only=a.b4w_shadow_cast_only&&
c.shadow_cast;c.reflexible=a.b4w_reflexible;c.reflexible_only=a.b4w_reflexible_only&&c.reflexible;c.reflective=a.b4w_reflective;c.reflection_type=a.b4w_reflection_type;if(!c.reflective)for(l=b.materials,h=0;h<l.length;h++)f=l[h],!f.use_nodes||-1==f.node_tree._bsdf_types.indexOf("BSDF_GLOSSY")&&-1==f.node_tree._bsdf_types.indexOf("BSDF_DIFFUSE")&&-1==f.node_tree._bsdf_types.indexOf("BSDF_PRINCIPLED")||(b.render.reflective=!0,b.render.reflection_type="PBR");c.caustics=a.b4w_caustics;if(c.wind_bending=
a.b4w_wind_bending)c.wind_bending_angle=a.b4w_wind_bending_angle,l=Ca.wb_angle_to_amp(U.T(a.b4w_wind_bending_angle),c.bb_original,a.scale[0]),c.wind_bending_amp=l,c.wind_bending_freq=a.b4w_wind_bending_freq,c.detail_bending_freq=a.b4w_detail_bending_freq,c.detail_bending_amp=a.b4w_detail_bending_amp,c.branch_bending_amp=a.b4w_branch_bending_amp,c.main_bend_col=a.b4w_main_bend_stiffness_col,l=a.b4w_detail_bend_colors,c.detail_bend_col.leaves_stiffness=l.leaves_stiffness_col,c.detail_bend_col.leaves_phase=
l.leaves_phase_col,c.detail_bend_col.overall_stiffness=l.overall_stiffness_col;c.dynamic_geometry=a.b4w_dynamic_geometry;if(c.dynamic_geometry)for(b._bpy_obj=a,l=0;l<b.materials.length;l++)b.mat_inheritance_data.original_mat_names.push(b.materials[l].name),b.mat_inheritance_data.is_disabled.push(!1);l=b.materials[0];c.friction=l.physics_settings.friction;c.elasticity=l.physics_settings.elasticity;c.lod_dist_min=0;c.lod_dist_max=qa.LOD_DIST_MAX_INFINITY;c.pass_index=a.pass_index;break;case "LINE":c.bb_local=
y.w();c.be_local=y.y();c.bb_world=y.w();c.be_world=y.y();break;case "CAMERA":C.camera_object_to_camera(a,b);C.assign_boundings(b);break;case "LAMP":u.a(a,b);break;case "SPEAKER":b.sfx=ma.create_sfx();c=!1;for(l=0;l<b.scenes_data.length;l++)if(b.scenes_data[l].scene._sfx){c=!0;break}c&&ma.update_object(a,b);break;case "EMPTY":l=y.w(),c.bb_local=l,l=y.A(),c.bs_local=l,a.field&&(b.field={type:a.field.type,strength:a.field.strength}),a.b4w_anchor&&(b.anchor={type:a.b4w_anchor.type,detect_visibility:a.b4w_anchor.detect_visibility,
element_id:a.b4w_anchor.element_id,max_width:a.b4w_anchor.max_width})}}ja(b);return b};S.update_object_relations=function(a,b){var c=b.render;if("MESH"==b.type){var h=pa.get_bpy_armobj(a);if(h){var f=h._object,d=f.render.pose_data;var l=b.render,k=a.data;b.armobj=f;k=k.vertex_groups;if(k.length){var f=f.render.bone_pointers,e=0,w={},q;for(q in f){var D=U._19("name",q,k);D&&(w[q]={vgroup_index:D.index,bone_index:f[q].bone_index,deform_bone_index:e++})}l.bone_skinning_info=w;q=e;k=pa.get_max_bones();
l.max_bones=q;q>2*k?(l.is_skinning=!1,g.error('too many bones for "'+a.name+'" / '+l.max_bones+" bones (max "+k+" with blending, "+2*k+" without blending). Skinning will be disabled.")):l.is_skinning=!0}d=pa.extract_skinned_pose_data(d.trans,d.quats,c.bone_skinning_info);h.b4w_animation_mixing?(c.quats_before=new Float32Array(d.quats),c.quats_after=new Float32Array(d.quats),c.trans_before=new Float32Array(d.trans),c.trans_after=new Float32Array(d.trans)):(c.quats_before=d.quats,c.quats_after=d.quats,
c.trans_before=d.trans,c.trans_after=d.trans);c.arm_rel_trans=new Float32Array(4);c.arm_rel_quat=T.create();c.pose_data=d;c.frame_factor=0}if(c.reflective)if(c=b.render,"CUBE"==c.reflection_type)c.cube_reflection_id=Va++;else if("PLANE"==c.reflection_type){a:{h=a.constraints;for(d=0;d<h.length;d++)if(l=h[d],"LOCKED_TRACK"==l.type&&"REFLECTION PLANE"==l.name){if(l.target&&l.target._object){h=l.target._object;break a}g.warn('Reflection plane target for object: "'+b.name+"\" is not present on the scene. Using object's Z-axis.")}h=
null}h||(h=ya.unique_name("%reflection%"),h=qa.create_object(h,"EMPTY"),d=qa.create_render("EMPTY"),h.render=d,ea(b,h),xa.append_stiff_obj(h,b,[0,0,0],null,1),ja(h));d=null;for(l=0;l<Z.length;l++)if(Z[l]==h){d=l;break}null==d&&(d=Z.length,Z.push(h));h.render.plane_reflection_id=d;c.plane_reflection_id=d;h.reflective_objs.push(b)}}};S.update_force=w;S.copy_scene_data=ea;S.check_bpy_obj_scene_compatibility=H;S.update_objects_dynamics=function(a){for(var g=0;g<a.length;g++){var b=a[g];!b.render||"DYNAMIC"!=
b.render.type&&"CAMERA"!=b.render.type||La.update_transform(b);b.use_default_animation&&pa.obj_is_animatable(b)&&(pa.apply_def(b),b.anim_slots.length&&pa.play(b,null,pa.SLOT_ALL))}};S.bpy_obj_is_dynamic=function(a){if(a.b4w_hidden_on_load||a.dg_parent&&a.dg_parent._is_dynamic||a.parent&&a.parent._is_dynamic)return!0;switch(a.type){case "MESH":return D(a);case "EMPTY":return ha(a);default:return!0}};S.get_meta_tags=function(a){return U.O(a.metatags)};S.get_custom_prop=function(a){return a.custom_prop};
S.cleanup=function(){Va=Na=0;Z.length=0;Oa.length=0;Ua={ALL:[]}};S.copy=function(g,b,c){var h=qa.get_dg_parent(g),h=h?qa.gen_dupli_name(h.name,b):b,f=za(h);b=qa.create_object(h+f,g.type,b+f);b.is_meta=g.is_meta;b._bpy_obj=g._bpy_obj;b.mat_inheritance_data.original_mat_names=qa.copy_bpy_object_props_by_link(g.mat_inheritance_data.original_mat_names);b.mat_inheritance_data.is_disabled=qa.copy_bpy_object_props_by_link(g.mat_inheritance_data.is_disabled);b.is_dynamic=g.is_dynamic;b.is_hair_dupli=g.is_hair_dupli;
b.use_default_animation=g.use_default_animation;b.def_action_slots=g.def_action_slots;b.render=qa.clone_render(g.render);b.render.is_lod=!1;b.metatags=qa.copy_object_props_by_value(g.metatags);b.custom_prop=qa.copy_object_props_by_value(g.custom_prop);ea(g,b);b.action_anim_cache=qa.copy_bpy_object_props_by_link(g.action_anim_cache);b.parent=qa.copy_bpy_object_props_by_link(g.parent);b.parent_is_dupli=g.parent_is_dupli;b.parent_bone=g.parent_bone;b.vertex_anim=qa.copy_bpy_object_props_by_link(g.vertex_anim);
b.anim_behavior_def=g.anim_behavior_def;!g.physics||g.is_vehicle||g.is_character||g.is_floating||(b.use_obj_physics=g.use_obj_physics,b.physics=null);b.collision_id=g.collision_id;b.correct_bounding_offset=g.correct_bounding_offset;b.physics_settings=qa.copy_object_props_by_value(g.physics_settings);h=[];for(f=0;f<g.scenes_data.length;f++){var d=b.scenes_data[f],l=g.scenes_data[f].batches;if(c){for(var k=d.batches,e=0;e<l.length;e++)if(!l[e].forked_batch){var q=qa.copy_object_props_by_value(l[e]);
q.bufs_data=O.clone_bufs_data(l[e].bufs_data);qa.append_batch(b,d.scene,q);h.push(l[e].bufs_data)}for(e=0;e<l.length;e++)if(l[e].forked_batch){q=qa.copy_object_props_by_value(l[e]);qa.append_batch(b,d.scene,q);for(var w=0;w<h.length;w++)h[w]==l[e].bufs_data&&(q.bufs_data=k[w].bufs_data)}for(e=0;e<k.length;e++)k[e].bufs_data&&O.update_gl_buffers(k[e].bufs_data),W.allow_vao_ext&&k[e].bufs_data&&Wa.assign_vao(k[e]),k[e].odd_id_prop=Ca.generate_odd_id(k[e],b.render,b.uuid),Ca.update_batch_id(k[e]);Ka.share_batch_canvas_textures(k)}else for(e=
0;e<l.length;e++)qa.append_batch(b,d.scene,l[e])}for(h=0;h<g.materials.length;h++)b.materials.push(a.a(g.materials[h]));qa.scene_data_set_active(b,!1);ja(b);b.render.is_copied=!0;b.render.is_copied_deep=c;b.render.color_id=ya.gen_color_id(Na);Na++;return b};S.get_bpy_def_action_slots=function(a,g){var b=[],c=a.animation_data,h=a.data?a.data.animation_data:null;c&&c.action&&(c=c.action,(c._render.type==pa.OBJ_ANIM_TYPE_OBJECT||c._render.type==pa.OBJ_ANIM_TYPE_ARMATURE&&"ARMATURE"==a.type||c._render.type==
pa.OBJ_ANIM_TYPE_LIGHT&&"LAMP"==a.type||c._render.type==pa.OBJ_ANIM_TYPE_ENVIRONMENT&&g)&&b.push(pa.init_action_slot(null,c)));h&&h.action&&("SPEAKER"==a.type||"LAMP"==a.type)&&b.push(pa.init_action_slot(null,h.action));"MESH"==a.type&&b.push.apply(b,pa.get_bpy_material_actions(a));g&&b.push.apply(b,pa.get_bpy_world_material_actions(a));return b};S.update_boundings=function(a){for(var g=a.render,b=null,c=a.scenes_data[0].batches,h=0;h<c.length;h++){var f=c[h],d=a.scenes_data[0].batch_world_bounds[h];
if(f.bufs_data&&d.be&&d.bb){var l=O.get_vbo_type_by_attr_name("a_position");if(l=O.get_vbo_source_by_type(f.bufs_data.vbo_source_data,l)){var k=f.bufs_data.pointers.a_position.offset,e=f.bufs_data.pointers.a_position.length+k;Ca.update_local_bounds_from_pos(f,l.subarray(k,e));qa.update_world_bounds_from_batch_tsr(f,g.world_tsr,d);"MAIN"==f.type&&(b?y.D(b,f.bounds_local.bb):b=y.n(f.bounds_local.bb))}}}b=b||y.w();if(g.billboard)qa.update_render_bounds_billboard(a,b);else{d=[];for(h=0;h<c.length;h++)if(f=
c[h],"MAIN"==f.type&&(l=O.get_vbo_type_by_attr_name("a_position"),l=O.get_vbo_source_by_type(f.bufs_data.vbo_source_data,l)))f=c[h].bufs_data.pointers,k=f.a_position.offset,e=f.a_position.length+k,d.push(l.subarray(k,e));qa.update_render_bounds_from_pos_arrays(a,b,d)}if(W.debug_view)for(h=0;h<c.length;h++)if("DEBUG_VIEW"===c[h].type&&c[h].debug_sphere){a=g.be_local;g=Da.generate_uv_sphere(16,8,1,a.center,!1,!1);O.scale_submesh_xyz(g,[a.axis_x[0],a.axis_y[1],a.axis_z[2]],a.center);O.submesh_drop_indices(g,
1,!0);g.va_common.a_polyindex=O.extract_polyindices(g);Ca.update_batch_geometry(c[h],g);break}};S.get_scene_objs=P;S.get_scene_objs_derived=function(a,g,b){g=Ua[g]||[];for(var c=[],h=0;h<g.length;h++){var f=g[h];if(!(f.render.data_id!=b&&-1!=b||f.is_meta))for(var d=f.scenes_data,l=0;l<d.length;l++)d[l].scene==a&&c.push(f)}return c};S.get_all_objects=t;S.get_first_character=function(a){var g=Ua.MESH;if(g)for(var b=0;b<g.length;b++){var c=g[b];if(Ja.has_character_physics(c))for(var h=c.scenes_data,
f=0;f<h.length;f++)if(h[f].scene==a)return c}return null};S.obj_switch_cleanup_flags=Q;S.get_selectable_objects=function(){var a=[],g=Ua.MESH;if(g)for(var b=0;b<g.length;b++){var c=g[b];c.render.selectable&&!c.is_meta&&a.push(c)}return a};S.get_outlining_objects=function(){var a=[],g=Ua.MESH;if(g)for(var b=0;b<g.length;b++){var c=g[b];c.render.outlining&&!c.is_meta&&a.push(c)}return a};S.get_object=function(a,g,b,c){var h=null,f=Ua.ALL;switch(a){case S.GET_OBJECT_BY_NAME:h=da(g,f,!0,b,c);break;case S.GET_OBJECT_BY_DUPLI_NAME:a:{for(a=
0;a<f.length;a++)if(h=f[a],h.origin_name==b&&(h.render.data_id==c||-1==c)){var d=qa.get_dg_parent(h);if(d&&d.origin_name==g)break a}h=null}break;case S.GET_OBJECT_BY_DUPLI_NAME_LIST:a:{for(c=0;c<f.length;c++){a=f[c];for(var h=g.length-1,d=a,l=!0;0<=h&&l;)l=d&&d.origin_name==g[h]&&(d.render.data_id==b||-1==b),d&&(d=qa.get_dg_parent(d)),h--;if(l&&!d){h=a;break a}}h=null}}return h};S.get_world_by_name=function(a,g){return da("%meta_world%"+a,Ua.WORLD,!0,g)};S.get_world_name=function(a){return a.origin_name.replace("%meta_world%",
"")};S.pick_object=function(a,b){var c=Ba.get_main();if(!c)return g.error("No active scene"),null;var h=Ba.get_subs(c,Ta.STEREO);h&&h.enable_hmd_stereo&&(h=ga.get_canvas(),a=h.clientHeight/2,b=h.clientWidth/2);if(h=Xa.pick_anchor(a,b))return h;h=Ba.pick_color(c,a,b);if(!h)return null;for(var c=P(c,"MESH",-1),f=0;f<c.length;f++){var d=c[f].render,l=d.color_id;if(l&&3>Math.abs(255*l[0]-h[0])&&3>Math.abs(255*l[1]-h[1])&&3>Math.abs(255*l[2]-h[2]))return d.outlining&&d.outline_on_select&&(Ia.outlining_overview_mode?
S.apply_outline_anim(c[f],Ia.outline_duration,Ia.outline_period,Ia.outline_relapses):(h=d.outline_anim_settings_default,S.apply_outline_anim(c[f],h.outline_duration,h.outline_period,h.outline_relapses))),c[f]}return null};S.set_wind_params=function(a,b){for(var c=P(a,"EMPTY",-1),h=0;h<c.length;h++){var f=c[h];if(f.field&&"WIND"===f.field.type){var d=f;break}}if(!d)return g.error("There is no wind on the scene"),0;"number"==typeof b.wind_dir&&(c=U.T(b.wind_dir),K.set(Math.sin(c),-Math.cos(c),0,Qa),
U.U(Qa,U.f,$a),La.set_rotation(d,$a));"number"==typeof b.wind_strength&&(d.field.strength=b.wind_strength);w(d)};S.remove_object=function(a){xa.check_constraint(a)&&xa.remove(a);var g=Ua.ALL,b=Ua[a.type],c=g.indexOf(a);a=b.indexOf(a);-1!=c&&g.splice(c,1);-1!=a&&b.splice(a,1)};S.objects_storage_add=ja;S.objects_storage_check=function(a){return Ua[a.type]&&-1<Ua[a.type].indexOf(a)};S.update_lod_scene=function(a,g){if(a.render.is_lod){var b=a.render,c=g._render;if(b.is_lod)for(var h=La.get_translation(g._camera,
Qa),f=0;f<a.scenes_data.length;f++)if(a.scenes_data[f].scene==g)for(var d=0;d<a.scenes_data[f].batches.length;d++){var l=a.scenes_data[f].batches[d],k=l.lod_settings,e="SHADOW"==l.type&&"RECEIVE"==l.subtype&&!W.reuse_depth_optimization;W.lod_smooth_transitions&&!e&&(e=c.lod_smooth_type,"ALL"==e||"NON-OPAQUE"==e&&(l.blend||l.alpha_clip))&&(k.use_smoothing=!0);va(l,b,h);k.coverage=k.dest_coverage;k.hyst_interval_min=Math.min(c.lod_hyst_interval,.6*b.lod_lower_border_range);k.hyst_interval_max=Math.min(c.lod_hyst_interval,
.6*b.lod_upper_border_range)}}};S.update_lod_visibility=va;S.set_hair_particles_wind_bend_params=function(a){var g=a.render,b=g.wind_bending_amp,c=g.wind_bending_freq,h=g.detail_bending_freq,f=g.detail_bending_amp,d=g.branch_bending_amp;a=a.scenes_data;for(g=0;g<a.length;g++)for(var l=a[g].batches,k=0;k<l.length;k++){var e=l[k].bufs_data,q=e.pointers,w=q.au_wind_bending_amp,D=q.au_wind_bending_freq,N=q.au_detail_bending_amp,la=q.au_detail_bending_freq,q=q.au_branch_bending_amp;if(D){var m=Array.apply(null,
Array(D.length)).map(function(){return c});O.update_gl_buffer_sub_data(e,O.VBO_FLOAT,new Float32Array(m),D.offset)}w&&(m=Array.apply(null,Array(w.length)).map(function(){return b}),O.update_gl_buffer_sub_data(e,O.VBO_FLOAT,new Float32Array(m),w.offset));N&&(m=Array.apply(null,Array(N.length)).map(function(){return f}),O.update_gl_buffer_sub_data(e,O.VBO_FLOAT,new Float32Array(m),N.offset));la&&(m=Array.apply(null,Array(la.length)).map(function(){return h}),O.update_gl_buffer_sub_data(e,O.VBO_FLOAT,
new Float32Array(m),la.offset));q&&(m=Array.apply(null,Array(q.length)).map(function(){return d}),O.update_gl_buffer_sub_data(e,O.VBO_FLOAT,new Float32Array(m),q.offset))}};S.inherit_material=function(a,g,b,c){if(a.render.dynamic_geometry&&b.render.dynamic_geometry){var h=Ca.find_batch_material(a,g,"MAIN"),f=null;Ca.iterate_batches_by_mat(b,c,function(a){f||(f={});a.particles_data&&(f[a.particles_data.name]=a.particles_data)},"PARTICLES");for(var d=Ga(b,c),l=Ea(a,g,b,c),k=Ba.get_active(),e=0;e<b.scenes_data.length;e++){var q=
b.scenes_data[e].scene;Ba.set_active(q);var w=P(q,"LAMP",0),D=b.scenes_data[e].batches;b.scenes_data[e].batches=[];b.scenes_data[e].batch_world_bounds=[];Ca.generate_main_batches(q,[b._bpy_obj],w,[]);Ca.create_forked_batches(b,Ba.get_graph(q),q);Ba.assign_scene_data_subs(q,[b]);Ba.append_object(q,b,!1);Ja.append_object(b,q);for(w=0;w<D.length;w++)qa.append_batch(b,q,D[w])}ta(a,g,b,l);ba(b,d);X(b,c,a,f,h);Ba.set_active(k)}};S.create_line=function(a){a=a||"";a+=za(a);a=qa.create_object(a,"LINE");a.render=
qa.create_render("EMPTY");a.is_dynamic=!0;Ca.generate_line_batches(Ba.get_main(),[a]);Ba.append_object(Ba.get_main(),a);ja(a);return a};S.create_empty=function(a){a=a||"";a+=za(a);a=qa.create_object(a,"EMPTY");a.render=qa.create_render("EMPTY");a.is_dynamic=!0;qa.append_scene_data(a,Ba.get_main());ja(a);return a};S.generate_mesh_render_boundings=function(a,g){var b=g.render,c=y.n(b.bb_original);b.billboard?qa.update_render_bounds_billboard(g,c):qa.update_render_bounds_from_bpy(g,c,a.data.b4w_boundings)};
S.set_nodemat_value=function(a,g,b,c){for(var h=qa.is_world(a),f=!1,d=0;d<a.scenes_data.length;d++)for(var l=a.scenes_data[d].batches,k=0;k<l.length;k++){var e=l[k];if(h||-1!=e.material_names.indexOf(g))f|=Ca.set_nodemat_value(e,b,c)}f&&h&&Ba.update_sky_texture(a);return f};S.set_nodemat_rgb=function(a,g,b,c,h,f){for(var d=qa.is_world(a),l=!1,k=0;k<a.scenes_data.length;k++)for(var e=a.scenes_data[k].batches,q=0;q<e.length;q++){var w=e[q];if(d||-1!=w.material_names.indexOf(g))l|=Ca.set_nodemat_rgb(w,
b,c,h,f)}l&&d&&Ba.update_sky_texture(a);return l};S.get_nodemat_value=function(a,g,b){a=Ca.find_batch_material_any(a,g,"MAIN")||Ca.find_batch_material_any(a,g,"PARTICLES");return Ca.get_nodemat_value(a,b)};S.get_nodemat_rgb=function(a,g,b,c){a=Ca.find_batch_material_any(a,g,"MAIN")||Ca.find_batch_material_any(a,g,"PARTICLES");return Ca.get_nodemat_rgb(a,b,c)}});t.a=e},function(C,t,e){C=e(0);var R=e(25),V=e(14),n=e(58),y=e(57);e(8);var d=e(12),k=e(9),I=e(10),A=e(23),r=e(6),p=e(2),u=e(3);e=Object(C.a)("__transform",
function(a,e){function l(a,b){if(E.has_child_of(a)){var c=E.get_child_of_offset(a);r.v(b,c)}else r.v(b,a.render.world_tsr)}function c(a,b){var c=a.render;if(E.has_child_of(a)){r.r(b,c.world_tsr);var f=E.get_child_of_parent_tsr(a),f=r.p(f,Y),d=E.get_child_of_offset(a);r.q(f,c.world_tsr,d)}else r.r(b,c.world_tsr)}function m(a,b){if(E.has_child_of(a)){var c=E.get_child_of_offset(a);r.r(b,c)}else r.r(b,a.render.world_tsr)}function b(a,b){r.g(a.render.world_tsr,b);return b}function f(a,b){if(E.has_child_of(a)){var c=
E.get_child_of_offset(a);r.g(c,b)}else r.g(a.render.world_tsr,b);return b}function B(a,b){if(E.has_child_of(a)){var c=E.get_child_of_offset(a);r.a(b,c)}else r.a(b,a.render.world_tsr)}function fa(a,b){if(E.has_child_of(a)){var c=E.get_child_of_offset(a);r.a(c,b)}else r.a(a.render.world_tsr,b);return b}function z(a){var b=a.render,c=a.scenes_data,f=a.type;E.update_constraint(a,S);"CAMERA"==f&&G.update_camera(a);R.h(b.bb_local,b.world_tsr,b.bb_world);R.k(b.bs_local,b.world_tsr,b.bs_world);for(var d=
0;d<c.length;d++)for(var h=c[d].batches,l=0;l<h.length;l++)M.update_world_bounds_from_batch_tsr(h[l],b.world_tsr,c[d].batch_world_bounds[l]);switch(f){case "MESH":a.need_inv_zup_tsr&&r.p(a.render.world_tsr,a.render.world_tsr_inv);if(h=a.armobj)d=h.render.world_tsr,0!=d[3]&&0!=d[4]&&0!=d[5]?(r.p(d,Y),r.q(Y,b.world_tsr,Y),r.l(Y,b.arm_rel_trans),r.g(Y,b.arm_rel_quat)):r.l(d,b.arm_rel_trans);b.force_zsort=!0;break;case "CAMERA":for(d=0;d<c.length;d++)G.update_camera_transform(a,c[d]);break;case "SPEAKER":U.speaker_update_transform(a,
S,L);break;case "LAMP":y.g(a)}for(var h=r.j(b.world_tsr,K),k=r.g(b.world_tsr,v),d=0;d<c.length;d++)if(l=c[d],l.is_active){var e=l.scene,q=e._render;switch(f){case "MESH":b.shadow_cast&&F.schedule_shadow_update(e);q=l.cube_refl_subs;null!=b.cube_reflection_id&&q&&F.update_cube_reflect_subs(q,h);break;case "EMPTY":J.update_force(a);break;case "CAMERA":if(F.get_active()==e&&F.get_camera(e)==a){F.schedule_grass_map_update(e);if(q.shadow_params){(q.shadow_params.enable_csm||q.shadow_params.dynamic_grass_cast)&&
F.schedule_shadow_update(e);var m=M.get_scene_data(a,e).cameras[0];F.update_shadow_billboard_view(m,q.graph)}U.listener_update_transform(e,h,k,S,L)}break;case "LAMP":F.update_lamp_scene(a,e)}q=l.plane_refl_subs;m=a.reflective_objs;if(m.length)for(l=0;l<q.length;l++){var p=q[l].camera;F.update_plane_reflect_subs(q[l],h,k);M.update_refl_objects(m,p.reflection_plane);G.set_view(p,F.get_camera(e))}}b=a.cons_descends;for(d=0;d<b.length;d++)z(b[d]);a=a.cons_armat_bone_descends;for(d=0;d<a.length;d++)b=
a[d],h=b[0],E.update_bone_constraint(h,b[1])}var G=Object(V.a)(a),E=Object(n.a)(a),J=Object(d.a)(a),M=Object(k.a)(a),F=Object(I.a)(a),U=Object(A.a)(a),K=new Float32Array(3),t=new Float32Array(3),v=new Float32Array(4),Y=r.b(),ha=r.b(),S=0,L=0;e.update=function(a){S=a;L++};e.set_translation=function(a,b){var c=a.render;if(E.has_child_of(a)){r.v(b,c.world_tsr);var f=E.get_child_of_parent_tsr(a),f=r.p(f,Y),d=E.get_child_of_offset(a);r.q(f,c.world_tsr,d)}else r.v(b,c.world_tsr)};e.set_translation_rel=
l;e.get_translation=function(a,b){r.j(a.render.world_tsr,b);return b};e.get_translation_rel=function(a,b){if(E.has_child_of(a)){var c=E.get_child_of_offset(a);r.j(c,b)}else r.j(a.render.world_tsr,b);return b};e.set_rotation=c;e.set_rotation_rel=m;e.get_rotation=b;e.get_rotation_rel=f;e.set_rotation_euler=function(a,b){var f=p.Y(b,v);c(a,f)};e.set_rotation_euler_rel=function(a,b){var c=p.Y(b,v);m(a,c)};e.get_rotation_euler=function(a,c){var f=b(a,v);return c=p._36(f,c)};e.get_rotation_euler_rel=function(a,
b){var c=f(a,v);return b=p._36(c,b)};e.set_scale=function(a,b){var c=a.render;if(E.has_child_of(a)){r.s(b,c.world_tsr);var f=E.get_child_of_parent_tsr(a),f=r.p(f,Y),d=E.get_child_of_offset(a);r.q(f,c.world_tsr,d)}else r.s(b,c.world_tsr)};e.set_scale_rel=function(a,b){var c=a.render;E.has_child_of(a)?(c=E.get_child_of_offset(a),r.s(b,c)):r.s(b,c.world_tsr)};e.get_scale=function(a,b){return r.i(a.render.world_tsr,b)};e.get_scale_rel=function(a,b){if(E.has_child_of(a)){var c=E.get_child_of_offset(a);
return r.i(c,b)}return r.i(a.render.world_tsr,b)};e.set_tsr=function(a,b){r.a(b,a.render.world_tsr);if(E.has_child_of(a)){var c=E.get_child_of_parent_tsr(a),c=r.p(c,Y),f=E.get_child_of_offset(a);r.q(c,a.render.world_tsr,f)}};e.set_tsr_rel=B;e.get_tsr=function(a,b){return r.a(a.render.world_tsr,b)};e.get_tsr_rel=fa;e.get_object_size=function(){var a=u.create();return function(b){var c=b.render;b=c.bb_original;var f=r.i(c.world_tsr,a),c=f[0]*(b.max_x-b.min_x),d=f[1]*(b.max_y-b.min_y);b=f[2]*(b.max_z-
b.min_z);return.5*Math.sqrt(c*c+d*d+b*b)}}();e.get_object_center=function(a,b,c){b?(a=a.render,u.copy(a.bs_world.center,c)):(a=a.render,b=a.bb_original,c[0]=(b.max_x+b.min_x)/2,c[1]=(b.max_y+b.min_y)/2,c[2]=(b.max_z+b.min_z)/2,r.D(c,a.world_tsr,c));return c};e.move_local=function(a,b,c,f){var d=fa(a,Y),h=K;h[0]=b;h[1]=c;h[2]=f;r.D(h,d,h);l(a,h)};e.rotate_local=function(a,b){var c=fa(a,Y),f=r.r(b,r.m(ha));r.q(c,f,f);B(a,f)};e.update_transform=z;e.distance=function(a,b){var c=r.j(a.render.world_tsr,
K),f=r.j(b.render.world_tsr,t);return u.dist(c,f)};e.obj_point_distance=function(a,b){var c=r.j(a.render.world_tsr,K);return u.dist(c,b)}});t.a=e},function(C,t,e){C=e(0);var R=e(5),V=e(25),n=e(15),y=e(21),d=e(42),k=e(9),I=e(1),A=e(8),r=e(10),p=e(11),u=e(13),a=e(6),B=e(2),l=e(3),c=e(7);e=Object(C.a)("__camera",function(e,b){function f(a,b,g,c,h){qa.set_translation(a,b);g&&ha(a,b,g);S(a,c);L(a,h)}function m(a,b,g,c,h,f,d,l){var N=a.render;qa.set_translation(a,b);N.pivot.set(g);ha(a,b,g);S(a,c);L(a,
h);H(a,f);D(a,d);N.use_panning=l}function fa(a,b,g,c,f,d,l,k){var N=a.render;qa.set_translation(a,b);N.hover_pivot.set(g);ha(a,b,g);ea(a,c);q(a,f);h(a,d);ia(a,l);N.enable_hover_hor_rotation=k}function z(b){b={type:b,name:"",size_mult:1,width:0,height:0,framebuffer:null,framebuffer_prev:null,color_attachment:null,depth_attachment:null,aspect:0,fov:0,fit:"VERTICAL",near:0,far:0,left:0,right:0,top:0,bottom:0,hmd_fov:c.create(),world_tsr:a.c(),view_matrix:new Float32Array(16),view_refl_matrix:new Float32Array(16),
view_transform_params:{trans:l.create(),angle:0},proj_matrix:new Float32Array(16),view_proj_matrix:new Float32Array(16),view_proj_inv_matrix:new Float32Array(16),prev_view_proj_matrix:new Float32Array(16),sky_vp_inv_matrix:new Float32Array(16),direction:new Float32Array(3),view_tsr:a.c(),view_tsr_inv:a.c(),real_view_tsr:a.c(),real_view_tsr_inv:a.c(),shadow_cast_billboard_view_tsr:a.c(),dof_distance:0,dof_front_start:0,dof_front_end:0,dof_rear_start:0,dof_rear_end:0,dof_power:0,dof_bokeh_intensity:0,
dof_object:null,dof_bokeh:!1,dof_foreground_blur:!1,dof_on:!1,lod_eye:new Float32Array(3),frustum_planes:E(),stereo_conv_dist:0,stereo_eye_dist:0,reflection_plane:null,csm_centers:null,csm_radii:null,csm_center_dists:new Float32Array(4),pcf_blur_radii:new Float32Array(4)};b.hmd_fov[0]=b.hmd_fov[2]=0;b.hmd_fov[1]=b.hmd_fov[3]=0;return b}function G(b,g){var h=z(b.type);h.name=b.name;h.size_mult=b.size_mult;h.width=b.width;h.height=b.height;g||(h.framebuffer=b.framebuffer,h.framebuffer_prev=b.framebuffer_prev,
h.color_attachment=b.color_attachment,h.depth_attachment=b.depth_attachment);h.aspect=b.aspect;h.fit=b.fit;h.fov=b.fov;h.near=b.near;h.far=b.far;h.left=b.left;h.right=b.right;h.top=b.top;h.bottom=b.bottom;c.copy(b.hmd_fov,h.hmd_fov);a.a(b.world_tsr,h.world_tsr);y.copy(b.view_matrix,h.view_matrix);y.copy(b.view_refl_matrix,h.view_refl_matrix);h.view_transform_params=B.O(b.view_transform_params);y.copy(b.proj_matrix,h.proj_matrix);y.copy(b.view_proj_matrix,h.view_proj_matrix);y.copy(b.view_proj_inv_matrix,
h.view_proj_inv_matrix);y.copy(b.prev_view_proj_matrix,h.prev_view_proj_matrix);y.copy(b.sky_vp_inv_matrix,h.sky_vp_inv_matrix);h.direction.set(b.direction);a.a(b.view_tsr,h.view_tsr);a.a(b.view_tsr_inv,h.view_tsr_inv);a.a(b.real_view_tsr,h.real_view_tsr);a.a(b.real_view_tsr_inv,h.real_view_tsr_inv);a.a(b.shadow_cast_billboard_view_tsr,h.shadow_cast_billboard_view_tsr);h.dof_distance=b.dof_distance;h.dof_front_start=b.dof_front_start;h.dof_front_end=b.dof_front_end;h.dof_rear_start=b.dof_rear_start;
h.dof_rear_end=b.dof_rear_end;h.dof_power=b.dof_power;h.dof_bokeh_intensity=b.dof_bokeh_intensity;h.dof_object=b.dof_object;h.dof_bokeh=b.dof_bokeh;h.dof_foreground_blur=b.dof_foreground_blur;h.dof_on=b.dof_on;l.copy(b.lod_eye,h.lod_eye);var f=b.frustum_planes,d=h.frustum_planes;c.copy(f.left,d.left);c.copy(f.right,d.right);c.copy(f.top,d.top);c.copy(f.bottom,d.bottom);c.copy(f.near,d.near);c.copy(f.far,d.far);h.stereo_conv_dist=b.stereo_conv_dist;h.stereo_eye_dist=b.stereo_eye_dist;b.reflection_plane&&
(h.reflection_plane=c.clone(b.reflection_plane));if(b.csm_centers){f=b.csm_centers.length;h.csm_centers=Array(f);for(d=0;d<f;d++)h.csm_centers[d]=l.clone(b.csm_centers[d]);h.csm_radii=new Float32Array(b.csm_radii)}c.copy(b.csm_center_dists,h.csm_center_dists);c.copy(b.pcf_blur_radii,h.pcf_blur_radii);return h}function E(){return{left:new Float32Array([0,0,0,0]),right:new Float32Array([0,0,0,0]),top:new Float32Array([0,0,0,0]),bottom:new Float32Array([0,0,0,0]),near:new Float32Array([0,0,0,0]),far:new Float32Array([0,
0,0,0])}}function J(a){switch(a){case "STATIC":return b.MS_STATIC;case "TARGET":return b.MS_TARGET_CONTROLS;case "EYE":return b.MS_EYE_CONTROLS;case "HOVER":return b.MS_HOVER_CONTROLS;default:Aa.panic("Unknown move style")}}function M(a){var g=z(a);if(a==b.TYPE_NONE)return g;switch(a){case b.TYPE_PERSP:t(g,na,.1,1E3);break;case b.TYPE_ORTHO:t(g,2.5,.1,1E3);break;case b.TYPE_PERSP_ASPECT:break;case b.TYPE_ORTHO_ASPECT:break;case b.TYPE_ORTHO_ASYMMETRIC:break;case b.TYPE_STEREO_LEFT:case b.TYPE_STEREO_RIGHT:case b.TYPE_HMD_LEFT:case b.TYPE_HMD_RIGHT:Aa.panic("Stereo camera may only be created from perspective one");
break;default:Aa.panic("Unknown camera type")}return g}function F(a,g,c){a.type!=b.TYPE_STEREO_LEFT&&a.type!=b.TYPE_STEREO_RIGHT&&a.type!=b.TYPE_HMD_LEFT&&a.type!=b.TYPE_HMD_RIGHT&&Aa.panic("set_stereo_params(): wrong camera type");if(a.type==b.TYPE_STEREO_LEFT||a.type==b.TYPE_STEREO_RIGHT)a.stereo_conv_dist=g;a.stereo_eye_dist=c;ja(a,!1);if(O.check_active()&&(g=O.get_active(),a=g._render.shadow_params))for(g=ga.get_scene_data(O.get_camera(g),g).cameras,c=0;c<g.length;c++)X(g[c],a)}function U(a,b,
g){var c=fb,h=La;0<l.dot(b,B.f)?(l.cross(B.d,b,c),l.normalize(c,c)):l.copy(B.f,c);l.cross(b,c,h);var f=B._34(a,B.f,Xa),d=B._34(a,B.b,Wa);l.normalize(f,f);l.normalize(d,d);a=-Math.asin(l.dot(f,b));b=l.dot(d,b);f=Math.abs(a)>Math.PI/4?l.scale(d,-B._50(a),W):l.scale(f,-B._50(Math.asin(b)),Ia);d=Math.atan(Math.abs(l.dot(h,f)/l.dot(c,f)));0<b&&(a=B._50(a)*Math.PI-a);b=d;0>l.dot(c,f)&&(b=Math.PI-b);0>l.dot(h,f)&&(b=2*Math.PI-b);g[0]=b;g[1]=a;return g}function K(a){switch(a.fit){case "AUTO":return 1<a.aspect?
Ca(a)?a.fov/a.aspect:2*Math.atan(Math.tan(a.fov/2)/a.aspect):a.fov;case "HORIZONTAL":return Ca(a)?a.fov/a.aspect:2*Math.atan(Math.tan(a.fov/2)/a.aspect);case "VERTICAL":return a.fov}}function t(a,g,c,h){switch(a.type){case b.TYPE_PERSP:case b.TYPE_STEREO_LEFT:case b.TYPE_STEREO_RIGHT:a.fov=g;a.aspect=1;break;case b.TYPE_ORTHO:a.fov=g;a.aspect=1;break;case b.TYPE_HMD_LEFT:case b.TYPE_HMD_RIGHT:break;default:Aa.panic("set_frustum(): Unsupported camera type: "+a.type)}a.near=c;a.far=h}function v(a,b){ja(a,
!0);var g=Na,h=Z;y.invert(a.view_matrix,h);y.transpose(h,h);c.transformMat4(a.reflection_plane,h,g);h=Va;h[0]=(B._50(g[0])+a.proj_matrix[8])/a.proj_matrix[0];h[1]=(B._50(g[1])+a.proj_matrix[9])/a.proj_matrix[5];h[2]=-1;h[3]=(1+a.proj_matrix[10])/a.proj_matrix[14];c.scale(g,2/(g[0]*h[0]+g[1]*h[1]+g[2]*h[2]+g[3]*h[3]),g);a.proj_matrix[2]=g[0];a.proj_matrix[6]=g[1];a.proj_matrix[10]=g[2]+1;a.proj_matrix[14]=g[3];va(a);b||Ga(a)}function Y(a,b,g){g=l.subtract(g,b,fb);l.length(g)&&(l.normalize(g,g),g=B._48(B.c,
g,Ua),qa.set_rotation(a,g));qa.set_translation(a,b)}function ha(a,b,g){var c=a.render,h=Ya(a);Y(a,b,g);h?(b=l.copy(c.vertical_axis,fb),l.negate(b,b),gb(a,b,!0)):gb(a,c.vertical_axis,!0)}function S(a,g){var c=a.render;if(g){c.horizontal_limits=c.horizontal_limits||{};c.horizontal_limits.left=g.left;c.horizontal_limits.right=g.right;c.horizontal_limits.left_local=g.left;c.horizontal_limits.right_local=g.right;c.horizontal_limits.camera_space=!!g.camera_space;var h=a.render;!(c=h.horizontal_limits)||
h.move_style!=b.MS_EYE_CONTROLS&&h.move_style!=b.MS_TARGET_CONTROLS||(h=Qa(a,Ta),c.camera_space?(c.left+=h[0],c.right+=h[0]):(c.left_local-=h[0],c.right_local-=h[0]),c.left=B.A(c.left),c.right=B.A(c.right),c.left_local=B.A(c.left_local),c.right_local=B.A(c.right_local))}else c.horizontal_limits=null}function L(a,b){var g=a.render;b?(g.vertical_limits=g.vertical_limits||{},g.vertical_limits.down=b.down,g.vertical_limits.up=b.up,g.vertical_limits.down_local=b.down,g.vertical_limits.up_local=b.up,g.vertical_limits.camera_space=
!!b.camera_space,w(a)):g.vertical_limits=null}function q(a,b){var g=a.render;if(!b){var c=Qa(a,Ta);b={down:c[1],up:c[1]}}g.vertical_limits=g.vertical_limits||{};g.vertical_limits.down=b.down;g.vertical_limits.up=b.up;w(a);g.distance_limits&&g.vertical_limits&&yb(a)}function w(a){var g=a.render,c=g.vertical_limits;if(c)switch(g.move_style){case b.MS_EYE_CONTROLS:case b.MS_TARGET_CONTROLS:a=Qa(a,Ta);c.camera_space?(c.up+=a[1],c.down+=a[1]):(c.up_local-=a[1],c.down_local-=a[1]);c.up=B.B(c.up,-Math.PI,
Math.PI);c.down=B.B(c.down,-Math.PI,Math.PI);c.up_local=B.B(c.up_local,-Math.PI,Math.PI);c.down_local=B.B(c.down_local,-Math.PI,Math.PI);break;case b.MS_HOVER_CONTROLS:c.up=B.B(c.up,-Math.PI,Math.PI),c.down=B.B(c.down,-Math.PI,Math.PI),c.up=B.M(c.up,-Math.PI/2,0),c.down=B.M(c.down,-Math.PI/2,0)}}function ea(a,b){var g=a.render;if(!b){var c=qa.obj_point_distance(a,g.hover_pivot);b={min:c,max:c}}g.distance_limits=g.distance_limits||{};g.distance_limits.min=b.min;g.distance_limits.max=b.max;g.distance_limits&&
g.vertical_limits&&yb(a)}function H(a,b){var g=a.render;b?(g.distance_limits=g.distance_limits||{},g.distance_limits.min=b.min,g.distance_limits.max=b.max):g.distance_limits=null}function D(a,b){var g=a.render;b?(g.pivot_limits=g.pivot_limits||{},g.pivot_limits.min_z=b.min_z,g.pivot_limits.max_z=b.max_z):g.pivot_limits=null}function h(a,b){var g=a.render;b?(g.hover_horiz_trans_limits=g.hover_horiz_trans_limits||{},g.hover_horiz_trans_limits.min=b.min,g.hover_horiz_trans_limits.max=b.max):g.hover_horiz_trans_limits=
null}function ia(a,b){var g=a.render;b?(g.hover_vert_trans_limits=g.hover_vert_trans_limits||{},g.hover_vert_trans_limits.min=b.min,g.hover_vert_trans_limits.max=b.max):g.hover_vert_trans_limits=null}function ra(a){var g=a.render,c=g.move_style;if(c===b.MS_TARGET_CONTROLS||c===b.MS_EYE_CONTROLS){if(g.horizontal_limits){var h=g.horizontal_limits.left,f=g.horizontal_limits.right,d=Qa(a,Ta);(d=c==b.MS_TARGET_CONTROLS?B.H(d[0],h,f):B.H(d[0],f,h))&&(c==b.MS_TARGET_CONTROLS?P(a,d,0):Sa(a,d,0))}g.vertical_limits&&
(h=g.vertical_limits.down,f=g.vertical_limits.up,d=Qa(a,Ta),(d=c==b.MS_TARGET_CONTROLS?B.H(d[1],f,h):B.H(d[1],h,f))&&(c==b.MS_TARGET_CONTROLS?P(a,0,d):Sa(a,0,d)));c===b.MS_TARGET_CONTROLS&&g.distance_limits&&Fb(a)}c===b.MS_TARGET_CONTROLS&&g.pivot_limits&&ua(a);c===b.MS_HOVER_CONTROLS&&(Ra(a),g=a.render,c=Qa(a,Ta)[1],(g=B.H(c,g.vertical_limits.up,g.vertical_limits.down))&&Q(a,0,g))}function za(a,b,g,c){a=Qa(a,Ka);c[0]=b-a[0];c[1]=g-a[1];return c}function P(a,b,g){mb(a,a.render.pivot,b,g)}function oa(a,
b,g){b=za(a,b,g,ma);P(a,b[0],b[1])}function Q(a,b,g){var c=a.render;c.enable_hover_hor_rotation||(b=0);mb(a,c.hover_pivot,b,g);g&&yb(a)}function da(a,b,g){b=za(a,b,g,ma);Q(a,b[0],b[1])}function ja(a,g){switch(a.type){case b.TYPE_PERSP:case b.TYPE_PERSP_ASPECT:y.perspective(K(a),a.aspect,a.near,a.far,a.proj_matrix);break;case b.TYPE_ORTHO:case b.TYPE_ORTHO_ASPECT:var c=K(a),h=c*a.aspect;y.ortho(-h,h,-c,c,a.near,a.far,a.proj_matrix);break;case b.TYPE_ORTHO_ASYMMETRIC:y.ortho(a.left,a.right,a.bottom,
a.top,a.near,a.far,a.proj_matrix);break;case b.TYPE_STEREO_LEFT:case b.TYPE_STEREO_RIGHT:var h=Math.tan(K(a)/2),c=a.near*h,f=a.aspect*a.stereo_conv_dist*h;a.type==b.TYPE_STEREO_LEFT?(h=f-a.stereo_eye_dist/2,f+=a.stereo_eye_dist/2):(h=f+a.stereo_eye_dist/2,f-=a.stereo_eye_dist/2);h=-(a.near/a.stereo_conv_dist*h);f*=a.near/a.stereo_conv_dist;y.frustum(h,f,-c,c,a.near,a.far,a.proj_matrix);a.left=h;a.right=f;break;case b.TYPE_HMD_LEFT:case b.TYPE_HMD_RIGHT:O.check_active()&&(c=O.get_active(),(c=O.get_subs(c,
wa.STEREO))&&c.enable_hmd_stereo?(c=Math.tan(a.hmd_fov[1]),h=Math.tan(a.hmd_fov[2]),f=Math.tan(a.hmd_fov[3]),a.top=a.near*Math.tan(a.hmd_fov[0]),a.right=a.near*c,a.bottom=-a.near*h,a.left=-a.near*f,y.frustum(a.left,a.right,a.bottom,a.top,a.near,a.far,a.proj_matrix)):(a.top=a.near*Math.tan(K(a)/2),a.bottom=-a.top,a.right=a.top*a.aspect,a.left=-a.right,y.perspective(K(a),a.aspect,a.near,a.far,a.proj_matrix)));break;case b.TYPE_NONE:return;default:Aa.panic("Wrong camera type: "+a.type)}va(a);g||Ga(a)}
function va(a){y.translate(a.proj_matrix,a.view_transform_params.trans,a.proj_matrix);y.rotateZ(a.proj_matrix,a.view_transform_params.angle,a.proj_matrix)}function Ga(a){ba(a);Ea(a);B._0(a.view_proj_matrix,a.frustum_planes)}function ba(a){y.copy(a.view_matrix,a.view_proj_matrix);y.multiply(a.proj_matrix,a.view_proj_matrix,a.view_proj_matrix);y.invert(a.view_proj_matrix,a.view_proj_inv_matrix)}function Ea(a){y.copy(a.view_matrix,a.sky_vp_inv_matrix);a.sky_vp_inv_matrix[12]=0;a.sky_vp_inv_matrix[13]=
0;a.sky_vp_inv_matrix[14]=0;a.sky_vp_inv_matrix[15]=1;y.multiply(a.proj_matrix,a.sky_vp_inv_matrix,a.sky_vp_inv_matrix);y.invert(a.sky_vp_inv_matrix,a.sky_vp_inv_matrix)}function ta(a,g,c,h,f){h||(h=new Float32Array(24));g||(g=a.near);c||(c=a.far);var d,l,N,k,e,q,m,la;switch(a.type){case b.TYPE_NONE:Aa.panic("Extraction from NONE camera is not possible");break;case b.TYPE_PERSP:case b.TYPE_PERSP_ASPECT:d=g*Math.tan(K(a)/2);k=-d;l=d*a.aspect;N=-l;e=c/g*d;la=-e;q=e*a.aspect;m=-q;break;case b.TYPE_ORTHO:case b.TYPE_ORTHO_ASPECT:k=
K(a);N=k*a.aspect;d=e=k;l=q=N;k=la=-k;N=m=-N;break;case b.TYPE_ORTHO_ASYMMETRIC:d=e=a.top;l=q=a.right;k=la=a.bottom;N=m=a.left;break;case b.TYPE_STEREO_LEFT:case b.TYPE_STEREO_RIGHT:e=g/a.near;d=g*Math.tan(K(a)/2);k=-d;l=a.right*e;N=a.left*e;m=c/g;e=d*m;la=-e;q=l*m;m*=N;break;case b.TYPE_HMD_LEFT:case b.TYPE_HMD_RIGHT:e=g/a.near;d=a.top*e;k=a.bottom*e;l=a.right*e;N=a.left*e;m=c/g;e=d*m;la=k*m;q=l*m;m*=N;break;default:Aa.panic("Wrong camera type: "+a.type)}h[0]=N;h[1]=k;h[2]=-g;h[3]=l;h[4]=k;h[5]=
-g;h[6]=l;h[7]=d;h[8]=-g;h[9]=N;h[10]=d;h[11]=-g;h[12]=m;h[13]=la;h[14]=-c;h[15]=m;h[16]=e;h[17]=-c;h[18]=q;h[19]=e;h[20]=-c;h[21]=q;h[22]=la;h[23]=-c;f&&(g=Z,y.invert(a.view_matrix,g),B._28(h,g,h,0));return h}function X(a,b){if(b.enable_csm){var g=b.csm_num;if(!a.csm_centers){var c=b.csm_num;a.csm_centers=Array(c);for(var h=0;h<c;h++)a.csm_centers[h]=new Float32Array(3);a.csm_radii=new Float32Array(c)}for(c=0;c<g;c++){var h=0==c?a.near:pa(b,a,c-1),f=pa(b,a,c),h=ta(a,h,f,Oa),h=V.H(h);a.csm_centers[c].set(h.center);
a.csm_radii[c]=h.radius;a.csm_center_dists[c]=l.length(h.center);a.pcf_blur_radii[c]=ka(b.first_cascade_blur_radius,b.last_cascade_blur_radius,g,c)}}else a.pcf_blur_radii[0]=b.first_cascade_blur_radius}function pa(a,b,g){var c=a.csm_num,h=B.M(a.csm_first_cascade_border,b.near,b.far);a=B.M(a.csm_last_cascade_border,b.near,b.far);g=ka(h,a,c,g);return B.M(g,b.near,b.far)}function ka(a,b,g,c){switch(c){case 0:break;case g-1:a=b;break;default:a=0==a?0:a*Math.pow(b/a,c/(g-1))}return a}function Ca(a){switch(a.type){case b.TYPE_ORTHO:case b.TYPE_ORTHO_ASPECT:case b.TYPE_ORTHO_ASYMMETRIC:return!0;
default:return!1}}function C(b,g){g||(g=new Float32Array(3));return a.j(b.render.world_tsr,g)}var Aa=Object(R.a)(e),xa=Object(n.a)(e),ga=Object(k.a)(e),ya=Object(I.a)(e),O=Object(r.a)(e),wa=Object(p.a)(e),qa=Object(u.a)(e);b.TYPE_NONE=10;b.TYPE_PERSP=20;b.TYPE_ORTHO=30;b.TYPE_PERSP_ASPECT=40;b.TYPE_ORTHO_ASPECT=50;b.TYPE_ORTHO_ASYMMETRIC=60;b.TYPE_STEREO_LEFT=70;b.TYPE_STEREO_RIGHT=80;b.TYPE_HMD_LEFT=90;b.TYPE_HMD_RIGHT=100;b.MS_STATIC=0;b.MS_TARGET_CONTROLS=2;b.MS_EYE_CONTROLS=3;b.MS_HOVER_CONTROLS=
4;var na=B.T(40),Ja=B.T(.5),g=new Float32Array([1,1,1,1]),Da=new Float32Array([-1,-1,1,1]),Ba=new Float32Array([0,0,-1,1]),Ta=new Float32Array(2),ma=new Float32Array(2),Ka=new Float32Array(2),fb=new Float32Array(3),La=new Float32Array(3),Xa=new Float32Array(3),Wa=new Float32Array(3),W=new Float32Array(3),Ia=new Float32Array(3);A.create();var Ua=new Float32Array(4);new Float32Array(4);var Na=new Float32Array(4),Va=new Float32Array(4),Z=new Float32Array(16),Oa=new Float32Array(24);new Float32Array(6);
b.camera_object_to_camera=function(){var g=l.create(),c=l.create();return function(h,d){var l=d.render,N=h.data;switch(N.type){case "PERSP":var k=M(b.TYPE_PERSP);k.fit=N.sensor_fit;t(k,N.angle,N.clip_start,N.clip_end);break;case "ORTHO":k=M(b.TYPE_ORTHO),k.fit=N.sensor_fit,t(k,N.ortho_scale/2,N.clip_start,N.clip_end)}k.name=d.name;var e=d.scenes_data;e[0].cameras.push(k);for(var q=1;q<e.length;q++){var w=G(k,!1);e[q].cameras.push(w)}l.move_style=J(N.b4w_move_style);l.dof_distance=N.dof_distance;k=
N.dof_object;l.dof_object=k?k._object:null;l.dof_front_start=N.b4w_dof_front_start;l.dof_front_end=N.b4w_dof_front_end;l.dof_rear_start=N.b4w_dof_rear_start;l.dof_rear_end=N.b4w_dof_rear_end;l.dof_power=N.b4w_dof_power;l.dof_bokeh=N.b4w_dof_bokeh;l.dof_bokeh_intensity=N.b4w_dof_bokeh_intensity;l.dof_foreground_blur=N.b4w_dof_foreground_blur;l.velocity_trans=N.b4w_trans_velocity;l.velocity_rot=N.b4w_rot_velocity;l.velocity_zoom=N.b4w_zoom_velocity;k=d.render.move_style;e=h.data;q=null;k!=b.MS_TARGET_CONTROLS&&
k!=b.MS_EYE_CONTROLS||!e.b4w_use_horizontal_clamping||(q={left:e.b4w_rotation_left_limit,right:e.b4w_rotation_right_limit,camera_space:"LOCAL"==e.b4w_horizontal_clamping_type},k==b.MS_EYE_CONTROLS&&(q.left*=-1,q.right*=-1));k=q;e=d.render.move_style;q=h.data;w=null;e!=b.MS_TARGET_CONTROLS&&e!=b.MS_EYE_CONTROLS||!q.b4w_use_vertical_clamping?e==b.MS_HOVER_CONTROLS&&q.b4w_use_zooming&&(q.b4w_hover_angle_min<=q.b4w_hover_angle_max?(w={down:q.b4w_hover_angle_min,up:q.b4w_hover_angle_max},w.down*=-1,w.up*=
-1):ya.error("Wrong angle limits for the HOVER camera. Disabling angle limits.")):(w={down:q.b4w_rotation_down_limit,up:q.b4w_rotation_up_limit,camera_space:"LOCAL"==q.b4w_vertical_clamping_type},e==b.MS_TARGET_CONTROLS&&(w.down*=-1,w.up*=-1));var e=w,q=d.render.move_style,w=h.data,D=null;q==b.MS_TARGET_CONTROLS&&w.b4w_use_target_distance_limits&&w.b4w_distance_min<=w.b4w_distance_max?D={min:w.b4w_distance_min,max:w.b4w_distance_max}:q===b.MS_HOVER_CONTROLS&&w.b4w_use_zooming&&(w.b4w_distance_min<=
w.b4w_distance_max?D={min:w.b4w_distance_min,max:w.b4w_distance_max}:ya.error("Wrong distance limits for the HOVER camera. Disabling distance limits."));q=D;w=h.data;D=null;d.render.move_style==b.MS_HOVER_CONTROLS&&w.b4w_use_horizontal_clamping&&w.b4w_horizontal_translation_min<=w.b4w_horizontal_translation_max&&(D={min:w.b4w_horizontal_translation_min,max:w.b4w_horizontal_translation_max});var w=D,D=h.data,la=null;d.render.move_style==b.MS_HOVER_CONTROLS&&D.b4w_use_vertical_clamping&&D.b4w_vertical_translation_min<=
D.b4w_vertical_translation_max&&(la={min:D.b4w_vertical_translation_min,max:D.b4w_vertical_translation_max});var D=la,la=h.data,v=null;d.render.move_style==b.MS_TARGET_CONTROLS&&la.b4w_use_pivot_limits&&(v={min_z:la.b4w_pivot_z_min,max_z:la.b4w_pivot_z_max});la=v;switch(l.move_style){case b.MS_EYE_CONTROLS:l=a.j(d.render.world_tsr,g);f(d,l,null,k,e);break;case b.MS_TARGET_CONTROLS:l=a.j(d.render.world_tsr,g);m(d,l,N.b4w_target,k,e,q,la,N.b4w_use_panning);break;case b.MS_HOVER_CONTROLS:l=a.j(d.render.world_tsr,
g),k=$a(d,h.data.b4w_hover_zero_level,c),fa(d,l,k,q,e,w,D,N.b4w_enable_hover_hor_rotation)}ra(d);rb(d)}}();b.setup_eye_model=f;b.setup_target_model=m;b.setup_hover_model=fa;var Qa=function(){var b=A.create();return function(g,c){var h=a.g(g.render.world_tsr,b);return U(h,g.render.vertical_axis,c)}}();b.get_camera_angles=Qa;var $a=function(){var b=new Float32Array(6),g=A.create(),h=new Float32Array(2),f=l.create(),k=l.create(),e=c.create();return function(c,l,N){var q=c.render,m=a.j(q.world_tsr,f),
q=a.g(q.world_tsr,g);e.set(B.f);e[3]=0;c=Qa(c,h)[1];q=B._34(q,B.c,k);d.R(b,m);d.Q(b,q);if(!B._22(e,-l,b,N)||Math.abs(c)<Ja)ya.warn("Active hover camera view vector and the supporting plane are parallel to each other. Hover pivot will be set based on the camera position."),N[0]=m[0],N[1]=m[1],N[2]=0;return N}}(),rb=function(){var g=l.create();return function(c){for(var h=c.render,f=0;f<c.scenes_data.length;f++){var d=c.scenes_data[f].cameras[0];if(d.type==b.TYPE_ORTHO)switch(h.move_style){case b.MS_TARGET_CONTROLS:var N=
a.j(h.world_tsr,g);h.init_dist=l.dist(N,h.pivot);h.init_fov=d.fov;break;case b.MS_HOVER_CONTROLS:N=a.j(h.world_tsr,g),h.init_dist=l.dist(N,h.hover_pivot),h.init_fov=d.fov}}}}();b.init_ortho_props=rb;b.clone_camera=G;b.create_frustum_planes=E;b.move_style_bpy_to_b4w=J;b.create_camera=M;b.check_attachment=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return!!a.color_attachment;case "DEPTH":return!!a.depth_attachment;case "SCREEN":return!a.color_attachment&&!a.depth_attachment;default:Aa.panic("Wrong attachment type: "+
b)}};b.set_attachment=function(a,b,g){switch(b){case "COLOR":case "CUBEMAP":a.color_attachment=g;break;case "DEPTH":a.depth_attachment=g;break;case "SCREEN":a.color_attachment=null;a.depth_attachment=null;break;default:Aa.panic("Wrong attachment type: "+b)}};b.get_attachment=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return a.color_attachment;case "DEPTH":return a.depth_attachment;case "SCREEN":return null;default:Aa.panic("Wrong attachment type: "+b)}};b.make_stereo=function(a,g){(a.type!=
b.TYPE_PERSP||g!=b.TYPE_STEREO_LEFT&&g!=b.TYPE_STEREO_RIGHT&&g!=b.TYPE_HMD_LEFT&&g!=b.TYPE_HMD_RIGHT)&&Aa.panic("make_stereo(): wrong camera type");a.type=g;F(a,6,.065)};b.set_stereo_params=F;b.get_camera_angles_from_quat=U;b.get_camera_angles_char=function(a,b){Qa(a,b);b[0]=B.A(b[0]+Math.PI);b[1]*=-1;return b};b.set_fov=function(a,g){switch(a.type){case b.TYPE_PERSP:case b.TYPE_PERSP_ASPECT:case b.TYPE_STEREO_LEFT:case b.TYPE_STEREO_RIGHT:a.fov=g}};b.get_fov=function(a){switch(a.type){case b.TYPE_PERSP:case b.TYPE_PERSP_ASPECT:case b.TYPE_STEREO_LEFT:case b.TYPE_STEREO_RIGHT:return a.fov;
default:return 0}};b.get_vfov=K;b.set_frustum=t;b.set_frustum2=function(a,g,c,h,f){switch(a.type){case b.TYPE_PERSP:case b.TYPE_STEREO_LEFT:case b.TYPE_STEREO_RIGHT:case b.TYPE_ORTHO:a.fov=c;a.aspect=1;break;case b.TYPE_PERSP_ASPECT:case b.TYPE_ORTHO_ASPECT:a.fov=c;a.aspect=g/c;break;case b.TYPE_HMD_LEFT:case b.TYPE_HMD_RIGHT:break;default:Aa.panic("set_frustum2(): Unsupported camera type: "+a.type)}a.near=h;a.far=f};b.set_frustum_asymmetric=function(a,g,c,h,f,d,l){switch(a.type){case b.TYPE_ORTHO_ASYMMETRIC:a.left=
g;a.right=c;a.bottom=h;a.top=f;a.near=d;a.far=l;break;default:Aa.panic("set_frustum_asymmetric(): Unsupported camera type: "+a.type)}};b.get_move_style=function(a){return a.render.move_style};var ob=function(){var g=l.create(),c=A.create(),h=y.create();return function(f,d){var N=a.j(d.render.world_tsr,g),k=a.g(d.render.world_tsr,c),e=y.fromRotationTranslation(k,N,h);y.invert(e,f.view_matrix);if(O.check_active())var e=O.get_active(),q=O.get_subs(e,wa.STEREO);if(f.type==b.TYPE_STEREO_LEFT||q&&q.enable_hmd_stereo&&
f.type==b.TYPE_HMD_LEFT)f.view_matrix[12]+=f.stereo_eye_dist/2;else if(f.type==b.TYPE_STEREO_RIGHT||q&&q.enable_hmd_stereo&&f.type==b.TYPE_HMD_RIGHT)f.view_matrix[12]-=f.stereo_eye_dist/2;if(f.reflection_plane){a.d(f.view_matrix,f.real_view_tsr);a.p(f.real_view_tsr,f.real_view_tsr_inv);var e=f.reflection_plane[0],q=f.reflection_plane[1],m=f.reflection_plane[2],w=f.reflection_plane[3],D=f.view_refl_matrix;D[0]=1-2*e*e;D[1]=-2*e*q;D[2]=-2*e*m;D[3]=0;D[4]=-2*e*q;D[5]=1-2*q*q;D[6]=-2*q*m;D[7]=0;D[8]=
-2*e*m;D[9]=-2*q*m;D[10]=1-2*m*m;D[11]=0;D[12]=-2*e*w;D[13]=-2*q*w;D[14]=-2*m*w;D[15]=1;y.multiply(f.view_matrix,f.view_refl_matrix,f.view_matrix);v(f,!0);l.transformMat4(N,f.view_refl_matrix,N)}a.d(f.view_matrix,f.view_tsr);a.p(f.view_tsr,f.view_tsr_inv);a.t(N,1,k,f.world_tsr);Ga(f)}}();b.set_view=ob;b.set_projection_reflect=v;b.set_view_trans_quat=function(g,c,h){var f=fb;f[0]=0;f[1]=0;f[2]=-1;l.transformQuat(f,h,f);f[0]+=c[0];f[1]+=c[1];f[2]+=c[2];var d=La;d[0]=0;d[1]=1;d[2]=0;l.transformQuat(d,
h,d);y.lookAt(c,f,d,g.view_matrix);h=O.get_active();h=O.get_subs(h,wa.STEREO);if(g.type==b.TYPE_STEREO_LEFT||h&&h.enable_hmd_stereo&&g.type==b.TYPE_HMD_LEFT)g.view_matrix[12]+=g.stereo_eye_dist/2;else if(g.type==b.TYPE_STEREO_RIGHT||h&&h.enable_hmd_stereo&&g.type==b.TYPE_HMD_RIGHT)g.view_matrix[12]-=g.stereo_eye_dist/2;a.d(g.view_matrix,g.view_tsr);ba(g);Ea(g);a.v(c,g.world_tsr)};b.set_look_at=Y;var gb=function(){var b=l.create(),g=l.create(),c=l.create(),h=A.create(),f=A.create();return function(d,
N,k){d=d.render;var e=a.g(d.world_tsr,h),q=B._34(e,B.f,b);l.normalize(q,q);if(.999999<Math.abs(l.dot(N,q)))q=A.identity(f);else{var m=l.cross(N,q,g);l.normalize(m,m);var w=B._34(e,B.b,c);0<l.dot(w,N)&&l.negate(m,m);w=B._34(e,B.d,c);l.normalize(w,w);var D=B.M(l.dot(w,m),-1,1),q=-.999999>=D?A.setAxisAngle(q,Math.acos(D),f):A.rotationTo(w,m,f);A.normalize(q,q)}A.multiply(q,e,e);k&&(k=B._34(e,B.e,b),0>l.dot(N,k)&&A.rotateZ(e,Math.PI,e));a.r(e,d.world_tsr)}}();b.correct_up=gb;var Ya=function(){var b=A.create(),
g=l.create();return function(c){var h=a.g(c.render.world_tsr,b);c=c.render.vertical_axis;h=B._34(h,B.e,g);return 0>l.dot(h,c)}}();b.set_look_at_corrected=ha;var sb=function(){var b=l.create(),g=l.create(),c=l.create(),h=A.create();return function(f,d){for(var N=f.render,k=d.cameras,e=a.g(N.world_tsr,h),e=B._34(e,B.c,b),q=a.j(N.world_tsr,g),m=d.shadow_cameras,w=0;w<m.length;w++){var D=m[w];l.copy(e,D.direction);a.j(N.world_tsr,D.lod_eye)}for(w=0;w<k.length;w++)D=k[w],ob(D,f),l.copy(e,D.direction),
D.dof_object&&D.dof_on&&(N=qa.get_translation(D.dof_object,c),N=l.dist(q,N),D.dof_distance=N)}}();b.update_camera_transform=sb;b.update_camera=function(){var g=A.create(),c=l.create();return function(h){var f=h.render;ra(h);Mb(h);switch(f.move_style){case b.MS_TARGET_CONTROLS:var d=a.j(f.world_tsr,c),N=a.g(f.world_tsr,g);B._31(d,N,f.pivot,B.c);a.r(N,f.world_tsr);for(N=0;N<h.scenes_data.length;N++)for(var k=h.scenes_data[N].cameras,e=0;e<k.length;e++){var q=k[e];q.type!=b.TYPE_STEREO_LEFT&&q.type!=
b.TYPE_STEREO_RIGHT||F(q,l.dist(d,f.pivot),q.stereo_eye_dist)}gb(h,f.vertical_axis);break;case b.MS_EYE_CONTROLS:h.constraint||gb(h,f.vertical_axis)}}}();b.set_horizontal_rot_limits=S;b.set_vertical_rot_limits=L;b.hover_set_vertical_limits=q;b.hover_set_distance_limits=ea;b.set_distance_limits=H;b.set_pivot_limits=D;b.set_hor_trans_limits=h;b.set_vert_trans_limits=ia;var Mb=function(){var g=l.create();return function(c){var h=c.render;if(ga.is_camera(c))for(var f=c.scenes_data,d=0;d<f.length;d++){var N=
f[d].cameras;if(N[0].type===b.TYPE_ORTHO){switch(h.move_style){case b.MS_TARGET_CONTROLS:var k=a.j(h.world_tsr,g),k=l.dist(k,h.pivot),k=k/h.init_dist*h.init_fov;break;case b.MS_HOVER_CONTROLS:k=a.j(h.world_tsr,g);k=l.distance(k,h.hover_pivot);k=k/h.init_dist*h.init_fov;break;default:k=N[0].fov}for(var e=0;e<N.length;e++){var q=N[e];q.fov=k;ja(q,!0)}sb(c,f[d])}}}}();b.update_ortho_scale=Mb;var Fb=function(){var b=A.create(),g=l.create(),c=l.create(),h=l.create();return function(f){f=f.render;var d=
a.j(f.world_tsr,g),N=l.subtract(d,f.pivot,c),k=l.length(N);k>f.distance_limits.max?(l.scale(N,f.distance_limits.max/k,N),l.add(f.pivot,N,d)):k<f.distance_limits.min&&(k=a.g(f.world_tsr,b),k=B._34(k,B.c,h),l.scale(k,100*f.distance_limits.min,k),l.add(N,k,N),l.scale(N,-f.distance_limits.min/l.length(N),N),l.add(f.pivot,N,d));a.v(d,f.world_tsr)}}(),mb=function(){var b=A.create(),g=A.create(),c=A.create(),h=l.create(),f=l.create();return function(d,l,N,k){var e=d.render;if(N||k){var q=A.identity(b);N&&
A.setAxisAngle(d.render.vertical_axis,N,q);d=a.g(e.world_tsr,g);k&&(N=B._34(d,B.d,h),k=A.setAxisAngle(N,k,c),A.normalize(k,k),A.multiply(q,k,q));k=a.j(e.world_tsr,f);B._46(k,l,q,k);a.v(k,e.world_tsr);A.multiply(q,d,d);A.normalize(d,d);a.r(d,e.world_tsr)}}}();b.rotate_target_angles=P;b.set_rotation_target_angles=oa;var Sa=function(){var b=A.create(),g=A.create(),c=A.create(),h=l.create();return function(f,d,l){f=f.render;if(d||l){var N=A.identity(b);d&&(d=A.setAxisAngle(f.vertical_axis,d,g),A.multiply(N,
d,N));d=a.g(f.world_tsr,g);if(l){var k=B._34(d,B.d,h);l=A.setAxisAngle(k,l,c);A.normalize(l,l);A.multiply(N,l,N)}A.multiply(N,d,d);A.normalize(d,d);a.r(d,f.world_tsr)}}}();b.rotate_static_angles=Sa;b.rotate_eye_angles=function(a,b,g){Sa(a,b,g)};b.set_rotation_eye_angles=function(a,b,g){ib(a,b,g)};var ib=function(){var b=new Float32Array(2),g=A.create();return function(c,h,f){var d=c.render,l=a.g(d.world_tsr,g),d=U(l,d.vertical_axis,b);Sa(c,h-d[0],f-d[1])}}();b.set_rotation_static_angles=ib;b.rotate_hover_angles=
Q;b.set_rotation_hover_angles=da;b.rotate_angles=function(a,g,c){var h=a.render.move_style;h===b.MS_TARGET_CONTROLS?P(a,g,c):h===b.MS_EYE_CONTROLS?Sa(a,g,c):h===b.MS_HOVER_CONTROLS?Q(a,g,c):h===b.MS_STATIC&&Sa(a,g,c)};b.set_rotation_angles=function(a,g,c){var h=a.render.move_style;h===b.MS_TARGET_CONTROLS?oa(a,g,c):h===b.MS_EYE_CONTROLS?ib(a,g,c):h===b.MS_HOVER_CONTROLS?da(a,g,c):h===b.MS_STATIC&&ib(a,g,c)};var yb=function(){var b=A.create(),g=new Float32Array(2),c=l.create(),h=l.create();return function(f){var d=
f.render,N=Qa(f,g)[1],k=f.render;f=k.vertical_limits;k=k.distance_limits;f.down-f.up?(N=(f.down-N)/(f.down-f.up),N=Math.max(N,0)):N=0;N=N*(k.max-k.min)+k.min;f=a.j(d.world_tsr,c);k=a.g(d.world_tsr,b);k=B._34(k,B.c,h);l.normalize(k,k);l.scale(k,N,k);l.subtract(d.hover_pivot,k,f);a.v(f,d.world_tsr)}}(),ua=function(){var b=l.create(),g=l.create();return function(c){c=c.render;var h=c.pivot[2],f=B.M(c.pivot[2],c.pivot_limits.min_z,c.pivot_limits.max_z);f!=h&&(h=l.set(0,0,f-h,b),l.add(c.pivot,h,c.pivot),
f=a.j(c.world_tsr,g),l.add(f,h,f),a.v(f,c.world_tsr))}}(),Ra=function(){var b=l.create();return function(g){g=g.render;if(g.hover_horiz_trans_limits){var c=B.M(g.hover_pivot[0],g.hover_horiz_trans_limits.min,g.hover_horiz_trans_limits.max)-g.hover_pivot[0];g.hover_pivot[0]+=c;var h=a.j(g.world_tsr,b);h[0]+=c;a.v(h,g.world_tsr)}g.hover_vert_trans_limits&&(c=B.M(g.hover_pivot[1],g.hover_vert_trans_limits.min,g.hover_vert_trans_limits.max)-g.hover_pivot[1],g.hover_pivot[1]+=c,h=a.j(g.world_tsr,b),h[1]+=
c,a.v(h,g.world_tsr))}}();b.is_float_aspect=function(a){switch(a.type){case b.TYPE_PERSP:case b.TYPE_ORTHO:case b.TYPE_STEREO_LEFT:case b.TYPE_STEREO_RIGHT:return!0;default:return!1}};b.get_angular_diameter=function(a){switch(a.type){case b.TYPE_PERSP:case b.TYPE_PERSP_ASPECT:case b.TYPE_STEREO_LEFT:case b.TYPE_STEREO_RIGHT:var g=K(a);a:{switch(a.fit){case "AUTO":a=1<a.aspect?a.fov:Ca(a)?a.fov*a.aspect:2*Math.atan(Math.tan(a.fov/2)*a.aspect);break a;case "HORIZONTAL":a=a.fov;break a;case "VERTICAL":a=
Ca(a)?a.fov*a.aspect:2*Math.atan(Math.tan(a.fov/2)*a.aspect);break a}a=void 0}return Math.min(g,a);default:return ya.error("get_angular_diameter(): Unsupported camera type: "+a.type),0}};b.set_aspect=function(a,g){switch(a.type){case b.TYPE_PERSP_ASPECT:case b.TYPE_ORTHO_ASPECT:ya.error("set_aspect(): Unsupported camera type: "+a.type);break;default:a.aspect=g}};b.get_aspect=function(a){return a.aspect};b.set_projection=ja;b.set_color_pick_proj=function(a,g,c,h,f){var d=1/Math.max(f,h);switch(a.type){case b.TYPE_NONE:case b.TYPE_PERSP:case b.TYPE_PERSP_ASPECT:f/=
2;h/=2;c=-(c-f)/f*Math.tan(K(a)/2);g=(g-h)/h*Math.tan(K(a)/2)*a.aspect;h=a.near*(c+d);f=a.near*(g+d);c=a.near*(c-d);g=a.near*(g-d);y.frustum(g,f,c,h,a.near,a.far,a.proj_matrix);break;case b.TYPE_ORTHO:case b.TYPE_ORTHO_ASPECT:c=-c/f;g/=h;h=K(a);f=h*a.aspect;y.ortho(-f+(g-d)*(f+f),-f+(g+d)*(f+f),h+(c-d)*(h+h),h+(c+d)*(h+h),a.near,a.far,a.proj_matrix);break;case b.TYPE_ORTHO_ASYMMETRIC:c=-c/f,g/=h,h=a.top+(c+d)*(a.top-a.bottom),f=a.left+(g+d)*(a.right-a.left),c=a.top+(c-d)*(a.top-a.bottom),g=a.left+
(g-d)*(a.right-a.left),y.ortho(g,f,c,h,a.near,a.far,a.proj_matrix)}va(a);Ga(a)};b.calc_sky_vp_inverse=Ea;b.extract_frustum_corners=ta;b.assign_boundings=function(a){a=a.render;var g=V.w();g.min_x=-1;g.max_x=1;g.min_y=-1;g.max_y=1;g.min_z=-1;g.max_z=1;a.bb_local=g;var b=V.l(1,B._1([0,0,0]));a.bs_local=b;a.bcap_local=V.b(1,g);a.bcyl_local=V.d(1,g);a.bcon_local=V.c(1,g)};b.is_static_camera=function(a){return ga.is_camera(a)&&a.render&&a.render.move_style==b.MS_STATIC};b.is_target_camera=function(a){return ga.is_camera(a)&&
a.render&&a.render.move_style==b.MS_TARGET_CONTROLS};b.is_eye_camera=function(a){return ga.is_camera(a)&&a.render&&a.render.move_style==b.MS_EYE_CONTROLS};b.is_hover_camera=function(a){return ga.is_camera(a)&&a.render&&a.render.move_style==b.MS_HOVER_CONTROLS};b.is_ortho_camera=function(a){return ga.is_camera(a)&&a.render&&a.scenes_data[0].cameras[0].type==b.TYPE_ORTHO};b.update_camera_shadows=X;b.csm_far_plane=pa;b.project_point=function(a,g,h){a=a.scenes_data[0].cameras[0];switch(a.type){case b.TYPE_PERSP:case b.TYPE_PERSP_ASPECT:case b.TYPE_ORTHO:case b.TYPE_ORTHO_ASPECT:case b.TYPE_STEREO_LEFT:case b.TYPE_STEREO_RIGHT:case b.TYPE_HMD_LEFT:case b.TYPE_HMD_RIGHT:case b.TYPE_NONE:var f=
Na;f.set(g);f[3]=1;c.transformMat4(f,a.view_proj_matrix,f);g=-f[1]/f[3];h[0]=(f[0]/f[3]+1)/2*a.width;h[1]=(g+1)/2*a.height;xa.viewport_to_canvas_coords(h[0],h[1],h,a);2<h.length&&(h[2]=(f[2]/Math.abs(f[3])+1)/2);return h;default:return ya.error("Non-compatible camera"),h}};b.get_first_cam=function(a){return a.scenes_data[0].cameras[0]};b.get_edge=function(a,g){switch(a.type){case b.TYPE_PERSP:case b.TYPE_PERSP_ASPECT:case b.TYPE_STEREO_LEFT:case b.TYPE_STEREO_RIGHT:var c=Math.tan(K(a)/2);switch(g){case "LEFT":return-c*
a.aspect;case "RIGHT":return c*a.aspect;case "TOP":return c;case "BOTTOM":return-c}break;case b.TYPE_ORTHO:case b.TYPE_ORTHO_ASPECT:switch(g){case "LEFT":return-K(a)*a.aspect;case "RIGHT":return K(a)*a.aspect;case "TOP":return K(a);case "BOTTOM":return-K(a)}break;case b.TYPE_ORTHO_ASYMMETRIC:switch(g){case "LEFT":return a.left;case "RIGHT":return a.right;case "TOP":return a.top;case "BOTTOM":return a.bottom}break;case b.TYPE_HMD_LEFT:case b.TYPE_HMD_RIGHT:c=O.get_active();if((c=O.get_subs(c,wa.STEREO))&&
c.enable_hmd_stereo)switch(g){case "LEFT":return-Math.tan(Math.min(a.hmd_fov[1],a.hmd_fov[3]));case "RIGHT":return Math.tan(Math.min(a.hmd_fov[1],a.hmd_fov[3]));case "TOP":return Math.tan(Math.min(a.hmd_fov[0],a.hmd_fov[2]));case "BOTTOM":return-Math.tan(Math.min(a.hmd_fov[0],a.hmd_fov[2]))}else switch(c=Math.tan(K(a)/2),g){case "LEFT":return-c*a.aspect;case "RIGHT":return c*a.aspect;case "TOP":return c;case "BOTTOM":return-c}break;default:Aa.panic("Unknown camera type")}};b.is_ortho=Ca;b.set_trans_pivot=
function(g,b,c){g=g.render;a.v(b,g.world_tsr);l.copy(c,g.pivot)};b.set_hover_pivot=function(){var g=l.create(),b=l.create();return function(c,h){var f=c.render,d=l.subtract(h,f.hover_pivot,g),k=a.j(f.world_tsr,b),d=l.add(d,k,d);qa.set_translation(c,d);l.copy(h,f.hover_pivot)}}();b.set_target_pivot=function(){var g=l.create(),b=l.create();return function(c,h){var f=c.render,d=l.subtract(h,f.pivot,g),k=a.j(f.world_tsr,b),d=l.add(d,k,d);qa.set_translation(c,d);l.copy(h,f.pivot)}}();b.get_eye=C;b.set_move_style=
function(){var g=l.create(),c=l.create(),h=A.create();return function(f,d){f.render.move_style=d;f.render.horizontal_limits=null;f.render.vertical_limits=null;f.render.distance_limits=null;f.render.hover_horiz_trans_limits=null;f.render.hover_vert_trans_limits=null;rb(f);switch(d){case b.MS_HOVER_CONTROLS:var k=a.j(f.render.world_tsr,g),N=$a(f,0,c);fa(f,k,N,null,null,null,null,f.render.enable_hover_hor_rotation);break;case b.MS_TARGET_CONTROLS:k=C(f,g),N=a.g(f.render.world_tsr,h),N=B._34(N,B.c,c),
N=l.scaleAndAdd(k,N,10,N),l.copy(N,f.render.pivot)}}}();b.wipe_move_style=function(a){a=a.render;a.move_style=0;l.set(0,0,0,a.pivot);l.set(0,0,0,a.hover_pivot);a.use_panning=!1;a.horizontal_limits=null;a.vertical_limits=null;a.distance_limits=null;a.hover_horiz_trans_limits=null;a.hover_vert_trans_limits=null;a.pivot_limits=null;a.enable_hover_hor_rotation=!0};b.set_eye_distance=function(a,g){for(var b=0;b<a.length;b++){var c=a[b];70!=c.type&&80!=c.type&&90!=c.type&&100!=c.type||F(c,c.stereo_conv_dist,
g)}};b.set_hmd_fov=function(a,g,b){var h=O.get_active();a=ga.get_scene_data(a,h).cameras;for(h=0;h<a.length;h++){var f=a[h];if(90==f.type||100==f.type)90==f.type&&c.copy(g,f.hmd_fov),100==f.type&&c.copy(b,f.hmd_fov),f.reflection_plane?v(f,!1):ja(f,!1)}};b.set_hmd_proj_mat=function(a,g,b){var c=O.get_active();a=ga.get_scene_data(a,c).cameras;for(c=0;c<a.length;c++){var h=a[c];if(90==h.type||100==h.type)90==h.type&&g&&y.copy(g,h.proj_matrix),100==h.type&&b&&y.copy(b,h.proj_matrix),va(h),Ga(h)}};b.set_proj_mat=
function(a,h){for(var f=O.get_active(),f=ga.get_scene_data(a,f).cameras,d,l,k,N,e,q,m,w,D=0;D<f.length;D++){var v=f[D];if(v.type==b.TYPE_NONE&&v.near||v.type==b.TYPE_PERSP||v.type==b.TYPE_PERSP_ASPECT){d=v.near;l=y.invert(h,Z);N=c.transformMat4(g,l,Na);k=N[0]*d;N=N[1]*d;q=c.transformMat4(Da,l,Na);e=q[0]*d;q=q[1]*d;l=c.transformMat4(Ba,l,Na);l=-l[2]*l[3];m=y.frustum(e,k,q,N,d,l,Z);w=(k-e)/(N-q);break}}for(D=0;D<f.length;D++)if(v=f[D],v.type==b.TYPE_NONE||v.type==b.TYPE_PERSP||v.type==b.TYPE_PERSP_ASPECT)v.far=
l,v.near=d,v.right=k,v.top=N,v.left=e,v.bottom=q,v.aspect=w,v.fov=Math.atan(N/d)-Math.atan(q/d),y.copy(m,v.proj_matrix),va(v),Ga(v)}});t.a=e},function(C,t,e){C=e(0);var R=e(5),V=e(4),n=e(43),y=e(51),d=e(1),k=e(10),I=e(11),A=e(13);e(2);e=Object(C.a)("__container",function(e,p){var r,a,B;function l(){t.getBoundingClientRect()}function c(a,b,c,f){F.ie11_edge_mouseoffset_hack?(c=c.getBoundingClientRect(),f[0]=a-c.left,f[1]=b-c.top):(ha.clientX=a,ha.clientY=b,ha.view=window,a=new MouseEvent("b4w_convert",
ha),c.dispatchEvent(a),f[0]=a.offsetX,f[1]=a.offsetY);return f}function m(a,b,c,f){a.style.width=c+"px";a.style.height=f+"px";b&&(b.style.width=c+"px",b.style.height=f+"px")}function b(a,b,c){var f=t,d=v;c&&m(f,d,a,b);d&&(d.width=a,d.height=b,z.update_dim());c=Math.floor(a*F.canvas_resolution_factor);b=Math.floor(b*F.canvas_resolution_factor);f.width=c;f.height=b;var d=Math.min(K.drawingBufferWidth,U.max_renderbuffer_size,U.max_viewport_dims[0]),l=Math.min(K.drawingBufferHeight,U.max_renderbuffer_size,
U.max_viewport_dims[1]);if(c>d||b>l)G.warn("Canvas size exceeds platform limits, downscaling"),d=Math.min(d/c,d/b),c*=d,b*=d;f.width=Math.floor(c);f.height=Math.floor(b);E.setup_dim(f.width,f.height,a?c/a:1);E.check_active()&&M.update_transform(E.get_active()._camera);fa.update_media_controls(f.width,f.height)}var f=Object(R.a)(e),T=Object(V.a)(e),fa=Object(n.a)(e),z=Object(y.a)(e),G=Object(d.a)(e),E=Object(k.a)(e),J=Object(I.a)(e),M=Object(A.a)(e),F=T.defaults,U=T.context_limits,K=null,t=null,v=
null,Y=null,ha={clientX:0,clientY:0};a=r=0;B=1;p.setup_context=function(a){K=a};p.get_canvas=function(){return t};p.get_canvas_hud=function(){return v};p.get_container=function(){return Y};p.init=function(a,b){a&&a.parentNode?(t=a,v=b,Y=a.parentNode):f.panic("canvas container is not available")};p.insert_to_container=function(a,b){b=b||"LAST";switch(b){case "FIRST":Y.insertBefore(a,Y.firstElementChild);break;case "JUST_BEFORE_CANVAS":Y.insertBefore(a,t);break;case "JUST_AFTER_CANVAS":t.nextElementSibling?
Y.insertBefore(a,t.nextElementSibling):Y.appendChild(a,t);break;case "LAST":Y.appendChild(a,t);break;default:G.error(b+" invalid stack order")}};p.get_viewport_width=function(){return r};p.get_viewport_height=function(){return a};p.set_canvas_offsets=function(a,b){};p.update_canvas_offsets=l;p.setup_viewport_dim=function(b,c,f){r=b;a=c;B=f;l()};p.force_offsets_updating=function(){};p.client_to_canvas_coords=function(a,b,f){return c(a,b,t,f)};p.get_coords_target_space=function(a,b,f){a.constructor==
MouseEvent?(f[0]=a.offsetX,f[1]=a.offsetY):a.constructor==TouchEvent?(b="touchend"==a.type?a.changedTouches:b?a.targetTouches:a.touches,c(b[0].clientX,b[0].clientY,a.target,f)):(f[0]=-1,f[1]=-1);return f};p.client_to_element_coords=c;p.canvas_to_viewport_coords=function(a,b,c,f){c||(c=new Float32Array(2));c[0]=a*B;c[1]=b*B;f&&(a=f.width/r,c[0]*=a,c[1]*=a);return c};p.viewport_to_canvas_coords=function(a,b,c,f){c||(c=new Float32Array(2));c[0]=a/B;c[1]=b/B;f&&(a=f.width/r,c[0]/=a,c[1]/=a);return c};
p.is_child=function(a){return a&&a.parentNode?a.parentNode==Y?!0:p.is_child(a.parentNode):!1};p.is_hidpi=function(){return F.allow_hidpi&&2<=window.devicePixelRatio?!0:!1};p.resize=b;p.resize_to_container=function(a){var c=Y,f=t,d=c.clientWidth,c=c.clientHeight;if(a||d!=f.clientWidth||c!=f.clientHeight){a=f.width;f=f.height;m(t,v,d,c);if(E.check_active()){var l=E.get_active();if((l=E.get_subs(l,J.STEREO))&&l.enable_hmd_stereo){b(a,f,!1);return}}b(d,c,!1)}};p.reset=function(){Y=v=t=K=null}});t.a=e},
function(C,t,e){C=e(0);var R=e(5),V=e(25),n=e(4),y=e(30),d=e(1),k=e(28),I=e(31),A=e(27),r=e(61),p=e(9),u=e(47),a=e(63),B=e(8),l=e(22),c=e(64),m=e(10),b=e(34),f=e(11),T=e(17),fa=e(6),z=e(20),G=e(2),E=e(3),J=e(7);e=Object(C.a)("__batch",function(e,F){function U(a){a={type:a,subtype:"",id:0,data_id:0,cluster_id:-1,odd_id_prop:"",debug_id_color:-1,debug_main_batch_id:-1,debug_main_batch_render_time:0,debug_render_time:0,debug_render_time_queries:[],textures:[],texture_names:[],bpy_tex_names:[],material_names:[],
common_attributes:[],uv_maps_usage:null,vertex_colors_usage:{},shader:null,shaders_info:Ia.init_shaders_info(),ngraph_proxy_id:"",attribute_setters:[],bufs_data:null,vaos:G.S(),use_shape_keys:!1,debug_sphere:!1,debug_sphere_dynamic:!1,num_vertices:0,num_triangles:0,jitter_amp:0,jitter_freq:0,dynamic_grass:!1,grass_scale_threshold:0,grass_size:0,grass_map_dim:new Float32Array(3),cube_fog:new Float32Array(16),alpha_clip:!1,alpha_antialiasing:!1,blend:!1,depth_mask:!1,xray:!1,use_backface_culling:!1,
use_shadeless:!1,dynamic_geometry:!1,shadow_cast:!1,shadow_cast_only:!1,shadow_receive:!1,reflexible:!1,reflexible_only:!1,reflective:!1,draw_mode:Va.DM_DEFAULT,z_sort:!1,forked_batch:!1,do_not_cull:!1,caustics:!1,lod_dist_max:Ka.LOD_DIST_MAX_INFINITY,lod_dist_min:0,lod_lower_border_range:0,lod_upper_border_range:0,lod_settings:M(),cube_reflection_id:-1,plane_reflection_id:-1,halo:!1,halo_size:0,halo_hardness:0,halo_stars_blend:0,halo_stars_height:0,halo_rings_color:new Float32Array(3),halo_lines_color:new Float32Array(3),
halo_particles:!1,ambient:0,emit:0,diffuse_intensity:1,reflect_factor:0,specular_color_factor:0,specular_alpha:1,parallax_scale:0,diffuse_color_factor:0,alpha_factor:1,normal_factor:0,mirror_factor:0,offset_z:0,refr_bump:0,diffuse_params:new Float32Array(2),specular_params:new Float32Array(3),texture_scale:new Float32Array(3),specular_color:new Float32Array(3),diffuse_color:new Float32Array(4),fresnel_params:new Float32Array(2),lamp_uuid_indexes:null,lamp_light_positions:null,lamp_light_directions:null,
lamp_light_color_intensities:null,has_nodes:!1,wireframe_edge_color:E.create(),water:!1,water_dynamic:!1,water_shore_smoothing:!1,water_generated_mesh:!1,water_num_cascads:0,water_subdivs:0,water_detailed_dist:0,water_norm_uv_velocity:.1,shallow_water_col_fac:0,shore_water_col_fac:0,foam_factor:0,foam_uv_freq:new Float32Array(2),foam_mag:new Float32Array(2),foam_scale:new Float32Array(2),shallow_water_col:new Float32Array(3),shore_water_col:new Float32Array(3),normalmap_scales:null,refractive:!1,
is_sky:!1,draw_proc_sky:!1,particles_data:null,line_width:0,anchor_positions:null,part_node_data:null,node_values:[],node_value_inds:[],node_rgbs:[],node_rgb_inds:[],bounds_local:V.L(),use_be:!1,submesh:null,cleanup_gl_data_on_unload:!0,inst_array_state:0,obj_info_params:new Float32Array(3),lights:[]};a.diffuse_color[3]=1;a.depth_mask=!0;a.line_width=1;a.lod_settings.hyst_prev_state=-1;return a}function K(a){var b=U(a.type);b.subtype=a.subtype;b.id=a.id;b.cluster_id=a.cluster_id;b.odd_id_prop=a.odd_id_prop;
b.debug_id_color=a.debug_id_color;b.debug_main_batch_id=a.debug_main_batch_id;b.debug_main_batch_render_time=a.debug_main_batch_render_time;b.debug_render_time=a.debug_render_time;b.debug_render_time_queries=[];b.textures=a.textures.slice();b.texture_names=a.texture_names.slice();b.bpy_tex_names=a.bpy_tex_names.slice();b.material_names=a.material_names.slice();b.common_attributes=a.common_attributes.slice();b.uv_maps_usage=G.O(a.uv_maps_usage);b.vertex_colors_usage=G.O(a.vertex_colors_usage);b.shader=
a.shader;b.shaders_info=Ia.clone_shaders_info(a.shaders_info);b.ngraph_proxy_id=a.ngraph_proxy_id;b.attribute_setters=Xa.clone_attribute_setters(a.attribute_setters);b.bufs_data=a.bufs_data;b.use_shape_keys=a.use_shape_keys;b.debug_sphere=a.debug_sphere;b.debug_sphere_dynamic=a.debug_sphere_dynamic;b.num_vertices=a.num_vertices;b.num_triangles=a.num_triangles;b.jitter_amp=a.jitter_amp;b.jitter_freq=a.jitter_freq;b.grass_scale_threshold=a.grass_scale_threshold;b.grass_size=a.grass_size;b.grass_map_dim=
a.grass_map_dim;b.cube_fog=a.cube_fog;b.alpha_clip=a.alpha_clip;b.alpha_antialiasing=a.alpha_antialiasing;b.blend=a.blend;b.depth_mask=a.depth_mask;b.xray=a.xray;b.use_backface_culling=a.use_backface_culling;b.use_shadeless=a.use_shadeless;b.dynamic_geometry=a.dynamic_geometry;b.shadow_cast=a.shadow_cast;b.shadow_cast_only=a.shadow_cast_only;b.shadow_receive=a.shadow_receive;b.reflexible=a.reflexible;b.reflexible_only=a.reflexible_only;b.reflective=a.reflective;b.dynamic_grass=a.dynamic_grass;b.draw_mode=
a.draw_mode;b.z_sort=a.z_sort;b.forked_batch=a.forked_batch;b.do_not_cull=a.do_not_cull;b.caustics=a.caustics;b.lod_dist_max=a.lod_dist_max;b.lod_dist_min=a.lod_dist_min;b.lod_lower_border_range=a.lod_lower_border_range;b.lod_upper_border_range=a.lod_upper_border_range;var g=a.lod_settings,c=M();c.use_smoothing=g.use_smoothing;c.coverage=g.coverage;c.cmp_logic=g.cmp_logic;c.dest_coverage=g.dest_coverage;c.hyst_prev_state=g.hyst_prev_state;c.hyst_interval_min=g.hyst_interval_min;c.hyst_interval_max=
g.hyst_interval_max;c.prev_dist=g.prev_dist;b.lod_settings=c;b.cube_reflection_id=a.cube_reflection_id;b.plane_reflection_id=a.plane_reflection_id;b.halo=a.halo;b.halo_size=a.halo_size;b.halo_hardness=a.halo_hardness;b.halo_stars_blend=a.halo_stars_blend;b.halo_stars_height=a.halo_stars_height;E.copy(a.halo_rings_color,b.halo_rings_color);E.copy(a.halo_lines_color,b.halo_lines_color);b.halo_particles=a.halo_particles;b.ambient=a.ambient;b.emit=a.emit;b.diffuse_intensity=a.diffuse_intensity;b.reflect_factor=
a.reflect_factor;b.specular_color_factor=a.specular_color_factor;b.specular_alpha=a.specular_alpha;b.parallax_scale=a.parallax_scale;b.diffuse_color_factor=a.diffuse_color_factor;b.alpha_factor=a.alpha_factor;b.normal_factor=a.normal_factor;b.mirror_factor=a.mirror_factor;b.offset_z=a.offset_z;b.refr_bump=a.refr_bump;b.diffuse_params[0]=a.diffuse_params[0];b.diffuse_params[1]=a.diffuse_params[1];E.copy(a.specular_params,b.specular_params);E.copy(a.texture_scale,b.texture_scale);E.copy(a.specular_color,
b.specular_color);J.copy(a.diffuse_color,b.diffuse_color);b.fresnel_params.set(a.fresnel_params);b.lamp_uuid_indexes=G.O(a.lamp_uuid_indexes);a.lamp_light_positions&&(b.lamp_light_positions=new Float32Array(a.lamp_light_positions),b.lamp_light_directions=new Float32Array(a.lamp_light_directions),b.lamp_light_color_intensities=new Float32Array(a.lamp_light_color_intensities));b.has_nodes=a.has_nodes;E.copy(a.wireframe_edge_color,b.wireframe_edge_color);b.water=a.water;b.water_dynamic=a.water_dynamic;
b.water_shore_smoothing=a.water_shore_smoothing;b.water_generated_mesh=a.water_generated_mesh;b.water_num_cascads=a.water_num_cascads;b.water_subdivs=a.water_subdivs;b.water_detailed_dist=a.water_detailed_dist;b.water_norm_uv_velocity=a.water_norm_uv_velocity;b.shallow_water_col_fac=a.shallow_water_col_fac;b.shore_water_col_fac=a.shore_water_col_fac;b.foam_factor=a.foam_factor;b.foam_uv_freq.set(a.foam_uv_freq);b.foam_mag.set(a.foam_mag);b.foam_scale.set(a.foam_scale);E.copy(a.shallow_water_col,b.shallow_water_col);
E.copy(a.shore_water_col,b.shore_water_col);b.normalmap_scales=G.O(a.normalmap_scales);b.refractive=a.refractive;b.is_sky=a.is_sky;b.draw_proc_sky=a.draw_proc_sky;a.particles_data&&(b.particles_data=fb.clone_particles_data(a.particles_data));b.line_width=a.line_width;a.anchor_positions&&(b.anchor_positions=new Float32Array(a.anchor_positions));b.part_node_data=G.O(a.part_node_data);b.node_values=a.node_values.slice();b.node_value_inds=a.node_value_inds.slice();b.node_rgbs=a.node_rgbs.slice();b.node_rgb_inds=
a.node_rgb_inds.slice();V.t(a.bounds_local,b.bounds_local);b.use_be=a.use_be;b.cleanup_gl_data_on_unload=a.cleanup_gl_data_on_unload;b.obj_info_params=a.obj_info_params;b.lights=a.lights;return b}function M(){return{use_smoothing:!1,coverage:0,dest_coverage:0,hyst_prev_state:0,hyst_interval_min:0,hyst_interval_max:0,prev_dist:0,cmp_logic:1}}function v(a){switch(a.type){case "MAIN":case "PARTICLES":case "LINE":a.subtype=a.blend?a.xray?"XRAY":"BLEND":"OPAQUE";break;case "SHADOW":a.subtype=a.shadow_cast_only?
"CAST":"RECEIVE";break;case "COLOR_ID":a.subtype=a.xray?"COLOR_ID_XRAY":"COLOR_ID"}}function Y(a,b,g){for(var c=[],h=0;h<a.length;h++){var f=a[h],d=f._object;d.is_hair_dupli||c.push.apply(c,ha(f,d.render,b,g))}return c}function ha(a,b,g,c){var h=[],f=a._object,d=L(g,b,!b.do_not_render,!1),l=a.data,k=f.materials,e=Array(k.length),N=Array(k.length),m=[],D=Wa.find_subs(g,Ua.MAIN_OPAQUE),w=!1;D&&(w=D.light_positions.length?!0:!1);for(var v=0;v<d.length;v++)for(var p=d[v],r=0;r<k.length;r++){var z=k[r];
if(!qa(f,r)&&!Va.has_empty_submesh(l,r))if("PHYSICS"==p&&a.b4w_collision&&"NAVMESH"==a.game.physics_type)m.push(Va.extract_submesh(l,r,[],b.bone_skinning_info,{},null));else if(!z.is_lens_flares||w){var H=U(p);H.lights=G.O(c);"MAIN"==p?e[r]=H:"DEBUG_VIEW"==p&&(N[r]=H);H.cluster_id=a.b4w_cluster_data.cluster_id;if(Ca(H,z)&&q(H,z,l)){"SHADOW"==p&&e[r]&&(H.use_shadeless=e[r].use_shadeless);H.draw_mode=b.use_shape_keys||b.dynamic_geometry?Va.DM_DYNAMIC_TRIANGLES:Va.DM_DEFAULT;Ga(H,b);Ea(H,a.particle_systems);
if("DYNAMIC"==b.type||"COLOR_ID"==H.type)H.odd_id_prop=wa(H,b,a.uuid);H.do_not_cull=a.b4w_do_not_cull;"MAIN"==H.type&&(H.caustics=a.b4w_caustics);X(H,"DISABLE_FOG",("COLOR_ID"!=p&&"SHADOW"!=p&&a.b4w_disable_fogging)|0);var la=Va.extract_submesh(l,r,H.common_attributes,b.bone_skinning_info,H.vertex_colors_usage,H.uv_maps_usage);!z.use_tangent_shading||"a_shade_tangs"in la.va_frames[0]||(X(H,"CALC_TBN",1),ta(H,"a_tbn"));if(z.is_lens_flares){for(var n=la,E=n.base_length,Y=n.va_frames[0].a_position,u=
[],B=[],S=0;S<E;S++)B.push(Y[3*S]),u.push(Y[3*S+1]),B.push(Y[3*S+2]);u=new Float32Array(u);B=new Float32Array(B);n.va_common.a_lf_dist=u;n.va_common.a_lf_bb_vertex=B;la=n}C(H);h.push({batch:H,obj_render:b,batch_render:b,submesh:la,mat_names:[z.name],rel_bpy_objects:[a]})}}}if(m.length){H=U("PHYSICS");H.subtype="NAVMESH";H.odd_id_prop=wa(H,b,a.uuid);for(var la=Va.submesh_list_join(m),A=[],v=0;v<k.length;v++)A.push(k[v].name);C(H);h.push({batch:H,obj_render:b,batch_render:b,submesh:la,mat_names:A,rel_bpy_objects:[a]})}for(v=
0;v<N.length;v++)N[v]&&(N[v].debug_main_batch_id=e[v].id,C(N[v]));var ea=a.particle_systems;if(0<ea.length){for(var K=!1,ha=!1,v=0;v<ea.length;v++){var ma=ea[v],O=ma.settings;O.use_render_emitter&&h.length&&(K=!0);"HAIR"!=O.type||"OBJECT"!=O.render_type&&"GROUP"!=O.render_type&&ma.transforms.length||(ha=!0);if(K&&ha)break}if(h.length)var Ya=h[0];else{var P=U("TMP");Ea(P,ea);var I=Va.extract_submesh(l,0,P.common_attributes,b.bone_skinning_info,P.vertex_colors_usage,P.uv_maps_usage),Ya={batch:P,submesh:I}}var mb=
Ya.batch.vertex_colors_usage;if(ha)if(1<k.length){for(var T,ia={},Fb=0;Fb<ea.length;Fb++){var za=ea[Fb].settings;if("HAIR"==za.type&&("OBJECT"==za.render_type||"GROUP"==za.render_type)){var ob=za.b4w_vcol_from_name,J=za.b4w_vcol_to_name;""!==ob&&""!==J&&(ia[ob]=G.O(mb[ob]))}}"a_bending_col_main"in mb&&(ia.a_bending_col_main=G.O(mb.a_bending_col_main));"a_bending_col_detail"in mb&&(ia.a_bending_col_detail=G.O(mb.a_bending_col_detail));T=Va.extract_submesh_all_mats(l,[],ia)}else T=Ya.submesh;else T=
null;for(var F=T,ra=a._object,da=[],fa=a.particle_systems,y=a.data,Oa=0;Oa<fa.length;Oa++){var M=fa[Oa],gb=M.settings;if(gb.count)if("EMITTER"==gb.type){if("DYNAMIC"==b.type){var ba=U("PARTICLES");ba.bounds_local.bb=b.bb_local;ba.bounds_local.be=b.be_local;ba.bounds_local.bs=b.bs_local;ba.lights=G.O(c);var Ja,ja=M.settings.material-1;ja>=ra.materials.length&&(Da.warn('Wrong material used for rendering particle system "'+M.name+'"'),ja=0);Ja=ja;var t=ra.materials[Ja];if(!qa(ra,Ja)&&("HALO"===M.settings.render_type&&
"HALO"==t.type&&(ba.halo_particles=!0),q(ba,t,y))){var Qa=ba,Sa=ra,sb=M.settings;switch(sb.b4w_billboard_align){case "VIEW":X(Qa,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW");break;case "XY":X(Qa,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_XY");break;case "YZ":X(Qa,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_YZ");break;case "ZX":X(Qa,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_ZX");break;default:na.panic("Wrong billboard align value")}X(Qa,"BILLBOARD",0);var Db=sb.b4w_enable_soft_particles&&Ka.check_obj_soft_particles_accessibility(Sa,
sb);X(Qa,"SOFT_PARTICLES",0<sb.b4w_particles_softness&&Db&&Z.depth_tex_available?1:0);X(Qa,"SOFT_STRENGTH",Ia.glsl_value(sb.b4w_particles_softness));Ia.set_directive(Qa.shaders_info,"WORLD_SPACE","WORLD"==sb.b4w_coordinate_system?1:0);ba.dynamic_geometry=!0;ba.do_not_cull=a.b4w_do_not_cull;ba.odd_id_prop=wa(ba,b,ra.name+"_"+gb.uuid);fb.create_particles_data(ba,M,t);var oa=fb.generate_emitter_particles_submesh(ba,y,M,ra.render);fb.update_particles_submesh(oa,ba,gb.count);fb.update_particles_objs_cache(ra);
Ga(ba,ra.render);C(ba);da.push({batch:ba,obj_render:b,batch_render:b,submesh:oa,mat_names:[t.name],rel_bpy_objects:[a]})}}}else if("HAIR"==gb.type){var Q=G._13(M.seed),W=-1!=G._70(Z.loaded_data_version,yb)&&!gb.b4w_initial_rand_rotation&&!gb.b4w_hair_billboard,sa=4;W&&(sa=8);if(M.transforms.length)var Pa=M.transforms;else for(var pa=Va.geometry_random_points(F,gb.count,!1,Q),Pa=new Float32Array(pa.length*sa),Aa=0;Aa<pa.length;Aa++){var xa=.75+.5*G._40(Q);Pa[Aa*sa]=pa[Aa][0];Pa[Aa*sa+1]=pa[Aa][1];
Pa[Aa*sa+2]=pa[Aa][2];Pa[Aa*sa+3]=xa;W&&(Pa[Aa*sa+4]=1,Pa[Aa*sa+5]=0,Pa[Aa*sa+6]=0,Pa[Aa*sa+7]=0)}var La=Wa.find_subs(g,Ua.GRASS_MAP)?!0:!1;if("OBJECT"==gb.render_type){var Mb=[L(g,gb.dupli_object._object.render,!b.do_not_render,!0)],$a=ka(a,b,mb,F,[gb.dupli_object],Mb,[Pa],gb,M,La,Q,!1,c);da.push.apply(da,$a)}else if("GROUP"==gb.render_type){for(var ga=gb.dupli_group.objects,Mb=[],Aa=0;Aa<ga.length;Aa++){var va=L(g,ga[Aa]._object.render,!b.do_not_render,!0);Mb.push(va)}for(var ib=!1,Xa=[],Aa=0;Aa<
ga.length;Aa++)Xa.push(ga[Aa]._object);if(gb.use_whole_group)var ua=Ra(Pa,Xa,W,sa),ib=!0;else{var Ta;if(gb.use_group_count){for(var rb=Pa,Ba=Xa,ya=gb.dupli_weights,R=Q,V=W,Ma=sa,Na={},Pc=[],ub=0;ub<Ba.length;ub++)for(var Ob=Ba[ub],Zc=Ob.origin_name||Ob.name,kb=0;kb<ya.length;kb++){var Xb=ya[kb];Zc==Xb.name&&Pc.push(Xb)}ya.length!=Pc.length&&Da.error("dupli weights match failed");for(ub=0;ub<rb.length;ub+=Ma){for(var hc,Fc=Pc,Kb=[0],$b=0;$b<Fc.length;$b++)Kb[$b+1]=Kb[$b]+Fc[$b].count;for(var wc=Kb[Kb.length-
1]*G._40(R),Qc=0,$b=0;$b<Kb.length;$b++)if(wc>=Kb[$b]&&wc<Kb[$b+1]){Qc=$b;break}hc=Qc;Na[hc]=Na[hc]||[];Na[hc].push(rb[ub],rb[ub+1],rb[ub+2],rb[ub+3]);V&&Na[hc].push(rb[ub+4],rb[ub+5],rb[ub+6],rb[ub+7])}for(hc in Na)Na[hc]=new Float32Array(Na[hc]);Ta=Na}else{for(var ac=Pa,Yb=Q,bc=W,Pb=sa,Rc=Xa.length,ic={},Lb=0;Lb<ac.length;Lb+=Pb){var hb=Math.floor(Rc*G._40(Yb));ic[hb]=ic[hb]||[];ic[hb].push(ac[Lb],ac[Lb+1],ac[Lb+2],ac[Lb+3]);bc&&ic[hb].push(ac[Lb+4],ac[Lb+5],ac[Lb+6],ac[Lb+7])}for(hb in ic)ic[hb]=
new Float32Array(ic[hb]);Ta=ic}ua=Ta}$a=ka(a,b,mb,F,ga,Mb,ua,gb,M,La,Q,ib,c);da.push.apply(da,$a)}"INSTANCE"==gb.b4w_wind_bend_inheritance&&ra.render.wind_bending&&Da.warn('Emitter object "'+ra.name+"\" has a particle system with wind bending inheritance from the particle instance. Wind bending on the emitter isn't disabled. Expect unforeseen behavior.")}else na.panic("Unknown particle settings type")}K?h.push.apply(h,da):h=da}return h}function S(a){for(var b=[],c=[],h={},f=0;f<a.length;f++){var d=
a[f].batch,l=null;if(d.id in h){var k=h[d.id],e=c[k].batch;Aa(d,function(a){Aa(e,function(b){G._59(a,b)&&1!=a.inst_array_state&&(l=c[k])})});if(!l){do d.id++;while(h[d.id])}}l||(l={batch:d,obj_renders_ordered:[],batch_renders_ordered:[],submeshes_ordered:[],rel_bpy_objects:[],rel_bpy_objects_uuids:[],mat_names:[]},h[d.id]=c.length,c.push(l));if(a[f].submesh&&a[f].submesh.base_length){l.obj_renders_ordered.push(a[f].obj_render);l.batch_renders_ordered.push(a[f].batch_render);l.submeshes_ordered.push(a[f].submesh);
for(var N=0;N<a[f].rel_bpy_objects.length;N++)d=a[f].rel_bpy_objects[N],-1==l.rel_bpy_objects_uuids.indexOf(d.uuid)&&(l.rel_bpy_objects.push(d),l.rel_bpy_objects_uuids.push(d.uuid));for(N=0;N<a[f].mat_names.length;N++)d=a[f].mat_names[N],-1==l.mat_names.indexOf(d)&&l.mat_names.push(d)}l.mat_names.sort()}for(f=0;f<c.length;f++){var d=c[f].batch,m=c[f].obj_renders_ordered,q=c[f].batch_renders_ordered,D=c[f].submeshes_ordered;a="DYNAMIC"==q[0].type||"COLOR_ID"==d.type?q[0]:Ka.clone_render(q[0]);if("STATIC"==
a.type&&"COLOR_ID"!=d.type)for(N=0;N<m.length;N++){var w=m[N],v=q[N],h=D[N],p=fa.m(Fb);if(w.billboard&&!w.billboard_pres_glob_orientation){var r=fa.j(w.world_tsr,ob);fa.v(r,p);w=fa.i(w.world_tsr,ob);fa.s(w,p)}else fa.a(w.world_tsr,p);v.is_hair_particles?h.instanced_array_data||(v.billboard?Va.submesh_apply_particle_transform(h,p):Va.submesh_apply_transform(h,p)):Va.submesh_apply_transform(h,p);if(v.is_hair_particles)X(d,"AU_QUALIFIER","GLSL_IN");else if(1<c[f].rel_bpy_objects.length){w={};if(v.wind_bending||
v.billboard)w.au_center_pos=fa.j(p,E.create());v.wind_bending&&(w.au_wind_bending_amp=[v.wind_bending_amp],w.au_wind_bending_freq=[v.wind_bending_freq],w.au_detail_bending_amp=[v.detail_bending_amp],w.au_detail_bending_freq=[v.detail_bending_freq],w.au_branch_bending_amp=[v.branch_bending_amp]);Va.submesh_apply_params(h,w);X(d,"AU_QUALIFIER","GLSL_IN")}else a.center_pos.set(p.subarray(0,3)),X(d,"AU_QUALIFIER","uniform")}if(0==D.length)h=Va.init_submesh(g.unique_name("%empty"));else if(1==D.length)h=
D[0];else{h=[];for(N=0;N<D.length;N++)Va.is_long_submesh(D[N])||h.push(N);if(h.length<D.length)for(N=0;N<h.length;N++)Va.submesh_drop_indices(D[h[N]]);h=Va.submesh_list_join(D)}if("STATIC"==a.type){if("COLOR_ID"!=d.type){D=[];for(N=0;N<c[f].rel_bpy_objects.length;N++)V.G(c[f].rel_bpy_objects[N]._object.render.bbr_world,D);V.a(D,0,D.length,a.bb_world);V.o(a.bb_world,a.bb_local);a.be_world=V.z(G._1(D),!0);V.s(a.be_world,a.be_local);a.bs_world=V.B(a.be_world);V.u(a.bs_world,a.bs_local)}a.is_lod&&(N=
c[f].rel_bpy_objects[0].b4w_cluster_data,N.cluster_center?a.lod_center.set(N.cluster_center):a.lod_center.set(a.bs_world.center))}"PARTICLES"!=d.type&&(N=h.submesh_bd,a.billboard?(V.o(a.bb_local,d.bounds_local.bb),V.s(a.be_local,d.bounds_local.be),V.u(a.bs_local,d.bounds_local.bs),d.use_be=!1):(V.o(N.bb_local,d.bounds_local.bb),V.s(N.be_local,d.bounds_local.be),a.bs_local.radius<N.bs_local.radius?"STATIC"==a.type&&"COLOR_ID"!=d.type?V.u(a.bs_world,d.bounds_local.bs):V.u(a.bs_local,d.bounds_local.bs):
V.u(N.bs_local,d.bounds_local.bs),d.use_be=V.M(d.bounds_local.be,d.bounds_local.bs)));b.push({batch:d,render:a,submesh:h,mat_names:c[f].mat_names,rel_bpy_objects:c[f].rel_bpy_objects})}return b}function L(a,b,g,c){var h=[];c||(b.selectable&&Wa.find_subs(a,Ua.COLOR_PICKING)||b.outlining&&Wa.find_subs(a,Ua.OUTLINE_MASK))&&h.push("COLOR_ID");g&&(h.push("MAIN"),h.push("NODES_GLOW"),Wa.find_subs(a,Ua.DEBUG_VIEW)&&h.push("DEBUG_VIEW"),Wa.find_subs(a,Ua.SHADOW_RECEIVE)&&h.push("SHADOW"),Wa.find_subs(a,Ua.GRASS_MAP)&&
h.push("GRASS_MAP"));h.push("PHYSICS");if(b.shadow_cast_only||b.reflexible_only)for(a=null,b.shadow_cast_only&&(a=["MAIN","NODES_GLOW","COLOR_ID","PHYSICS","DEBUG_VIEW"]),b.reflexible_only&&(b=["COLOR_ID","PHYSICS","SHADOW","DEBUG_VIEW"],a=null!==a?G.D(a,b):b),b=a,a=0;a<b.length;a++)g=h.indexOf(b[a]),-1!==g&&h.splice(g,1);return h}function q(a,b,g){var c;switch(a.type){case "MAIN":if(b.do_not_render)c=!1;else{if(b.use_nodes&&"HALO"!=b.type)P(a,b,g,"MAIN");else{D(a,b);a.use_backface_culling=b.use_backface_culling;
a.xray=b.render_above_all&&"OPAQUE"!=b.blend_mode&&"CLIP"!=b.blend_mode&&"ALPHA_ANTIALIASING"!=b.blend_mode;a.offset_z=b.offset_z;a.texture_scale.set([1,1,1]);var f=b.texture_slots;a.diffuse_color.set(b.diffuse_color);a.diffuse_color[3]=b.alpha;if(b.is_lens_flares){ga(a,"lens_flares.glslv","lens_flares.glslf");ta(a,"a_position");ta(a,"a_texcoord");var d=Na.get_batch_texture(f[0]),l=f[0].texture;ya(a,d,"u_sampler",l.name)}else{ga(a,"main.glslv","main_stack.glslf");b.use_shadeless||(g={use_shadeless:b.use_shadeless,
diffuse_shader:b.diffuse_shader,specular_shader:b.specular_shader,use_tangent_shading:b.use_tangent_shading},c=w(b.uuid,"MAIN"),g=ma.create_lighting_graph(c,g,a.lights),a.shaders_info.node_elements=ma.compose_node_elements(g));var k=h("use_map_color_diffuse",!0,f);c=h("use_map_color_spec",!0,f);var e=h("use_map_normal",!0,f),m=h("use_map_mirror",!0,f),q=h("use_stencil",!0,f);g=k[0];c=c[0];e=e[0];m=m[0];k=k[1];f=q[0]&&h("use_rgb_to_intensity",!0,f)[0];if(g){l=g.texture;switch(g.blend_type){case "MIX":X(a,
"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":X(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}d=Na.get_batch_texture(g);ya(a,d,"u_colormap0",l.name);a.diffuse_color_factor=g.diffuse_color_factor;a.alpha_factor=g.use_map_alpha?g.alpha_factor:0;a.texture_scale.set(g.scale)}q=g&&g==c;c&&(q||(l=c.texture,d=Na.get_batch_texture(c),ya(a,d,"u_specmap0",l.name)),a.specular_color_factor=c.specular_color_factor);if(e&&(l=e.texture,ta(a,"a_tbn"),d=Na.get_batch_texture(e),ya(a,
d,"u_normalmap0",l.name),a.normal_factor=e.normal_factor,l.b4w_use_map_parallax&&Z.parallax)){var d=Ia.glsl_value(l.b4w_parallax_steps),v=Ia.glsl_value(l.b4w_parallax_lod_dist);X(a,"PARALLAX",1);X(a,"PARALLAX_STEPS",d);X(a,"PARALLAX_LOD_DIST",v);a.parallax_scale=l.b4w_parallax_scale}m&&(l=m.texture,d=Na.get_batch_texture(m),ya(a,d,"u_mirrormap",l.name),a.mirror_factor=m.mirror_factor);if(m=g&&k&&f?1:0)d=Na.get_batch_texture(k),l=k.texture,ya(a,d,"u_colormap1",l.name),d=Na.get_batch_texture(f),l=f.texture,
ya(a,d,"u_stencil0",l.name);(l=g||c||e)&&a.texture_scale.set(l.scale);X(a,"TEXTURE_SPEC",void 0==c?0:1);X(a,"ALPHA_AS_SPEC",q?1:0);X(a,"TEXTURE_STENCIL_ALPHA_MASK",m);ta(a,"a_position");ta(a,"a_tbn");(g||c||e)&&ta(a,"a_texcoord");if(b.water_settings.is_water){a.water=!0;a.water_dynamic=b.water_settings.is_dynamic;b.water_settings.shore_smoothing&&!a.blend?(Da.warn('Material: "'+b.name+'" is opaque.',"Disabling water shore smoothing."),a.water_shore_smoothing=!1):a.water_shore_smoothing="REFLECT"!=
a.subtype?b.water_settings.shore_smoothing:!1;ga(a,"water.glslv","water.glslf");m={use_shadeless:!1,diffuse_shader:b.diffuse_shader,specular_shader:b.specular_shader,use_tangent_shading:b.use_tangent_shading};q=w(b.uuid);m=ma.create_lighting_graph(q,m,a.lights);a.shaders_info.node_elements=ma.compose_node_elements(m);ta(a,"a_position");Z.water_wireframe_debug?(ta(a,"a_polyindex"),a.depth_mask=!0,E.set(0,0,0,a.wireframe_edge_color),Ba.get_standard_derivatives()?X(a,"DEBUG_WIREFRAME",1):X(a,"DEBUG_WIREFRAME",
2)):X(a,"DEBUG_WIREFRAME",0);q=b.texture_slots;m=h("use_map_normal",!0,q);d=h("use_map_mirror",!0,q)[0];m.length&&(v=Na.get_batch_texture(m[0]),l=m[0].texture,ya(a,v,"u_normalmap0",l.name),a.water_norm_uv_velocity=b.water_settings.norm_uv_velocity);X(a,"NUM_NORMALMAPS",m.length);a.normalmap_scales=Array(m.length);for(l=0;l<m.length;l++)a.normalmap_scales[l]=new Float32Array(2),a.normalmap_scales[l].set([m[l].scale[0],m[l].scale[1]]);d&&(v=Na.get_batch_texture(d),l=d.texture,ya(a,v,"u_mirrormap",l.name),
a.mirror_factor=d.mirror_factor);d=null;if(Z.foam)for(l=0;l<q.length;l++){var N=q[l];if(!0===N.texture.b4w_water_foam){d=N;break}}d&&(X(a,"FOAM",1),v=Na.get_batch_texture(d),l=d.texture,ya(a,v,"u_foam",l.name),a.foam_factor=b.water_settings.foam_factor,a.foam_uv_freq.set(l.b4w_foam_uv_freq),a.foam_mag.set(l.b4w_foam_uv_magnitude),a.foam_scale[0]=d.scale[0],a.foam_scale[1]=d.scale[1]);for(l=0;l<q.length;l++)if(N=q[l],!0===N.texture.b4w_shore_dist_map){var p=N;break}p&&Z.allow_vertex_textures&&(q=Na.get_batch_texture(p),
l=p.texture,ya(a,q,"u_shore_dist_map",l.name),X(a,"SHORE_PARAMS",1),p=N.texture.b4w_shore_boundings,X(a,"MAX_SHORE_DIST",Ia.glsl_value(N.texture.b4w_max_shore_dist)),X(a,"SHORE_MAP_SIZE_X",Ia.glsl_value(p[0]-p[1])),X(a,"SHORE_MAP_SIZE_Y",Ia.glsl_value(p[2]-p[3])),X(a,"SHORE_MAP_CENTER_X",Ia.glsl_value((p[0]+p[1])/2)),X(a,"SHORE_MAP_CENTER_Y",Ia.glsl_value((p[2]+p[3])/2)));b.water_settings.is_generated_mesh?(X(a,"GENERATED_MESH",1),a.water_generated_mesh=!0,a.water_num_cascads=b.water_settings.num_cascads,
a.water_subdivs=b.water_settings.num_subdivs,a.water_detailed_dist=b.water_settings.detailed_dist):(ta(a,"a_tbn"),(d||m.length)&&ta(a,"a_texcoord"),X(a,"GENERATED_MESH",0));if(b.water_settings.is_dynamic){var N=Ia.glsl_value(b.water_settings.dst_noise_scale0),p=Ia.glsl_value(b.water_settings.dst_noise_scale1),m=Ia.glsl_value(b.water_settings.dst_noise_freq0),q=Ia.glsl_value(b.water_settings.dst_noise_freq1),l=Ia.glsl_value(b.water_settings.dir_min_shore_fac),d=Ia.glsl_value(b.water_settings.dir_freq),
v=Ia.glsl_value(b.water_settings.dir_noise_scale),r=Ia.glsl_value(b.water_settings.dir_noise_freq),z=Ia.glsl_value(b.water_settings.dir_min_noise_fac),L=Ia.glsl_value(b.water_settings.dst_min_fac),n=Ia.glsl_value(b.water_settings.waves_hor_fac);X(a,"DST_NOISE_SCALE_0",N);X(a,"DST_NOISE_SCALE_1",p);X(a,"DST_NOISE_FREQ_0",m);X(a,"DST_NOISE_FREQ_1",q);X(a,"DIR_MIN_SHR_FAC",l);X(a,"DIR_FREQ",d);X(a,"DIR_NOISE_SCALE",v);X(a,"DIR_NOISE_FREQ",r);X(a,"DIR_MIN_NOISE_FAC",z);X(a,"DST_MIN_FAC",L);X(a,"WAVES_HOR_FAC",
n)}ra(a,b);za(a,b);a.shallow_water_col.set(b.water_settings.shallow_col);a.shore_water_col.set(b.water_settings.shore_col);a.shallow_water_col_fac=b.water_settings.shallow_col_fac;a.shore_water_col_fac=b.water_settings.shore_col_fac;X(a,"ABSORB",Ia.glsl_value(b.water_settings.absorb_factor));X(a,"SSS_STRENGTH",Ia.glsl_value(b.water_settings.sss_strength));X(a,"SSS_WIDTH",Ia.glsl_value(b.water_settings.sss_width))}"HALO"===b.type&&(ga(a,"halo.glslv","halo.glslf"),ea(a,b),a.common_attributes=["a_position"]);
b.use_tangent_shading&&(X(a,"USE_TBN_SHADING",1),ta(a,"a_shade_tangs"));X(a,"TEXCOORD",0);X(a,"NORMAL_TEXCOORD",0);g&&H(a,g,"TEXTURE_COLOR0_CO");k&&H(a,k,"TEXTURE_COLOR1_CO");f&&H(a,f,"TEXTURE_STENCIL_ALPHA_MASK_CO");c&&H(a,c,"TEXTURE_SPEC_CO");e&&H(a,e,"TEXTURE_NORM_CO");X(a,"SHADELESS",b.use_shadeless?1:0);a.use_shadeless=b.use_shadeless}X(a,"ALPHA","OPAQUE"===b.blend_mode?0:1);X(a,"ALPHA_CLIP","CLIP"===b.blend_mode?1:0);X(a,"DOUBLE_SIDED_LIGHTING",b.use_double_sided_lighting?1:0);b.use_vertex_color_paint?
(X(a,"VERTEX_COLOR",1),ta(a,"a_color")):X(a,"VERTEX_COLOR",0);a.ambient=b.ambient;a.diffuse_intensity=b.diffuse_intensity;a.emit=b.emit;a.specular_color.set(b.specular_color);a.specular_alpha=b.specular_alpha;ra(a,b);za(a,b);b.is_wettable?X(a,"WETTABLE",1):X(a,"WETTABLE",0);ia(a,b);b.is_refractive&&!a.blend?(Da.warn('Material "'+b.name+'" is not blend. Disabling refractions.'),a.refractive=!1):a.refractive=b.is_refractive;a.refr_bump=b.refr_bump}c=!0}break;case "NODES_GLOW":c=P(a,b,g,"GLOW");break;
case "SHADOW":if(b.is_lens_flares||b.water_settings.is_water||b.do_not_render||"HALO"==b.type)c=!1;else if(D(a,b),a.use_backface_culling=b.use_backface_culling,a.blend)c=!1;else{!b.use_nodes||"CLIP"!=b.blend_mode&&"ALPHA_ANTIALIASING"!=b.blend_mode?ga(a,"shadow.glslv","shadow.glslf"):P(a,b,g,"SHADOW");a.depth_mask=a.depth_mask&&!(Z.reuse_depth_optimization&&"ALPHA_ANTIALIASING"==b.blend_mode);J.set(0,0,0,b.alpha,a.diffuse_color);ta(a,"a_position");ta(a,"a_tbn");X(a,"ALPHA","OPAQUE"===b.blend_mode?
0:1);a.texture_scale.set([1,1,1]);g=h("use_map_color_diffuse",!0,b.texture_slots)[0];if(!g||"CLIP"!=b.blend_mode&&"ALPHA_ANTIALIASING"!=b.blend_mode)X(a,"TEXTURE_COLOR",0);else{switch(g.blend_type){case "MIX":X(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":X(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.texture_scale.set(g.scale);X(a,"TEXTURE_COLOR",1);ta(a,"a_texcoord");b=Na.get_batch_texture(g);g=g.texture;"IMAGE"!=b.source&&"ENVIRONMENT_MAP"!=b.source&&"CANVAS"!=
b.source&&"NONE"!=b.source||ya(a,b,"u_colormap0",g.name)}c=!0}break;case "PHYSICS":g=b.physics_settings;b=b.water_settings;g.use_coll_physics?(a.use_ghost=g.use_ghost,a.collision_id=g.collision_id,a.collision_margin=g.collision_margin,a.collision_group=g.collision_group,a.collision_mask=g.collision_mask,a.friction=g.friction,a.elasticity=g.elasticity,c=!0):b.is_water?(a.water=!0,a.water_dynamics=b.is_dynamic,a.dst_noise_scale0=b.dst_noise_scale0,a.dst_noise_scale1=b.dst_noise_scale1,a.dst_noise_freq0=
b.dst_noise_freq0,a.dst_noise_freq1=b.dst_noise_freq1,a.dir_min_shore_fac=b.dir_min_shore_fac,a.dir_freq=b.dir_freq,a.dir_noise_scale=b.dir_noise_scale,a.dir_noise_freq=b.dir_noise_freq,a.dir_min_noise_fac=b.dir_min_noise_fac,a.dst_min_fac=b.dst_min_fac,a.waves_hor_fac=b.waves_hor_fac,c=!0):c=!1;break;case "COLOR_ID":if(b.is_lens_flares||"HALO"==b.type)c=!1;else{e=c=b.blend_mode;"ALPHA_ANTIALIASING"==e&&(e="CLIP",b.blend_mode="CLIP");D(a,b);a.use_backface_culling=b.use_backface_culling;a.z_sort=!1;
a.depth_mask=!0;a.blend=!1;a.xray=b.render_above_all&&"OPAQUE"!=e&&"CLIP"!=e;b.use_nodes&&"CLIP"==e?P(a,b,g,"COLOR_ID"):ga(a,"color_id.glslv","color_id.glslf");J.set(0,0,0,b.alpha,a.diffuse_color);ta(a,"a_position");X(a,"ALPHA","OPAQUE"===e?0:1);a.texture_scale.set([1,1,1]);g=h("use_map_color_diffuse",!0,b.texture_slots)[0];X(a,"ALPHA_CLIP","CLIP"===e?1:0);if(g&&"CLIP"==e){switch(g.blend_type){case "MIX":X(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":X(a,"TEXTURE_BLEND_TYPE",
"TEXTURE_BLEND_TYPE_MULTIPLY")}a.texture_scale.set(g.scale);X(a,"TEXTURE_COLOR",1);ta(a,"a_texcoord");e=Na.get_batch_texture(g);g=g.texture;"IMAGE"!=e.source&&"ENVIRONMENT_MAP"!=e.source&&"CANVAS"!=e.source&&"NONE"!=e.source||ya(a,e,"u_colormap0",g.name)}else X(a,"TEXTURE_COLOR",0);b.blend_mode=c;c=!0}break;case "GRASS_MAP":!b.terrain_settings.is_terrain||b.do_not_render?c=!1:(D(a,b),a.use_backface_culling=b.use_backface_culling,a.blend=!1,a.z_sort=!1,a.depth_mask=!0,ga(a,"grass_map.glslv","grass_map.glslf"),
ta(a,"a_position"),g=b.terrain_settings.dynamic_grass_size?b.terrain_settings.dynamic_grass_size:null,b=b.terrain_settings.dynamic_grass_color?b.terrain_settings.dynamic_grass_color:null,a.vertex_colors_usage.a_grass_size={generate_buffer:!0,src:[]},g?(a.vertex_colors_usage.a_grass_size.src.push({name:g,mask:4}),X(a,"DYNAMIC_GRASS_SIZE",1)):X(a,"DYNAMIC_GRASS_SIZE",0),a.vertex_colors_usage.a_grass_color={generate_buffer:!0,src:[]},b?(a.vertex_colors_usage.a_grass_color.src.push({name:b,mask:7}),X(a,
"DYNAMIC_GRASS_COLOR",1)):X(a,"DYNAMIC_GRASS_COLOR",0),X(a,"GRASS_TEXTURE_SIZE",Ia.glsl_value(Qa.grass_tex_size)),c=!0);break;case "DEBUG_VIEW":c=va(a,b);break;case "PARTICLES":a:if(b.do_not_render)c=!1;else{c=b.texture_slots;if(a.halo_particles)ga(a,"particle_system.glslv","particle_system_stack.glslf"),X(a,"HALO_PARTICLES",1),ea(a,b);else{e={use_shadeless:!1,diffuse_shader:b.diffuse_shader,specular_shader:b.specular_shader,use_tangent_shading:b.use_tangent_shading};if(b.use_nodes){ga(a,"particle_system.glslv",
"particle_system.glslf");P(a,b,g,"PARTICLES");c=!0;break a}else ga(a,"particle_system.glslv","particle_system_stack.glslf"),g=w(b.uuid),g=ma.create_lighting_graph(g,e,a.lights),a.shaders_info.node_elements=ma.compose_node_elements(g);if(g=h("use_map_color_diffuse",!0,c)[0]){X(a,"TEXTURE_COLOR",1);switch(g.blend_type){case "MIX":X(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":X(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.diffuse_color_factor=g.diffuse_color_factor;
a.alpha_factor=g.use_map_alpha?g.alpha_factor:0;c=Na.get_batch_texture(g);ya(a,c,"default"+String(a.textures.length),g.texture.name)}}a.diffuse_color.set(b.diffuse_color);a.diffuse_color[3]=b.alpha;a.ambient=b.ambient;a.diffuse_intensity=b.diffuse_intensity;a.emit=b.emit;a.specular_color.set(b.specular_color);a.specular_alpha=b.specular_alpha;ta(a,"a_position");ta(a,"a_tbn");X(a,"ALPHA","OPAQUE"===b.blend_mode?0:1);X(a,"ALPHA_CLIP","CLIP"===b.blend_mode?1:0);X(a,"PARTICLES_SHADELESS",b.use_shadeless?
1:0);ra(a,b);za(a,b);D(a,b);a.use_backface_culling=b.use_backface_culling;a.xray=b.render_above_all&&"OPAQUE"!=b.blend_mode&&"CLIP"!=b.blend_mode&&"ALPHA_ANTIALIASING"!=b.blend_mode;a.offset_z=b.offset_z;c=!0}break;default:na.panic("Wrong batch type: "+a.type)}return c}function w(a,b,g){var c="";W.check_active()&&(c=W.get_active().uuid);return ma.generate_graph_id(a,b,c,g)}function ea(a,b){var g=b.halo_settings;X(a,"NUM_RINGS",g.ring_count);X(a,"NUM_LINES",g.line_count);X(a,"NUM_STARS",g.star_tip_count);
X(a,"SKY_STARS",g.is_sky_stars?1:0);a.halo_size=g.size;a.halo_hardness=g.hardness/20;a.halo_rings_color.set(g.rings_color);a.halo_lines_color.set(g.lines_color);a.halo_stars_blend=1/g.stars_blend_height;a.halo_stars_height=g.stars_min_height;a.halo=!0}function H(a,b,g){switch(b.texture_coords){case "UV":case "ORCO":X(a,g,"TEXTURE_COORDS_UV_ORCO");X(a,"TEXCOORD",1);break;case "NORMAL":X(a,g,"TEXTURE_COORDS_NORMAL");X(a,"NORMAL_TEXCOORD",1);break;default:X(a,g,"TEXTURE_COORDS_NONE")}}function D(a,b){switch(b.blend_mode){case "ALPHA_ANTIALIASING":a.blend=
!1;a.z_sort=!1;a.depth_mask=!0;a.alpha_clip=!1;a.alpha_antialiasing=!0;break;case "ALPHA_SORT":a.blend=!0;a.z_sort=!0;a.depth_mask=!0;a.alpha_clip=!1;a.alpha_antialiasing=!1;break;case "ALPHA":a.blend=!0;a.z_sort=!1;a.depth_mask=!0;a.alpha_clip=!1;a.alpha_antialiasing=!1;break;case "CLIP":a.blend=!1;a.z_sort=!1;a.depth_mask=!0;a.alpha_clip=!0;a.alpha_antialiasing=!1;break;case "ADD":a.blend=!0;a.z_sort=!1;a.depth_mask=!1;a.alpha_clip=!1;a.alpha_antialiasing=!1;break;case "OPAQUE":a.blend=!1;a.z_sort=
!1;a.depth_mask=!0;a.alpha_clip=!1;a.alpha_antialiasing=!1;break;default:na.panic("Unknown alpha blend mode: "+b.blend_mode)}}function h(a,b,g){for(var c=[],h=g.length,f=0;f<h;f++){var d=g[f];d[a]==b&&d.texture&&d.texture._render&&c.push(d)}return c}function ia(a,b){var g=b.raytrace_mirror;a.reflect_factor=g.reflect_factor;a.fresnel_params[0]=g.fresnel;a.fresnel_params[1]=1-g.fresnel_factor/5}function ra(a,b){var g,c=0;switch(b.specular_shader){case "PHONG":case "COOKTORR":g=b.specular_hardness;break;
case "WARDISO":g=b.specular_slope;break;case "TOON":g=b.specular_toon_size;c=b.specular_toon_smooth;break;case "BLINN":g=b.specular_ior;c=b.specular_hardness;break;default:Da.error("unsupported specular shader: "+b.specular_shader+' (material "'+b.name+'")'),g=b.specular_hardness}a.specular_params[0]=b.specular_intensity;a.specular_params[1]=g;a.specular_params[2]=c}function za(a,b){switch(b.diffuse_shader){case "LAMBERT":a.diffuse_params[0]=0;a.diffuse_params[1]=0;break;case "OREN_NAYAR":a.diffuse_params[0]=
b.roughness;a.diffuse_params[1]=0;break;case "FRESNEL":a.diffuse_params[0]=b.diffuse_fresnel;a.diffuse_params[1]=b.diffuse_fresnel_factor;break;case "MINNAERT":a.diffuse_params[0]=b.darkness;a.diffuse_params[1]=0;break;case "TOON":a.diffuse_params[0]=b.diffuse_toon_size;a.diffuse_params[1]=b.diffuse_toon_smooth;break;default:Da.error("unsupported diffuse shader: "+b.diffuse_shader+' (material "'+b.name+'")'),a.diffuse_params[0]=0,a.diffuse_params[1]=0}}function P(a,b,g,c){if(!b.use_nodes||b.do_not_render)return!1;
var h;switch(c){case "MAIN":ga(a,"main.glslv","main.glslf");h=!1;break;case "GLOW":ga(a,"main.glslv","main.glslf");h=!0;break;case "SHADOW":ga(a,"shadow.glslv","shadow.glslf");h=!1;break;case "COLOR_ID":ga(a,"color_id.glslv","color_id.glslf"),h=!1}var f=b.node_tree,d={vc_name:g.active_vcol_name,uv_name:g.active_uv_name},l=w(b.uuid,c,d);g=ma.compose_ngraph_proxy(f,l,!1,g.name,b.name,c,d,a.lights);if(!g.graph)return Da.error('Failed to create node graph for material "'+b.name+'", disable nodes'),ja(a,
b),!0;a.ngraph_proxy_id=g.id;a.has_nodes=!0;X(a,"NODES",1);X(a,"DOUBLE_SIDED_LIGHTING",b.use_double_sided_lighting?1:0);ta(a,"a_position");b.use_orco_tex_coord&&ta(a,"a_orco_tex_coord");D(a,b);a.use_backface_culling=b.use_backface_culling;a.offset_z=b.offset_z;h?(X(a,"ALPHA",1),X(a,"ALPHA_CLIP",0)):(X(a,"ALPHA","OPAQUE"===b.blend_mode?0:1),X(a,"ALPHA_CLIP","CLIP"===b.blend_mode?1:0));a.xray=b.render_above_all&&"OPAQUE"!=b.blend_mode&&"CLIP"!=b.blend_mode&&"ALPHA_ANTIALIASING"!=b.blend_mode;a.emit=
b.emit;a.ambient=b.ambient;ia(a,b);b.is_wettable?X(a,"WETTABLE",1):X(a,"WETTABLE",0);var k=null,e=!1;Ta.traverse(g.graph,function(g,c){switch(c.type){case "UVMAP":case "TEX_COORD_UV":case "GEOMETRY_UV":case "UV_MERGED":var h=c.data.name,f=c.data.value;a.uv_maps_usage||(a.uv_maps_usage={});a.uv_maps_usage[f]=h;break;case "GEOMETRY_VC":case "GEOMETRY_VC1":case "GEOMETRY_VC2":case "GEOMETRY_VC3":h=c.data.name;a.vertex_colors_usage[h]={generate_buffer:!0,src:[{name:c.data.value}]};f=0;if("GEOMETRY_VC"==
c.type)f=7;else for(var d=0;d<c.outputs.length;d++){var l="RGB".indexOf(c.outputs[d].identifier);-1<l&&(f|=1<<2-l)}a.vertex_colors_usage[h].src[0].mask=f;break;case "TEX_COORD_NO":case "TEX_COORD_RE":case "GEOMETRY_NO":case "FRESNEL":case "LAYER_WEIGHT":ta(a,"a_tbn");break;case "TEX_COORD_OB":X(a,"USE_MODEL_TSR_INVERSE",1);break;case "TEX_COORD_WI":X(a,"USE_POSITION_CLIP",1);break;case "MATERIAL_BEGIN":c.data.value.use_tangent_shading&&(X(a,"USE_TBN_SHADING",1),"PARTICLES"!=a.type&&ta(a,"a_shade_tangs"));
ta(a,"a_tbn");e=!0;break;case "BSDF_BEGIN":e=!0;ta(a,"a_tbn");break;case "TEXTURE_COLOR":case "TEXTURE_ENVIRONMENT_CUBE":case "TEXTURE_ENVIRONMENT_EQUIRECTANGULAR":case "TEXTURE_ENVIRONMENT_MIRROR_BALL":h=c.data.name;f=c.data.bpy_name;d=c.data.value;ya(a,d,h,f);break;case "TEXTURE_NORMAL":case "B4W_PARALLAX":X(a,"CALC_TBN_SPACE",1);ta(a,"a_tbn");c.data&&(h=c.data.name,f=c.data.bpy_name,d=c.data.value,ya(a,d,h,f));break;case "NORMAL_MAP":ta(a,"a_tbn");switch(Number(c.dirs[0][1])){case ma.NM_TANGENT:X(a,
"CALC_TBN_SPACE",1);break;case ma.NM_OBJECT:case ma.NM_BLENDER_OBJECT:X(a,"USE_MODEL_TSR",1)}break;case "LAMP":c.data&&(a.lamp_uuid_indexes=c.data);break;case "B4W_REFRACTION":a.blend?a.refractive=!0:(a.refractive=!1,Da.warn('Material "'+b.name+'" is not blend. Disabling refractions.'));X(a,"USE_POSITION_CLIP",1);break;case "VALTORGB":case "CURVE_VEC":case "CURVE_RGB":k||(k=c.data.texture);break;case "PARTICLE_INFO":"PARTICLES"==a.type&&c.data&&(a.part_node_data=c.data);break;case "VECT_TRANSFORM":switch(Number(c.dirs[1][1])){case ma.VT_WORLD_TO_OBJECT:X(a,
"USE_MODEL_TSR_INVERSE",1);break;case ma.VT_WORLD_TO_CAMERA:X(a,"USE_VIEW_TSR",1);break;case ma.VT_OBJECT_TO_WORLD:X(a,"USE_MODEL_TSR",1);break;case ma.VT_OBJECT_TO_CAMERA:X(a,"USE_MODEL_TSR",1);X(a,"USE_VIEW_TSR",1);break;case ma.VT_CAMERA_TO_WORLD:X(a,"USE_VIEW_TSR_INVERSE",1);break;case ma.VT_CAMERA_TO_OBJECT:X(a,"USE_MODEL_TSR_INVERSE",1),X(a,"USE_VIEW_TSR_INVERSE",1)}break;case "OBJECT_INFO":X(a,"USE_MODEL_TSR",1);a.obj_info_params[1]=b.pass_index;a.obj_info_params[2]=Math.random();break;case "B4W_VECTOR_VIEW":case "GEOMETRY_VW":X(a,
"USE_VIEW_TSR",1);break;case "B4W_REFLECT":X(a,"USE_VIEW_TSR_INVERSE",1);break;case "BUMP":case "DISPLACEMENT_BUMP":ta(a,"a_tbn");Ba.get_standard_derivatives()?X(a,"USE_DERIVATIVES_EXT",1):Da.warn('"OES_standard_derivatives" extension is not available. Disabling the BUMP node in the "'+b.name+'" material.');break;case "BSDF_TRANSPARENT":c.data.value.use_alpha?X(a,"USE_BSDF_TRANSPARENT_ALPHA",1):(a.blend=!0,a.refractive=!0,X(a,"USE_BSDF_TRANSPARENT_REFRACT",1));break;case "BSDF_GLOSSY":case "BSDF_DIFFUSE":X(a,
"USE_BSDF_SKY_DIM",1);Ba.get_texture_lod()&&X(a,"USE_TEXTURE_LOD_EXT",1);break;case "BSDF_PRINCIPLED":X(a,"USE_BSDF_SKY_DIM",1),Ba.get_texture_lod()&&X(a,"USE_TEXTURE_LOD_EXT",1),c.data.value.use_refract&&(a.blend=!0,a.refractive=!0,X(a,"USE_BSDF_PRINCIPLED_REFRACT",1),X(a,"USE_VIEW_TSR",1),X(a,"USE_PROJ_MATRIX_FRAG",1))}});k&&ya(a,k,"u_nodes_texture");e||(a.use_shadeless=!0);h=a.shaders_info.node_elements=ma.compose_node_elements(g.graph);Q(g.graph,a,b.name);g=a.node_value_inds;c=a.node_rgb_inds;
for(f=0;f<h.length;f++)switch(d=h[f],d.id){case "VALUE":if(l=d.param_values[0])for(var m=0;m<g.length;m+=3)if(g[m]==l){d.dirs.push(["VALUE_ROW_IND",g[m+1]]);d.dirs.push(["VALUE_COL_IND",g[m+2]]);break}break;case "RGB":if(l=d.param_values[0])for(m=0;m<c.length;m+=2)if(c[m]==l){d.dirs.push(["RGB_IND",c[m+1]]);break}}X(a,"NUM_VALUES",a.node_values.length/4);X(a,"NUM_RGBS",a.node_rgbs.length);return!0}function t(a,b){var g=b._render.world_light_set;if(""!=g.ngraph_proxy_id){a.has_nodes=!0;a.ngraph_proxy_id=
g.ngraph_proxy_id;var c=ma.get_ngraph_proxy_cached(g.ngraph_proxy_id).graph;if(!c)return Da.error('Failed to create node graph for world "'+b.world.name+'", disable nodes'),ja(a,b.world.name),!0;var h=null;Ta.traverse(c,function(b,g){switch(g.type){case "TEXTURE_COLOR":case "TEXTURE_ENVIRONMENT_EQUIRECTANGULAR":case "TEXTURE_ENVIRONMENT_MIRROR_BALL":ya(a,g.data.value,g.data.name,g.data.bpy_name);break;case "VALTORGB":case "CURVE_VEC":case "CURVE_RGB":h||(h=g.data.texture);break;case "VECT_TRANSFORM":switch(Number(g.dirs[1][1])){case ma.VT_WORLD_TO_OBJECT:X(a,
"USE_MODEL_TSR_INVERSE",1);break;case ma.VT_WORLD_TO_CAMERA:X(a,"USE_VIEW_TSR",1);break;case ma.VT_OBJECT_TO_WORLD:X(a,"USE_MODEL_TSR",1);break;case ma.VT_OBJECT_TO_CAMERA:X(a,"USE_MODEL_TSR",1);X(a,"USE_VIEW_TSR",1);break;case ma.VT_CAMERA_TO_WORLD:X(a,"USE_VIEW_TSR_INVERSE",1);break;case ma.VT_CAMERA_TO_OBJECT:X(a,"USE_MODEL_TSR_INVERSE",1),X(a,"USE_VIEW_TSR_INVERSE",1)}break;case "B4W_VECTOR_VIEW":X(a,"USE_VIEW_TSR",1);break;case "B4W_REFLECT":X(a,"USE_VIEW_TSR_INVERSE",1)}});h&&ya(a,h,"u_nodes_texture");
g=a.shaders_info.node_elements=ma.compose_node_elements(c);Q(c,a,b.world.name);for(var c=a.node_value_inds,f=a.node_rgb_inds,d=0;d<g.length;d++){var l=g[d];switch(l.id){case "VALUE":var k=l.param_values[0];if(k)for(var e=0;e<c.length;e+=3)if(c[e]==k){l.dirs.push(["VALUE_ROW_IND",c[e+1]]);l.dirs.push(["VALUE_COL_IND",c[e+2]]);break}break;case "RGB":if(k=l.param_values[0])for(e=0;e<f.length;e+=2)if(f[e]==k){l.dirs.push(["RGB_IND",f[e+1]]);break}}}X(a,"NUM_VALUES",a.node_values.length/4);X(a,"NUM_RGBS",
a.node_rgbs.length);return!0}return!1}function Q(a,b,g){g=[];var c=[],h=[],f=[];da(a,"",g,c,h,f);b.node_values=g;b.node_value_inds=c;b.node_rgbs=h;b.node_rgb_inds=f}function da(a,b,g,c,h,f){Ta.traverse(a,function(a,d){if("VALUE"==d.type){var l=(b?b+"%join%":"")+d.name;g.push(d.outputs[0].default_value);var k=c.length/3,e=parseInt(k/4),k=parseInt(k%4);c.push(l,e,k)}else"RGB"==d.type&&(l=(b?b+"%join%":"")+d.name,e=d.outputs[0].default_value.slice(0,3),h.push(e[0],e[1],e[2]),f.push(l,f.length/2))});
a=g.length+4-g.length%4;for(var d=g.length;d<a;d++)g.push(0)}function ja(a,b){switch(a.type){case "SHADOW":ga(a,"shadow.glslv","shadow.glslf");break;case "COLOR_ID":ga(a,"color_id.glslv","color_id.glslf");break;default:ga(a,"main.glslv","main_stack.glslf")}X(a,"SHADELESS",1);ta(a,"a_position");ta(a,"a_tbn");J.set(1,0,1,1,a.diffuse_color);b&&(X(a,"ALPHA","OPAQUE"===b.blend_mode?0:1),X(a,"ALPHA_CLIP","CLIP"===b.blend_mode?1:0),X(a,"VERTEX_COLOR",0),a.offset_z=b.offset_z,D(a,b),a.use_backface_culling=
b.use_backface_culling);return!0}function va(a,b){if(b&&(b.is_lens_flares||b.do_not_render))return!1;ga(a,"debug_view.glslv","debug_view.glslf");ta(a,"a_position");ta(a,"a_tbn");ta(a,"a_polyindex");a.depth_mask=!0;E.set(0,0,0,a.wireframe_edge_color);return!0}function Ga(a,b){a.data_id=b.data_id;if("PHYSICS"!==a.type){"DYNAMIC"==b.type||"COLOR_ID"==a.type?(b.is_hair_particles?X(a,"AU_QUALIFIER","GLSL_IN"):X(a,"AU_QUALIFIER","uniform"),X(a,"STATIC_BATCH",0)):(X(a,"AU_QUALIFIER","GLSL_IN"),X(a,"STATIC_BATCH",
1));"DEBUG_VIEW"==a.type&&(Ba.get_standard_derivatives()?X(a,"WIREFRAME_QUALITY",1):X(a,"WIREFRAME_QUALITY",0),a.debug_sphere?(X(a,"DEBUG_SPHERE",1),a.debug_sphere_dynamic?X(a,"DEBUG_SPHERE_DYNAMIC",1):X(a,"DEBUG_SPHERE_DYNAMIC",0)):X(a,"DEBUG_SPHERE",0),X(a,"ALPHA",1));b.use_shape_keys&&"PARTICLES"!=a.type&&!b.is_hair_particles&&(a.use_shape_keys=b.use_shape_keys);b.wind_bending?(""!==b.main_bend_col?(a.vertex_colors_usage.a_bending_col_main={generate_buffer:!0,src:[{name:b.main_bend_col,mask:4}]},
ta(a,"a_bending_col_main"),""!==b.detail_bend_col.leaves_stiffness&&""!==b.detail_bend_col.leaves_phase&&""!==b.detail_bend_col.overall_stiffness?(a.vertex_colors_usage.a_bending_col_detail={generate_buffer:!0,src:[{name:b.detail_bend_col.leaves_stiffness,mask:4},{name:b.detail_bend_col.leaves_phase,mask:2},{name:b.detail_bend_col.overall_stiffness,mask:1}]},ta(a,"a_bending_col_detail"),ta(a,"a_tbn"),X(a,"DETAIL_BEND",1)):X(a,"DETAIL_BEND",0),X(a,"MAIN_BEND_COL",1)):X(a,"MAIN_BEND_COL",0),b.bend_center_only?
X(a,"BEND_CENTER_ONLY",1):X(a,"BEND_CENTER_ONLY",0),X(a,"WIND_BEND",1)):X(a,"WIND_BEND",0);X(a,"BILLBOARD_PRES_GLOB_ORIENTATION",b.billboard_pres_glob_orientation|0);b.billboard?X(a,"BILLBOARD",1):X(a,"BILLBOARD",0);b.billboard&&b.is_hair_particles?X(a,"HAIR_BILLBOARD",1):X(a,"HAIR_BILLBOARD",0);b.billboard_spherical?X(a,"BILLBOARD_SPHERICAL",1):X(a,"BILLBOARD_SPHERICAL",0);switch(b.billboard_type){case "RANDOM":X(a,"BILLBOARD_RANDOM",1);X(a,"BILLBOARD_JITTERED",0);break;case "JITTERED":X(a,"BILLBOARD_RANDOM",
0);X(a,"BILLBOARD_JITTERED",1);break;default:X(a,"BILLBOARD_RANDOM",0),X(a,"BILLBOARD_JITTERED",0)}b.dynamic_grass&&Z.allow_vertex_textures?X(a,"DYNAMIC_GRASS",1):X(a,"DYNAMIC_GRASS",0);a.dynamic_grass=b.dynamic_grass;"PARTICLES"!=a.type&&(a.dynamic_geometry=b.dynamic_geometry);a.shadow_cast=b.shadow_cast;a.shadow_cast_only=b.shadow_cast_only;a.shadow_receive=b.shadow_receive&&!a.use_shadeless&&!(a.blend&&Z.disable_blend_shadows_hack);Z.rgba_fallback_shadows?("MAIN"==a.type&&a.shadow_receive||"SHADOW"==
a.type)&&X(a,"RGBA_SHADOWS",1):X(a,"RGBA_SHADOWS",0);a.reflexible=b.reflexible;a.reflexible_only=b.reflexible_only;a.reflective=b.reflective;a.obj_info_params[0]=b.pass_index;a.lod_dist_max=b.lod_dist_max;a.lod_dist_min=b.lod_dist_min;a.lod_lower_border_range=b.lod_lower_border_range;a.lod_upper_border_range=b.lod_upper_border_range;a.cube_reflection_id=b.cube_reflection_id;a.plane_reflection_id=b.plane_reflection_id;b.is_skinning?(ta(a,"a_influence"),X(a,"SKINNED",1),Z.skinning_hack?(X(a,"DISABLE_TANGENT_SKINNING",
1),X(a,"FRAMES_BLENDING",0)):(X(a,"DISABLE_TANGENT_SKINNING",0),b.frames_blending?X(a,"FRAMES_BLENDING",1):X(a,"FRAMES_BLENDING",0)),X(a,"MAX_BONES",b.max_bones)):(X(a,"SKINNED",0),X(a,"FRAMES_BLENDING",0),X(a,"DISABLE_TANGENT_SKINNING",0));b.vertex_anim?(X(a,"VERTEX_ANIM",1),Z.vert_anim_mix_normals_hack?X(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR",.5):X(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR","u_va_frame_factor")):X(a,"VERTEX_ANIM",0);b.is_skinning&&b.vertex_anim&&na.panic("Skinning and vertex animation are mutually exlusive")}}
function ba(a,b,g){if(b.length){for(var c=Ka.get_shadow_lamps(b,Z.ssao&&g.b4w_enable_ssao),h=a.shaders_info,f=a.lamp_uuid_indexes,d=0,l=0;l<a.shaders_info.node_elements.length;l++){var k=a.shaders_info.node_elements[l];if("LIGHTING_LAMP"==k.id){var e=b[d++%b.length],m=e.light,q=Ka.get_scene_data(e,g);if("SPOT"==m.type||"POINT"==m.type)var D=Math.cos(m.spot_size/2);if("SPOT"==m.type)var w=m.spot_blend*(1-D);q=q.light_index;e=c.indexOf(e);k.dirs=[["LAMP_TYPE",m.type],["LAMP_IND",q],["LAMP_SPOT_SIZE",
Ia.glsl_value(D||.01)],["LAMP_SPOT_BLEND",Ia.glsl_value(w||.01)],["LAMP_LIGHT_DIST",Ia.glsl_value(m.distance)],["LAMP_USE_SPHERE",m.use_sphere?1:0],["LAMP_SHADOW_MAP_IND",e]]}else if("LAMP"==k.id&&f)for(var q=k.dirs[0][1],v=0;v<b.length;v++)if(e=b[v],f[e.uuid]==q){m=e.light;if("SPOT"==m.type||"POINT"==m.type)D=Math.cos(m.spot_size/2);"SPOT"==m.type&&(w=m.spot_blend*(1-D));k.dirs.push(["LAMP_TYPE",m.type],["LAMP_SPOT_SIZE",Ia.glsl_value(D||.01)],["LAMP_SPOT_BLEND",Ia.glsl_value(w||.01)],["LAMP_LIGHT_DIST",
Ia.glsl_value(m.distance)],["LAMP_USE_SPHERE",m.use_sphere?1:0])}}if(f){g=0;for(var p in f)g++;a.lamp_light_positions=new Float32Array(3*g);a.lamp_light_directions=new Float32Array(3*g);a.lamp_light_color_intensities=new Float32Array(3*g);Ia.set_directive(h,"NUM_LAMP_LIGHTS",g);for(l=0;l<b.length;l++)ua(a,b[l])}}}function Ea(a,b){for(var g=0;g<b.length;g++){var c=b[g].settings.b4w_vcol_from_name,h=b[g].settings.b4w_vcol_to_name;""!==c&&""!==h&&(a.vertex_colors_usage[c]={generate_buffer:!1,src:[{name:c,
mask:7}]})}}function ta(a,b){var g=a.common_attributes;-1==g.indexOf(b)&&g.push(b);a.common_attributes=g.sort()}function X(a,b,g){Ia.set_directive(a.shaders_info,b,g)}function pa(a,b,g){if("PHYSICS"==a.type)"NAVMESH"==a.subtype?a.bufs_data=Va.submesh_to_bufs_data(b,Va.DM_DEFAULT,[]):(0<b.shape_keys.length&&Va.submesh_init_shape_keys(b,b.va_frames[0],g),a.submesh=b);else{g=a.draw_mode;a.halo&&"PARTICLES"!=a.type&&(b=Va.extract_halo_submesh(b));a.water_generated_mesh&&(b=La.generate_cascaded_grid(a.water_num_cascads,
a.water_subdivs,a.water_detailed_dist));g=Va.submesh_to_bufs_data(b,g,a.vertex_colors_usage);a.bufs_data=g;a.dynamic_geometry||a.z_sort||a.use_shape_keys||(g.ibo_array=null,g.vbo_source_data.length=0);g=b.va_frames.length;a.num_vertices=b.base_length*g;var c;a:switch(a.draw_mode){case Va.DM_DEFAULT:case Va.DM_TRIANGLES:case Va.DM_DYNAMIC_TRIANGLES:c=!0;break a;default:c=!1}c?Va.is_indexed(b)?a.num_triangles=b.indices.length/3*g:a.num_triangles=b.base_length/3*g:a.num_triangles=0}}function ka(a,b,
g,c,h,f,d,l,k,e,m,D,w){var v=a._object,p=[],r=l.b4w_dynamic_grass;if(!e&&r)return p;for(var z="INSTANCE"==l.b4w_wind_bend_inheritance,H="INSTANCE"==l.b4w_shadow_inheritance,L="INSTANCE"==l.b4w_reflection_inheritance,n=[],Y=[],N=0;N<h.length;N++){var u=h[N]._object.render,S=Ka.clone_render(b);S.billboard=l.b4w_hair_billboard;S.billboard_type=l.b4w_hair_billboard_type;S.billboard_spherical="SPHERICAL"==l.b4w_hair_billboard_geometry;S.dynamic_grass=r;S.is_hair_particles=!0;z?(S.wind_bending=u.wind_bending,
S.wind_bending_angle=u.wind_bending_angle,S.wind_bending_freq=u.wind_bending_freq,S.detail_bending_freq=u.detail_bending_freq,S.main_bend_col=u.main_bend_col,S.detail_bending_amp=u.detail_bending_amp,S.branch_bending_amp=u.branch_bending_amp,S.wind_bending_amp=u.wind_bending_amp,S.detail_bend_col=u.detail_bend_col,S.bend_center_only=!1):(S.wind_bending=v.render.wind_bending,S.wind_bending_angle=v.render.wind_bending_angle,S.wind_bending_freq=v.render.wind_bending_freq,S.detail_bending_freq=v.render.detail_bending_freq,
S.main_bend_col=v.render.main_bend_col,S.detail_bending_amp=v.render.detail_bending_amp,S.branch_bending_amp=v.render.branch_bending_amp,S.wind_bending_amp=v.render.wind_bending_amp,S.detail_bend_col=v.render.detail_bend_col,S.bend_center_only=!0);H?(S.shadow_cast=u.shadow_cast,S.shadow_cast_only=u.shadow_cast_only,S.shadow_receive=u.shadow_receive):(S.shadow_cast=v.render.shadow_cast,S.shadow_cast_only=v.render.shadow_cast_only,S.shadow_receive=v.render.shadow_receive);L?(S.reflexible=u.reflexible,
S.reflexible_only=u.reflexible_only,S.reflective=u.reflective,S.cube_reflection_id=u.cube_reflection_id,S.plane_reflection_id=u.plane_reflection_id,S.reflection_type=u.reflection_type):(S.reflexible=v.render.reflexible,S.reflexible_only=v.render.reflexible_only,S.reflective=v.render.reflective,S.cube_reflection_id=v.render.cube_reflection_id,S.plane_reflection_id=v.render.plane_reflection_id,S.reflection_type=v.render.reflection_type);n.push(S);var ea=d[N];ea||(ea=new Float32Array);D&&G._13(k.seed,
m);var A=new Float32Array(3),K=new Float32Array([0,0,0,1]),ha=[],ma=-1!=G._70(Z.loaded_data_version,yb)&&!l.b4w_initial_rand_rotation&&!l.b4w_hair_billboard,O=4;ma&&(O=8);for(var Ya=0;Ya<ea.length;Ya+=O){A[0]=ea[Ya];A[1]=ea[Ya+1];A[2]=ea[Ya+2];var P=ea[Ya+3]*fa.i(u.world_tsr);if(l.b4w_initial_rand_rotation){switch(l.b4w_rotation_type){case "XYZ":var I=new Float32Array([G._40(m),G._40(m),G._40(m)]);E.normalize(I,I);break;case "Z":I=new Float32Array([0,0,1]);break;default:na.panic("Unsupported random rotation type: "+
l.b4w_rotation_type)}B.setAxisAngle(I,l.b4w_rand_rotation_strength*(2*Math.PI*G._40(m)-Math.PI),K)}else if(ma&&(K.set(ea.subarray(Ya+4,Ya+8)),G._29(K,K),!l.use_whole_group))if(l.use_rotation_dupli){var mb=fa.g(u.world_tsr,Mb);B.multiply(K,mb,K)}else B.multiply(K,rb,K);var T=fa.t(A,P,K,fa.b());ha.push(T)}Y.push(ha)}for(var ia={},Fb=0,N=0;N<h.length;N++)for(var za=h[N]._object.materials,Ya=0;Ya<za.length;Ya++)za[Ya].name in ia?ia[za[Ya].name]++:(ia[za[Ya].name]=1,Fb++);for(var Fb=Fb?Fb:1,ob={},N=0;N<
h.length;N++){var la=h[N],J=f[N],S=n[N],F={};S.wind_bending&&(F.au_wind_bending_amp=[S.wind_bending_amp],F.au_wind_bending_freq=[S.wind_bending_freq],F.au_detail_bending_freq=[S.detail_bending_freq],F.au_detail_bending_amp=[S.detail_bending_amp],F.au_branch_bending_amp=[S.branch_bending_amp],S.wind_bending_amp=0,S.wind_bending_freq=0,S.detail_bending_freq=0,S.detail_bending_amp=0,S.branch_bending_amp=0);ha=Y[N];if(ha.length){for(var ra=la.data,za=la._object.materials,da=Array(za.length),y=Array(za.length),
Ya=0;Ya<za.length;Ya++)if(!qa(v,Ya)&&!Va.has_empty_submesh(ra,Ya))for(var Ea=0;Ea<J.length;Ea++){var Oa=J[Ea],M=U(Oa),gb=za[Ya];"MAIN"==Oa?da[Ya]=M:"DEBUG_VIEW"==Oa&&(y[Ya]=M);M.cluster_id=a.b4w_cluster_data.cluster_id;if(Ca(M,gb)&&(M.lights=G.O(w),q(M,gb,ra))){"SHADOW"==Oa&&da[Ya]&&(M.use_shadeless=da[Ya].use_shadeless);M.draw_mode=Va.DM_DEFAULT;Ga(M,S);M.odd_id_prop=wa(M,S,l.uuid);M.do_not_cull=a.b4w_do_not_cull||l.b4w_dynamic_grass;"MAIN"==M.type&&(M.caustics=a.b4w_caustics);X(M,"DISABLE_FOG",
("COLOR_ID"!=Oa&&"SHADOW"!=Oa&&a.b4w_disable_fogging)|0);"JITTERED"==l.b4w_hair_billboard_type&&(M.jitter_amp=l.b4w_hair_billboard_jitter_amp,M.jitter_freq=l.b4w_hair_billboard_jitter_freq);r&&(M.grass_scale_threshold=l.b4w_dynamic_grass_scale_threshold);z||(delete M.vertex_colors_usage.a_bending_col_main,delete M.vertex_colors_usage.a_bending_col_detail);var ka=Va.extract_submesh(ra,Ya,M.common_attributes,b.bone_skinning_info,M.vertex_colors_usage,M.uv_maps_usage),ba=v.render.world_tsr,Ja=!0;if(1<
ia[gb.name]){var ja=0,t;for(t in ka.va_frames)ja++;Ja=ka.indices.length*ha.length*ja*ia[gb.name]>2E5*Fb}var Qa=Z.allow_instanced_arrays_ext&&Ja&&"PHYSICS"!=M.type;if(Qa){M.inst_array_state=l.use_whole_group?2:1;var Sa=Va.clone_submesh(ka);Va.calc_unit_boundings(ka,Sa,ha);Sa.instanced_array_data={tsr_array:ha,stat_part_em_tsr:ba,static_hair:"STATIC"==b.type,submesh_params:F,part_inh_attrs:{},dyn_grass:r};if(S.wind_bending&&S.bend_center_only){var ta=E.fromValues(0,0,0);fa.D(ta,v.render.world_tsr,ta);
for(var sb=[],oa=0;oa<ha.length;oa++)sb.push(ta[0],ta[1],ta[2]);Sa.instanced_array_data.part_inh_attrs.a_emitter_center={num_comp:3,data:sb}}Va.calc_unit_boundings(ka,ka,ha);"STATIC"==b.type&&Va.bounding_data_apply_transform(Sa.submesh_bd,ba)}else{var sa=Sa=Va.make_propagated_submesh(ka,F,ha),Q=ha;sa.va_common.au_center_pos=new Float32Array(3*sa.base_length);for(var W=Q.length,Aa=sa.base_length/W,pa=0;pa<W;pa++)for(var xa=Q[pa],La=3*Aa*pa,$a=0;$a<Aa;$a++)sa.va_common.au_center_pos[La+3*$a]=xa[0],
sa.va_common.au_center_pos[La+3*$a+1]=xa[1],sa.va_common.au_center_pos[La+3*$a+2]=xa[2];Sa=sa;if(S.wind_bending&&S.bend_center_only){var fb=Sa,ga=v.render.world_tsr;fb.va_common.a_emitter_center=new Float32Array(3*fb.base_length);var va=E.fromValues(0,0,0);fa.D(va,ga,va);for(var ib=0;ib<fb.base_length;ib++)fb.va_common.a_emitter_center[3*ib]=va[0],fb.va_common.a_emitter_center[3*ib+1]=va[1],fb.va_common.a_emitter_center[3*ib+2]=va[2];Sa=fb}}var Pa=l.b4w_vcol_from_name,Xa=l.b4w_vcol_to_name,ua=M,Db=
g,Ta=!z,Ba=ra,ya=[];if(""!==Pa&&""!==Xa){var R,Ra=void 0,Wa=Xa,zc=ua.vertex_colors_usage,V=[];for(Ra in zc)for(var Ma=zc[Ra].src,Ia=0,Ua=0;Ua<Ma.length;Ua++){var Ac=Ma[Ua].mask;Wa==Ma[Ua].name&&V.push(Ra,Ac,Ia);Ia+=G._43(Ac)}R=V;if(0<R.length)for(var Na=0;Na<R.length;Na+=3)ya.push({emitter_attr:Pa,emitter_mask:7,particle_attr:R[Na],particle_mask:R[Na+1],dst_channel_offset:R[Na+2]});else Va.has_attr(ua.common_attributes,"a_color")&&Xa==Ba.active_vcol_name&&ya.push({emitter_attr:Pa,emitter_mask:7,particle_attr:"a_color",
particle_mask:7,dst_channel_offset:0})}Ta&&("a_bending_col_main"in Db&&ya.push({emitter_attr:"a_bending_col_main",emitter_mask:4,particle_attr:"a_bending_col_main",particle_mask:4,dst_channel_offset:0}),"a_bending_col_detail"in Db&&ya.push({emitter_attr:"a_bending_col_detail",emitter_mask:7,particle_attr:"a_bending_col_detail",particle_mask:7,dst_channel_offset:0}));for(var gc=Sa,Vb=ha,qb=c,wb=ya,Za=M.vertex_colors_usage,Eb=Qa,Bb=!1,Yb=0;Yb<wb.length;Yb++){var bc=wb[Yb].emitter_attr,Pb=qb.va_common[bc];
if(Pb&&0<Pb.length){Bb=!0;break}}if(Eb)var Rc=gc.instanced_array_data.part_inh_attrs;if(Bb){var ic,Lb=v.render.bb_local,hb=qb.va_frames[0].a_position,hd=Vb,lb=ob,Cc=new Float32Array(3),oc=new Float32Array(3),Kd=new Uint32Array(hd.length);if(!("verts_indices"in lb)){lb.cell_size=new Float32Array(3);lb.base_point=new Float32Array(3);lb.verts_indices=new Uint32Array(hb.length/3);lb.octs_indices=new Uint32Array(hb.length/3);lb.cell_size[0]=(Lb.max_x-Lb.min_x)/20;lb.cell_size[1]=(Lb.max_y-Lb.min_y)/20;
lb.cell_size[2]=(Lb.max_z-Lb.min_z)/20;lb.base_point[0]=Lb.min_x;lb.base_point[1]=Lb.min_y;lb.base_point[2]=Lb.min_z;for(var Ab=0;Ab<hb.length/3;Ab++){var ud=hb[3*Ab+1],Ld=hb[3*Ab+2],vd=G._64((hb[3*Ab]-lb.base_point[0])/lb.cell_size[0]),Gd=G._64((ud-lb.base_point[1])/lb.cell_size[1]),pc=G._64((Ld-lb.base_point[2])/lb.cell_size[2]),vd=G.M(vd,0,19),Gd=G.M(Gd,0,19),pc=G.M(pc,0,19);lb.verts_indices[Ab]=Ab;lb.octs_indices[Ab]=pc*Math.pow(20,2)+20*Gd+vd}Va.sort_two_arrays(lb.octs_indices,lb.verts_indices,
Va.SORT_NUMERIC,!0);lb.verts_offsets=new Uint32Array(Math.pow(20,3));for(Ab=0;Ab<lb.octs_indices.length;Ab++)lb.verts_offsets[lb.octs_indices[Ab]]++;delete lb.octs_indices;for(Ab=1;Ab<lb.verts_offsets.length;Ab++)lb.verts_offsets[Ab]+=lb.verts_offsets[Ab-1]}for(var $c=0;$c<hd.length;$c++){Cc[0]=hd[$c][0];Cc[1]=hd[$c][1];Cc[2]=hd[$c][2];for(var wd=1E10,xd=-1,Hb=G._64((Cc[0]-lb.base_point[0])/lb.cell_size[0]),Mc=G._64((Cc[1]-lb.base_point[1])/lb.cell_size[1]),ec=G._64((Cc[2]-lb.base_point[2])/lb.cell_size[2]),
Hb=G.M(Hb,0,19),Mc=G.M(Mc,0,19),ec=G.M(ec,0,19),ed=ec*Math.pow(20,2)+20*Mc+Hb,yd=lb.verts_offsets[ed],Qb=0==ed?0:lb.verts_offsets[ed-1];Qb<yd;Qb++){var zd=lb.verts_indices[Qb];oc[0]=hb[3*zd];oc[1]=hb[3*zd+1];oc[2]=hb[3*zd+2];E.sub(oc,Cc,oc);var id=E.sqrLen(oc);id<=wd&&(wd=id,xd=zd)}if(-1==xd)for(Qb=0;Qb<hb.length/3;Qb++)oc[0]=hb[3*Qb],oc[1]=hb[3*Qb+1],oc[2]=hb[3*Qb+2],E.sub(oc,Cc,oc),id=E.sqrLen(oc),id<=wd&&(wd=id,xd=Qb);Kd[$c]=xd}ic=Kd;for(var ad=gc.base_length/Vb.length,Yb=0;Yb<wb.length;Yb++){var Nc=
wb[Yb].particle_attr,xc=wb[Yb].particle_mask,bc=wb[Yb].emitter_attr,Md=wb[Yb].emitter_mask,Pb=qb.va_common[bc];switch(Nc){case "a_bending_col_main":var Sc=1;break;case "a_bending_col_detail":Sc=3;break;case "a_color":Sc=3;break;default:for(var Gc=Sc=0;Gc<Za[Nc].src.length;Gc++)Sc+=G._43(Za[Nc].src[Gc].mask)}if(Pb&&0<Pb.length){var ie=G._43(Md),je=G._43(xc),Nd=Md&xc,jd=G._44(Nd);Nd!=xc&&Da.error("Wrong color extraction from "+bc+" to "+Nc+".");if(Eb)for(Rc[Nc]={num_comp:Sc,data:[]},Gc=0;Gc<Vb.length;Gc++)for(Od=
ic[Gc],kd=Od*ie,Hc=0;Hc<jd.length;Hc++)jd[Hc]&&(ld=G._42(Md,Hc),Rc[Nc].data.push(Pb[kd+ld]));else{if("a_bending_col_main"==Nc||"a_bending_col_detail"==Nc)gc.va_common[Nc]=new Float32Array(gc.base_length*je);for(Gc=0;Gc<Vb.length;Gc++){var Od=ic[Gc],kd=Od*ie,Ad=Gc*ad*Sc;if(-1!=Od)for(var Tc=0;Tc<ad;Tc++)for(var md=Tc*Sc,Hc=0;Hc<jd.length;Hc++)if(jd[Hc]){var ld=G._42(Md,Hc),Pd=wb[Yb].dst_channel_offset+G._42(xc,Hc);gc.va_common[Nc][Ad+md+Pd]=Pb[kd+ld]}}}}else gc.va_common[Nc]=new Float32Array(0)}}Sa=
gc;X(M,"USE_INSTANCED_PARTCLS",Sa.instanced_array_data?1:0);C(M);p.push({batch:M,obj_render:b,batch_render:S,submesh:Sa,mat_names:[gb.name],rel_bpy_objects:[a]})}}for(Ya=0;Ya<y.length;Ya++)y[Ya]&&(y[Ya].debug_main_batch_id=da[Ya].id,C(y[Ya]))}}return p}function Ca(a,b){var g=!0;"NODES_GLOW"==a.type&&(g=ma.check_material_glow_output(b));return g}function C(a){Aa(a,function(a){a.id=0;a.id=g.calc_variable_id(a,0)})}function Aa(a,b){for(var g=null,c=null,h=[],f=0;f<a.textures.length;f++){var d=a.textures[f],
l=d.canvas_context;l&&(g||(g={}),g[f]=l,d.canvas_context=null);if(l=d.video_file)c||(c={}),c[f]=l,d.video_file=null;h.push(d.num_users);d.num_users=0}d=a.bounds_local;a.bounds_local=null;l=a.vaos;a.vaos=null;var k=a.bufs_data;a.bufs_data=null;var e=a.submesh;a.submesh=null;b(a);a.bufs_data=k;a.submesh=e;a.vaos=l;a.bounds_local=d;if(g)for(f in g)a.textures[f].canvas_context=g[f];if(c)for(f in c)a.textures[f].video_file=c[f];for(f=0;f<a.textures.length;f++)a.textures[f].num_users=h[f]}function xa(a,
b,g,c){var h=U("DEBUG_VIEW");ga(h,"debug_view.glslv","debug_view.glslf");h.debug_sphere=!0;h.depth_mask=!0;h.odd_id_prop=wa(h,a,b);h.debug_sphere_dynamic=g;Ga(h,a);C(h);if(c.use_be){a=c.bounds_local.be;var f=E.create();b=La.generate_uv_sphere(16,8,1,f,!1,!1);g=E.fromValues(E.length(a.axis_x),E.length(a.axis_y),E.length(a.axis_z));Va.scale_submesh_xyz(b,g,f);var f=E.normalize(a.axis_x,ob),d=E.normalize(a.axis_y,gb),l=E.normalize(a.axis_z,Ya);!g[0]&&g[1]&&g[2]?E.cross(d,l,f):!g[1]&&g[0]&&g[2]?E.cross(l,
f,d):!g[2]&&g[0]&&g[1]&&E.cross(f,d,l);g=G.W(f,d,l,mb);A.invert(g,g);g=B.fromMat3(g,sb);fa.r(g,Fb);fa.s(1,Fb);fa.v(a.center,Fb);Va.submesh_apply_transform(b,Fb)}else a=c.bounds_local.bs,b=La.generate_uv_sphere(16,8,a.radius,a.center,!1,!1);V.t(c.bounds_local,h.bounds_local);Va.submesh_drop_indices(b,1,!0);b.va_common.a_polyindex=Va.extract_polyindices(b);pa(h,b);return h}function ga(a,b,g){a.shaders_info.vert=b;a.shaders_info.frag=g;Ia.set_default_directives(a.shaders_info)}function ya(a,b,g,c){c=
c||"";-1==a.texture_names.indexOf(g)&&(a.textures.push(b),a.texture_names.push(g),a.bpy_tex_names.push(c));a.shader&&Xa.assign_texture_uniforms(a)}function O(a){a.shaders_info||na.panic("No shaders info for batch "+a.name);a.shader=Ia.get_compiled_shader(a.shaders_info);var b=a.shaders_info;if(b.status===Ia.VALID){var g=a.shader.attributes,c=a.bufs_data.pointers,h;for(h in g)c[h]||na.panic('missing data for "'+h+'" attribute')}b.status&Ia.INVALID_TEX_IMAGE_UNITS&&Da.error("Texture limit exceeded for shader - "+
b.frag+', materials: "'+a.material_names.join(", ")+'". Maximum texture count: '+Oa.max_texture_image_units+", actual texture count: "+b.texture_count);b.status&Ia.INVALID_F_UNIFORM_VECTORS&&Da.error("Fragment uniform limit exceeded for shader - "+b.frag+', materials: "'+a.material_names.join(", ")+'". ');b.status&Ia.INVALID_V_UNIFORM_VECTORS&&Da.error("Vertex uniform limit exceeded for shader - "+b.vert+', materials: "'+a.material_names.join(", ")+'". ');b.status&Ia.INVALID_VERTEX_ATTRIBS&&Da.error("Vertex attribute limit exceeded for shader - "+
b.vert+', materials: "'+a.material_names.join(", ")+'". Maximum attribute count: '+Oa.max_vertex_attribs+", actual attribute count: "+b.attribute_count);b.status&Ia.INVALID_VARYING_VECTORS&&("MAIN"!=a.type||a.has_nodes||Da.error("Varying limit exceeded for shader - "+a.shaders_info.frag+', materials: "'+a.material_names.join(", ")+'"'),"MAIN"==a.type&&a.has_nodes||"NODES_GLOW"==a.type)&&(c=g=0,a.uv_maps_usage&&(g=G._8(a.uv_maps_usage)),a.vertex_colors_usage&&(c=G._8(a.vertex_colors_usage)),Da.error("Varying limit exceeded for node shader - "+
a.shaders_info.frag+", uv: "+g+", vc: "+c+', materials: "'+a.material_names.join(", ")+'"'));b.status&Ia.COMPILATION_ERROR&&Da.error("Shader compilation/linking error: "+b.vert+", "+b.frag+', materials: "'+a.material_names.join(", ")+'"');return a.shaders_info.status===Ia.VALID?(Xa.assign_uniform_setters(a.shader),Xa.assign_attribute_setters(a),Xa.assign_texture_uniforms(a),!0):!1}function wa(a,b,c){return"NAVMESH"==a.subtype?c:b.dynamic_geometry?"_odd_id_"+g.unique_id():c}function qa(a,b){return 0<=
b&&b<a.mat_inheritance_data.is_disabled.length&&a.mat_inheritance_data.is_disabled[b]}var na=Object(R.a)(e),Ja=Object(n.a)(e),g=Object(y.a)(e),Da=Object(d.a)(e),Ba=Object(k.a)(e),Ta=Object(I.a)(e),ma=Object(r.a)(e),Ka=Object(p.a)(e),fb=Object(u.a)(e),La=Object(a.a)(e),Xa=Object(l.a)(e),Wa=Object(c.a)(e),W=Object(m.a)(e),Ia=Object(b.a)(e),Ua=Object(f.a)(e),Na=Object(T.a)(e),Va=Object(z.a)(e),Z=Ja.defaults,Oa=Ja.context_limits,Qa=Ja.scenes,$a=Ja.hmd_params,rb=new Float32Array([0,0,-Math.sqrt(.5),Math.sqrt(.5)]),
ob=new Float32Array(3),gb=new Float32Array(3),Ya=new Float32Array(3),sb=new Float32Array(4),Mb=B.create(),Fb=fa.b(),mb=A.create(),Sa={},ib=new Float32Array(24),yb=[5,4];F.batch_get_debug_storage=function(a){return Sa[a]||null};F.batch_set_debug_storage=function(a,b){Sa[a]=b};F.clone_batch=K;F.generate_main_batches=function(a,b,c,h){for(var f=(c||[]).map(function(a){return a.light}),f=Y(b,a._render.graph,f),f=S(f),d=0;d<f.length;d++){var l=f[d].batch;l.material_names=f[d].mat_names;pa(l,f[d].submesh);
ba(l,c,a);if("STATIC"==f[d].render.type&&"COLOR_ID"!=l.type){var k=g.unique_name("%meta%"+l.type+"%"+l.material_names.join("%")+"%"),e=Ka.create_object(k,"MESH");Ka.meta_obj_append_render(e,f[d].render);Ka.append_scene_data(e,a);Ka.append_batch(e,a,l);h.push(e);if("MAIN"==l.type)for(var m=0;m<f[d].rel_bpy_objects.length;m++)k=f[d].rel_bpy_objects[m]._object,k.meta_objects.push(e)}else k=f[d].rel_bpy_objects[0]._object,Ka.append_batch(k,a,l)}if(Z.debug_view){for(d=0;d<f.length;d++)if(c=f[d].render,
"DYNAMIC"==c.type&&(k=f[d].rel_bpy_objects[0]._object,l=f[d].batch,"MAIN"==l.type)){for(var m=Ka.get_scene_data(k,a),e=m.batches,q=!1,m=0;m<e.length;m++)e[m].debug_sphere&&(q=!0);q||(l=xa(c,k.name,!0,l),Ka.append_batch(k,a,l))}for(d=0;d<h.length;d++)k=h[d],c=k.render,m=Ka.get_scene_data(k,a),l=m.batches[0],"MAIN"==l.type&&(l=xa(c,k.name,!1,l),Ka.append_batch(k,a,l));for(d=0;d<f.length;d++)l=f[d].batch,"DEBUG_VIEW"==l.type&&(l.debug_id_color=d)}for(d=0;d<b.length;d++)for(m=Ka.get_scene_data(b[d]._object,
a),e=m.batches,m=0;m<e.length;m++)v(e[m]);for(d=0;d<h.length;d++)for(m=Ka.get_scene_data(h[d],a),e=m.batches,m=0;m<e.length;m++)v(e[m])};F.append_sky_batch_to_world=function(a,b,g){var c=a._render.world_light_set,h=U("MAIN");ga(h,"sky.glslv","sky.glslf");h.is_sky=!0;h.depth_mask=!1;if(b.procedural_skydome)X(h,"PROCEDURAL_SKYDOME",1),h.draw_proc_sky=!0;else{var f=c.sky_texture_param,d=Wa.find_subs(a._render.graph,Ua.SKY).camera.color_attachment;ya(h,d,"u_sky");f&&(X(h,"WO_SKYTEX",1),f.invert&&X(h,
"MTEX_NEGATIVE",1),f.use_rgb_to_intensity&&X(h,"MTEX_RGBTOINT",1),X(h,"BLENDTYPE",f.blend_type),f.use_map_blend&&X(h,"WOMAP_BLEND",1),f.use_map_horizon&&X(h,"WOMAP_HORIZ",1),f.use_map_zenith_up&&X(h,"WOMAP_ZENUP",1),f.use_map_zenith_down&&X(h,"WOMAP_ZENDOWN",1));c.use_sky_blend&&X(h,"WO_SKYBLEND",1);c.use_sky_paper&&X(h,"WO_SKYPAPER",1);c.use_sky_real&&X(h,"WO_SKYREAL",1)}b.reflexible&&(h.reflexible=!0,b.reflexible_only&&(h.reflexible_only=!0));ta(h,"a_position");b=La.generate_fullscreen_quad();pa(h,
b);v(h);h.do_not_cull=!0;C(h);Ka.append_batch(g,a,h);Wa.find_subs(a._render.graph,Ua.DEBUG_VIEW)&&(c=K(h),c.type="DEBUG_VIEW",c.subtype="",va(c),X(c,"DEBUG_VIEW_SPECIAL_SKYDOME",1),b.va_common.a_polyindex=Va.extract_polyindices(b),pa(c,b),c.debug_main_batch_id=h.id,C(c),Ka.append_batch(g,a,c))};F.create_forked_batches=function(a,b,g){var c=Ka.get_scene_data(a,g).batches,h=[],f=Wa.find_subs(b,Ua.MAIN_PLANE_REFLECT),d=Wa.find_subs(b,Ua.MAIN_CUBE_REFLECT),l=Wa.find_subs(b,Ua.OUTLINE_MASK);b=Wa.find_subs(b,
Ua.COLOR_PICKING);for(var k=0;k<c.length;k++){var e=c[k],m=null;"SHADOW"==e.type&&"RECEIVE"==e.subtype&&e.shadow_cast&&(m=K(e),m.subtype="CAST");"MAIN"!=e.type&&"PARTICLES"!=e.type||!f&&!d||!e.reflexible||(m=K(e),m.subtype="REFLECT",m.refractive=!1,m.z_sort&&(m.z_sort=!1,m.depth_mask=!1),m.particles_data=e.particles_data);"COLOR_ID"==e.type&&l&&a.render.outlining&&(b&&a.render.selectable?(m=K(e),m.subtype="OUTLINE"):e.subtype="OUTLINE");m&&(m.forked_batch=!0,C(m),h.push(m))}for(c=0;c<h.length;c++)Ka.append_batch(a,
g,h[c])};F.wb_angle_to_amp=function(a,b,g){b=g*(b.max_z-b.min_z);return 0==b?0:.5*(Math.sqrt(2*Math.sqrt(4*b*Math.tan(a)+1)+2)/2-1)/b};F.wb_amp_to_angle=function(a,b,g){b=g*(b.max_z-b.min_z);if(0==b)return 0;a*=2*b;return Math.atan((Math.pow(a+1,4)-Math.pow(a+1,2))/b)};F.bb_bpy_to_b4w=function(a){var b=V.w();b.max_x=a.max_x;b.min_x=a.min_x;b.max_y=a.max_y;b.min_y=a.min_y;b.max_z=a.max_z;b.min_z=a.min_z;return b};F.name_list_to_node_name=function(a,b){for(var g=a[b],c=b+1;c<a.length;c++)g=(g?g+"%join%":
"")+a[c];return g};F.update_batch_material_error=ja;F.update_batch_lights=ba;var ua=function(){var a=E.create();return function(b,g){if(g.uuid in b.lamp_uuid_indexes){var c=b.lamp_uuid_indexes[g.uuid],h=fa.j(g.render.world_tsr,a);b.lamp_light_positions.set(h,3*c);b.lamp_light_directions.set(g.light.direction,3*c);b.lamp_light_color_intensities.set(g.light.color_intensity,3*c)}}}();F.set_lamp_data=ua;F.assign_shadow_receive_dirs=function(a,b,g){X(a,"CSM_SECTION1",0);X(a,"CSM_SECTION2",0);X(a,"CSM_SECTION3",
0);X(a,"NUM_CAST_LAMPS",0);if(b){X(a,"NUM_CAST_LAMPS",b.lamp_types.length);Z.mac_os_shadow_hack&&X(a,"MAC_OS_SHADOW_HACK",1);for(g=1;g<b.csm_num;g++)X(a,"CSM_SECTION"+String(g),1);X(a,"SHADOW_TEX_RES",Ia.glsl_value(b.csm_resolution));X(a,"CSM_FADE_LAST_CASCADE",b.fade_last_cascade?1:0);X(a,"CSM_BLEND_BETWEEN_CASCADES",b.blend_between_cascades&&!Z.chrome_csm_blend_hack?1:0)}else X(a,"SHADOW_TEX_RES",0),X(a,"CSM_FADE_LAST_CASCADE",0),X(a,"CSM_BLEND_BETWEEN_CASCADES",0)};F.set_batch_directive=X;F.get_batch_directive=
function(a,b){return Ia.get_directive(a.shaders_info,b)};F.update_batch_geometry=pa;var Ra=function(){var a=E.create();return function(b,g,c,h){for(var f={},d=new Float32Array([0,0,0,1]),l=0;l<b.length;l+=h)for(var k=0;k<g.length;k++){var e=E.create(),m=fa.i(g[k].render.world_tsr),q=fa.j(g[k].render.world_tsr,a);E.scale(q,m,e);m=E.clone([b[l],b[l+1],b[l+2]]);f[k]||(f[k]=new Float32Array(b.length));c&&(f[k][l+4]=d[0]=b[l+4],f[k][l+5]=d[1]=b[l+5],f[k][l+6]=d[2]=b[l+6],f[k][l+7]=d[3]=b[l+7],G._29(d,
d),G._62(e,d,e));E.add(m,e,m);f[k][l]=m[0];f[k][l+1]=m[1];f[k][l+2]=m[2];f[k][l+3]=b[l+3]}return f}}();F.update_batch_id=C;F.update_local_bounds_from_pos=function(a,b){a.bounds_local.bb=V.a(b,0,b.length,a.bounds_local.bb);var g=V.F(a.bounds_local.bb,ib);a.bounds_local.be=V.z(g,!0);a.bounds_local.bs=V.B(a.bounds_local.be);a.use_be=V.M(a.bounds_local.be,a.bounds_local.bs)};F.apply_shader=ga;F.append_texture=ya;F.replace_texture=function(a,b,g){g=a.texture_names.indexOf(g);-1<g&&(a.textures[g]=b)};F.create_shadeless_batch=
function(a,b,g){var c=U("MAIN");1>g&&(c.blend=!0);J.set(b[0],b[1],b[2],g,c.diffuse_color);c.draw_mode=Va.DM_TRIANGLES;pa(c,a);ga(c,"main.glslv","main_stack.glslf");X(c,"SHADELESS",1);O(c);return c};F.update_shader=O;F.generate_line_batches=function(a,b){for(var g=0;g<b.length;g++){var c=b[g],h=U("LINE");ga(h,"line.glslv","line.glslf");h.blend=!0;h.do_not_cull=!0;var f=La.generate_line();pa(h,f);v(h);Ka.append_scene_data(c,a);Ka.append_batch(c,a,h);O(h)}};F.check_batch_perm_uniform=function(a,b){return a.shader.permanent_uniform_setters.length?
a.shader.permanent_uniform_setters_table[b]?!0:!1:!1};F.create_depth_pack_batch=function(a){a=U("DEPTH_PACK");a.use_backface_culling=!0;a.depth_mask=!1;var b=La.generate_fullscreen_tri();pa(a,b);ga(a,"postprocessing/postprocessing.glslv","postprocessing/depth_pack.glslf");O(a);return a};F.create_postprocessing_batch=function(a){var b=U("POSTPROCESSING");ga(b,"postprocessing/postprocessing.glslv","postprocessing/postprocessing.glslf");switch(a){case "NONE":X(b,"POST_EFFECT","POST_EFFECT_NONE");break;
case "GRAYSCALE":X(b,"POST_EFFECT","POST_EFFECT_GRAYSCALE");break;case "X_BLUR":case "Y_BLUR":X(b,"POST_EFFECT","POST_EFFECT_BLUR");break;case "X_GLOW_BLUR":case "Y_GLOW_BLUR":case "X_BLOOM_BLUR":case "Y_BLOOM_BLUR":X(b,"POST_EFFECT","POST_EFFECT_GLOW_BLUR");break;case "X_DOF_BLUR":case "Y_DOF_BLUR":X(b,"POST_EFFECT","POST_EFFECT_DOF_BLUR");break;case "X_ALPHA_BLUR":case "Y_ALPHA_BLUR":X(b,"POST_EFFECT","POST_EFFECT_ALPHA_BLUR");break;case "X_EXTEND":case "Y_EXTEND":X(b,"POST_EFFECT","POST_EFFECT_EXTEND");
break;case "FLIP_CUBEMAP_COORDS":X(b,"POST_EFFECT","FLIP_CUBEMAP_COORDS");break;default:na.panic("Wrong postprocessing effect: "+a)}X(b,"SHADOW_USAGE","NO_SHADOWS");b.use_backface_culling=!0;b.depth_mask=!1;a=La.generate_fullscreen_tri();pa(b,a);O(b);return b};F.create_ssao_batch=function(a){var b=U("SSAO");b.depth_mask=!1;b.use_backface_culling=!0;var g=La.generate_fullscreen_tri();pa(b,g);ga(b,"postprocessing/postprocessing.glslv","postprocessing/ssao.glslf");X(b,"SSAO_QUALITY","SSAO_QUALITY_"+
a.ssao_samples);X(b,"SSAO_HEMISPHERE",a.ssao_hemisphere?1:0);X(b,"SHADOW_USAGE","NO_SHADOWS");a={width:4,height:4,data:new Uint8Array([150,123,254,0,127,3,97,0,164,246,99,0,155,177,14,0,54,83,221,0,2,142,143,0,32,57,79,0,49,160,32,0,57,232,115,0,178,216,203,0,70,196,218,0,241,164,82,0,225,58,85,0,233,88,189,0,144,25,203,0,117,73,12,0])};g=Na.create_texture(Na.TT_RGBA_INT,!1);g.source="NODE_TEX";Na.update_texture(g,a,0);ya(b,g,"u_ssao_special_tex");O(b);return b};F.create_ssao_blur_batch=function(a){var b=
U("SSAO_BLUR");b.depth_mask=!1;b.use_backface_culling=!0;var g=La.generate_fullscreen_tri();pa(b,g);ga(b,"postprocessing/postprocessing.glslv","postprocessing/ssao_blur.glslf");X(b,"SSAO_BLUR_DEPTH",a.ssao_blur_depth?1:0);X(b,"SHADOW_USAGE","NO_SHADOWS");O(b);return b};F.create_coc_batch=function(a){var b=U("COC");b.depth_mask=!1;b.use_backface_culling=!0;var g=La.generate_fullscreen_tri();pa(b,g);ga(b,"postprocessing/postprocessing.glslv","postprocessing/coc.glslf");X(b,"DEPTH_RGBA",1);switch(a){case "COC_ALL":X(b,
"COC_TYPE","COC_ALL");break;case "COC_FOREGROUND":X(b,"COC_TYPE","COC_FOREGROUND");break;case "COC_COMBINE":X(b,"COC_TYPE","COC_COMBINE")}X(b,"SHADOW_USAGE","NO_SHADOWS");O(b);return b};F.create_dof_batch=function(a){var b=U("DOF");b.depth_mask=!1;b.use_backface_culling=!0;var g=La.generate_fullscreen_tri();pa(b,g);ga(b,"postprocessing/postprocessing.glslv","postprocessing/dof.glslf");a.dof_bokeh?X(b,"DOF_TYPE","DOF_BOKEH"):(X(b,"DOF_TYPE","DOF_SIMPLE"),X(b,"DEPTH_RGBA",1));X(b,"SHADOW_USAGE","NO_SHADOWS");
O(b);return b};F.create_outline_batch=function(){var a=U("OUTLINE");a.depth_mask=!1;a.use_backface_culling=!0;var b=La.generate_fullscreen_tri();pa(a,b);ga(a,"postprocessing/postprocessing.glslv","postprocessing/outline.glslf");O(a);return a};F.create_glow_combine_batch=function(){var a=U("GLOW_COMBINE");a.depth_mask=!1;a.use_backface_culling=!0;var b=La.generate_fullscreen_tri();pa(a,b);ga(a,"postprocessing/postprocessing.glslv","postprocessing/glow.glslf");O(a);return a};F.create_god_rays_batch=
function(a,b,g){var c=U("GOD_RAYS");c.depth_mask=!1;c.use_backface_culling=!0;var h=La.generate_billboard();pa(c,h);ga(c,"postprocessing/god_rays.glslv","postprocessing/god_rays.glslf");X(c,"DEPTH_RGBA",a?1:0);X(c,"WATER_EFFECTS",b?1:0);X(c,"STEPS_PER_PASS",Ia.glsl_value(g,1));X(c,"SHADOW_USAGE","NO_SHADOWS");O(c);return c};F.create_god_rays_combine_batch=function(){var a=U("GOD_RAYS_COM");a.depth_mask=!1;a.use_backface_culling=!0;var b=La.generate_fullscreen_tri();pa(a,b);ga(a,"postprocessing/postprocessing.glslv",
"postprocessing/god_rays_combine.glslf");X(a,"SAFARI_CANVAS_ALPHA_HACK",Z.safari_canvas_alpha_hack?1:0);O(a);return a};F.create_cube_sky_batch=function(a,b){var g=U("SKY");g.depth_mask=!1;g.use_backface_culling=!1;var c=La.generate_plane(1,1);pa(g,c);if(""!=b.sky_ngraph_proxy_id)ga(g,"skybox.glslv","node_skybox.glslf"),X(g,"IS_WORLD",1),t(g,a);else if(b.procedural_skydome)ga(g,"skybox.glslv","proc_skybox.glslf"),X(g,"WATER_EFFECTS",1);else{ga(g,"skybox.glslv","tex_skybox.glslf");if(a){c=a._render.world_light_set;
if(c.sky_texture_slot){var h=c.sky_texture_slot.texture,f=Na.get_batch_texture(c.sky_texture_slot,null);ya(g,f,"u_sky_texture",h.name)}c.sky_texture_param&&X(g,"WO_SKYTEX",1)}b.sky_invert&&X(g,"MTEX_NEGATIVE",1);b.sky_use_rgb_to_intensity&&X(g,"MTEX_RGBTOINT",1);X(g,"BLENDTYPE",b.sky_blend_type);b.sky_use_map_blend&&X(g,"WOMAP_BLEND",1);b.sky_use_map_horizon&&X(g,"WOMAP_HORIZ",1);b.sky_use_map_zenith_up&&X(g,"WOMAP_ZENUP",1);b.sky_use_map_zenith_down&&X(g,"WOMAP_ZENDOWN",1);b.use_sky_blend&&X(g,"WO_SKYBLEND",
1);b.use_sky_paper&&X(g,"WO_SKYPAPER",1);b.use_sky_real&&X(g,"WO_SKYREAL",1)}O(g);return g};F.append_cube_sky_batch_to_world=function(a,b){var g=Wa.find_subs(a._render.graph,Ua.SKY);g&&Ka.append_batch(b,a,g.draw_data[0].bundles[0].batch)};F.create_cube_irradiance_batch=function(a,b){var g=U("IRRADIANCE");g.depth_mask=!1;g.use_backface_culling=!1;var c=La.generate_plane(1,1);pa(g,c);ga(g,"skybox.glslv","irradiance_skybox.glslf");O(g);return g};F.create_cube_roughness_convolution_batch=function(a,b){var g=
U("R_CONVOLUTION");g.depth_mask=!1;g.use_backface_culling=!1;var c=La.generate_plane(1,1);pa(g,c);ga(g,"skybox.glslv","r_convolution_skybox.glslf");O(g);return g};F.create_brdf_batch=function(a,b){var g=U("BRDF");g.depth_mask=!1;g.use_backface_culling=!1;var c=La.generate_plane(1,1);pa(g,c);ga(g,"postprocessing/postprocessing.glslv","postprocessing/precompute_brdf.glslf");O(g);return g};F.create_antialiasing_batch=function(a){var b=U("ANTIALIASING");b.depth_mask=!1;b.use_backface_culling=!0;var g=
La.generate_fullscreen_tri();pa(b,g);ga(b,"postprocessing/postprocessing.glslv","postprocessing/antialiasing.glslf");Z.quality_aa_method?(X(b,"AA_METHOD","AA_METHOD_FXAA_QUALITY"),X(b,"AA_QUALITY",a.fxaa_quality)):X(b,"AA_METHOD","AA_METHOD_FXAA_LIGHT");O(b);return b};F.create_smaa_batch=function(a){var b=U("SMAA"),g=La.generate_fullscreen_tri();pa(b,g);ga(b,"postprocessing/smaa.glslv","postprocessing/smaa.glslf");X(b,"AA_METHOD","AA_METHOD_SMAA_HIGH");X(b,"SMAA_PASS",a);X(b,"SMAA_PREDICATION",0);
X(b,"SMAA_REPROJECTION",0);O(b);b.depth_mask=!1;b.use_backface_culling=!0;return b};F.create_compositing_batch=function(){var a=U("COMPOSITING");a.depth_mask=!1;a.use_backface_culling=!0;var b=La.generate_fullscreen_tri();pa(a,b);ga(a,"postprocessing/postprocessing.glslv","postprocessing/compositing.glslf");O(a);return a};F.create_motion_blur_batch=function(a){a=U("MOTION_BLUR");a.use_backface_culling=!0;a.depth_mask=!1;var b=La.generate_fullscreen_tri();pa(a,b);ga(a,"postprocessing/postprocessing.glslv",
"postprocessing/motion_blur.glslf");O(a);return a};F.create_stereo_batch=function(a){var b=U("STEREO");b.use_backface_culling=!0;b.depth_mask=!1;var g=La.generate_fullscreen_tri();pa(b,g);ga(b,"postprocessing/postprocessing.glslv","postprocessing/stereo.glslf");X(b,"ANAGLYPH","ANAGLYPH"===a?1:0);X(b,"SIDEBYSIDE","SIDEBYSIDE"===a?1:0);X(b,"DISTOR_SCALE",$a.nonwebvr.distor_scale);O(b);return b};F.create_luminance_batch=function(){var a=U("LUMINANCE");a.depth_mask=!1;a.use_backface_culling=!0;var b=
La.generate_fullscreen_tri();pa(a,b);ga(a,"postprocessing/postprocessing.glslv","postprocessing/luminance.glslf");O(a);return a};F.create_average_luminance_batch=function(){var a=U("LUMINANCE");a.depth_mask=!1;a.use_backface_culling=!0;var b=La.generate_fullscreen_tri();pa(a,b);ga(a,"postprocessing/postprocessing.glslv","postprocessing/luminance_av.glslf");O(a);return a};F.create_luminance_truncated_batch=function(a){var b=U("LUMINANCE_X_BLUR");b.depth_mask=!1;b.use_backface_culling=!0;var g=La.generate_fullscreen_tri();
pa(b,g);ga(b,"postprocessing/postprocessing.glslv","postprocessing/luminance_truncated.glslf");a&&Ia.set_directive(b.shaders_info,"ADAPTIVE_BLOOM",1);O(b);return b};F.create_bloom_combine_batch=function(a){var b=U("BLOOM");b.depth_mask=!1;b.use_backface_culling=!0;var g=La.generate_fullscreen_tri();pa(b,g);ga(b,"postprocessing/postprocessing.glslv","postprocessing/bloom_combine.glslf");if(1==a)var c="BLUR_PASS_1";else 2==a?c="BLUR_PASS_2":3==a?c="BLUR_PASS_3":4==a?c="BLUR_PASS_4":5==a&&(c="BLUR_PASS_5");
Ia.set_directive(b.shaders_info,"BLUR_PASS_NUM",c);O(b);return b};F.create_velocity_batch=function(){var a=U("VELOCITY");a.depth_mask=!1;a.use_backface_culling=!0;var b=La.generate_fullscreen_tri();pa(a,b);ga(a,"postprocessing/postprocessing.glslv","postprocessing/velocity.glslf");O(a);return a};F.create_anchor_visibility_batch=function(){var a=U("ANCHOR_VISIBILITY");a.depth_mask=!0;a.use_backface_culling=!0;a.draw_mode=Va.DM_TRIANGLES;ga(a,"anchors.glslv","anchors.glslf");var b=La.generate_index(1);
pa(a,b);X(a,"ANCHOR_NUM",1);O(a);a.anchor_positions=new Float32Array(3);return a};F.create_performance_batch=function(){var a=U("PERFORMANCE");a.depth_mask=!1;a.use_backface_culling=!0;var b=La.generate_fullscreen_tri();pa(a,b);ga(a,"postprocessing/postprocessing.glslv","postprocessing/performance.glslf");O(a);return a};F.update_anchor_visibility_batch=function(a,b){var g=b.length/3;if(g!=a.anchor_positions.length/3){var c=La.generate_index(g);pa(a,c);X(a,"ANCHOR_NUM",g);O(a)}a.anchor_positions=b};
F.get_first_batch=function(a){if(!a.scenes_data.length)return null;a=a.scenes_data[0];return a.batches.length?a.batches[0]:null};F.find_batch_material_any=function(a,b,g){a=a.scenes_data[0].batches;for(var c=0;c<a.length;c++)if(a[c].type==g&&-1!=a[c].material_names.indexOf(b))return a[c];return null};F.find_batch_material=function(a,b,g){a=a.scenes_data[0].batches;for(var c=0;c<a.length;c++)if(a[c].type==g&&!a[c].forked_batch&&-1!=a[c].material_names.indexOf(b))return a[c];return null};F.find_batch_material_forked=
function(a,b,g){a=a.scenes_data[0].batches;for(var c=0;c<a.length;c++)if(a[c].type==g&&a[c].forked_batch&&-1!=a[c].material_names.indexOf(b))return a[c];return null};F.iterate_batches_by_mat=function(a,b,g,c){a=a.scenes_data[0].batches;for(var h=0;h<a.length;h++){var f=a[h];if(-1!=f.material_names.indexOf(b)&&(!c||f.type==c)&&g(f))break}};F.check_batch_type=function(a,b){for(var g=a.scenes_data[0].batches,c=0;c<g.length;c++)if(g[c].type==b)return!0;return!1};F.get_batch_by_type=function(a,b,g){a=
(g?Ka.get_scene_data(a,g):a.scenes_data[0]).batches;for(g=0;g<a.length;g++)if(a[g].type==b)return a[g];return null};F.clear_batch=function(a){var b=a.textures;a.textures=[];for(var g=0;g<b.length;g++)Na.cleanup_unused(b[g]);a.textures=b;a.bufs_data&&a.bufs_data.cleanup_gl_data_on_unload&&Va.cleanup_bufs_data(a.bufs_data);a.cleanup_gl_data_on_unload&&a.vaos.length&&Xa.cleanup_vao(a);a.shader&&a.shader.cleanup_gl_data_on_unload&&Ia.cleanup_shader(a.shader);a.ngraph_proxy_id&&(b=ma.get_ngraph_proxy_cached(a.ngraph_proxy_id))&&
b.cleanup_on_unload&&ma.cleanup_ngraph_proxy(a.ngraph_proxy_id)};F.set_cleanup_nodemat=function(a,b){if(""!==a.ngraph_proxy_id){var g=ma.get_ngraph_proxy_cached(a.ngraph_proxy_id);g&&(g.cleanup_on_unload=b)}};F.generate_odd_id=wa;F.cleanup=function(){Sa={}};F.set_nodemat_value=function(a,b,g){for(var c=a.node_value_inds,h=0;h<c.length;h+=3)if(c[h]==b)return a.node_values[4*c[h+1]+c[h+2]]=g,!0;return!1};F.set_nodemat_rgb=function(a,b,g,c,h){for(var f=a.node_rgb_inds,d=0;d<f.length;d+=2)if(f[d]==b)return b=
f[d+1],a.node_rgbs[3*b]=g,a.node_rgbs[3*b+1]=c,a.node_rgbs[3*b+2]=h,!0;return!1};F.get_nodemat_value=function(a,b){for(var g=a.node_value_inds,c=0;c<g.length;c+=3)if(g[c]==b)return a.node_values[4*g[c+1]+g[c+2]];return null};F.get_nodemat_rgb=function(a,b,g){for(var c=a.node_rgb_inds,h=0;h<c.length;h+=2)if(c[h]==b)return b=c[h+1],g[0]=a.node_rgbs[3*b],g[1]=a.node_rgbs[3*b+1],g[2]=a.node_rgbs[3*b+2],g;return null}});t.a=e},function(C,t,e){C=e(0);var R=e(5),V=e(35),n=e(4),y=e(70),d=e(45),k=e(28),I=
e(1),A=e(18),r=e(2),p=e(22),u=e(12),a=e(9),B=e(75),l=e(3),c=e(10),m=e(48);e=Object(C.a)("__textures",function(b,f){function e(){fb||(fb=W.createFramebuffer());return fb}function fa(){Ka||(Ka=W.createTexture());return Ka}function z(){return{type:0,source:"",source_id:"",width:0,height:0,compress_ratio:1,anisotropic_filtering:0,source_size:1024,enable_canvas_mipmapping:!1,canvas_context:null,w_target:0,w_texture:null,w_renderbuffer:null,is_movie:!1,vtex_data_id:-1,video_file:null,video_tex_name:"",
movie_length:0,fps:0,frame_start:0,frame_offset:0,frame_duration:0,need_resize:!1,scale_fac:1,use_mipmap:!1,mipmap_count:0,seq_video:null,seq_movie_length:0,seq_fps:0,seq_cur_frame:-1,seq_video_played:!1,seq_last_discrete_mark:-1,video_was_stopped:!1,use_auto_refresh:!1,use_cyclic:!1,use_nla:!1,repeat:!0,img_full_filepath:"",img_filepath:"",img_uuid:"",img_source:"",img_name:"",img_comp_method:""}}function G(a,b,g){a.img_uuid=b.uuid;a.img_filepath=b.filepath;a.img_source=b.source;a.img_name=b.name;
a.img_full_filepath=Object(m.b)(g+b.filepath);a.img_comp_method=b._comp_method;-1==La.textures.indexOf(a)&&(La.textures.push(a),La.loaded_status.push(!1))}function E(a,b,g){var c=-1<b.indexOf(".dds"),h=-1<b.indexOf(".pvr");a.img_comp_method=c?"dds":h?"pvr":"";a.img_filepath=b;a.img_full_filepath=g;a.img_uuid=r._4();La.textures.push(a);La.loaded_status.push(!0)}function J(a,b,g){var c=z();c.type=a;c.source="NONE";c.use_mipmap=g;if(a==f.TT_RB_RGBA||a==f.TT_RB_DEPTH||a==f.TT_RB_RGBA_MS||a==f.TT_RB_DEPTH_MS)c.w_renderbuffer=
W.createRenderbuffer();else{var h=W.TEXTURE_2D,d=W.createTexture();W.bindTexture(h,d);W.texParameteri(h,W.TEXTURE_MAG_FILTER,W.LINEAR);g?W.texParameteri(h,W.TEXTURE_MIN_FILTER,Ia[Da.texture_min_filter]):W.texParameteri(h,W.TEXTURE_MIN_FILTER,W.LINEAR);W.texParameteri(h,W.TEXTURE_WRAP_S,W.CLAMP_TO_EDGE);W.texParameteri(h,W.TEXTURE_WRAP_T,W.CLAMP_TO_EDGE);g=q(c);var l=w(c),k=H(c);a=a==f.TT_DEPTH?null:a==f.TT_RGBA_FLOAT?new Float32Array([204,204,204,255]):new Uint8Array([204,204,204,255]);W.texImage2D(h,
0,l,1,1,0,g,k,a);Da.compared_mode_depth&&b&&W.texParameterf(h,W.TEXTURE_COMPARE_MODE,W.COMPARE_REF_TO_TEXTURE);W.bindTexture(h,null);c.w_target=h;c.w_texture=d}return c}function M(a){var b=a.w_target;W.bindTexture(b,a.w_texture);var g=q(a),c=w(a),h=H(a),f=a.canvas_context.canvas;W.pixelStorei(W.UNPACK_FLIP_Y_WEBGL,!0);W.texImage2D(b,0,c,g,h,f);W.pixelStorei(W.UNPACK_FLIP_Y_WEBGL,!1);a.enable_canvas_mipmapping&&W.generateMipmap(b);W.bindTexture(b,null);a.width=f.width;a.height=f.height}function F(a){var b=
a.w_target;W.bindTexture(b,a.w_texture);W.pixelStorei(W.UNPACK_FLIP_Y_WEBGL,!0);4!=a.video_file.length?a.need_resize?t(a,a.video_file,a.width*a.scale_fac,a.height*a.scale_fac,!1):W.texImage2D(b,0,W.RGBA,W.RGBA,W.UNSIGNED_BYTE,a.video_file):W.texImage2D(b,0,W.RGBA,1,1,0,W.RGBA,W.UNSIGNED_BYTE,a.video_file);W.bindTexture(b,null)}function U(a){var b=a.w_target;W.bindTexture(b,a.w_texture);W.pixelStorei(W.UNPACK_FLIP_Y_WEBGL,!0);a.need_resize?t(a,a.seq_video[a.seq_cur_frame],a.width*a.scale_fac,a.height*
a.scale_fac,!1):W.texImage2D(b,0,W.RGBA,W.RGBA,W.UNSIGNED_BYTE,a.seq_video[a.seq_cur_frame]);W.bindTexture(b,null)}function K(){ma||(ma=document.createElement("canvas"));return ma}function t(a,b,g,c,h){h||(Y(W.TEXTURE_2D),W.texImage2D(W.TEXTURE_2D,0,W.RGBA,W.RGBA,W.UNSIGNED_BYTE,b));W.bindTexture(W.TEXTURE_2D,null);b=e();h=fa();wa.draw_resized_texture(a,g,c,b,h,"NONE")}function v(a,b,g,c){for(a=0;6>a;a++){var h=Ua[a],f=Na[a],d=K();d.width=c;d.height=c;var l=d.getContext("2d");l.translate(c/2,c/2);
"TEXTURE_CUBE_MAP_POSITIVE_X"==h?(l.rotate(Math.PI/2),l.scale(1,-1)):"TEXTURE_CUBE_MAP_NEGATIVE_X"==h?(l.rotate(Math.PI/2),l.scale(-1,1)):"TEXTURE_CUBE_MAP_POSITIVE_Y"==h||"TEXTURE_CUBE_MAP_POSITIVE_Z"==h?l.scale(1,-1):"TEXTURE_CUBE_MAP_NEGATIVE_Y"!=h&&"TEXTURE_CUBE_MAP_NEGATIVE_Z"!=h||l.scale(-1,1);l.drawImage(b,f[0]*g,f[1]*g,g,g,-c/2,-c/2,c,c);Da.d3d9_canvas_resizing_hack?W.texImage2D(W[h],0,W.RGBA,c,c,0,W.RGBA,W.UNSIGNED_BYTE,new Uint8Array(l.getImageData(0,0,c,c).data.buffer)):W.texImage2D(W[h],
0,W.RGBA,W.RGBA,W.UNSIGNED_BYTE,d)}}function Y(a){W.bindTexture(a,null);var b=fa();W.bindTexture(a,b);W.texParameteri(a,W.TEXTURE_WRAP_S,W.CLAMP_TO_EDGE);W.texParameteri(a,W.TEXTURE_WRAP_T,W.CLAMP_TO_EDGE);W.texParameteri(a,W.TEXTURE_MAG_FILTER,W.LINEAR);W.texParameteri(a,W.TEXTURE_MIN_FILTER,W.LINEAR)}function ha(a,b,g){var c=a.source,h=a.w_texture,f=a.w_target,d=a.img_comp_method,l=a.img_filepath,k;W.bindTexture(f,h);a.repeat?(W.texParameteri(f,W.TEXTURE_WRAP_S,W.REPEAT),W.texParameteri(f,W.TEXTURE_WRAP_T,
W.REPEAT)):(W.texParameteri(f,W.TEXTURE_WRAP_S,W.CLAMP_TO_EDGE),W.texParameteri(f,W.TEXTURE_WRAP_T,W.CLAMP_TO_EDGE));a.is_movie||"NODE_TEX"==c?W.texParameteri(f,W.TEXTURE_MIN_FILTER,W.LINEAR):W.texParameteri(f,W.TEXTURE_MIN_FILTER,Ia[Da.texture_min_filter]);a.anisotropic_filtering&&W.texParameterf(f,ga.get_aniso().TEXTURE_MAX_ANISOTROPY_EXT,a.anisotropic_filtering);4==b.length&&(k=!0,b=new Uint8Array([255*b[0],255*b[1],255*b[2],255*b[3]]));if("IMAGE"==c)if(k)W.texImage2D(f,0,W.RGBA,1,1,0,W.RGBA,W.UNSIGNED_BYTE,
b),a.width=1,a.height=1;else if(d){k=Aa.get_width_height(b,d);g=r.L(k.width)||r.L(k.height);if(k.width>Ba.max_texture_size||k.height>Ba.max_texture_size){ya.error('Image "'+l+'" has unsupported size: '+k.width+"x"+k.height+". Max available: "+Ba.max_texture_size+"x"+Ba.max_texture_size+".");return}c=k.width;k=k.height;if(g||"pvr"==d)a.need_resize=!0,Y(f),c=L(c*a.scale_fac),k=L(k*a.scale_fac);"dds"==d?Aa.upload_dds_levels(W,ga.get_s3tc(),b,!0):"pvr"==d&&Aa.upload_pvr_levels(W,ga.get_pvr(),b,!0);a.need_resize&&
(t(a,null,c,k,!0),W.bindTexture(f,h),W.generateMipmap(f));a.width=c;a.height=k;a.compress_ratio=Aa.get_compress_ratio(b,d)}else{W.pixelStorei(W.UNPACK_FLIP_Y_WEBGL,!0);a.is_movie?Da.seq_video_fallback?(c=b[0].width,k=b[0].height):(c=b.videoWidth,k=b.videoHeight):(c=b.width,k=b.height);a.width=c;a.height=k;if(c>Ba.max_texture_size||k>Ba.max_texture_size)ya.warn('Image "'+l+'" has unsupported size: '+c+"x"+k+". Max available: "+Ba.max_texture_size+"x"+Ba.max_texture_size+". Reduced image size will be used."),
a.scale_fac=Math.min(Ba.max_texture_size/c,Ba.max_texture_size/k),a.need_resize=!0;a.is_movie&&(g in Wa||(Wa[g]={}),Wa[g][a.video_tex_name]=a,Da.seq_video_fallback?(a.seq_video=b,a.seq_movie_length=b.length,a.fps=a.seq_fps*a.movie_length/b.length,b=b[0]):(a.video_file=b,a.video_file.loop=a.use_cyclic,a.fps=b.duration?a.movie_length/b.duration:O.get_framerate(),Ta.disable_playback_rate_hack||(b.playbackRate=O.get_framerate()/a.fps,Ta.clamp_playback_rate_hack&&2<b.playbackRate&&(b.playbackRate=2)),
S(a)));c=L(a.width*a.scale_fac);k=L(a.height*a.scale_fac);a.need_resize||Da.resize_texture_canvas_hack?(l=K(),d=l.getContext("2d"),l.width=c,l.height=k,d.drawImage(b,0,0,a.width,a.height,0,0,c,k),Da.d3d9_canvas_resizing_hack?W.texImage2D(f,0,W.RGBA,c,k,0,W.RGBA,W.UNSIGNED_BYTE,new Uint8Array(d.getImageData(0,0,c,k).data.buffer)):W.texImage2D(f,0,W.RGBA,W.RGBA,W.UNSIGNED_BYTE,l)):Da.webgl2||!r.L(a.width)&&!r.L(a.height)?W.texImage2D(f,0,W.RGBA,W.RGBA,W.UNSIGNED_BYTE,b):(t(a,b,c,k,!1),a.need_resize=
!0);a.width=c;a.height=k;a.is_movie||(W.bindTexture(f,h),W.generateMipmap(f))}else if("ENVIRONMENT_MAP"==c)if(k){for(h=0;6>h;h++)W.texImage2D(W["TEXTURE_CUBE_MAP_"+Ua[h]],0,W.RGBA,1,1,0,W.RGBA,W.UNSIGNED_BYTE,b);a.width=3;a.height=2}else{W.pixelStorei(W.UNPACK_FLIP_Y_WEBGL,!1);if(b.width%3||b.height%2){ya.error('Cubemap Image "'+l+'" has unsupported size: '+b.width+"x"+b.height+". The width must be multiple of three and the height - multiple of two.");return}h=b.width/3;h>Ba.max_cube_map_texture_size?
(ya.warn('Cubemap Image "'+l+'" has unsupported size: '+b.width+"x"+b.height+". Max available: "+3*Ba.max_cube_map_texture_size+"x"+2*Ba.max_cube_map_texture_size+". Reduced image size will be used."),l=L(Ba.max_cube_map_texture_size/h*h),a.need_resize=!0):(l=L(h),!Da.webgl2&&(3*l>Ba.max_texture_size||2*l>Ba.max_texture_size)&&(a.need_resize=!0));if(a.need_resize||Da.resize_cubemap_canvas_hack)v(a,b,h,l);else{d=b;c=l;Y(W.TEXTURE_2D);W.texImage2D(W.TEXTURE_2D,0,W.RGBA,W.RGBA,W.UNSIGNED_BYTE,d);W.bindTexture(W.TEXTURE_2D,
null);for(d=0;6>d;d++)W.texImage2D(W.TEXTURE_CUBE_MAP_POSITIVE_X+d,0,W.RGBA,c,c,0,W.RGBA,W.UNSIGNED_BYTE,null);W.bindTexture(a.w_target,null);d=e();W.bindFramebuffer(W.FRAMEBUFFER,d);k=fa();for(d=0;6>d;d++)wa.draw_resized_cubemap_texture(a,W[Ua[d]],c,h,k,d);W.bindFramebuffer(W.FRAMEBUFFER,null);W.bindTexture(a.w_target,a.w_texture);W.texParameteri(a.w_target,W.TEXTURE_MIN_FILTER,Ia[Da.texture_min_filter]);W.texParameteri(a.w_target,W.TEXTURE_MAG_FILTER,W.LINEAR)}xa.ff_cubemap_out_of_memory()&&(ya.warn("Firefox detected, setting max cubemap size to 256, use canvas for resizing."),
v(a,b,h,Ca.NVIDIA_OLD_GPU_CUBEMAP_MAX_SIZE));a.width=3*l;a.height=2*l;W.generateMipmap(f)}else"NODE_TEX"==c&&(W.pixelStorei(W.UNPACK_FLIP_Y_WEBGL,!1),W.texImage2D(f,0,W.RGBA,b.width,b.height,0,W.RGBA,W.UNSIGNED_BYTE,b.data),a.width=b.width,a.height=b.height);W.bindTexture(f,null)}function S(a){a.video_file.oncanplay=function(){za(a)&&F(a)}}function L(a){return r.L(a)?(a=Math.pow(2,(a|0).toString(2).length),r.M(a,2,Ba.max_texture_size)):a}function q(a){var b;switch(a.type){case f.TT_RGBA_INT:b=W.RGBA;
break;case f.TT_RGB_INT:b=W.RGB;break;case f.TT_RGBA_FLOAT:b=W.RGBA;break;case f.TT_RGB_FLOAT:b=W.RGB;break;case f.TT_DEPTH:b=W.DEPTH_COMPONENT;break;default:ka.panic("Wrong texture type")}return b}function w(a){var b;switch(a.type){case f.TT_RGBA_INT:b=Da.webgl2?W.RGBA8:W.RGBA;break;case f.TT_RGB_INT:b=Da.webgl2?W.RGB8:W.RGB;break;case f.TT_RGBA_FLOAT:b=Da.webgl2?W.RGBA32F:W.RGBA;break;case f.TT_RGB_FLOAT:b=Da.webgl2?W.RGB8:W.RGB;break;case f.TT_DEPTH:b=Da.webgl2?ea(Ba.depth_bits):W.DEPTH_COMPONENT;
break;default:ka.panic("Wrong texture type")}return b}function ea(a){switch(a){case 16:a=W.DEPTH_COMPONENT16;break;case 24:a=W.DEPTH_COMPONENT24;break;case 32:a=W.DEPTH_COMPONENT32F;break;default:a=W.DEPTH_COMPONENT24}return a}function H(a){var b;switch(a.type){case f.TT_RGBA_INT:b=W.UNSIGNED_BYTE;break;case f.TT_RGB_INT:b=W.UNSIGNED_BYTE;break;case f.TT_RGBA_FLOAT:b=W.FLOAT;break;case f.TT_RGB_FLOAT:b=W.FLOAT;break;case f.TT_DEPTH:b=W.UNSIGNED_INT;break;default:ka.panic("Wrong texture type")}return b}
function D(a){a.video_file?a.video_file.play():a.seq_video&&(a.seq_video_played=!0);a.video_was_stopped=!1}function h(a){a.video_file?a.video_file.pause():a.seq_video&&(a.seq_video_played=!1);a.video_was_stopped=!0}function ia(a){a.video_file?a.video_file.currentTime=a.frame_offset/a.fps:a.seq_video&&(a.seq_cur_frame=P(a,a.frame_offset),U(a))}function ra(a){return a.video_file?!a.video_file.paused:a.seq_video?a.seq_video_played:!1}function za(a){return a.video_file||a.seq_video?a.video_file?2<=a.video_file.readyState:
!0:0}function P(a,b){return Math.round(b*a.seq_movie_length/a.movie_length)}function oa(a,b){if(na.is_dynamic(a))return da(a,b);for(var g=a.meta_objects,c=0;c<g.length;c++){var h=da(g[c],b);if(h)return h}return null}function Q(a,b,g){if(na.is_dynamic(a))ja(a,b,g);else{a=a.meta_objects;for(var c=0;c<a.length;c++)ja(a[c],b,g)}}function da(a,b){var g=a.scenes_data;if(g.length)for(var g=g[0].batches,c=0;c<g.length;c++){var h=g[c];if("MAIN"==h.type||"SKY"==h.type)for(var f=0;f<h.textures.length;f++)if(h.bpy_tex_names[f]==
b)return h.textures[f]}return null}function ja(a,b,g){a=a.scenes_data;if(a.length){a=a[0].batches;for(var c=0;c<a.length;c++){var h=a[c];if("MAIN"==h.type)for(var f=0;f<h.textures.length;f++)if(h.bpy_tex_names[f]==b){var d=h.textures[f];h.textures[f]=g;ta(d)}}}}function va(a,b){var g=a.scenes_data;if(g.length)for(var g=g[0].batches,c=0;c<g.length;c++){var h=g[c];if("MAIN"==h.type)for(var f=0;f<h.textures.length;f++){var d=h.textures[f],l=h.bpy_tex_names[f];-1==b.indexOf(l)&&"NODE_TEX"!=d.source&&
b.push(l)}}}function Ga(a,b,g){var c=a.elements;a=a.interpolation;for(var h=0;h<b;h++){var f=h/(b-1),d=ba(c,f,!0),l=Ea(c,f,!0);if(d&&l)if("CONSTANT"==a)g.push.apply(g,d.color);else{var k=g,e=d,m=l;if(e==m)k.push.apply(k,e.color);else{var q=Ja.linear_interpolation(m.color[0],m.position,e.color[0],e.position,f);k.push(q);q=Ja.linear_interpolation(m.color[1],m.position,e.color[1],e.position,f);k.push(q);q=Ja.linear_interpolation(m.color[2],m.position,e.color[2],e.position,f);k.push(q);e=Ja.linear_interpolation(m.color[3],
m.position,e.color[3],e.position,f);k.push(e)}}l&&!d&&g.push.apply(g,l.color);d&&!l&&g.push.apply(g,d.color)}}function ba(a,b,g){for(var c=null,h=0;h<a.length;h++){var f=g?b-a[h].position:b-a[h][1][0];0<=f&&(c?f<=(g?b-c.position:b-a[h][1][0])&&(c=a[h]):c=a[h])}return c}function Ea(a,b,g){for(var c=null,h=0;h<a.length;h++){var f=g?a[h].position-b:a[h][1][0]-b;0<=f&&(c?f<=(g?c.position-b:c[1][0]-b)&&(c=a[h]):c=a[h])}return c}function ta(a){var b;if(b=!Da.enable_texture_cache){a:{b=qa.get_all_objects("ALL",
qa.DATA_ID_ALL);for(var g=0;g<b.length;g++){var c=b[g];if(X(c,a)){b=!0;break a}for(var c=c.meta_objects,h=0;h<c.length;h++)if(X(c[h],a)){b=!0;break a}}b=!1}b=!b}b&&(a.w_texture&&W.deleteTexture(a.w_texture),a=La.textures.indexOf(a),-1!=a&&(La.textures.splice(a,1),La.loaded_status.splice(a,1)))}function X(a,b){for(var g=0;g<a.scenes_data.length;g++)for(var c=a.scenes_data[g].batches,h=0;h<c.length;h++)for(var f=c[h].textures,d=0;d<f.length;d++)if(f[d]==b)return!0}function pa(a,b){for(var g=0;g<La.textures.length;g++){var c=
La.textures[g];if(c.img_full_filepath==a&&c.type==b.type&&c.source==b.source&&c.repeat==b.repeat&&c.anisotropic_filtering==b.anisotropic_filtering&&c.use_nla==b.use_nla)return c}return null}var ka=Object(R.a)(b),Ca=Object(V.a)(b),C=Object(n.a)(b),Aa=Object(y.a)(b),xa=Object(d.a)(b),ga=Object(k.a)(b),ya=Object(I.a)(b),O=Object(A.a)(b),wa=Object(p.a)(b),qa=Object(u.a)(b),na=Object(a.a)(b),Ja=Object(B.a)(b),g=Object(c.a)(b),Da=C.defaults,Ba=C.context_limits,Ta=C.sfx,ma=null,Ka=null,fb=null;f.TF_NEAREST=
0;f.TF_LINEAR=0;f.TF_NEAREST_MIPMAP_NEAREST=0;f.TF_LINEAR_MIPMAP_NEAREST=0;f.TF_NEAREST_MIPMAP_LINEAR=0;f.TF_LINEAR_MIPMAP_LINEAR=0;f.TT_RGBA_INT=10;f.TT_RGB_INT=20;f.TT_RGBA_FLOAT=30;f.TT_RGB_FLOAT=40;f.TT_DEPTH=50;f.TT_RB_RGBA=60;f.TT_RB_DEPTH=70;f.TT_RB_RGBA_MS=80;f.TT_RB_DEPTH_MS=90;f.CURVE_NODES_TEXT_SIZE=128;f.COLORRAMP_TEXT_SIZE=128;f.PART_COLORRAMP_TEXT_SIZE=128;var La={textures:[],loaded_status:[]},Xa={},Wa={},W=null,Ia,Ua="TEXTURE_CUBE_MAP_POSITIVE_X TEXTURE_CUBE_MAP_NEGATIVE_X TEXTURE_CUBE_MAP_POSITIVE_Y TEXTURE_CUBE_MAP_NEGATIVE_Y TEXTURE_CUBE_MAP_POSITIVE_Z TEXTURE_CUBE_MAP_NEGATIVE_Z".split(" "),
Na=[[2,0],[0,0],[2,1],[1,0],[1,1],[0,1]];f.setup_context=function(a){Ia=[a.NEAREST_MIPMAP_NEAREST,a.NEAREST_MIPMAP_LINEAR,a.LINEAR_MIPMAP_NEAREST,a.LINEAR_MIPMAP_LINEAR];f.TF_NEAREST=a.NEAREST;f.TF_LINEAR=a.LINEAR;f.TF_NEAREST_MIPMAP_NEAREST=a.NEAREST_MIPMAP_NEAREST;f.TF_LINEAR_MIPMAP_NEAREST=a.LINEAR_MIPMAP_NEAREST;f.TF_NEAREST_MIPMAP_LINEAR=a.NEAREST_MIPMAP_LINEAR;f.TF_LINEAR_MIPMAP_LINEAR=a.LINEAR_MIPMAP_LINEAR;W=a};f.get_canvas_context=function(a,b){return b in Xa&&a in Xa[b]?Xa[b][a].canvas_context:
null};f.update_canvas_context=function(a,b){return b in Xa&&a in Xa[b]?(M(Xa[b][a]),!0):!1};f.append_img_info=G;f.create_texture=J;f.create_cubemap_texture=function(a,b){var g=W.createTexture(),c=W.TEXTURE_CUBE_MAP;W.bindTexture(c,g);W.texParameteri(c,W.TEXTURE_MAG_FILTER,W.LINEAR);b?W.texParameteri(c,W.TEXTURE_MIN_FILTER,Ia[Da.texture_min_filter]):W.texParameteri(c,W.TEXTURE_MIN_FILTER,W.LINEAR);W.texParameteri(c,W.TEXTURE_WRAP_S,W.CLAMP_TO_EDGE);W.texParameteri(c,W.TEXTURE_WRAP_T,W.CLAMP_TO_EDGE);
for(var h=0;6>h;h++)W.texImage2D(W[Ua[h]],0,W.RGBA,a,a,0,W.RGBA,W.UNSIGNED_BYTE,null);W.bindTexture(c,null);c=z();c.type=f.TT_RGBA_INT;c.source="NONE";c.width=3*a;c.height=2*a;c.compress_ratio=1;c.use_mipmap=b;c.w_texture=g;c.w_target=W.TEXTURE_CUBE_MAP;return c};f.set_cubemap_tex_size=function(a,b){var g=a.w_target;W.bindTexture(g,a.w_texture);for(var c=0;6>c;c++)W.texImage2D(W[Ua[c]],0,W.RGBA,b,b,0,W.RGBA,W.UNSIGNED_BYTE,null);W.bindTexture(g,null);a.width=3*b;a.height=2*b};f.set_filters=function(a,
b,g){var c=a.w_target;W.bindTexture(c,a.w_texture);b&&W.texParameteri(c,W.TEXTURE_MIN_FILTER,b);g&&W.texParameteri(c,W.TEXTURE_MAG_FILTER,g);W.bindTexture(c,null)};f.resize=function(a,b,g){b=Math.max(b,1);g=Math.max(g,1);if(a.width!=b||a.height!=g){switch(a.type){case f.TT_RB_RGBA:W.bindRenderbuffer(W.RENDERBUFFER,a.w_renderbuffer);W.renderbufferStorage(W.RENDERBUFFER,W.RGB565,b,g);W.bindRenderbuffer(W.RENDERBUFFER,null);break;case f.TT_RB_DEPTH:W.bindRenderbuffer(W.RENDERBUFFER,a.w_renderbuffer);
W.renderbufferStorage(W.RENDERBUFFER,ea(Ba.depth_bits),b,g);W.bindRenderbuffer(W.RENDERBUFFER,null);break;case f.TT_RB_RGBA_MS:W.bindRenderbuffer(W.RENDERBUFFER,a.w_renderbuffer);W.renderbufferStorageMultisample(W.RENDERBUFFER,Da.msaa_samples,W.RGBA8,b,g);W.bindRenderbuffer(W.RENDERBUFFER,null);break;case f.TT_RB_DEPTH_MS:W.bindRenderbuffer(W.RENDERBUFFER,a.w_renderbuffer);W.renderbufferStorageMultisample(W.RENDERBUFFER,Da.msaa_samples,ea(Ba.depth_bits),b,g);W.bindRenderbuffer(W.RENDERBUFFER,null);
break;default:var c=a.w_target;W.bindTexture(c,a.w_texture);var h=q(a),d=w(a),l=H(a);a.use_mipmap&&(Da.webgl2||(g=Math.max(b,g),b=L(g),g=L(g)),a.mipmap_count=Math.round(Math.log(Math.max(b,g))/Math.log(2)+.5));W.texImage2D(c,0,d,b,g,0,h,l,null);W.bindTexture(c,null)}b>Ba.max_texture_size||g>Ba.max_texture_size?ka.panic('Slink texture "'+a.type+'" has unsupported size: '+b+"x"+g+". Max available: "+Ba.max_texture_size+"x"+Ba.max_texture_size+"."):(a.width=b,a.height=g)}};f.create_texture_bpy=function(a,
b,g,c,h){var d=a.type;if("BLEND"==d)return null;var l=a.image,k=z();k.type=f.TT_RGBA_INT;k.width=1;k.height=1;if(Da.anisotropic_available){var e=a.b4w_anisotropic_filtering;"DEFAULT"===e&&(e=b);"OFF"!==e&&Da.anisotropic_filtering&&(b=parseFloat(e.split("x")[0]),k.anisotropic_filtering=b)}if("REPEAT"!=a.extension||a.b4w_shore_dist_map)k.repeat=!1;if(l){"IMAGE"==d&&"MOVIE"==l.source&&(k.is_movie=!0,k.video_tex_name=a.name,k.frame_start=a.frame_start,k.frame_offset=a.frame_offset,k.frame_duration=a.frame_duration,
k.use_auto_refresh=a.use_auto_refresh,k.use_cyclic=a.use_cyclic,k.movie_length=a.movie_length,k.use_nla=a.b4w_nla_video,0!=k.frame_offset&&ya.warn('Frame offset for texture "'+a.name+'" has a nonzero value. Can lead to undefined behaviour for mobile devices.'));k.source=d;b=Object(m.b)(h+l.filepath);if(b=pa(b,k))return b;G(k,l,h)}b=new Uint8Array([204,204,204,255]);switch(d){case "IMAGE":h=W.createTexture();l=W.TEXTURE_2D;W.bindTexture(l,h);W.texImage2D(l,0,W.RGBA,1,1,0,W.RGBA,W.UNSIGNED_BYTE,b);
break;case "NONE":if("NONE"==a.b4w_source_type)return null;h=W.createTexture();l=W.TEXTURE_2D;k.source=a.b4w_source_type;if("SCENE"==k.source){if(!a.b4w_source_id)return null;c=r._19("name",a.b4w_source_id,g);if(!c)return null;k.source_id=a.b4w_source_id;k.source_size=a.b4w_source_size;c._render_to_textures=c._render_to_textures||[];c._render_to_textures.push(k);W.bindTexture(l,h);W.texImage2D(l,0,W.RGBA,1,1,0,W.RGBA,W.UNSIGNED_BYTE,b)}else"CANVAS"==k.source&&(g=a.b4w_source_id,b=a.b4w_source_size,
k.source_id=g,k.enable_canvas_mipmapping=a.b4w_enable_canvas_mipmapping,a=document.createElement("canvas"),a.width=b,a.height=b,k.canvas_context=a.getContext("2d"),c in Xa||(Xa[c]={}),Xa[c][g]=k,W.bindTexture(l,h));break;case "ENVIRONMENT_MAP":h=W.createTexture();l=W.TEXTURE_CUBE_MAP;W.bindTexture(l,h);a="POSITIVE_X NEGATIVE_X POSITIVE_Y NEGATIVE_Y POSITIVE_Z NEGATIVE_Z".split(" ");for(c=0;6>c;c++)W.texImage2D(W["TEXTURE_CUBE_MAP_"+a[c]],0,W.RGBA,1,1,0,W.RGBA,W.UNSIGNED_BYTE,b);break;default:return ya.error('texture "'+
a.name+'" has unsupported type "'+d+'"'),null}k.w_texture=h;k.w_target=l;"NONE"==d?(k.enable_canvas_mipmapping?W.texParameteri(l,W.TEXTURE_MIN_FILTER,Ia[Da.texture_min_filter]):W.texParameteri(l,W.TEXTURE_MIN_FILTER,W.LINEAR),k.anisotropic_filtering&&W.texParameterf(l,ga.get_aniso().TEXTURE_MAX_ANISOTROPY_EXT,k.anisotropic_filtering),"CANVAS"==k.source&&M(k)):(W.generateMipmap(l),W.bindTexture(l,null));return k};f.update_texture_canvas=M;f.update_video_texture=F;f.update_seq_video_texture=U;f.update_texture=
ha;f.calc_pot_size=L;f.is_texture=function(a){return a&&(a.w_texture||a.w_renderbuffer)?!0:!1};f.is_renderbuffer=function(a){return a&&a.w_renderbuffer?!0:!1};f.is_float=function(a){return a.type==f.TT_RGBA_FLOAT||a.type==f.TT_RGB_FLOAT?!0:!1};f.get_texture_texel_size=function(a){var b=0;switch(a.type){case f.TT_RGBA_INT:case f.TT_RGB_INT:b=4;break;case f.TT_RGBA_FLOAT:case f.TT_RGB_FLOAT:b=32;break;case f.TT_DEPTH:b=3;break;case f.TT_RB_RGBA:case f.TT_RB_DEPTH:b=2;break;case f.TT_RB_RGBA_MS:b=4*
Da.msaa_samples;break;case f.TT_RB_DEPTH_MS:b=3*Da.msaa_samples}return b};f.cleanup=function(){if(!Da.seq_video_fallback)for(var a in Wa)for(var b in Wa[a])Wa[a][b].video_file.pause(),Wa[a][b].video_file.src="",Wa[a][b].video_file.load();La.textures.length=0;La.loaded_status.length=0;Xa={};Wa={}};f.pause=function(){for(var a in Wa)for(var b in Wa[a]){var g=Wa[a][b];ra(g)&&h(g)}};f.reset=function(){for(var a in Wa)for(var b in Wa[a])ia(Wa[a][b])};f.play=function(a){for(var b in Wa)for(var g in Wa[b]){var c=
Wa[b][g];a&&!c.video_was_stopped||D(c)}};f.get_video_texture=function(a,b){return b in Wa&&a in Wa[b]?Wa[b][a]:null};f.video_allow_nla=function(a){return a.use_nla};f.play_video=D;f.pause_video=h;f.reset_video=ia;f.set_frame_video=function(a,b,g){return g in Wa&&a in Wa[g]?(a=Wa[g][a],a.video_file?a.video_file.currentTime=b/a.fps:a.seq_video&&(a.seq_cur_frame=b,U(a)),!0):!1};f.video_is_played=ra;f.video_update_is_available=za;f.video_get_current_frame=function(a){return a.video_file||a.seq_video?
a.video_file?Math.round(a.video_file.currentTime*a.fps):a.seq_cur_frame:0};f.video_get_start_frame=function(a){return a.video_file||a.seq_video?a.video_file?a.frame_offset:P(a,a.frame_offset):0};f.video_get_end_frame=function(a){if(!a.video_file&&!a.seq_video)return 0;var b=Math.min(a.frame_duration,a.movie_length-a.frame_offset);return a.video_file?a.frame_offset+b:P(a,a.frame_offset+b)};f.seq_video_get_discrete_timemark=function(a,b){return Math.round(b*a.seq_fps*(O.get_framerate()/a.fps))};f.video_get_duration=
function(a){return Math.min(a.frame_duration,a.movie_length-a.frame_offset)};f.video_frame_to_seq_frame=P;f.get_canvas_context_by_object=function(a,b){var g=oa(a,b);return g&&"CANVAS"==g.source?g.canvas_context:null};f.get_texture_by_name=oa;f.set_texture_by_name=Q;f.get_texture_names=function(a){var b=[];if(na.is_dynamic(a))va(a,b);else{a=a.meta_objects;for(var g=0;g<a.length;g++)va(a[g],b)}return b};f.share_batch_canvas_textures=function(a){for(var b={},g=0;g<a.length;g++){for(var c=a[g].textures,
h=a[g].texture_names,f=[],d=[],l=0;l<c.length;l++){var k=c[l],e=h[l];if("CANVAS"==k.source)if(e in b)k=b[e];else{var m=c[l],k=z();k.source="CANVAS";k.width=m.width;k.height=m.height;k.enable_canvas_mipmapping=m.enable_canvas_mipmapping;k.type=m.type;m=document.createElement("canvas");m.width=k.width;m.height=k.height;k.canvas_context=m.getContext("2d");k.w_target=W.TEXTURE_2D;k.w_texture=W.createTexture();W.bindTexture(W.TEXTURE_2D,k.w_texture);k.enable_canvas_mipmapping?W.texParameteri(W.TEXTURE_2D,
W.TEXTURE_MIN_FILTER,Ia[Da.texture_min_filter]):W.texParameteri(W.TEXTURE_2D,W.TEXTURE_MIN_FILTER,W.LINEAR);W.texParameteri(W.TEXTURE_2D,W.TEXTURE_MAG_FILTER,W.LINEAR);W.bindTexture(W.TEXTURE_2D,null);m=k;m.canvas_context.drawImage(c[l].canvas_context.canvas,0,0);M(m);b[e]=k}f.push(k);d.push(e)}a[g].textures=f}};f.extract_col_ramps_data=function(a,b){for(var g=[],c=0;c<a.length;c++)Ga(a[c].data.value.color_ramp,b,g);return new Uint8Array(g.map(function(a){return r.M(255*a,0,255)}))};f.calc_color_ramp_data=
Ga;f.extract_vec_curves_data=function(a,b){for(var g=new Float32Array(3),c=new Float32Array(3),h=[],f=0;f<a.length;f++){for(var d=a[f].data.value,k=[],e=d.curve_mapping.curves_data,m=d.curve_mapping.curve_extend,q=d.curve_mapping.curves_handle_types,d=0;d<e.length;d++){for(var D=m[d],v=e[d],w=[],p=q[d],z=0;z<v.length;z++)w.push([new Float32Array(3),new Float32Array(v[z].concat(0)),new Float32Array(3)]);Ja.calchandle_curvemap(w[0],null,w[1],p[0],p[0]);for(z=1;z<w.length-1;z++)Ja.calchandle_curvemap(w[z],
w[z-1],w[z+1],p[z],p[z]);Ja.calchandle_curvemap(w[w.length-1],w[w.length-2],null,p[w.length-1],p[w.length-1]);if(2<w.length){if("AUTO"==p[0]){l.subtract(w[0][2],w[0][1],g);z=l.length(g);l.copy(w[1][0],c);c[0]<w[0][1][0]&&(c[0]=w[0][1][0]);l.subtract(c,w[0][1],c);var H=l.length(c);1E-8<H&&(l.scale(c,z/H,c),l.add(w[0][1],c,w[0][2]),l.subtract(w[0][1],c,w[0][0]))}v=w.length-1;"AUTO"==p[0]&&(l.subtract(w[v][0],w[v][1],g),z=l.length(g),l.copy(w[v-1][2],c),c[0]>w[v][1][0]&&(c[0]=w[v][1][0]),l.subtract(c,
w[v][1],c),H=l.length(c),1E-8<H&&(l.scale(c,z/H,c),l.add(w[v][1],c,w[v][0]),l.subtract(w[v][1],c,w[v][2])))}for(v=0;v<w.length-1;v++)Ja.correct_bezpart(w[v][1],w[v][2],w[v+1][0],w[v+1][1]);v=[];3>=e.length?(z=Math.round(-b/2),p=Math.round(b/2)):(z=0,p=b);for(;z<p;z++){var H=z/(p-1),L=ba(w,H,!1),n=Ea(w,H,!1);L&&n?v.push(Ja.bezier(H,L[1],L[2],n[0],n[1],.001)):n&&!L?"EXTRAPOLATED"==D?(H=n[1][0]==n[2][0]?n[1][1]:Ja.linear(H,n[1],n[2]),v.push(H)):v.push(n[1][1]):L&&!n&&("EXTRAPOLATED"==D?(H=L[0][0]==L[1][0]?
L[1][1]:Ja.linear(H,L[0],L[1]),v.push(H)):v.push(L[1][1]))}k.push(v)}h.push(k)}g=[];for(z=0;z<h.length;z++)for(k=h[z],d=0;d<k[0].length;d++)3>=k.length?(c=r.M(127.5*(k[0][d]+1),0,255),f=r.M(127.5*(k[1][d]+1),0,255),e=r.M(127.5*(k[2][d]+1),0,255),v=255):(c=r.M(255*k[0][d],0,255),f=r.M(255*k[1][d],0,255),e=r.M(255*k[2][d],0,255),v=r.M(255*k[3][d],0,255)),g.push(c,f,e,v);return new Uint8Array(g)};f.create_color_ramp_texture=function(a,b){var g=J(f.TT_RGBA_INT,!1);g.source="NODE_TEX";g.repeat=!1;ha(g,
{width:b,height:a.length/(4*b),data:a});return g};f.change_image=function(a,b,c,h,f){var d=Object(m.b)(f);if("WORLD"!=a.type){var l=pa(d,b);if(!l){l=z();l.type=b.type;l.anisotropic_filtering=b.anisotropic_filtering;l.source=b.source;l.source_id=b.source_id;l.width=b.width;l.height=b.height;l.compress_ratio=b.compress_ratio;l.source_size=b.source_size;l.enable_canvas_mipmapping=b.enable_canvas_mipmapping;l.canvas_context=b.canvas_context;l.w_target=b.w_target;l.w_texture=b.w_texture;l.w_renderbuffer=
b.w_renderbuffer;l.is_movie=b.is_movie;l.vtex_data_id=b.vtex_data_id;l.video_file=b.video_file;l.video_tex_name=b.video_tex_name;l.movie_length=b.movie_length;l.fps=b.fps;l.frame_start=b.frame_start;l.frame_offset=b.frame_offset;l.frame_duration=b.frame_duration;l.need_resize=b.need_resize;l.scale_fac=b.scale_fac;l.seq_video=b.seq_video;l.seq_movie_length=b.seq_movie_length;l.seq_fps=b.seq_fps;l.seq_cur_frame=b.seq_cur_frame;l.seq_video_played=b.seq_video_played;l.seq_last_discrete_mark=b.seq_last_discrete_mark;
l.video_was_stopped=b.video_was_stopped;l.use_auto_refresh=b.use_auto_refresh;l.use_cyclic=b.use_cyclic;l.use_nla=b.use_nla;l.repeat=b.repeat;l.img_filepath=b.img_filepath;l.img_full_filepath=b.img_full_filepath;l.img_uuid=b.img_uuid;l.img_source=b.img_source;l.img_name=b.img_name;l.img_comp_method=b.img_comp_method;var k=l;W.bindTexture(b.w_target,b.w_texture);var e=W.getTexParameter(b.w_target,W.TEXTURE_MAG_FILTER),v=W.getTexParameter(b.w_target,W.TEXTURE_MIN_FILTER),q=W.getTexParameter(b.w_target,
W.TEXTURE_WRAP_S);b=W.getTexParameter(b.w_target,W.TEXTURE_WRAP_T);k.w_texture=W.createTexture();W.bindTexture(k.w_target,k.w_texture);W.texParameteri(k.w_target,W.TEXTURE_MAG_FILTER,e);W.texParameteri(k.w_target,W.TEXTURE_MIN_FILTER,v);W.texParameteri(k.w_target,W.TEXTURE_WRAP_S,q);W.texParameteri(k.w_target,W.TEXTURE_WRAP_T,b);W.bindTexture(k.w_target,null);E(l,f,d);ha(l,h,0)}Q(a,c,l)}else l=b,E(l,f,d),ha(l,h,0),g.update_cube_sky_dim(a,l),g.update_sky_texture(a)};f.cleanup_unused=ta;f.get_batch_texture=
function(a){return a.texture._render};f.reset_mod=function(){W=null};f.get_img_textures=function(){return La.textures};f.get_cache_loaded_status=function(a){a=La.textures.indexOf(a);return-1==a?!1:La.loaded_status[a]};f.set_cache_loaded_status=function(a,b){var g=La.textures.indexOf(a);-1!=g&&(La.loaded_status[g]=b)}});t.a=e},function(C,t,e){C=e(0);var R=e(4);e=Object(C.a)("__time",function(e,n){function y(){return-1!==d.animation.framerate?d.animation.framerate:a}var d=Object(R.a)(e),k=0,I=0,A=[],
r=0,p=0,u=[],a=-1,B=0;n.set_timeline=function(a){k=a;I=performance.now();for(a=0;a<A.length;a++){var c=A[a];k>c.expire_time&&(A.splice(a,1),a--,c.callback())}for(a=0;a<u.length;a++){var c=u[a],d=1-(c.expire_time-k)/c.duration,d=Math.min(d,1);c.callback(c.from+d*(c.to-c.from));1==d&&(u.splice(a,1),a--)}};n.get_timeline=function(){return k};n.set_delta=function(a){B=a};n.get_delta=function(){return B};n.set_timeout=function(a,c){var d;r++;d=r;var b={id:d,callback:a,expire_time:k+(performance.now()-
I+c)/1E3};A.push(b);return d};n.clear_timeout=function(a){for(var c=0;c<A.length;c++)if(A[c].id==a){A.splice(c,1);break}};n.clear_animation=function(a){for(var c=u.length;c--;)if(u[c].id==a){u.splice(c,1);break}};n.animate=function(a,c,d,b){d/=1E3;var f;p++;f=p;u.push({id:f,callback:b,from:a,to:c,expire_time:k+d,duration:d});b(a);return f};n.reset=function(a){I=k=0;A.length=0;p=r=u.length=0};n.get_framerate=y;n.set_framerate=function(d){a=d};n.get_frame=function(a){return a*y()}});t.a=e},function(C,
t,e){C=e(0);var R=e(5),V=e(4),n=e(62),y=e(89),d=e(9),k=e(1),I=e(8),A=e(10),r=e(11),p=e(13),u=e(6),a=e(2),B=e(3),l=e(37),c=e(73),m=e(16);e=Object(C.a)("__physics",function(b,f){function e(a,b){for(var g=a.cons_descends,c=0;c<g.length;c++)g[c].physics_settings.use_collision_compound&&b.push(g[c]),e(g[c],b);return null}function fa(a,b,g){for(var c=a._physics.bundles,h=0;h<c.length;h++)for(var f=c[h].physics,d=0;d<f.collision_tests.length;d++){var l=f.collision_tests[d];"ANY"!=l.collision_id&&g!=l.collision_id||
ea(l,a,b)}}function z(a,b,g){if(ba.is_active(a))switch(b){case ba.IN_LOADED:var c=G(a);c._physics.worker_loaded=!0;g=Date.now()-performance.now();ba.post_msg(a,ba.OUT_INIT,g,Aa.max_fps,Aa.calc_fps?xa.fps_measurement_interval:0);break;case ba.IN_LOG:ta.log_raw("URANIUM:",g.slice(1));break;case ba.IN_ERROR:ta.error(g);break;case ba.IN_FBMSG:Ga.fbmsg.apply(this,g.slice(1));break;case ba.IN_TRANSFORM:(a=J(g.body_id))&&ma(a,g.time,g.trans,g.quat,g.linvel,g.angvel);break;case ba.IN_PROP_OFFSET:(a=J(g.chassis_hull_body_id))&&
u.t(g.trans,1,g.quat,a.vehicle.prop_offsets[g.prop_ind]);break;case ba.IN_FLOATER_BOB_TRANSFORM:if(c=J(g[1]))a=g[4],c=c.floater.bobs[g[2]],ka.set_translation(c,g[3]),ka.set_rotation(c,a),ka.update_transform(c);break;case ba.IN_VEHICLE_SPEED:if(a=J(g[1]))a.vehicle.speed=g[2];break;case ba.IN_COLLISION:c=G(a);M(c,g.body_id_a,g.body_id_b,g.result,null,null,0);break;case ba.IN_COLLISION_POS_NORM:c=G(a);M(c,g.body_id_a,g.body_id_b,g.result,g.coll_point,g.coll_norm,g.coll_dist);break;case ba.IN_COLLISION_IMPULSE:if(a=
J(g[1]))a=a.physics,a.col_imp_test_cb&&a.col_imp_test_cb(g[2]);break;case ba.IN_RAY_HIT:case ba.IN_RAY_HIT_POS_NORM:c=G(a);if(a=c._physics.ray_tests[g.id])if(c=J(g.body_id_hit),b==ba.IN_RAY_HIT)b=a.callback,b(a.id,g.hit_fract,c,g.hit_time);else{b=g.hit_fract;var f=g.hit_time,d=g.hit_pos,l=a.callback;d?l(a.id,b,c,f,d,g.hit_norm):l(a.id,b,c,f)}break;case ba.IN_REMOVE_RAY_TEST:h(g.id);break;case ba.IN_PING:a=O.indexOf(a);c=(g[2]-g[1]).toFixed(3);b=(performance.now()-g[2]).toFixed(3);g=(performance.now()-
g[1]).toFixed(3);ta.log("Physics #"+a+" Ping: OUT "+c+" ms, IN "+b+" ms, ALL "+g+" ms");break;case ba.IN_FPS:ya=g[1];break;case ba.IN_DEBUG_STATS:a=O.indexOf(a);ta.log("Worker: #"+String(a));ta.log(g[1]);break;default:ta.error("Wrong message: "+b)}}function G(a){for(var b=0;b<O.length;b++)if(O[b]==a)return wa[b]}function E(a){for(var b=0;b<wa.length;b++)if(wa[b]==a)return O[b]}function J(a){return qa[a]||null}function M(a,b,g,c,h,f,d){a=a._physics.bundles;for(var l=0;l<a.length;l++)for(var k=a[l].physics,
e=0;e<k.collision_tests.length;e++){for(var m=k.collision_tests[e],v=m.pairs,q=!1,w=0;w<v.length;w++){var D=v[w];if(D[0]===b&&D[1]===g){m.pair_results[w]=c;q=!0;break}}q&&(v=F(m),h&&m.body_id_src!=b&&(q=h,w=f,D=d,q[0]+=w[0]*D,q[1]+=w[1]*D,q[2]+=w[2]*D,w[0]*=-1,w[1]*=-1,w[2]*=-1),q=v?m.body_id_src==b?J(g):J(b):null,m.callback(v,q,h,f,d))}}function F(a){a=a.pair_results;for(var b=!1,g=0;g<a.length;g++)b=b||a[g];return b}function U(){g.body++;return g.body}function K(a,b,g){g=g?a.physics.body_id:U();
var c=b.submesh;return{body_id:g,submesh:c,positions:c.va_frames[0].a_position,indices:c.indices||null,trans:u.j(a.render.world_tsr,Da),friction:b.friction,restitution:b.elasticity,collision_id:b.collision_id,collision_id_num:t(b.collision_id),collision_margin:b.collision_margin,collision_group:b.collision_group,collision_mask:b.collision_mask}}function t(a){var b=Ja.indexOf(a);return-1==b?(Ja.push(a),Ja.length-1):b}function v(a,b){return{body_id:a,type:b,mass:0,is_ghost:!1,simulated:!0,is_vehicle:!1,
is_character:!1,is_floater:!1,cons_id:null,collision_id:"",collision_id_num:0,collision_callbacks:{},collision_tests:[],col_imp_test_cb:null,curr_time:0,curr_tsr:u.b(),linvel:new Float32Array(3),angvel:new Float32Array(3),cached_trans:new Float32Array(3),cached_quat:new Float32Array(4),navmesh:null}}function Y(a,b){switch(a){case "BOX":var g=b.bb_local;break;case "CYLINDER":g=b.bcyl_local;break;case "CONE":g=b.bcon_local;break;case "SPHERE":g=b.bs_local;break;case "CAPSULE":g=b.bcap_local}return g}
function ha(a){if(!a)return null;var b={};"number"===typeof a.min_x&&(b.min_x=a.min_x);"number"===typeof a.min_y&&(b.min_y=a.min_y);"number"===typeof a.min_z&&(b.min_z=a.min_z);"number"===typeof a.max_x&&(b.max_x=a.max_x);"number"===typeof a.max_y&&(b.max_y=a.max_y);"number"===typeof a.max_z&&(b.max_z=a.max_z);"object"===typeof a.center&&(b.center=a.center);"number"===typeof a.radius&&(b.radius=a.radius);"number"===typeof a.height&&(b.height=a.height);return b}function S(a){return a.physics&&a.physics.cons_id}
function L(a,b,c,h,f,d,l,k,e,m){var v;g.constraint++;v=g.constraint.toString(16);var w=b.physics.body_id;f=f.physics.body_id;var D=q(w);ba.post_msg(D,ba.OUT_APPEND_CONSTRAINT,v,a,k,w,c,h,f,d,l,e,m);b.physics.cons_id=v}function q(a){for(var b=0;b<wa.length;b++)for(var g=wa[b]._physics.bundles,c=0;c<g.length;c++)if(g[c].physics.body_id==a)return O[b];return null}function w(a){var b;if(b=(b=a.physics)?0===b.mass?!0:!0===b.is_ghost?!0:!1===b.simulated?!0:"RIGID_BODY"!==b.type&&"DYNAMIC"!==b.type?!0:!1:
!1){b=u.j(a.render.world_tsr,Da);var g=u.g(a.render.world_tsr,Ba);b=b[0]!=a.physics.cached_trans[0]||b[1]!=a.physics.cached_trans[1]||b[2]!=a.physics.cached_trans[2]||g[0]!=a.physics.cached_quat[0]||g[1]!=a.physics.cached_quat[1]||g[2]!=a.physics.cached_quat[2]||g[3]!=a.physics.cached_quat[3]}if(b){b=a.physics;var c=a.render,g=ba.get_msg_cache(ba.OUT_SET_TRANSFORM);g.body_id=b.body_id;var h=u.j(c.world_tsr,g.trans),c=u.g(c.world_tsr,g.quat);B.copy(h,b.cached_trans);I.copy(c,b.cached_quat);"DYNAMIC"==
b.type&&I.identity(g.quat);b=q(b.body_id);ba.post_msg(b,ba.OUT_SET_TRANSFORM)}a=a.cons_descends;for(b=0;b<a.length;b++)w(a[b])}function ea(a,b,g){var c=a.pairs,h=a.pair_results,f=a.body_id_src,d=[],l=a.collision_id;d||ja.panic("At least one destination required");for(var k=0;k<b._physics.bundles.length;k++){var e=b._physics.bundles[k];if("ANY"==l||e.physics.collision_id==l&&"NAVMESH"!=e.physics.type)e=e.physics.body_id,d&&-1==d.indexOf(e)&&d.push(e)}for(b=0;b<d.length;b++)l=d[b],f<l&&!H(c,f,l)?(c.push([f,
l]),h.push(!1)):f>l&&!H(c,l,f)&&(c.push([l,f]),h.push(!1));ba.post_msg(g,ba.OUT_ACTIVATE,f);ba.post_msg(g,ba.OUT_APPEND_COLLISION_TEST,c,a.calc_pos_norm)}function H(a,b,g){for(var c=0;c<a.length;c++)if(a[c][0]==b&&a[c][1]==g)return!0;return!1}function D(a){if(a.physics&&a.physics.col_imp_test_cb){a=a.physics;var b=q(a.body_id);ba.post_msg(b,ba.OUT_CLEAR_COLLISION_IMPULSE_TEST,a.body_id);a.col_imp_test_cb=null}}function h(a){var b=ia(a),g=ra(a),b=b._physics;b.ray_tests[a]&&(delete b.ray_tests[a],b.ray_tests_arr.splice(b.ray_tests_arr.indexOf,
1),ba.post_msg(g,ba.OUT_REMOVE_RAY_TEST,a))}function ia(a){for(var b=0;b<wa.length;b++){var g=wa[b];if(g._physics.ray_tests[a])return g}return null}function ra(a){for(var b=0;b<wa.length;b++)if(wa[b]._physics.ray_tests[a])return O[b];return null}function za(a,b,g){if(b.steering_wheel){a=a.physics.body_id;var c=b.engine_force*b.force_max,h=b.brake_force*b.brake_max,f=-b.steering*b.steering_max*2*Math.PI/b.steering_ratio;b.inverse_control&&(f*=-1);switch(b.type){case 10:ba.post_msg(g,ba.OUT_UPDATE_CAR_CONTROLS,
a,c,h,f);break;case 20:ba.post_msg(g,ba.OUT_UPDATE_BOAT_CONTROLS,a,c,h,f)}}}function P(a){return a.is_vehicle&&"CHASSIS"==a.vehicle_settings.part}function oa(a){return a.is_vehicle&&"HULL"==a.vehicle_settings.part}function Q(a){return"NAVMESH"==a.physics_settings.physics_type}function da(a){return a.is_floating&&"MAIN_BODY"==a.floating_settings.part}var ja=Object(R.a)(b),va=Object(V.a)(b),Ga=Object(n.a)(b),ba=Object(y.a)(b),Ea=Object(d.a)(b),ta=Object(k.a)(b),X=Object(A.a)(b),pa=Object(r.a)(b),ka=
Object(p.a)(b),Ca=Object(c.a)(b),C=Object(m.a)(b),Aa=va.physics,xa=va.defaults,ga=va.assets,ya=0,O=[],wa=[],qa={},na=[],Ja=["ANY"],g={body:0,constraint:0,ray_test:0},Da=new Float32Array(3);new Float32Array(3);var Ba=new Float32Array(4),Ta=u.b();u.b();f.init_scene_physics=function(a){a._physics={worker_loaded:!1,bundles:[],ray_tests:{},ray_tests_arr:[]};var b=Aa.uranium_path;ga.prevent_caching&&(b+="?v="+Object(l.c)());ta.log("%cLOAD PHYSICS","color: #0a0",Aa.use_workers?"Using Separate Worker Thread,":
"Using Same Thread,","Max FPS: "+Aa.max_fps);ta.log("%cPHYSICS PATH","color: #0a0",b);var g=ba.create_worker(b,!Aa.use_workers);ba.attach_handler(g,z);O.push(g);wa.push(a);Aa.ping&&setInterval(function(){ba.post_msg(g,ba.OUT_PING,performance.now())},1E3)};f.check_worker_loaded=function(a){return a._physics?a._physics.worker_loaded:!0};f.cleanup=function(){for(var a=0;a<O.length;a++)ba.terminate(O[a]);O.length=0;wa.length=0;qa={};na.length=0;Ja=["ANY"];for(var b in g)g[b]=0};f.append_object=function(a,
b){if(b._physics){var g=a.physics_settings,c=E(b),h=[];g.use_collision_compound&&e(a,h);g=b._physics.bundles;if(P(a)||oa(a)||a.is_character||da(a)||a.use_obj_physics){var f=Q(a);if(f){var d,h=U(),h=v(h,"NAVMESH"),l=Ea.get_scene_data(a,b).batches;h.navmesh=null;for(d=0;d<l.length;d++){var k=l[d];if("PHYSICS"==k.type){h.navmesh=Ca.navmesh_build_from_bufs_data(k.bufs_data);break}}d=h}else h=fb(a,h,!1),ba.post_msg(c,ba.OUT_APPEND_BOUNDING_BODY,h.body_id,h.trans,h.quat,h.physics_type,h.is_ghost,h.disable_sleeping,
h.mass,h.velocity_min,h.velocity_max,h.damping,h.rotation_damping,h.collision_id_num,h.collision_margin,h.collision_group,h.collision_mask,h.bounding_type,h.worker_bounding,h.size,h.friction,h.restitution,h.comp_children_params,h.correct_bound_offset),qa[h.body_id]=a,na.push(a),l=v(h.body_id,"BOUNDING"),l.type=h.physics_type,l.mass=h.mass,l.is_ghost=h.is_ghost,l.collision_id=h.collision_id,l.collision_id_num=h.collision_id_num,d=l;a.physics=d;l={batch:null,physics:d};f||(g.push(l),fa(b,c,d.collision_id))}else for(h=
Ea.get_scene_data(a,b).batches,f=0;f<h.length;f++){l=h[f];if(!(d="PHYSICS"!=l.type))a:{d=b._physics.bundles;for(k=0;k<d.length;k++){var m=d[k].batch;if(m&&m.id==l.id){d=!0;break a}}d=!1}if(!d)if(l.submesh.base_length)if(l.water&&b._render.water_params){var q=l,l=b;d=c;k=l._render.water_params;ba.post_msg(d,ba.OUT_APPEND_WATER,k.water_level);if(q.water_dynamics){m={};m.dst_noise_scale0=q.dst_noise_scale0;m.dst_noise_scale1=q.dst_noise_scale1;m.dst_noise_freq0=q.dst_noise_freq0;m.dst_noise_freq1=q.dst_noise_freq1;
m.dir_min_shore_fac=q.dir_min_shore_fac;m.dir_freq=q.dir_freq;m.dir_noise_scale=q.dir_noise_scale;m.dir_noise_freq=q.dir_noise_freq;m.dir_min_noise_fac=q.dir_min_noise_fac;m.dst_min_fac=q.dst_min_fac;m.waves_hor_fac=q.waves_hor_fac;var q=k.waves_height,w=k.waves_length;k.shoremap_image?ba.post_msg(d,ba.OUT_ADD_WATER_WRAPPER,m,k.shoremap_size[0],k.shoremap_size[1],k.shoremap_center[0],k.shoremap_center[1],k.max_shore_dist,q,w,k.shoremap_tex_size,l._render.shore_distances):ba.post_msg(d,ba.OUT_ADD_WATER_WRAPPER,
m,0,0,0,0,0,q,w,0,null)}}else l.use_ghost?d=Ka(a,l,c):(k=c,d=K(a,l),ba.post_msg(k,ba.OUT_APPEND_STATIC_MESH_BODY,d.body_id,d.positions,d.indices,d.trans,d.friction,d.restitution,d.collision_id_num,d.collision_margin,d.collision_group,d.collision_mask),k=v(d.body_id,"STATIC_MESH"),k.collision_id=d.collision_id,k.collision_id_num=d.collision_id_num,d=k),a.physics=d,l={batch:l,physics:d},g.push(l),fa(b,c,d.collision_id);else ta.error("Object "+a.name+" has collision material with no assigned vertices")}if(P(a)||
oa(a)){g=a.physics.body_id;P(a)?(a.vehicle.type=10,ba.post_msg(c,ba.OUT_APPEND_CAR,g,a.vehicle.suspension_compression,a.vehicle.suspension_stiffness,a.vehicle.suspension_damping,a.vehicle.wheel_friction,a.vehicle.max_suspension_travel_cm)):oa(a)&&(a.vehicle.type=20,ba.post_msg(c,ba.OUT_APPEND_BOAT,g,a.vehicle.floating_factor,a.vehicle.water_lin_damp,a.vehicle.water_rot_damp));if(a.vehicle.props)switch(f=a.vehicle.props,a.vehicle.type){case 10:Xa(f[0],a,g,!0,c);Xa(f[1],a,g,!0,c);Xa(f[2],a,g,!1,c);
Xa(f[3],a,g,!1,c);break;case 20:for(h=0;h<f.length;h++)Xa(f[h],a,g,!1,c)}za(a,a.vehicle,c)}else a.is_character?(f=a.render,g=a.physics,f=f.bb_local.max_z-f.bb_local.min_z,h=g.body_id,q=a.character_settings,l=q.walk_speed,d=q.run_speed,k=q.step_height,m=q.jump_strength,q=q.waterline,w=Wa(a),ba.post_msg(c,ba.OUT_APPEND_CHARACTER,h,w,f,l,d,k,m,q),g.is_character=!0):da(a)&&W(a,c);for(f=0;f<na.length;f++)c=na[f],c.physics&&Ia(c)}};f.find_obj_by_body_id=J;var ma=function(){var a=B.create();return function(b,
g,c,h,f,d){var l=b.physics;l.curr_time=g;b=u.i(b.render.world_tsr,a);u.t(c,b,h,l.curr_tsr);B.copy(f,l.linvel);B.copy(d,l.angvel)}}();f.update=function(a,b){for(var g=0;g<O.length;g++){var c=O[g],h=a,f=b;c&&ba.is_fallback(c)&&ba.post_msg(c,ba.OUT_UPDATE_WORLD,h,f);for(f=0;f<na.length;f++){var d=na[f],l=d.physics;if(l.simulated&&l.curr_time){var k=ba.is_fallback(c)?h-l.curr_time:performance.now()/1E3-l.curr_time,k=Math.min(k,10/Aa.max_fps),k=k-1/Aa.max_fps;xa.no_phy_interp_hack&&(k=0);var e=Ta;u.n(l.curr_tsr,
k,l.linvel,l.angvel,Ta);ka.set_tsr(d,e);ka.update_transform(d);w(d);if(d.vehicle)for(var l=d,k=l.vehicle.props,e=l.render.world_tsr,m=Ta,q=0;q<k.length;q++){var v=k[q];u.q(e,l.vehicle.prop_offsets[q],m);ka.set_tsr(v,m);ka.update_transform(v)}d.vehicle&&d.vehicle.steering_wheel&&Na(d);d.vehicle&&d.vehicle.speedometer&&Va(d);d.vehicle&&d.vehicle.tachometer&&Z(d)}}ba.post_msg_arr(c);c=wa[g];(h=c._render.water_params)&&0<h.waves_height&&(c=X.get_subs(c,pa.MAIN_OPAQUE),h=B.length(c.wind)||1,ba.post_msg(O[g],
ba.OUT_SET_WATER_TIME,c.time*h))}};f.get_active_scene=function(){return wa[0]};f.pause=function(){for(var a=0;a<O.length;a++)ba.post_msg(O[a],ba.OUT_PAUSE)};f.resume=function(){for(var a=0;a<O.length;a++)ba.post_msg(O[a],ba.OUT_RESUME)};var Ka=function(){var a=B.create();return function(b,g,c){var h=U(),f=g.submesh,d=f.va_frames[0].a_position,l=f.indices||null,f=g.collision_id,k=t(f),e=g.collision_margin,m=g.collision_group;g=g.collision_mask;b=u.j(b.render.world_tsr,a);ba.post_msg(c,ba.OUT_APPEND_GHOST_MESH_BODY,
h,d,l,b,k,e,m,g);c=v(h,"STATIC_MESH");c.is_ghost=!0;c.collision_id=f;c.collision_id_num=k;return c}}(),fb=function(){var a=I.create(),b=B.create();return function(g,c,h){var f=g.render,d=g.physics_settings,l=d.physics_type;if(h)a:{for(var k in qa)if(qa[k]===g){h=k;break a}h=-1}else h=U();if(!(0>=h)){if("CAMERA"==g.type){k=d.use_collision_bounds?d.collision_bounds_type:"BOX";var e=Y(k,f),m=.5,q=0}else if("EMPTY"==g.type)k="EMPTY",e=null,q=m=0;else{k=d.use_collision_bounds?d.collision_bounds_type:"BOX";
e=Y(k,f);m=u.i(f.world_tsr,b);if(1!=m[0]||1!=m[1]||1!=m[2])switch(q=e,k){case "BOX":q.min_x*=m[0];q.max_x*=m[0];q.min_y*=m[1];q.max_y*=m[1];q.min_z*=m[2];q.max_z*=m[2];break;case "CYLINDER":case "CONE":case "CAPSULE":q.height*=m[2];q.radius*=Math.max(m[0],m[1]);break;case "SPHERE":q.radius*=Math.max(m[0],m[1])}m=f.friction;q=f.elasticity}e=ha(e);return{body_id:h,trans:u.j(f.world_tsr,b),quat:u.g(f.world_tsr,a),is_ghost:d.use_ghost,disable_sleeping:d.use_sleep,mass:d.mass,velocity_min:d.velocity_min,
velocity_max:d.velocity_max,damping:d.damping,rotation_damping:d.rotation_damping,collision_id:g.collision_id,collision_id_num:t(g.collision_id),collision_margin:d.collision_margin,collision_group:d.collision_group,collision_mask:d.collision_mask,size:f.bs_local.radius,worker_bounding:e,correct_bound_offset:g.correct_bounding_offset,restitution:q,friction:m,bounding_type:k,physics_type:l,comp_children_params:La(f,c,k,e)}}}}(),La=function(){var a=I.create(),b=I.create(),g=u.b(),c=B.create();return function(h,
f,d,l){if(!f.length)return[];var k=[],e={};e.quat=new Float32Array([0,0,0,1]);e.trans=new Float32Array(3);e.worker_bounding=l;e.bounding_type=d;k.push(e);d=u.p(h.world_tsr,g);h=u.g(h.world_tsr,a);h=I.invert(h,a);for(l=0;l<f.length;l++){var e={},m=f[l],q=m.physics_settings.collision_bounds_type,v=new Float32Array(4),w=new Float32Array(3),D=u.j(m.render.world_tsr,c),p=u.g(m.render.world_tsr,b);u.D(D,d,w);I.multiply(h,p,v);e.trans=w;e.quat=v;e.bounding_type=q;e.worker_bounding=ha(Y(q,m.render));k.push(e)}return k}}(),
Xa=function(){var a=u.b(),b=B.create();return function(g,c,h,f,d){var l=u.j(g.render.world_tsr,b),k=u.p(c.render.world_tsr,a),e=new Float32Array(3);u.D(l,k,e);switch(c.vehicle.type){case 10:c=c.vehicle_settings;g=g.render.bb_local;ba.post_msg(d,ba.OUT_ADD_CAR_WHEEL,h,e,c.suspension_rest_length,c.roll_influence,(g.max_z-g.min_z)/2,f);break;case 20:ba.post_msg(d,ba.OUT_ADD_BOAT_BOB,h,e,g.bob_synchronize_pos)}}}(),Wa=function(){var a=I.create(),b=B.create(),g=B.create();return function(c){var h=u.g(c.render.world_tsr,
a);switch(c.type){case "CAMERA":b[0]=0;b[1]=-1;b[2]=0;B.transformQuat(b,h,b);g[0]=0;g[1]=0;g[2]=-1;break;case "MESH":b[0]=0;b[1]=0;b[2]=1;B.transformQuat(b,h,b);g[0]=0;g[1]=0;g[2]=1;break;case "EMPTY":b[0]=0,b[1]=1,b[2]=0,B.transformQuat(b,h,b),g[0]=0,g[1]=1,g[2]=0}b[1]=0;B.normalize(b,b);c=B.dot(b,g);return Math.acos(c)*(0<-b[0]*g[2]?-1:1)}}(),W=function(){var a=B.create(),b=u.b();return function(g,c){var h=g.physics.body_id;ba.post_msg(c,ba.OUT_APPEND_FLOATER,h,g.floater.floating_factor,g.floater.water_lin_damp,
g.floater.water_rot_damp);if(g.floater.bobs)for(var f=g.floater.bobs,d=0;d<f.length;d++){var l=f[d],k=u.j(l.render.world_tsr,a),e=u.p(g.render.world_tsr,b),m=new Float32Array(3);u.D(k,e,m);ba.post_msg(c,ba.OUT_ADD_FLOATER_BOB,h,m,l.bob_synchronize_pos)}g.physics.is_floater=!0}}();f.enable_simulation=function(a){(a=a.physics)||ja.panic("No object physics");if(!a.simulated){var b=a.body_id,g=q(b);a.simulated=!0;ba.post_msg(g,ba.OUT_ENABLE_SIMULATION,b)}};f.disable_simulation=function(a){(a=a.physics)||
ja.panic("No object physics");if(a.simulated){var b=a.body_id,g=q(b);a.simulated=!1;ba.post_msg(g,ba.OUT_DISABLE_SIMULATION,b)}};f.scene_has_physics=function(a){return!!a._physics};f.obj_has_physics=function(a){return!!a.physics};f.has_dynamic_physics=function(a){return(a=a.physics)&&a.simulated&&("RIGID_BODY"==a.type||"DYNAMIC"==a.type)&&0<a.mass&&0==a.is_ghost?!0:!1};f.has_simulated_physics=function(a){return(a=a.physics)&&a.simulated?!0:!1};f.set_gravity=function(a,b,g,c){a=a.physics.body_id;var h=
q(a);ba.post_msg(h,ba.OUT_SET_GRAVITY,a,b,g,c)};var Ia=function(){var b=I.create(),g=u.b(),c=u.b(),h=B.create();return function(f){if(!S(f))for(var d=0;d<f.physics_constraints.length;d++){var l=f.physics_constraints[d],k=l.target,e=l.pivot_type;if(k.physics){var m;m=new Float32Array([l.pivot_x,l.pivot_y,l.pivot_z]);var q;q=new Float32Array([l.axis_x,l.axis_y,l.axis_z]);q=a.Y(q,new Float32Array(4));"HINGE"==e&&I.rotateY(q,Math.PI/2,q);var v=u.m(g),v=u.v(m,v),v=u.r(q,v),v=u.q(f.render.world_tsr,v,g),
w=u.p(k.render.world_tsr,c),w=u.q(w,v,w),v=u.j(w,h),w=u.g(w,b),D={};D.use_limit_x=l.use_limit_x;D.use_limit_y=l.use_limit_y;D.use_limit_z=l.use_limit_z;D.use_angular_limit_x=l.use_angular_limit_x;D.use_angular_limit_y=l.use_angular_limit_y;D.use_angular_limit_z=l.use_angular_limit_z;D.limit_max_x=l.limit_max_x;D.limit_min_x=l.limit_min_x;D.limit_max_y=l.limit_max_y;D.limit_min_y=l.limit_min_y;D.limit_max_z=l.limit_max_z;D.limit_min_z=l.limit_min_z;D.limit_angle_max_x=l.limit_angle_max_x;D.limit_angle_min_x=
l.limit_angle_min_x;D.limit_angle_max_y=l.limit_angle_max_y;D.limit_angle_min_y=l.limit_angle_min_y;D.limit_angle_max_z=l.limit_angle_max_z;D.limit_angle_min_z=l.limit_angle_min_z;L(e,f,m,q,k,v,w,D,null,null)}}}}();f.has_constraint=S;f.apply_constraint=L;f.clear_constraint=function(a){a=a.physics;var b=a.cons_id,g=q(a.body_id);ba.post_msg(g,ba.OUT_REMOVE_CONSTRAINT,b);a.cons_id=null};f.pull_to_constraint_pivot=function(){var a=I.create(),b=u.b(),g=u.b(),c=u.b();return function(h,d,l,k,e,m){d=u.t(d,
1,l,b);e=u.t(e,1,m,g);u.p(d,d);u.q(e,d,d);ka.get_tsr(k,e);u.q(e,d,d);ka.set_tsr(h,d);ka.update_transform(h);k=u.j(h.render.world_tsr,c);e=u.g(h.render.world_tsr,a);f.set_transform(h,k,e)}}();f.set_transform=function(a,b,g){var c=a.physics,h=ba.get_msg_cache(ba.OUT_SET_TRANSFORM),f=u.j(a.render.world_tsr,h.trans);a=u.g(a.render.world_tsr,h.quat);u.t(f,1,a,c.curr_tsr);h.body_id=c.body_id;B.copy(b,h.trans);I.copy(g,h.quat);b=q(c.body_id);ba.post_msg(b,ba.OUT_SET_TRANSFORM)};f.sync_transform=w;f.sync_bounding=
function(a,b){var g=a.physics_settings,c=E(b),h=[];g.use_collision_compound&&e(a,h);(P(a)||oa(a)||a.is_character||da(a)||a.use_obj_physics)&&!Q(a)&&(g=fb(a,h,!0),ba.post_msg(c,ba.OUT_UPDATE_BOUNDING_BODY,g.body_id,g.trans,g.quat,g.physics_type,g.is_ghost,g.disable_sleeping,g.mass,g.velocity_min,g.velocity_max,g.damping,g.rotation_damping,g.collision_id_num,g.collision_margin,g.collision_group,g.collision_mask,g.bounding_type,g.worker_bounding,g.size,g.friction,g.restitution,g.comp_children_params,
g.correct_bound_offset))};f.sync_mesh=function(a,b){for(var g=E(b),c=a.scenes_data[0].batches,h=0;h<c.length;h++){var f=c[h];if("PHYSICS"==f.type){C.update_batch_geometry(c[h],c[h].submesh,a.render.shape_keys_values);if(f.use_ghost)ta.error("The function is not implemented for ghost objects yet");else{var d=g,f=K(a,f,!0);ba.post_msg(d,ba.OUT_UPDATE_STATIC_MESH_BODY,f.body_id,f.positions,f.indices,f.trans,f.friction,f.restitution,f.collision_id_num,f.collision_margin,f.collision_group,f.collision_mask)}fa(b,
g,a.physics.collision_id)}}};f.apply_velocity=function(a,b,g,c){var h=Da;Ua(a,b,g,c,h);a=a.physics.body_id;b=Math.abs(0);g=Math.abs(0);c=Math.abs(0);var f=Math.abs(h[0]),d=Math.abs(h[1]),l=Math.abs(h[2]);h[0]=f?h[0]/f*Math.max(f,b):0;h[1]=d?h[1]/d*Math.max(d,g):0;h[2]=l?h[2]/l*Math.max(l,c):0;b=q(a);ba.post_msg(b,ba.OUT_SET_LINEAR_VELOCITY,a,h[0],h[1],h[2])};f.apply_velocity_world=function(a,b,g,c){a=a.physics.body_id;var h=q(a);ba.post_msg(h,ba.OUT_SET_LINEAR_VELOCITY,a,b,g,c)};var Ua=function(){var a=
I.create();return function(b,g,c,h,f){f=f||new Float32Array(3);b=u.g(b.render.world_tsr,a);f[0]=g;f[1]=c;f[2]=h;return B.transformQuat(f,b,f)}}();f.apply_force=function(a,b,g,c,h){var f=Da;h?(f[0]=b,f[1]=g,f[2]=c):Ua(a,b,g,c,f);a=a.physics.body_id;b=q(a);ba.post_msg(b,ba.OUT_APPLY_CENTRAL_FORCE,a,f[0],f[1],f[2])};f.apply_torque=function(a,b,g,c){var h=Da;Ua(a,b,g,c,h);a=a.physics.body_id;b=q(a);ba.post_msg(b,ba.OUT_APPLY_TORQUE,a,h[0],h[1],h[2])};f.set_angular_velocity=function(a,b,g,c){a=a.physics.body_id;
var h=q(a);ba.post_msg(h,ba.OUT_SET_ANGULAR_VELOCITY,a,b,g,c)};f.set_character_move_dir=function(a,b,g){a=a.physics.body_id;var c=q(a);ba.post_msg(c,ba.OUT_SET_CHARACTER_MOVE_DIR,a,b,g)};f.set_character_move_type=function(a,b){var g=a.physics.body_id,c=q(g);ba.post_msg(c,ba.OUT_SET_CHARACTER_MOVE_TYPE,g,b)};f.set_character_walk_velocity=function(a,b){var g=a.physics.body_id,c=q(g);ba.post_msg(c,ba.OUT_SET_CHARACTER_WALK_VELOCITY,g,b)};f.set_character_run_velocity=function(a,b){var g=a.physics.body_id,
c=q(g);ba.post_msg(c,ba.OUT_SET_CHARACTER_RUN_VELOCITY,g,b)};f.set_character_fly_velocity=function(a,b){var g=a.physics.body_id,c=q(g);ba.post_msg(c,ba.OUT_SET_CHARACTER_FLY_VELOCITY,g,b)};f.character_jump=function(a){a=a.physics.body_id;var b=q(a);ba.post_msg(b,ba.OUT_CHARACTER_JUMP,a)};f.character_rotation_inc=function(a,b,g){a=a.physics.body_id;var c=q(a);ba.post_msg(c,ba.OUT_CHARACTER_ROTATION_INCREMENT,a,b,g)};f.set_character_rotation=function(a,b,g){a=a.physics.body_id;var c=q(a);ba.post_msg(c,
ba.OUT_SET_CHARACTER_ROTATION,a,b,g)};f.set_character_rotation_h=function(a,b){var g=a.physics.body_id,c=q(g);ba.post_msg(c,ba.OUT_SET_CHARACTER_HOR_ROTATION,g,b)};f.set_character_rotation_v=function(a,b){var g=a.physics.body_id,c=q(g);ba.post_msg(c,ba.OUT_SET_CHARACTER_VERT_ROTATION,g,b)};f.set_character_vert_move_dir_angle=function(a,b){var g=a.physics.body_id,c=q(g);ba.post_msg(c,ba.OUT_SET_CHARACTER_VERT_MOVE_DIR_ANGLE,g,b)};f.append_collision_test=function(a,b,g,c){var h=a.physics;if(!h.navmesh){for(var f=
h.body_id,d=0;d<h.collision_tests.length;d++)if(a=h.collision_tests[d],a.collision_id==b&&a.callback==g)return;a={body_id_src:f,calc_pos_norm:c||!1,collision_id:b,callback:g,pairs:[],pair_results:[]};h.collision_tests.push(a);b=q(f);g=G(b);ea(a,g,b)}};f.remove_collision_test=function(a,b,g){a=a.physics;for(var c=q(a.body_id),h=G(c),f=0;f<a.collision_tests.length;f++){var d=a.collision_tests[f];if(d.collision_id==b&&d.callback==g){if(F(d)){var l=B.set(0,0,0,Da);d.callback(!1,null,l,l,0)}a.collision_tests.splice(f,
1);f--;for(var l=c,k=h._physics.bundles,d=d.pairs,e=0;e<k.length;e++)for(var m=k[e].physics,v=0;v<m.collision_tests.length;v++)for(var w=m.collision_tests[v],D=0;D<w.pairs.length;D++)for(var p=w.pairs[D],r=0;r<d.length;r++){var z=d[r];p[0]==z[0]&&p[1]==z[1]&&(d.splice(r,1),r--)}d.length&&ba.post_msg(l,ba.OUT_REMOVE_COLLISION_TEST,d)}}};f.apply_collision_impulse_test=function(a,b){a.physics&&a.physics.col_imp_test_cb&&D(a);var g=a.physics,c=q(g.body_id);ba.post_msg(c,ba.OUT_APPLY_COLLISION_IMPULSE_TEST,
g.body_id);g.col_imp_test_cb=b};f.clear_collision_impulse_test=D;f.append_ray_test=function(a,b,c,h,f,d,l,k,e){var m;g.ray_test++;m=g.ray_test;a={id:m,body_id:a?a.physics.body_id:0,from:new Float32Array(b),to:new Float32Array(c),collision_id:h,collision_id_num:t(h),autoremove:d,calc_all_hits:l,calc_pos_norm:k,ign_src_rot:e,callback:f};b=q(a.body_id)||O[0];c=G(b)._physics;c.ray_tests[m]=a;c.ray_tests_arr.push(a);ba.post_msg(b,ba.OUT_APPEND_RAY_TEST,a.id,a.body_id,a.from,a.to,a.collision_id_num,a.autoremove,
a.calc_all_hits,a.calc_pos_norm,a.ign_src_rot);return m};f.remove_ray_test=h;f.change_ray_test_from_to=function(a,b,g){var c=ia(a),h=ra(a);(c=c._physics.ray_tests[a])&&!c.autoremove&&(c.from.set(b),c.to.set(g),ba.post_msg(h,ba.OUT_CHANGE_RAY_TEST_FROM_TO,a,b,g))};f.is_ray_test=function(a){return ia(a)._physics.ray_tests[a]?!0:!1};f.vehicle_throttle=function(a,b){var g=a.vehicle;g.engine_force=b;var c=q(a.physics.body_id);za(a,g,c)};f.vehicle_steer=function(a,b){var g=a.vehicle;g.steering=b;var c=
q(a.physics.body_id);za(a,g,c)};f.vehicle_brake=function(a,b){var g=a.vehicle;g.brake_force=b;var c=q(a.physics.body_id);za(a,g,c)};var Na=function(){var a=I.create(),b=I.create(),g=B.create();return function(c){var h=c.vehicle,f=h.steering_wheel;if(f){var d=c.vehicle.steering_wheel_axis;u.q(c.render.world_tsr,c.vehicle.steering_wheel_tsr,f.render.world_tsr);c=u.y(d,c.render.world_tsr,g);h=I.setAxisAngle(c,-h.steering*h.steering_max*2*Math.PI,a);c=u.g(f.render.world_tsr,b);I.multiply(h,c,c);I.normalize(c,
c);u.r(c,f.render.world_tsr);ka.update_transform(f)}}}(),Va=function(){var a=I.create(),b=I.create(),g=B.create();return function(c){var h=c.vehicle,f=h.speedometer;if(f){var d=c.vehicle.speedometer_axis;u.q(c.render.world_tsr,c.vehicle.speedometer_tsr,f.render.world_tsr);u.y(d,c.render.world_tsr,g);c=Math.abs(h.speed)*h.speed_ratio;c>h.max_speed_angle&&(c=h.max_speed_angle);h=I.setAxisAngle(g,-c,a);c=u.g(f.render.world_tsr,b);I.multiply(h,c,c);I.normalize(c,c);u.r(c,f.render.world_tsr);ka.update_transform(f)}}}(),
Z=function(){var a=I.create(),b=I.create(),g=B.create();return function(c){var h=c.vehicle,f=h.tachometer;if(f){var d=c.vehicle.tachometer_axis;u.q(c.render.world_tsr,c.vehicle.tachometer_tsr,f.render.world_tsr);u.y(d,c.render.world_tsr,g);I.setAxisAngle(g,-Math.abs(h.engine_force)*h.delta_tach_angle,a);c=u.g(f.render.world_tsr,b);I.multiply(a,c,c);I.normalize(c,c);u.r(c,f.render.world_tsr);ka.update_transform(f)}}}();f.is_vehicle_chassis=P;f.is_vehicle_hull=oa;f.is_navigation_mesh=Q;f.is_car_wheel=
function(a){if(!a.is_vehicle)return!1;a=a.vehicle_settings.part;return"WHEEL_FRONT_LEFT"==a||"WHEEL_FRONT_RIGHT"==a||"WHEEL_BACK_LEFT"==a||"WHEEL_BACK_RIGHT"==a?!0:!1};f.is_boat_bob=function(a){return a.is_vehicle?"BOB"==a.vehicle_settings.part?!0:!1:!1};f.is_floater_bob=function(a){return a.is_floating?"BOB"==a.floating_settings.part?!0:!1:!1};f.is_vehicle_steering_wheel=function(a){return a.is_vehicle&&"STEERING_WHEEL"==a.vehicle_settings.part?!0:!1};f.is_vehicle_speedometer=function(a){return a.is_vehicle&&
"SPEEDOMETER"==a.vehicle_settings.part?!0:!1};f.is_vehicle_tachometer=function(a){return a.is_vehicle&&"TACHOMETER"==a.vehicle_settings.part?!0:!1};f.get_vehicle_speed=function(a){return a.vehicle.speed};f.wheel_index=function(a){switch(a){case "WHEEL_FRONT_RIGHT":return 0;case "WHEEL_FRONT_LEFT":return 1;case "WHEEL_BACK_LEFT":return 2;case "WHEEL_BACK_RIGHT":return 3}};f.has_character_physics=function(a){return a.physics&&a.physics.is_character};f.is_floater_main=da;f.get_fps=function(){return ya};
f.debug_workers=function(){for(var a=0;a<O.length;a++)ba.post_msg(O[a],ba.OUT_DEBUG)};f.remove_object=function(a){var b=a.physics.body_id;if("BOUNDING"==a.physics.type){var g=na.indexOf(a);-1==g&&ta.error("Object "+a.name+" doesn't have bounding physics");delete qa[b];na.splice(g,1)}for(var g=q(b),c=G(g),h=c._physics.bundles,f=[],d=0;d<h.length;d++)for(var l=h[d].physics,k=0;k<l.collision_tests.length;k++)for(var e=l.collision_tests[k],m=0;m<e.pairs.length;m++){var v=e.pairs[m],w=e.pair_results[m];
if(v[0]==b||v[1]==b)e.pairs.splice(m,1),e.pair_results.splice(m,1),m--,w&&!F(e)&&(w=B.set(0,0,0,Da),e.callback(!1,null,w,w,0)),f.push(v)}f.length&&ba.post_msg(g,ba.OUT_REMOVE_COLLISION_TEST,f);a.physics&&a.physics.col_imp_test_cb&&D(a);a=c._physics.bundles;for(c=0;c<a.length;c++)a[c].physics.body_id==b&&(a.splice(c,1),c--);ba.post_msg(g,ba.OUT_REMOVE_BODY,b)};f.has_dynamic_settings=function(a){var b=a.physics_settings;return a.is_vehicle||a.is_floating||a.is_character||a.use_obj_physics&&!b.use_ghost&&
0<b.mass&&("DYNAMIC"==b.physics_type||"RIGID_BODY"==b.physics_type)}});t.a=e},function(C,t,e){C=e(0);var R=e(5),V=e(25),n=e(30),y=e(28),d=e(1),k=e(8),I=e(36),A=e(6),r=e(2),p=e(3),u=e(7);e=Object(C.a)("__geometry",function(a,e){function l(){return{length:0,frames:1,num_comp:0,offset:0,divisor:0}}function c(a,b,g){var c=b.a_tbn,h=b.a_position,f=h.length;b=a.shape_keys.length;if(g)for(var d=a.shape_keys[0].geometry.a_position,l=0;l<f;l++)h[l]=d[l];for(var k=1;k<b;k++)for(var e=g?g[k].value:a.shape_keys[k].init_value,
d=a.shape_keys[k].geometry.a_position,l=0;l<f;l++)h[l]+=e*d[l];b=I.f(c);if(g)for(f=a.shape_keys[0].geometry.a_tbn,k=0;k<b;k++)I.n(c,f,k);for(k=0;k<b;k++){h=I.i(ka);for(l=1;l<a.shape_keys.length;l++)if(f=a.shape_keys[l].geometry.a_tbn,e=g?g[l].value:a.shape_keys[l].init_value)f=I.e(f,k,Ca),e=I.p(I.i(C),f,e,Ca),I.k(e,h,h);l=I.e(c,k,Ca);l=I.k(h,l,Ca);I.n(c,l,k)}}function m(a){return 65536<a.base_length?ta.get_elem_index_uint()?!1:!0:!1}function b(a){return 0<a.indices.length?!0:!1}function f(a,c,g){if(!b(a))return a;
g||pa.log('%cDEBUG max vertices exceeded for indexed submesh "'+a.name+'": '+a.base_length*(c||1)+", will use drawArrays","color: #aa0");c=a.indices;g=a.base_length;var h=a.va_common,f=a.va_frames,d;for(d in h){var l=h[d],k=L(l,g);h[d]=B(c,l,k)}for(h=0;h<f.length;h++){var e=f[h];for(d in e)l=e[d],k=L(l,g),e[d]=B(c,l,k)}for(h=0;h<a.shape_keys.length;h++){d=a.shape_keys[h].geometry;for(var m in d)l=d[m],k=L(l,g),d[m]=B(c,l,k)}a.base_length=c.length;a.indices=new Uint16Array(0);return a}function B(a,
b,g){if(0==b.length)return new Float32Array(0);for(var c=new Float32Array(a.length*g),h=0;h<a.length;h++)for(var f=a[h],d=0;d<g;d++)c[g*h+d]=b[g*f+d];return c}function fa(){return{ibo_array:null,vbo_source_data:ra(),ibo_type:0,count:0,pointers:{},usage:0,debug_ibo_bytes:0,debug_vbo_bytes:0,vbo_data:[],ibo:null,shape_keys:null,instance_count:1,cleanup_gl_data_on_unload:!0}}function z(a,b,g,c){if("a_normal"==b)return c=I.d(c),z(a,"a_tbn",g,c);var h=a.pointers,f=h[b],d=ja(b);if(f)g&&f.num_comp!=g&&Ea.panic('invalid num_comp for "'+
b+'"'),va(a.vbo_source_data,b,c,f.offset);else{f=P(a.vbo_source_data,d);-1==f&&(a.vbo_source_data.push(za(d,0)),f=a.vbo_source_data.length-1);var d=a.vbo_source_data[f].vbo_source,k=new d.constructor(d.length+c.length);k.set(d);a.vbo_source_data[f].vbo_source=k;va(a.vbo_source_data,b,c,d.length);b=h[b]=l();b.num_comp=g;b.offset=d.length;b.length=c.length}M(a);return a}function G(a,b){if("a_normal"==b){for(var g=G(a,"a_tbn"),c=I.f(g),h=new Float32Array(3*c),f=0;f<c;f++){var d=I.g(g,f,Aa);h.set(d,3*
f)}return h}if(g=a.pointers[b])return c=ja(b),c=Q(a.vbo_source_data,c),Ga(b,c.subarray(g.offset,g.offset+g.length),new Float32Array(g.length));Ea.panic("extract_array_float() failed; invalid name: "+b)}function E(a,b){var g;switch(b){case e.DM_DEFAULT:case e.DM_TRIANGLES:g=wa.STATIC_DRAW;break;case e.DM_DYNAMIC_TRIANGLES:g=wa.DYNAMIC_DRAW;break;default:Ea.panic("Wrong draw_mode")}a.usage=g}function J(a,b,g){var c={},h=function(a,b){c[a]||(c[a]=0);c[a]+=b},f;for(f in a[0]){var d=a[0][f],l=ja(f);h(l,
d.length*a.length)}for(f in b)d=b[f],l=ja(f),h(l,d.length);if(g){a=g.tsr_array.length;l=ja("a_part_ts");h(l,4*a);l=ja("a_part_r");h(l,4*a);b=g.part_inh_attrs;for(f in b)l=ja(f),h(l,b[f].num_comp*a);g=g.submesh_params;for(f in g)l=ja(f),h(l,a)}return c}function M(a){a.ibo_array?(a.ibo||(a.ibo=wa.createBuffer()),wa.bindBuffer(wa.ELEMENT_ARRAY_BUFFER,a.ibo),wa.bufferData(wa.ELEMENT_ARRAY_BUFFER,a.ibo_array,a.usage),a.debug_ibo_bytes=a.ibo_array.byteLength):a.debug_ibo_bytes=0;for(var b=a.debug_vbo_bytes=
0;b<a.vbo_source_data.length;b++){var g=a.vbo_source_data[b].type,c=P(a.vbo_data,g);-1==c&&(a.vbo_data.push({vbo:null,type:g,debug_id:X.unique_id()}),c=a.vbo_data.length-1);g=a.vbo_data[c];g.vbo||(g.vbo=wa.createBuffer());wa.bindBuffer(wa.ARRAY_BUFFER,g.vbo);wa.bufferData(wa.ARRAY_BUFFER,a.vbo_source_data[b].vbo_source,a.usage);a.debug_vbo_bytes+=a.vbo_source_data[b].vbo_source.byteLength}}function F(a,b){a.bb_local=V.h(a.bb_local,b);a.be_local=V.i(a.be_local,b);a.bs_local=V.k(a.bs_local,b);a.bbr_local=
V.j(a.bbr_local,b)}function U(a){for(var b=a[0],g=a[0],c=ia("JOIN_"+a.length+"_SUBMESHES"),h=0,f=0;f<a.length;f++)h+=a[f].indices.length;c.indices=new Uint32Array(h);var d=h=0;if(0<a[0].shape_keys.length)for(var l=0;l<a[0].shape_keys.length;l++){for(f=0;f<a.length;f++)h+=a[f].shape_keys[l].geometry.a_position.length,d+=I.f(a[f].shape_keys[l].geometry.a_tbn);f={a_position:new Float32Array(h),a_tbn:I.c(d)};c.shape_keys.push({init_value:a[0].shape_keys[l].init_value,geometry:f})}for(f=h=0;f<a.length;f++)h+=
a[f].base_length;c.base_length=h;for(var k in g.va_common){for(f=h=0;f<a.length;f++)h+=a[f].va_common[k].length;c.va_common[k]=new Float32Array(h)}for(k in g.va_frames[0]){for(f=h=0;f<a.length;f++)h+=a[f].va_frames[0][k].length;for(f=0;f<g.va_frames.length;f++)c.va_frames[f]=c.va_frames[f]||{},c.va_frames[f][k]=new Float32Array(h)}f=c.submesh_bd;f.bb_local=V.n(b.submesh_bd.bb_local);d=h=0;l=[];for(g=0;g<a.length;g++){var e=a[g],m=e.indices,q=e.base_length,v=e.va_common;k=e.submesh_bd.bs_local;V.D(f.bb_local,
e.submesh_bd.bb_local);V.E(f.bs_local,k);V.G(e.submesh_bd.bbr_local,l);for(k=0;k<m.length;k++)c.indices[h+k]=m[k]+d;var h=h+m.length,w;for(w in v){var m=v[w],D=d*L(m,q);c.va_common[w].set(m,D)}for(k=0;k<e.va_frames.length;k++){var v=e.va_frames[k],p=c.va_frames[k];for(w in v)m=v[w],D=d*L(m,q),p[w].set(m,D)}d+=q}f.be_local=V.z(r._1(l),!0);if(0<c.shape_keys.length)for(g=0;g<c.shape_keys.length;g++)for(w=c.shape_keys[g].geometry,k=h=f=0;k<a.length;k++)d=a[k].shape_keys[g].geometry,w.a_position.set(d.a_position,
f),w.a_tbn.set(d.a_tbn,h),f+=d.a_position.length,h+=d.a_tbn.length;a[0].instanced_array_data&&(c.instanced_array_data={tsr_array:b.instanced_array_data.tsr_array,stat_part_em_tsr:b.instanced_array_data.stat_part_em_tsr,static_hair:!0,submesh_params:b.instanced_array_data.submesh_params,part_inh_attrs:b.instanced_array_data.part_inh_attrs,dyn_grass:b.instanced_array_data.dyn_grass});return c}function K(a,b,g){b=b.submesh_bd;for(var c=V.w(),h=V.C(),f=[],d=0;d<g.length;d++)V.h(a.submesh_bd.bb_local,
g[d],c),V.D(b.bb_local,c),V.j(a.submesh_bd.bbr_local,g[d],h),V.G(h,f);b.be_local=V.z(r._1(f),!0);b.bbr_local=V.x(b.be_local);b.bs_local=V.B(b.be_local)}function t(a,b,g,c,h,d){var l=a.submeshes[b],k=l.base_length,e=ia("SUBMESH_"+a.name+"_"+a.materials[b].name);e.base_length=k;var m=!1;if(ha(g,"a_texcoord")){var q=null,w=a.materials[b];b=a.submeshes[b];if(w.texture_slots.length)switch(w=w.texture_slots[0],w.texture_coords){case "UV":q=Y(b,w.uv_layer||a.active_uv_name,a.name);break;case "ORCO":for(var D=
a.b4w_boundings.bb_src,q=new Float32Array(2*b.base_length),w=(D.max_x+D.min_x)/2,z=(D.max_y+D.min_y)/2,L=D.max_x-D.min_x,D=D.max_y-D.min_y,n=0,u=0;u<b.position.length;u+=3)q[n++]=(b.position[u]-w)/L+.5,q[n++]=(b.position[u+1]-z)/D+.5}null===q&&(q=new Float32Array(2*b.base_length));b=q}else b=new Float32Array(0);if(ha(g,"a_orco_tex_coord")){for(var q=a.b4w_boundings.bb_src,w=new Float32Array(3*l.base_length),z=l.position,L=q.max_x-q.min_x,D=q.max_y-q.min_y,n=q.max_z-q.min_z,E=u=0;E<z.length;E+=3)0==
L?w[u++]=.5:w[u++]=r.M(parseFloat(((z[E]-q.min_x)/L).toFixed(5)),0,1),0==D?w[u++]=.5:w[u++]=r.M(parseFloat(((z[E+1]-q.min_y)/D).toFixed(5)),0,1),0==n?w[u++]=.5:w[u++]=r.M(parseFloat(((z[E+2]-q.min_z)/n).toFixed(5)),0,1);q=w}else q=new Float32Array(0);w=l.group;if(ha(g,"a_influence")&&c){z=new Float32Array(4*k);L=w.length/k;D=new Float32Array(L);for(n=0;n<L;n++){D[n]=-1;for(var ea in c)if(u=c[ea],u.vgroup_index===n){D[n]=u.deform_bone_index;break}}E=3<L?L:4;c=new Float32Array(E);ea=new Uint32Array(E);
for(var n=new Float32Array(4),u=new Float32Array(E),E=new Uint32Array(E),K=new Float32Array(4),A=0;A<k;A++)c.set(u),ea.set(E),n.set(K),z.set(S(w,L,A,k,D,c,ea,n),4*A)}else z=new Float32Array(0);c=z;h=h?r.O(h):{};h.a_color={generate_buffer:!0};ha(g,"a_color")&&a.active_vcol_name?h.a_color.src=[{name:a.active_vcol_name,mask:7}]:h.a_color.src=[];e.va_common.a_texcoord=b;e.va_common.a_influence=c;e.va_common.a_orco_tex_coord=q;c=e.va_common;ea=l.vertex_colors;b=l.color;q=a.name;w=[];for(z=0;z<ea.length;z++)w.push(ea[z].name);
for(var G in h)if(z=h[G].src,z.length){for(D=L=0;D<z.length;D++)L+=r._43(z[D].mask);c[G]=new Float32Array(L*k);for(D=n=0;D<z.length;D++){var O=z[D].name,u=z[D].mask,E=r._44(u),K=w.indexOf(O);if(-1==K)pa.warn('vertex color "'+O+'" for mesh "'+q+'" not found'),A=7;else{var A=ea[K].mask,B;B=ea;for(var P=K,I=k,T=0,na=0;na<P;na++)T+=r._43(B[na].mask);B=T*I}P=r._43(A);(u&A)!==u&&pa.error("Wrong color extraction from "+O+" to "+G+' for the mesh "'+q+'".');for(O=0;O<k;O++)for(I=0;3>I;I++)E[I]&&(T=n+r._42(u,
I),na=r._42(A,I),c[G][O*L+T]=-1==K?0:b[B+O*P+na]);n+=P}}else c[G]=new Float32Array(0);G=a.name;B=e.va_common;if(d)for(var za in d)B[d[za]]=Y(l,za,G);e.indices=new Uint32Array(l.indices);za=l.position.length/k/3;G=ha(g,"a_tbn")&&l.tbn.length?!0:!1;B=ha(g,"a_shade_tangs")&&l.shade_tangs.length?!0:!1;0<a.b4w_shape_keys.length&&(m=!0);for(h=0;h<za;h++){d=v(l,k,G,B,h);if(m)if(c={},c.name=a.b4w_shape_keys[h].name,e.shape_keys.push(c),0!=h){c.geometry=d;c.init_value=a.b4w_shape_keys[h].value;continue}else c.geometry=
v(l,k,G,B,h),c.init_value=1;e.va_frames.push(d)}if(1<za&&!m){a=e.va_frames[0];d={};for(var F in a)d[F]=new Float32Array(a[F]);e.va_frames.push(d)}ha(g,"a_polyindex")&&(f(e,1,!0),e.va_common.a_polyindex=H(e));l=l.boundings;g=e.submesh_bd;g.bb_local=V.w();g.bb_local.max_x=l.bb.max_x;g.bb_local.max_y=l.bb.max_y;g.bb_local.max_z=l.bb.max_z;g.bb_local.min_x=l.bb.min_x;g.bb_local.min_y=l.bb.min_y;g.bb_local.min_z=l.bb.min_z;F=l.rbb;a=l.caxis_x;k=l.caxis_y;m=l.caxis_z;d=l.be_ax;g.be_local=V.e(a,k,m,l.be_cen);
p.scale(g.be_local.axis_x,d[0],g.be_local.axis_x);p.scale(g.be_local.axis_y,d[1],g.be_local.axis_y);p.scale(g.be_local.axis_z,d[2],g.be_local.axis_z);g.bs_local=V.B(g.be_local);p.copy(F.rbb_c,g.bbr_local.center);p.copy(a,g.bbr_local.axis_x);p.copy(k,g.bbr_local.axis_y);p.copy(m,g.bbr_local.axis_z);l=F.rbb_s;p.scale(g.bbr_local.axis_x,l[0],g.bbr_local.axis_x);p.scale(g.bbr_local.axis_y,l[1],g.bbr_local.axis_y);p.scale(g.bbr_local.axis_z,l[2],g.bbr_local.axis_z);return e}function v(a,b,g,c,h){var f=
{},d=new Float32Array(3*b),l=I.c(g?b:0),k=h*b*3;d.set(a.position.subarray(k,k+3*b),0);g&&I.b(a.tbn,h*b,b,l);c&&(g=new Float32Array(3*b),g.set(a.shade_tangs.subarray(0,3*b),0),f.a_shade_tangs=g);f.a_position=d;f.a_tbn=l;return f}function Y(a,b,g){var c=2*a.base_length,h=a.uv_layers.indexOf(b);if(-1==h)return pa.warn('uv layer "'+b+'" for mesh "'+g+'" not found'),new Float32Array(c);b=h*c;return a.texcoord.subarray(b,b+c)}function ha(a,b){return-1<a.indexOf(b)?!0:!1}function S(a,b,g,c,h,f,d,l){for(var k=
!0,m=0;m<b;m++){var w=a[m*c+g];if(-1!==w){var D=h[m];-1!==D&&(f[m]=w,d[m]=D,k=!1)}}if(k)return l;q(f,d,e.SORT_NUMERIC,!1);for(m=a=0;4>m;m++)a+=f[m];if(.01>a)return l;for(m=0;4>m;m++)f[m]/=a;if(.01>Math.abs(f[0]-1))l[0]=d[0]+1;else for(m=0;4>m;m++)l[m]=d[m]+f[m];return l}function L(a,b){if(0==b)return 0;var g=a.length,c=g/b;c!=Math.floor(c)&&Ea.panic("Array size mismatch during geometry calculation: array length="+g+", base length="+b);return c}function q(a,b,g,c){for(var h=a.length,f=h,d=!1,l=c?-1:
1;1<f||d;){1<f&&(f=Math.floor(f/1.247330950103979));for(var d=!1,k=0;f+k<h;k++)if(g==e.SORT_NUMERIC?0>l*(a[k]-a[k+f]):a[k]<a[k+f]&&c)d=a[k],a[k]=a[k+f],a[k+f]=d,d=b[k],b[k]=b[k+f],b[k+f]=d,d=!0}}function w(a,b,g){var c=[],h=[];p.subtract(b,a,c);p.subtract(g,a,h);p.normalize(c,c);p.normalize(h,h);a=r.M(p.dot(c,h),-1,1);return Math.acos(a)}function ea(a,c,g){if(b(c)){c=c.indices;for(var h=c.length/3,f=0;f<h;f++){var d=new Float32Array(9),l=c[3*f];d[0]=a[3*l];d[1]=a[3*l+1];d[2]=a[3*l+2];l=c[3*f+1];d[3]=
a[3*l];d[4]=a[3*l+1];d[5]=a[3*l+2];l=c[3*f+2];d[6]=a[3*l];d[7]=a[3*l+1];d[8]=a[3*l+2];g[f]=d}}else for(f=0;f<a.length;f++)d=new Float32Array(9),d[0]=a[9*f],d[1]=a[9*f+1],d[2]=a[9*f+2],d[3]=a[9*f+3],d[4]=a[9*f+4],d[5]=a[9*f+5],d[6]=a[9*f+6],d[7]=a[9*f+7],d[8]=a[9*f+8],g[f]=d;return g}function H(a){for(var b=new Float32Array(a.base_length),g=0;g<a.base_length;g++)b[g]=g%3/2;return b}function D(a,b,g){var c=p.dist(a,b);a=p.dist(a,g);b=p.dist(b,g);g=(c+a+b)/2;return g*(g-c)*(g-a)*(g-b)}function h(a){for(var b=
new Float32Array([0,0,0,1,1,1,1,0]),g=new Float32Array(8*a),c=0;c<a;c++)g.set(b,8*c);return g}function ia(a){var b={a_influence:new Float32Array(0),a_color:new Float32Array(0),a_texcoord:new Float32Array(0)};return{name:a,base_length:0,indices:null,va_frames:[],va_common:b,shape_keys:[],submesh_bd:{bb_local:V.w(),be_local:V.y(),bs_local:V.A(),bbr_local:V.C()},instanced_array_data:null}}function ra(a){var b=[],g;for(g in a)b.push(za(g,a[g]));return b}function za(a,b){return{vbo_source:new (da(a))(b),
type:a}}function P(a,b){for(var g=0;g<a.length;g++)if(a[g].type==b)return g;return-1}function oa(a,b){var g=P(a,b);return-1==g?null:a[g].vbo}function Q(a,b){var g=P(a,b);return-1==g?null:a[g].vbo_source}function da(a){switch(a){case "float":return Float32Array;case "short":return Int16Array;case "unsigned_byte":return Uint8Array;default:return Float32Array}}function ja(a){a=a.replace(/_next$/,"");a=a.replace(/param_GEOMETRY_VC_a_\w+/,"param_GEOMETRY_VC_a");switch(a){case "a_tbn":case "a_shade_tangs":return"short";
case "a_color":case "a_bending_col_main":case "a_bending_col_detail":case "a_grass_size":case "a_grass_color":case "param_GEOMETRY_VC_a":case "a_polyindex":case "a_p_bb_vertex":case "a_halo_bb_vertex":case "a_bb_vertex":return"unsigned_byte";default:return"float"}}function va(a,b,g,c){var h=ja(b),h=P(a,h);ba(b,g,a[h].vbo_source.subarray(c))}function Ga(a,b,g){switch(ja(a)){case "float":g.set(b);break;case "short":for(a=0;a<b.length;a++)g[a]=r._49(b[a]);break;case "unsigned_byte":for(a=0;a<b.length;a++)g[a]=
r._65(b[a])}return g}function ba(a,b,g){switch(ja(a)){case "float":g.set(b);break;case "short":for(a=0;a<b.length;a++)g[a]=r._3(b[a]);break;case "unsigned_byte":for(a=0;a<b.length;a++)g[a]=r._66(b[a])}return g}var Ea=Object(R.a)(a),ta=Object(y.a)(a),X=Object(n.a)(a),pa=Object(d.a)(a),ka=I.c(),Ca=I.c(),C=I.c(),Aa=new Float32Array(3),xa=new Float32Array(3),ga=new Float32Array(3),ya=k.create(),O=A.b();e.DM_TRIANGLES=10;e.DM_DYNAMIC_TRIANGLES=20;e.SORT_NUMERIC=0;e.SORT_STRING=1;e.DM_DEFAULT=e.DM_TRIANGLES;
var wa=null;e.VBO_FLOAT="float";e.VBO_SHORT="short";e.VBO_UBYTE="unsigned_byte";e.setup_context=function(a){wa=a};e.submesh_to_bufs_data=function(a,b,g){m(a)&&f(a);var h=a.indices,d=a.base_length,k=a.va_frames,e={},q;for(q in a.va_common)q in g&&!g[q].generate_buffer||(e[q]=a.va_common[q]);g=fa();0<a.shape_keys.length&&c(a,k[0]);q=a.instanced_array_data;if(h.length){var w=h.length;if(65536>=d)var h=new Uint16Array(h),D=wa.UNSIGNED_SHORT;else h=new Uint32Array(h),D=wa.UNSIGNED_INT}else w=d,h=null;
for(var v=J(k,e,q),v=ra(v),p={},z=0;z<v.length;z++)p[v[z].type]=0;var r={},H;for(H in e){var n=e[H],u=n.length;if(u){var S=ja(H),z=r[H]=l();z.length=u;z.num_comp=L(n,d);z.offset=p[S];va(v,H,n,p[S]);p[S]+=u}}e=k.length;for(H in k[0])if(n=k[0][H],S=ja(H),u=n.length,n=L(n,d),u)for(z=r[H]=l(),z.length=u,z.frames=e,z.num_comp=n,z.offset=p[S],1<e&&(z=r[H+"_next"]=l(),z.length=u,z.frames=e,z.num_comp=n,z.offset=p[S]+u),z=0;z<e;z++)n=k[z][H],S=ja(H),va(v,H,n,p[S]),p[S]+=u;q&&(qa(q,r,v,p),g.instance_count=
q.tsr_array.length);g.count=w;g.ibo_array=h;g.vbo_source_data=v;g.ibo_type=D;g.pointers=r;E(g,b);M(g);g.shape_keys=a.shape_keys;return g};e.submesh_init_shape_keys=c;e.is_long_submesh=m;e.is_indexed=b;e.submesh_drop_indices=f;e.update_bufs_data_index_array=function(a,b,g){E(a,b);a.count=g.length;a.ibo_array=g;a.ibo_type=g instanceof Uint16Array?wa.UNSIGNED_SHORT:wa.UNSIGNED_INT;return a};e.update_bufs_data_array=z;e.extract_array_float=G;e.make_static=function(a){a.usage=wa.STATIC_DRAW};e.make_dynamic=
function(a){a.usage=wa.DYNAMIC_DRAW};var qa=function(){var a=u.create(),b=k.create();return function(g,c,h,f){var d=g.tsr_array,k=g.stat_part_em_tsr,e=g.part_inh_attrs,m=g.submesh_params,q=g.static_hair,w={a_part_ts:{data:[],num_comp:4},a_part_r:{data:[],num_comp:4}},v;for(v in e)w[v]={data:[],num_comp:e[v].num_comp};for(v in m)w[v]={data:[],num_comp:1};for(var D=0;D<d.length;D++){var z=d[D];q&&k&&!g.dyn_grass&&(z=A.q(k,d[D],O));!q&&g.dyn_grass&&p.subtract(d[D],k,d[D]);var r=A.l(z,a),z=A.g(z,b),H=
w.a_part_ts.data,L=w.a_part_r.data;H.push.apply(H,r);L.push.apply(L,z);for(v in e)for(r=e[v].num_comp,z=0;z<r;z++)w[v].data.push(e[v].data[D*r+z]);for(v in m)w[v].data.push(m[v][0])}for(v in w)g=ja(v),va(h,v,w[v].data,f[g]),d=l(),d.num_comp=w[v].num_comp,d.offset=f[g],d.divisor=1,d.length=w[v].data.length,c[v]=d,f[g]+=d.length}}();e.update_gl_buffers=M;e.update_gl_buffer_sub_data=function(a,b,g,c){b=P(a.vbo_data,b);wa.bindBuffer(wa.ARRAY_BUFFER,a.vbo_data[b].vbo);wa.bufferSubData(wa.ARRAY_BUFFER,
r.h*c,g)};e.cleanup_bufs_data=function(a){a.ibo&&wa.deleteBuffer(a.ibo);for(var b=0;b<a.vbo_data.length;b++)a.vbo_data[b].vbo&&wa.deleteBuffer(a.vbo_data[b].vbo);a.vbo_data.length=0};e.has_empty_submesh=function(a,b){return a.submeshes[b].base_length?!1:!0};e.submesh_apply_transform=function(a,b){for(var g=0;g<a.va_frames.length;g++){var c=a.va_frames[g].a_position;A.F(c,b,c,0);c=a.va_frames[g].a_tbn;I.m(c,b,c);(c=a.va_frames[g].a_shade_tangs)&&0<c.length&&A.z(c,b,c,0)}(g=a.va_common.au_center_pos)&&
g.length&&A.F(g,b,g,0);F(a.submesh_bd,b);return a};e.submesh_apply_particle_transform=function(a,b){var g=a.va_common.au_center_pos;if(g&&g.length){var c=new Float32Array(g);A.F(c,b,c,0);for(var h=0;h<a.va_frames.length;h++)for(var f=0;f<c.length;f++)a.va_frames[h].a_position[f]+=c[f]-g[f];g.set(c)}else Ea.panic('Attribute "au_center_pos" is missing in particle submesh');F(a.submesh_bd,b);return a};e.bounding_data_apply_transform=F;e.submesh_apply_params=function(a,b){var g=a.base_length,c;for(c in b){var h=
b[c].length;a.va_common[c]=new Float32Array(h*g);for(var f=0;f<g;f++)for(var d=0;d<h;d++)a.va_common[c][f*h+d]=b[c][d]}return a};e.submesh_list_join=U;e.make_propagated_submesh=function(a,b,g){if(!a.base_length)return ia("EMPTY");var c=g.length;65536<a.base_length*c&&!ta.get_elem_index_uint()&&f(a,c);var h=a.indices,d=a.base_length,l=a.va_common,k=a.va_frames,e;for(e in b){var m=b[e].length,q=m*d;l[e]=new Float32Array(q);for(var w=0;w<d;w++)for(q=0;q<m;q++)l[e][w*m+q]=b[e][q]}b=ia("CLONE_"+c+"_SUBMESHES");
b.base_length=d*c;b.indices=new Uint32Array(h.length*c);for(w=0;w<c;w++)for(m=h.length*w,e=d*w,q=0;q<h.length;q++)b.indices[m+q]=h[q]+e;for(var v in l)for(h=l[v],q=h.length*c,m=L(h,d),b.va_common[v]=new Float32Array(q),w=0;w<c;w++)e=d*m*w,b.va_common[v].set(h,e);for(v in k[0])for(w=0;w<k.length;w++)for(h=k[w][v],q=h.length*c,m=L(h,d),b.va_frames[w]=b.va_frames[w]||{},b.va_frames[w][v]=new Float32Array(q),q=0;q<c;q++)switch(l=g[q],e=d*m*q,v){case "a_position":A.F(h,l,b.va_frames[w][v],e);break;case "a_tbn":A.B(h,
l,b.va_frames[w][v],e);break;case "a_shade_tangs":A.C(h,l,b.va_frames[w][v],e);break;default:Ea.panic("Wrong attribute name: "+v)}K(a,b,g);return b};e.calc_unit_boundings=K;e.extract_submesh=t;e.extract_halo_submesh=function(a){var b=a.base_length,g=a.va_frames[0].a_position,c=new Float32Array(12*b);a=new Uint32Array(4*a.indices.length);for(var f=new Float32Array(4*b),d=0;d<b;d++){c[12*d]=g[3*d];c[12*d+1]=g[3*d+1];c[12*d+2]=g[3*d+2];c[12*d+3]=g[3*d];c[12*d+4]=g[3*d+1];c[12*d+5]=g[3*d+2];c[12*d+6]=
g[3*d];c[12*d+7]=g[3*d+1];c[12*d+8]=g[3*d+2];c[12*d+9]=g[3*d];c[12*d+10]=g[3*d+1];c[12*d+11]=g[3*d+2];a[6*d]=4*d+2;a[6*d+1]=4*d+1;a[6*d+2]=4*d;a[6*d+3]=4*d+2;a[6*d+4]=4*d;a[6*d+5]=4*d+3;var l=Math.random();f[4*d]=l;f[4*d+1]=l;f[4*d+2]=l;f[4*d+3]=l}g=ia("HALO");g.va_frames[0]={};g.base_length=4*b;g.va_frames[0].a_position=c;g.va_common.a_halo_bb_vertex=h(b);g.va_common.a_random_vals=f;g.indices=a;return g};e.has_attr=ha;e.extract_submesh_all_mats=function(a,b,g){for(var c=[],h=0;h<a.submeshes.length;h++){var f=
t(a,h,b,null,g,null);f.base_length&&c.push(f)}return 0==c.length?ia("EMPTY"):1==c.length?c[0]:U(c)};e.update_buffers_movable=function(a,b,g,c){var h=a.ibo_array,f=G(a,"a_position"),d=b.median_cache,l=b.median_world_cache;b=b.dist_cache;for(var k=h,e=k.length/3,m=0;m<e;m++){var q=k[3*m],w=k[3*m+1],v=k[3*m+2],D=f[3*q+1],p=f[3*q+2],z=f[3*w+1],r=f[3*w+2],H=f[3*v+1],L=f[3*v+2];d[3*m]=(f[3*q]+f[3*w]+f[3*v])/3;d[3*m+1]=(D+z+H)/3;d[3*m+2]=(p+r+L)/3}A.F(d,g,l);g=l.length/3;for(f=0;f<g;f++)d=l[3*f]-c[0],k=
l[3*f+1]-c[1],e=l[3*f+2]-c[2],b[f]=d*d+k*k+e*e;c=h;h=b.length;if(!(2>h))for(l=h,f=!1;1<l||f;)for(1<l&&(l=Math.floor(l/1.247330950103979)),f=!1,g=0;l+g<h;g++)0>b[g]-b[g+l]&&(f=b[g],b[g]=b[g+l],b[g+l]=f,f=c,d=g,k=g+l,e=f[3*d],m=f[3*d+1],q=f[3*d+2],f[3*d]=f[3*k],f[3*d+1]=f[3*k+1],f[3*d+2]=f[3*k+2],f[3*k]=e,f[3*k+1]=m,f[3*k+2]=q,f=!0);h=c;wa.bindBuffer(wa.ELEMENT_ARRAY_BUFFER,a.ibo);wa.bufferData(wa.ELEMENT_ARRAY_BUFFER,h,wa.DYNAMIC_DRAW)};e.sort_two_arrays=q;e.calc_normals=function(a,b,g){for(var c=
b.length/3,h=a.length/3,f=[],d=Array(3),l=Array(3),k=Array(3),e=0;e<h;e++){for(var m=a[3*e],q=a[3*e+1],v=a[3*e+2],D=0;3>D;D++)d[D]=b[3*m+D],l[D]=b[3*q+D],k[D]=b[3*v+D];if(g)var D=w(d,l,k),z=w(l,k,d),r=Math.PI-D-z;else r=z=D=1;var H=f,L;L=d;var n=k,u=[],S=[],E=[];p.subtract(l,L,u);p.subtract(n,L,S);p.cross(u,S,E);p.normalize(E,E);L=E;for(n=0;3>n;n++)u=3*q+n,S=3*v+n,H[3*m+n]=D*L[n],H[u]=z*L[n],H[S]=r*L[n]}if(g)for(var Y in g)for(e=g[Y],a=0;3>a;a++){b=3*e[0]+a;for(h=1;h<e.length;h++)d=3*e[h]+a,f[b]+=
f[d];for(h=1;h<e.length;h++)d=3*e[h]+a,f[d]=f[b]}for(e=0;e<c;e++){g=e;Y=f;a=new Float32Array(3);for(b=0;3>b;b++)h=3*g+b,a[b]=Y[h];p.normalize(a,a);for(b=0;3>b;b++)h=3*g+b,Y[h]=a[b]}return f};e.calc_shared_indices=function(a,b,g){for(var c={},h=b.length/3,f=0;f<h;f++){var d=String(b[3*f])+String(b[3*f+1])+String(b[3*f+2]);c[d]=[]}b=a.length;for(f=0;f<b;f++)h=a[f],d=String(g[3*h])+String(g[3*h+1])+String(g[3*h+2]),d in c&&c[d].push(h);return c};e.geometry_random_points=function(a,b,g,c){var h;h=ea(a.va_frames[0].a_position,
a,[]);if(g){var f;f=a.va_frames[0].a_tbn;for(var d=I.f(f),l=new Float32Array(3*d),e=0;e<d;e++){var m=I.h(f,e,ya),m=p.transformQuat(r.e,m,Aa);l[3*e]=m[0];l[3*e+1]=m[1];l[3*e+2]=m[2]}f=ea(l,a,[])}l=h.length;e=new Float32Array(l);d=Aa;for(a=0;a<l;a++)m=h[a],d.set(m.subarray(0,3)),xa.set(m.subarray(3,6)),ga.set(m.subarray(6)),e[a]=Math.sqrt(D(d,xa,ga));d=new Float32Array(l);d[0]=e[0];for(a=1;a<l;a++)d[a]=d[a-1]+e[a];l=d[e.length-1];e=[];for(a=0;a<b;a++){var m=l*r._40(c),m=r.F(d,m,0,d.length-1),q=m=g?
f[m]:h[m],w=c;(m=Aa)||(m=new Float32Array(3));var v=q[0],z=q[1],L=q[2],H=q[3],n=q[4],u=q[5],S=q[6],E=q[7],q=q[8],Y=r._40(w),w=r._40(w);1<Y+w&&(Y=1-Y,w=1-w);var A=1-Y-w;m[0]=A*v+Y*H+w*S;m[1]=A*z+Y*n+w*E;m[2]=A*L+Y*u+w*q;g?(e[a]=new Float32Array(4),p.normalize(m,m),m=k.rotationTo(r.e,m,ya),e[a][0]=m[0],e[a][1]=m[1],e[a][2]=m[2],e[a][3]=m[3]):(e[a]=new Float32Array(3),e[a][0]=m[0],e[a][1]=m[1],e[a][2]=m[2])}return e};e.extract_polyindices=H;e.triangle_area_squared=D;e.gen_bb_vertices=h;e.scale_submesh_xyz=
function(a,b,g){a=a.va_frames[0].a_position;for(var c=0;c<a.length;c+=3)a[c]=(a[c]-g[0])*b[0]+g[0],a[c+1]=(a[c+1]-g[1])*b[1]+g[1],a[c+2]=(a[c+2]-g[2])*b[2]+g[2]};e.apply_shape_key=function(a,b,g){var c=a.scenes_data[0].batches;a=a.render.shape_keys_values;for(var h=1;h<a.length;h++)a[h].name==b&&(a[h].value=g);for(h=0;h<c.length;h++)if(!c[h].forked_batch&&c[h].use_shape_keys&&!c[h].debug_sphere){b=c[h].bufs_data;var f=ja("a_position");g=oa(b.vbo_data,f);f=Q(b.vbo_source_data,f);wa.bindBuffer(wa.ARRAY_BUFFER,
g);var d=b.pointers.a_position;g=c[h];var l=a;if(d){for(var k=d.offset,d=d.length+k,e=g.bufs_data.shape_keys[0].geometry.a_position,m=k;m<d;m++)f[m]=e[m-k];for(m=1;m<g.bufs_data.shape_keys.length;m++){var e=g.bufs_data.shape_keys[m].geometry.a_position,q=l[m].value;if(q)for(var w=k;w<d;w++)f[w]+=q*e[w-k]}wa.bufferSubData(wa.ARRAY_BUFFER,r.h*k,f.subarray(k))}f=ja("a_tbn");g=oa(b.vbo_data,f);f=Q(b.vbo_source_data,f);wa.bindBuffer(wa.ARRAY_BUFFER,g);l=b.pointers.a_tbn;b=f;g=a;if(l){f=l.offset;l=l.length+
f;k=c[h].bufs_data.shape_keys;d=k[0].geometry.a_tbn;m=I.i(ka);for(e=f;e<l;e+=I.a){for(var q=I.i(C),w=(e-f)/I.a,v=1;v<k.length;v++){var D=g[v].value;if(D){var p=I.e(k[v].geometry.a_tbn,w,Ca),D=I.p(m,p,D,Ca);I.k(D,m,q)}}w=I.e(d,w,Ca);q=I.k(q,w,Ca);b[e]=r._3(q[0]);b[e+1]=r._3(q[1]);b[e+2]=r._3(q[2]);b[e+3]=r._3(q[3])}wa.bufferSubData(wa.ARRAY_BUFFER,r.h*f,b.subarray(f))}}};e.check_shape_keys=function(a){return a.render.use_shape_keys};e.get_shape_keys_names=function(a){var b=[];if(a.render)for(var g=
1;g<a.render.shape_keys_values.length;g++)b.push(a.render.shape_keys_values[g].name);return b};e.get_shape_key_value=function(a,b){if(a.render)for(var g=1;g<a.render.shape_keys_values.length;g++)if(b==a.render.shape_keys_values[g].name)return a.render.shape_keys_values[g].value;return 0};e.has_shape_key=function(a,b){var g=a.render.shape_keys_values;if(g)for(var c=1;c<g.length;c++)if(g[c].name==b)return!0;return!1};e.has_dyn_geom=function(a){return a&&a.render&&a.render.dynamic_geometry?!0:!1};e.draw_line=
function(a,b,g){var c=a.bufs_data;if(c){for(var h=g?b.length/3/2:b.length/3-1,f=new Float32Array(12*h),d=new Float32Array(12*h),l=new Uint16Array(6*h),k=0;k<h;k++){if(g)var m=6*k,q=6*k+3;else m=3*k,q=3*(k+1);var w=b[m],v=b[m+1],m=b[m+2],D=b[q],p=b[q+1],q=b[q+2],z=D-w,r=p-v,L=q-m;f[12*k]=w;f[12*k+1]=v;f[12*k+2]=m;d[12*k]=z;d[12*k+1]=r;d[12*k+2]=L;f[12*k+3]=D;f[12*k+4]=p;f[12*k+5]=q;d[12*k+3]=-z;d[12*k+4]=-r;d[12*k+5]=-L;f[12*k+6]=w;f[12*k+7]=v;f[12*k+8]=m;d[12*k+6]=-z;d[12*k+7]=-r;d[12*k+8]=-L;f[12*
k+9]=D;f[12*k+10]=p;f[12*k+11]=q;d[12*k+9]=z;d[12*k+10]=r;d[12*k+11]=L;l[6*k]=4*k;l[6*k+1]=4*k+1;l[6*k+2]=4*k+2;l[6*k+3]=4*k;l[6*k+4]=4*k+3;l[6*k+5]=4*k+1}g=0;for(var H in c.pointers)b=c.pointers[H],g+=f.length/3*b.num_comp;b={};b["float"]=g;g=c.vbo_source_data=ra(b);e.update_bufs_data_index_array(c,a.draw_mode,l);a=0;for(H in c.pointers)switch(b=c.pointers[H],H){case "a_position":va(g,H,f,a);b.offset=a;b.length=f.length;a+=b.length;break;case "a_direction":va(g,H,d,a);b.offset=a;b.length=d.length;
a+=b.length;break;default:b.offset=a,b.length=f.length/3*b.num_comp,l=new Float32Array(b.length),va(g,H,l,a),a+=b.length}M(c)}};e.clone_bufs_data=function(a){if(a){var b=fa();if(a.ibo_array)switch(a.ibo_type){case wa.UNSIGNED_SHORT:b.ibo_array=new Uint16Array(a.ibo_array);break;case wa.UNSIGNED_INT:b.ibo_array=new Uint32Array(a.ibo_array)}else b.ibo_array=null;for(var g=b,c=a.vbo_source_data,h=[],f=0;f<c.length;f++){var d=c[f].vbo_source,l=c[f].type;h.push({vbo_source:new d.constructor(d),type:l})}g.vbo_source_data=
h;b.ibo_type=a.ibo_type;b.count=a.count;b.pointers=r.O(a.pointers);b.usage=a.usage;b.debug_ibo_bytes=a.debug_ibo_bytes;b.debug_vbo_bytes=a.debug_vbo_bytes;b.ibo=null;b.info_for_z_sort_updates=r.O(a.info_for_z_sort_updates);b.shape_keys=r.O(a.shape_keys);b.instance_count=a.instance_count;b.cleanup_gl_data_on_unload=a.cleanup_gl_data_on_unload}else b=null;return b};e.init_submesh=ia;e.clone_submesh=function(a){var b=ia(a.name);b.base_length=a.base_length;b.indices=r.O(a.indices);b.va_frames=r.O(a.va_frames);
b.va_common=r.O(a.va_common);b.shape_keys=r.O(a.shape_keys);V.o(a.submesh_bd.bb_local,b.submesh_bd.bb_local);V.s(a.submesh_bd.be_local,b.submesh_bd.be_local);V.u(a.submesh_bd.bs_local,b.submesh_bd.bs_local);V.v(a.submesh_bd.bbr_local,b.submesh_bd.bbr_local);b.instanced_array_data=r.O(a.instanced_array_data);return b};e.reset=function(){wa=null};e.init_vbo_source_data=ra;e.search_vbo_index_by_type=P;e.get_vbo_by_type=oa;e.get_vbo_source_by_type=Q;e.get_constructor_by_type=da;e.get_vbo_type_by_attr_name=
ja;e.get_type_size_by_attr_name=function(a){switch(ja(a)){case "float":return r.h;case "short":return r.l;case "unsigned_byte":return r.g;default:return r.h}};e.get_gl_type_by_attr_name=function(a){switch(ja(a)){case "float":return wa.FLOAT;case "short":return wa.SHORT;case "unsigned_byte":return wa.UNSIGNED_BYTE;default:return wa.FLOAT}};e.vbo_source_data_set_attr=va;e.value_vbo_to_float=function(a,b){switch(ja(a)){case "short":return r._49(b);case "unsigned_byte":return r._65(b)}return b};e.value_float_to_vbo=
function(a,b){switch(ja(a)){case "short":return r._3(b);case "unsigned_byte":return r._66(b)}return b};e.array_vbo_to_float=Ga;e.array_float_to_vbo=ba;e.create_empty_va_frame=function(){return{a_position:new Float32Array(0),a_tbn:I.c(0)}}});t.a=e},function(C,t,e){function R(d){d[0]=1;d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=1;d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=1;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d}function V(d,k,e){var n=d[0],r=d[1],p=d[2],u=d[3],a=d[4],B=d[5],l=d[6],c=d[7],m=d[8],b=d[9],f=d[10],
I=d[11],y=d[12],z=d[13],G=d[14];d=d[15];var E=k[0],J=k[1],M=k[2],F=k[3];e[0]=E*n+J*a+M*m+F*y;e[1]=E*r+J*B+M*b+F*z;e[2]=E*p+J*l+M*f+F*G;e[3]=E*u+J*c+M*I+F*d;E=k[4];J=k[5];M=k[6];F=k[7];e[4]=E*n+J*a+M*m+F*y;e[5]=E*r+J*B+M*b+F*z;e[6]=E*p+J*l+M*f+F*G;e[7]=E*u+J*c+M*I+F*d;E=k[8];J=k[9];M=k[10];F=k[11];e[8]=E*n+J*a+M*m+F*y;e[9]=E*r+J*B+M*b+F*z;e[10]=E*p+J*l+M*f+F*G;e[11]=E*u+J*c+M*I+F*d;E=k[12];J=k[13];M=k[14];F=k[15];e[12]=E*n+J*a+M*m+F*y;e[13]=E*r+J*B+M*b+F*z;e[14]=E*p+J*l+M*f+F*G;e[15]=E*u+J*c+M*I+F*
d;return e}Object.defineProperty(t,"__esModule",{value:!0});t.create=function(){var d=new y(16);d[0]=1;d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=1;d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=1;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d};t.clone=function(d){var k=new y(16);k[0]=d[0];k[1]=d[1];k[2]=d[2];k[3]=d[3];k[4]=d[4];k[5]=d[5];k[6]=d[6];k[7]=d[7];k[8]=d[8];k[9]=d[9];k[10]=d[10];k[11]=d[11];k[12]=d[12];k[13]=d[13];k[14]=d[14];k[15]=d[15];return k};t.copy=function(d,k){k[0]=d[0];k[1]=d[1];k[2]=d[2];k[3]=d[3];
k[4]=d[4];k[5]=d[5];k[6]=d[6];k[7]=d[7];k[8]=d[8];k[9]=d[9];k[10]=d[10];k[11]=d[11];k[12]=d[12];k[13]=d[13];k[14]=d[14];k[15]=d[15];return k};t.identity=R;t.transpose=function(d,k){if(k===d){var e=d[1],n=d[2],r=d[3],p=d[6],u=d[7],a=d[11];k[1]=d[4];k[2]=d[8];k[3]=d[12];k[4]=e;k[6]=d[9];k[7]=d[13];k[8]=n;k[9]=p;k[11]=d[14];k[12]=r;k[13]=u;k[14]=a}else k[0]=d[0],k[1]=d[4],k[2]=d[8],k[3]=d[12],k[4]=d[1],k[5]=d[5],k[6]=d[9],k[7]=d[13],k[8]=d[2],k[9]=d[6],k[10]=d[10],k[11]=d[14],k[12]=d[3],k[13]=d[7],k[14]=
d[11],k[15]=d[15];return k};t.invert=function(d,k){var e=d[0],n=d[1],r=d[2],p=d[3],u=d[4],a=d[5],B=d[6],l=d[7],c=d[8],m=d[9],b=d[10],f=d[11],T=d[12],y=d[13],z=d[14],G=d[15],E=e*a-n*u,J=e*B-r*u,M=e*l-p*u,F=n*B-r*a,U=n*l-p*a,K=r*l-p*B,t=c*y-m*T,v=c*z-b*T,Y=c*G-f*T,ha=m*z-b*y,S=m*G-f*y,L=b*G-f*z,q=E*L-J*S+M*ha+F*Y-U*v+K*t;if(!q)return null;q=1/q;k[0]=(a*L-B*S+l*ha)*q;k[1]=(r*S-n*L-p*ha)*q;k[2]=(y*K-z*U+G*F)*q;k[3]=(b*U-m*K-f*F)*q;k[4]=(B*Y-u*L-l*v)*q;k[5]=(e*L-r*Y+p*v)*q;k[6]=(z*M-T*K-G*J)*q;k[7]=(c*
K-b*M+f*J)*q;k[8]=(u*S-a*Y+l*t)*q;k[9]=(n*Y-e*S-p*t)*q;k[10]=(T*U-y*M+G*E)*q;k[11]=(m*M-c*U-f*E)*q;k[12]=(a*v-u*ha-B*t)*q;k[13]=(e*ha-n*v+r*t)*q;k[14]=(y*J-T*F-z*E)*q;k[15]=(c*F-m*J+b*E)*q;return k};t.adjoint=function(d,k){var e=d[0],n=d[1],r=d[2],p=d[3],u=d[4],a=d[5],B=d[6],l=d[7],c=d[8],m=d[9],b=d[10],f=d[11],T=d[12],y=d[13],z=d[14],G=d[15];k[0]=a*(b*G-f*z)-m*(B*G-l*z)+y*(B*f-l*b);k[1]=-(n*(b*G-f*z)-m*(r*G-p*z)+y*(r*f-p*b));k[2]=n*(B*G-l*z)-a*(r*G-p*z)+y*(r*l-p*B);k[3]=-(n*(B*f-l*b)-a*(r*f-p*b)+
m*(r*l-p*B));k[4]=-(u*(b*G-f*z)-c*(B*G-l*z)+T*(B*f-l*b));k[5]=e*(b*G-f*z)-c*(r*G-p*z)+T*(r*f-p*b);k[6]=-(e*(B*G-l*z)-u*(r*G-p*z)+T*(r*l-p*B));k[7]=e*(B*f-l*b)-u*(r*f-p*b)+c*(r*l-p*B);k[8]=u*(m*G-f*y)-c*(a*G-l*y)+T*(a*f-l*m);k[9]=-(e*(m*G-f*y)-c*(n*G-p*y)+T*(n*f-p*m));k[10]=e*(a*G-l*y)-u*(n*G-p*y)+T*(n*l-p*a);k[11]=-(e*(a*f-l*m)-u*(n*f-p*m)+c*(n*l-p*a));k[12]=-(u*(m*z-b*y)-c*(a*z-B*y)+T*(a*b-B*m));k[13]=e*(m*z-b*y)-c*(n*z-r*y)+T*(n*b-r*m);k[14]=-(e*(a*z-B*y)-u*(n*z-r*y)+T*(n*B-r*a));k[15]=e*(a*b-B*
m)-u*(n*b-r*m)+c*(n*B-r*a);return k};t.determinant=function(d){var k=d[0],e=d[1],n=d[2],r=d[3],p=d[4],u=d[5],a=d[6],B=d[7],l=d[8],c=d[9],m=d[10],b=d[11],f=d[12],T=d[13],y=d[14];d=d[15];return(k*u-e*p)*(m*d-b*y)-(k*a-n*p)*(c*d-b*T)+(k*B-r*p)*(c*y-m*T)+(e*a-n*u)*(l*d-b*f)-(e*B-r*u)*(l*y-m*f)+(n*B-r*a)*(l*T-c*f)};t.multiply=V;e.d(t,"mul",function(){return V});t.translate=function(d,k,e){var n=k[0],r=k[1];k=k[2];var p,u,a,B,l,c,m,b,f,T,I,z;d===e?(e[12]=d[0]*n+d[4]*r+d[8]*k+d[12],e[13]=d[1]*n+d[5]*r+d[9]*
k+d[13],e[14]=d[2]*n+d[6]*r+d[10]*k+d[14],e[15]=d[3]*n+d[7]*r+d[11]*k+d[15]):(p=d[0],u=d[1],a=d[2],B=d[3],l=d[4],c=d[5],m=d[6],b=d[7],f=d[8],T=d[9],I=d[10],z=d[11],e[0]=p,e[1]=u,e[2]=a,e[3]=B,e[4]=l,e[5]=c,e[6]=m,e[7]=b,e[8]=f,e[9]=T,e[10]=I,e[11]=z,e[12]=p*n+l*r+f*k+d[12],e[13]=u*n+c*r+T*k+d[13],e[14]=a*n+m*r+I*k+d[14],e[15]=B*n+b*r+z*k+d[15]);return e};t.scale=function(d,k,e){var n=k[0],r=k[1];k=k[2];e[0]=d[0]*n;e[1]=d[1]*n;e[2]=d[2]*n;e[3]=d[3]*n;e[4]=d[4]*r;e[5]=d[5]*r;e[6]=d[6]*r;e[7]=d[7]*r;
e[8]=d[8]*k;e[9]=d[9]*k;e[10]=d[10]*k;e[11]=d[11]*k;e[12]=d[12];e[13]=d[13];e[14]=d[14];e[15]=d[15];return e};t.rotate=function(d,k,e,A){var r=e[0],p=e[1];e=e[2];var u=Math.sqrt(r*r+p*p+e*e),a,B,l,c,m,b,f,T,I,z,G,E,J,y,F,U,K,t,v,Y;if(Math.abs(u)<n)return null;u=1/u;r*=u;p*=u;e*=u;a=Math.sin(k);B=Math.cos(k);l=1-B;k=d[0];u=d[1];c=d[2];m=d[3];b=d[4];f=d[5];T=d[6];I=d[7];z=d[8];G=d[9];E=d[10];J=d[11];y=r*r*l+B;F=p*r*l+e*a;U=e*r*l-p*a;K=r*p*l-e*a;t=p*p*l+B;v=e*p*l+r*a;Y=r*e*l+p*a;r=p*e*l-r*a;p=e*e*l+
B;A[0]=k*y+b*F+z*U;A[1]=u*y+f*F+G*U;A[2]=c*y+T*F+E*U;A[3]=m*y+I*F+J*U;A[4]=k*K+b*t+z*v;A[5]=u*K+f*t+G*v;A[6]=c*K+T*t+E*v;A[7]=m*K+I*t+J*v;A[8]=k*Y+b*r+z*p;A[9]=u*Y+f*r+G*p;A[10]=c*Y+T*r+E*p;A[11]=m*Y+I*r+J*p;d!==A&&(A[12]=d[12],A[13]=d[13],A[14]=d[14],A[15]=d[15]);return A};t.rotateX=function(d,k,e){var n=Math.sin(k);k=Math.cos(k);var r=d[4],p=d[5],u=d[6],a=d[7],B=d[8],l=d[9],c=d[10],m=d[11];d!==e&&(e[0]=d[0],e[1]=d[1],e[2]=d[2],e[3]=d[3],e[12]=d[12],e[13]=d[13],e[14]=d[14],e[15]=d[15]);e[4]=r*k+
B*n;e[5]=p*k+l*n;e[6]=u*k+c*n;e[7]=a*k+m*n;e[8]=B*k-r*n;e[9]=l*k-p*n;e[10]=c*k-u*n;e[11]=m*k-a*n;return e};t.rotateY=function(d,k,e){var n=Math.sin(k);k=Math.cos(k);var r=d[0],p=d[1],u=d[2],a=d[3],B=d[8],l=d[9],c=d[10],m=d[11];d!==e&&(e[4]=d[4],e[5]=d[5],e[6]=d[6],e[7]=d[7],e[12]=d[12],e[13]=d[13],e[14]=d[14],e[15]=d[15]);e[0]=r*k-B*n;e[1]=p*k-l*n;e[2]=u*k-c*n;e[3]=a*k-m*n;e[8]=r*n+B*k;e[9]=p*n+l*k;e[10]=u*n+c*k;e[11]=a*n+m*k;return e};t.rotateZ=function(d,k,e){var n=Math.sin(k);k=Math.cos(k);var r=
d[0],p=d[1],u=d[2],a=d[3],B=d[4],l=d[5],c=d[6],m=d[7];d!==e&&(e[8]=d[8],e[9]=d[9],e[10]=d[10],e[11]=d[11],e[12]=d[12],e[13]=d[13],e[14]=d[14],e[15]=d[15]);e[0]=r*k+B*n;e[1]=p*k+l*n;e[2]=u*k+c*n;e[3]=a*k+m*n;e[4]=B*k-r*n;e[5]=l*k-p*n;e[6]=c*k-u*n;e[7]=m*k-a*n;return e};t.fromTranslation=function(d,e){e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=1;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=1;e[11]=0;e[12]=d[0];e[13]=d[1];e[14]=d[2];e[15]=1;return e};t.fromScaling=function(d,e){e[0]=d[0];e[1]=0;e[2]=0;e[3]=0;e[4]=
0;e[5]=d[1];e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=d[2];e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e};t.fromRotation=function(d,e,y){var k=e[0],r=e[1];e=e[2];var p=Math.sqrt(k*k+r*r+e*e),u;if(Math.abs(p)<n)return null;p=1/p;k*=p;r*=p;e*=p;p=Math.sin(d);d=Math.cos(d);u=1-d;y[0]=k*k*u+d;y[1]=r*k*u+e*p;y[2]=e*k*u-r*p;y[3]=0;y[4]=k*r*u-e*p;y[5]=r*r*u+d;y[6]=e*r*u+k*p;y[7]=0;y[8]=k*e*u+r*p;y[9]=r*e*u-k*p;y[10]=e*e*u+d;y[11]=0;y[12]=0;y[13]=0;y[14]=0;y[15]=1;return y};t.fromXRotation=function(d,e){var k=
Math.sin(d),n=Math.cos(d);e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=n;e[6]=k;e[7]=0;e[8]=0;e[9]=-k;e[10]=n;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e};t.fromYRotation=function(d,e){var k=Math.sin(d),n=Math.cos(d);e[0]=n;e[1]=0;e[2]=-k;e[3]=0;e[4]=0;e[5]=1;e[6]=0;e[7]=0;e[8]=k;e[9]=0;e[10]=n;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e};t.fromZRotation=function(d,e){var k=Math.sin(d),n=Math.cos(d);e[0]=n;e[1]=k;e[2]=0;e[3]=0;e[4]=-k;e[5]=n;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=1;e[11]=0;e[12]=
0;e[13]=0;e[14]=0;e[15]=1;return e};t.fromRotationTranslation=function(d,e,n){var k=d[0],r=d[1],p=d[2],u=d[3],a=k+k,B=r+r,l=p+p;d=k*a;var c=k*B,k=k*l,m=r*B,r=r*l,p=p*l,a=u*a,B=u*B,u=u*l;n[0]=1-(m+p);n[1]=c+u;n[2]=k-B;n[3]=0;n[4]=c-u;n[5]=1-(d+p);n[6]=r+a;n[7]=0;n[8]=k+B;n[9]=r-a;n[10]=1-(d+m);n[11]=0;n[12]=e[0];n[13]=e[1];n[14]=e[2];n[15]=1;return n};t.fromRotationTranslationScale=function(d,e,n,A){var k=d[0],p=d[1],u=d[2],a=d[3],B=k+k,l=p+p,c=u+u;d=k*B;var m=k*l,k=k*c,b=p*l,p=p*c,u=u*c,B=a*B,l=a*
l,a=a*c,c=n[0],f=n[1];n=n[2];A[0]=(1-(b+u))*c;A[1]=(m+a)*c;A[2]=(k-l)*c;A[3]=0;A[4]=(m-a)*f;A[5]=(1-(d+u))*f;A[6]=(p+B)*f;A[7]=0;A[8]=(k+l)*n;A[9]=(p-B)*n;A[10]=(1-(d+b))*n;A[11]=0;A[12]=e[0];A[13]=e[1];A[14]=e[2];A[15]=1;return A};t.fromRotationTranslationScaleOrigin=function(d,e,n,A,r){var k=d[0],u=d[1],a=d[2],B=d[3],l=k+k,c=u+u,m=a+a;d=k*l;var b=k*c,k=k*m,f=u*c,u=u*m,a=a*m,l=B*l,c=B*c,B=B*m,m=n[0],T=n[1];n=n[2];var y=A[0],z=A[1];A=A[2];r[0]=(1-(f+a))*m;r[1]=(b+B)*m;r[2]=(k-c)*m;r[3]=0;r[4]=(b-
B)*T;r[5]=(1-(d+a))*T;r[6]=(u+l)*T;r[7]=0;r[8]=(k+c)*n;r[9]=(u-l)*n;r[10]=(1-(d+f))*n;r[11]=0;r[12]=e[0]+y-(r[0]*y+r[4]*z+r[8]*A);r[13]=e[1]+z-(r[1]*y+r[5]*z+r[9]*A);r[14]=e[2]+A-(r[2]*y+r[6]*z+r[10]*A);r[15]=1;return r};t.fromQuat=function(d,e){var k=d[0],n=d[1],r=d[2],p=d[3],u=k+k,a=n+n,B=r+r,k=k*u,l=n*u,n=n*a,c=r*u,m=r*a,r=r*B,u=p*u,a=p*a,p=p*B;e[0]=1-n-r;e[1]=l+p;e[2]=c-a;e[3]=0;e[4]=l-p;e[5]=1-k-r;e[6]=m+u;e[7]=0;e[8]=c+a;e[9]=m-u;e[10]=1-k-n;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e};
t.frustum=function(d,e,n,A,r,p,u){var a=1/(e-d),k=1/(A-n),l=1/(r-p);u[0]=2*r*a;u[1]=0;u[2]=0;u[3]=0;u[4]=0;u[5]=2*r*k;u[6]=0;u[7]=0;u[8]=(e+d)*a;u[9]=(A+n)*k;u[10]=(p+r)*l;u[11]=-1;u[12]=0;u[13]=0;u[14]=p*r*2*l;u[15]=0;return u};t.perspective=function(d,e,n,A,r){d=1/Math.tan(d/2);var k=1/(n-A);r[0]=d/e;r[1]=0;r[2]=0;r[3]=0;r[4]=0;r[5]=d;r[6]=0;r[7]=0;r[8]=0;r[9]=0;r[10]=(A+n)*k;r[11]=-1;r[12]=0;r[13]=0;r[14]=2*A*n*k;r[15]=0;return r};t.perspectiveFromFieldOfView=function(d,e,n,A){var k=Math.tan(d.upDegrees*
Math.PI/180),p=Math.tan(d.downDegrees*Math.PI/180),u=Math.tan(d.leftDegrees*Math.PI/180);d=Math.tan(d.rightDegrees*Math.PI/180);var a=2/(u+d),B=2/(k+p);A[0]=a;A[1]=0;A[2]=0;A[3]=0;A[4]=0;A[5]=B;A[6]=0;A[7]=0;A[8]=-((u-d)*a*.5);A[9]=(k-p)*B*.5;A[10]=n/(e-n);A[11]=-1;A[12]=0;A[13]=0;A[14]=n*e/(e-n);A[15]=0;return A};t.ortho=function(d,e,n,A,r,p,u){var a=1/(d-e),k=1/(n-A),l=1/(r-p);u[0]=-2*a;u[1]=0;u[2]=0;u[3]=0;u[4]=0;u[5]=-2*k;u[6]=0;u[7]=0;u[8]=0;u[9]=0;u[10]=2*l;u[11]=0;u[12]=(d+e)*a;u[13]=(A+n)*
k;u[14]=(p+r)*l;u[15]=1;return u};t.lookAt=function(d,e,y,A){var k,p,u,a,B,l,c,m,b=d[0],f=d[1];d=d[2];u=y[0];a=y[1];p=y[2];c=e[0];y=e[1];k=e[2];if(Math.abs(b-c)<n&&Math.abs(f-y)<n&&Math.abs(d-k)<n)return R(A);e=b-c;y=f-y;c=d-k;m=1/Math.sqrt(e*e+y*y+c*c);e*=m;y*=m;c*=m;k=a*c-p*y;p=p*e-u*c;u=u*y-a*e;(m=Math.sqrt(k*k+p*p+u*u))?(m=1/m,k*=m,p*=m,u*=m):u=p=k=0;a=y*u-c*p;B=c*k-e*u;l=e*p-y*k;(m=Math.sqrt(a*a+B*B+l*l))?(m=1/m,a*=m,B*=m,l*=m):l=B=a=0;A[0]=k;A[1]=a;A[2]=e;A[3]=0;A[4]=p;A[5]=B;A[6]=y;A[7]=0;
A[8]=u;A[9]=l;A[10]=c;A[11]=0;A[12]=-(k*b+p*f+u*d);A[13]=-(a*b+B*f+l*d);A[14]=-(e*b+y*f+c*d);A[15]=1;return A};t.str=function(d){return"mat4("+d[0]+", "+d[1]+", "+d[2]+", "+d[3]+", "+d[4]+", "+d[5]+", "+d[6]+", "+d[7]+", "+d[8]+", "+d[9]+", "+d[10]+", "+d[11]+", "+d[12]+", "+d[13]+", "+d[14]+", "+d[15]+")"};t.frob=function(d){return Math.sqrt(Math.pow(d[0],2)+Math.pow(d[1],2)+Math.pow(d[2],2)+Math.pow(d[3],2)+Math.pow(d[4],2)+Math.pow(d[5],2)+Math.pow(d[6],2)+Math.pow(d[7],2)+Math.pow(d[8],2)+Math.pow(d[9],
2)+Math.pow(d[10],2)+Math.pow(d[11],2)+Math.pow(d[12],2)+Math.pow(d[13],2)+Math.pow(d[14],2)+Math.pow(d[15],2))};var n=1E-7,y="undefined"!==typeof Float32Array?Float32Array:Array},function(C,t,e){C=e(0);var R=e(16),V=e(14),n=e(4),y=e(71),d=e(45),k=e(72),I=e(28),A=e(20),r=e(8),p=e(11),u=e(17),a=e(6),B=e(2),l=e(37),c=e(3);e=Object(C.a)("__renderer",function(e,b){function f(b){for(var h=b.camera,f=b.draw_data,d=null,l=a.j(h.world_tsr,P),e=0;e<f.length;e++){var k=f[e];if(k.do_render){var m=k.shader,q=
k.bundles;if(m.program!=d){H.useProgram(m.program);for(var d=b,w=h,D=m,z=D.transient_sc_uniform_setters,n=z.length;n--;){var p=z[n];p.fun(H,p.loc,d,w)}if(D.need_uniforms_update&&!D.no_permanent_uniforms)for(D.permanent_sc_uniform_setters.length||G(D),D=D.permanent_sc_uniform_setters,z=D.length;z--;)p=D[z],p.fun(H,p.loc,d,w);d=m.program}k.alpha_antialiasing?(H.enable(H.SAMPLE_ALPHA_TO_COVERAGE),b.blend||H.enable(H.BLEND)):(H.disable(H.SAMPLE_ALPHA_TO_COVERAGE),b.blend||H.disable(H.BLEND));for(k=0;k<
q.length;k++)if(z=q[k],z.do_render){D=z.obj_render;w=z.batch;K.start_batch(w);K.is_debug_view_render_time_mode()&&"DEBUG_VIEW"==w.type&&(w.debug_main_batch_render_time=B._51(E.batch_get_debug_storage(w.debug_main_batch_id),w.debug_main_batch_render_time,1,15));if(da.alpha_sort&&w.z_sort){var p=D,z=z.info_for_z_sort_updates,n=l,r=w.bufs_data;if(c.dist(n,z.zsort_eye_last)>da.alpha_sort_threshold*Math.min(z.bb_min_side,1)||p.force_zsort)v.update_buffers_movable(r,z,p.world_tsr,n),c.copy(n,z.zsort_eye_last),
p.force_zsort=!1}for(var p=b,z=w,n=m,L=n.transient_uniform_setters,u=L.length;u--;)r=L[u],r.fun(H,r.loc,D,z);if(n.need_uniforms_update&&!n.no_permanent_uniforms){n.permanent_uniform_setters.length||G(n);L=n.permanent_uniform_setters;for(u=L.length;u--;)r=L[u],r.fun(H,r.loc,D,z);n.need_uniforms_update=!1}H.depthMask(z.depth_mask);z.use_backface_culling?H.enable(H.CULL_FACE):H.disable(H.CULL_FACE);r=z.textures;L=H;for(u=0;u<r.length;u++){var S=r[u];L.activeTexture(L.TEXTURE0+u);L.bindTexture(S.w_target,
S.w_texture);S.use_mipmap&&L.generateMipmap(S.w_target)}if(p.type==Y.SKY||p.type==Y.IRRADIANCE){D=p;n=n.uniforms;L=D.camera.color_attachment;r=L.w_texture;L=L.w_target;u=D.cube_view_matrices;for(S=0;6>S;S++){var A=fa(S);da.clear_procedural_sky_hack?(H.bindTexture(H.TEXTURE_CUBE_MAP,r),H.texImage2D(A,0,H.RGBA,1,1,0,H.RGBA,H.UNSIGNED_BYTE,ea)):(H.uniformMatrix4fv(n.u_cube_view_matrix,!1,u[S]),H.uniform4fv(n.u_sky_tex_fac,D.sky_tex_fac),H.uniform3fv(n.u_sky_tex_color,D.sky_tex_color),H.uniform1f(n.u_sky_tex_dvar,
D.sky_tex_default_value),H.uniform3fv(n.u_horizon_color,D.horizon_color),H.uniform3fv(n.u_zenith_color,D.zenith_color),H.framebufferTexture2D(H.FRAMEBUFFER,H.COLOR_ATTACHMENT0,A,r,0),za(z,0));if(D.need_fog_update&&5!=S){var A=D,ia=S,g=Q;da.clear_procedural_sky_hack?g.set(ea):(H.readPixels(191,191,1,1,H.RGBA,H.UNSIGNED_BYTE,g),255!=g[0]&&255!=g[1]&&255!=g[2]||H.readPixels(191,220,1,1,H.RGBA,H.UNSIGNED_BYTE,g));var T=g[0],y=g[1],g=g[2],T=T/255,y=y/255,g=g/255;4===ia?(A.cube_fog[3]=T,A.cube_fog[7]=y,
A.cube_fog[11]=g):(A.cube_fog[4*ia]=T,A.cube_fog[4*ia+1]=y,A.cube_fog[4*ia+2]=g)}}da.texture_lod_available&&(H.bindTexture(L,r),H.generateMipmap(L),H.texParameteri(L,H.TEXTURE_MIN_FILTER,ha.TF_LINEAR_MIPMAP_LINEAR));H.bindFramebuffer(H.FRAMEBUFFER,null);p.debug_render_calls+=6}else if(p.type==Y.ROUGHNESS_CONVOLUTION){D=z;z=n.uniforms;r=p.camera.color_attachment;n=r.w_texture;L=r.w_target;r=p.cube_view_matrices;da.texture_lod_available&&(H.activeTexture(H.TEXTURE7),H.bindTexture(L,n),H.generateMipmap(L),
H.texParameteri(L,H.TEXTURE_MIN_FILTER,ha.TF_LINEAR_MIPMAP_LINEAR));for(L=0;5>L;++L)for(H.viewport(0,0,128*Math.pow(.5,L),128*Math.pow(.5,L)),u=L/4,S=0;6>S;S++)A=fa(S),H.uniformMatrix4fv(z.u_cube_view_matrix,!1,r[S]),H.uniform1f(z.u_roughness,u),H.framebufferTexture2D(H.FRAMEBUFFER,H.COLOR_ATTACHMENT0,A,n,L),za(D,0);p.debug_render_calls+=30}else za(z,D.va_frame),p.debug_render_calls++;K.stop_batch(w);K.is_debug_view_render_time_mode()&&"MAIN"==w.type&&E.batch_set_debug_storage(w.id,w.debug_render_time)}}}}
function m(a){if(a){var b=(a.clear_color?H.COLOR_BUFFER_BIT:0)|(a.clear_depth?H.DEPTH_BUFFER_BIT:0);if(!b)return;switch(a.type){case Y.MAIN_GLOW:a=w;break;case Y.SHADOW_CAST:a=S;break;case Y.SHADOW_RECEIVE:a=L;break;case Y.COLOR_PICKING:case Y.COLOR_PICKING_XRAY:case Y.ANCHOR_VISIBILITY:a=q;break;case Y.MAIN_OPAQUE:case Y.OUTLINE_MASK:case Y.SMAA_BLENDING_WEIGHT_CALCULATION:case Y.SMAA_EDGE_DETECTION:a=w;break;default:a=da.background_color}}else b=H.COLOR_BUFFER_BIT|H.DEPTH_BUFFER_BIT,a=da.background_color;
H.colorMask(!0,!0,!0,!0);H.depthMask(!0);H.clearColor(a[0],a[1],a[2],a[3]);H.clear(b)}function fa(a){switch(a){case 0:return H.TEXTURE_CUBE_MAP_POSITIVE_X;case 1:return H.TEXTURE_CUBE_MAP_NEGATIVE_X;case 2:return H.TEXTURE_CUBE_MAP_POSITIVE_Y;case 3:return H.TEXTURE_CUBE_MAP_NEGATIVE_Y;case 4:return H.TEXTURE_CUBE_MAP_POSITIVE_Z;case 5:return H.TEXTURE_CUBE_MAP_NEGATIVE_Z}}function z(a){var b=t.get_vertex_array_object(),c=a.attribute_setters,f=a.bufs_data,d=f.pointers;a.vaos.length=0;var l=1,e;for(e in d)l=
Math.max(l,d[e].frames);for(d=0;d<l;d++){e=b.createVertexArray();ra(e);f.ibo&&H.bindBuffer(H.ELEMENT_ARRAY_BUFFER,f.ibo);for(var k=0;k<f.vbo_data.length;k++){H.bindBuffer(H.ARRAY_BUFFER,f.vbo_data[k].vbo);for(var m=0;m<c.length;m++){var q=c[m];q.vbo_type==f.vbo_data[k].type&&(H.enableVertexAttribArray(q.loc),H.vertexAttribPointer(q.loc,q.num_comp,q.gl_type,q.gl_type==H.FLOAT?!1:!0,0,q.base_offset+q.frame_length*d),h(q.loc,q.divisor))}}ra(null);a.vaos.push(e)}}function G(b){var c=b.uniforms,h=b.transient_uniform_setters,
f=b.permanent_uniform_setters,d=b.transient_sc_uniform_setters,l=b.permanent_sc_uniform_setters;h.length=0;f.length=0;d.length=0;l.length=0;for(var e in c){var k=!1,m=null,q=null;switch(e){case "u_proj_matrix":case "u_proj_matrix_frag":m=function(a,b,c,h){a.uniformMatrix4fv(b,!1,h.proj_matrix)};k=!0;break;case "u_view_refl_matrix":m=function(a,b,c,h){a.uniformMatrix4fv(b,!1,h.view_refl_matrix)};k=!0;break;case "u_view_tsr":case "u_view_tsr_frag":m=function(a,b,c,h){h.reflection_plane?a.uniformMatrix3fv(b,
!1,h.real_view_tsr):a.uniformMatrix3fv(b,!1,h.view_tsr)};k=!0;break;case "u_view_tsr_inverse":m=function(a,b,c,h){h.reflection_plane?a.uniformMatrix3fv(b,!1,h.real_view_tsr_inv):a.uniformMatrix3fv(b,!1,h.view_tsr_inv)};k=!0;break;case "u_shadow_cast_billboard_view_tsr":m=function(a,b,c,h){a.uniformMatrix3fv(b,!1,h.shadow_cast_billboard_view_tsr)};k=!0;break;case "u_view_proj_prev":m=function(a,b,c,h){a.uniformMatrix4fv(b,!1,h.prev_view_proj_matrix)};k=!0;break;case "u_view_proj_matrix":m=function(a,
b,c,h){a.uniformMatrix4fv(b,!1,h.view_proj_matrix)};k=!0;break;case "u_view_proj_inverse":m=function(a,b,c,h){a.uniformMatrix4fv(b,!1,h.view_proj_inv_matrix)};k=!0;break;case "u_sky_vp_inverse":m=function(a,b,c,h){a.uniformMatrix4fv(b,!1,h.sky_vp_inv_matrix)};k=!0;break;case "u_camera_eye":case "u_camera_eye_frag":m=function(b,c,h,f){b.uniform3fv(c,a.j(f.world_tsr,P))};k=!0;break;case "u_camera_quat":m=function(b,c,h,f){b.uniform4fv(c,a.g(f.world_tsr,oa))};k=!0;break;case "u_view_max_depth":m=function(a,
b,c,h){a.uniform1f(b,h.far)};k=!0;break;case "u_camera_range":m=function(a,b,c,h){a.uniform2f(b,h.near,h.far)};k=!0;break;case "u_csm_center_dists":m=function(a,b,c,h){a.uniform4fv(b,h.csm_center_dists)};break;case "u_height":m=function(a,b,c,h){a.uniform1f(b,h.height)};k=!0;break;case "u_pcf_blur_radii":m=function(a,b,c,h){a.uniform4fv(b,h.pcf_blur_radii)};break;case "u_dof_dist":m=function(a,b,c,h){h.dof_on?a.uniform1f(b,h.dof_distance):a.uniform1f(b,0)};k=!0;break;case "u_dof_front_start":m=function(a,
b,c,h){a.uniform1f(b,h.dof_front_start)};k=!0;break;case "u_dof_front_end":m=function(a,b,c,h){a.uniform1f(b,h.dof_front_end)};k=!0;break;case "u_dof_rear_start":m=function(a,b,c,h){a.uniform1f(b,h.dof_rear_start)};k=!0;break;case "u_dof_rear_end":m=function(a,b,c,h){a.uniform1f(b,h.dof_rear_end)};k=!0;break;case "u_dof_bokeh_intensity":m=function(a,b,c,h){a.uniform1f(b,h.dof_bokeh_intensity)};k=!0;break;case "u_camera_direction":m=function(a,b,c,h){a.uniform3fv(b,h.direction)};k=!0;break;case "u_cam_water_depth":m=
function(a,b,c,h){a.uniform1f(b,c.cam_water_depth)};k=!0;break;case "u_fog_color_density":m=function(a,b,c,h){a.uniform4fv(b,c.fog_color_density)};break;case "u_fog_params":m=function(a,b,c,h){a.uniform4fv(b,c.fog_params)};break;case "u_underwater_fog_color_density":m=function(a,b,c,h){a.uniform4fv(b,c.water_fog_color_density)};break;case "u_bloom_key":m=function(a,b,c,h){a.uniform1f(b,c.bloom_key)};break;case "u_average_lum_val":m=function(a,b,c,h){a.uniform1f(b,c.average_luminance)};break;case "u_mipmap_1x1":m=
function(a,b,c,h){a.uniform1f(b,c.last_mip_map_ind)};break;case "u_bloom_edge_lum":m=function(a,b,c,h){a.uniform1f(b,c.bloom_edge_lum)};break;case "u_time":m=function(a,b,c,h){a.uniform1f(b,c.time)};k=!0;break;case "u_wind":m=function(a,b,c,h){a.uniform3fv(b,c.wind)};k=!0;break;case "u_sky_tex_dvar":m=function(a,b,c,h){a.uniform1f(b,c.sky_tex_default_value)};break;case "u_sky_tex_fac":m=function(a,b,c,h){a.uniform4fv(b,c.sky_tex_fac)};break;case "u_sky_tex_color":m=function(a,b,c,h){a.uniform3fv(b,
c.sky_tex_color)};break;case "u_horizon_color":m=function(a,b,c,h){a.uniform3fv(b,c.horizon_color)};break;case "u_zenith_color":m=function(a,b,c,h){a.uniform3fv(b,c.zenith_color)};break;case "u_environment_energy":m=function(a,b,c,h){a.uniform1f(b,c.environment_energy)};break;case "u_bsdf_cube_sky_dim":m=function(a,b,c,h){a.uniform1f(b,c.bsdf_cube_sky_dim)};k=!0;break;case "u_sky_color":m=function(a,b,c,h){a.uniform3fv(b,c.sky_color)};break;case "u_rayleigh_brightness":m=function(a,b,c,h){a.uniform1f(b,
c.rayleigh_brightness)};break;case "u_mie_brightness":m=function(a,b,c,h){a.uniform1f(b,c.mie_brightness)};break;case "u_spot_brightness":m=function(a,b,c,h){a.uniform1f(b,c.spot_brightness)};break;case "u_scatter_strength":m=function(a,b,c,h){a.uniform1f(b,c.scatter_strength)};break;case "u_rayleigh_strength":m=function(a,b,c,h){a.uniform1f(b,c.rayleigh_strength)};break;case "u_mie_strength":m=function(a,b,c,h){a.uniform1f(b,c.mie_strength)};break;case "u_rayleigh_collection_power":m=function(a,
b,c,h){a.uniform1f(b,c.rayleigh_collection_power)};break;case "u_mie_collection_power":m=function(a,b,c,h){a.uniform1f(b,c.mie_collection_power)};break;case "u_mie_distribution":m=function(a,b,c,h){a.uniform1f(b,c.mie_distribution)};break;case "u_light_positions":m=function(a,b,c,h){a.uniform4fv(b,c.light_positions)};break;case "u_light_directions":m=function(a,b,c,h){a.uniform3fv(b,c.light_directions)};break;case "u_light_color_intensities":m=function(a,b,c,h){a.uniform4fv(b,c.light_color_intensities)};
break;case "u_sun_quaternion":m=function(a,b,c,h){a.uniform4fv(b,c.sun_quaternion)};break;case "u_sun_intensity":m=function(a,b,c,h){a.uniform3fv(b,c.sun_intensity)};break;case "u_sun_direction":m=function(a,b,c,h){a.uniform3fv(b,c.sun_direction)};break;case "u_debug_view_mode":m=function(a,b,c,h){a.uniform1i(b,c.debug_view_mode)};break;case "u_debug_colors_seed":m=function(a,b,c,h){a.uniform1f(b,c.debug_colors_seed)};break;case "u_debug_render_time_threshold":m=function(a,b,c,h){a.uniform1f(b,c.debug_render_time_threshold)};
break;case "u_subpixel_jitter":m=function(a,b,c,h){a.uniform2fv(b,c.jitter_projection_space)};k=!0;break;case "u_subsample_indices":m=function(a,b,c,h){a.uniform4fv(b,c.jitter_subsample_ind)};k=!0;break;case "u_radial_blur_step":m=function(a,b,c,h){a.uniform1f(b,c.radial_blur_step)};break;case "u_god_rays_intensity":m=function(a,b,c,h){a.uniform1f(b,c.god_rays_intensity)};break;case "u_ssao_radius_increase":m=function(a,b,c,h){a.uniform1f(b,c.ssao_radius_increase)};break;case "u_ssao_blur_discard_value":m=
function(a,b,c,h){a.uniform1f(b,c.ssao_blur_discard_value)};k=!0;break;case "u_ssao_influence":m=function(a,b,c,h){a.uniform1f(b,c.ssao_influence)};break;case "u_ssao_dist_factor":m=function(a,b,c,h){a.uniform1f(b,c.ssao_dist_factor)};break;case "u_texel_size":m=function(a,b,c,h){a.uniform2fv(b,c.texel_size)};k=!0;break;case "u_normal_offset":m=function(a,b,c,h){a.uniform1f(b,c.self_shadow_normal_offset)};break;case "u_v_light_ts":m=function(a,b,c,h){a.uniform4fv(b,c.v_light_ts)};k=!0;break;case "u_v_light_r":m=
function(a,b,c,h){a.uniform4fv(b,c.v_light_r)};k=!0;break;case "u_v_light_tsr":m=function(a,b,c,h){a.uniformMatrix3fv(b,!1,c.v_light_tsr)};k=!0;break;case "u_p_light_matrix0":m=function(a,b,c,h){a.uniformMatrix4fv(b,!1,c.p_light_matrix[0])};k=!0;break;case "u_p_light_matrix1":m=function(a,b,c,h){a.uniformMatrix4fv(b,!1,c.p_light_matrix[1])};k=!0;break;case "u_p_light_matrix2":m=function(a,b,c,h){a.uniformMatrix4fv(b,!1,c.p_light_matrix[2])};k=!0;break;case "u_p_light_matrix3":m=function(a,b,c,h){a.uniformMatrix4fv(b,
!1,c.p_light_matrix[3])};k=!0;break;case "u_outline_color":m=function(a,b,c,h){a.uniform3fv(b,c.outline_color)};break;case "u_draw_outline":m=function(a,b,c,h){a.uniform1f(b,c.draw_outline_flag)};k=!0;break;case "u_glow_mask_small_coeff":m=function(a,b,c,h){a.uniform1f(b,c.small_glow_mask_coeff)};k=!0;break;case "u_glow_mask_large_coeff":m=function(a,b,c,h){a.uniform1f(b,c.large_glow_mask_coeff)};k=!0;break;case "u_brightness":m=function(a,b,c,h){a.uniform1f(b,c.brightness)};break;case "u_contrast":m=
function(a,b,c,h){a.uniform1f(b,c.contrast)};break;case "u_exposure":m=function(a,b,c,h){a.uniform1f(b,c.exposure)};break;case "u_saturation":m=function(a,b,c,h){a.uniform1f(b,c.saturation)};break;case "u_enable_hmd_stereo":m=function(a,b,c,h){a.uniform1i(b,c.enable_hmd_stereo)};break;case "u_distortion_params":m=function(a,b,c,h){a.uniform4fv(b,c.distortion_params)};break;case "u_chromatic_aberration_coefs":m=function(a,b,c,h){a.uniform4fv(b,c.chromatic_aberration_coefs)};break;case "u_motion_blur_exp":m=
function(a,b,c,h){a.uniform1f(b,c.motion_blur_exp)};k=!0;break;case "u_motion_blur_decay_threshold":m=function(a,b,c,h){a.uniform1f(b,c.mb_decay_threshold)};k=!0;break;case "u_model_tsr":q=function(a,b,c,h){a.uniformMatrix3fv(b,!1,c.world_tsr)};k=!0;break;case "u_model_tsr_inverse":q=function(a,b,c,h){a.uniformMatrix3fv(b,!1,c.world_tsr_inv)};k=!0;break;case "u_transb":q=function(a,b,c,h){a.uniform4fv(b,c.trans_before)};k=!0;break;case "u_transa":q=function(a,b,c,h){a.uniform4fv(b,c.trans_after)};
k=!0;break;case "u_arm_rel_trans":q=function(a,b,c,h){a.uniform4fv(b,c.arm_rel_trans)};k=!0;break;case "u_arm_rel_quat":q=function(a,b,c,h){a.uniform4fv(b,c.arm_rel_quat)};k=!0;break;case "u_quat":q=function(b,c,h,f){b.uniform4fv(c,a.g(h.world_tsr,oa))};k=!0;break;case "u_quatsb":q=function(a,b,c,h){a.uniform4fv(b,c.quats_before)};k=!0;break;case "u_quatsa":q=function(a,b,c,h){a.uniform4fv(b,c.quats_after)};k=!0;break;case "u_frame_factor":q=function(a,b,c,h){a.uniform1f(b,c.frame_factor)};k=!0;break;
case "au_center_pos":q=function(a,b,c,h){a.uniform3fv(b,c.center_pos)};k=!0;break;case "au_wind_bending_amp":q=function(a,b,c,h){a.uniform1f(b,c.wind_bending_amp)};k=!0;break;case "au_wind_bending_freq":q=function(a,b,c,h){a.uniform1f(b,c.wind_bending_freq)};k=!0;break;case "au_detail_bending_freq":q=function(a,b,c,h){a.uniform1f(b,c.detail_bending_freq)};k=!0;break;case "au_detail_bending_amp":q=function(a,b,c,h){a.uniform1f(b,c.detail_bending_amp)};k=!0;break;case "au_branch_bending_amp":q=function(a,
b,c,h){a.uniform1f(b,c.branch_bending_amp)};k=!0;break;case "u_node_values":q=function(a,b,c,h){a.uniform4fv(b,h.node_values)};k=!0;break;case "u_node_rgbs":q=function(a,b,c,h){a.uniform3fv(b,h.node_rgbs)};k=!0;break;case "u_lod_coverage":q=function(a,b,c,h){a.uniform1f(b,h.lod_settings.coverage)};k=!0;break;case "u_lod_cmp_logic":q=function(a,b,c,h){a.uniform1f(b,h.lod_settings.cmp_logic)};k=!0;break;case "u_diffuse_color":q=function(a,b,c,h){a.uniform4fv(b,h.diffuse_color)};k=!0;break;case "u_diffuse_intensity":q=
function(a,b,c,h){a.uniform1f(b,h.diffuse_intensity)};k=!0;break;case "u_diffuse_params":q=function(a,b,c,h){a.uniform2fv(b,h.diffuse_params)};k=!0;break;case "u_emit":q=function(a,b,c,h){a.uniform1f(b,h.emit)};k=!0;break;case "u_ambient":q=function(a,b,c,h){a.uniform1f(b,h.ambient)};k=!0;break;case "u_specular_color":q=function(a,b,c,h){a.uniform3fv(b,h.specular_color)};k=!0;break;case "u_specular_alpha":q=function(a,b,c,h){a.uniform1f(b,h.specular_alpha)};k=!0;break;case "u_specular_params":q=function(a,
b,c,h){a.uniform3fv(b,h.specular_params)};k=!0;break;case "u_reflect_factor":q=function(a,b,c,h){a.uniform1f(b,h.reflect_factor)};k=!0;break;case "u_mirror_factor":q=function(a,b,c,h){a.uniform1f(b,h.mirror_factor)};k=!0;break;case "u_grass_map_dim":q=function(a,b,c,h){a.uniform3fv(b,h.grass_map_dim)};k=!0;break;case "u_grass_size":q=function(a,b,c,h){a.uniform1f(b,h.grass_size)};k=!0;break;case "u_scale_threshold":q=function(a,b,c,h){a.uniform1f(b,h.grass_scale_threshold)};k=!0;break;case "u_cube_fog":q=
function(a,b,c,h){a.uniformMatrix4fv(b,!1,h.cube_fog)};break;case "u_jitter_amp":q=function(a,b,c,h){a.uniform1f(b,h.jitter_amp)};k=!0;break;case "u_jitter_freq":q=function(a,b,c,h){a.uniform1f(b,h.jitter_freq)};k=!0;break;case "u_wireframe_edge_color":q=function(a,b,c,h){a.uniform3fv(b,h.wireframe_edge_color)};break;case "u_cluster_id":q=function(a,b,c,h){a.uniform1f(b,h.cluster_id)};k=!0;break;case "u_batch_debug_id_color":q=function(a,b,c,h){a.uniform1f(b,h.debug_id_color)};k=!0;break;case "u_batch_debug_main_render_time":q=
function(a,b,c,h){a.uniform1f(b,h.debug_main_batch_render_time)};k=!0;break;case "u_refr_bump":q=function(a,b,c,h){a.uniform1f(b,h.refr_bump)};k=!0;break;case "u_line_width":q=function(a,b,c,h){a.uniform1f(b,h.line_width)};k=!0;break;case "u_lamp_light_positions":q=function(a,b,c,h){a.uniform3fv(b,h.lamp_light_positions)};break;case "u_lamp_light_directions":q=function(a,b,c,h){a.uniform3fv(b,h.lamp_light_directions)};break;case "u_lamp_light_color_intensities":q=function(a,b,c,h){a.uniform3fv(b,
h.lamp_light_color_intensities)};break;case "u_halo_size":q=function(a,b,c,h){a.uniform1f(b,h.halo_size)};k=!0;break;case "u_halo_hardness":q=function(a,b,c,h){a.uniform1f(b,h.halo_hardness)};k=!0;break;case "u_halo_rings_color":q=function(a,b,c,h){a.uniform3fv(b,h.halo_rings_color)};k=!0;break;case "u_halo_lines_color":q=function(a,b,c,h){a.uniform3fv(b,h.halo_lines_color)};k=!0;break;case "u_halo_stars_blend":q=function(a,b,c,h){a.uniform1f(b,h.halo_stars_blend)};k=!0;break;case "u_halo_stars_height":q=
function(a,b,c,h){a.uniform1f(b,h.halo_stars_height)};k=!0;break;case "u_fresnel_params":q=function(a,b,c,h){a.uniform2fv(b,h.fresnel_params)};k=!0;break;case "u_texture_scale":q=function(a,b,c,h){a.uniform3fv(b,h.texture_scale)};k=!0;break;case "u_parallax_scale":q=function(a,b,c,h){a.uniform1f(b,h.parallax_scale)};k=!0;break;case "u_color_id":q=function(a,b,c,h){a.uniform3fv(b,c.color_id)};k=!0;break;case "u_diffuse_color_factor":q=function(a,b,c,h){a.uniform1f(b,h.diffuse_color_factor)};k=!0;break;
case "u_alpha_factor":q=function(a,b,c,h){a.uniform1f(b,h.alpha_factor)};k=!0;break;case "u_specular_color_factor":q=function(a,b,c,h){a.uniform1f(b,h.specular_color_factor)};k=!0;break;case "u_normal_factor":q=function(a,b,c,h){a.uniform1f(b,h.normal_factor)};k=!0;break;case "u_normalmap0_scale":q=function(a,b,c,h){a.uniform2fv(b,h.normalmap_scales[0])};k=!0;break;case "u_normalmap1_scale":q=function(a,b,c,h){a.uniform2fv(b,h.normalmap_scales[1])};k=!0;break;case "u_normalmap2_scale":q=function(a,
b,c,h){a.uniform2fv(b,h.normalmap_scales[2])};k=!0;break;case "u_normalmap3_scale":q=function(a,b,c,h){a.uniform2fv(b,h.normalmap_scales[3])};k=!0;break;case "u_foam_factor":q=function(a,b,c,h){a.uniform1f(b,h.foam_factor)};k=!0;break;case "u_foam_uv_freq":q=function(a,b,c,h){a.uniform2fv(b,h.foam_uv_freq)};k=!0;break;case "u_foam_mag":q=function(a,b,c,h){a.uniform2fv(b,h.foam_mag)};k=!0;break;case "u_foam_scale":q=function(a,b,c,h){a.uniform2fv(b,h.foam_scale)};k=!0;break;case "u_water_norm_uv_velocity":q=
function(a,b,c,h){a.uniform1f(b,h.water_norm_uv_velocity)};k=!0;break;case "u_shallow_water_col":q=function(a,b,c,h){a.uniform3fv(b,h.shallow_water_col)};k=!0;break;case "u_shore_water_col":q=function(a,b,c,h){a.uniform3fv(b,h.shore_water_col)};k=!0;break;case "u_water_shallow_col_fac":q=function(a,b,c,h){a.uniform1f(b,h.shallow_water_col_fac)};k=!0;break;case "u_water_shore_col_fac":q=function(a,b,c,h){a.uniform1f(b,h.shore_water_col_fac)};k=!0;break;case "u_p_length":q=function(a,b,c,h){a.uniform1f(b,
h.particles_data.time_length)};k=!0;break;case "u_p_cyclic":q=function(a,b,c,h){a.uniform1i(b,h.particles_data.cyclic)};k=!0;break;case "u_p_max_lifetime":q=function(a,b,c,h){a.uniform1f(b,h.particles_data.lifetime)};k=!0;break;case "u_p_fade_in":q=function(a,b,c,h){a.uniform1f(b,h.particles_data.fade_in)};k=!0;break;case "u_p_fade_out":q=function(a,b,c,h){a.uniform1f(b,h.particles_data.fade_out)};k=!0;break;case "u_p_size":q=function(a,b,c,h){a.uniform1f(b,h.particles_data.size)};k=!0;break;case "u_p_alpha_start":q=
function(a,b,c,h){a.uniform1f(b,h.particles_data.alpha_start)};k=!0;break;case "u_p_alpha_end":q=function(a,b,c,h){a.uniform1f(b,h.particles_data.alpha_end)};k=!0;break;case "u_p_nfactor":q=function(a,b,c,h){a.uniform1f(b,h.particles_data.nfactor)};k=!0;break;case "u_p_gravity":q=function(a,b,c,h){a.uniform1f(b,h.particles_data.gravity)};k=!0;break;case "u_p_mass":q=function(a,b,c,h){a.uniform1f(b,h.particles_data.mass)};k=!0;break;case "u_p_color_ramp":q=function(a,b,c,h){a.uniform4fv(b,h.particles_data.color_ramp)};
k=!0;break;case "u_p_wind_fac":q=function(a,b,c,h){a.uniform1f(b,h.particles_data.wind_factor)};k=!0;break;case "u_p_time":q=function(a,b,c,h){a.uniform1f(b,h.particles_data.time)};k=!0;break;case "u_p_tilt":q=function(a,b,c,h){a.uniform1f(b,h.particles_data.tilt)};k=!0;break;case "u_p_tilt_rand":q=function(a,b,c,h){a.uniform1f(b,h.particles_data.tilt_rand)};k=!0;break;case "u_position":q=function(a,b,c,h){a.uniform3fv(b,h.anchor_positions)};k=!0;break;case "u_va_frame_factor":q=function(a,b,c,h){a.uniform1f(b,
c.va_frame_factor)};k=!0;break;case "u_refl_plane":q=function(a,b,c,h){a.uniform4fv(b,c.reflection_plane)};k=!0;break;case "u_outline_intensity":q=function(a,b,c,h){a.uniform1f(b,c.outline_intensity)};k=!0;break;case "u_obj_info":q=function(a,b,c,h){a.uniform3fv(b,h.obj_info_params)},k=!0}q&&(q={name:e,fun:q,loc:c[e]},k?h.push(q):f.push(q));m&&(q={name:e,fun:m,loc:c[e]},k?d.push(q):l.push(q))}if(f.length||l.length){b=b.permanent_uniform_setters_table;for(var w in b)delete b[w];for(w=0;w<f.length;w++)q=
f[w],b[q.name]=q;for(w=0;w<l.length;w++)q=l[w],b[q.name]=q}else b.no_permanent_uniforms=!0}var E=Object(R.a)(e),J=Object(V.a)(e),M=Object(n.a)(e),F=Object(y.a)(e),U=Object(d.a)(e),K=Object(k.a)(e),t=Object(I.a)(e),v=Object(A.a)(e),Y=Object(p.a)(e),ha=Object(u.a)(e),S=[1,0,0,1],L=[1,1,1,1],q=[0,0,0,1],w=[0,0,0,0],ea=new Uint8Array([91.8,142.8,.96*255,255]);new Float32Array([.25,-.25]);new Float32Array([-.25,.25]);new Float32Array([1,1,1,0]);new Float32Array([2,2,2,0]);var H=null,D=null,h=null,ia=null,
ra=null,za=null,P=new Float32Array(3),oa=r.create(),Q=new Uint8Array(4),da=M.defaults;b.setup_context=function(a){var b=da.background_color;a.clearColor(b[0],b[1],b[2],b[3]);a.clearDepth(1);a.enable(a.DEPTH_TEST);a.depthFunc(a.LEQUAL);a.enable(a.CULL_FACE);a.frontFace(a.CCW);a.cullFace(a.BACK);a.enable(a.BLEND);a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA);H=a};b.draw=function(b){if(b.do_render&&!b.force_do_not_render)if(b.type==Y.RESOLVE){K.start_subs(b);var c=b.camera;H.bindFramebuffer(H.READ_FRAMEBUFFER,
c.framebuffer_prev);H.bindFramebuffer(H.DRAW_FRAMEBUFFER,c.framebuffer);var h=0;c.color_attachment&&(h|=H.COLOR_BUFFER_BIT);c.depth_attachment&&(h|=H.DEPTH_BUFFER_BIT);H.blitFramebuffer(0,0,c.width,c.height,0,0,c.width,c.height,h,H.NEAREST);K.stop_subs(b);U.gl("draw resolve")}else if(b.type==Y.COPY)K.start_subs(b),c=b.camera,H.bindFramebuffer(H.FRAMEBUFFER,c.framebuffer_prev),H.bindTexture(H.TEXTURE_2D,c.color_attachment.w_texture),H.copyTexSubImage2D(H.TEXTURE_2D,0,0,0,0,0,c.width,c.height,0),K.stop_subs(b),
U.gl("draw copy");else{K.start_subs(b);c=b.camera;H.bindFramebuffer(H.FRAMEBUFFER,c.framebuffer);b.assign_texture&&(h=c.color_attachment,H.framebufferTexture2D(H.FRAMEBUFFER,H.COLOR_ATTACHMENT0,h.w_target,h.w_texture,0));H.viewport(0,0,c.width,c.height);b.type!=Y.MAIN_CUBE_REFLECT&&b.type!=Y.MAIN_CUBE_REFLECT_BLEND&&m(b);b.blend?H.enable(H.BLEND):H.disable(H.BLEND);b.depth_test?H.enable(H.DEPTH_TEST):H.disable(H.DEPTH_TEST);switch(b.type){case Y.SHADOW_CAST:H.enable(H.POLYGON_OFFSET_FILL);H.polygonOffset(b.self_shadow_polygon_offset,
b.self_shadow_polygon_offset);H.cullFace(H.BACK);break;case Y.MAIN_PLANE_REFLECT:case Y.MAIN_PLANE_REFLECT_BLEND:H.disable(H.POLYGON_OFFSET_FILL);H.cullFace(H.FRONT);break;case Y.DEBUG_VIEW:H.enable(H.POLYGON_OFFSET_FILL);H.polygonOffset(-4,-4);H.cullFace(H.BACK);break;case Y.MAIN_GLOW:if(1<da.msaa_samples||da.safari_glow_hack){H.enable(H.POLYGON_OFFSET_FILL);H.polygonOffset(-2,-2);break}default:H.disable(H.POLYGON_OFFSET_FILL),H.cullFace(H.BACK)}if(b.type==Y.MAIN_CUBE_REFLECT||b.type==Y.MAIN_CUBE_REFLECT_BLEND)for(var c=
b.camera,h=c.color_attachment.w_texture,d=0;6>d;d++){var l=fa(d);c.view_matrix=b.cube_view_matrices[d];a.d(c.view_matrix,c.view_tsr);J.calc_sky_vp_inverse(c);H.framebufferTexture2D(H.FRAMEBUFFER,H.COLOR_ATTACHMENT0,l,h,0);m(b);for(var l=b.draw_data,e=0;e<l.length;e++)for(var k=0;k<l[e].bundles.length;k++){var q=l[e].bundles[k];q.do_render=q.do_render_cube[d]}f(b)}else f(b);K.stop_subs(b);U.gl("draw subscene: "+Y.subs_label(b));b.type==Y.BRDF&&H.bindFramebuffer(H.FRAMEBUFFER,null)}};b.clear=function(a){if(a)H.bindFramebuffer(H.FRAMEBUFFER,
a.camera.framebuffer);else{var b=da.background_color;if(b[0]===w[0]&&b[1]===w[1]&&b[2]===w[2]&&b[3]===w[3])return}m(a)};b.assign_attribute_setters=function(a){var b=a.attribute_setters;b.length=0;var c=a.bufs_data,h=c.pointers,f=a.shader.attributes,d;for(d in f){var e=h[d],k=v.get_vbo_type_by_attr_name(d),m=v.get_gl_type_by_attr_name(d),q=v.get_type_size_by_attr_name(d);b.push({vbo_type:k,gl_type:m,loc:f[d],base_offset:e.offset*q,frame_length:1<e.frames?e.length*q:0,num_comp:e.num_comp,divisor:e.divisor})}if("DEBUG"==
Object(l.d)())for(d in h)k=v.get_vbo_type_by_attr_name(d),b=v.search_vbo_index_by_type(c.vbo_data,k),b=c.vbo_data[b],e=a.shaders_info.vert+" | "+a.shaders_info.frag,k=h[d].length*h[d].frames*v.get_type_size_by_attr_name(d),F.fill_vbo_garbage_info(b.debug_id,e,d,k,d in f);da.allow_vao_ext&&z(a)};b.assign_vao=z;b.cleanup_vao=function(a){for(var b=t.get_vertex_array_object(),c=0;c<a.vaos.length;c++)b.deleteVertexArray(a.vaos[c]);a.vaos.length=0};b.clone_attribute_setters=function(a){for(var b=[],c=0;c<
a.length;c++){var h=a[c];b.push({vbo_type:h.vbo_type,gl_type:h.gl_type,loc:h.loc,base_offset:h.base_offset,frame_length:h.frame_length,num_comp:h.num_comp,divisor:h.divisor})}return b};b.assign_uniform_setters=G;b.assign_texture_uniforms=function(a){var b=a.shader,c=a.textures;a=a.texture_names;H.useProgram(b.program);for(var h=0;h<c.length;h++)H.uniform1i(b.uniforms[a[h]],h)};b.read_pixels=function(a,b,c,h,f,d){H.bindFramebuffer(H.FRAMEBUFFER,a);H.readPixels(b,c,h,f,H.RGBA,H.UNSIGNED_BYTE,d);H.bindFramebuffer(H.FRAMEBUFFER,
null);return d};b.update_batch_permanent_uniform=function(a,b){var c=a.shader;c.no_permanent_uniforms||(H.useProgram(c.program),c.permanent_uniform_setters.length||G(c),c=c.permanent_uniform_setters_table[b],c.fun(H,c.loc,null,a))};b.render_target_create=function(a,b){var c=H.createFramebuffer();H.bindFramebuffer(H.FRAMEBUFFER,c);if(ha.is_renderbuffer(a)){var h=a.w_renderbuffer;H.framebufferRenderbuffer(H.FRAMEBUFFER,H.COLOR_ATTACHMENT0,H.RENDERBUFFER,h)}else if(ha.is_texture(a)){var f=a,h=f.w_texture,
f=f.w_target==H.TEXTURE_CUBE_MAP?H.TEXTURE_CUBE_MAP_NEGATIVE_Z:f.w_target;H.framebufferTexture2D(H.FRAMEBUFFER,H.COLOR_ATTACHMENT0,f,h,0)}ha.is_renderbuffer(b)?(h=b.w_renderbuffer,H.framebufferRenderbuffer(H.FRAMEBUFFER,H.DEPTH_ATTACHMENT,H.RENDERBUFFER,h)):ha.is_texture(b)&&(f=b,h=f.w_texture,f=f.w_target,H.framebufferTexture2D(H.FRAMEBUFFER,H.DEPTH_ATTACHMENT,f,h,0));U.bound_fb();H.bindFramebuffer(H.FRAMEBUFFER,null);return c};b.render_target_cleanup=function(a,b,c,h,f){null==a?(H.bindFramebuffer(H.FRAMEBUFFER,
a),H.viewport(0,0,h,f),H.clear(H.COLOR_BUFFER_BIT|H.DEPTH_BUFFER_BIT)):(ha.is_renderbuffer(b)?H.deleteRenderbuffer(b.w_renderbuffer):ha.is_texture(b)&&H.deleteTexture(b.w_texture),ha.is_renderbuffer(c)?H.deleteRenderbuffer(c.w_renderbuffer):ha.is_texture(c)&&H.deleteTexture(c.w_texture),H.deleteFramebuffer(a))};b.increment_subpixel_index=function(){};b.draw_resized_cubemap_texture=function(a,b,c,h,f,d){a=a.w_texture;H.viewport(0,0,c,c);H.framebufferTexture2D(H.FRAMEBUFFER,H.COLOR_ATTACHMENT0,b,a,
0);b=E.create_postprocessing_batch("FLIP_CUBEMAP_COORDS");a=b.shader;H.activeTexture(H.TEXTURE0);H.bindTexture(H.TEXTURE_2D,f);var l=f=0;c!=h&&(f=1/(6*h),l=1/(4*h));H.uniform1i(a.uniforms.u_tex_number,d);H.uniform2fv(a.uniforms.u_delta,[f,l]);H.useProgram(a.program);za(b,0);H.bindTexture(H.TEXTURE_2D,null)};b.draw_resized_texture=function(a,b,c,h,f,d){H.bindFramebuffer(H.FRAMEBUFFER,h);h=a.w_texture;a=a.w_target;H.bindTexture(a,h);H.viewport(0,0,b,c);H.texImage2D(a,0,H.RGBA,b,c,0,H.RGBA,H.UNSIGNED_BYTE,
null);H.framebufferTexture2D(H.FRAMEBUFFER,H.COLOR_ATTACHMENT0,a,h,0);b=E.create_postprocessing_batch(d);c=b.shader;H.activeTexture(H.TEXTURE0);H.bindTexture(a,f);H.useProgram(c.program);za(b,0);H.bindFramebuffer(H.FRAMEBUFFER,null);H.bindTexture(a,null)};b.cleanup=function(){};b.set_draw_methods=function(){var a=t.get_instanced_arrays(),b=t.get_vertex_array_object();da.allow_instanced_arrays_ext=a?!0:!1;da.allow_vao_ext=b?!0:!1;a?(D=function(b,c,h,f){a.drawElementsInstanced(H.TRIANGLES,b,c,h,f)},
h=function(b,c){a.vertexAttribDivisor(b,c)},ia=function(b,c,h){a.drawArraysInstanced(H.TRIANGLES,b,c,h)}):(D=function(a,b,c){H.drawElements(H.TRIANGLES,a,b,c)},h=function(a,b){},ia=function(a,b,c){H.drawArrays(H.TRIANGLES,a,b)});b?(ra=function(a){b.bindVertexArray(a)},za=function(a,b){var c=a.bufs_data;ra(a.vaos[b]);c.ibo?D(c.count,c.ibo_type,0,c.instance_count):ia(0,c.count,c.instance_count);ra(null)}):za=function(a,b){for(var c=a.bufs_data,f=a.attribute_setters,d=0;d<c.vbo_data.length;d++){H.bindBuffer(H.ARRAY_BUFFER,
c.vbo_data[d].vbo);for(var l=0;l<f.length;l++){var e=f[l];e.vbo_type==c.vbo_data[d].type&&(H.enableVertexAttribArray(e.loc),H.vertexAttribPointer(e.loc,e.num_comp,e.gl_type,e.gl_type==H.FLOAT?!1:!0,0,e.base_offset+e.frame_length*b),h(e.loc,e.divisor))}}c.ibo?(H.bindBuffer(H.ELEMENT_ARRAY_BUFFER,c.ibo),D(c.count,c.ibo_type,0,c.instance_count)):ia(0,c.count,c.instance_count);for(d=0;d<f.length;d++)e=f[d],H.disableVertexAttribArray(e.loc)}};b.reset=function(){ra=ia=h=D=H=null}});t.a=e},function(C,t,
e){C=e(0);var R=e(5),V=e(4),n=e(1),y=e(8),d=e(18),k=e(6),I=e(2),A=e(3);e=Object(C.a)("__sfx",function(e,p){function r(){var a=window.AudioContext||window.webkitAudioContext;if(a){try{var b=new a}catch(oa){return K.error('Unable to initialize AudioContext: "'+oa+'". The audio is disabled.'),null}if(b.createGain)return b;K.warn("deprecated WebAudio implementation");return null}K.warn("WebAudio is not supported");return null}function a(a,h,f){var d=a.sfx;if("NONE"!=d.behavior){var e=d.loop,k=d.pitch;
if(d.src&&(e||0<=f)){d.base_seed=Math.floor(5E4*Math.random());var q=ea.currentTime+h,q=Math.max(0,q);d.start_time=q;d.state=20;var w=H._sfx;"POSITIONAL"==d.behavior&&"none"==w.distance_model&&(d.behavior="BACKGROUND_SOUND");ra(a,H._sfx);if("POSITIONAL"==d.behavior||"BACKGROUND_SOUND"==d.behavior){h=ea.createBufferSource();h.buffer=d.src;h.playbackRate.value=k;if(e){d.source_node&&d.source_node.disconnect();d.source_node2&&d.source_node2.disconnect();h.loop=!0;h.loopStart=d.loop_start;if(h.loopEnd=
d.loop_end)f=ea.createBufferSource(),f.buffer=d.src,f.playbackRate.value=k,d.source_node2=f,f.connect(d.proc_chain_in);h.start(q);d.duration=0}else e=h.buffer?h.buffer.duration:0,f>e?(e=q+f+d.fade_out,h.loop=!0,h.start(q),h.stop(e),d.duration=f):(h.loop=!1,h.start(q),d.duration=e);h.connect(d.proc_chain_in);d.source_node=h;l(d);c(d);m(d)}else"BACKGROUND_MUSIC"==d.behavior&&(t.clear_timeout(d.bgm_start_timeout),t.clear_timeout(d.bgm_stop_timeout),f=function(){var b=a.sfx,c=b.src;c&&(c.volume=1,c.loop=
b.loop,b.source_node=b.source_node||ea.createMediaElementSource(c),b.source_node.connect(b.proc_chain_in),20==b.state&&(c.currentTime&&(c.currentTime=0),c.play()))},0==h?f():d.bgm_start_timeout=t.set_timeout(f,1E3*h),e?d.duration=0:(f=M(a),d.duration=f));b(d,q)}}}function B(b){var c=b.sfx;a(b,c.delay+c.delay_random*Math.random(),c.duration)}function l(a){var b=a.source_node2||a.source_node;I._17(b.onended)&&(b.onended=function(){a.state=50})}function c(a){a.volume_random&&a.rand_gain_node.gain.cancelScheduledValues(a.start_time);
a.pitch_random&&(a.source_node.playbackRate.cancelScheduledValues(a.start_time),a.source_node2&&a.source_node2.playbackRate.cancelScheduledValues(a.start_time));a.vp_rand_end_time=a.start_time}function m(a){if(a.volume_random||a.pitch_random){var b=a.rand_gain_node,c=a.source_node,f=c.buffer?c.buffer.duration:0;if(f){var d=a.start_time;h[0]=a.base_seed;for(var l=0;5>l;){var e=a.pitch+a.pitch_random*I._40(h);if(d>=a.vp_rand_end_time){if(a.volume_random){var k=1-I.M(a.volume_random,0,1)*Math.random();
b.gain.setTargetAtTime(k,d,.015)}a.pitch_random&&(c.playbackRate.setTargetAtTime(e,d,.015),a.source_node2&&a.source_node2.playbackRate.setTargetAtTime(e,d,.015));l++}d+=f/e}a.vp_rand_end_time=d-.001}}}function b(a,b){if(a.fade_in||a.fade_out){var c=a.fade_gain_node;c.gain.cancelScheduledValues(b);a.fade_in?(c.gain.setTargetAtTime(0,b,.015),c.gain.linearRampToValueAtTime(1,b+a.fade_in)):c.gain.setTargetAtTime(1,b,.015);a.fade_out&&!a.loop&&(c.gain.setTargetAtTime(1,b+a.duration,.015),c.gain.linearRampToValueAtTime(0,
b+a.duration+a.fade_out))}}function f(a){"SPEAKER"!=a.type&&F.panic("Wrong object type");var b=a.sfx;if(50==b.state)b.state=30;else if(20==b.state||40==b.state){var c=b.fade_gain_node,h=ea.currentTime;b.fade_out&&(c.gain.setTargetAtTime(c.gain.value,h,.015),c.gain.linearRampToValueAtTime(0,h+b.fade_out,.015));"BACKGROUND_MUSIC"==b.behavior?b.src&&(t.clear_timeout(b.bgm_start_timeout),t.clear_timeout(b.bgm_stop_timeout),b.bgm_stop_timeout=t.set_timeout(function(){var b=a.sfx.src;b&&(b.currentTime&&
(b.currentTime=0),b.pause())},1E3*b.fade_out)):(c=b.source_node,c.onended=function(){},b.duration<c.buffer.duration?b.fade_out&&20==b.state?c.stop(h+b.fade_out):20==b.state&&(c.stop(0),c.disconnect()):c.disconnect(),b.start_time=0,b.pause_time=0,b.buf_offset=0);b.state=30}}function T(a){a=a.sfx;if(20==a.state){var b=ea.currentTime;a.pause_time=b;"BACKGROUND_MUSIC"==a.behavior?(b=a.src)&&b.pause():(a.buf_offset=b>a.start_time?fa(a,b):0,a.source_node.onended=function(){},a.source_node.stop(0),a.source_node.disconnect(),
c(a));a.state=40}}function fa(a,b){h[0]=a.base_seed;for(var c=a.source_node.buffer.duration,f=a.start_time,d;f<b;)d=a.pitch+a.pitch_random*I._40(h),f+=c/d;return(c/d-(f-b))*d}function z(a){var c=a.sfx;if(40==c.state){var h=ea.currentTime;c.start_time+=h-c.pause_time;if("BACKGROUND_MUSIC"==c.behavior)c.src.play();else{a=a.sfx;var f=ea.createBufferSource();f.loop=a.source_node.loop;f.loopStart=a.source_node.loopStart;f.loopEnd=a.source_node.loopEnd;f.buffer=a.source_node.buffer;f.playbackRate.value=
a.source_node.playbackRate.value;f.connect(a.proc_chain_in);a.source_node=f;a.source_node2&&(f=ea.createBufferSource(),f.loop=a.source_node2.loop,f.buffer=a.source_node2.buffer,f.playbackRate.value=a.source_node2.playbackRate.value,f.connect(a.proc_chain_in),a.source_node2=f);c.vp_rand_end_time=h;h=c.source_node;l(c);h.start(c.start_time,c.buf_offset);m(c)}b(c,c.start_time);c.state=20}}function G(a,b,c){var h;h=b.doppler_factor;if(0<h){var f=b.speed_of_sound;if(0!=A.dot(a.velocity,a.velocity)||0!=
A.dot(b.listener_velocity,b.listener_velocity)){var d=A.subtract(a.last_position,b.listener_last_eye,ha),l=A.length(d);b=A.dot(d,b.listener_velocity)/l;d=A.dot(d,a.velocity)/l;l=f/h;b=Math.min(-b,l);d=Math.min(-d,l);h=(f-h*b)/(f-h*d);isFinite(h)||(h=0);h=Math.min(h,16);h=Math.max(h,.125);h=I._51(h,a.last_doppler_shift,c,.3);a.source_node.playbackRate.value=h;a.last_doppler_shift=h}}}function E(a){a=a.sfx;return!a||20!=a.state&&40!=a.state&&30!=a.state&&50!=a.state?!1:!0}function J(a){return a.muted?
0:a.volume}function M(a){a=a.sfx;return(a=a.src)?a.duration:0}var F=Object(R.a)(e),U=Object(V.a)(e),K=Object(n.a)(e),t=Object(d.a)(e),v=U.defaults,Y=U.sfx,ha=new Float32Array(3),S=new Float32Array(3),L=y.create(),q=[],w=[],ea=null,H=null,D=[],h=[1],ia=null;p.AST_NONE=10;p.AST_ARRAY_BUFFER=20;p.AST_HTML_ELEMENT=30;p.create_sfx=function(){return{uuid:-1,filepath:"",behavior:"NONE",muted:!1,volume:1,pitch:1,attenuation:1,dist_ref:1,dist_max:1E4,cone_angle_inner:360,cone_angle_outer:360,cone_volume_outer:1,
autoplay:!1,cyclic:!1,loop:!1,loop_start:0,loop_end:0,delay:0,delay_random:0,volume_random:0,pitch_random:0,fade_in:0,fade_out:0,start_time:0,pause_time:0,buf_offset:0,duration:0,vp_rand_end_time:0,base_seed:1,src:null,state:10,last_position:new Float32Array(3),velocity:new Float32Array(3),enable_doppler:!1,last_doppler_shift:1,bgm_start_timeout:-1,bgm_stop_timeout:-1,duck_time:0,proc_chain_in:null,source_node:null,source_node2:null,panner_node:null,filter_node:null,gain_node:null,fade_gain_node:null,
rand_gain_node:null,update_counter:0}};p.init=function(){var a=document.createElement("audio"),b=document.createElement("video");a.canPlayType&&(""!=a.canPlayType("audio/ogg")&&(q.push("ogg"),q.push("ogv"),q.push("oga")),""!=a.canPlayType("audio/mpeg")&&q.push("mp3"),""!=a.canPlayType("audio/mp4")&&(q.push("mp4"),q.push("m4v"),q.push("m4a")),""!=a.canPlayType("audio/webm")&&q.push("webm"));b.canPlayType&&(""!=b.canPlayType("video/ogg")&&(w.push("ogv"),w.push("ogg"),w.push("oga")),""!=b.canPlayType("video/mp4")&&
(w.push("m4v"),w.push("mp4")),""!=b.canPlayType("video/webm")&&w.push("webm"),""!=b.canPlayType("video/mpeg")&&w.push("mp3"))};p.attach_scene_sfx=function(a){Y.webaudio&&!ea&&(ea=r())&&K.log("%cINIT WEBAUDIO: "+ea.sampleRate+"Hz","color: #00a");if(ea){var b={listener_last_eye:new Float32Array(3),listener_velocity:new Float32Array(3),update_counter:0},c=ea.createGain(),h=ea.createGain();b.gain_node=c;b.fade_gain_node=h;c.connect(h);h.connect(ea.destination);if(a.b4w_enable_dynamic_compressor){var h=
ea.createDynamicsCompressor(),f=a.b4w_dynamic_compressor_settings;h.threshold.value=f.threshold;h.knee.value=f.knee;h.ratio.value=f.ratio;h.attack.value=f.attack;h.release.value=f.release;h.connect(c);b.compressor_node=h;b.proc_chain_in=h}else b.compressor_node=null,b.proc_chain_in=c;switch(a.audio_distance_model){case "INVERSE":case "INVERSE_CLAMPED":b.distance_model="inverse";break;case "LINEAR":case "LINEAR_CLAMPED":b.distance_model="linear";break;case "EXPONENT":case "EXPONENT_CLAMPED":b.distance_model=
"exponential";break;case "NONE":b.distance_model="none";break;default:F.panic("Wrong audio distance model")}b.doppler_factor=a.audio_doppler_factor;b.speed_of_sound=a.audio_doppler_speed;b.muted=!1;b.volume=a.audio_volume;c.gain.value=J(b);b.duck_time=0}else b=null;a._sfx=b};p.set_active_scene=function(a){H=a};p.detect_audio_container=function(a){a||(a="ogg");return-1<q.indexOf(a)?a:-1<q.indexOf("m4a")?"m4a":-1<q.indexOf("oga")?"oga":""};p.detect_video_container=function(a){a||(a="webm");return-1<
w.indexOf(a)?a:-1<w.indexOf("m4v")?"m4v":-1<w.indexOf("webm")?"webm":""};p.update_object=function(a,b){var c=a.data,h=b.sfx;if(a.data.sound){h.uuid=a.data.sound.uuid;h.filepath=a.data.sound.filepath;switch(c.b4w_behavior){case "POSITIONAL":case "BACKGROUND_SOUND":h.behavior=ea?c.b4w_behavior:"NONE";break;case "BACKGROUND_MUSIC":var f;ea?(window.MediaElementAudioSourceNode?f=!0:(K.warn("MediaElementAudioSourceNode not found"),f=!1),f=f&&!v.chrome_html_bkg_music_hack?"BACKGROUND_MUSIC":"BACKGROUND_SOUND"):
f="NONE";h.behavior=f;break;default:F.panic("Wrong speaker behavior")}c.sound||(h.behavior="NONE");h.enable_doppler=c.b4w_enable_doppler;h.muted=c.muted;h.volume=c.volume;h.pitch=c.pitch;h.attenuation=c.attenuation;h.dist_ref=c.distance_reference;h.dist_max=c.distance_max||1E4;h.cone_angle_inner=c.cone_angle_inner;h.cone_angle_outer=c.cone_angle_outer;h.cone_volume_outer=c.cone_volume_outer;h.autoplay=c.b4w_auto_play;h.cyclic=c.b4w_cyclic_play;h.loop=c.b4w_loop;h.loop_start=c.b4w_loop_start;h.loop_end=
c.b4w_loop_end;h.delay=c.b4w_delay;h.delay_random=c.b4w_delay_random;h.volume_random=c.b4w_volume_random;h.pitch_random=c.b4w_pitch_random;h.fade_in=c.b4w_fade_in;h.fade_out=c.b4w_fade_out;D.push(b)}};p.source_type=function(a){"SPEAKER"!=a.type&&F.panic("Wrong object type");switch(a.sfx.behavior){case "POSITIONAL":return p.AST_ARRAY_BUFFER;case "BACKGROUND_SOUND":return p.AST_ARRAY_BUFFER;case "BACKGROUND_MUSIC":return p.AST_HTML_ELEMENT;case "NONE":return p.AST_NONE;default:F.panic("Wrong speaker behavior")}};
p.update_spkobj=function(a,b){var c=a.sfx;switch(c.behavior){case "POSITIONAL":case "BACKGROUND_SOUND":case "BACKGROUND_MUSIC":c.src=b;break;case "NONE":break;default:F.panic("Wrong speaker behavior")}};p.play_empty_sound=function(){var a=ea.createBufferSource();a.buffer=ea.createBuffer(1,22050,22050);a.connect(ea.destination);a.start(0)};p.decode_audio_data=function(a,b,c){ea?ea.decodeAudioData(a,b,c):c()};p.speaker_remove=function(a){f(a);a.sfx=null;D.splice(D.indexOf(a),1)};p.cleanup=function(){for(var a=
0;a<D.length;a++){var b=D[a].sfx;"BACKGROUND_MUSIC"==b.behavior?(b=b.src)&&b.pause():(b.source_node&&b.source_node.disconnect(),b.source_node2&&b.source_node2.disconnect())}H&&H._sfx&&(a=H._sfx,a.listener_last_eye[0]=0,a.listener_last_eye[1]=0,a.listener_last_eye[2]=0,a.listener_velocity[0]=0,a.listener_velocity[1]=0,a.listener_velocity[2]=0);H=null;D.splice(0);ia=null};p.update=function(a,b){if(ea&&0!=D.length){for(var c=0;c<D.length;c++){var h=D[c],d=h.sfx,l=d.source_node,e=ea.currentTime;!d.loop&&
20==d.state&&d.duration&&d.start_time+d.duration<e&&("BACKGROUND_MUSIC"==d.behavior||l&&!I._17(l.onended))&&(d.state=50);d.cyclic&&50==d.state&&B(h);20==d.state&&3>d.vp_rand_end_time-e&&m(d)}ia&&ia.speakers.length&&(-1==ia.active||a>ia.active_start_time+ia.durations[ia.active])&&(c=ia,-1<c.active&&f(c.speakers[c.active]),h=-1==c.active&&c.random?Math.round(Math.random()*(c.speakers.length-1)):c.random?(c.active+(1+Math.round(Math.random()*(c.speakers.length-2))))%c.speakers.length:(c.active+1)%c.speakers.length,
B(c.speakers[h]),c.active=h,c.active_start_time=a)}};var ra=function(){var a=y.create(),b=A.create();return function(c,h){var f=c.sfx;if(!f.proc_chain_in){if(Y.mix_mode){var d=ea.createBiquadFilter();d.type="peaking"}else d=null;var l=ea.createGain();switch(f.behavior){case "POSITIONAL":var e=ea.createPanner();"string"!=typeof e.panningModel?(e.panningModel=e.EQUALPOWER,e.distanceModel=e.INVERSE_DISTANCE):(e.panningModel="equalpower",e.distanceModel=h.distance_model);var m=k.j(c.render.world_tsr,
b),q=k.g(c.render.world_tsr,a);e.setPosition(m[0],m[1],m[2]);A.copy(m,f.last_position);I._34(q,I.c,b);e.setOrientation(b[0],b[1],b[2]);e.refDistance=f.dist_ref;e.maxDistance=f.dist_max;e.rolloffFactor=f.attenuation;e.coneInnerAngle=f.cone_angle_inner;e.coneOuterAngle=f.cone_angle_outer;e.coneOuterGain=f.cone_volume_outer;m=ea.createGain();m.gain.value=J(f);d?(e.connect(d),d.connect(m)):e.connect(m);m.connect(l);f.proc_chain_in=e;f.volume_random?(q=ea.createGain(),l.connect(q),q.connect(h.proc_chain_in)):
(q=null,l.connect(h.proc_chain_in));break;case "BACKGROUND_SOUND":e=null;m=ea.createGain();m.gain.value=J(f);d?(f.proc_chain_in=d,d.connect(m)):f.proc_chain_in=m;m.connect(l);f.volume_random?(q=ea.createGain(),l.connect(q),q.connect(h.proc_chain_in)):(q=null,l.connect(h.proc_chain_in));break;case "BACKGROUND_MUSIC":q=e=null,m=ea.createGain(),m.gain.value=J(f),d?(f.proc_chain_in=d,d.connect(m)):f.proc_chain_in=m,m.connect(l),l.connect(h.proc_chain_in)}f.panner_node=e;f.filter_node=d;f.gain_node=m;
f.fade_gain_node=l;f.rand_gain_node=q}}}();p.play=a;p.play_def=B;p.stop=f;p.is_playing=function(a){return 20==a.sfx.state};p.speaker_pause=T;p.speaker_resume=z;p.loop_stop=function(a,b,c){c=a.sfx;var h=c.source_node2;E(a)&&("POSITIONAL"==c.behavior||"BACKGROUND_SOUND"==c.behavior)&&h&&(a=ea.currentTime+b,c.source_node.stop(a),h.start(a,c.loop_end))};p.playrate=function(a,b){var h=a.sfx;h.pitch=b;!E(a)||"POSITIONAL"!=h.behavior&&"BACKGROUND_SOUND"!=h.behavior||(h.source_node.playbackRate.value=b,h.source_node2&&
(h.source_node2.playbackRate.value=b),c(h),m(h))};p.get_playrate=function(a){return a.sfx.pitch};p.cyclic=function(a,b){a.sfx.cyclic=!!b};p.is_autoplay=function(a){return a.sfx.autoplay};p.is_cyclic=function(a){return a.sfx.cyclic};p.listener_update_transform=function(a,b,c,h,f){if(a=a._sfx){var d=ha;d[0]=0;d[1]=0;d[2]=-1;A.transformQuat(d,c,d);S[0]=0;S[1]=1;S[2]=0;A.transformQuat(S,c,S);c=ea.listener;c.setPosition(b[0],b[1],b[2]);c.setOrientation(d[0],d[1],d[2],S[0],S[1],S[2]);if(h&&a.update_counter!=
f){if(a.listener_stride)a.listener_stride=!1,A.copy(b,a.listener_last_eye);else for(c=a.listener_velocity,c[0]=(b[0]-a.listener_last_eye[0])/h,c[1]=(b[1]-a.listener_last_eye[1])/h,c[2]=(b[2]-a.listener_last_eye[2])/h,A.copy(b,a.listener_last_eye),b=0;b<D.length;b++)c=D[b],d=c.sfx,E(c)&&"POSITIONAL"==d.behavior&&d.enable_doppler&&G(d,a,h);a.update_counter=f}else A.copy(b,a.listener_last_eye)}};p.listener_stride=function(){var a=H._sfx;a&&(a.listener_stride=!0)};p.speaker_update_transform=function(a,
b,c){var h=a.sfx;if(E(a)&&"POSITIONAL"==h.behavior){var f=k.j(a.render.world_tsr,ha);a=k.g(a.render.world_tsr,L);var d=h.panner_node;d.setPosition(f[0],f[1],f[2]);I._34(a,I.c,S);d.setOrientation(S[0],S[1],S[2]);h.enable_doppler&&(a=h.last_position,b&&h.update_counter!=c?(h.stride?(A.copy(f,a),h.stride=!1):(d=h.velocity,d[0]=(f[0]-a[0])/b,d[1]=(f[1]-a[1])/b,d[2]=(f[2]-a[2])/b,A.copy(f,a),G(h,H._sfx,b)),h.update_counter=c):A.copy(f,a))}};p.speaker_stride=function(a){var b=a.sfx;E(a)&&"POSITIONAL"==
b.behavior&&b.enable_doppler&&(b.stride=!0)};p.get_spk_behavior=function(a){return a.sfx.behavior};p.check_active_speakers=function(){for(var a=0;a<D.length;a++)if(E(D[a]))return!0;return!1};p.set_master_volume=function(a){var b=H._sfx;b&&(b.volume=a,ea&&(b.gain_node.gain.value=J(b)))};p.get_master_volume=function(){var a=H._sfx;return a?a.volume:0};p.set_volume=function(a,b){var c=a.sfx;c.volume=b;E(a)&&(c.gain_node.gain.value=J(c))};p.get_volume=function(a){return a.sfx.volume};p.mute=function(a,
b){a.sfx.muted=!!b;E(a)&&(a.sfx.gain_node.gain.value=J(a.sfx))};p.is_muted=function(a){return a.sfx.muted};p.mute_master=function(a){var b=H._sfx;b&&(b.muted=!!a,ea&&(b.gain_node.gain.value=J(b)))};p.is_master_muted=function(){var a=H._sfx;return a?a.muted:!1};p.get_speaker_objects=function(){return D};p.pause=function(){for(var a=0;a<D.length;a++)T(D[a])};p.resume=function(){for(var a=0;a<D.length;a++)z(D[a])};p.set_compressor_params=function(a,b){if(a._sfx&&a._sfx.compressor_node){var c=a._sfx.compressor_node;
c.threshold.value=b.threshold;c.knee.value=b.knee;c.ratio.value=b.ratio;c.attack.value=b.attack;c.release.value=b.release}};p.get_compressor_params=function(a){if(!a._sfx||!a._sfx.compressor_node)return null;a=a._sfx.compressor_node;return{threshold:a.threshold.value,knee:a.knee.value,ratio:a.ratio.value,attack:a.attack.value,release:a.release.value}};p.duck=function(a,b,c){if(E(a)){a=a.sfx;var h=a.fade_gain_node,f=ea.currentTime;h.gain.setTargetAtTime(h.gain.value,f,.015);h.gain.linearRampToValueAtTime(b,
f+c);a.duck_time=c}};p.unduck=function(a){if(E(a)){a=a.sfx;var b=a.fade_gain_node,c=ea.currentTime;b.gain.setTargetAtTime(b.gain.value,c,.015);b.gain.linearRampToValueAtTime(1,c+a.duck_time);a.duck_time=0}};p.duck_master=function(a,b){if(ea){var c=H._sfx,h=c.fade_gain_node,f=ea.currentTime;h.gain.setTargetAtTime(h.gain.value,f,.015);h.gain.linearRampToValueAtTime(a,f+b);c.duck_time=b}};p.unduck_master=function(){if(ea){var a=H._sfx,b=a.fade_gain_node,c=ea.currentTime;b.gain.setTargetAtTime(b.gain.value,
c,.015);b.gain.linearRampToValueAtTime(1,c+a.duck_time);a.duck_time=0}};p.apply_playlist=function(a,b,c){ia={active:-1,active_start_time:0,random:c,speakers:[],durations:[]};for(c=0;c<a.length;c++){var h=a[c],d=M(h);0==d?K.warn("Ignoring speaker with zero duration: "+h.name):(f(h),h.sfx.cyclic=!1,ia.speakers.push(h),ia.durations.push(d+b))}};p.get_duration=M;p.clear_playlist=function(){if(ia)for(var a=ia.speakers,b=0;b<a.length;b++)f(a[b]);ia=null};p.get_positional_params=function(a){return(a=a.sfx)&&
"POSITIONAL"==a.behavior?{dist_ref:a.dist_ref,dist_max:a.dist_max,attenuation:a.attenuation}:null};p.set_positional_params=function(a,b){var c=a.sfx;if(c&&"POSITIONAL"==c.behavior){c.dist_ref=b.dist_ref;c.dist_max=b.dist_max;c.attenuation=b.attenuation;var h=c.panner_node;h&&(h.refDistance=c.dist_ref,h.maxDistance=c.dist_max,h.rolloffFactor=c.attenuation)}};p.set_filter_params=function(a,b){var c=a.sfx;c&&c.filter_node&&(c.filter_node.frequency.value=b.freq,c.filter_node.Q.value=b.Q,c.filter_node.gain.value=
b.gain)};p.get_filter_params=function(a){return(a=a.sfx)&&a.filter_node?{freq:a.filter_node.frequency.value,Q:a.filter_node.Q.value,gain:a.filter_node.gain.value}:null};p.get_filter_freq_response=function(a,b,c,h){a=a.sfx;if(!a||!a.filter_node)return null;a.filter_node.getFrequencyResponse(b,c,h)};p.reset=function(){q.length=0;w.length=0;ea=null}});t.a=e},function(C,t,e){C=e(0);var R=e(53),V=e(19),n=e(1);e=Object(C.a)("controls",function(e,d){var k=Object(R.a)(e),y=Object(V.a)(e),A=Object(n.a)(e);
d.CT_POSITIVE=k.CT_POSITIVE;d.CT_CONTINUOUS=k.CT_CONTINUOUS;d.CT_TRIGGER=k.CT_TRIGGER;d.CT_SHOT=k.CT_SHOT;d.CT_LEVEL=k.CT_LEVEL;d.CT_CHANGE=k.CT_CHANGE;d.KEY_BACKSPACE=8;d.KEY_TAB=9;d.KEY_ENTER=13;d.KEY_SHIFT=16;d.KEY_CTRL=17;d.KEY_ALT=18;d.KEY_PAUSE=19;d.KEY_CAPSLOCK=20;d.KEY_ESC=27;d.KEY_SPACE=32;d.KEY_LEFT=37;d.KEY_UP=38;d.KEY_RIGHT=39;d.KEY_DOWN=40;d.KEY_1=49;d.KEY_2=50;d.KEY_3=51;d.KEY_4=52;d.KEY_5=53;d.KEY_6=54;d.KEY_7=55;d.KEY_8=56;d.KEY_9=57;d.KEY_A=65;d.KEY_B=66;d.KEY_C=67;d.KEY_D=68;d.KEY_E=
69;d.KEY_F=70;d.KEY_G=71;d.KEY_H=72;d.KEY_I=73;d.KEY_J=74;d.KEY_K=75;d.KEY_L=76;d.KEY_M=77;d.KEY_N=78;d.KEY_O=79;d.KEY_P=80;d.KEY_Q=81;d.KEY_R=82;d.KEY_S=83;d.KEY_T=84;d.KEY_U=85;d.KEY_V=86;d.KEY_W=87;d.KEY_X=88;d.KEY_Y=89;d.KEY_Z=90;d.KEY_NUM0=96;d.KEY_NUM1=97;d.KEY_NUM2=98;d.KEY_NUM3=99;d.KEY_NUM4=100;d.KEY_NUM5=101;d.KEY_NUM6=102;d.KEY_NUM7=103;d.KEY_NUM8=104;d.KEY_NUM9=105;d.KEY_MULT=106;d.KEY_ADD=107;d.KEY_SUB=109;d.KEY_DEC_POINT=110;d.KEY_DIV=111;d.KEY_SEMI_COLON=186;d.KEY_EQUAL_SIGN=187;d.KEY_COMMA=
188;d.KEY_DASH=189;d.KEY_PERIOD=190;d.KEY_FORWARD_SLASH=191;d.KEY_GRAVE_ACCENT=192;d.KEY_LEFT_SQ_BRACKET=219;d.KEY_BACK_SLASH=220;d.KEY_RIGHT_SQ_BRACKET=221;d.KEY_SINGLE_QUOTE=222;d.PL_SINGLE_TOUCH_MOVE=k.PL_SINGLE_TOUCH_MOVE;d.PL_MULTITOUCH_MOVE_ZOOM=k.PL_MULTITOUCH_MOVE_ZOOM;d.PL_MULTITOUCH_MOVE_PAN=k.PL_MULTITOUCH_MOVE_PAN;d.PL_MULTITOUCH_MOVE_ROTATE=k.PL_MULTITOUCH_MOVE_ROTATE;d.default_AND_logic_fun=k.default_AND_logic_fun;d.default_OR_logic_fun=k.default_OR_logic_fun;d.create_gamepad_btn_sensor=
k.create_gamepad_btn_sensor;d.create_gamepad_axis_sensor=k.create_gamepad_axis_sensor;d.create_gamepad_position_sensor=k.create_gamepad_position_sensor;d.create_gamepad_orientation_sensor=k.create_gamepad_orientation_sensor;d.create_custom_sensor=k.create_custom_sensor;d.create_keyboard_sensor=k.create_keyboard_sensor;d.create_collision_sensor=function(d,e,n){return k.create_collision_sensor(d,e||"ANY",n||!1)};d.create_collision_impulse_sensor=k.create_collision_impulse_sensor;d.create_ray_sensor=
function(d,e,n,a,B,l,c){if(d&&!y.obj_has_physics(d))A.error_once("No physics for object "+d.name);else return k.create_ray_sensor(d,e,n,a||"ANY",B||!1,l||!1,c||!1)};d.create_mouse_click_sensor=k.create_mouse_click_sensor;d.create_mouse_wheel_sensor=k.create_mouse_wheel_sensor;d.create_mouse_move_sensor=k.create_mouse_move_sensor;d.create_plock_mouse_sensor=k.create_plock_mouse_sensor;d.create_plock_sensor=k.create_plock_sensor;d.create_touch_move_sensor=k.create_touch_move_sensor;d.create_touch_zoom_sensor=
k.create_touch_zoom_sensor;d.create_touch_rotate_sensor=k.create_touch_rotate_sensor;d.create_touch_click_sensor=k.create_touch_click_sensor;d.create_motion_sensor=k.create_motion_sensor;d.create_vertical_velocity_sensor=k.create_vertical_velocity_sensor;d.create_gyro_angles_sensor=k.create_gyro_angles_sensor;d.create_gyro_quat_sensor=k.create_gyro_quat_sensor;d.create_gyro_delta_sensor=k.create_gyro_delta_sensor;d.create_hmd_quat_sensor=k.create_hmd_quat_sensor;d.create_hmd_position_sensor=k.create_hmd_position_sensor;
d.create_timer_sensor=function(d,e){return k.create_timer_sensor(d,e||!1)};d.reset_timer_sensor=k.reset_timer_sensor;d.create_elapsed_sensor=k.create_elapsed_sensor;d.create_timeline_sensor=k.create_timeline_sensor;d.create_selection_sensor=function(d,e){return k.create_selection_sensor(d,e||!1)};d.create_callback_sensor=function(d,e){return k.create_callback_sensor(d,e||0)};d.set_custom_sensor=function(d,e){k.sensor_set_value(d,e)};d.get_custom_sensor=function(d){return d.value};d.get_sensor_value=
k.get_sensor_value;d.get_sensor_payload=k.get_sensor_payload;d.create_sensor_manifold=function(d,e,n,a,B,l,c){B=B||k.default_AND_logic_fun;k.create_sensor_manifold(d,e,n,a,B,l,void 0===c?null:c)};d.create_kb_sensor_manifold=function(d,e,n,a,B,l){a=k.create_keyboard_sensor(a);k.create_sensor_manifold(d,e,n,[a],k.default_AND_logic_fun,B,void 0===l?null:l)};d.check_sensor_manifolds=function(d){return k.check_sensor_manifold(d,null)};d.check_sensor_manifold=k.check_sensor_manifold;d.remove_sensor_manifold=
k.remove_sensor_manifold;d.reset=k.reset;d.set_plock_smooth_factor=k.set_plock_smooth_factor});t.a=e},function(C,t,e){function R(){return{max_x:0,min_x:0,max_y:0,min_y:0,max_z:0,min_z:0}}function V(a,b){b.min_x=a.min_x;b.max_x=a.max_x;b.min_y=a.min_y;b.max_y=a.max_y;b.min_z=a.min_z;b.max_z=a.max_z;return b}function n(){return{center:new Float32Array(3),axis_x:new Float32Array(3),axis_y:new Float32Array(3),axis_z:new Float32Array(3)}}function y(a,b){var c=a.max_y,f=a.max_z,d=a.min_x,l=a.min_y,e=a.min_z;
a.max_x=Math.max(b.max_x,a.max_x);a.max_y=Math.max(b.max_y,c);a.max_z=Math.max(b.max_z,f);a.min_x=Math.min(b.min_x,d);a.min_y=Math.min(b.min_y,l);a.min_z=Math.min(b.min_z,e);return a}function d(a,b,c,f){var d=a[b],l=a[b+1],e=a[b+2],k=a[b],h=a[b+1],m=a[b+2];for(b+=3;b<c;b+=3)var q=a[b],v=a[b+1],n=a[b+2],d=Math.max(d,q),l=Math.max(l,v),e=Math.max(e,n),k=Math.min(k,q),h=Math.min(h,v),m=Math.min(m,n);f.max_x=d;f.max_y=l;f.max_z=e;f.min_x=k;f.min_y=h;f.min_z=m;return f}function k(a,b){b||(b=new Float32Array(24));
var c=a.max_x,f=a.max_y,d=a.max_z,l=a.min_x,e=a.min_y,k=a.min_z;b[0]=l;b[1]=e;b[2]=k;b[3]=c;b[4]=e;b[5]=k;b[6]=c;b[7]=f;b[8]=k;b[9]=l;b[10]=f;b[11]=k;b[12]=l;b[13]=e;b[14]=d;b[15]=c;b[16]=e;b[17]=d;b[18]=c;b[19]=f;b[20]=d;b[21]=l;b[22]=f;b[23]=d;return b}function I(){return{center:new Float32Array(3),radius:0}}function A(a,b){b.center[0]=a.center[0];b.center[1]=a.center[1];b.center[2]=a.center[2];b.radius=a.radius;return b}function r(){return{axis_x:new Float32Array(3),axis_y:new Float32Array(3),
axis_z:new Float32Array(3),center:new Float32Array(3)}}function p(a,b){f.copy(a.axis_x,b.axis_x);f.copy(a.axis_y,b.axis_y);f.copy(a.axis_z,b.axis_z);f.copy(a.center,b.center);return b}function u(a,b,c,f){return{axis_x:new Float32Array(a),axis_y:new Float32Array(b),axis_z:new Float32Array(c),center:new Float32Array([f[0],f[1],f[2]])}}function a(a,b){var c=T.g(a,M),c=b?T.e(a,c,U):fa.identity(U),c=T.L(c,v,F);f.copy(a,G);f.transformMat3(G,c,G);for(var d=G[0],l=d,e=G[1],k=e,m=G[2],h=m,n,z,p,r,E=3;E<a.length;E+=
3)G[0]=a[E],G[1]=a[E+1],G[2]=a[E+2],f.transformMat3(G,c,G),n=G[0],z=G[1],p=G[2],n>d&&(d=n),n<l&&(l=n),z>e&&(e=z),z<k&&(k=z),p>m&&(m=p),p<h&&(h=p);d=Math.max(d-l,sa);e=Math.max(e-k,sa);m=Math.max(m-h,sa);h=fa.identity(U);h[0]=0!=d?1/d:1/Y;h[4]=0!=e?1/e:1/Y;h[8]=0!=m?1/m:1/Y;fa.transpose(c,K);G[0]=a[0];G[1]=a[1];G[2]=a[2];f.transformMat3(G,c,G);f.transformMat3(G,h,G);f.transformMat3(G,K,G);k=G[0];l=G[0];n=G[1];z=G[1];p=G[2];r=G[2];for(E=3;E<a.length;E+=3)G[0]=a[E],G[1]=a[E+1],G[2]=a[E+2],f.transformMat3(G,
c,G),f.transformMat3(G,h,G),f.transformMat3(G,K,G),k=Math.max(k,G[0]),l=Math.min(l,G[0]),n=Math.max(n,G[1]),z=Math.min(z,G[1]),p=Math.max(p,G[2]),r=Math.min(r,G[2]);E=Math.sqrt((k-l)*(k-l)+(n-z)*(n-z)+(p-r)*(p-r))/2;E=Math.min(E,1);J[0]=(k+l)/2;J[1]=(n+z)/2;J[2]=(p+r)/2;k=J;h=fa.identity(U);h[0]=d;h[4]=e;h[8]=m;f.transformMat3(k,c,k);f.transformMat3(k,h,k);f.transformMat3(k,K,k);h=[c[0],c[3],c[6]];l=[c[1],c[4],c[7]];c=[c[2],c[5],c[8]];f.scale(h,d*E,h);f.scale(l,e*E,l);f.scale(c,m*E,c);return u(h,
l,c,k)}function B(){return{radius:0,height:0,center:new Float32Array(3)}}function l(a,b){b.radius=a.radius;b.height=a.height;b.center.set(a.center);return b}function c(a,b,c){f.add(b,c,a.center);f.scale(a.center,.5,a.center);a.radius=f.distance(a.center,b);return a}t.L=function(){return{bb:R(),be:r(),bs:I()}};t.t=function(a,b){V(a.bb,b.bb);p(a.be,b.be);A(a.bs,b.bs);return b};t.w=R;t.o=V;t.C=n;t.v=function(a,b){f.copy(a.center,b.center);f.copy(a.axis_x,b.axis_x);f.copy(a.axis_y,b.axis_y);f.copy(a.axis_z,
b.axis_z);return b};t.f=function(){return{max_x:1E12,min_x:-1E12,max_y:1E12,min_y:-1E12,max_z:1E12,min_z:-1E12}};t.P=function(a){a.max_x=0;a.min_x=0;a.max_y=0;a.min_y=0;a.max_z=0;a.min_z=0;return a};t.n=function(a){var b=R();V(a,b);return b};t.m=function(a){var b=a.max_x-a.min_x,c=a.max_y-a.min_y;c<b&&(b=c);a=a.max_z-a.min_z;a<b&&(b=a);return b};t.D=y;t.a=d;t.h=function(a,b,c){c||(c=R());a=k(a,z);m.F(a,b,a);return d(a,0,a.length,c)};t.F=k;t.k=function(a,b,c){c||(c=I());m.D(a.center,b,c.center);b=
m.i(b);c.radius=a.radius*(0>b?-b:b);return c};t.i=function(a,b,c){c||(c=r());m.D(a.center,b,c.center);f.copy(a.axis_x,c.axis_x);f.copy(a.axis_y,c.axis_y);f.copy(a.axis_z,c.axis_z);m.y(c.axis_x,b,c.axis_x);m.y(c.axis_y,b,c.axis_y);m.y(c.axis_z,b,c.axis_z);return c};t.j=function(a,b,c){c||(c=n());m.D(a.center,b,c.center);f.copy(a.axis_x,c.axis_x);f.copy(a.axis_y,c.axis_y);f.copy(a.axis_z,c.axis_z);m.y(c.axis_x,b,c.axis_x);m.y(c.axis_y,b,c.axis_y);m.y(c.axis_z,b,c.axis_z);return c};t.l=function(a,b){var c=
I();f.copy(b,c.center);c.radius=a;return c};t.O=function(a,b,c,d,l){var e=n();f.copy(a,e.center);f.copy(b,e.axis_x);f.copy(c,e.axis_y);f.copy(d,e.axis_z);f.scale(e.axis_x,l[0],e.axis_x);f.scale(e.axis_y,l[1],e.axis_y);f.scale(e.axis_z,l[2],e.axis_z);return e};t.A=I;t.u=A;t.y=r;t.s=p;t.e=u;t.g=function(a){a||(a=I());f.set(0,0,0,a.center);a.radius=1E12;return a};t.E=function(a,b){var c=f.subtract(b.center,a.center,f.create());0==f.length(c)&&f.set(1,0,0,c);var d=f.normalize(c,f.create()),c=f.scale(d,
a.radius,f.create());f.add(c,a.center,c);var l=f.scale(d,-a.radius,f.create());f.add(l,a.center,l);var e=f.scale(d,b.radius,f.create());f.add(e,b.center,e);var k=f.scale(d,-b.radius,f.create());f.add(k,b.center,k);c=[c,l,e,k];d=f.normalize(d,f.create());l=c[0];e=c[0];for(k=1;k<c.length;k++){var m=f.dot(c[k],d);m<f.dot(l,d)&&(l=c[k]);m>f.dot(e,d)&&(e=c[k])}d=[l,e];c=d[0];d=d[1];a.center=f.scale(f.add(c,d,f.create()),.5,f.create());a.radius=f.length(f.subtract(d,c,f.create()))/2};t.G=function(a,b){f.add(a.center,
a.axis_y,G);f.add(G,a.axis_x,G);f.add(G,a.axis_z,G);b.push(G[0],G[1],G[2]);f.add(a.center,a.axis_y,G);f.add(G,a.axis_x,G);f.subtract(G,a.axis_z,G);b.push(G[0],G[1],G[2]);f.add(a.center,a.axis_y,G);f.subtract(G,a.axis_x,G);f.add(G,a.axis_z,G);b.push(G[0],G[1],G[2]);f.add(a.center,a.axis_y,G);f.subtract(G,a.axis_x,G);f.subtract(G,a.axis_z,G);b.push(G[0],G[1],G[2]);f.subtract(a.center,a.axis_y,G);f.add(G,a.axis_x,G);f.add(G,a.axis_z,G);b.push(G[0],G[1],G[2]);f.subtract(a.center,a.axis_y,G);f.add(G,a.axis_x,
G);f.subtract(G,a.axis_z,G);b.push(G[0],G[1],G[2]);f.subtract(a.center,a.axis_y,G);f.subtract(G,a.axis_x,G);f.add(G,a.axis_z,G);b.push(G[0],G[1],G[2]);f.subtract(a.center,a.axis_y,G);f.subtract(G,a.axis_x,G);f.subtract(G,a.axis_z,G);b.push(G[0],G[1],G[2])};t.z=a;t.x=function(a){var b=n();f.copy(a.axis_x,b.axis_x);f.copy(a.axis_y,b.axis_y);f.copy(a.axis_z,b.axis_z);f.copy(a.center,b.center);return b};t.B=function(a){var b=I(),c;c=f.length(a.axis_x);var d=f.length(a.axis_y),l=f.length(a.axis_z);c=c>
d?c:d;b.center=a.center;b.radius=l>c?l:c;return b};t.M=function(a,b){var c=f.length(a.axis_x),d=f.length(a.axis_y),l=f.length(a.axis_z);return.75*b.radius*b.radius*b.radius>c*d*l};e.d(t,"I",function(){return B});e.d(t,"K",function(){return B});e.d(t,"J",function(){return B});t.b=function(a,b){var c=b.max_z,f=b.min_z,d=Math.max(0,c-f-2*a),l=B();l.radius=a;l.height=d;l.center[0]=0;l.center[1]=0;l.center[2]=(c+f)/2;return l};t.d=function(a,b){var c=b.max_z,f=b.min_z,d=Math.max(0,c-f),l=B();l.radius=
a;l.height=d;l.center[0]=0;l.center[1]=0;l.center[2]=(c+f)/2;return l};t.c=function(a,b){var c=b.max_z,f=b.min_z,d=Math.max(0,c-f),l=B();l.radius=a;l.height=d;l.center[0]=0;l.center[1]=0;l.center[2]=(c+f)/2;return l};e.d(t,"p",function(){return l});e.d(t,"r",function(){return l});e.d(t,"q",function(){return l});t.N=function(b){for(var c=0,f=0,l=R(),e=0;e<b.submeshes.length;e++){for(var m=b.submeshes[e],v=m.position,D=0;D<v.length/3;D++)var h=v[3*D],n=v[3*D+1],p=v[3*D+2],c=Math.max(Math.sqrt(h*h+n*
n+p*p),c),f=Math.max(Math.sqrt(h*h+n*n),f);D=m.boundings.bb;v=d(v,0,v.length,R());D.max_x=v.max_x;D.min_x=v.min_x;D.max_y=v.max_y;D.min_y=v.min_y;D.max_z=v.max_z;D.min_z=v.min_z;D=k(v,z);D=a(D,!1);m.boundings.be_cen=D.center;m.boundings.be_ax=[D.axis_x[0],D.axis_y[1],D.axis_z[2]];0==e?V(v,l):y(l,v)}e=b.b4w_boundings.bb;e.max_x=l.max_x;e.min_x=l.min_x;e.max_y=l.max_y;e.min_y=l.min_y;e.max_z=l.max_z;e.min_z=l.min_z;e=b.b4w_boundings.bb_src;e.max_x=l.max_x;e.min_x=l.min_x;e.max_y=l.max_y;e.min_y=l.min_y;
e.max_z=l.max_z;e.min_z=l.min_z;b.b4w_boundings.bs_rad=c;b.b4w_boundings.bc_rad=f;D=k(l,z);D=a(D,!1);b.b4w_boundings.be_cen=D.center;b.b4w_boundings.be_ax=[D.axis_x[0],D.axis_y[1],D.axis_z[2]]};t.H=function(a){var d=a.subarray(0,3),l=a.subarray(6,9),e=a.subarray(12,15),k=a.subarray(18,21);a=f.subtract(l,d,G);f.normalize(a,a);var m=b._10(d,l,e,E),m=f.cross(m,a,m);f.normalize(m,m);var v=f.create(),D=f.create();f.subtract(l,d,J);D[0]=f.dot(J,a);D[1]=f.dot(J,m);l=f.create();f.subtract(e,d,J);l[0]=f.dot(J,
a);l[1]=f.dot(J,m);e=f.create();f.subtract(k,d,J);e[0]=f.dot(J,a);e[1]=f.dot(J,m);k=I();e=[v,D,l,e];v=c(k,e[0],e[1]);for(k=2;k<e.length;k++)if(f.distance(v.center,e[k])>v.radius){for(var h=v,v=e,D=e[k],l=k-1,h=c(h,D,v[0]),n=1;n<=l;n++)if(f.distance(h.center,v[n])>h.radius){for(var z=h,h=v,p=D,r=v[n],u=n-1,z=c(z,p,r),Y=0;Y<=u;Y++)if(f.distance(z.center,h[Y])>z.radius){var K=p,B=r,A=h[Y],T=f.subtract(B,A,J),T=f.squaredLength(T),y=f.subtract(K,A,J),F=f.squaredLength(y),y=f.subtract(K,B,J),ha=f.squaredLength(y),
y=T*(F+ha-T),M=F*(ha+T-F),T=ha*(T+F-ha),F=y+M+T;f.copy(K,z.center);f.scale(z.center,y/F,z.center);f.scaleAndAdd(z.center,B,M/F,z.center);f.scaleAndAdd(z.center,A,T/F,z.center);z.radius=f.distance(z.center,K)}h=z}v=h}k=v;a=f.scale(a,k.center[0],J);f.scaleAndAdd(a,m,k.center[1],a);f.add(a,d,k.center);return k};var m=e(6),b=e(2),f=e(3),T=e(42),fa=e(27),z=new Float32Array(24),G=new Float32Array(3),E=new Float32Array(3),J=new Float32Array(3),M=new Float32Array(3),F=new Float32Array(9),U=new Float32Array(9),
K=new Float32Array(9),sa=.001,v=5E-4,Y=sa/2},function(C,t,e){C=e(0);var R=e(5),V=e(35),n=e(30),y=e(1),d=e(8),k=e(36),I=e(2),A=e(3);e=Object(C.a)("util",function(e,p){var r=Object(R.a)(e),a=Object(V.a)(e),B=Object(n.a)(e),l=Object(y.a)(e);p.AXIS_X=new Float32Array([1,0,0]);p.AXIS_Y=new Float32Array([0,1,0]);p.AXIS_Z=new Float32Array([0,0,1]);p.AXIS_MX=new Float32Array([-1,0,0]);p.AXIS_MY=new Float32Array([0,-1,0]);p.AXIS_MZ=new Float32Array([0,0,-1]);p.XYX=I.o;p.YZY=I.v;p.ZXZ=I.x;p.XZX=I.q;p.YXY=I.s;
p.ZYZ=I.z;p.XYZ=I.p;p.YZX=I.u;p.ZXY=I.w;p.XZY=I.r;p.YXZ=I.t;p.ZYX=I.y;p.f32=function(a){return I._1(a||0)};p.assert=r.assert;p.keyfind=I._18;p.keysearch=I._19;p.matrix_to_quat=function(a){return I._24(a)};p.euler_to_quat=function(a,d){d||(d=new Float32Array(4));return I.Y(a,d)};p.ordered_angles_to_quat=function(a,l,b){b||(b=d.create());return I._27(a,l,b)};p.quat_to_ordered_angles=function(a,d,b){b||(b=A.create());return I._37(a,d,b)};p.quat_to_euler=function(a,d){d||(d=new Float32Array(3));return I._36(a,
d)};p.sign=I._50;p.clamp=I.M;p.quat_to_dir=I._34;p.ground_project_cam_quat=function(a,d){return I._30(a,I.c,I.f,I.e,d)};p.cam_quat_to_mesh_quat=function(a,d){return I.I(a,d)};p.quat_project=function(a,d,b,f,e){return 0!=A.dot(b,f)?(l.error("Wrong in-plane direction"),null):I._30(a,d,b,f,e)};p.hash_code=function(){return B.hash_code.apply(B,arguments)};p.smooth=I._51;p.smooth_v=I._54;p.is_vector=I._16;p.correct_cam_quat_up=I.R;p.quat_to_angle_axis=I._33;p.random_from_array=I._41;p.horizontal_direction=
I._12;p.angle_wrap_0_2pi=I.A;p.angle_wrap_periodic=I.B;p.smooth_step=I._53;p.lerp=I._20;p.deg_to_rad=I.T;p.rad_to_deg=I._39;p.dir_to_quat=I.U;p.is_ie11=a.is_ie11;p.gen_tbn_quats=function(a,d){l.error_once("util.gen_tbn_quats() deprecated. Do not use it anymore.");return k.d(a,d)};p.trunc=I._64});t.a=e},function(C,t,e){function R(e,y,d){var k=e[0],n=e[1],A=e[2],r=e[3],p=e[4],u=e[5],a=e[6],B=e[7];e=e[8];var l=y[0],c=y[1],m=y[2],b=y[3],f=y[4],T=y[5],fa=y[6],z=y[7];y=y[8];d[0]=l*k+c*r+m*a;d[1]=l*n+c*
p+m*B;d[2]=l*A+c*u+m*e;d[3]=b*k+f*r+T*a;d[4]=b*n+f*p+T*B;d[5]=b*A+f*u+T*e;d[6]=fa*k+z*r+y*a;d[7]=fa*n+z*p+y*B;d[8]=fa*A+z*u+y*e;return d}Object.defineProperty(t,"__esModule",{value:!0});t.create=function(){var e=new V(9);e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=1;e[5]=0;e[6]=0;e[7]=0;e[8]=1;return e};t.fromMat4=function(e,y){y[0]=e[0];y[1]=e[1];y[2]=e[2];y[3]=e[4];y[4]=e[5];y[5]=e[6];y[6]=e[8];y[7]=e[9];y[8]=e[10];return y};t.clone=function(e){var n=new V(9);n[0]=e[0];n[1]=e[1];n[2]=e[2];n[3]=e[3];n[4]=e[4];
n[5]=e[5];n[6]=e[6];n[7]=e[7];n[8]=e[8];return n};t.copy=function(e,y){y[0]=e[0];y[1]=e[1];y[2]=e[2];y[3]=e[3];y[4]=e[4];y[5]=e[5];y[6]=e[6];y[7]=e[7];y[8]=e[8];return y};t.identity=function(e){e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=1;e[5]=0;e[6]=0;e[7]=0;e[8]=1;return e};t.transpose=function(e,y){if(y===e){var d=e[1],k=e[2],n=e[5];y[1]=e[3];y[2]=e[6];y[3]=d;y[5]=e[7];y[6]=k;y[7]=n}else y[0]=e[0],y[1]=e[3],y[2]=e[6],y[3]=e[1],y[4]=e[4],y[5]=e[7],y[6]=e[2],y[7]=e[5],y[8]=e[8];return y};t.invert=function(e,
y){var d=e[0],k=e[1],n=e[2],A=e[3],r=e[4],p=e[5],u=e[6],a=e[7],B=e[8],l=B*r-p*a,c=-B*A+p*u,m=a*A-r*u,b=d*l+k*c+n*m;if(!b)return null;b=1/b;y[0]=l*b;y[1]=(-B*k+n*a)*b;y[2]=(p*k-n*r)*b;y[3]=c*b;y[4]=(B*d-n*u)*b;y[5]=(-p*d+n*A)*b;y[6]=m*b;y[7]=(-a*d+k*u)*b;y[8]=(r*d-k*A)*b;return y};t.adjoint=function(e,y){var d=e[0],k=e[1],n=e[2],A=e[3],r=e[4],p=e[5],u=e[6],a=e[7],B=e[8];y[0]=r*B-p*a;y[1]=n*a-k*B;y[2]=k*p-n*r;y[3]=p*u-A*B;y[4]=d*B-n*u;y[5]=n*A-d*p;y[6]=A*a-r*u;y[7]=k*u-d*a;y[8]=d*r-k*A;return y};t.determinant=
function(e){var n=e[3],d=e[4],k=e[5],I=e[6],A=e[7],r=e[8];return e[0]*(r*d-k*A)+e[1]*(-r*n+k*I)+e[2]*(A*n-d*I)};t.multiply=R;e.d(t,"mul",function(){return R});t.translate=function(e,y,d){var k=e[0],n=e[1],A=e[2],r=e[3],p=e[4],u=e[5],a=e[6],B=e[7];e=e[8];var l=y[0];y=y[1];d[0]=k;d[1]=n;d[2]=A;d[3]=r;d[4]=p;d[5]=u;d[6]=l*k+y*r+a;d[7]=l*n+y*p+B;d[8]=l*A+y*u+e;return d};t.rotate=function(e,y,d){var k=e[0],n=e[1],A=e[2],r=e[3],p=e[4],u=e[5],a=e[6],B=e[7];e=e[8];var l=Math.sin(y);y=Math.cos(y);d[0]=y*k+
l*r;d[1]=y*n+l*p;d[2]=y*A+l*u;d[3]=y*r-l*k;d[4]=y*p-l*n;d[5]=y*u-l*A;d[6]=a;d[7]=B;d[8]=e;return d};t.scale=function(e,y,d){var k=y[0];y=y[1];d[0]=k*e[0];d[1]=k*e[1];d[2]=k*e[2];d[3]=y*e[3];d[4]=y*e[4];d[5]=y*e[5];d[6]=e[6];d[7]=e[7];d[8]=e[8];return d};t.fromTranslation=function(e,y){y[0]=1;y[1]=0;y[2]=0;y[3]=0;y[4]=1;y[5]=0;y[6]=e[0];y[7]=e[1];y[8]=1;return y};t.fromRotation=function(e,y){var d=Math.sin(e),k=Math.cos(e);y[0]=k;y[1]=d;y[2]=0;y[3]=-d;y[4]=k;y[5]=0;y[6]=0;y[7]=0;y[8]=1;return y};t.fromScaling=
function(e,y){y[0]=e[0];y[1]=0;y[2]=0;y[3]=0;y[4]=e[1];y[5]=0;y[6]=0;y[7]=0;y[8]=1;return y};t.fromMat2d=function(e,y){y[0]=e[0];y[1]=e[1];y[2]=0;y[3]=e[2];y[4]=e[3];y[5]=0;y[6]=e[4];y[7]=e[5];y[8]=1;return y};t.fromQuat=function(e,y){var d=e[0],k=e[1],n=e[2],A=e[3],r=d+d,p=k+k,u=n+n,d=d*r,a=k*r,k=k*p,B=n*r,l=n*p,n=n*u,r=A*r,p=A*p,A=A*u;y[0]=1-k-n;y[3]=a-A;y[6]=B+p;y[1]=a+A;y[4]=1-d-n;y[7]=l-r;y[2]=B-p;y[5]=l+r;y[8]=1-d-k;return y};t.normalFromMat4=function(e,y){var d=e[0],k=e[1],n=e[2],A=e[3],r=
e[4],p=e[5],u=e[6],a=e[7],B=e[8],l=e[9],c=e[10],m=e[11],b=e[12],f=e[13],T=e[14],fa=e[15],z=d*p-k*r,G=d*u-n*r,E=d*a-A*r,J=k*u-n*p,M=k*a-A*p,F=n*a-A*u,U=B*f-l*b,K=B*T-c*b,B=B*fa-m*b,t=l*T-c*f,l=l*fa-m*f,c=c*fa-m*T,m=z*c-G*l+E*t+J*B-M*K+F*U;if(!m)return null;m=1/m;y[0]=(p*c-u*l+a*t)*m;y[1]=(u*B-r*c-a*K)*m;y[2]=(r*l-p*B+a*U)*m;y[3]=(n*l-k*c-A*t)*m;y[4]=(d*c-n*B+A*K)*m;y[5]=(k*B-d*l-A*U)*m;y[6]=(f*F-T*M+fa*J)*m;y[7]=(T*E-b*F-fa*G)*m;y[8]=(b*M-f*E+fa*z)*m;return y};t.str=function(e){return"mat3("+e[0]+
", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"};t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))};var V="undefined"!==typeof Float32Array?Float32Array:Array},function(C,t,e){C=e(0);var R=e(4),V=e(1);e=Object(C.a)("__extensions",function(e,y){function d(){return u.webgl2?A("OES_texture_float_linear"):n("OES_texture_float_linear")}
function k(){return u.webgl2?A("EXT_color_buffer_float"):n("WEBGL_color_buffer_float")}function n(d){if(d in B)return B[d];var c=a.getExtension(d)||null;B[d]=c;p.log("%cGET EXTENSION","color: #"+(c?"0a0":"a00"),d);return c}function A(d){if(d in B)return B[d];switch(d){case "WEBGL_depth_texture":case "OES_element_index_uint":case "OES_standard_derivatives":case "EXT_shader_texture_lod":case "OES_texture_float":case "OES_texture_half_float":var c={};break;case "ANGLE_instanced_arrays":case "OES_vertex_array_object":c=
a;break;default:c=a.getExtension(d)||null}B[d]=c;p.log("%cGET EXTENSION (WebGL 2)","color: #"+(c?"0a0":"a00"),d);return c}var r=Object(R.a)(e),p=Object(V.a)(e),u=r.defaults,a=null,B={};y.setup_context=function(d){a=d};y.get_s3tc=function(){return n("WEBGL_compressed_texture_s3tc")||n("WEBKIT_WEBGL_compressed_texture_s3tc")};y.get_pvr=function(){return n("WEBKIT_WEBGL_compressed_texture_pvrtc")||n("WEBGL_compressed_texture_pvrtc")};y.get_depth_texture=function(){return u.webgl2?A("WEBGL_depth_texture"):
n("WEBGL_depth_texture")||n("WEBKIT_WEBGL_depth_texture")};y.get_texture_float=function(){return u.webgl2?A("OES_texture_float"):n("OES_texture_float")};y.get_texture_half_float=function(){return u.webgl2?A("OES_texture_half_float"):n("OES_texture_half_float")};y.get_texture_float_linear=d;y.get_texture_half_float_linear=function(){return u.webgl2?d():n("OES_texture_half_float_linear")};y.get_color_buffer_float=k;y.get_color_buffer_half_float=function(){return u.webgl2?k():n("EXT_color_buffer_half_float")};
y.get_aniso=function(){return n("EXT_texture_filter_anisotropic")||n("WEBKIT_EXT_texture_filter_anisotropic")};y.get_texture_lod=function(){return u.webgl2?A("EXT_shader_texture_lod"):n("EXT_shader_texture_lod")};y.get_debug_shaders=function(){return n("WEBGL_debug_shaders")};y.get_renderer_info=function(){return n("WEBGL_debug_renderer_info")};y.get_elem_index_uint=function(){return u.webgl2?A("OES_element_index_uint"):n("OES_element_index_uint")};y.get_standard_derivatives=function(){return u.webgl2?
A("OES_standard_derivatives"):n("OES_standard_derivatives")};y.get_disjoint_timer_query=function(){var d=u.webgl2?A("EXT_disjoint_timer_query_webgl2"):n("EXT_disjoint_timer_query");return null==d?d:d.createQueryEXT?{createQuery:function(){return d.createQueryEXT()},beginQuery:function(a){d.beginQueryEXT(d.TIME_ELAPSED_EXT,a)},endQuery:function(){d.endQueryEXT(d.TIME_ELAPSED_EXT)},getQueryAvailable:function(a){return d.getQueryObjectEXT(a,d.QUERY_RESULT_AVAILABLE_EXT)},getQueryObject:function(a){return d.getQueryObjectEXT(a,
d.QUERY_RESULT_EXT)},getDisjoint:function(){return a.getParameter(d.GPU_DISJOINT_EXT)}}:{createQuery:function(){return a.createQuery()},beginQuery:function(c){a.beginQuery(d.TIME_ELAPSED_EXT,c)},endQuery:function(){a.endQuery(d.TIME_ELAPSED_EXT)},getQueryAvailable:function(c){return a.getQueryParameter(c,a.QUERY_RESULT_AVAILABLE)},getQueryObject:function(c){return a.getQueryParameter(c,a.QUERY_RESULT)},getDisjoint:function(){return a.getParameter(d.GPU_DISJOINT_EXT)}}};y.get_instanced_arrays=function(){if(u.webgl2)return A("ANGLE_instanced_arrays");
var a=n("ANGLE_instanced_arrays");return null==a?a:{drawElementsInstanced:function(c,d,b,f,l){a.drawElementsInstancedANGLE(c,d,b,f,l)},vertexAttribDivisor:function(c,d){a.vertexAttribDivisorANGLE(c,d)},drawArraysInstanced:function(c,d,b,f){a.drawArraysInstancedANGLE(c,d,b,f)}}};y.get_vertex_array_object=function(){if(u.webgl2)return A("OES_vertex_array_object");var a=n("OES_vertex_array_object");return null==a?a:{bindVertexArray:function(c){a.bindVertexArrayOES(c)},createVertexArray:function(){return a.createVertexArrayOES()},
deleteVertexArray:function(c){a.deleteVertexArrayOES(c)},isVertexArray:function(c){return a.isVertexArrayOES(c)}}};y.cleanup=function(){B={}};y.reset=function(){a=null}});t.a=e},function(C,t,e){C=e(0);var R=e(16),V=e(14),n=e(15),y=e(43),d=e(31),k=e(12),I=e(9),A=e(1),r=e(19),p=e(10),u=e(11),a=e(2);e=Object(C.a)("scenes",function(e,l){function c(){var a=B.get_canvas();return G.pick_object(a.clientWidth/2,a.clientHeight/2)}function m(a){return E.is_dynamic_mesh(a)||E.is_empty(a)||E.is_line(a)||E.is_lamp(a)}
var b=Object(R.a)(e),f=Object(V.a)(e),B=Object(n.a)(e),fa=Object(y.a)(e),z=Object(d.a)(e),G=Object(k.a)(e),E=Object(I.a)(e),J=Object(A.a)(e),M=Object(r.a)(e),F=Object(p.a)(e),U=Object(u.a)(e);l.DATA_ID_ALL=G.DATA_ID_ALL;l.set_active=function(b){var c=F.get_all_scenes();F.set_active(a._19("name",b,c))};l.get_active=function(){return F.check_active()?F.get_active().name:""};l.get_scenes=function(){for(var a=F.get_all_scenes(),b=[],c=0;c<a.length;c++)b.push(a[c].name);return b};l.get_active_camera=function(){if(F.check_active())return F.get_camera(F.get_active());
J.error("No active scene");return!1};l.get_object_by_name=function(a,b){var c=G.get_object(G.GET_OBJECT_BY_NAME,a,b|0,!0);if(c)return c;J.error("get object "+a+": not found")};l.get_object_by_dupli_name=function(a,b,c){if(a=G.get_object(G.GET_OBJECT_BY_DUPLI_NAME,a,b,c|0))return a;J.error("get object "+b+": not found")};l.get_object_by_dupli_name_list=function(a,b){var c=G.get_object(G.GET_OBJECT_BY_DUPLI_NAME_LIST,a,b|0);if(c)return c;J.error("get object "+a+": not found")};l.get_world_by_name=function(a,
b){var c=G.get_world_by_name(a,b|0);if(c)return c;J.error("get object "+a+": not found")};l.get_object_data_id=function(a){return E.get_object_data_id(a)};l.pick_object=function(a,b){var f=F.get_main();return f?(f=F.get_subs(f,U.STEREO))&&f.enable_hmd_stereo?(J.error_once("pick_object() is not available in the stereo rendering mode. Use scenes.pick_center instead."),c()):G.pick_object(a,b):(J.error("No active scene"),null)};l.pick_center=c;l.outlining_is_enabled=function(a){return a&&a.render&&a.render.outlining};
l.set_outline_intensity=function(a,b){a&&a.render&&a.render.outlining?G.set_outline_intensity(a,b):J.error("set_outline_intensity(): wrong object")};l.get_outline_intensity=function(a){if(a&&a.render&&a.render.outlining)return a.render.outline_intensity;J.error("get_outline_intensity(): wrong object");return 0};l.apply_outline_anim=function(a,b,c,f){a&&a.render&&a.render.outlining?G.apply_outline_anim(a,b,c,f):J.error("apply_outline_anim(): wrong object")};l.apply_outline_anim_def=function(a){if(a&&
a.render&&a.render.outlining){var b=a.render.outline_anim_settings_default;G.apply_outline_anim(a,b.outline_duration,b.outline_period,b.outline_relapses)}else J.error("apply_outline_anim_def(): wrong object")};l.clear_outline_anim=function(a){a&&a.render&&a.render.outlining?G.clear_outline_anim(a):J.error("clear_outline_anim(): wrong object")};l.set_outline_color=F.set_outline_color;l.get_outline_color=function(a){var b=F.get_active();if(b=F.get_subs(b,U.OUTLINE))return a=a||new Float32Array(3),a.set(b.outline_color),
a};l.set_hmd_params=function(a){F.check_active()?a&&(!a.distortion_coefs||a.distortion_coefs instanceof Array||(a.distortion_coefs=null),!a.chromatic_aberration_coefs||a.chromatic_aberration_coefs instanceof Array||(a.chromatic_aberration_coefs=null),"number"!=typeof a.base_line_factor&&(a.base_line_factor=null),"number"!=typeof a.inter_lens_factor&&(a.inter_lens_factor=null),"boolean"!=typeof a.enable_hmd_stereo&&(a.enable_hmd_stereo=null),F.set_hmd_params(a)):J.error("No active scene")};l.get_shadow_params=
function(){if(!F.check_active())return J.error("No active scene"),!1;var a=F.get_active(),b=F.get_subs(a,U.SHADOW_CAST);if(!b)return null;var c=a._render.shadow_params,f=F.get_subs(a,U.MAIN_OPAQUE),d=F.get_subs(a,U.SHADOW_RECEIVE),l={};l.csm_resolution=c.csm_resolution;l.self_shadow_polygon_offset=b.self_shadow_polygon_offset;d&&(l.self_shadow_normal_offset=d.self_shadow_normal_offset);l.enable_csm=c.enable_csm;l.csm_num=c.csm_num;l.csm_first_cascade_border=c.csm_first_cascade_border;l.first_cascade_blur_radius=
c.first_cascade_blur_radius;l.csm_last_cascade_border=c.csm_last_cascade_border;l.last_cascade_blur_radius=c.last_cascade_blur_radius;l.fade_last_cascade=c.fade_last_cascade;l.blend_between_cascades=c.blend_between_cascades;c.enable_csm?(l.csm_borders=F.get_csm_borders(a,f.camera),l.blur_radii=new Float32Array(c.csm_num),l.blur_radii.set(f.camera.pcf_blur_radii.subarray(0,c.csm_num))):(l.csm_borders=null,l.blur_radii=null);return l};l.set_shadow_params=function(a){if(F.check_active()){var c=F.get_active();
"number"==typeof a.self_shadow_polygon_offset&&z.traverse(c._render.graph,function(b,c){c.type==U.SHADOW_CAST&&(c.self_shadow_polygon_offset=a.self_shadow_polygon_offset)});for(var d=F.subs_array(c,[U.SHADOW_RECEIVE]),l=0;l<d.length;l++){var e=d[l];"number"==typeof a.self_shadow_normal_offset&&(e.self_shadow_normal_offset=a.self_shadow_normal_offset);"number"==typeof a.pcf_blur_radius&&(e.pcf_blur_radius=a.pcf_blur_radius)}d=F.subs_array(c,[U.MAIN_BLEND]);for(l=0;l<d.length;l++){var k=d[l];"number"==
typeof a.self_shadow_normal_offset&&(k.self_shadow_normal_offset=a.self_shadow_normal_offset);"number"==typeof a.pcf_blur_radius&&(k.pcf_blur_radius=a.pcf_blur_radius);k.need_perm_uniforms_update=!0}d=c._render.shadow_params;"number"==typeof a.csm_first_cascade_border&&(d.csm_first_cascade_border=a.csm_first_cascade_border);"number"==typeof a.first_cascade_blur_radius&&(d.first_cascade_blur_radius=a.first_cascade_blur_radius);"number"==typeof a.csm_last_cascade_border&&(d.csm_last_cascade_border=
a.csm_last_cascade_border);"number"==typeof a.last_cascade_blur_radius&&(d.last_cascade_blur_radius=a.last_cascade_blur_radius);if(e){k=e.draw_data;for(l=0;l<k.length;l++)for(var m=k[l].bundles,q=0;q<m.length;q++){var w=m[q];if(w.obj_render.shadow_receive){var p=w.batch;b.assign_shadow_receive_dirs(p,d);b.update_shader(p);U.append_draw_data(e,w)}}e.need_perm_uniforms_update=!0}e=E.get_scene_data(c._camera,c).cameras;for(l=0;l<e.length;l++)f.update_camera_shadows(e[l],d);F.schedule_shadow_update(c)}else J.error("No active scene")};
l.get_environment_colors=function(){if(!F.check_active())return J.error("No active scene"),[];var a=F.get_active();return F.get_environment_colors(a)};l.set_environment_colors=function(a,b,c){if(F.check_active()){var f=F.get_active(),d=F.get_subs(f,U.MAIN_OPAQUE);a=a||0==a?parseFloat(a):d.environment_energy;F.set_environment_colors(f,a,b||0==b?b:d.horizon_color,c||0==c?c:d.zenith_color)}else J.error("No active scene")};l.get_fog_color_density=function(a){if(!F.check_active())return J.error("No active scene"),
!1;var b=F.get_active();return F.get_fog_color_density(b,a)};l.set_fog_color_density=function(a){if(F.check_active()){var b=F.get_active();F.set_fog_color_density(b,a)}else J.error("No active scene")};l.get_fog_params=function(){if(!F.check_active())return J.error("No active scene"),!1;var a=F.get_active(),b={};b.fog_intensity=F.get_fog_intensity(a);b.fog_depth=F.get_fog_depth(a);b.fog_start=F.get_fog_start(a);b.fog_height=F.get_fog_height(a);return b};l.set_fog_params=function(a){if(F.check_active()){var b=
F.get_active();"number"==typeof a.fog_intensity&&F.set_fog_intensity(b,a.fog_intensity);"number"==typeof a.fog_depth&&F.set_fog_depth(b,a.fog_depth);"number"==typeof a.fog_start&&F.set_fog_start(b,a.fog_start);"number"==typeof a.fog_height&&F.set_fog_height(b,a.fog_height)}else J.error("No active scene")};l.get_ssao_params=function(){if(!F.check_active())return J.error("No active scene"),!1;var a=F.get_active();return F.get_ssao_params(a)};l.set_ssao_params=function(a){if(F.check_active()){var c=
F.get_active(),f=F.subs_array(c,[U.SSAO]),c=F.subs_array(c,[U.SSAO_BLUR]);if(!f.length)return J.error("SSAO is not enabled on the scene"),0;for(var d=0;d<f.length;d++){var l=f[d],e=c[d],k=a,m=F.get_active(),w=l.draw_data[0].bundles[0],z=w.batch,p=e.draw_data[0].bundles[0],D=p.batch;if("quality"in k){var h=k.quality;8===h||16===h||24===h||32===h?(l.ssao_samples=h,b.set_batch_directive(z,"SSAO_QUALITY","SSAO_QUALITY_"+h),b.update_shader(z),U.append_draw_data(l,w)):J.error('set_ssao_params(): Wrong "quality" value.')}"use_hemisphere"in
k&&(l.ssao_hemisphere=k.use_hemisphere,b.set_batch_directive(z,"SSAO_HEMISPHERE",k.use_hemisphere|0),b.update_shader(z),U.append_draw_data(l,w));"use_blur_depth"in k&&(e.ssao_blur_depth=k.use_blur_depth,b.set_batch_directive(D,"SSAO_BLUR_DEPTH",k.use_blur_depth|0),b.update_shader(D),U.append_draw_data(e,p),F.connect_render_targets_batch(m._render.graph,e,D,!1));"ssao_white"in k&&(l.ssao_white=k.ssao_white,b.set_batch_directive(z,"SSAO_WHITE",k.ssao_white|0),b.update_shader(z),U.append_draw_data(l,
w));"blur_discard_value"in k&&(e.ssao_blur_discard_value=k.blur_discard_value);"radius_increase"in k&&(l.ssao_radius_increase=k.radius_increase);"influence"in k&&(l.ssao_influence=k.influence);"dist_factor"in k&&(l.ssao_dist_factor=k.dist_factor);if("boolean"==typeof k.ssao_only){m=F.get_subs(m,U.MAIN_OPAQUE);m.ssao_only=k.ssao_only;w=m.draw_data;z=[];for(p=0;p<w.length;p++)for(D=w[p].bundles,h=0;h<D.length;h++){var r=D[h].batch;b.set_batch_directive(r,"SSAO_ONLY",k.ssao_only|0);b.update_shader(r);
z.push(D[h])}for(p=0;p<z.length;p++)U.append_draw_data(m,z[p])}l.need_perm_uniforms_update=!0;e.need_perm_uniforms_update=!0}}else J.error("No active scene")};l.get_color_correction_params=function(){if(!F.check_active())return J.error("No active scene"),null;var a=F.get_active(),a=F.get_subs(a,U.COMPOSITING);if(!a)return null;var b={};b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;return b};l.set_color_correction_params=function(a){if(F.check_active()){var b=
F.get_active();if(b=F.get_subs(b,U.COMPOSITING))"brightness"in a&&(b.brightness=a.brightness),"contrast"in a&&(b.contrast=a.contrast),"exposure"in a&&(b.exposure=a.exposure),"saturation"in a&&(b.saturation=a.saturation),b.need_perm_uniforms_update=!0}else J.error("No active scene")};l.get_sky_params=function(){if(!F.check_active())return J.error("No active scene"),!1;var a=F.get_active();return F.get_sky_params(a)};l.set_sky_params=function(a){if(F.check_active()){var b=F.get_active(),c=F.get_subs(b,
U.SKY);c&&("color"in a&&c.sky_color.set(a.color),"rayleigh_brightness"in a&&(c.rayleigh_brightness=a.rayleigh_brightness),"mie_brightness"in a&&(c.mie_brightness=a.mie_brightness),"spot_brightness"in a&&(c.spot_brightness=a.spot_brightness),"scatter_strength"in a&&(c.scatter_strength=a.scatter_strength),"rayleigh_strength"in a&&(c.rayleigh_strength=a.rayleigh_strength),"mie_strength"in a&&(c.mie_strength=a.mie_strength),"rayleigh_collection_power"in a&&(c.rayleigh_collection_power=a.rayleigh_collection_power),
"mie_collection_power"in a&&(c.mie_collection_power=a.mie_collection_power),"mie_distribution"in a&&(c.mie_distribution=a.mie_distribution),c.need_perm_uniforms_update=!0,c.need_fog_update=!0,F.update_sky(b,c))}else J.error("No active scene")};l.get_dof_params=function(){if(!F.check_active())return J.error("No active scene"),!1;var a=F.get_active();return F.get_subs(a,U.DOF)?F.get_dof_params(a):null};l.set_dof_params=function(a){if(F.check_active()){var b=F.get_active();F.set_dof_params(b,a)}else J.error("No active scene")};
l.get_god_rays_params=function(){if(!F.check_active())return J.error("No active scene"),!1;var a=F.get_active();return F.get_subs(a,U.GOD_RAYS)?F.get_god_rays_params(a):null};l.set_god_rays_params=function(a){if(F.check_active()){var b=F.get_active();F.set_god_rays_params(b,a)}else J.error("No active scene")};l.get_bloom_params=function(){if(!F.check_active())return J.error("No active scene"),!1;var a=F.get_active();return F.get_subs(a,U.BLOOM)?F.get_bloom_params(a):null};l.set_bloom_params=function(a){if(F.check_active()){var b=
F.get_active();F.set_bloom_params(b,a)}else J.error("No active scene")};l.get_glow_material_params=function(){if(!F.check_active())return J.error("No active scene"),!1;var a=F.get_active();return F.get_subs(a,U.GLOW_COMBINE)?F.get_glow_material_params(a):null};l.set_glow_material_params=function(a){if(F.check_active()){var b=F.get_active();F.set_glow_material_params(b,a)}else J.error("No active scene")};l.get_wind_params=function(){if(!F.check_active())return J.error("No active scene"),!1;var a=F.get_active();
return F.get_wind_params(a)};l.set_wind_params=function(a){if(F.check_active()){var b=F.get_active();G.set_wind_params(b,a)}else J.error("No active scene")};l.get_water_surface_level=function(a,b){if(!F.check_active())return J.error("No active scene"),0;var c=F.get_active();return c._render.water_params?F.get_water_surface_level(c,a,b):(J.error("No water parameters on the active scene"),0)};l.set_water_params=function(a){if(F.check_active()){var b=F.get_active();F.set_water_params(b,a)}else J.error("No active scene")};
l.get_water_mat_params=function(a){if(F.check_active()){var b=F.get_active();F.get_water_mat_params(b,a)}else J.error("No active scene")};l.update_scene_materials_params=function(){if(F.check_active()){var a=F.get_active();F.update_scene_permanent_uniforms(a)}else J.error("No active scene")};l.hide_object=function(a,b){b=b||!1;m(a)?b?F.change_visibility(a,!0):F.change_visibility_rec(a,!0):J.error("show/hide is only supported for dynamic objects.")};l.show_object=function(a,b){b=b||!1;m(a)?b?F.change_visibility(a,
!1):F.change_visibility_rec(a,!1):J.error("show/hide is only supported for dynamic objects.")};l.is_hidden=function(a){if(m(a))return F.is_hidden(a);J.error("show/hide is only supported for dynamic meshes/empties and lamps");return!1};l.is_visible=function(a){return a.render.is_visible};l.check_object_by_name=function(a,b){return G.get_object(G.GET_OBJECT_BY_NAME,a,b|0,!0)?!0:!1};l.check_object_by_dupli_name=function(a,b,c){return G.get_object(G.GET_OBJECT_BY_DUPLI_NAME,a,b,c|0)?!0:!1};l.check_object_by_dupli_name_list=
function(a,b){return G.get_object(G.GET_OBJECT_BY_DUPLI_NAME_LIST,a,b|0)?!0:!1};l.get_all_objects=function(a,b){var c=F.get_active();a||(a="ALL");b||0===b||(b=G.DATA_ID_ALL);return G.get_scene_objs_derived(c,a,b)};l.get_object_name=function(a){return a?a.origin_name:(J.error("Wrong object name"),"")};l.get_object_name_hierarchy=function(a){if(!a)return J.error("Wrong object name"),null;for(var b=[];a;)b.push(a.origin_name),a=E.get_dg_parent(a);return b.reverse()};l.get_object_type=function(a){return a&&
a.type?a.type:(J.error("Wrong object"),"UNDEFINED")};l.get_object_children=function(a){return a.cons_descends.slice(0)};l.get_first_character=function(){return G.get_first_character(F.get_active())};l.get_shore_dist=function(a,b){b||0===b||(b=1);if(!F.check_active())return J.error("No active scene"),0;var c=F.get_active();return F.get_shore_dist(c,a,b)};l.get_cam_water_depth=function(){return F.get_cam_water_depth()};l.get_type_mesh_object=function(a){return E.is_mesh(a)?a.render.type:""};l.get_meta_tags=
function(){if(!F.check_active())return J.error("No active scene"),!1;var a=F.get_active();return F.get_meta_tags(a)};l.get_custom_prop=function(){if(!F.check_active())return J.error("No active scene"),!1;var a=F.get_active();return F.get_custom_prop(a)};l.append_object=function(b,c){if(c)var f=F.get_all_scenes(),f=a._19("name",c,f);else f=F.get_active();F.append_object(f,b,!0);M.append_object(b,f)};l.remove_object=function(a){E.is_dynamic_mesh(a)||E.is_empty(a)||E.is_line(a)?(G.obj_switch_cleanup_flags(a,
a.render.is_copied_deep,!1,!1),fa.prepare_object_unloading(a),G.obj_switch_cleanup_flags(a,!0,!0,!0),G.remove_object(a)):J.error("Can't remove object \""+a.name+'". It must be dynamic and type of MESH or EMPTY.')};l.marker_frame=function(a){var b=F.get_active();if(b.timeline_markers&&a in b.timeline_markers)return F.marker_frame(b,a);J.error('"'+a+'" marker not found.');return 0};l.get_mb_params=function(){var a=F.get_active();return(a=F.get_subs(a,U.MOTION_BLUR))?{mb_factor:a.mb_factor,mb_decay_threshold:a.mb_decay_threshold}:
null};l.set_mb_params=function(a){var b=F.get_active(),b=F.subs_array(b,[U.MOTION_BLUR]);if(b.length)for(var c=0;c<b.length;c++){var f=b[c];"number"==typeof a.mb_decay_threshold&&(f.mb_decay_threshold=a.mb_decay_threshold);"number"==typeof a.mb_factor&&(f.mb_factor=a.mb_factor)}else J.error("The motion blur subscene doesn't exist.")};l.can_select_objects=function(){var a=F.get_active();return!!F.get_subs(a,U.COLOR_PICKING)}});t.a=e},function(C,t,e){C=e(0);var R=e(5),V=e(1);e=Object(C.a)("generator",
function(e,y){function d(a,c){var l=c;switch(typeof a){case "object":if(a)switch(a.constructor){case Object:for(var b in a)l=d(a[b],l);break;case Int8Array:case Uint8Array:case Uint8ClampedArray:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:for(b=0;b<a.length;b++)l=k(a[b],l);break;case Array:for(b=0;b<a.length;b++)l=d(a[b],l);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLRenderbuffer:case WebGLTexture:case WebGLBuffer:l=
k(0,l);break;default:n.panic("Wrong object constructor:",a.constructor)}else l=k(0,l);return l;case "number":return k(a,l);case "boolean":return k(a|0,l);case "string":for(b=0;b<a.length;b++)var f=a.charCodeAt(b),l=(l<<5)-l+f,l=l&l;return l;case "function":case "undefined":return k(0,l)}}function k(d,c){var l=c;a[0]=d;l=(l<<5)-l+B[0];l&=l;l=(l<<5)-l+B[1];return l&l}var n=Object(R.a)(e),A=Object(V.a)(e),r=1,p=0,u={},a=new Float64Array(1),B=new Uint32Array(a.buffer);y.unique_name=function(a){u[a]||
(u[a]=0);var c=a+u[a];u[a]++;return c};y.cleanup=function(){p=0;u={}};y.unique_id=function(){p++;return p.toString(10)};y.gen_color_id=function(a){a++;132651<a&&A.error("Color ID pool depleted");var c=Math.floor(a/2601);a%=2601;return new Float32Array([c/51,Math.floor(a/51)/51,a%51/51])};y.rand=function(){r=(69069*r+5)%Math.pow(2,32);return Math.round(r/65536)%32768/32767};y.srand=function(a){r=a};y.calc_variable_id=function(a,c){return d(a,c)};y.hash_code=d});t.a=e},function(C,t,e){C=e(0);var R=
e(5),V=e(2);e=Object(C.a)("__graph",function(e,y){function d(a,b,c){c||(c=null);k(a,b)?ha.panic("Graph already has node with given ID"):a.nodes.push(b,c)}function k(a,b){for(var c=a.nodes,f=0;f<c.length;f+=2)if(c[f]==b)return!0;return!1}function n(a,b,c,f){f||(f=null);k(a,b)&&k(a,c)?a.edges.push(b,c,f):ha.panic("Wrong node IDs")}function A(a,b){k(a,b)||ha.panic("Node not found");for(var c=a.nodes,f=0;f<c.length;f+=2)c[f]==b&&(c.splice(f,2),f-=2)}function r(a,b,c,f){K(a,b,c)||ha.panic("Edge not found");
a=a.edges;for(var d=0,l=0;l<a.length;l+=3)if(a[l]==b&&a[l+1]==c){if(-1==f)a.splice(l,3);else{if(f==d){a.splice(l,3);break}d++}l-=3}}function p(a){a=a.nodes;for(var b=-1,c=0;c<a.length;c+=2)b=Math.max(b,a[c]);return++b}function u(a,b){for(var c=a.nodes,f=0;f<c.length;f+=2)if(c[f+1]==b)return c[f];return-1}function a(a){var b=[],c={};B(a,c);for(var f=a.nodes,d=0;d<f.length;d+=2)0==M(a,f[d])&&l(a,f[d],c,b);return{nodes:b,edges:a.edges.slice(0)}}function B(a,b){for(var c=a.nodes,f=0;f<c.length;f+=2)b[c[f]]=
!1}function l(a,b,c,f){if(!c[b]){c[b]=!0;for(var d=0;d<J(a,b);d++){var e=F(a,b,d);l(a,e,c,f)}f.unshift(b,E(a,b))}}function c(a,b,f,d){if(!f[b]){f[b]=!0;if(10==d||30==d)for(var l=0;l<J(a,b);l++){var e=F(a,b,l);c(a,e,f,d)}if(20==d||30==d)for(l=0;l<M(a,b);l++)e=U(a,b,l),c(a,e,f,d)}}function m(a){for(var b=a.edges,c=0;c<b.length;c+=3){var f=b[c+1];k(a,b[c])&&k(a,f)||(b.splice(c,3),c-=3)}}function b(a){for(var b=[],c=a.nodes,f=0;f<c.length;f+=2){var d=c[f];J(a,d)||b.push(d)}return b}function f(a){var b=
a.nodes;a=a.edges;for(var c=[],f=[],d=[],l=0;l<b.length;l++)d[b[2*l]]=l,c.push(l,b[2*l+1]);for(l=0;l<a.length;l+=3)f.push(d[a[l]],d[a[l+1]],a[l+2]);return{nodes:c,edges:f}}function T(a,b,c){if(c.core_len==c.n1){for(var f=0,d=0;f<c.n1;f++)-1!=c.core_1[f]&&(a[d]=f,b[d]=c.core_1[f],d++);return!0}if(c.n1>c.n2||c.t1both_len>c.t2both_len||c.t1out_len>c.t2out_len||c.t1in_len>c.t2in_len)return!1;for(var d=f=-1,l=!1;!l&&fa(c,S,f,d);)if(f=S[0],d=S[1],z(c,f,d)){var h;h=c;l={};l.g1=h.g1;l.g2=h.g2;l.node_comp=
h.node_comp;l.edge_comp=h.edge_comp;l.n1=h.n1;l.n2=h.n2;l.order=h.order;l.core_len=l.orig_core_len=h.core_len;l.t1in_len=h.t1in_len;l.t1out_len=h.t1out_len;l.t1both_len=h.t1both_len;l.t2in_len=h.t2in_len;l.t2out_len=h.t2out_len;l.t2both_len=h.t2both_len;l.added_node1=-1;l.core_1=h.core_1;l.core_2=h.core_2;l.in_1=h.in_1;l.in_2=h.in_2;l.out_1=h.out_1;l.out_2=h.out_2;l.share_count=h.share_count;h.share_count[0]+=1;var l=h=l,e=f,k=d,m=l.g1,q=l.g2,v=l.n1,w=l.n2,p=l.core_1,r=l.core_2,n=l.in_1,u=l.in_2,
E=l.out_1,Y=l.out_2;G(e<v);G(k<w);G(l.core_len<v);G(l.core_len<w);v=++l.core_len;l.added_node1=e;n[e]||(n[e]=v,l.t1in_len++,E[e]&&l.t1both_len++);E[e]||(E[e]=v,l.t1out_len++,n[e]&&l.t1both_len++);u[k]||(u[k]=v,l.t2in_len++,Y[k]&&l.t2both_len++);Y[k]||(Y[k]=v,l.t2out_len++,u[k]&&l.t2both_len++);p[e]=k;r[k]=e;for(p=0;p<M(m,e);p++)r=U(m,e,p),n[r]||(n[r]=v,l.t1in_len++,E[r]&&l.t1both_len++);for(p=0;p<J(m,e);p++)r=F(m,e,p),E[r]||(E[r]=v,l.t1out_len++,n[r]&&l.t1both_len++);for(p=0;p<M(q,k);p++)r=U(q,k,
p),u[r]||(u[r]=v,l.t2in_len++,Y[r]&&l.t2both_len++);for(p=0;p<J(q,k);p++)r=F(q,k,p),Y[r]||(Y[r]=v,l.t2out_len++,u[r]&&l.t2both_len++);l=T(a,b,h);G(1>=h.core_len-h.orig_core_len);G(-1!=h.added_node1);r=h.g1;e=h.g2;k=h.core_len;m=h.added_node1;q=h.core_1;n=h.core_2;v=h.in_1;u=h.in_2;w=h.out_1;E=h.out_2;if(h.orig_core_len<k){v[m]==k&&(v[m]=0);for(Y=0;Y<M(r,m);Y++)p=U(r,m,Y),v[p]==k&&(v[p]=0);w[m]==k&&(w[m]=0);for(Y=0;Y<J(r,m);Y++)p=F(r,m,Y),w[p]==k&&(w[p]=0);r=q[m];u[r]==k&&(u[r]=0);for(Y=0;Y<M(e,r);Y++)p=
U(e,r,Y),u[p]==k&&(u[p]=0);E[r]==k&&(E[r]=0);for(Y=0;Y<J(e,r);Y++)p=F(e,r,Y),E[p]==k&&(E[p]=0);q[m]=-1;n[r]=-1;h.core_len=h.orig_core_len;h.added_node1=-1}}return l}function fa(a,b,c,f){-1==c&&(c=0);-1==f?f=0:f++;var d=a.t1both_len,l=a.t2both_len,h=a.t1out_len,e=a.t2out_len,k=a.t1in_len,m=a.t2in_len,q=a.core_len,v=a.n1,w=a.n2,z=a.core_1,p=a.core_2,r=a.in_1,n=a.in_2,u=a.out_1,E=a.out_2;if(d>q&&l>q)for(;c<v&&(-1!=z[c]||0==u[c]||0==r[c]);)c++,f=0;else if(h>q&&e>q)for(;c<v&&(-1!=z[c]||0==u[c]);)c++,f=
0;else if(k>q&&m>q)for(;c<v&&(-1!=z[c]||0==r[c]);)c++,f=0;else if(0==c&&0!=a.order){for(r=0;r<v&&-1!=z[c=a.order[r]];)r++;r==v&&(c=v)}else for(;c<v&&-1!=z[c];)c++,f=0;if(d>q&&l>q)for(;f<w&&(-1!=p[f]||0==E[f]||0==n[f]);)f++;else if(h>q&&e>q)for(;f<w&&(-1!=p[f]||0==E[f]);)f++;else if(k>q&&m>q)for(;f<w&&(-1!=p[f]||0==n[f]);)f++;else for(;f<w&&-1!=p[f];)f++;return c<v&&f<w?(b[0]=c,b[1]=f,!0):!1}function z(a,b,c){var f=a.g1,d=a.g2,l=a.n2,h=a.core_1,e=a.core_2,k=a.in_1,m=a.in_2,q=a.out_1,v=a.out_2;G(b<
a.n1);G(c<l);G(-1==h[b]);G(-1==e[c]);l=(0,a.node_comp)(E(f,b),E(d,c))?!0:!1;if(!l)return!1;for(var w=l=0,z=0,p=0,r=0,n=0,u=0;u<J(f,b);u++){var Y=F(f,b,u);if(-1!=h[Y]){var L=h[Y];if(!K(d,c,L)||!t(a.edge_comp,f,b,Y,d,c,L))return!1}else k[Y]&&z++,q[Y]&&l++,k[Y]||q[Y]||r++}for(u=0;u<M(f,b);u++)if(Y=U(f,b,u),-1!=h[Y]){if(L=h[Y],!K(d,L,c)||!t(a.edge_comp,f,Y,b,d,L,c))return!1}else k[Y]&&z++,q[Y]&&l++,k[Y]||q[Y]||r++;for(u=0;u<J(d,c);u++)if(L=F(d,c,u),-1!=e[L]){if(Y=e[L],!K(f,b,Y))return!1}else m[L]&&p++,
v[L]&&w++,m[L]||v[L]||n++;for(u=0;u<M(d,c);u++)if(L=U(d,c,u),-1!=e[L]){if(Y=e[L],!K(f,Y,b))return!1}else m[L]&&p++,v[L]&&w++,m[L]||v[L]||n++;return z<=p&&l<=w&&r<=n}function G(a){a||ha.panic("Assertion failed")}function E(a,b){for(var c=a.nodes,f=0;f<c.length;f+=2)if(c[f]==b)return c[f+1];return null}function J(a,b){for(var c=a.edges,f=0,d=0;d<c.length;d+=3)c[d]==b&&f++;return f}function M(a,b){for(var c=a.edges,f=0,d=0;d<c.length;d+=3)c[d+1]==b&&f++;return f}function F(a,b,c){a=a.edges;for(var f=
0,d=0;d<a.length;d+=3)if(a[d]==b){if(f==c)return a[d+1];f++}return-1}function U(a,b,c){a=a.edges;for(var f=0,d=0;d<a.length;d+=3)if(a[d+1]==b){if(f==c)return a[d];f++}return-1}function K(a,b,c){a=a.edges;for(var f=0;f<a.length;f+=3)if(a[f]==b&&a[f+1]==c)return!0;return!1}function t(a,b,c,f,d,l,h){for(var e=v(b,c,f),k=v(d,l,h),m=0;m<e;m++){for(var q=!1,D=0;D<k;D++)if(a(Y(b,c,f,m),Y(d,l,h,D))){q=!0;break}if(!q)return!1}return!0}function v(a,b,c){var f=0;a=a.edges;for(var d=0;d<a.length;d+=3)a[d]==b&&
a[d+1]==c&&f++;return f}function Y(a,b,c,f){a=a.edges;for(var d=0,l=0;l<a.length;l+=3)if(a[l]==b&&a[l+1]==c){if(d==f)return a[l+2];d++}return null}var ha=Object(R.a)(e),S=[-1,-1];y.NULL_NODE=-1;y.FORWARD_DIR=10;y.BACKWARD_DIR=20;y.TWO_WAY=30;y.create=function(){for(var a=arguments,b=[],c=[],f=0;f<a.length;f++){var d=a[f];switch(d.length){case 2:b.push(d[0],d[1]);break;case 3:c.push(d[0],d[1],d[2]);break;default:ha.panic("Wrong graph constructor params")}}return{nodes:b,edges:c}};y.clone=function(a,
b,c){if(b)for(var f=Array(a.nodes.length),d=0;d<a.nodes.length;d+=2)f[d]=a.nodes[d],f[d+1]=b(a.nodes[d+1]);else f=V.O(a.nodes);if(c)for(b=Array(a.edges.length),d=0;d<a.edges.length;d+=3)b[d]=a.edges[d],b[d+1]=a.edges[d+1],b[d+2]=c(a.edges[d+2]);else b=V.O(a.edges);return a={nodes:f,edges:b}};y.create_node_edge_arr=function(a,b){for(var c=[],f=[],d=0;d<a.length;d++)c.push(a[d][0],a[d][1]);for(d=0;d<b.length;d++)f.push(b[d][0],b[d][1],b[d][2]);return{nodes:c,edges:f}};y.append_node=d;y.has_node=k;y.append_edge=
n;y.remove_node=A;y.remove_edge=r;y.remove_edge_by_attr=function(a,b,c,f){K(a,b,c)||ha.panic("Edge not found");a=a.edges;for(var d=0;d<a.length;d+=3)if(a[d]==b&&a[d+1]==c&&a[d+2][0]==f[0]&&a[d+2][1]==f[1]){a.splice(d,3);break}};y.append_node_attr=function(a,b){if(-1==u(a,b)){var c=p(a);d(a,c,b);return c}ha.panic("Non-unique attribute")};y.replace_edge_attr=function(a,b,c,f,d){a=a.edges;for(var l=0;l<a.length;l+=3)a[l]==b&&a[l+1]==c&&a[l+2]==f&&(a[l+2]=d)};y.append_subgraph=function(a,b,c,f){c=c||
[];f=f||[];for(var l={},e=0;e<a.nodes.length;e+=2){var h=a.nodes[e],k=a.nodes[e+1],m=p(b);d(b,m,k);l[h]=m}for(e=0;e<a.edges.length;e+=3)k=l[a.edges[e]],m=l[a.edges[e+1]],h=a.edges[e+2],n(b,k,m,h);for(e=0;e<c.length;e+=3)k=l[c[e]],a=c[e+1],h=c[e+2],n(b,k,a,h);for(e=0;e<f.length;e+=3)c=f[e],m=l[f[e+1]],h=f[e+2],n(b,c,m,h)};y.gen_node_id=p;y.node_by_attr=u;y.append_edge_attr=function(a,b,c,f){b=u(a,b);c=u(a,c);-1!=b&&-1!=c?n(a,b,c,f):ha.panic("Attributes not found")};y.traverse=function(a,b){for(var c=
a.nodes,f=0;f<c.length&&!b(c[f],c[f+1]);f+=2);};y.traverse_edges=function(a,b){for(var c=a.edges,f=0;f<c.length&&!b(c[f],c[f+1],c[f+2]);f+=3);};y.traverse_inputs=function(a,b,c){for(var f=a.edges,d=0;d<f.length;d+=3)if(f[d+1]==b){var l=f[d];if(c(l,E(a,l),f[d+2]))break}};y.traverse_outputs=function(a,b,c){for(var f=a.edges,d=0;d<f.length;d+=3)if(f[d]==b){var l=f[d+1];if(c(l,E(a,l),f[d+2]))break}};y.topsort=a;y.topsort_attr=function(b){b=a(b).nodes;for(var c=[],f=0;f<b.length;f+=2)c.push(b[f+1]);return c};
y.is_connected=function(a){};y.subgraph_node_conn=function(a,b,f){k(a,b)||ha.panic("No such node");var d={};B(a,d);c(a,b,d,f);b=[];for(var l in d)d[l]&&(l=Number(l),b.push(l,E(a,l)));a={nodes:b,edges:a.edges.slice(0)};m(a);return a};y.cleanup_loose_edges=m;y.get_source_nodes=function(a){for(var b=[],c=a.nodes,f=0;f<c.length;f+=2){var d=c[f];M(a,d)||b.push(d)}return b};y.get_sink_nodes=b;y.match=function(a,b,c,d){var l={};l.g1=f(a);l.g2=f(b);l.node_comp=c||function(a,b){return a==b};l.edge_comp=d||
function(a,b){return a==b};d=a.nodes.length/2;var e=b.nodes.length/2;l.n1=d;l.n2=e;l.order=0;l.core_len=l.orig_core_len=0;l.t1both_len=l.t1in_len=l.t1out_len=0;l.t2both_len=l.t2in_len=l.t2out_len=0;l.added_node1=-1;l.core_1=Array(d);l.core_2=Array(e);l.in_1=Array(d);l.in_2=Array(e);l.out_1=Array(d);l.out_2=Array(e);l.share_count=[1];for(c=0;c<d;c++)l.core_1[c]=-1,l.in_1[c]=0,l.out_1[c]=0;for(c=0;c<e;c++)l.core_2[c]=-1,l.in_2[c]=0,l.out_2[c]=0;e=Array(d);d=Array(d);if(T(e,d,l)){for(c=0;c<e.length;c++)e[c]=
a.nodes[2*e[c]],d[c]=b.nodes[2*d[c]];return[e,d]}return null};y.get_node_id=function(a,b){for(var c=a.nodes,f=1;f<c.length;f+=2)if(c[f]==b)return c[f-1];return null};y.get_node_attr=E;y.out_edge_count=J;y.in_edge_count=M;y.get_out_edge=F;y.get_in_edge=U;y.get_edge_count=v;y.get_edge_attr=Y;y.replace=function(a,b,c){for(var f=a.edges,l=p(a),e=0;e<b.length;e++){var h=b[e];A(a,h);for(var k=0;k<f.length;k+=3)f[k]==h&&(f[k]=l),f[k+1]==h&&(f[k+1]=l),f[k]==f[k+1]&&(f.splice(k,3),k-=3)}d(a,l,c)};y.reconnect_edges=
function(a,b,c,f,d){K(a,b,c)||ha.panic("Edge not found");a=a.edges;for(var l=0;l<a.length;l+=3)a[l]==b&&a[l+1]==c&&(a[l]=f,a[l+1]=d)};y.enforce_acyclic=function(a,c){function f(a,b){if(-1!=k.indexOf(a)){var c=k.slice(k.indexOf(a));if(-1!=l[c[c.length-1]].indexOf(c[0])){m.push([a,c[c.length-1]]);return}}k.push(a);for(c=0;c<b.length;c++)b[c]in l&&f(b[c],l[b[c]])}c||(c=b(a)[0]);var d=a.edges;if(!d.length||-1==d.indexOf(c))return a;for(var l={},e=0,h=0;h<d.length;h+=3)d[h+1]in l?l[d[h+1]].push(d[h]):
l[d[h+1]]=[d[h]],e++;var k=[],m=[];f(c,l[c]);for(h=0;h<m.length;h++)for(var q=e=0;q<d.length;q+=3)m[h][1]==d[q+1]&&m[h][0]==d[q]&&r(a,d[q],d[q+1],e),e++;return a};y.debug_dot=function(a,b,c){var f=a.nodes;a=a.edges;var d;d="digraph debug {\n    node [shape=box];\n";for(var l=0;l<f.length;l+=2){var h=f[l],e=f[l+1],e=b?b(h,e):String(h);d+="    ";d+=String(h)+' [label="'+e.replace(/\"/g,'\\"')+'"];\n'}for(l=0;l<a.length;l+=3)b=a[l],f=a[l+1],e=a[l+2],d+="    ",d+=String(b)+" -> "+String(f),c&&(d+=' [label="'+
c(b,f,e)+'"]'),d+=";\n";return d+"}"}});t.a=e},function(C,t,e){var R;C=!1;try{R=window.b4w}catch(d){R=self.b4w,C=!0}if(!R){R={};C?self.b4w=R:window.b4w=R;var V={},n={};R.module=V;R._n_module=n;var y={};R.cleanup=function(d,e){var k=V[d];k&&(k._compiled=null);y[e||"__b4w_default"]=null};R.register=function(d,e){V[d]||(V[d]=e)};R.require=function(d,e){if(!V[d]&&!n[d])throw Error('Module "'+d+'" not found');e=e||"__b4w_default";if(void 0!==n[d])return n[d](e);y[e]||(y[e]=function(d){return function(e){if(!V[e]&&
!n[e])throw Error('Module "'+e+'" not found');if(void 0!==n[e])return n[e](d);e=V[e];e._compiled||(e._compiled={});e._compiled[d]||(e._compiled[d]={},e(e._compiled[d],y[d]));return e._compiled[d]}}(e));return y[e](d)};R.module_check=function(d){return void 0!==V[d]||void 0!==n[d]};R.get_namespace=function(d){for(var e in y)if(y[e]==d)return e;return""};R.worker_listeners=[];R.worker_namespaces=[]}t.a=R},function(C,t,e){C=e(0);var R=e(14),V=e(15),n=e(42),y=e(9),d=e(19),k=e(1),I=e(10),A=e(13),r=e(6),
p=e(2),u=e(3),a=e(7),B=e(8);e=Object(C.a)("camera",function(l,c){function e(a,b){if(!T.is_camera(a))return z.error("get_view_vector(): Wrong camera object"),null;b=b||new Float32Array(3);var c=r.g(a.render.world_tsr,U);p._34(c,p.c,b);return b}var b=Object(R.a)(l),f=Object(V.a)(l),T=Object(y.a)(l),fa=Object(d.a)(l),z=Object(k.a)(l),G=Object(I.a)(l),E=Object(A.a)(l),J=new Float32Array(2),M=new Float32Array(3),F=new Float32Array(3);new Float32Array(4);var U=B.create(),K={},t={};c.MS_STATIC=b.MS_STATIC;
c.MS_TARGET_CONTROLS=b.MS_TARGET_CONTROLS;c.MS_EYE_CONTROLS=b.MS_EYE_CONTROLS;c.MS_HOVER_CONTROLS=b.MS_HOVER_CONTROLS;c.static_setup=function(a,c){if(T.is_camera(a)){b.wipe_move_style(a);a.render.move_style=b.MS_STATIC;if(c){var f=c.pos||r.j(a.render.world_tsr,M);c.look_at?b.set_look_at(a,f,c.look_at):E.set_translation(a,f)}E.update_transform(a);fa.sync_transform(a);b.init_ortho_props(a)}else z.error("static_setup(): Wrong camera object")};c.static_set_look_at=function(a,c,f){b.is_static_camera(a)?
(c=c||r.j(a.render.world_tsr,M),f?b.set_look_at(a,c,f):E.set_translation(a,c),E.update_transform(a),fa.sync_transform(a)):z.error("static_set_look_at(): Wrong camera object or camera move style")};c.static_set_rotation=function(a,c){b.is_static_camera(a)?(E.set_rotation(a,c),E.update_transform(a),fa.sync_transform(a)):z.error("static_set_rotation(): Wrong camera object or camera move style")};c.static_get_rotation=function(a,c){if(!b.is_static_camera(a))return z.error("static_get_rotation(): Wrong camera object or camera move style"),
null;c=c||new Float32Array(4);return E.get_rotation(a,c)};c.eye_setup=function(a,c){if(T.is_camera(a))if(c&&c.horiz_rot_lim&&("number"!=typeof c.horiz_rot_lim.left||"number"!=typeof c.horiz_rot_lim.right))z.error("eye_setup(): Wrong horizontal limits object.");else if(c&&c.vert_rot_lim&&("number"!=typeof c.vert_rot_lim.down||"number"!=typeof c.vert_rot_lim.up))z.error("eye_setup(): Wrong vertical limits object.");else{b.wipe_move_style(a);a.render.move_style=b.MS_EYE_CONTROLS;if(c){var f=c.pos||r.j(a.render.world_tsr,
M);b.setup_eye_model(a,f,c.look_at,c.horiz_rot_lim,c.vert_rot_lim)}E.update_transform(a);fa.sync_transform(a);b.init_ortho_props(a)}else z.error("eye_setup(): Wrong camera object")};c.eye_set_look_at=function(a,c,f){b.is_eye_camera(a)?(c=c||r.j(a.render.world_tsr,M),f?b.set_look_at_corrected(a,c,f):E.set_translation(a,c),b.correct_up(a,a.render.vertical_axis,!0),E.update_transform(a),fa.sync_transform(a)):z.error("eye_set_look_at(): Wrong camera object or camera move style")};c.eye_rotate=function(a,
f,d,l){z.error_deprecated("eye_rotate","rotate_camera");b.is_eye_camera(a)?c.rotate_camera(a,f,d,l||!1):z.error("eye_rotate(): Wrong camera object or camera move style")};c.eye_set_vertical_limits=function(a,c){b.is_eye_camera(a)?!c||"number"==typeof c.down&&"number"==typeof c.up?(b.set_vertical_rot_limits(a,c),E.update_transform(a),fa.sync_transform(a)):z.error("eye_set_vertical_limits(): Incorrect limits object."):z.error("eye_set_vertical_limits(): Wrong camera object or camera move style")};c.eye_get_vertical_limits=
function(a,c,f){if(!b.is_eye_camera(a))return z.error("eye_get_vertical_limits(): Wrong camera object or camera move style"),null;a=a.render;return a.vertical_limits?(c=c||{},f?(c.down=a.vertical_limits.down_local,c.up=a.vertical_limits.up_local):(c.down=a.vertical_limits.down,c.up=a.vertical_limits.up),c.camera_space=f||!1,c):null};c.eye_set_horizontal_limits=function(a,c){b.is_eye_camera(a)?!c||"number"==typeof c.left&&"number"==typeof c.right?(b.set_horizontal_rot_limits(a,c),E.update_transform(a),
fa.sync_transform(a)):z.error("eye_set_horizontal_limits(): Incorrect limits object."):z.error("eye_set_horizontal_limits(): Wrong camera object or camera move style")};c.eye_get_horizontal_limits=function(a,c,f){if(!b.is_eye_camera(a))return z.error("eye_get_horizontal_limits(): Wrong camera object or camera move style"),null;a=a.render;return a.horizontal_limits?(c=c||{},f?(c.left=a.horizontal_limits.left_local,c.right=a.horizontal_limits.right_local):(c.left=a.horizontal_limits.left,c.right=a.horizontal_limits.right),
c.camera_space=f||!1,c):null};c.target_setup=function(a,c){if(T.is_camera(a))if(!c.horiz_rot_lim||"number"==typeof c.horiz_rot_lim.left&&"number"==typeof c.horiz_rot_lim.right)if(!c.vert_rot_lim||"number"==typeof c.vert_rot_lim.down&&"number"==typeof c.vert_rot_lim.up){if(c.dist_lim){if("number"!=typeof c.dist_lim.min||"number"!=typeof c.dist_lim.max||c.dist_lim.min>c.dist_lim.max){z.error("target_setup(): Wrong distance limits object");return}c.dist_lim.min=Math.max(c.dist_lim.min,0);c.dist_lim.max=
Math.max(c.dist_lim.max,0)}if(c.pivot_lim&&("number"!=typeof c.pivot_lim.min_y||"number"!=typeof c.pivot_lim.max_y||c.pivot_lim.min_y>c.pivot_lim.max_y))z.error("target_setup(): Wrong pivot limits object");else{b.wipe_move_style(a);a.render.move_style=b.MS_TARGET_CONTROLS;var f=c.pos||r.j(a.render.world_tsr,M),d=c.pivot;d||(d=e(a,F),d=u.add(f,d,d));b.setup_target_model(a,f,d,c.horiz_rot_lim,c.vert_rot_lim,c.dist_lim,c.pivot_lim,c.use_panning||!1);E.update_transform(a);fa.sync_transform(a);b.init_ortho_props(a)}}else z.error("target_setup(): Wrong vertical limits object");
else z.error("target_setup(): Wrong horizontal limits object");else z.error("target_setup(): Wrong camera object")};c.target_rotate=function(a,f,d,l){z.error_deprecated("target_rotate","rotate_camera");b.is_target_camera(a)?c.rotate_camera(a,f,d,l||!1):z.error("target_rotate(): Wrong camera object or camera move style")};c.target_set_trans_pivot=function(a,c,f){b.is_target_camera(a)?(c=c||r.j(a.render.world_tsr,M),f=f||a.render.pivot,b.set_trans_pivot(a,c,f),E.update_transform(a),fa.sync_transform(a)):
z.error("target_set_trans_pivot(): Wrong camera object or camera move style")};c.target_set_pivot_translation=function(a,c){b.is_target_camera(a)?(b.set_target_pivot(a,c),E.update_transform(a),fa.sync_transform(a)):z.error("target_set_pivot_translation(): Wrong camera object or camera move style")};c.target_set_distance=function(a,c){if(b.is_target_camera(a)){var f=E.obj_point_distance(a,a.render.pivot);E.move_local(a,0,0,Math.max(0,c)-f);E.update_transform(a);fa.sync_transform(a)}else z.error("target_set_distance(): Wrong camera object or camera move style")};
c.target_get_distance=function(a){return b.is_target_camera(a)?E.obj_point_distance(a,a.render.pivot):(z.error("target_get_distance(): Wrong camera object or camera move style"),0)};c.target_zoom_object=function(a,c){if(b.is_target_camera(a)){var f=E.get_object_center(c,!1,M),d=E.get_object_size(c),l=G.get_active(),l=T.get_scene_data(a,l).cameras[0],l=b.get_angular_diameter(l)/2,d=d/Math.sin(l),l=E.obj_point_distance(a,f);b.set_trans_pivot(a,r.j(a.render.world_tsr,F),f);E.update_transform(a);E.move_local(a,
0,0,d-l);E.update_transform(a);fa.sync_transform(a)}else z.error("target_zoom_object(): Wrong camera object or camera move style")};c.target_get_pivot=function(a,c){if(!b.is_target_camera(a))return z.error("target_get_pivot(): Wrong camera object or camera move style"),null;c=c||new Float32Array(3);u.copy(a.render.pivot,c);return c};c.target_set_distance_limits=function(a,c){if(b.is_target_camera(a)){if(c){if("number"!=typeof c.min||"number"!=typeof c.max||c.min>c.max){z.error("target_set_distance_limits(): Wrong limits object");
return}c.min=Math.max(c.min,0);c.max=Math.max(c.max,0)}b.set_distance_limits(a,c);E.update_transform(a);fa.sync_transform(a)}else z.error("target_set_distance_limits(): Wrong camera object or camera move style")};c.target_get_distance_limits=function(a,c){if(!b.is_target_camera(a))return z.error("target_get_distance_limits(): Wrong camera object or camera move style"),null;var f=a.render;return f.distance_limits?(c=c||{},c.min=f.distance_limits.min,c.max=f.distance_limits.max,c):null};c.target_set_vertical_limits=
function(a,c){b.is_target_camera(a)?!c||"number"==typeof c.down&&"number"==typeof c.up?(b.set_vertical_rot_limits(a,c),E.update_transform(a),fa.sync_transform(a)):z.error("target_set_vertical_limits(): Wrong limits object"):z.error("target_set_vertical_limits(): Wrong camera object or camera move style")};c.target_get_vertical_limits=function(a,c,f){if(!b.is_target_camera(a))return z.error("target_get_vertical_limits(): Wrong camera object or camera move style"),null;a=a.render;return a.vertical_limits?
(c=c||{},f?(c.down=a.vertical_limits.down_local,c.up=a.vertical_limits.up_local):(c.down=a.vertical_limits.down,c.up=a.vertical_limits.up),c.camera_space=f||!1,c):null};c.target_set_horizontal_limits=function(a,c){b.is_target_camera(a)?!c||"number"==typeof c.left&&"number"==typeof c.right?(b.set_horizontal_rot_limits(a,c),E.update_transform(a),fa.sync_transform(a)):z.error("target_set_horizontal_limits(): Wrong limits object"):z.error("target_set_horizontal_limits(): Wrong camera object or camera move style")};
c.target_get_horizontal_limits=function(a,c,f){if(!b.is_target_camera(a))return z.error("target_get_horizontal_limits(): Wrong camera object or camera move style"),null;a=a.render;return a.horizontal_limits?(c=c||{},f?(c.left=a.horizontal_limits.left_local,c.right=a.horizontal_limits.right_local):(c.left=a.horizontal_limits.left,c.right=a.horizontal_limits.right),c.camera_space=f||!1,c):null};c.target_set_pivot_limits=function(a,c){b.is_target_camera(a)?c&&("number"!=typeof c.min_z||"number"!=typeof c.max_z||
c.min_z>c.max_z)?z.error("target_set_pivot_limits(): Wrong limits object"):(b.set_pivot_limits(a,c),E.update_transform(a),fa.sync_transform(a)):z.error("target_set_pivot_limits(): Wrong camera object or camera move style")};c.target_get_pivot_limits=function(a,c){if(!b.is_target_camera(a))return z.error("target_get_pivot_limits(): Wrong camera object or camera move style"),null;var f=a.render;return f.pivot_limits?(c=c||{},c.min_z=f.pivot_limits.min_z,c.max_z=f.pivot_limits.max_z,c):null};c.target_pan_pivot=
function(a,c,f){if(b.is_target_camera(a)){var d=a.render;d.use_panning&&(M[0]=c,M[1]=-f,M[2]=0,r.y(M,d.world_tsr,M),u.add(d.pivot,M,d.pivot),c=r.j(d.world_tsr,F),u.add(c,M,c),r.v(c,d.world_tsr),E.update_transform(a),fa.sync_transform(a))}else z.error("target_pan_pivot(): wrong object")};c.target_switch_panning=function(a,c){if(!b.is_target_camera(a))return z.error("target_switch_panning(): Wrong camera object or camera move style"),null;a.render.use_panning=c};c.hover_setup_rel=function(a,f){c.hover_setup(a,
{pos:f.pos,pivot:f.pivot});var d="undefined"==typeof f.dist_interval?0:Math.max(f.dist_interval,0),l="undefined"==typeof f.angle_interval?0:Math.max(f.angle_interval,0),e="undefined"==typeof f.t?.5:p.M(f.t,0,1),k=c.hover_get_distance_limits(a,K);k.min=Math.max(k.min-e*d,0);k.max+=(1-e)*d;d=c.hover_get_vertical_limits(a,t);d.down=p.M(d.down+e*l,-Math.PI/2,0);d.up=p.M(d.up-(1-e)*l,-Math.PI/2,0);b.hover_set_distance_limits(a,k);b.hover_set_vertical_limits(a,d);E.update_transform(a);fa.sync_transform(a);
b.init_ortho_props(a)};c.hover_setup=function(a,c){if(T.is_camera(a)){if(c.dist_lim){if("number"!=typeof c.dist_lim.min||"number"!=typeof c.dist_lim.max||c.dist_lim.min>c.dist_lim.max){z.error("hover_setup(): Wrong distance limits object");return}c.dist_lim.min=Math.max(c.dist_lim.min,0);c.dist_lim.max=Math.max(c.dist_lim.max,0)}if(c.hover_angle_lim&&("number"!=typeof c.hover_angle_lim.down||"number"!=typeof c.hover_angle_lim.up||c.hover_angle_lim.down<c.hover_angle_lim.up))z.error("hover_setup(): Wrong hover angle limits object");
else if(c.horiz_trans_lim&&("number"!=typeof c.horiz_trans_lim.min||"number"!=typeof c.horiz_trans_lim.max||c.horiz_trans_lim.min>c.horiz_trans_lim.max))z.error("hover_setup(): Wrong horizontal translation limits object");else if(c.vert_trans_lim&&("number"!=typeof c.vert_trans_lim.min||"number"!=typeof c.vert_trans_lim.max||c.vert_trans_lim.min>c.vert_trans_lim.max))z.error("hover_setup(): Wrong vertical translation limits object");else{b.wipe_move_style(a);a.render.move_style=b.MS_HOVER_CONTROLS;
var f=c.pos||r.j(a.render.world_tsr,M);b.setup_hover_model(a,f,c.pivot,c.dist_lim,c.hover_angle_lim,c.horiz_trans_lim,c.vert_trans_lim,c.enable_horiz_rot||!1);E.update_transform(a);fa.sync_transform(a);b.init_ortho_props(a)}}else z.error("hover_setup(): Wrong camera object")};c.hover_rotate=function(a,f,d,l){z.error_deprecated("hover_rotate","rotate_camera");b.is_hover_camera(a)?c.rotate_camera(a,f,d,l||!1):z.error("hover_rotate(): Wrong camera object or camera move style")};c.hover_set_pivot_translation=
function(a,c){b.is_hover_camera(a)?(b.set_hover_pivot(a,c),E.update_transform(a),fa.sync_transform(a)):z.error("hover_set_pivot_translation(): Wrong camera object or camera move style")};c.hover_get_pivot=function(a,c){if(!b.is_hover_camera(a))return z.error("hover_get_pivot(): Wrong camera object or camera move style"),null;c=c||new Float32Array(3);u.copy(a.render.hover_pivot,c);return c};c.hover_get_distance=function(a){return b.is_hover_camera(a)?E.obj_point_distance(a,a.render.hover_pivot):(z.error("hover_get_distance(): Wrong camera object or camera move style"),
0)};c.hover_set_vertical_limits=function(a,c){b.is_hover_camera(a)?"number"!=typeof c.down||"number"!=typeof c.up||c.down<c.up?z.error("hover_set_vertical_limits(): Wrong limits object"):(b.hover_set_vertical_limits(a,c),E.update_transform(a),fa.sync_transform(a)):z.error("hover_set_vertical_limits(): Wrong camera object or camera move style")};c.hover_get_vertical_limits=function(a,c){if(!b.is_hover_camera(a))return z.error("hover_get_vertical_limits(): Wrong camera object or camera move style"),
null;var f=a.render;c=c||{};c.down=f.vertical_limits.down;c.up=f.vertical_limits.up;return c};c.hover_set_distance_limits=function(a,c){b.is_hover_camera(a)?"number"!=typeof c.min||"number"!=typeof c.max||c.min>c.max?z.error("hover_set_distance_limits(): Wrong limits object"):(c.min=Math.max(c.min,0),c.max=Math.max(c.max,0),b.hover_set_distance_limits(a,c),E.update_transform(a),fa.sync_transform(a)):z.error("hover_set_distance_limits(): Wrong camera object or camera move style")};c.hover_get_distance_limits=
function(a,c){if(!b.is_hover_camera(a))return z.error("hover_get_distance_limits(): Wrong camera object or camera move style"),null;var f=a.render;c=c||{};c.min=f.distance_limits.min;c.max=f.distance_limits.max;return c};c.hover_set_vert_trans_limits=function(a,c){b.is_hover_camera(a)?c&&("number"!=typeof c.min||"number"!=typeof c.max||c.min>c.max)?z.error("hover_set_vert_trans_limits(): Wrong limits object"):(b.set_vert_trans_limits(a,c),E.update_transform(a),fa.sync_transform(a)):z.error("hover_set_vert_trans_limits(): Wrong camera object or camera move style")};
c.hover_get_vert_trans_limits=function(a,c){if(!b.is_hover_camera(a))return z.error("hover_get_vert_trans_limits(): Wrong camera object or camera move style"),null;var f=a.render;return f.hover_vert_trans_limits?(c=c||{},c.min=f.hover_vert_trans_limits.min,c.max=f.hover_vert_trans_limits.max,c):null};c.hover_set_horiz_trans_limits=function(a,c){b.is_hover_camera(a)?c&&("number"!=typeof c.min||"number"!=typeof c.max||c.min>c.max)?z.error("hover_set_horiz_trans_limits(): Wrong limits object"):(b.set_hor_trans_limits(a,
c),E.update_transform(a),fa.sync_transform(a)):z.error("hover_set_horiz_trans_limits(): Wrong camera object or camera move style")};c.hover_get_horiz_trans_limits=function(a,c){if(!b.is_hover_camera(a))return z.error("hover_get_horiz_trans_limits(): Wrong camera object or camera move style"),null;var f=a.render;return f.hover_horiz_trans_limits?(c=c||{},c.min=f.hover_horiz_trans_limits.min,c.max=f.hover_horiz_trans_limits.max,c):null};c.hover_switch_horiz_rotation=function(a,c){if(!b.is_hover_camera(a))return z.error("hover_switch_horiz_rotation(): Wrong camera object or camera move style"),
null;a.render.enable_hover_hor_rotation=c};c.is_static_camera=b.is_static_camera;c.is_target_camera=b.is_target_camera;c.is_eye_camera=b.is_eye_camera;c.is_hover_camera=b.is_hover_camera;c.get_move_style=function(a){return T.is_camera(a)?b.get_move_style(a):(z.error("get_move_style(): Wrong camera object"),null)};c.set_translation=function(a,c){if(T.is_camera(a)){var f=a.render;if(b.is_target_camera(a)){var d=r.j(f.world_tsr,M),d=u.subtract(c,d,M);u.add(d,f.pivot,f.pivot)}else b.is_hover_camera(a)&&
(d=r.j(f.world_tsr,M),d=u.subtract(c,d,M),u.add(d,f.hover_pivot,f.hover_pivot));E.set_translation(a,c);E.update_transform(a);fa.sync_transform(a)}else z.error("set_translation(): Wrong camera object")};c.get_translation=function(a,b){if(!T.is_camera(a))return z.error("get_translation(): Wrong camera object"),null;b=b||new Float32Array(3);return E.get_translation(a,b)};c.rotate_camera=function(a,c,f,d){T.is_camera(a)?(d?b.set_rotation_angles(a,c,f):b.rotate_angles(a,c,f),E.update_transform(a),fa.sync_transform(a)):
z.error("rotate_camera(): Wrong camera object")};c.set_velocities=function(a,b){if(T.is_camera(a)){var c=a.render;"number"==typeof b.trans&&(c.velocity_trans=p.M(b.trans,0,Infinity));"number"==typeof b.rot&&(c.velocity_rot=p.M(b.rot,0,Infinity));"number"==typeof b.zoom&&(c.velocity_zoom=p.M(b.zoom,0,.99))}else z.error("set_velocities(): Wrong camera object")};c.get_velocities=function(a,b){if(!T.is_camera(a))return z.error("get_velocities(): Wrong camera object"),null;var c=a.render;b=b||{};b.trans=
c.velocity_trans;b.rot=c.velocity_rot;b.zoom=c.velocity_zoom;return b};c.is_look_up=function(a){if(!T.is_camera(a))return z.error("is_look_up(): Wrong camera object"),!1;a=r.g(a.render.world_tsr,U);return 0<=p._34(a,p.c,M)[1]};c.get_camera_angles=function(a,c){if(!T.is_camera(a))return z.error("get_camera_angles(): Wrong camera object"),null;c=c||new Float32Array(2);b.get_camera_angles(a,c);return c};c.get_camera_angles_char=function(a,c){if(!T.is_camera(a))return z.error("get_camera_angles_char(): Wrong camera object"),
null;c=c||new Float32Array(2);b.get_camera_angles_char(a,c);return c};c.get_camera_angles_dir=function(a,c){c=c||new Float32Array(2);var f=u.normalize(a,M),f=p._48(p.c,f,U);p.R(f,!0);b.get_camera_angles_from_quat(f,p.f,c);return c};c.set_stereo_distance=function(a,c){if(T.is_camera(a))for(var f=G.get_active(),f=T.get_scene_data(a,f).cameras,d=0;d<f.length;d++){var l=f[d];l.type!=b.TYPE_STEREO_LEFT&&l.type!=b.TYPE_STEREO_RIGHT&&l.type!=b.TYPE_HMD_LEFT&&l.type!=b.TYPE_HMD_RIGHT||b.set_stereo_params(l,
c,l.stereo_eye_dist)}else z.error("set_stereo_distance(): Wrong camera object")};c.get_stereo_distance=function(a){if(!T.is_camera(a))return z.error("get_stereo_distance(): Wrong camera object"),0;var c=G.get_active();a=T.get_scene_data(a,c).cameras;for(c=0;c<a.length;c++){var f=a[c];if(f.type==b.TYPE_STEREO_LEFT||f.type==b.TYPE_STEREO_RIGHT)return f.stereo_conv_dist}return 0};c.set_eye_distance=function(a,c){if(T.is_camera(a)){var f=G.get_active(),f=T.get_scene_data(a,f).cameras;b.set_eye_distance(f,
c)}else z.error("set_eye_distance(): Wrong camera object")};c.get_eye_distance=function(a){if(!T.is_camera(a))return z.error("get_eye_distance(): Wrong camera object"),0;var c=G.get_active();a=T.get_scene_data(a,c).cameras;for(c=0;c<a.length;c++){var f=a[c];if(f.type==b.TYPE_STEREO_LEFT||f.type==b.TYPE_STEREO_RIGHT||f.type==b.TYPE_HMD_LEFT||f.type==b.TYPE_HMD_RIGHT)return f.stereo_eye_dist}return 0};c.set_vertical_axis=function(a,b){T.is_camera(a)?(u.copy(b,a.render.vertical_axis),E.update_transform(a),
fa.sync_transform(a)):z.error("set_vertical_axis(): Wrong camera object")};c.get_vertical_axis=function(a,b){if(T.is_camera(a))return b||(b=u.create()),u.copy(a.render.vertical_axis,b),b;z.error("get_vertical_axis(): Wrong camera object")};c.translate_view=function(a,c,f,d){if(T.is_camera(a))for(d=G.get_active(),a=T.get_scene_data(a,d).cameras,d=0;d<a.length;d++){var l=a[d];u.set(-c,-f,0,l.view_transform_params.trans);l.reflection_plane?b.set_projection_reflect(l,!1):b.set_projection(l,!1)}else z.error("translate_view(): Wrong camera object")};
c.get_view_vector=e;c.get_fov=function(a){if(!T.is_camera(a))return z.error("get_fov(): Wrong camera object"),0;var c=G.get_active();a=T.get_scene_data(a,c).cameras;return b.get_fov(a[0])};c.set_fov=function(a,c){if(T.is_camera(a))for(var f=G.get_active(),f=T.get_scene_data(a,f).cameras,d=0;d<f.length;d++){var l=f[d];b.set_fov(l,c);l.reflection_plane?b.set_projection_reflect(l,!1):b.set_projection(l,!1)}else z.error("set_fov(): Wrong camera object")};c.set_hmd_fov=function(a,b,c){z.error_once("set_hmd_fov() deprecated")};
c.correct_up=function(a,c,f){T.is_camera(a)?(c=c||a.render.vertical_axis,b.correct_up(a,c,f||!1),E.update_transform(a),fa.sync_transform(a)):z.error("correct_up(): Wrong camera object")};c.set_ortho_scale=function(a,c){if(T.is_camera(a)&&b.is_ortho_camera(a)){var f=a.render;if(b.is_target_camera(a)){var d=r.j(f.world_tsr,M),d=u.dist(d,f.pivot);f.init_fov=c/2*f.init_dist/d}else b.is_hover_camera(a)?(d=r.j(f.world_tsr,M),d=u.distance(d,f.hover_pivot),f.init_fov=c/2*f.init_dist/d):(f=G.get_active(),
T.get_scene_data(a,f).cameras[0].fov=c/2);b.update_ortho_scale(a)}else z.error("set_ortho_scale(): Wrong camera object")};c.get_ortho_scale=function(a){if(!T.is_camera(a)||!b.is_ortho_camera(a))return z.error("get_ortho_scale(): Wrong camera object"),0;var c=G.get_active();return 2*T.get_scene_data(a,c).cameras[0].fov};c.is_ortho_camera=function(a){return T.is_camera(a)?b.is_ortho_camera(a):(z.error("is_ortho_camera(): Wrong camera object"),!1)};c.calc_ray=function(a,c,d,l){if(!T.is_camera(a))return z.error("calc_ray(): Wrong camera object"),
null;var e=G.get_active(),k=T.get_scene_data(a,e).cameras[0];l&&3==l.length?z.error_once('dest parameter in the function "calc_ray" should be type of parametric line.'):l=l||new Float32Array(6);switch(k.type){case b.TYPE_PERSP:case b.TYPE_PERSP_ASPECT:case b.TYPE_STEREO_LEFT:case b.TYPE_STEREO_RIGHT:var m=Math.tan(b.get_vfov(k)/2),v=m*k.aspect,e=M;c=f.canvas_to_viewport_coords(c,d,J,k);e[0]=(2*c[0]/k.width-1)*v;e[1]=(1-2*c[1]/k.height)*m;e[2]=-1;r.y(e,a.render.world_tsr,e);u.normalize(e,e);3==l.length?
u.copy(e,l):(a=E.get_translation(a,F),n.R(l,a),n.Q(l,e));return l;case b.TYPE_ORTHO:return e=M,c=f.canvas_to_viewport_coords(c,d,J,k),e[0]=(2*c[0]/k.width-1)*k.top*k.aspect,e[1]=(1-2*c[1]/k.height)*k.top,e[2]=0,r.D(e,a.render.world_tsr,e),u.copy(e,l),a=r.g(a.render.world_tsr,U),u.transformQuat(p.c,a,e),n.Q(l,e),l;default:return z.error("calc_ray(): Non-compatible camera"),l}};c.project_point=function(a,c,f){if(!T.is_camera(a))return z.error("project_point(): Wrong camera object"),null;f=f||new Float32Array(2);
return b.project_point(a,c,f)};c.has_distance_limits=function(a){return(b.is_target_camera(a)||b.is_hover_camera(a))&&null!==a.render.distance_limits};c.has_vertical_rot_limits=function(a){return(b.is_eye_camera(a)||b.is_target_camera(a)||b.is_hover_camera(a))&&null!==a.render.vertical_limits};c.has_horizontal_rot_limits=function(a){return(b.is_target_camera(a)||b.is_eye_camera(a))&&null!==a.render.horizontal_limits};c.has_vertical_trans_limits=function(a){return b.is_hover_camera(a)&&null!==a.render.hover_vert_trans_limits};
c.has_horizontal_trans_limits=function(a){return b.is_hover_camera(a)&&null!==a.render.hover_horiz_trans_limits};c.get_frustum_planes=function(b,c){if(!T.is_camera(b))return z.error("get_frustum_planes(): Wrong camera object"),null;var f=G.get_active(),f=T.get_scene_data(b,f).cameras[0].frustum_planes;a.copy(f.left,c.left);a.copy(f.right,c.right);a.copy(f.top,c.top);a.copy(f.bottom,c.bottom);a.copy(f.near,c.near);a.copy(f.far,c.far);return c};c.set_projection=function(a,c){T.is_camera(a)?b.set_proj_mat(a,
c):z.error("set_projection(): Wrong camera object")}});t.a=e},function(C,t,e){C=e(0);var R=e(32),V=e(5),n=e(44),y=e(4),d=e(37);e(92);var k=e(93),I=e(1),A=e(2),r=e(48),p={parser:{parse:function(){}}};"DEBUG"==d.d()&&(p=k);e=Object(C.a)("__shaders",function(e,a){function k(){return{vert:"",frag:"",directives:[],node_elements:[],status:0,attribute_count:0,texture_count:0}}function l(a){var b=k();b.vert=a.vert;b.frag=a.frag;b.directives=A.O(a.directives);b.node_elements=A.O(a.node_elements);b.status=
a.status;b.attribute_count=a.attribute_count;b.texture_count=a.texture_count;return b}function c(a,b,c){var h=a.directives;"string"==typeof c?(a=m(a,c))&&(c=a[1]):c=String(c);for(a=0;a<h.length;a++)if(h[a][0]==b){h[a][1]=c;break}}function m(a,b){for(var c=a.directives,h=0;h<c.length;h++)if(c[h][0]==b)return c[h];return!1}function b(a,b){var c=a+b;if(!(c in da)){var h=t(za.shaders_path,a),f=t(za.shaders_path,b),h=Y(h),f=Y(f),g;for(g in f)h[g]=f[g];f=[];for(g in h)f.push([g,h[g]]);da[c]=f}return da[c]}
function f(a,b,c){ia.gl_debug&&(c=u(c),h.error("shader compilation failed:\n"+c+"\n"+ga.getShaderInfoLog(a)+" ("+b+")"))}function u(a){a=a.split("\n");for(var b=0;b<a.length;b++)a[b]=b+1+" "+a[b];return a=a.join("\n")}function fa(a,b){return a+b}function z(a,b){return(a.split(";").map(function(a){return(a=a.match(b))&&(a[3]?parseInt(a[3],10):1)}).filter(function(a){return a})||[]).reduce(fa,0)}function G(a,b){var c=K(a.type),h=K(b.type),f=a.array_size,g=b.array_size;return c>h?-1:c<h?1:f>g?-1:f<g?
1:0}function E(a){if(ia.webgl2){a=a.replace(/(.*?)\([^()]*?\)(.*?)/g,"$1$2");var b=ba}else b=Ea;a=a.split(";").map(function(a){return(a=a.match(b))&&{type:a[2],array_size:a[4]?parseInt(a[4],10):1}}).filter(function(a){return a});return M(a,pa,ra.max_varying_vectors)}function J(a,b,c){a=a.split(";");for(var h=[],f=0;f<a.length;f++){var g=a[f].match(Ga);g&&h.push({type:g[2],array_size:g[4]?parseInt(g[4],10):1})}return M(h,b,c)}function M(a,b,c){function h(){for(var c=0;k<a.length;){var g=a[k];if(3!=
K(g.type))break;c+=U(g.type)*g.array_size;k++}l=e+c;if(l>Aa)return!1;F(b,e,c,0,3);return!0}function f(){for(var c=Aa-l,g=c,h=c;k<a.length;){var f=a[k];if(2!=K(f.type))break;f=U(f.type)*f.array_size;if(f<=g)g-=f;else if(f<=h)h-=f;else return!1;k++}h=c-h;F(b,l,c-g,0,2);F(b,Aa-h,h,2,2);return!0}function g(){for(;k<a.length;){for(var g=a[k],g=U(g.type)*g.array_size,h=-1,f=c+1,d=-1,l=0;4>l;l++){var e=X;e[0]=0;e[1]=1;var m;m=b;for(var q=l,D=g,w=e;Ma<m.length&&15===m[Ma];)Ma++;for(;0<Aa&&15===m[Aa];)Aa--;
if(Aa-Ma<D)m=!1;else{for(var q=1<<q,z=0,p=-1,r=m.length+1,n=!1,v=Ma;v<=Aa;v++)v<Aa&&!(m[v]&q)?n||(z=v,n=!0):(n&&(n=v-z,n>=D&&n<r&&(r=n,p=z)),n=!1);0>p?m=!1:(w[0]=p,w[1]=r,m=!0)}m&&e[1]<f&&(d=e[0],f=e[1],h=l)}if(0>h)return!1;F(b,d,g,h,1);k++}return!0}if(!a.length)return!0;for(var d=0;d<c;d++)b[d]=0;Aa=c;a.sort(G);var l=0,e=0,k=0;return function(){for(;k<a.length;){var c=a[k];if(4!=K(c.type))break;e+=U(c.type)*c.array_size;k++}if(e>Aa)return!1;Ma=e;F(b,0,e,0,4);return!0}()&&h()&&f()&&g()}function F(a,
b,c,h,f){for(var g=0,d=0;d<f;d++)g|=1<<h+d;for(d=0;d<c;d++)a[b+d]|=g}function U(a){switch(a){case "mat4":a=4;break;case "mat3":a=3;break;case "mat2":a=2;break;default:a=1}return a}function K(a){switch(a){case "mat4":case "vec4":case "ivec4":case "bvec4":case "mat2":a=4;break;case "mat3":case "vec3":case "ivec3":case "bvec3":a=3;break;case "vec2":case "ivec2":case "bvec2":a=2;break;default:a=1}return a}function t(a,b){var c=a+b;if(oa[c])return oa[c];if(Q){var h=Q[b];if(!h)return null;h=p.parser.parse(h)}else if(h=
R.a.require("shader_texts")[b],!h)return null;return oa[c]=h}function v(a,b){for(var c={},f=b.directives||[],d=0;d<f.length;d++)c[f[d][0]]=[f[d][1]];for(d=0;d<b.node_elements.length;d++)c["USE_NODE_"+b.node_elements[d].id]=["1"];ia.webgl2?(c.GLSL1=["0"],c.GLSL3=["1"],c.GLSL_VERSION=["300 es"],c.GLSL_IN=["in"],c.GLSL_OUT=["out"],c.GLSL_OUT_FRAG_COLOR=["glsl_out_frag_color"],c.GLSL_TEXTURE=["texture"],c.GLSL_TEXTURE_CUBE=["texture"],c.GLSL_TEXTURE_PROJ=["textureProj"],c.GLSL_TEXTURE_LOD=["textureLod"],
c.GLSL_TEXTURE_CUBE_LOD=["textureLod"]):(c.GLSL1=["1"],c.GLSL3=["0"],c.GLSL_VERSION=["100"],c.GLSL_IN="vert"==a?["attribute"]:["varying"],c.GLSL_OUT="vert"==a?["varying"]:[""],c.GLSL_OUT_FRAG_COLOR=["gl_FragColor"],c.GLSL_TEXTURE=["texture2D"],c.GLSL_TEXTURE_CUBE=["textureCube"],c.GLSL_TEXTURE_PROJ=["texture2DProj"],c.GLSL_TEXTURE_LOD=["textureLod"],ia.texture_lod_available?(c.GLSL_TEXTURE_LOD=["texture2DLodEXT"],c.GLSL_TEXTURE_CUBE_LOD=["textureCubeLodEXT"]):(c.GLSL_TEXTURE_LOD=["texture2D"],c.GLSL_TEXTURE_CUBE_LOD=
["textureCube"]));c.GLSL_SMPLR2D_SHDW=ia.compared_mode_depth&&!ia.rgba_fallback_shadows?["sampler2DShadow"]:["sampler2D"];for(var g in c)c[g][0].constructor!=String&&h.warn("Warning! The value of a directive '"+g+"' is not of type string.");return c}function Y(a){function b(a,c,h){if(a instanceof Array)for(var g=0;g<a.length;g++)b(a[g],c,h);else if(a instanceof Object&&a){c&&c(a);for(g in a)b(a[g],c,h);h&&h(a)}}var c={},h=function(a){"var"==a.TYPE?c[a.NAME]=a.TOKENS.join(""):"include"==a.TYPE&&(a=
t(za.shaders_path,za.shaders_include_dir+a.FILE),b(a,h))};b(a,h);return c}function ha(a,b,c){function f(b){b=b.PARTS;for(var c=0;c<b.length;c++){var m=b[c];switch(m.TYPE){case "cond":a:for(var m=m.PARTS,n=0;n<m.length;n++){var v=m[n];switch(v.TYPE){case "if":case "elif":if(d(v.EXPRESSION)){f(v.GROUP);break a}break;case "else":f(v.GROUP);break a;case "ifdef":v.NAME in z&&f(v.GROUP);break;case "ifndef":v.NAME in z||f(v.GROUP)}}break;case "include":m=m.FILE;n=t(za.shaders_path,za.shaders_include_dir+
m);r.push("include/"+m);f(n);r.pop();break;case "var":break;case "define":z[m.NAME]=m.TOKENS;break;case "error":ea.panic("Shader error: #error "+m.TOKENS.join(" "));break;case "line":break;case "pragma":D.push("#pragma "+m.NAME+" "+m.TOKENS.join(" "));break;case "undef":delete z[m.NAME];break;case "warning":h.warn("Shader warning: #warning "+m.TOKENS.join(" "));break;case "extension":m=k(m.TOKENS,z,p,!1);D.push("#extension "+m.join(" "));break;case "version":m=k(m.TOKENS,z,p,!1),D.push("#version "+
m.join(" "));case "#":break;case "node":u[m.NAME]=m;break;case "nodes_global":m=q;for(n=0;n<m.length;n++){var v=m[n],G=u[v.id];if(G)for(var H=0,B=0;B<G.DECLARATIONS.length;B++){var S=G.DECLARATIONS[B];if("node_param"==S.TYPE){var L;L=v;if("PARTICLE_INFO"==L.id&&S.IS_OPTIONAL)if(1==z.PARTICLE_BATCH){var y=!1;switch(H){case 0:y=w(L.dirs,"PART_INFO_IND")||w(L.dirs,"PART_INFO_AGE")||w(L.dirs,"PART_INFO_LT")||w(L.dirs,"PART_INFO_SIZE");break;case 1:y=w(L.dirs,"PART_INFO_LOC");break;case 2:y=w(L.dirs,"PART_INFO_VEL");
break;case 3:y=w(L.dirs,"PART_INFO_A_VEL");break;case 4:y=w(L.dirs,"PART_INFO_IND")}L=y}else L=!1;else L=!0;L&&(S=S.QUALIFIER.join(" ")+" ","vert"==a?S+=v.vparams[H]:"frag"==a&&(S+=v.params[H],null!==v.param_values[H]&&(S+="="+v.param_values[H])),S+=";",e(l(S)));H++}}}break;case "nodes_main":m=q;for(n=0;n<m.length;n++)if(v=m[n],G=u[v.id]){H={};T=O=A=0;B=G;S=v;L=B;for(var y={},F=0;F<L.NODE_VARS.length;F++){var J=L.NODE_VARS[F];y[J.NAME]=[J.TOKENS.join("")]}L=y;for(y=0;y<S.dirs.length;y++)F=S.dirs[y][0],
F in L&&(L[F]=[S.dirs[y][1]]);for(y=F=0;y<B.DECLARATIONS.length;y++)if(J=B.DECLARATIONS[y],"node_out"==J.TYPE){var ia=-1<E.indexOf(S.outputs[F])|0;L["USE_OUT_"+J.NAME]=[ia];F++}B=L;S=v;L=G.DECLARATIONS;y=H;F=B;for(J=0;J<L.length;J++)switch(ia=L[J],ia.TYPE){case "node_in":var ma=S.inputs[A];if(null!==S.input_values[A]){if(("MATERIAL_BEGIN"==S.id&&3===A||!F.MATERIAL_EXT&&("MATERIAL_BEGIN"==S.id&&4===A||"MATERIAL_END"==S.id&&3===A||"MATERIAL_END"==S.id&&4===A||"MATERIAL_END"==S.id&&5===A)||"TEXTURE_COLOR"==
S.id||"TEXTURE_NORMAL"==S.id)&&ia.IS_OPTIONAL){y[ia.NAME]=S.input_values[A];A++;continue}var M=ia.QUALIFIER.join(" ")+" ",M=M+(ma+"="+S.input_values[A]+";");e(l(M))}y[ia.NAME]=ma;A++;break;case "node_out":ma=S.outputs[O];if(!ia.IS_OPTIONAL||-1<E.indexOf(ma))M=ia.QUALIFIER.join(" ")+" ",M+=ma+";",e(l(M)),y[ia.NAME]=ma;O++;break;case "node_param":"vert"==a?ma=S.vparams[T]:"frag"==a&&(ma=S.params[T]),y[ia.NAME]=ma,T++}D.push("{");g(v,G.STATEMENTS,H,B);D.push("}")}break;case "txt":e(m.TOKENS);break;default:ea.panic("Unknown element type: "+
m.TYPE)}}}function d(a,b){var c;c=k(a,z,p,!0,b);for(var g=[],f=0;f<c.length;f++)if(c[f]instanceof Object)switch(c[f].TYPE){case "conditional_expr":var d=g.pop(),l=g.pop();g.pop()?g.push(l):g.push(d);break;case "logical_or_expr":for(var l=g.pop(),e=0;e<c[f].PLACES-1;e++)d=g.pop(),l=l||d;g.push(l);break;case "logical_and_expr":l=g.pop();for(e=0;e<c[f].PLACES-1;e++)d=g.pop(),l=l&&d;g.push(l);break;case "logical_bitor_expr":l=g.pop();for(e=0;e<c[f].PLACES-1;e++)l|=g.pop();g.push(l);break;case "logical_bitxor_expr":l=
g.pop();for(e=0;e<c[f].PLACES-1;e++)l^=g.pop();g.push(l);break;case "logical_bitand_expr":l=g.pop();for(e=0;e<c[f].PLACES-1;e++)l&=g.pop();g.push(l);break;case "equal_expr":d=g.pop();l=g.pop();g.push(l==d);break;case "non_equal_expr":d=g.pop();l=g.pop();g.push(l!=d);break;case "le_expr":d=g.pop();l=g.pop();g.push(l<=d);break;case "ge_expr":d=g.pop();l=g.pop();g.push(l>=d);break;case "l_expr":d=g.pop();l=g.pop();g.push(l<d);break;case "g_expr":d=g.pop();l=g.pop();g.push(l>d);break;case "left_shift_expr":l=
g.pop();d=g.pop();g.push(l<<d);break;case "right_shift_expr":l=g.pop();d=g.pop();g.push(l>>d);break;case "add_expr":l=g.pop();d=g.pop();g.push(l+d);break;case "sub_expr":l=g.pop();d=g.pop();g.push(l-d);break;case "mul_expr":l=g.pop();d=g.pop();g.push(l*d);break;case "div_expr":l=g.pop();d=g.pop();g.push(l/d);break;case "mod_expr":l=g.pop();d=g.pop();g.push(l%d);break;case "pre_inc_expr":case "post_inc_expr":d=g.pop();g.push(++d);break;case "pre_dec_expr":case "post_dec_expr":d=g.pop();g.push(--d);
break;case "positive_expr":d=g.pop();g.push(+d);break;case "negative_expr":d=g.pop();g.push(-d);break;case "one_compl_expr":d=g.pop();g.push(~d);break;case "logic_negative_expr":d=g.pop();g.push(!d);break;default:ea.panic("Unknown operation type: "+c[f].TYPE)}else d=c[f],/^[a-zA-Z_$][a-zA-Z_$0-9]*$/.test(d)?(g.push(0),0!=d.indexOf("USE_NODE_")&&(l=r[r.length-1],l in n||(n[l]=[]),-1==n[l].indexOf(d)&&(n[l].push(d),h.error("Undefined directive '"+d+"' in shader '"+l+"'. Should it be defined with #var/#node_var or #define?")))):
g.push(parseFloat(c[f]));1==g.length?c=g[0]:(ea.panic("Incorrect expression: "+c.join(" ")),c=void 0);return c}function g(a,b,c,h){for(var f=0;f<b.length;f++){var l=b[f];switch(l.TYPE){case "node_cond":a:for(var k=a,l=l.PARTS,m=c,q=h,D=0;D<l.length;D++){var w=l[D];switch(w.TYPE){case "node_if":case "node_elif":if(d(w.EXPRESSION,q)){g(k,w.STATEMENTS,m,q);break a}break;case "node_else":g(k,w.STATEMENTS,m,q);break a;case "node_ifdef":(w.NAME in z||w.NAME in q)&&g(k,w.STATEMENTS,m,q);break;case "node_ifndef":w.NAME in
z||w.NAME in q||g(k,w.STATEMENTS,m,q)}}break;case "txt":k=[];for(m=0;m<l.TOKENS.length;m++)q=l.TOKENS[m],q in c?k.push(c[q]):k.push(q);e(k,h)}}}function l(a){return a.match(/([\d]+\.[\d]+|[\w]+|[^\s])/g)}function e(b,c){var g=b;ia.webgl2||"frag"!=a||(g=g.join(" "),B&&(g.match(/[^;]*;/)?(g=g.replace(/[^;]*;/,""),B=!1):g=""),g=g.replace(/GLSL_OUT [^;]*;/g,""),g.match(/GLSL_OUT(?:$| [^;]*)/)&&(g=g.replace(/GLSL_OUT(?:$| [^;]*)/,""),B=!0),g=g.replace(/ {2,}/g," "),g=(g=g.trim())?g.split(" "):[]);b=g;
b.length&&(g=k(b,z,p,!1,c),D.push(g.join(" ")))}function k(a,b,c,g,h){var f=[];m(a,b,c,g,f,h);return f}function m(a,b,c,g,h,f){for(var d=0;d<a.length;d++){var l=a[d];if(f&&l in f)l=f[l];else if(l in b)l=b[l];else{h.push(l);continue}0==l.length&&g?h.push(0):m(l,b,c,g,h,f)}}var q=c.node_elements,D=[],z=v(a,c),p={},r=[c[a]],n={},u={},E=[],G;for(G in q)for(var H in q[G].inputs)E.push(q[G].inputs[H]);var B=!1;f(b);var A=0,O=0,T=0;return D.join("\n")}function S(a){ga.deleteProgram(a.program);ga.deleteShader(a.vshader);
ga.deleteShader(a.fshader);delete P[a.shader_id]}function L(a,b){!b&&a.length?b=a.length:b||(b=1);switch(b){case 1:return q(a);case 2:return"vec2("+q(a[0])+","+q(a[1])+")";case 3:return"vec3("+q(a[0])+","+q(a[1])+","+q(a[2])+")";case 4:return"vec4("+q(a[0])+","+q(a[1])+","+q(a[2])+","+q(a[3])+")";case 9:return"mat3("+q(a[0])+","+q(a[1])+","+q(a[2])+","+q(a[3])+","+q(a[4])+","+q(a[5])+","+q(a[6])+","+q(a[7])+","+q(a[8])+")";case 16:return"mat4("+q(a[0])+","+q(a[1])+","+q(a[2])+","+q(a[3])+","+q(a[4])+
","+q(a[5])+","+q(a[6])+","+q(a[7])+","+q(a[8])+","+q(a[9])+","+q(a[10])+","+q(a[11])+","+q(a[12])+","+q(a[13])+","+q(a[14])+","+q(a[15])+")";default:ea.panic("Wrong glsl value dimension")}}function q(a){return a%1?String(a):String(a)+".0"}function w(a,b){for(var c=0;c<a.length;c++)if(a[c][0]==b)return!0;return!1}var ea=Object(V.a)(e),H=Object(n.a)(e),D=Object(y.a)(e),h=Object(I.a)(e),ia=D.defaults,ra=D.context_limits,za=D.paths,P={},oa={},Q=null,da={},ja="anchors.glslf anchors.glslv color_id.glslf color_id.glslv shadow.glslf shadow.glslv error.glslf error.glslv grass_map.glslf grass_map.glslv halo.glslf halo.glslv irradiance_skybox.glslf line.glslf line.glslv main.glslf main.glslv main_stack.glslf particle_system.glslf particle_system_stack.glslf particle_system.glslv proc_skybox.glslf r_convolution_skybox.glslf skybox.glslv lens_flares.glslf lens_flares.glslv sky.glslf sky.glslv water.glslf water.glslv tex_skybox.glslf debug_view.glslf debug_view.glslv node_skybox.glslf postprocessing/antialiasing.glslf postprocessing/bloom_combine.glslf postprocessing/coc.glslf postprocessing/compositing.glslf postprocessing/depth_pack.glslf postprocessing/dof.glslf postprocessing/glow.glslf postprocessing/god_rays.glslf postprocessing/god_rays.glslv postprocessing/god_rays_combine.glslf postprocessing/luminance.glslf postprocessing/luminance_av.glslf postprocessing/luminance_truncated.glslf postprocessing/motion_blur.glslf postprocessing/outline.glslf postprocessing/performance.glslf postprocessing/postprocessing.glslf postprocessing/postprocessing.glslv postprocessing/smaa.glslf postprocessing/smaa.glslv postprocessing/ssao.glslf postprocessing/ssao_blur.glslf postprocessing/stereo.glslf postprocessing/precompute_brdf.glslf include/blending.glslf include/caustics.glslf include/color_util.glslf include/coverage.glslf include/depth_fetch.glslf include/dynamic_grass.glslv include/environment.glslf include/fog.glslf include/fxaa.glslf include/halo_color.glslf include/lighting_nodes.glslf include/math.glslv include/mirror.glslf include/nodes.glslf include/nodes.glslv include/pack.glslf include/particles.glslv include/particles_nodes.glslf include/particles_nodes.glslv include/precision_statement.glslf include/procedural.glslf include/refraction.glslf include/scale_texcoord.glslv include/shadow.glslf include/shadow.glslv include/skin.glslv include/sky_blending.glslf include/std.glsl include/to_world.glslv include/wind_bending.glslv".split(" ");
a.VALID=0;a.INVALID_TEX_IMAGE_UNITS=1;a.INVALID_F_UNIFORM_VECTORS=2;a.INVALID_V_UNIFORM_VECTORS=4;a.INVALID_VERTEX_ATTRIBS=8;a.INVALID_VARYING_VECTORS=16;a.COMPILATION_ERROR=32;var va=/(?:^|[^a-zA-Z_])uniform.*?(sampler2D|samplerCube)(?=\s)(.*?\[\s*([0-9]*)\s*\])?/,Ga=/(?:^|[^a-zA-Z_])(uniform)(?=\s)\s*(float|vec2|vec3|vec4|ivec2|ivec3|ivec4|bvec2|bvec3|bvec4|mat2|mat3|mat4|sampler2D|samplerCube)\s*(.*?\[\s*([0-9]*)\s*\])?/,ba=/(?:^|[^a-zA-Z_])(in)(?=\s)\s*(float|vec2|vec3|vec4|mat2|mat3|mat4)\s*(.*?\[\s*([0-9]*)\s*\])?/,
Ea=/(?:^|[^a-zA-Z_])(varying)(?=\s)\s*(float|vec2|vec3|vec4|mat2|mat3|mat4)\s*(.*?\[\s*([0-9]*)\s*\])?/,ta=/(?:\W|^)discard(\W|$)/,X=new Int16Array(2),pa=null,ka=null,C=null,Ma=0,Aa=0,xa=[],ga=null,ya=!1;a.setup_context=function(a){ga=a};a.init_shaders_info=k;a.clone_shaders_info=l;a.set_directive=c;a.get_directive=m;a.set_default_directives=function(a){a.directives=A.O(b(a.vert,a.frag));c(a,"PRECISION",D.defaults.precision);"highp"==D.defaults.precision?c(a,"EPSILON",L(1E-6)):c(a,"EPSILON",L(1E-4));
c(a,"CONSTANTS_HACK",ia.shader_constants_hack|0);c(a,"SRGB",ia.srgb_type);c(a,"COMPARED_MODE",ia.compared_mode_depth|0)};a.get_vname=function(a){return a.vert};a.get_fname=function(a){return a.frag};a.get_compiled_shader=function(a){var b=JSON.stringify(a.vert)+JSON.stringify(a.frag)+JSON.stringify(a.directives)+JSON.stringify(a.node_elements),c=P[b];if(c)return c;var d=a.frag,e=t(za.shaders_path,a.vert),d=t(za.shaders_path,d);if(!e||!d)return null;var e=ha("vert",e,a),d=ha("frag",d,a),c=0,g=z(d,
va);a.texture_count=g;g>ra.max_texture_image_units&&(c|=1);pa||(pa=new Uint32Array(ra.max_varying_vectors));ka||(ka=new Uint32Array(ra.max_fragment_uniform_vectors));C||(C=new Uint32Array(ra.max_vertex_uniform_vectors));J(d,ka,ra.max_fragment_uniform_vectors)||(c|=2);J(e,C,ra.max_vertex_uniform_vectors)||(c|=4);g=ia.webgl2?(e.replace(/(.*?)\([^()]*?\)(.*?)/g,"$1$2").match(/(?:^|[^a-zA-Z_])in(?=\s)/g)||[]).length:(e.match(/(?:^|[^a-zA-Z_])attribute(?=\s)/g)||[]).length;a.attribute_count=g;g>ra.max_vertex_attribs&&
(c|=8);E(d)||(c|=16);a.status=c;if(0===a.status){var c=ga,k=c.createShader(c.VERTEX_SHADER);c.shaderSource(k,e);c.compileShader(k);var m=c.createShader(c.FRAGMENT_SHADER);c.shaderSource(m,d);c.compileShader(m);g=c.createProgram();c.attachShader(g,k);c.attachShader(g,m);c.linkProgram(g);for(var k={vshader:k,fshader:m,program:g,attributes:{},uniforms:{},permanent_uniform_setters:A.S(),permanent_sc_uniform_setters:A.S(),permanent_uniform_setters_table:{},need_uniforms_update:!0,no_permanent_uniforms:!1,
transient_uniform_setters:A.S(),transient_sc_uniform_setters:A.S(),shaders_info:l(a),shader_id:b,has_discard:!!d.match(ta),cleanup_gl_data_on_unload:!0},q=c.getProgramParameter(g,c.ACTIVE_ATTRIBUTES),m=0;m<q;m++){var D=c.getActiveAttrib(g,m).name,w=c.getAttribLocation(g,D);k.attributes[D]=w}q=c.getProgramParameter(g,c.ACTIVE_UNIFORMS);for(m=0;m<q;m++)D=c.getActiveUniform(g,m).name.split("[0]").join(""),w=c.getUniformLocation(g,D),k.uniforms[D]=w;P[b]=c=k;g=!ga.getShaderParameter(c.fshader,ga.COMPILE_STATUS);
k=!ga.getShaderParameter(c.vshader,ga.COMPILE_STATUS);m=!ga.getProgramParameter(c.program,ga.LINK_STATUS);g?f(c.fshader,b,d):k?f(c.vshader,b,e):m&&(q=c.program,ia.gl_debug&&(e=u(e),d=u(d),h.error("shader linking failed:\n"+e+"\n\n\n"+d+"\n"+ga.getProgramInfoLog(q)+" ("+b+")")));if(g||k||m)a.status|=32,c=null}else c=null;return c};a.load_shaders=function(){ya=!1;if("DEBUG"==d.d()){for(var a=[],b=H.AT_TEXT,c=0;c<ja.length;c++){var f=Object(r.b)(za.shaders_path+ja[c]);a.push({id:ja[c],type:b,url:f})}b=
function(a,b,c,h){Q||(Q={});Q[b]=a};a.length?H.enqueue(a,b,function(){ya=!0}):h.error("Shaders have not been found.")}else ya=!0};a.check_shaders_loaded=function(){return ya};a.debug_get_compilation_stats=function(){return xa};a.get_compiled_shaders=function(){return P};a.cleanup=function(){for(var a in P)S(P[a]);for(var b in oa)delete oa[b];for(var c in xa)delete xa[c];C=ka=pa=null;da={}};a.cleanup_shader=S;a.debug_shaders_info=function(a){var b=a.directives;h.log("Shader: "+a.vert+" "+a.frag+", "+
String(b.length)+" directives: ");for(a=0;a<b.length;a++)h.log("  "+b[a][0],b[a][1])};a.glsl_value=L;a.check_uniform=function(a,b){return b in a.uniforms?!0:!1};a.reset=function(){ga=null}});t.a=e},function(C,t,e){C=e(0);var R=e(4),V=e(45),n=e(28),y=e(1),d=e(22);e=Object(C.a)("__compat",function(e,t){function k(a){return-1<navigator.userAgent.indexOf(a)?!0:!1}function r(){return navigator.userAgent.match(/Windows Phone/i)||navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||
navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)}function p(){return!window.ActiveXObject&&"ActiveXObject"in window}var u=Object(R.a)(e),a=Object(V.a)(e),B=Object(n.a)(e),l=Object(y.a)(e),c=Object(d.a)(e),m="R600;RV610;RV630;RV620;RV635;RV670;RS780;RS880;RV770;RV730;RV710;RV740;CEDAR;REDWOOD;JUNIPER;CYPRESS;PALM (Wrestler/Ontario);SUMO (Llano);SUMO2 (Llano);ARUBA (Trinity/Richland);BARTS;TURKS;CAICOS;CAYMAN".split(";");
t.NVIDIA_OLD_GPU_CUBEMAP_MAX_SIZE=256;var b=u.animation,f=u.defaults,T=u.debug_subs,fa=u.context,z=u.context_limits,G=u.sfx,E=u.physics,J=u.assets;t.detect_tegra_invalid_enum_issue=function(a){a.getError()==a.INVALID_ENUM&&l.warn("Possible Tegra invalid enum issue detected, ignoring")};t.set_hardware_defaults=function(d,e){var n=function(a){e&&l.warn(a)};z.max_combined_texture_image_units=d.getParameter(d.MAX_COMBINED_TEXTURE_IMAGE_UNITS);z.max_fragment_uniform_vectors=d.getParameter(d.MAX_FRAGMENT_UNIFORM_VECTORS);
z.max_texture_image_units=d.getParameter(d.MAX_TEXTURE_IMAGE_UNITS);z.max_varying_vectors=d.getParameter(d.MAX_VARYING_VECTORS);z.max_vertex_attribs=d.getParameter(d.MAX_VERTEX_ATTRIBS);z.max_vertex_texture_image_units=d.getParameter(d.MAX_VERTEX_TEXTURE_IMAGE_UNITS);z.max_vertex_uniform_vectors=d.getParameter(d.MAX_VERTEX_UNIFORM_VECTORS);z.max_cube_map_texture_size=d.getParameter(d.MAX_CUBE_MAP_TEXTURE_SIZE);z.max_renderbuffer_size=d.getParameter(d.MAX_RENDERBUFFER_SIZE);z.max_texture_size=d.getParameter(d.MAX_TEXTURE_SIZE);
z.max_viewport_dims=d.getParameter(d.MAX_VIEWPORT_DIMS);var A=B.get_renderer_info();if(A){var y=d.getParameter(A.UNMASKED_VENDOR_WEBGL),v=d.getParameter(A.UNMASKED_RENDERER_WEBGL);-1<y.indexOf("Qualcomm")&&-1<v.indexOf("330")&&(k("Chrome")||k("Firefox"))&&(n("Chrome/Firefox and Qualcomm 330 detected, force enable WebGL 1, disable blending cascaded shadow maps."),f.webgl2=!1,f.chrome_csm_blend_hack=!0)}z.depth_bits=f.webgl2?24:16;f.webgl2&&!T.enabled&&(f.compared_mode_depth=!0);f.webgl2?(f.msaa_samples=
Math.min(f.msaa_samples,d.getParameter(d.MAX_SAMPLES)),k("Firefox")&&(n("Firefox and WebGL 2 detected, applying framebuffer hack."),f.check_framebuffer_hack=!0),k("Windows")&&k("Chrome")&&(n("Windows, Chrome and WebGL 2 detected, applying multisample hack, disabling MSAA."),f.msaa_samples=1)):f.msaa_samples=1;k("Firefox")&&"NONE"!==f.stereo&&(n("Firefox and Stereo rendering detected, disable texture reusage"),f.firefox_tex_reuse_hack=!0);if(f.webgl2&&a.multisample_issue()||k("Firefox"))n("Firefox detected, disabling multisample"),
f.msaa_samples=1;k("Mac OS X")&&k("Chrome/60")&&(n("macOS and Chrome 60 detected, disabling multisample"),f.msaa_samples=1);c.set_draw_methods();var F=!!B.get_depth_texture();k("Firefox/28.0")&&(k("Linux")||k("Macintosh"))&&(n("Firefox 28 detected, applying depth hack"),F=!1);k("Windows Phone")||(k("iPad")||k("iPhone")?(n("iOS detected, applying alpha hack, applying vertex animation mix normals hack, disable smaa. Disable ssao for performance. Initialize WebAudio context with empty sound. Applying glow hack."),
fa.alpha||(f.background_color[3]=1),f.ios_copy_tex_hack=!0,f.vert_anim_mix_normals_hack=!0,f.smaa=!1,f.ssao=!1,f.init_wa_context_hack=!0,B.get_pvr()&&J.pvr_available&&(f.compress_format="pvr")):k("Mac OS X")&&k("Safari")&&!k("Chrome")&&(n("OS X / Safari detected, force to wait complete loading. Applying playback rate hack for video textures. Applying canvas alpha hack."),f.safari_canvas_alpha_hack=!0,G.audio_loading_hack=!0,G.clamp_playback_rate_hack=!0));k("Windows")&&(k("Chrome/40")||k("Firefox/33")||
k("Firefox/34")||k("Firefox/35")||k("Firefox/36"))&&(n("Windows/Chrome40 or Firefox33-36 detected. Applying clear procedural skydome hack."),f.clear_procedural_sky_hack=!0);k("Chrome")&&!r()&&u.is_built_in_data()&&(n('Chrome (non-mobile) was detected for a single HTML-exported file. "Background Music" speakers were changed to "Background Sound".'),f.chrome_html_bkg_music_hack=!0);k("Mac OS X")&&(f.mac_os_shadow_hack=!0,n("OS X detected, applying shadows hack"));r()&&(n("Mobile detected, applying various hacks for video textures."),
f.is_mobile_device=!0,k("iPad")||k("iPhone")||k("Windows Phone")||(n("Mobile (not iOS) detected, disable playback rate for video textures."),G.disable_playback_rate_hack=!0));k("iPad")&&(n('iPad detected, use "autoplay" hack for video textures.'),f.ipad_video_hack=!0);(k("Firefox/35.0")||k("Firefox/36.0"))&&k("Windows")&&(n("Windows/Firefox 35/36 detected, applying shadows slink hack"),f.shadows_color_slink_hack=!0);if(k("iPhone")||p())n("iPhone or IE11 detected. Enable sequential video fallback for video textures."),
f.seq_video_fallback=!0;10>z.max_varying_vectors&&(n("Not enough varyings, disable shadows on blend objects"),f.disable_blend_shadows_hack=!0);k("Windows Phone")&&(n("Windows Phone detected. Disable debug view mode, glow materials, ssao, smaa, shadows, reflections, refractions."),f.debug_view=!1,f.glow_materials=!1,f.ssao=!1,f.smaa=!1,f.shadows=!1,f.reflections=!1,f.refractions=!1,f.quality_aa_method=!1);if(k("UCBrowser")||k("Chrome")&&k("Nexus")&&f.is_mobile_device)n("Mobile Nexus Chrome or UCBrowser detected, disable workers."),
E.use_workers=!1;k("Firefox")&&(n("Firefox detected, disabling workers"),E.use_workers=!1);if(p()||k("Edge"))n("IE11 or Edge detected, disabling workers"),E.use_workers=!1;k("Chrome")&&k("Linux")&&(n("Chrome and Linux detected, disabling wasm physics."),E.use_wasm=!1);if(A){y=d.getParameter(A.UNMASKED_VENDOR_WEBGL);v=d.getParameter(A.UNMASKED_RENDERER_WEBGL);A=/\b4\d{2}\b/;y.indexOf("Intel")&&(-1<v.indexOf("3000")||-1<v.indexOf("2000"))&&(f.reuse_depth_optimization=!1,n("Intel HD Graphics 2000/3000 detected, disable depth reuse."));
k("Chrome")&&-1<v.indexOf("Mali-T720")&&(n('Chrome and ARM Mali-T720 detected, changing "Alpha Anti-Aliasing" materials to "Alpha Clip".'),f.mali_alpha_antialias_hack=!0);-1<v.indexOf("AMD")&&k("Windows")&&k("Firefox")&&(n("AMD, Windows and Firefox detected, disabling depth textures."),F=!1);-1<y.indexOf("ARM")&&A.test(v)&&(n("ARM Mali-400 series detected, applying lamps, depth and frames blending hacks"),F=!1,b.frames_blending_hack=!0,f.mali4_lamps_hack=!0);-1<y.indexOf("ARM")&&-1<v.indexOf("Mali-T604")&&
(n("ARM Mali-T604 detected, disabling shadows."),f.shadows=!1);-1<y.indexOf("ARM")&&-1<v.indexOf("Mali-T760")&&(n("ARM Mali-T760 detected, disabling SSAO."),f.ssao=!1,f.skinning_hack=!0,f.webgl2&&(f.msaa_samples=1,n("ARM Mali-T760 and WebGL 2 detected, switching MSAA samples to 1.")));-1<y.indexOf("ARM")&&-1<v.indexOf("Mali-T720")&&(n("ARM Mali-T720 detected, disabling depth textures."),F=!1,f.webgl2&&(f.msaa_samples=1,n("ARM Mali-T720 and WebGL 2 detected, switching MSAA samples to 1.")));-1<y.indexOf("Qualcomm")&&
-1<v.indexOf("Adreno")&&(n("Qualcomm Adreno detected, applying shader constants hack."),f.shader_constants_hack=!0,-1<v.indexOf("420")&&(n("Qualcomm Adreno420 detected, setting max cubemap size to 12288x8192, setting max texture size to 4096x4096."),z.max_texture_size=Math.min(z.max_texture_size,4096),z.max_cube_map_texture_size=Math.min(z.max_cube_map_texture_size,4096)),k("Chrome")&&(v.match(/4../)||v.match(/5../))&&(n("Qualcomm Adreno 4xx or 5xx detected, switch MSAA samples to 1."),f.msaa_samples=
1));-1<y.indexOf("NVIDIA")&&-1<v.indexOf("Tegra 3")&&(n("NVIDIA Tegra 3 detected, force low quality for B4W_LEVELS_OF_QUALITY nodes."),f.force_low_quality_nodes=!0);k("Windows")&&k("Chrome")&&!k("Edge")&&(v.match(/NVIDIA GeForce 8..0/)||v.match(/NVIDIA GeForce 9..0/)||v.match(/NVIDIA GeForce( (G|GT|GTS|GTX))? 2../))&&(n("Chrome / Windows / NVIDIA GeForce 8/9/200 series detected, setting max cubemap size to 768x512, use canvas for resizing."),z.max_cube_map_texture_size=t.NVIDIA_OLD_GPU_CUBEMAP_MAX_SIZE,
f.resize_cubemap_canvas_hack=!0);-1<v.indexOf("PowerVR")&&-1<v.indexOf("SGX")&&(n("PowerVR SGX series detected, use canvas for resizing. Disable shadows. Apply skinning hack, disable skin blending between frames."),f.resize_cubemap_canvas_hack=!0,f.skinning_hack=!0,f.shadows=!1);k("Windows")&&-1<v.indexOf("Direct3D9")&&(n("DirectX 9.0 detected, using canvas for resizing textures/cubemap textures."),f.d3d9_canvas_resizing_hack=!0,f.resize_cubemap_canvas_hack=!0,f.resize_texture_canvas_hack=!0);y="";
for(A=0;A<m.length;A++)if(-1<v.indexOf(m[A])){y=m[A];break}y&&(n("Architecture "+y+" detected. Blending between frames and shadows on blend objects will be disabled."),f.skinning_hack=!0,f.disable_blend_shadows_hack=!0)}0==z.max_vertex_texture_image_units&&(n("Vertex textures are not allowed. Disabling vertex textures"),f.allow_vertex_textures=!1);F||(f.foam=!1,f.dynamic_grass=!1,f.water_dynamic=!1,f.shore_smoothing=!1,f.shore_distance=!1,f.smaa=!1,f.ssao=!1,f.rgba_fallback_shadows=!0);f.use_compression=
!!B.get_s3tc()||"pvr"==f.compress_format;f.depth_tex_available=F;if(d.getShaderPrecisionFormat)var M=d.getShaderPrecisionFormat(d.FRAGMENT_SHADER,d.HIGH_FLOAT);d.getShaderPrecisionFormat&&0!==M.precision||(f.precision="mediump");if(p()&&k("Touch")||k("Edge"))n("IE11 and touchscreen or Edge detected. Behaviour of the mouse move sensor will be changed."),f.ie11_edge_touchscreen_hack=!0;if(p()||k("Edge"))f.ie_edge_anchors_floor_hack=!0,f.ie11_edge_mouseoffset_hack=!0,f.resize_cubemap_canvas_hack=!0;
r()&&k("Firefox")&&(l.log("Mobile firefox detected. Applying autoplay media hack.Setting max cubemap size to 12288x8192, setting max texture size to 4096x4096."),f.mobile_firefox_media_hack=!0,z.max_texture_size=Math.min(z.max_texture_size,4096),z.max_cube_map_texture_size=Math.min(z.max_cube_map_texture_size,4096));n=!!B.get_aniso();f.anisotropic_available=n;n=!!B.get_texture_lod();f.texture_lod_available=n;n=!!B.get_texture_float();f.tex_float_available=n;n=!!B.get_texture_half_float();f.tex_hfloat_available=
n;n=!!B.get_texture_float_linear();f.tex_float_lin_available=n;n=!!B.get_texture_half_float_linear();f.tex_hfloat_lin_available=n;n=!!B.get_color_buffer_float();f.cbuffer_float_available=n;n=!!B.get_color_buffer_half_float();f.cbuffer_hfloat_available=n};t.check_user_agent=k;t.detect_mobile=r;t.apply_context_alpha_hack=function(){k("Firefox/35.0")&&k("Windows")&&(l.warn("Windows/Firefox 35 detected, forcing context's alpha"),u.context.alpha=!0)};t.is_ie11=p});t.a=e},function(C,t,e){function R(b,c,
f){b=A(b,c||0,f);a.normalize(b,f);return f}function V(b,f,d){d=d||0;var l=A(b,d,J),e=a.length(l),k=c._50(l[3])*c._50(f[3])||1;a.scale(f,k*e,l);Math.abs(l[3])<m&&(l[3]=0<l[3]?m:-m);r(b,l,d);return b}function n(a,b){return c._50(a[4*(b||0)+3])}function y(b,f,d){d=d||0;var l=A(b,d,J);0>c._50(l[3])*f&&a.scale(l,-1,l);r(b,l,d);return b}function d(b,c,f){f=f||0;var d=A(b,f,J);a.normalize(d,d);a.scale(d,c,d);Math.abs(d[3])<m&&(d[3]=0<d[3]?d[3]+m:d[3]-m);r(b,d,f);return b}function k(b,c){var f=A(b,c||0,J);
return a.length(f)}function I(a){a=0!==a?a||1:0;for(var b=new Float32Array(4*a),c=0;c<a;c++)b[4*c+3]=f;return b}function A(a,b,c){c[0]=a[4*b];c[1]=a[4*b+1];c[2]=a[4*b+2];c[3]=a[4*b+3];return c}function r(a,b,c){a[4*c]=b[0];a[4*c+1]=b[1];a[4*c+2]=b[2];a[4*c+3]=b[3];return a}function p(a){return a.length/4}function u(b,c,f){for(var l=p(b),e=0;e<l;e++){var m=n(b,e),z=k(b,e),r=R(b,e,fa),r=a.multiply(c,r,fa);V(f,r,e);d(f,z,e);y(f,m,e)}}e.d(t,"a",function(){return b});t.d=function(e,k,p){var n=!(!k||!k.length),
r=e.length/3;p=p||I(r);for(var u=0;u<r;++u){var B=z;B[0]=e[3*u];B[1]=e[3*u+1];B[2]=e[3*u+2];l.normalize(B,B);if(n){var A=M;A[0]=k[b*u];A[1]=k[b*u+1];A[2]=k[b*u+2];A[3]=k[b*u+3];l.normalize(A,A);var L=l.cross(A,B,G);l.normalize(L,L);var q=a.rotationTo(c.f,L,T),w=l.transformQuat(c.e,q,E),w=a.rotationTo(w,B,fa),q=a.multiply(w,q,T);a.normalize(q,q);w=f;L=l.cross(B,L,E);if(Math.abs(L[0]-A[0])>m||Math.abs(L[1]-A[1])>m||Math.abs(L[2]-A[2])>m)w=Math.acos(l.dot(B,A))/Math.PI;V(p,q,u);y(p,c._50(A[3]),u);d(p,
w,u)}else q=a.rotationTo(c.e,B,T),V(p,q,u)}return p};t.b=function(a,b,c,f){if(0!==c){b=4*b||0;c=c||a.length;for(var d=0,l=0;d<4*c;d+=4,l+=4)f[l]=a[b+d],f[l+1]=a[b+d+1],f[l+2]=a[b+d+2],f[l+3]=a[b+d+3]}};t.h=R;t.o=V;t.g=function(a,b,f){a=R(a,b,T);return l.transformQuat(c.e,a,f)};t.c=I;t.i=function(a){for(var b=0;b<a.length;b+=4)a[b]=0,a[b+1]=0,a[b+2]=0,a[b+3]=f;return a};t.e=A;t.n=r;t.f=p;t.j=u;t.m=function(a,b,c){b=B.g(b,T);return u(a,b,c)};t.p=function(b,c,f,l){var e=n(c,0),m=R(b,0,T),z=R(c,0,fa);
b=k(b);c=k(c);m=a.slerp(m,z,f,fa);a.normalize(m,m);V(l,m,0);d(l,f*(b-c)+c);y(l,e,0);return l};t.k=function(b,c,l){var e=n(c,0),m=R(b,0,T),z=R(c,0,fa);b=k(b,0);c=k(c,0);m=a.multiply(m,z,T);V(l,m,0);d(l,b+c-f);y(l,e,0);return l};t.l=function(b,c,l){var e=n(c,0),m=R(b,0,T),z=R(c,0,fa);b=k(b);c=k(c);z=a.invert(z,fa);m=a.multiply(m,z,T);V(l,m,0);d(l,b-c+f);y(l,e,0);return l};var a=e(8),B=e(6),l=e(3);C=e(7);var c=e(2),m=3.1E-5,b=4,f=.5,T=a.create(),fa=a.create(),z=l.create(),G=l.create(),E=l.create(),J=
C.create(),M=C.create()},function(C,t,e){function R(){if("DEBUG"==y){var d=V();return[parseInt(String(d.getFullYear()).slice(-2),10),d.getMonth()+1]}return k}function V(){return"DEBUG"==y?new Date:d}function n(){var d=V(),e=d.getDate(),e=10>e?"0"+String(e):String(e),k=d.getMonth()+1,k=10>k?"0"+String(k):String(k),n=String(d.getFullYear()),a=d.getHours(),a=10>a?"0"+String(a):String(a),B=d.getMinutes(),B=10>B?"0"+String(B):String(B),d=d.getSeconds(),d=10>d?"0"+String(d):String(d);return e+"."+k+"."+
n+" "+a+":"+B+":"+d}t.e=R;t.f=function(){for(var d="",e=R(),k=0;k<e.length;k++)d=1==k?d+(10>e[k]?"0"+e[k]:e[k]):d+e[k],k!=e.length-1&&(d+=".");return d};t.d=function(){return y};t.a=V;t.b=n;t.c=function(){if("DEBUG"!=y)return I;var d=n();return d=d.split(" ").join("").split(":").join("").split(".").join("")};var y="RELEASE",d=new Date(2018,3,24,11,45,9),k=[17,12,0],I="_b4w_ver_17_12_0_"},function(C,t,e){C=e(0);var R=e(56),V=e(5),n=e(4),y=e(57),d=e(9),k=e(47),I=e(19),A=e(1),r=e(8),p=e(10),u=e(23),
a=e(11),B=e(18),l=e(13),c=e(6),m=e(2),b=e(3);e(7);e=Object(C.a)("__animation",function(f,e){function T(a,b){var c=a.anim_slots[b];c&&c.finish_callback&&c.exec_finish_callback&&(c.exec_finish_callback=!1,c.finish_callback(a,b))}function z(a,b,c){c=a.anim_slots[c];c.type=30;var g=b.frame_start,h=b.frame_end-g+1;c.start=g;c.length=h;c.current_frame_float=g;c.animation_name=b.name;for(h=g=0;h<a.vertex_anim.length;h++){var f=a.vertex_anim[h];if(f==b)break;else g+=f.frame_end-f.frame_start+1}c.va_frame_offset=
g}function G(a,b,c){b.type=50;b.animation_name=c.name;b.start=c.frame_start;b.length=c.frame_end-b.start;c.cyclic||(b.length+=c.lifetime_frames)}function E(a,b){var c={type:null,animation_name:null,action_frame_range:null,action_step:0,action_bflags:null,channels_mask:new Int8Array(8),quats:null,scale:null,trans:null,bone_space_quats:null,bone_space_trans:null,skinning_data:[],play:!1,behavior:20,current_frame_float:0,start:0,length:0,trans_smooth_period:0,quat_smooth_period:0,exec_finish_callback:!1,
va_frame_offset:null,speed:1,volume:null,pitch:null,color:null,energy:null,zenith_color:null,horizon_color:null,fog_intensity:null,fog_depth:null,fog_start:null,fog_height:null,fog_color:null,nodemat_values:[],node_value_inds:[],nodemat_rgbs:[],node_rgb_inds:[],node_batches:null};if(!a.anim_slots.length)for(var g=0;8>g;g++)a.anim_slots.push(null);a.anim_slots[b]=c}function J(a){return a.replace(/_B4W_BAKED$/,"")}function M(a,b){return{name_list:a,action:b}}function F(a,b,c){if(a.animation_data){var g=
a.animation_data.action;g&&60==g._render.type&&b.push(M(c,g))}a=a.nodes;for(g=0;g<a.length;g++){var h=a[g];if(h.node_group){var f=h.node_group.node_tree;if(f){var d=c.slice();d.push(h.name);F(f,b,d)}}}}function t(a){return xa.is_mesh(a)&&a.render.vertex_anim?!0:!1}function K(a,b,c){var g=a.anim_slots;if(-1==c)for(c=0;8>c;c++){var h=g[c];h&&(h.current_frame_float=b,v(a,0,c,!0))}else if(h=g[c])h.current_frame_float=b,v(a,0,c,!0)}function sa(a,b,c){if(-1==b)for(b=0;8>b;b++){var g=a[b];g&&c(g)}else(g=
a[b])&&c(g)}function v(a,b,c,g){ea(a,b,c,g);T(a,c);a.render.anim_mixing&&(ra(a,b),D(a,b))}function Y(a,b,c,g){var h=c.frame_range;if(h[0]>h[1])return O.warn('Incompatible action "'+c.name+'" has been applied to object "'+a.name+'"'),!1;var f=c._render,d=a.anim_slots[g];d.animation_name=c.name;d.action_frame_range=h;d.action_step=f.pierce_step;d.action_bflags=f.bflags;d.channels_mask.set(f.channels_mask);d.start=h[0];d.length=h[1]-h[0];d.current_frame_float=h[0];switch(f.type){case 10:if(xa.is_armature(a)){d.type=
10;var l=ha(a,b,c);l||(l=za(c,a.render.bone_pointers),S(a,b,c,l));d.trans=l.trans;d.quats=l.quats;d.bone_space_quats=l.bone_space_quats;d.bone_space_trans=l.bone_space_trans;L(a,g,c,l)}break;case 40:xa.is_speaker(a)&&(d.volume=f.params.volume||null,d.pitch=f.params.pitch||null,d.type=40);break;case 70:xa.is_lamp(a)&&(d.color=f.params.color||null,d.energy=f.params.energy||null,d.type=70);break;case 60:if("MESH"==a.type||"WORLD"==a.type){d.type=60;var h=xa.is_world(a),e=[],k=[],m=[],q=[],D=[];c=c._render;
var z=b?b[0]:null;for(l in c.params){var p;p=b;var n=l.match(/"(.*?)"/)[1];if(p&&1<p.length){for(var r=p[1],v=2;v<p.length;v++)r=r+"%join%"+p[v];r+="%join%"+n}else r=n;p=r;for(n=0;n<a.scenes_data.length;n++)for(r=a.scenes_data[n].batches,v=0;v<r.length;v++){var u=r[v];if(h||!z||-1!=u.material_names.indexOf(z)){var E=u.node_rgb_inds,G;G=l;var H=p,B=c,A=k,y=e,J=u.node_value_inds;if(J){for(var ia=!1,T=0;T<J.length;T+=3)H==J[T]&&(y.push(4*J[T+1]+J[T+2]),A.push(new Float32Array(B.params[G])),ia=!0);G=
ia}else G=!1;H=l;B=p;A=c;y=q;J=m;if(E){ia=!1;for(T=0;T<E.length;T+=2)B==E[T]&&(J.push(E[T+1]),y.push(new Float32Array(A.params[H])),ia=!0);E=ia}else E=!1;(G||E)&&D.push(u)}}}d.node_value_inds=e;d.nodemat_values=k;d.node_rgb_inds=m;d.nodemat_rgbs=q;d.node_batches=D}break;case 20:if(l=f.params.tsr)d.type=20,h=ha(a,b,c),h||(h=rb(a,c,l),S(a,b,c,h)),d.trans=h.trans,d.scale=h.scale,d.quats=h.quats,ga.obj_has_particles(a)&&ga.update_start_pos(a,d.trans[0],d.scale[0],d.quats[0]);else return O.warn('Incompatible action "'+
c.name+'" has been applied to object "'+a.name+'"'),!1;break;case 80:xa.is_world(a)&&(d.energy=f.params["light_settings.environment_energy"]||null,d.horizon_color=f.params.horizon_color||null,d.zenith_color=f.params.zenith_color||null,d.fog_intensity=f.params["mist_settings.intensity"]||null,d.fog_depth=f.params["mist_settings.depth"]||null,d.fog_start=f.params["mist_settings.start"]||null,d.fog_height=f.params["mist_settings.height"]||null,d.fog_color=f.params.b4w_fog_color||null,d.type=80)}xa.is_armature(a)&&
10!=f.type&&w(a,g);return!0}function ha(a,b,c){a=a.action_anim_cache;b=b?b.join("%join%"):null;for(var g=0;g<a.length;g+=3)if(c==a[g]&&b==a[g+1])return a[g+2];return null}function S(a,b,c,g){a=a.action_anim_cache;b=b?b.join("%join%"):null;a.push(c,b,g)}function L(a,b,c,g){var h=a.render,f=h.skinned_renders,d=a.anim_slots[b],l=d.skinning_data,e;a:{e=h.skinning_data_cache;for(var k=0;k<e.length;k+=2)if(c==e[k]){e=e[k+1];break a}e=null}if(e)d.skinning_data=e;else{for(d=0;d<f.length;d++){e=f[d].bone_skinning_info;
for(var k=[],m=[],D=g.trans,w=g.quats,z=0;z<D.length;z++){var p=oa(D[z],w[z],e);k.push(p.trans);m.push(p.quats)}l.push({trans:k,quats:m})}h.skinning_data_cache.push(c,l)}h.anim_mixing&&(c=h.blend_skel_slots,b>c[1]?(g=c[1],c[1]=b,c[0]=g):b>c[0]&&b<c[1]&&(c[0]=b),q(a))}function q(a){var b=a.render.blend_skel_slots;if(-1!=b[0]&&-1!=b[1]){var c=a.anim_slots;a=c[b[1]].current_frame_float;var g=Math.floor(a),h=a-g,b=c[b[0]];a=b.current_frame_float;g=Math.floor(a);b.current_frame_float=g+h}}function w(a,
b){var c=a.render.blend_skel_slots,g=c[1];c[0]=-1;c[1]=-1;if(-1!=b)for(var h=a.anim_slots;0<=g;g--){var f=h[g];if(f&&10==f.type)if(g>c[1])c[1]=g;else{g>c[0]&&(c[1]=g);break}}}function ea(a,h,f,d){if((f=a.anim_slots[f])&&null!=f.type&&(f.play||d)){var l=a.render,e=f.current_frame_float,k=f.start,q=f.length,e=e+f.speed*h*Ja.get_framerate(),D=f.type,w=f.speed;if(0<=w&&e>=k+q||0>w&&e<k)switch(d||(f.exec_finish_callback=!0),f.behavior){case 10:e=0<=w?(e-k)%q+k:k+q-1E-6;break;case 20:e=0<=w?k:k+q-1E-6;
f.play=!1;break;case 30:e=0<=w?k+q-1E-6:k,f.play=!1}f.current_frame_float=e;switch(D){case 10:if(!l.anim_mixing){d=H(f);h=d[0];var z=d[1];d=d[2];l.quats_before=f.quats[h];l.quats_after=f.quats[z];l.trans_before=f.trans[h];l.trans_after=f.trans[z];l.frame_factor=d;d=l.skinned_renders;f=f.skinning_data;for(var p=0;p<d.length;p++){var n=d[p],v=f[p];n.quats_before=v.quats[h];n.quats_after=v.quats[z];n.trans_before=v.trans[h];n.trans_after=v.trans[z];n.frame_factor=l.frame_factor}g.update_transform(a)}break;
case 20:d=H(f);var l=ma,z=d[0],p=d[1],n=d[2],v=f.trans,u=v[z][1],e=v[z][2],k=v[p][1],q=v[p][2];l[0]=(1-n)*v[z][0]+n*v[p][0];l[1]=(1-n)*u+n*k;l[2]=(1-n)*e+n*q;z=Ka;p=d[0];n=d[1];v=d[2];u=f.scale;e=u[p][1];k=u[p][2];q=u[n][1];D=u[n][2];z[0]=(1-v)*u[p][0]+v*u[n][0];z[1]=(1-v)*e+v*q;z[2]=(1-v)*k+v*D;p=Ia;v=d[0];n=d[1];d=d[2];u=f.quats;e=Ua;e[0]=u[v][0];e[1]=u[v][1];e[2]=u[v][2];e[3]=u[v][3];v=Na;v[0]=u[n][0];v[1]=u[n][1];v[2]=u[n][2];v[3]=u[n][3];r.slerp(e,v,d,p);a.parent&&a.pinverse_tsr&&(d=Z,c.t(l,
z,p,d),c.q(a.pinverse_tsr,d,d),c.j(d,l),c.i(d,z),c.g(d,p));f.trans_smooth_period&&(d=g.get_translation(a,fb),m._54(l,d,h,f.trans_smooth_period,l));f.quat_smooth_period&&(d=Ua,g.get_rotation(a,d),m._52(p,d,h,f.quat_smooth_period,p));e=f.channels_mask;e[0]&&g.set_translation_rel(a,l);e[1]&&g.set_rotation_rel(a,p);e[2]&&g.set_scale_rel(a,z);g.update_transform(a);ya.sync_transform(a);break;case 30:d=f.current_frame_float-f.start;0>d&&(d=0);d>=f.length&&(d=f.length);a=Math.floor(d);h=a+1;d-=a;10!=f.behavior&&
h==f.length&&(h=--a,d=1);f=f.va_frame_offset;Ta[0]=a+f;Ta[1]=h+f;Ta[2]=d;d=Ta;l.va_frame=d[0];l.va_frame_factor=d[2];break;case 40:d=H(f);h=d[0];l=d[1];d=d[2];f.volume&&qa.set_volume(a,(1-d)*f.volume[h]+d*f.volume[l]);f.pitch&&qa.playrate(a,(1-d)*f.pitch[h]+d*f.pitch[l]);break;case 50:h=10==f.behavior?(e-k)/Ja.get_framerate():e/Ja.get_framerate();ga.set_time(a,f.animation_name,h);break;case 60:d=H(f);h=d[0];l=d[1];d=d[2];u=f.nodemat_values;e=f.node_value_inds;z=f.nodemat_rgbs;p=f.node_rgb_inds;n=
f.node_batches;for(f=0;f<e.length;f++)for(k=u[f],v=e[f],q=(1-d)*k[h]+d*k[l],k=0;k<n.length;k++)n[k].node_values[v]=q;for(f=0;f<p.length;f++)for(e=z[f],v=p[f],u=e.subarray(3*h,3*h+3),e=e.subarray(3*l,3*l+3),u=b.lerp(u,e,d,ma),k=0;k<n.length;k++)n[k].node_rgbs[3*v]=u[0],n[k].node_rgbs[3*v+1]=u[1],n[k].node_rgbs[3*v+2]=u[2];xa.is_world(a)&&wa.update_sky_texture(a);break;case 70:d=H(f);h=d[0];l=d[1];d=d[2];e=f.channels_mask;(q=f.energy)&&e[0]&&y.d(a.light,(1-d)*q[h]+d*q[l]);(f=f.color)&&e[1]&&(ma[0]=
(1-d)*f[3*h]+d*f[3*l],ma[1]=(1-d)*f[3*h+1]+d*f[3*l+1],ma[2]=(1-d)*f[3*h+2]+d*f[3*l+2],y.b(a.light,ma));k=a.scenes_data;for(f=0;f<k.length;f++)wa.update_lamp_scene_color_intensity(a,k[f].scene);break;case 80:d=H(f);h=d[0];l=d[1];d=d[2];e=f.channels_mask;k=a.scenes_data;w=wa.get_subs(k[0].scene,na.MAIN_OPAQUE);q=f.energy;q=e[0]?(1-d)*q[h]+d*q[l]:w.energy;D=f.horizon_color;e[1]?(ma[0]=(1-d)*D[3*h]+d*D[3*l],ma[1]=(1-d)*D[3*h+1]+d*D[3*l+1],ma[2]=(1-d)*D[3*h+2]+d*D[3*l+2],D=ma):D=w.horizon_color;var E=
f.zenith_color;e[2]?(Ka[0]=(1-d)*E[3*h]+d*E[3*l],Ka[1]=(1-d)*E[3*h+1]+d*E[3*l+1],Ka[2]=(1-d)*E[3*h+2]+d*E[3*l+2],w=Ka):w=w.zenith_color;E=f.fog_intensity;e[3]&&(z=(1-d)*E[h]+d*E[l]);E=f.fog_depth;e[4]&&(p=(1-d)*E[h]+d*E[l]);E=f.fog_start;e[5]&&(n=(1-d)*E[h]+d*E[l]);E=f.fog_height;e[6]&&(v=(1-d)*E[h]+d*E[l]);f=f.fog_color;e[7]&&(Ia[0]=(1-d)*f[3*h]+d*f[3*l],Ia[1]=(1-d)*f[3*h+1]+d*f[3*l+1],Ia[2]=(1-d)*f[3*h+2]+d*f[3*l+2],u=Ia);for(f=0;f<k.length;f++)h=a.scenes_data[f].scene,(e[0]||e[1]||e[2])&&wa.set_environment_colors(h,
q,D,w),e[3]&&wa.set_fog_intensity(h,z),e[4]&&wa.set_fog_depth(h,p),e[5]&&wa.set_fog_start(h,n),e[6]&&wa.set_fog_height(h,v),e[7]&&wa.set_fog_color_density(h,u);break;default:Ma.panic("Unknown animation type:"+D)}}}function H(a){var b=a.action_frame_range[0],c=a.action_frame_range[1]-b,b=a.current_frame_float-b;0>b&&(b=0);b>=c&&(b=c);b/=a.action_step;c=Math.floor(b);a=a.action_bflags[c]?b-c:0;b=Math.ceil(c+a);Ta[0]=c;Ta[1]=b;Ta[2]=a;return Ta}function D(a,b){var c=a.render,f=c.anim_mix_factor,d=c.blend_skel_slots,
l=d[0],d=d[1];if(-1!=d){if(-1!=l){var e=a.anim_slots[l];if(e.play||0==b||c.mix_with_current){var k=H(e),m=k[0],q=k[1];c.frame_factor=k[2];var k=e.quats[m],D=e.quats[q],w=e.trans[m],z=e.trans[q]}else f=1}else f=1;d=a.anim_slots[d];if(d.play||0==b||c.mix_with_current){var l=H(d),p=l[0],n=l[1];c.frame_factor=l[2]}else if(-1!=l&&e.play)f=0;else return;var l=d.quats[p],r=d.quats[n],v=d.trans[p],u=d.trans[n];if(1!=f||c.mix_with_current)if(0!=f||c.mix_with_current){f=c.bone_pointers;if(c.mix_with_current&&
!c.trans_curr&&!c.quats_curr){c.trans_curr=new Float32Array(c.trans_before.length);c.quats_curr=new Float32Array(c.quats_before.length);for(var E in f)k=f[E],k.parent_bone_ptr||ia(c,k)}for(E in f)k=f[E],k.parent_bone_ptr||h(c,k,e,d,m,q,p,n)}else c.quats_before.set(k),c.quats_after.set(D),c.trans_before.set(w),c.trans_after.set(z);else c.quats_before.set(l),c.quats_after.set(r),c.trans_before.set(v),c.trans_after.set(u);g.update_transform(a);R.f(a)}}function h(a,b,g,f,d,l,e,k){var q=b.parent_bone_ptr,
D=a.anim_mix_factor,w=Ia,z=Ua,p=La,n=Xa,v=Na,u=Va,E=Wa,G=W,H=4*b.bone_index,B=f.bone_space_quats[e],A=f.bone_space_trans[e],y=f.bone_space_quats[k],L=f.bone_space_trans[k];if(!a.mix_with_current)var S=g.bone_space_quats[d],J=g.bone_space_trans[d],T=g.bone_space_quats[l],ia=g.bone_space_trans[l];for(var O=0;4>O;O++)z[O]=B[H+O],n[O]=A[H+O],u[O]=y[H+O],G[O]=L[H+O],a.mix_with_current?(w[O]=a.quats_curr[H+O],p[O]=a.trans_curr[H+O],v[O]=a.quats_curr[H+O],E[O]=a.trans_curr[H+O]):(w[O]=S[H+O],p[O]=J[H+O],
v[O]=T[H+O],E[O]=ia[H+O]);r.slerp(w,z,D,w);m.G(p,n,D,p);c.w(p,Z);c.r(w,Z);q&&c.q(q.tsr_local_pose_b,Z,Z);c.a(Z,b.tsr_local_pose_b);c.q(Z,b.tsr_local_rest_i,Z);c.l(Z,p);c.g(Z,w);r.slerp(v,u,D,v);m.G(E,G,D,E);c.w(E,Z);c.r(v,Z);q&&c.q(q.tsr_local_pose_a,Z,Z);c.a(Z,b.tsr_local_pose_a);c.q(Z,b.tsr_local_rest_i,Z);c.l(Z,E);c.g(Z,v);for(O=0;4>O;O++)a.quats_before[H+O]=w[O],a.trans_before[H+O]=p[O],a.quats_after[H+O]=v[O],a.trans_after[H+O]=E[O];b=b.descend_bones_ptrs;for(O=0;O<b.length;O++)h(a,b[O],g,f,
d,l,e,k)}function ia(a,b){for(var g=4*b.bone_index,h=b.parent_bone_ptr,f=a.anim_mix_factor,d=La,l=Ia,e=Xa,k=Ua,q=0;4>q;q++)d[q]=a.trans_before[g+q],l[q]=a.quats_before[g+q],e[q]=a.trans_after[g+q],k[q]=a.quats_after[g+q];c.w(d,Z);c.r(l,Z);c.q(Z,b.tsr_local_rest,Z);c.a(Z,b.tsr_local_pose_b);h&&(c.p(h.tsr_local_pose_b,Oa),c.q(Oa,Z,Z));c.l(Z,d);c.g(Z,l);c.w(e,Z);c.r(k,Z);c.q(Z,b.tsr_local_rest,Z);c.a(Z,b.tsr_local_pose_a);h&&(c.p(h.tsr_local_pose_a,Oa),c.q(Oa,Z,Z));c.l(Z,e);c.g(Z,k);r.slerp(l,k,f,l);
m.G(d,e,f,d);for(q=0;4>q;q++)a.quats_curr[g+q]=l[q],a.trans_curr[g+q]=d[q];g=b.descend_bones_ptrs;for(q=0;q<g.length;q++)ia(a,g[q])}function ra(a,b){var c=a.render,g=c.anim_mix_factor,h=c.anim_mix_factor_change_speed;if(0!=h){!c.mix_with_current||c.trans_curr||c.quats_curr||(g=c.anim_mix_factor=0);var g=c.anim_destination_mix_factor-g,f=h*b;m._50(g)==m._50(h)&&Math.abs(f)<Math.abs(g)?c.anim_mix_factor+=f:(c.anim_mix_factor=c.anim_destination_mix_factor,c.anim_mix_factor_change_speed=0,c.anim_mix_cb&&
(c.anim_mix_cb(),c.anim_mix_cb=null),c.mix_with_current&&(c.trans_curr=null,c.quats_curr=null,c.mix_with_current=!1))}}function za(a,b){for(var g=[],h=[],f=[],d=[],l=a._render.num_pierced,e=0;e<l;e++){for(var k in b){var m=b[k],q=m.tsr_basis,D=a._render.bones[k];D?c.f(D,e,q):c.m(q);m.tsr_channel_cache_valid=!1}m=P(b);g.push(m.trans);h.push(m.quats);f.push(m.bone_space_trans);d.push(m.bone_space_quats)}return{trans:g,quats:h,bone_space_trans:f,bone_space_quats:d}}function P(a){var b=[],g=[],h=[],f=
[],d=new Float32Array(4),l=new Float32Array(4),e=new Float32Array(4),k=new Float32Array(4),m;for(m in a){var q=a[m],D=d,w=l,z=q.chain,p=z[z.length-1],n=p.tsr_channel_cache;p.tsr_channel_cache_valid||c.m(n);for(p=z.length-1;0<=p;p--){var r=z[p],v=r.tsr_channel_cache;if(r.tsr_channel_cache_valid)n=v;else{var u=r.tsr_local_rest,E=r.tsr_basis;c.p(u,Z);c.q(E,Z,Z);c.q(u,Z,Z);c.q(n,Z,v);n=v;r.tsr_channel_cache_valid=!0}}z=r.tsr_channel_cache;c.l(z,D);c.g(z,w);D=q.bone_index;c.q(q.tsr_bone_rest,q.tsr_basis,
Z);c.l(Z,e);c.g(Z,k);for(q=0;4>q;q++)w=4*D+q,b[w]=d[q],g[w]=l[q],h[w]=e[q],f[w]=k[q]}return{trans:b,quats:g,bone_space_trans:h,bone_space_quats:f}}function oa(a,b,c){var g=[],h=[],f;for(f in c)for(var d=c[f],l=d.bone_index,d=d.deform_bone_index,e=0;4>e;e++){var k=4*d+e,m=4*l+e;g[k]=a[m];h[k]=b[m]}g=new Float32Array(g);h=new Float32Array(h);return{trans:g,quats:h}}function Q(a){var b=a._render;if(b.bones)b.type=10;else if(b.params)if("volume"in b.params||"pitch"in b.params)b.type=40;else{var c;a:{if(c=
a._render.params)for(var g in c)if(-1!=g.indexOf("nodes")){c=!0;break a}c=!1}if(c)b.type=60;else{var h;a:{if(a._render.params){c=a.fcurves;for(h in c)if("color"==h&&!c[h][3]){h=!0;break a}if("energy"==h){h=!0;break a}}h=!1}if(h)b.type=70;else if(h=a._render.params,"light_settings.environment_energy"in h||"horizon_color"in h||"zenith_color"in h||"mist_settings.intensity"in h||"mist_settings.depth"in h||"mist_settings.start"in h||"mist_settings.height"in h||"b4w_fog_color"in h)b.type=80;else{var f;
a:{if(a._render.params)for(f in a=a.fcurves,a)if("location"==f||"rotation_quaternion"==f||"scale"==f){f=!0;break a}f=!1}b.type=f?20:0}}}else b.type=0}function da(a,b){b[0]=b[1]=b[2]=0;for(var c in a)"location"==c?b[0]=1:"rotation_quaternion"==c?b[1]=1:"scale"==c&&(b[2]=1)}function ja(a,b){b[0]=b[1]=0;for(var c in a)"energy"==c?b[0]=1:"color"==c&&(b[1]=1)}function va(a,b){b[0]=b[1]=b[2]=0;b[3]=b[4]=b[5]=0;b[6]=b[7]=0;for(var c in a)"light_settings.environment_energy"==c?b[0]=1:"horizon_color"==c?b[1]=
1:"zenith_color"==c?b[2]=1:"mist_settings.intensity"==c?b[3]=1:"mist_settings.depth"==c?b[4]=1:"mist_settings.start"==c?b[5]=1:"mist_settings.height"==c?b[6]=1:"b4w_fog_color"==c&&(b[7]=1)}function Ga(a,b,c,g,h,f,d){var l=a+(b-a)/2,e=ba(l,g,h,f,d)-c;return.02>Math.abs(e)?l:0<e?Ga(a,l,c,g,h,f,d):Ga(l,b,c,g,h,f,d)}function ba(a,b,c,g,h){var f=1-a;return b*f*f*f+3*c*f*f*a+3*g*f*a*a+h*a*a*a}function Ea(a,b){E(a,b);-1==Qa.indexOf(a)&&Qa.push(a)}function ta(a,b){g.update_transform(a);ya.sync_transform(a);
v(a,0,b,!0)}function X(a,b,c,g){g=g||0;if(xa.is_mesh(a)){var h=pa(a,c);if(h)return Ea(a,g),z(a,h,g),ta(a,g),!0;if((h=ka(a,c))&&"EMITTER"==h.p_type){Ea(a,g);b=h.name;c=g;for(var h=a.scenes_data,f=0;f<h.length;f++)for(var d=h[f].batches,l=0;l<d.length;l++){var e=d[l].particles_data;e&&e.name==b&&G(d[l],a.anim_slots[c],e)}ta(a,g);return!0}}if(h=m._19("name",c,$a)||m._19("name",c+"_B4W_BAKED",$a)){Ea(a,g);if(Y(a,b,h,g))return ta(a,g),!0;a.anim_slots[g]=null}O.error('Unsupported object: "'+a.name+'" or animation name: "'+
c+'"');return!1}function pa(a,b){for(var c=0;c<a.vertex_anim.length;c++){var g=a.vertex_anim[c];if(g.name===b)return g}return null}function ka(a,b){for(var c=a.scenes_data,g=0;g<c.length;g++)for(var h=c[g].batches,f=0;f<h.length;f++){var d=h[f].particles_data;if(d&&d.name===b)return d}return null}function C(a){a=a.modifiers;for(var b=0;b<a.length;b++){var c=a[b];if("ARMATURE"==c.type)return c.object}return null}var Ma=Object(V.a)(f),Aa=Object(n.a)(f),xa=Object(d.a)(f),ga=Object(k.a)(f),ya=Object(I.a)(f),
O=Object(A.a)(f),wa=Object(p.a)(f),qa=Object(u.a)(f),na=Object(a.a)(f),Ja=Object(B.a)(f),g=Object(l.a)(f),Da=Aa.animation,Ba=Aa.context_limits;e.LAST_FRAME_EPSILON=1E-6;e.OBJ_ANIM_TYPE_NONE=0;e.OBJ_ANIM_TYPE_ARMATURE=10;e.OBJ_ANIM_TYPE_OBJECT=20;e.OBJ_ANIM_TYPE_VERTEX=30;e.OBJ_ANIM_TYPE_SOUND=40;e.OBJ_ANIM_TYPE_PARTICLES=50;e.OBJ_ANIM_TYPE_MATERIAL=60;e.OBJ_ANIM_TYPE_LIGHT=70;e.OBJ_ANIM_TYPE_ENVIRONMENT=80;e.SLOT_0=0;e.SLOT_1=1;e.SLOT_2=2;e.SLOT_3=3;e.SLOT_4=4;e.SLOT_5=5;e.SLOT_6=6;e.SLOT_7=7;e.SLOT_ALL=
-1;e.AB_CYCLIC=10;e.AB_FINISH_RESET=20;e.AB_FINISH_STOP=30;var Ta=Array(3),ma=new Float32Array(3),Ka=new Float32Array(3),fb=new Float32Array(3),La=new Float32Array(4),Xa=new Float32Array(4),Wa=new Float32Array(4),W=new Float32Array(4),Ia=new Float32Array(4),Ua=new Float32Array(4),Na=new Float32Array(4),Va=new Float32Array(4),Z=c.b(),Oa=c.b(),Qa=[],$a=[];e.get_max_bones=function(){return m._64((Ba.max_vertex_uniform_vectors-50)/4)};e.frame_to_sec=function(a){return a/Ja.get_framerate()};e.update=function(a){for(var b=
0;b<Qa.length;b++){for(var c=Qa[b],g=0;8>g;g++)ea(c,a,g);c.render.anim_mixing&&(ra(c,a),D(c,a))}for(b=0;b<Qa.length;b++)for(c=Qa[b],g=0;8>g&&c.anim_slots.length;g++)T(c,g)};e.get_all_actions=function(){return $a};e.get_anim_names=function(a){var b=[];if(t(a))for(var c=0;c<a.vertex_anim.length;c++)b.push(a.vertex_anim[c].name);for(var g=[],c=0;c<$a.length;c++){var h=$a[c],f=h._render;20==f.type?g.push(h):60!=h._render.type||"MESH"!=a.type&&"WORLD"!=a.type?10==f.type&&"ARMATURE"==a.type?g.push(h):40==
f.type&&"SPEAKER"==a.type?g.push(h):80==f.type&&"WORLD"==a.type&&g.push(h):g.push(h)}for(c=0;c<g.length;c++)b.push(J(g[c].name));if(ga.obj_has_particles(a)&&ga.obj_has_anim_particles(a))for(a=a.scenes_data,c=0;c<a.length;c++)for(g=a[c].batches,h=0;h<g.length;h++)(f=g[h].particles_data)&&b.push(f.name);return b};e.strip_baked_suffix=J;e.get_anim_type=function(a,b){var c=a.anim_slots[b];return c?c.type:0};e.apply_def=function(a){for(var b=0,c=a.scenes_data,g=0;g<c.length;g++)for(var h=c[g].batches,
f=0;f<h.length;f++){var d=h[f].particles_data;d&&"EMITTER"==d.p_type&&!h[f].forked_batch&&(Ea(a,b),G(h[f],a.anim_slots[b],d),ta(a,b),a.anim_slots[b].behavior=d.cyclic?10:a.anim_behavior_def,b++)}c=a.def_action_slots.slice();for(g=0;g<c.length;g++)f=c[g],h=f.name_list,f=f.action,Ea(a,b),Y(a,h,f,b)?(ta(a,b),a.anim_slots[b].behavior=a.anim_behavior_def,b++):a.anim_slots[b]=null;t(a)&&(Ea(a,b),z(a,a.vertex_anim[0],b),ta(a,b),a.anim_slots[b].behavior=a.anim_behavior_def)};e.anim_behavior_bpy_b4w=function(a){switch(a){case "CYCLIC":return 10;
case "FINISH_RESET":return 20;case "FINISH_STOP":return 30;default:Ma.panic("Wrong animation behavior")}};e.get_bpy_material_actions=function(a){var b=[];a=a.data.materials;for(var c=0;c<a.length;c++){var g=a[c],h=g.node_tree;h&&F(h,b,[g.name])}return b};e.get_bpy_world_material_actions=function(a){var b=[],c=a.node_tree;c&&F(c,b,[a.name]);return b};e.init_action_slot=M;e.play=function(a,b,c){sa(a.anim_slots,c,function(a){a.play=!0;a.finish_callback=b?b:null;a.exec_finish_callback=!1});a.render.anim_mixing&&
q(a)};e.stop=function(a,b){sa(a.anim_slots,b,function(a){a.play=!1;a.finish_callback=null;a.exec_finish_callback=!1})};e.is_play=function(a,b){var c=a.anim_slots;if(-1==b)for(var g=0;8>g;g++){if(c[g]&&c[g].play)return!0}else if(c=c[b])return c.play;return!1};e.set_frame=K;e.set_first_frame=function(a,b){b=b||0;sa(a.anim_slots,b,function(c){K(a,c.start,b)})};e.get_current_frame_float=function(a,b){var c=a.anim_slots[b];return c&&c.current_frame_float?c.current_frame_float:0};e.is_cyclic=function(a,
b){var c=a.anim_slots[b];return c&&10==c.behavior};e.set_behavior=function(a,b,c){sa(a.anim_slots,c,function(a){a.behavior=b})};e.get_behavior=function(a,b){var c=a.anim_slots[b];return c&&c.behavior};e.apply_smoothing=function(a,b,c,g){sa(a.anim_slots,g,function(a){a.trans_smooth_period=b||0;a.quat_smooth_period=c||0})};e.remove_slot_animation=function(a,b){if(-1==b)for(var c=0;8>c;c++)a.anim_slots[c]=null;else a.anim_slots[b]=null;a.render.anim_mixing&&w(a,b)};e.update_object_animation=v;e.obj_is_animatable=
function(a){if("ARMATURE"==a.type||a.armobj||"WORLD"==a.type)return!0;for(var b=0;b<a.def_action_slots.length;b++){var c=a.def_action_slots[b].action._render.type;if(20==c||10==c||40==c&&"SPEAKER"==a.type||70==c&&"LAMP"==a.type||60==c&&"MESH"==a.type)return!0}return ga.obj_has_particles(a)&&ga.obj_has_anim_particles(a)||"MESH"==a.type&&a.vertex_anim.length?!0:!1};e.bpy_mesh_empty_is_animatable=function(a){if(C(a))return!0;if(a._def_action_slots)for(var b=0;b<a._def_action_slots.length;b++){var c=
a._def_action_slots[b].action._render.type;if(20==c||60==c&&"MESH"==a.type)return!0}return ga.bpy_obj_has_particles(a)&&ga.bpy_obj_has_anim_particles(a)||"MESH"==a.type&&a.data.b4w_vertex_anim.length?!0:!1};e.is_animated=function(a){return!!a.anim_slots.length};e.init_action_cache=function(a,b,c,g,h){if(c=c?m._19("uuid",c,$a):m._19("name",g,$a)||m._19("name",g+"_B4W_BAKED",$a)){E(a,h);-1==Qa.indexOf(a)&&Qa.push(a);g=c.frame_range;if(g[0]>g[1])return O.warn('Incompatible action "'+c.name+'" has been applied to object "'+
a.name+'"'),!1;g=c._render;switch(g.type){case 10:xa.is_armature(a)&&(g=ha(a,b,c),g||(g=za(c,a.render.bone_pointers),S(a,b,c,g)),L(a,h,c,g));break;case 20:if(h=g.params.tsr)g=ha(a,b,c),g||(g=rb(a,c,h),S(a,b,c,g));else return O.warn('Incompatible action "'+c.name+'" has been applied to object "'+a.name+'"'),!1}}};e.delete_cached_anim_data_by_mat=function(a,b){for(var c=a.action_anim_cache,g=[],h=0;h<c.length;h+=3)(60!=c[h]._render.type||null!==c[h+1]&&c[h+1].split("%join%")[0]!=b)&&g.push(c[h],c[h+
1],c[h+2]);a.action_anim_cache=g};var rb=function(){var a=c.b();return function(g,h,f){g=h._render.num_pierced;h=[];for(var d=[],l=[],e=0;e<g;e++){var k=c.f(f,e,a),m=c.j(k,b.create()),q=c.i(k,b.create()),k=c.g(k,r.create());h.push(m);d.push(q);l.push(k)}return{trans:h,scale:d,quats:l}}}();e.calc_pose_data=P;e.extract_skinned_pose_data=oa;e.append_action=function(a){var b=new RegExp(/pose.bones\[\".+\"\]/g),g=c.b(),h=function(a,c,h,f,d){if(-1<h.search(b)){a=c;h=h.split('"')[1];var l=g}else 8==d||9==
d?(h="tsr",l=g):l=1<d?new Float32Array(d):0;if(!a[h]){d=a;c=h;if("object"==typeof l&&l.length)for(var e=l.length,k=new Float32Array(f*e),m=0;m<f;m++)for(var q=0;q<e;q++)k[m*e+q]=l[q];else if("number"==typeof l)for(k=new Float32Array(f),m=0;m<f;m++)k[m]=l;else Ma.panic("Wrong storage default value");d[c]=k}return a[h]},f=function(a,b){if(-1<a.indexOf("location"))var c=0,g=b;else-1<a.indexOf("rotation_quaternion")?(c=6,g=0==b?NaN:b-1):(c=-1<a.indexOf("scale")?3:0,g=b);return c+g},d=a._render={type:0,
num_pierced:0,pierce_step:0,params:null,bones:null,bflags:null,channels_mask:new Int8Array(8)};d.pierce_step=1/Da.frame_steps;var l=a.fcurves,e={},k={},q=0,D;for(D in l){var w=l[D];Object.keys(w);for(var z in w){var p=w[z],n=p._pierced_points,r=p.num_channels;q||(q=n.length);var p=h(e,k,D,q,r),v=p.length/q,u=f(D,z|0);if(u==u)if(-1<D.indexOf("scale")&&8===r)for(r=0;r<q;r++)p[r*v+u]=n[r],p[r*v+u+1]=n[r],p[r*v+u+2]=n[r];else for(r=0;r<q;r++)p[r*v+u]=n[r]}if(-1<D.indexOf("rotation_quaternion")&&0 in w)for(p=
w[0],n=p._pierced_points,r=p.num_channels,p=h(e,k,D,q,r),v=p.length/q,r=0;r<q;r++)0>n[r]&&(p[r*v+6]=-p[r*v+6],p[r*v+7]=-p[r*v+7],p[r*v+8]=-p[r*v+8])}m._8(e)&&(d.params=e);m._8(k)&&(d.bones=k);d.num_pierced=q;d.bflags=a._bflags;"tsr"in e&&da(l,d.channels_mask);("color"in e||"energy"in e)&&ja(l,d.channels_mask);("light_settings.environment_energy"in e||"horizon_color"in e||"zenith_color"in e||"mist_settings.intensity"in e||"mist_settings.depth"in e||"mist_settings.start"in e||"mist_settings.height"in
e||"b4w_fog_color"in e)&&va(l,d.channels_mask);Q(a);$a.push(a)};e.get_approx_curve_length=function(a,b){return(b-a)*Da.frame_steps+1};e.approximate_curve=function(a,b,c,g,h,f){var d=new Float32Array(2),l=new Float32Array(2),e=new Float32Array(2),k=new Float32Array(2),m=b[1],q=b[2],D=b[a.last_frame_offset+1];a=b[a.last_frame_offset+2];for(var w=0,p=0,z=null;h<=f;h++)if(h<m)for(var n=0;n<Da.frame_steps;n++)c[w++]=q;else if(h>D)for(n=0;n<Da.frame_steps;n++)c[w++]=a;else{var r=b[p],v=3;0===r&&(v+=2);
0===z&&(v+=2);var u=2===r?0:1;if(b[p+1]==b[p+v+1])z=r,p+=v;else{n=0;h==b[p+1]&&(u&&(g[w]=1),c[w]=b[p+2],w++,n++);if(h==D)for(;n<Da.frame_steps;n++)c[w++]=a;else for(d[0]=b[p+1],d[1]=b[p+2],0!==r?(l[0]=0,l[1]=0):0===z?(l[0]=b[p+5],l[1]=b[p+6]):(l[0]=b[p+3],l[1]=b[p+4]),0!==r?(e[0]=0,e[1]=0):(e[0]=b[p+v+3],e[1]=b[p+v+4]),k[0]=b[p+v+1],k[1]=b[p+v+2];n<Da.frame_steps;n++){var E=h+n/Da.frame_steps;switch(r){case 0:var G,H,B,A=d,y=l,L=e,S=k,J=[],O=[];J[0]=A[0]-y[0];J[1]=A[1]-y[1];O[0]=S[0]-L[0];O[1]=S[1]-
L[1];G=S[0]-A[0];B=Math.abs(J[0]);H=Math.abs(O[0]);0!=B+H&&B+H>G&&(G/=B+H,y[0]=A[0]-G*J[0],y[1]=A[1]-G*J[1],L[0]=S[0]-G*O[0],L[1]=S[1]-G*O[1]);u&&(g[w]=1);A=w;y=d;L=l;S=e;J=k;E=Ga(0,1,E,y[0],L[0],S[0],J[0]);E=ba(E,y[1],L[1],S[1],J[1]);c[A]=E;w++;break;case 1:u&&(g[w]=1);A=d[0];y=d[1];L=(k[1]-y)/(k[0]-A);c[w]=L*E+(y-L*A);w++;break;case 2:u&&(g[w]=1);c[w]=b[p+2];w++;break;default:Ma.panic("Unknown keyframe interpolation mode: "+r)}}h+1==b[p+v+1]&&(z=r,p+=v)}}};e.apply=X;e.apply_by_uuid=function(a,b,
c,g){g=g||0;var h=m._19("uuid",c,$a);if(h){Ea(a,g);if(Y(a,b,h,g))return ta(a,g),!0;a.anim_slots[g]=null}O.error('Unsupported object: "'+a.name+'" or animation uuid: "'+c+'"');return!1};e.validate_action_by_name=function(a,b){var c=m._19("name",b,$a)||m._19("name",b+"_B4W_BAKED",$a);if(c){if(0==c._render.type)return!1}else if(!(ka(a,b)||xa.is_mesh(a)&&pa(a,b)))return!1;return!0};e.get_slot_num_by_anim=function(a,b){for(var c=a.anim_slots,g=0;g<c.length;g++){var h=c[g];if(h&&J(h.animation_name)==J(b))return g}return-1};
e.get_anim_by_slot_num=function(a,b){var c=a.anim_slots[b];return c&&c.animation_name?J(c.animation_name):null};e.remove=function(a){a.anim_slots.length=0;a=Qa.indexOf(a);-1!=a&&Qa.splice(a,1)};e.remove_actions=function(a){for(var b=$a.length-1;0<=b;b--)$a[b]._data_id==a&&$a.splice(b,1)};e.apply_to_first_empty_slot=function(a,b){if(!a.anim_slots.length)return X(a,null,b,0)?0:-1;for(var c=0;c<a.anim_slots.length;c++)if(!a.anim_slots[c])return X(a,null,b,c)?c:-1};e.set_skel_mix_factor=function(a,b,
c,g){a=a.render;a.anim_mix_factor_change_speed=(b-a.anim_mix_factor)/c;a.anim_destination_mix_factor=b;a.anim_mix_cb&&a.anim_mix_cb();a.anim_mix_cb=g};e.mix_from_cur_pos=function(a,b,c,g){a=a.render;a.blend_skel_slots[1]=b;a.anim_mix_factor_change_speed=1/c;a.anim_destination_mix_factor=1;a.anim_mix_cb&&a.anim_mix_cb();a.anim_mix_cb=g;a.trans_curr=null;a.quats_curr=null;a.mix_with_current=!0};e.set_speed=function(a,b,c){sa(a.anim_slots,c,function(a){a.speed=b})};e.get_speed=function(a,b){return a.anim_slots[b].speed};
e.get_anim_start_frame=function(a,b){return a.anim_slots[b].start};e.get_anim_length=function(a,b){return a.anim_slots[b].length};e.cleanup=function(){Qa.length=0;$a.length=0};e.fcurve_replace_euler_by_quat=function(a){var b=(a[0]||a[1]||a[2])._pierced_points.length,c=Ia,g=ma,h=!!a[0];h||(a[0]={_pierced_points:new Float32Array(b),num_channels:8});var f=!!a[1];f||(a[1]={_pierced_points:new Float32Array(b),num_channels:8});var d=!!a[2];d||(a[2]={_pierced_points:new Float32Array(b),num_channels:8});
a[3]={_pierced_points:new Float32Array(b),num_channels:8};for(var l=0;l<b;l++)g[0]=h?a[0]._pierced_points[l]:0,g[1]=f?a[1]._pierced_points[l]:0,g[2]=d?a[2]._pierced_points[l]:0,m.Y(g,c),a[0]._pierced_points[l]=c[3],a[1]._pierced_points[l]=c[0],a[2]._pierced_points[l]=c[1],a[3]._pierced_points[l]=c[2]};e.get_bpy_armobj=C;e.slot_by_anim_type=function(a,b){for(var c=7,g=0,h=0;h<$a.length;h++){var f=$a[h];if(f.name==b){g=f._render.type;break}}0==g&&(pa(a,b)?g=30:(h=ka(a,b))&&"EMITTER"==h.p_type&&(g=50));
for(h=0;8>h;h++)if(f=a.anim_slots[h]){if(f.type==g)return h}else h<c&&(c=h);return c}});t.a=e},function(C,t,e){C=e(0);var R=e(35),V=e(15),n=e(4),y=e(21),d=e(1),k=e(6),I=e(8),A=e(2),r=e(3),p=e(7);e=Object(C.a)("__input",function(e,a){function u(a){var b=Q.detect_mobile();return(20!=a||navigator.getVRDevices||navigator.getVRDisplays||b&&oa())&&(10!=a||b&&window.DeviceOrientationEvent)?!0:!1}function l(a,b){if(!u(a))return null;var c={type:a,registered:!1,orientation_quat_cb_list:[],orientation_angles_cb_list:[],
mouse_down_which_cb_list:[],mouse_location_cb_list:[],mouse_up_which_cb_list:[],mouse_wheel_cb_list:[],keyboard_down_cb_list:[],keyboard_down_mod_cb_list:[],keyboard_up_cb_list:[],touch_start_cb_list:[],touch_move_cb_list:[],touch_end_cb_list:[],element:b,prevent_default:!0,registered_event_listeners:[],mouse_location:new Float32Array(2),mouse_which:0,distortion_coefs:new Float32Array(2),chromatic_aberration_coefs:new Float32Array(4),registered_cb:null,webvr_hmd_device:null,webvr_sensor_devices:null,
webvr_display:null,orientation:I.create(),position:r.create(),frame_data:window.VRFrameData?new VRFrameData:null,standing_tsr:k.b(),fov_left:new Float32Array(4),fov_right:new Float32Array(4),inter_lens_dist:0,base_line_dist:0,screen_to_lens_dist:0,width_dist:0,height_dist:0,bevel_size:0,gamepad_btns:[],gamepad_axes:[0,0,0,0,0,0,0,0,0,0,0,0],gamepad_prev_axes:[0,0,0,0,0,0,0,0,0,0,0,0],gamepad_mapping:[]};c.fov_left[0]=c.fov_left[1]=c.fov_left[2]=c.fov_left[3]=Math.PI/4;c.fov_right[0]=c.fov_right[1]=
c.fov_right[2]=c.fov_right[3]=Math.PI/4;30==a||40==a||50==a?(c.registered=!!b,50==a?document.addEventListener("touchstart",function(){}):40==a&&(c.prevent_default=!1)):10==a?c.registered=!0:20==a&&m(c);return c}function c(b,c){10==b||20==b?c=window:c||(c=40==b?document:da.get_container());for(var h=0;h<ya.length;h++)if(ya[h].type==b&&ya[h].element==c)return ya[h];h=l(b,c);60!=b&&70!=b&&80!=b&&90!=b||h.gamepad_mapping.push(a.GMPD_BUTTON_0,a.GMPD_BUTTON_1,a.GMPD_BUTTON_2,a.GMPD_BUTTON_3,a.GMPD_BUTTON_4,
a.GMPD_BUTTON_5,a.GMPD_BUTTON_6,a.GMPD_BUTTON_7,a.GMPD_BUTTON_8,a.GMPD_BUTTON_9,a.GMPD_BUTTON_10,a.GMPD_BUTTON_11,a.GMPD_BUTTON_12,a.GMPD_BUTTON_13,a.GMPD_BUTTON_14,a.GMPD_BUTTON_15,a.GMPD_BUTTON_16,a.GMPD_BUTTON_17,a.GMPD_BUTTON_18,a.GMPD_BUTTON_19,a.GMPD_BUTTON_20,a.GMPD_BUTTON_21,a.GMPD_BUTTON_22,a.GMPD_BUTTON_23,a.GMPD_BUTTON_24,a.GMPD_BUTTON_25,a.GMPD_AXIS_0,a.GMPD_AXIS_1,a.GMPD_AXIS_2,a.GMPD_AXIS_3,a.GMPD_AXIS_4,a.GMPD_AXIS_5,a.GMPD_AXIS_6,a.GMPD_AXIS_7,a.GMPD_AXIS_8,a.GMPD_AXIS_9,a.GMPD_AXIS_10,
a.GMPD_AXIS_11);h&&ya.push(h);return h}function m(a){20==a.type&&(navigator.getVRDisplays?navigator.getVRDisplays().then(function(b){0<b.length&&(a.webvr_display=b[0],a.registered=!0,a.webvr_display.getFrameData(a.frame_data),a.registered_cb&&a.registered_cb())},function(b){va.error_once("WebVR displays are not found.");a.registered=!1}):navigator.getVRDevices?(navigator.getVRDevices().then(function(b){fa(a,b);b.length&&(a.registered=!0);a.registered_cb&&a.registered_cb()},function(b){va.error_once("WebVR devices are not found.");
a.registered=!1}),f(a,ba.webvr)):(b(a),a.registered=!0))}function b(a){var b=ba.nonwebvr;a.width_dist=b.width_dist;a.height_dist=b.height_dist;a.bevel_size=b.bevel_size;f(a,b);a.inter_lens_dist=b.inter_lens_dist;a.base_line_dist=b.base_line_dist;a.screen_to_lens_dist=b.screen_to_lens_dist;T(a)}function f(a,b){a.distortion_coefs[0]=b.distortion_coefs[0];a.distortion_coefs[1]=b.distortion_coefs[1];a.chromatic_aberration_coefs[0]=b.chromatic_aberration_coefs[0];a.chromatic_aberration_coefs[1]=b.chromatic_aberration_coefs[1];
a.chromatic_aberration_coefs[2]=b.chromatic_aberration_coefs[2];a.chromatic_aberration_coefs[3]=b.chromatic_aberration_coefs[3]}function T(a){var b=Math.atan(a.inter_lens_dist/2/a.screen_to_lens_dist*ba.nonwebvr.distor_scale);b&&(a.fov_left[0]=a.fov_right[0]=Math.min(b,Math.PI/3));b&&(a.fov_left[1]=a.fov_right[3]=Math.min(b,Math.PI/3));b&&(a.fov_left[2]=a.fov_right[2]=Math.min(b,Math.PI/3));b&&(a.fov_left[3]=a.fov_right[1]=Math.min(b,Math.PI/3))}function fa(a,b){var c=b.filter(function(a){return a instanceof
HMDVRDevice}),h=null;c.length&&(h=c[0]);c=null;h&&(c=b.filter(function(a){return-1!==a.deviceName.toLowerCase().indexOf("oculus")&&a.hardwareUnitId==h.hardwareUnitId&&a instanceof PositionSensorVRDevice}));a.webvr_hmd_device=h;a.webvr_sensor_devices=c}function z(a,b,c){switch(a.type){case 20:var h=E(a,0);if(h&1){var f="left"==b?a.fov_left:a.fov_right;p.copy(f,c)}else if(f=a.webvr_display||a.webvr_hmd_device)f=f.getEyeParameters(b),(f=f.fieldOfView||f.currentFieldOfView)?(c[0]=A.T(f.upDegrees),c[1]=
A.T(f.rightDegrees),c[2]=A.T(f.downDegrees),c[3]=A.T(f.leftDegrees)):h&16&&(h=X,"left"==b?y.copy(a.frame_data.leftProjectionMatrix,h):y.copy(a.frame_data.rightProjectionMatrix,h),a=y.invert(h,h),r.transformMat4([1,1,-1],a,C),c[0]=Math.atan(-C[1]/C[2]),c[1]=Math.atan(-C[0]/C[2]),r.transformMat4([-1,-1,-1],a,C),c[2]=Math.atan(C[1]/C[2]),c[3]=Math.atan(C[0]/C[2]));break;default:va.error("fov is undefined for device: ",a.type)}return c}function G(a,b,c){switch(a.type){case 20:a.webvr_display&&("left"==
b?y.copy(a.frame_data.leftProjectionMatrix,c):"right"==b?y.copy(a.frame_data.rightProjectionMatrix,c):va.error("Unknown type of eye: ",b));break;default:va.error("Projection matrix is undefined for device: ",a.type)}return c}function E(a,b){switch(b){case 0:var c=0;navigator.getVRDisplays&&(c|=8,a.frame_data&&(c|=16));navigator.getVRDevices&&(c=Ga.is_mobile_device?c|4:c|2);return c||1;case 23:var h=a.webvr_display||a.webvr_hmd_device;return h?(c=h.getEyeParameters("left"),h=h.getEyeParameters("right"),
a.webvr_display?h.offset[0]-c.offset[0]:h.eyeTranslation.x-c.eyeTranslation.x):a.inter_lens_dist}}function J(a,b){if(a){for(var h=0;h<a.buttons.length;h++)b.gamepad_btns[h]=a.buttons[h].value||+a.buttons[h].pressed;if(a.axes)for(h=0;h<a.axes.length;h++)b.gamepad_axes[h]=a.axes[h];if(h=a.pose){var f=c(20).standing_tsr;h.position&&k.D(h.position,f,b.position);h.orientation&&k.A(h.orientation,f,b.orientation)}}}function M(a){for(var b=0;b<a.gamepad_btns;b++)a.gamepad_btns[b]=0;for(b=0;b<a.gamepad_axes.length;b++)a.gamepad_prev_axes[b]=
a.gamepad_axes[b],a.gamepad_axes[b]=0;a.position.set(A.m);a.orientation.set(A.k)}function F(a,b){var c=a.indexOf(b);0<=c&&(a[c]=null)}function t(a){return null===a}function K(a,b,c,f){switch(b){case 130:c&&F(a.orientation_quat_cb_list,c);if(f||a.orientation_angles_cb_list.every(t)&&a.orientation_quat_cb_list.every(t))a.orientation_quat_cb_list.length=0,a.orientation_angles_cb_list.length=0,b=a.registered_event_listeners.indexOf(141),0<=b&&(a.registered_event_listeners.splice(b,1),a.element.removeEventListener("deviceorientation",
v,!1));break;case 140:c&&F(a.orientation_angles_cb_list,c);if(f||a.orientation_angles_cb_list.every(t)&&a.orientation_quat_cb_list.every(t))a.orientation_quat_cb_list.length=0,a.orientation_angles_cb_list.length=0,b=a.registered_event_listeners.indexOf(141),0<=b&&(a.registered_event_listeners.splice(b,1),a.element.removeEventListener("deviceorientation",v,!1));break;case 50:c&&F(a.mouse_down_which_cb_list,c);if(f||a.mouse_down_which_cb_list.every(t))a.mouse_down_which_cb_list.length=0,b=a.registered_event_listeners.indexOf(b),
0<=b&&(a.registered_event_listeners.splice(b,1),a.element.removeEventListener("mousedown",L,!1));break;case 40:c&&F(a.mouse_location_cb_list,c);if(f||a.mouse_location_cb_list.every(t))a.mouse_location_cb_list.length=0,b=a.registered_event_listeners.indexOf(b),0<=b&&(a.registered_event_listeners.splice(b,1),a.element.removeEventListener("mousemove",ha,!1));break;case 41:c&&F(a.mouse_location_cb_list,c);if(f||a.mouse_location_cb_list.every(t))a.mouse_location_cb_list.length=0,b=a.registered_event_listeners.indexOf(b),
0<=b&&(a.registered_event_listeners.splice(b,1),a.element.removeEventListener("mousemove",S,!1));break;case 60:c&&F(a.mouse_up_which_cb_list,c);if(f||a.mouse_up_which_cb_list.every(t))a.mouse_up_which_cb_list.length=0,b=a.registered_event_listeners.indexOf(b),0<=b&&(a.registered_event_listeners.splice(b,1),a.element.removeEventListener("mouseout",q,!1),a.element.removeEventListener("mouseup",w,!1));break;case 70:c&&F(a.mouse_wheel_cb_list,c);if(f||a.mouse_wheel_cb_list.every(t))a.mouse_wheel_cb_list.length=
0,b=a.registered_event_listeners.indexOf(b),0<=b&&(a.registered_event_listeners.splice(b,1),a.element.removeEventListener("wheel",ea,!1));break;case 90:c&&F(a.keyboard_down_cb_list,c);if(f||a.keyboard_down_cb_list.every(t))a.keyboard_down_cb_list.length=0,b=a.registered_event_listeners.indexOf(b),0<=b&&(a.registered_event_listeners.splice(b,1),a.element.removeEventListener("keydown",H,!1));break;case 80:c&&F(a.keyboard_up_cb_list,c);if(f||a.keyboard_up_cb_list.every(t))a.keyboard_up_cb_list.length=
0,b=a.registered_event_listeners.indexOf(b),0<=b&&(a.registered_event_listeners.splice(b,1),a.element.removeEventListener("keyup",D,!1));break;case 100:c&&F(a.touch_start_cb_list,c);if(f||a.touch_start_cb_list.every(t))a.touch_start_cb_list.length=0,b=a.registered_event_listeners.indexOf(b),0<=b&&(a.registered_event_listeners.splice(b,1),a.element.removeEventListener("touchstart",h,!1));break;case 110:c&&F(a.touch_move_cb_list,c);if(f||a.touch_move_cb_list.every(t))a.touch_move_cb_list.length=0,b=
a.registered_event_listeners.indexOf(b),0<=b&&(a.registered_event_listeners.splice(b,1),a.element.removeEventListener("touchmove",ia,!1));break;case 120:if(c&&F(a.touch_end_cb_list,c),f||a.touch_end_cb_list.every(t))a.touch_end_cb_list.length=0,b=a.registered_event_listeners.indexOf(b),0<=b&&(a.registered_event_listeners.splice(b,1),a.element.removeEventListener("touchend",ra,!1))}}function sa(a,b){A._27(a,A.w,b);var c="orientation"in window?A.T(window.orientation):"orientation"in window.screen?A.T(window.screen.orientation.angle):
0,c=I.setAxisAngle(A.c,c,ka);I.multiply(b,c,b);return b}function v(a){var b=C;null===a.alpha||null===a.beta||null===a.gamma?b[0]=b[1]=b[2]=0:(b[0]=A.T(a.alpha),b[1]=A.T(a.beta),b[2]=A.T(a.gamma));a=c(10,a.currentTarget);for(var h=0;h<a.orientation_angles_cb_list.length;h++){var f=a.orientation_angles_cb_list[h];f&&(r.copy(b,Aa),f(Aa))}if(a.orientation_quat_cb_list.length)for(b=sa(b,pa),h=0;h<a.orientation_quat_cb_list.length;h++)if(f=a.orientation_quat_cb_list[h])I.copy(b,xa),f(xa);for(h=0;h<a.orientation_quat_cb_list.length;h++)a.orientation_quat_cb_list[h]||
a.orientation_quat_cb_list.splice(h,1);for(h=0;h<a.orientation_angles_cb_list.length;h++)a.orientation_angles_cb_list[h]||a.orientation_angles_cb_list.splice(h,1)}function Y(a,b){switch(a.type){case 30:a.mouse_location[0]=b.clientX,a.mouse_location[1]=b.clientY,a.mouse_which=b.which}}function ha(a){if(!ga||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var b=c(30,a.currentTarget);Y(b,a);for(var h=0;h<b.mouse_location_cb_list.length;h++){var f=b.mouse_location_cb_list[h];
f&&(Ma[0]=a.clientX,Ma[1]=a.clientY,f(Ma))}b.prevent_default&&a.preventDefault();for(h=0;h<b.mouse_location_cb_list.length;h++)b.mouse_location_cb_list[h]||b.mouse_location_cb_list.splice(h,1)}}function S(a){if(!ga||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var b=c(30,a.currentTarget);Y(b,a);for(var h=0;h<b.mouse_location_cb_list.length;h++){var f=b.mouse_location_cb_list[h];if(f){if("number"==typeof a.movementX)var d=a.movementX,g=a.movementY;else"number"==
typeof a.webkitMovementX?(d=a.webkitMovementX,g=a.webkitMovementY):"number"==typeof a.mozMovementX?(d=a.mozMovementX,g=a.mozMovementY):g=d=0;Ma[0]=d;Ma[1]=g;f(Ma)}}b.prevent_default&&a.preventDefault();for(h=0;h<b.mouse_location_cb_list.length;h++)b.mouse_location_cb_list[h]||b.mouse_location_cb_list.splice(h,1)}}function L(a){if(!ga||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var b=c(30,a.currentTarget);Y(b,a);for(var h=0;h<b.mouse_down_which_cb_list.length;h++){var f=
b.mouse_down_which_cb_list[h];f&&f(a.which)}b.prevent_default&&(window.frameElement&&window.frameElement.focus(),a.preventDefault());for(h=0;h<b.mouse_down_which_cb_list.length;h++)b.mouse_down_which_cb_list[h]||b.mouse_down_which_cb_list.splice(h,1)}}function q(a){!da.is_child(a.relatedTarget)&&a.which&&w(a)}function w(a){if(!ga||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var b=c(30,a.currentTarget);Y(b,a);for(var h=0;h<b.mouse_up_which_cb_list.length;h++){var f=
b.mouse_up_which_cb_list[h];f&&f(a.which)}b.prevent_default&&a.preventDefault();for(h=0;h<b.mouse_up_which_cb_list.length;h++)b.mouse_up_which_cb_list[h]||b.mouse_up_which_cb_list.splice(h,1)}}function ea(a){for(var b=c(30,a.currentTarget),h=0;h<b.mouse_wheel_cb_list.length;h++){var f=b.mouse_wheel_cb_list[h];if(f){var d;d=a;var g=0;d.wheelDelta?g=0==d.wheelDelta%120?d.wheelDelta/120:A._50(d.wheelDelta):d.deltaY&&(g=0==d.deltaY%3?-d.deltaY/3:-A._50(d.deltaY));d=A.M(100*g,-2E3,2E3);f(d)}}b.prevent_default&&
a.preventDefault();for(h=0;h<b.mouse_wheel_cb_list.length;h++)b.mouse_wheel_cb_list[h]||b.mouse_wheel_cb_list.splice(h,1)}function H(a){for(var b=c(40,a.currentTarget),h=a.ctrlKey||a.altKey||a.metaKey?b.keyboard_down_mod_cb_list:b.keyboard_down_cb_list,f=0;f<h.length;f++){var d=h[f];d?d(a.keyCode):h.splice(f--,1)}b.prevent_default&&a.preventDefault()}function D(a){for(var b=c(40,a.currentTarget),h=0;h<b.keyboard_up_cb_list.length;h++){var f=b.keyboard_up_cb_list[h];f&&f(a.keyCode)}b.prevent_default&&
a.preventDefault();for(h=0;h<b.keyboard_up_cb_list.length;h++)b.keyboard_up_cb_list[h]||b.keyboard_up_cb_list.splice(h,1)}function h(a){for(var b=c(50,a.currentTarget),h=0;h<b.touch_start_cb_list.length;h++){var f=b.touch_start_cb_list[h];f&&f(a.targetTouches)}for(h=0;h<b.touch_start_cb_list.length;h++)b.touch_start_cb_list[h]||b.touch_start_cb_list.splice(h,1)}function ia(a){for(var b=c(50,a.currentTarget),h=0;h<b.touch_move_cb_list.length;h++){var f=b.touch_move_cb_list[h];f&&f(a.targetTouches)}b.prevent_default&&
a.preventDefault();for(h=0;h<b.touch_move_cb_list.length;h++)b.touch_move_cb_list[h]||b.touch_move_cb_list.splice(h,1)}function ra(a){for(var b=c(50,a.currentTarget),h=0;h<b.touch_end_cb_list.length;h++){var f=b.touch_end_cb_list[h];f&&f(a.targetTouches)}for(h=0;h<b.touch_end_cb_list.length;h++)b.touch_end_cb_list[h]||b.touch_end_cb_list.splice(h,1)}function za(a){switch(a){case 0:a=60;break;case 1:a=70;break;case 2:a=80;break;case 3:a=90;break;default:a=60}return a}function P(a){var b=a.element,
c=function(){document.pointerLockElement===b||document.webkitPointerLockElement===b||document.mozPointerLockElement===b?a.value=1:(a.value=0,document.removeEventListener("pointerlockchange",c,!1),document.removeEventListener("webkitpointerlockchange",c,!1),document.removeEventListener("mozpointerlockchange",c,!1))};document.addEventListener("pointerlockchange",c,!1);document.addEventListener("webkitpointerlockchange",c,!1);document.addEventListener("mozpointerlockchange",c,!1);var h=b.requestPointerLock||
b.webkitRequestPointerLock||b.mozRequestPointerLock;"function"===typeof h&&h.apply(b)}function oa(){return window.document.fullscreenEnabled||window.document.mozFullScreenEnabled||window.document.msFullscreenEnabled||window.document.webkitFullscreenEnabled?!0:!1}var Q=Object(R.a)(e),da=Object(V.a)(e),ja=Object(n.a)(e),va=Object(d.a)(e),Ga=ja.defaults,ba=ja.hmd_params,Ea=k.b(),ta=k.b(),X=y.create();a.DEVICE_GYRO=10;a.DEVICE_HMD=20;a.DEVICE_MOUSE=30;a.DEVICE_KEYBOARD=40;a.DEVICE_TOUCH=50;a.DEVICE_GAMEPAD0=
60;a.DEVICE_GAMEPAD1=70;a.DEVICE_GAMEPAD2=80;a.DEVICE_GAMEPAD3=90;a.HMD_WEBVR_DESKTOP=2;a.HMD_WEBVR_MOBILE=4;a.HMD_NON_WEBVR=1;a.HMD_WEBVR1=8;a.HMD_WEBVR1_1=16;a.HMD_WEBVR_TYPE=0;a.HMD_ORIENTATION_QUAT=10;a.HMD_POSITION=20;a.HMD_FOV_LEFT=21;a.HMD_FOV_RIGHT=22;a.HMD_EYE_DISTANCE=23;a.HMD_DISTORTION=24;a.HMD_BASELINE_DIST=25;a.HMD_SCREEN_LENS_DIST=26;a.HMD_SCREEN_WIDTH=27;a.HMD_SCREEN_HEIGHT=28;a.HMD_BEVEL_SIZE=29;a.HMD_PROJ_LEFT=30;a.HMD_PROJ_RIGHT=31;a.MOUSE_LOCATION=40;a.MOUSE_LOCATION_PL=41;a.MOUSE_DOWN_WHICH=
50;a.MOUSE_UP_WHICH=60;a.MOUSE_WHEEL=70;a.KEYBOARD_UP=80;a.KEYBOARD_DOWN=90;a.KEYBOARD_DOWN_MODIFIED=91;a.TOUCH_START=100;a.TOUCH_MOVE=110;a.TOUCH_END=120;a.GYRO_ORIENTATION_QUAT=130;a.GYRO_ORIENTATION_ANGLES=140;a.GMPD_BUTTON_0=300;a.GMPD_BUTTON_1=301;a.GMPD_BUTTON_2=302;a.GMPD_BUTTON_3=303;a.GMPD_BUTTON_4=304;a.GMPD_BUTTON_5=305;a.GMPD_BUTTON_6=306;a.GMPD_BUTTON_7=307;a.GMPD_BUTTON_8=308;a.GMPD_BUTTON_9=309;a.GMPD_BUTTON_10=310;a.GMPD_BUTTON_11=311;a.GMPD_BUTTON_12=312;a.GMPD_BUTTON_13=313;a.GMPD_BUTTON_14=
314;a.GMPD_BUTTON_15=315;a.GMPD_BUTTON_16=316;a.GMPD_BUTTON_17=317;a.GMPD_BUTTON_18=318;a.GMPD_BUTTON_19=319;a.GMPD_BUTTON_20=320;a.GMPD_BUTTON_21=321;a.GMPD_BUTTON_22=322;a.GMPD_BUTTON_23=323;a.GMPD_BUTTON_24=324;a.GMPD_BUTTON_25=325;a.GMPD_TRACKPAD_BUTTON=300;a.GMPD_TRIGGER_BUTTON=301;a.GMPD_GRIPS_BUTTON=302;a.GMPD_MENU_BUTTON=303;a.GMPD_AXIS_0=326;a.GMPD_AXIS_1=327;a.GMPD_AXIS_2=328;a.GMPD_AXIS_3=329;a.GMPD_AXIS_4=330;a.GMPD_AXIS_5=331;a.GMPD_AXIS_6=332;a.GMPD_AXIS_7=333;a.GMPD_AXIS_8=334;a.GMPD_AXIS_9=
335;a.GMPD_AXIS_10=336;a.GMPD_AXIS_11=337;var pa=I.create(),ka=I.create(),C=r.create(),Ma=new Float32Array(2),Aa=r.create(),xa=I.create(),ga="ontouchstart"in document.documentElement,ya=[];a.can_use_device=u;a.init=function(){if("HMD"==Ga.stereo||"NONE"==Ga.stereo&&Ga.is_mobile_device){var a=c(20);a&&document.addEventListener("onvrdisplayconnect",function(b){a.webvr_display=b.display;a.registered=!0;a.webvr_display.getFrameData(a.frame_data)})}};a.get_device_by_type_element=c;a.request_register_device=
m;a.switch_prevent_default=function(a,b){a.prevent_default=b};a.reset_device=function(a){switch(a.type){case 20:if(a.registered)if(a.webvr_display)a.webvr_display.resetPose();else if(a.webvr_sensor_devices)for(var b=0;b<a.webvr_sensor_devices.length;b++)a.webvr_sensor_devices[b].resetSensor();break;default:va.error("reset_device() is undefined for device: ",a.type)}};a.get_vector_param=function(a,b,c){switch(b){case 10:a:switch(a.type){case 20:r.copy(A.k,c);if(a.webvr_display)c[0]=a.orientation[0],
c[1]=a.orientation[1],c[2]=a.orientation[2],c[3]=a.orientation[3];else if(a.webvr_sensor_devices)for(b=0;b<a.webvr_sensor_devices.length;b++){var h=a.webvr_sensor_devices[b],h=h.getState&&h.getState()||h.getImmediateState&&h.getImmediateState();h.orientation&&(c[0]=h.orientation.x,c[1]=h.orientation.y,c[2]=h.orientation.z,c[3]=h.orientation.w)}a=c;break a;default:va.error("orientation_quat is undefined for device: ",a.type),a=c}return a;case 20:a:switch(a.type){case 20:r.copy(A.n,c);if(a.webvr_display)c[0]=
a.position[0],c[1]=a.position[1],c[2]=a.position[2];else if(a.webvr_sensor_devices)for(b=0;b<a.webvr_sensor_devices.length;b++)h=a.webvr_sensor_devices[b],h=h.getState&&h.getState()||h.getImmediateState&&h.getImmediateState(),h.position&&(c[0]=h.position.x,c[1]=-h.position.z,c[2]=h.position.y);a=c;break a;default:va.error("position is undefined for device: ",a.type),a=c}return a;case 21:return z(a,"left",c);case 22:return z(a,"right",c);case 30:return G(a,"left",c);case 31:return G(a,"right",c);case 40:case 41:return c[0]=
a.mouse_location[0],c[1]=a.mouse_location[1],c}};a.get_value_param=E;a.set_config=function(a,b,c){switch(a.type){case 20:if(E(a,0)&8)break;switch(b){case 24:a.distortion_coefs[0]=c[0];a.distortion_coefs[1]=c[1];break;case 23:a.inter_lens_dist=c;T(a);break;case 25:a.base_line_dist=c;T(a);break;case 26:a.screen_to_lens_dist=c;T(a);break;case 27:a.width_dist=c;T(a);break;case 28:a.height_dist=c;T(a);break;case 29:a.bevel_size=c,T(a)}break;case 60:case 70:case 80:case 90:a.gamepad_mapping[b]=c}};a.get_gamepad_btn_value=
function(a,b){var c=b-300;return c<a.gamepad_btns.length?a.gamepad_btns[a.gamepad_mapping[c]-300]:!1};a.get_gamepad_axis_value=function(a,b){return b-326<a.gamepad_axes.length?a.gamepad_axes[a.gamepad_mapping[b-300]-326]:0};a.get_gamepad_position=function(a,b){b.set(a.position);return b};a.get_gamepad_orientation=function(a,b){b.set(a.orientation);return b};a.update=function(a){a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[];for(var b=0;b<
ya.length;b++){var c=ya[b];switch(c.type){case 60:M(c);J(a[0],c);break;case 70:M(c);J(a[1],c);break;case 80:M(c);J(a[2],c);break;case 90:M(c);J(a[3],c);break;case 20:if(c.webvr_display){var h=c.webvr_display;if(c.frame_data&&h.getFrameData(c.frame_data)){var f=c.frame_data.pose,g=A._26(c.frame_data.leftViewMatrix,C);c.inter_lens_dist=2*r.length(g)}else h.getPose&&(f=h.getPose());f&&(g=I.setAxisAngle(A.d,Math.PI/2,pa),h.stageParameters&&h.stageParameters.sittingToStandingTransform?(h=k.d(h.stageParameters.sittingToStandingTransform,
Ea),k.m(ta),g=k.r(g,ta),h=k.q(g,h,c.standing_tsr)):(k.m(Ea),h=k.r(g,c.standing_tsr)),f.orientation&&k.A(f.orientation,h,c.orientation),f.position&&k.D(f.position,h,c.position))}}}};a.attach_param_cb=function(a,b,c){switch(b){case 130:a.orientation_quat_cb_list.push(c);b=141;break;case 140:a.orientation_angles_cb_list.push(c);b=141;break;case 50:a.mouse_down_which_cb_list.push(c);break;case 40:case 41:a.mouse_location_cb_list.push(c);break;case 60:a.mouse_up_which_cb_list.push(c);break;case 70:a.mouse_wheel_cb_list.push(c);
break;case 90:a.keyboard_down_cb_list.push(c);break;case 91:a.keyboard_down_mod_cb_list.push(c);b=90;break;case 80:a.keyboard_up_cb_list.push(c);break;case 100:a.touch_start_cb_list.push(c);break;case 110:a.touch_move_cb_list.push(c);break;case 120:a.touch_end_cb_list.push(c)}if(-1==a.registered_event_listeners.indexOf(b)&&(a.registered_event_listeners.push(b),a.registered))switch(b){case 50:/iPad|iPhone|iPod/.test(navigator.platform)||a.element.addEventListener("mousedown",L,!1);break;case 40:a.element.addEventListener("mousemove",
ha,!1);break;case 41:a.element.addEventListener("mousemove",S,!1);break;case 60:/iPad|iPhone|iPod/.test(navigator.platform)||(a.element!=window&&a.element.addEventListener("mouseout",q,!1),a.element.addEventListener("mouseup",w,!1));break;case 70:a.element.addEventListener("wheel",ea,!1);break;case 90:a.element.addEventListener("keydown",H,!1);break;case 80:a.element.addEventListener("keyup",D,!1);break;case 100:a.element.addEventListener("touchstart",h,!1);break;case 110:a.element.addEventListener("touchmove",
ia,!1);break;case 120:a.element.addEventListener("touchend",ra,!1);break;case 141:a.element.addEventListener("deviceorientation",v,!1)}};a.detach_param_cb=function(a,b,c){K(a,b,c,!1)};a.gyro_angles_to_quat=sa;a.cleanup=function(){for(var a=0;a<ya.length;a++)for(var b=ya[a],c=0;c<b.registered_event_listeners.length;c++)K(b,b.registered_event_listeners[c],null,!0);ya.length=0};a.get_pressed_gmpd_btn=function(a){a=za(a);a=c(a);for(var b=0;b<a.gamepad_btns.length;b++)if(a.gamepad_btns[b])return b+300;
return-1};a.get_moved_gmpd_axis=function(a){a=za(a);a=c(a);for(var b=0;b<a.gamepad_axes.length;b++)if(a.gamepad_prev_axes[b]-a.gamepad_axes[b])return b+326;return-1};a.get_first_gmpd_id=function(){for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],b=0;b<a.length;b++)if(a[b])return b;return 0};a.get_webvr_display=function(){var a=c(20);return a&&a.webvr_display};a.activate_pointerlock=function(a){a.element.addEventListener("mousedown",
function(b){a.value||P(a)},!1)};a.add_click_listener=function(a,b){Ga.is_mobile_device?a.addEventListener("touchend",b):a.addEventListener("mouseup",b)};a.remove_click_listener=function(a,b){Ga.is_mobile_device?a.removeEventListener("touchend",b):a.removeEventListener("mouseup",b)};a.check_fullscreen=oa});t.a=e},function(C,t,e){C=e(0);var R=e(15),V=e(1);e=Object(C.a)("container",function(e,y){var d=Object(R.a)(e),k=Object(V.a)(e);y.get_canvas=d.get_canvas;y.get_canvas_hud=d.get_canvas_hud;y.get_container=
d.get_container;y.insert_to_container=function(e,n){2!=arguments.length?k.error("insert_to_container(): two arguments required"):e&&n&&d.insert_to_container(e,n)};y.set_canvas_offsets=function(e,n){k.error_once("container.set_canvas_offsets() deprecated. Not needed anymore. Use the container.client_to_canvas_coords method.");return d.set_canvas_offsets(e,n)};y.update_canvas_offsets=function(){k.error_once("container.update_canvas_offsets() deprecated. Not needed anymore. Use the container.client_to_canvas_coords method.");
d.update_canvas_offsets()};y.client_to_canvas_coords=function(e,k,n){n||(n=new Float32Array(2));return d.client_to_canvas_coords(e,k,n)};y.client_to_element_coords=function(e,k,n,p){p||(p=new Float32Array(2));return d.client_to_element_coords(e,k,n,p)};y.get_coords_target_space=function(e,k,n){n||(n=new Float32Array(2));return d.get_coords_target_space(e,k,n)};y.force_offsets_updating=function(){k.error_once("container.force_offsets_updating() deprecated. Not needed anymore. Use the container.client_to_canvas_coords method.");
d.force_offsets_updating()};y.resize=function(e,k,n){d.resize(e,k,n)};y.resize_to_container=function(e){d.resize_to_container(e||!1)}});t.a=e},function(C,t,e){C=e(0);var R=e(25),V=e(9),n=e(19),y=e(1),d=e(8),k=e(13),I=e(6),A=e(2),r=e(3);e=Object(C.a)("transform",function(e,u){var a=Object(V.a)(e),p=Object(n.a)(e),l=Object(y.a)(e),c=Object(k.a)(e),m=I.b(),b=r.create(),f=r.create(),T=new Float32Array(4),fa=d.create();u.set_translation=function(f,d,e,k){a.is_dynamic(f)?(b[0]=d,b[1]=e,b[2]=k,c.set_translation(f,
b),c.update_transform(f),p.sync_transform(f)):l.error('Wrong object: "'+f.name+'" is not dynamic.')};u.set_translation_rel=function(f,d,e,k){a.is_dynamic(f)?(b[0]=d,b[1]=e,b[2]=k,c.set_translation_rel(f,b),c.update_transform(f),p.sync_transform(f)):l.error('Wrong object: "'+f.name+'" is not dynamic.')};u.set_translation_v=function(b,f){a.is_dynamic(b)?(c.set_translation(b,f),c.update_transform(b),p.sync_transform(b)):l.error('Wrong object: "'+b.name+'" is not dynamic.')};u.set_translation_rel_v=function(b,
f){a.is_dynamic(b)?(c.set_translation_rel(b,f),c.update_transform(b),p.sync_transform(b)):l.error('Wrong object: "'+b.name+'" is not dynamic.')};u.set_translation_obj_rel=function(d,e,k,m,n){a.is_dynamic(d)?(b[0]=e,b[1]=k,b[2]=m,e=I.j(n.render.world_tsr,f),n=I.g(n.render.world_tsr,fa),A._63(b,1,n,e,b),c.set_translation(d,b),c.update_transform(d),p.sync_transform(d)):l.error('Wrong object: "'+d.name+'" is not dynamic.')};u.get_translation=function(a,b){b||(b=new Float32Array(3));c.get_translation(a,
b);return b};u.get_translation_rel=function(a,b){b||(b=new Float32Array(3));c.get_translation_rel(a,b);return b};u.set_rotation=function(b,f,d,e,k){a.is_dynamic(b)?(T[0]=f,T[1]=d,T[2]=e,T[3]=k,c.set_rotation(b,T),c.update_transform(b),p.sync_transform(b)):l.error('Wrong object: "'+b.name+'" is not dynamic.')};u.set_rotation_rel=function(b,f,d,e,k){a.is_dynamic(b)?(T[0]=f,T[1]=d,T[2]=e,T[3]=k,c.set_rotation_rel(b,T),c.update_transform(b),p.sync_transform(b)):l.error('Wrong object: "'+b.name+'" is not dynamic.')};
u.set_rotation_v=function(b,f){a.is_dynamic(b)?(c.set_rotation(b,f),c.update_transform(b),p.sync_transform(b)):l.error('Wrong object: "'+b.name+'" is not dynamic.')};u.set_rotation_rel_v=function(b,f){a.is_dynamic(b)?(c.set_rotation_rel(b,f),c.update_transform(b),p.sync_transform(b)):l.error('Wrong object: "'+b.name+'" is not dynamic.')};u.get_rotation_rel_v=function(b,f){if(a.is_dynamic(b))return c.get_rotation_rel(b,f),f;l.error('Wrong object: "'+b.name+'" is not dynamic.')};u.get_rotation=function(a,
b){b||(b=new Float32Array(4));c.get_rotation(a,b);return b};u.get_rotation_rel=function(a,b){b||(b=new Float32Array(4));c.get_rotation_rel(a,b);return b};u.set_rotation_euler=function(f,d,e,k){a.is_dynamic(f)?(b[0]=d,b[1]=e,b[2]=k,c.set_rotation_euler(f,b),c.update_transform(f),p.sync_transform(f)):l.error('Wrong object: "'+f.name+'" is not dynamic.')};u.get_rotation_euler=function(a,b){b||(b=new Float32Array(3));c.get_rotation_euler(a,b);return b};u.get_rotation_euler_rel=function(a,b){b||(b=new Float32Array(3));
c.get_rotation_euler_rel(a,b);return b};u.set_rotation_euler_rel=function(f,d,e,k){a.is_dynamic(f)?(b[0]=d,b[1]=e,b[2]=k,c.set_rotation_euler_rel(f,b),c.update_transform(f),p.sync_transform(f)):l.error('Wrong object: "'+f.name+'" is not dynamic.')};u.set_rotation_euler_v=function(b,f){a.is_dynamic(b)?(c.set_rotation_euler(b,f),c.update_transform(b),p.sync_transform(b)):l.error('Wrong object: "'+b.name+'" is not dynamic.')};u.set_rotation_euler_rel_v=function(b,f){a.is_dynamic(b)?(c.set_rotation_euler_rel(b,
f),c.update_transform(b),p.sync_transform(b)):l.error('Wrong object: "'+b.name+'" is not dynamic.')};u.set_scale=function(b,f){a.is_dynamic(b)?(c.set_scale(b,f),c.update_transform(b)):l.error('Wrong object: "'+b.name+'" is not dynamic.')};u.set_scale_rel=function(b,f){a.is_dynamic(b)?(c.set_scale_rel(b,f),c.update_transform(b)):l.error('Wrong object: "'+b.name+'" is not dynamic.')};u.get_scale=function(a,b){return c.get_scale(a,b)};u.get_scale_rel=function(a,b){return c.get_scale_rel(a,b)};u.empty_reset_transform=
function(b){if("EMPTY"!=b.type)l.error("Wrong object: "+b.name);else{for(var f=0;f<b.cons_descends.length;f++)if(!a.is_dynamic(b.cons_descends[f])){l.error('Wrong object: "'+b.cons_descends[f].name+'" is not dynamic.');return}c.set_translation(b,[0,0,0]);c.set_rotation(b,[0,0,0,1]);c.set_scale(b,1);c.update_transform(b);p.sync_transform(b)}};u.get_object_size=function(b){return a.is_mesh(b)?c.get_object_size(b):(l.error("Wrong object: "+b.name),0)};u.get_object_center=function(b,f,d){if(!a.is_mesh(b))return l.error("Wrong object: "+
b.name),null;d||(d=new Float32Array(3));return c.get_object_center(b,f,d)};u.move_local=function(b,f,d,e){a.is_dynamic(b)?(c.move_local(b,f,d,e),c.update_transform(b),p.sync_transform(b)):l.error('Wrong object: "'+b.name+'" is not dynamic.')};u.rotate_x_local=function(b,f){if(a.is_dynamic(b)){var e=d.setAxisAngle(A.d,f,T);c.rotate_local(b,e);c.update_transform(b);p.sync_transform(b)}else l.error('Wrong object: "'+b.name+'" is not dynamic.')};u.rotate_y_local=function(b,f){if(a.is_dynamic(b)){var e=
d.setAxisAngle(A.b,f,T);c.rotate_local(b,e);c.update_transform(b);p.sync_transform(b)}else l.error('Wrong object: "'+b.name+'" is not dynamic.')};u.rotate_z_local=function(b,f){if(a.is_dynamic(b)){var e=d.setAxisAngle(A.f,f,T);c.rotate_local(b,e);c.update_transform(b);p.sync_transform(b)}else l.error('Wrong object: "'+b.name+'" is not dynamic.')};u.get_object_bounding_box=function(a){return R.n(a.render.bb_world)};u.set_tsr=function(b,f){a.is_dynamic(b)?(c.set_tsr(b,f),c.update_transform(b),p.sync_transform(b)):
l.error('Wrong object: "'+b.name+'" is not dynamic.')};u.set_tsr_rel=function(b,f){a.is_dynamic(b)?(c.set_tsr_rel(b,f),c.update_transform(b),p.sync_transform(b)):l.error('Wrong object: "'+b.name+'" is not dynamic.')};u.get_tsr=function(a,b){b||(b=I.b());c.get_tsr(a,b);return b};u.get_tsr_rel=function(a,b){b||(b=I.b());c.get_tsr_rel(a,b);return b};u.distance=function(a,b){return c.distance(a,b)};u.set_matrix=function(b,f){a.is_dynamic(b)?(I.d(f,m),c.set_tsr(b,m),c.update_transform(b),p.sync_transform(b)):
l.error('Wrong object: "'+b.name+'" is not dynamic.')};u.set_matrix_rel=function(b,f){a.is_dynamic(b)?(I.d(f,m),c.set_tsr_rel(b,m),c.update_transform(b),p.sync_transform(b)):l.error('Wrong object: "'+b.name+'" is not dynamic.')};u.get_matrix=function(a,b){b||(b=new Float32Array(16));c.get_tsr(a,m);I.x(m,b);return b};u.get_matrix_rel=function(a,b){b||(b=new Float32Array(16));c.get_tsr_rel(a,m);I.x(m,b);return b}});t.a=e},function(C,t,e){function R(a,c){for(var d=a[1],b=1,f=2;f<a.length;f++)4!=f&&8!=
f&&Math.abs(a[f])>Math.abs(d)&&(d=a[f],b=f);for(var l=Math.floor(b/3),b=b%3,d=.5*Math.atan(2*d/(a[3*l+l]-a[3*b+b])),f=0;f<c.length;f++)c[f]=0==f||4==f||8==f?1:0;c[b+3*l]=-Math.sin(d);c[l+3*b]=Math.sin(d);c[l+3*l]=Math.cos(d);c[b+3*b]=Math.cos(d);return c}function V(a){return Math.sqrt(a[1]*a[1]+a[2]*a[2]+a[5]*a[5])}function n(a,c){for(var d=a.content[c];0<c;){var b=(c+1>>1)-1,f=a.content[b];if(a.score_function(d)<a.score_function(f))a.content[b]=d,a.content[c]=f,c=b;else break}}function y(a,c,e,b){return e-
d(b-a,0,e,b)+c}function d(a,c,d,b){return(a/=b)<1/2.75?7.5625*d*a*a+c:a<2/2.75?d*(7.5625*(a-=1.5/2.75)*a+.75)+c:a<2.5/2.75?d*(7.5625*(a-=2.25/2.75)*a+.9375)+c:d*(7.5625*(a-=2.625/2.75)*a+.984375)+c}t.M=function(a,c){c=c||new Float32Array(3);c[0]=a[3];c[1]=a[4];c[2]=a[5];return c};t.N=function(a,c){c=c||new Float32Array(3);return I.copy(a,c)};t.R=function(a,c){I.copy(c,a)};t.Q=function(a,c){I.normalize(c,A);a[3]=A[0];a[4]=A[1];a[5]=A[2]};t.f=function(a,c,d){d=d||new Float32Array(3);d[0]=a[0]+a[3]*
c;d[1]=a[1]+a[4]*c;d[2]=a[2]+a[5]*c;return d};t.g=function(a,c){c[0]=0;c[1]=0;for(var d=c[2]=0;d<a.length;d+=3)c[0]+=a[d],c[1]+=a[d+1],c[2]+=a[d+2];return I.scale(c,3/a.length,c)};t.e=function(a,c,d){for(var b=0;b<d.length;b++)d[b]=0;for(b=0;b<a.length;b+=3){var f=a[b]-c[0],l=a[b+1]-c[1],e=a[b+2]-c[2];d[0]+=f*f;d[1]+=f*l;d[2]+=f*e;d[4]+=l*l;d[5]+=l*e;d[8]+=e*e}d[3]=d[1];d[6]=d[2];d[7]=d[5];for(b=0;b<d.length;b++)d[b]*=3/a.length;return d};t.L=function(d,c,e){d=k.copy(d,r);if(V(d)<c)return k.identity(e);
var b=R(d,p),f=k.transpose(b,u);k.multiply(d,f,a);k.multiply(b,a,d);e=k.copy(b,e);for(var l=1;c<=V(d)&&l<B;)b=R(d,p),f=k.transpose(b,u),k.multiply(d,f,a),k.multiply(b,a,d),k.multiply(b,e,e),l++;return e};t.P=function(a,c){return c[0]*a[0]+c[1]*a[1]+c[2]*a[2]+c[3]};t.a=function(a){return{content:[],score_function:a}};t.c=function(a,c){a.content.push(c);n(a,a.content.length-1)};t.b=function(a){var c=a.content[0],d=a.content.pop();if(0<a.content.length){a.content[0]=d;for(var d=0,b=a.content.length,
f=a.content[d],l=a.score_function(f);;){var e=d+1<<1,k=e-1,p=null;if(k<b){var n=a.score_function(a.content[k]);n<l&&(p=k)}e<b&&a.score_function(a.content[e])<(null===p?l:n)&&(p=e);if(null!==p)a.content[d]=a.content[p],a.content[p]=f,d=p;else break}}return c};t.d=function(a,c){n(a,a.content.indexOf(c))};t.O=function(a,c,d,b){return d*a/b+c};t.x=function(a,c,d,b){return d*(a/=b)*a+c};t.H=function(a,c,d,b){return-d*(a/=b)*(a-2)+c};t.t=function(a,c,d,b){return 1>(a/=b/2)?d/2*a*a+c:-d/2*(--a*(a-2)-1)+
c};t.k=function(a,c,d,b){return d*(a/=b)*a*a+c};t.E=function(a,c,d,b){return d*((a=a/b-1)*a*a+1)+c};t.q=function(a,c,d,b){return 1>(a/=b/2)?d/2*a*a*a+c:d/2*((a-=2)*a*a+2)+c};t.y=function(a,c,d,b){return d*(a/=b)*a*a*a+c};t.I=function(a,c,d,b){return-d*((a=a/b-1)*a*a*a-1)+c};t.u=function(a,c,d,b){return 1>(a/=b/2)?d/2*a*a*a*a+c:-d/2*((a-=2)*a*a*a-2)+c};t.z=function(a,c,d,b){return d*(a/=b)*a*a*a*a+c};t.J=function(a,c,d,b){return d*((a=a/b-1)*a*a*a*a+1)+c};t.v=function(a,c,d,b){return 1>(a/=b/2)?d/
2*a*a*a*a*a+c:d/2*((a-=2)*a*a*a*a+2)+c};t.A=function(a,c,d,b){return-d*Math.cos(a/b*(Math.PI/2))+d+c};t.K=function(a,c,d,b){return d*Math.sin(a/b*(Math.PI/2))+c};t.w=function(a,c,d,b){return-d/2*(Math.cos(Math.PI*a/b)-1)+c};t.m=function(a,c,d,b){return 0==a?c:d*Math.pow(2,10*(a/b-1))+c};t.G=function(a,c,d,b){return a==b?c+d:d*(-Math.pow(2,-10*a/b)+1)+c};t.s=function(a,c,d,b){return 0==a?c:a==b?c+d:1>(a/=b/2)?d/2*Math.pow(2,10*(a-1))+c:d/2*(-Math.pow(2,-10*--a)+2)+c};t.j=function(a,c,d,b){return-d*
(Math.sqrt(1-(a/=b)*a)-1)+c};t.D=function(a,c,d,b){return d*Math.sqrt(1-(a=a/b-1)*a)+c};t.p=function(a,c,d,b){return 1>(a/=b/2)?-d/2*(Math.sqrt(1-a*a)-1)+c:d/2*(Math.sqrt(1-(a-=2)*a)+1)+c};t.l=function(a,c,d,b){var f=0,e=d;if(0==a)return c;if(1==(a/=b))return c+d;f||(f=.3*b);e<Math.abs(d)?(e=d,d=f/4):d=f/(2*Math.PI)*Math.asin(d/e);return-(e*Math.pow(2,10*--a)*Math.sin(2*(a*b-d)*Math.PI/f))+c};t.F=function(a,c,d,b){var f,e=0,l=d;if(0==a)return c;if(1==(a/=b))return c+d;e||(e=.3*b);l<Math.abs(d)?(l=
d,f=e/4):f=e/(2*Math.PI)*Math.asin(d/l);return l*Math.pow(2,-10*a)*Math.sin(2*(a*b-f)*Math.PI/e)+d+c};t.r=function(a,c,d,b){var f,e=0,l=d;if(0==a)return c;if(2==(a/=b/2))return c+d;e||(e=.3*b*1.5);l<Math.abs(d)?(l=d,f=e/4):f=e/(2*Math.PI)*Math.asin(d/l);return 1>a?-.5*l*Math.pow(2,10*--a)*Math.sin(2*(a*b-f)*Math.PI/e)+c:l*Math.pow(2,-10*--a)*Math.sin(2*(a*b-f)*Math.PI/e)*.5+d+c};t.h=function(a,c,d,b,f){void 0==f&&(f=1.70158);return d*(a/=b)*a*((f+1)*a-f)+c};t.B=function(a,c,d,b,f){void 0==f&&(f=1.70158);
return d*((a=a/b-1)*a*((f+1)*a+f)+1)+c};t.n=function(a,c,d,b,f){void 0==f&&(f=1.70158);return 1>(a/=b/2)?d/2*a*a*(((f*=1.525)+1)*a-f)+c:d/2*((a-=2)*a*(((f*=1.525)+1)*a+f)+2)+c};t.i=y;t.C=d;t.o=function(a,c,e,b){return a<b/2?.5*y(2*a,0,e,b)+c:.5*d(2*a-b,0,e,b)+.5*e+c};var k=e(27),I=e(3),A=new Float32Array(3),r=new Float32Array(9),p=new Float32Array(9),u=new Float32Array(9),a=new Float32Array(9),B=100},function(C,t,e){C=e(0);var R=e(55),V=e(38),n=e(5),y=e(44),d=e(16),k=e(4),I=e(58),A=e(53),r=e(70),
p=e(46),u=e(28),a=e(30),B=e(39),l=e(65),c=e(74),m=e(94),b=e(52),f=e(59),T=e(47),fa=e(61),z=e(12),G=e(9),E=e(19),J=e(1),M=e(8),F=e(95),U=e(22),K=e(10),sa=e(23),v=e(34),Y=e(11),ha=e(36),S=e(17),L=e(18),q=e(13),w=e(6),ea=e(2),H=e(3),D=e(7),h=e(48);e=Object(C.a)("__data",function(e,ra){function ia(a,b){vc[b.id]=null;mc[b.id]=null}function t(a,b,c,g){a instanceof ArrayBuffer&&(a=gc.get_width_height(a,g));g=a.width;a=a.height;bb.log("%cLOAD IMAGE "+g+"x"+a,"color: #"+(2048<g||2048<a?"a00":1024<g||1024<
a?"aa0":"0a0"),b);-1==b.indexOf(kc)&&c&&bb.warn("image",b,"is not from app root.")}function C(a,b,c,g,h,d){var f=b.filepath;f||yb.panic("Nothing requested");var e=function(g,d,k,m){if(g){bb.log("%cLOAD METADATA","color: #616",m);d=ea._58(g.b4w_format_version);switch(ea._70(d,cb.min_format_version)){case -1:d[0]<cb.min_format_version[0]?yb.panic("JSON version is too old relative to B4W engine: "+ea._71(d)+", required: "+ea._71(cb.min_format_version)+". Reexport scene with the latest B4W addon to fix it."):
bb.warn("JSON version is a bit old relative to B4W engine: "+ea._71(d)+", required: "+ea._71(cb.min_format_version)+". Some compatibility issues can occur. Reexport scene with the latest B4W addon to fix it.");break;case 1:d[0]>cb.min_format_version[0]?yb.panic("B4W engine version is too old relative to JSON. Can't load the scene. Update your engine version to fix it."):bb.error("B4W engine version is a bit old relative to JSON. Some compatibility issues can occur. Update your engine version to fix it.")}cb.loaded_data_version=
d;for(var q in g)a[q]=g[q];b.is_primary&&(zb=jb.find_main_scene(a.scenes));(g=a.binaries[0].binfile)?b.binary_name=g:(Za.skip_stage_by_name(b,"load_binaries"),Za.skip_stage_by_name(b,"prepare_bindata"));cb.is_mobile_device||Za.skip_stage_by_name(b,"mobile_media_start");cb.antialiasing&&cb.smaa||Za.skip_stage_by_name(b,"load_smaa_textures");if(a.b4w_export_errors)for(g=0;g<a.b4w_export_errors.length;g++)q=a.b4w_export_errors[g],(b.is_primary&&"PRIMARY"==q.type||"ALL"==q.type)&&bb.export_error(q.text+
" See more details in https://www.blend4web.com/doc/en/addon.html#non-critical-export-errors");if(a.b4w_export_warnings)for(g=0;g<a.b4w_export_warnings.length;g++)q=a.b4w_export_warnings[g],(b.is_primary&&"PRIMARY"==q.type||"ALL"==q.type)&&bb.export_warn(q.text+" See more details in https://www.blend4web.com/doc/en/addon.html#other-messages");b.is_preloading&&xa(a);h(b,c)}else k==N.AT_JSON_ZIP?(bb.warn("Compressed file ",m,"not found or invalid. Trying to load non-compressed",f),N.enqueue([{id:f,
type:N.AT_JSON,url:f,is_fetch:b.is_preloading}],e,null,l)):Za.abort_thread(b)},l=function(a){d(b,c,a)};if(cb.assets_gzip_available){g=f+".gz";var k=N.AT_JSON_ZIP}else g=f,k=N.AT_JSON;N.enqueue([{id:g,type:k,url:g,is_fetch:b.is_preloading}],e,null,l)}function Q(a,b,c,g,h,d){var f=mb(b.filepath)+b.binary_name;f||yb.panic("Binary data is missing");var e=function(g,d,k,m){g?(bb.log("%cLOAD BINARY","color: #616",m),a.bin_data=g,d=(new Uint32Array(g,4,1))[0],g=(new Uint32Array(g,8,1))[0],g=[d,g],d=ea._58(a.b4w_format_version),
g[0]!=d[0]&&yb.panic("BIN version does not match to JSON version: "+ea._71(g)+", required: "+ea._71(cb.min_format_version)+". Couldn't load the scene. Reexport scene to fix it."),g[1]!=d[1]&&bb.warn("BIN version does not match to JSON version: "+ +ea._71(g)+", required: "+ea._71(cb.min_format_version)+". Some compatibility issues can occur. Reexport scene to fix it."),h(b,c)):k==N.AT_ARRAYBUFFER_ZIP?(bb.warn("Compressed file ",m,"not found or invalid. Trying to load non-compressed",f),N.enqueue([{id:f,
type:N.AT_ARRAYBUFFER,url:f,is_fetch:b.is_preloading}],e,null,l)):Za.abort_thread(b)},l=function(a){d(b,c,a)};if(cb.assets_gzip_available){g=f+".gz";var k=N.AT_ARRAYBUFFER_ZIP}else g=f,k=N.AT_ARRAYBUFFER;N.enqueue([{id:g,type:k,url:g,is_fetch:b.is_preloading}],e,null,l)}function da(a,b,c,g,h,d){dc.check_shaders_loaded()&&h(b,c)}function ja(a,b,c,g,h,d){g=a.bin_data;d=a.binaries[0];var f=a.objects,e=a.meshes;a=a.actions;for(var l=ea.K(),k=["indices"],m=["position","texcoord","texcoord2","shade_tangs"],
q=["normal","tangent"],p=["group"],w=["color"],n=0;n<e.length;n++)for(var r=e[n].submeshes,v=0;v<r.length;v++){for(var z in r[v]){var u=r[v][z][1];if(-1!=k.indexOf(z)){var E=r[v][z][0]*ea.i+d["int"]+12,B=r[v],G=z,y=g;if(l)var A=new Uint32Array(y,E,u);else for(var A=new Uint32Array(u),y=new DataView(y),L=0;L<u;L++)A[L]=y.getUint32(E+L*ea.i,!0);B[G]=A}else if(-1!=m.indexOf(z))E=r[v][z][0]*ea.h+d["float"]+12,r[v][z]=va(g,E,u,l);else if(-1!=q.indexOf(z)){E=r[v][z][0]*ea.l+d["short"]+12;B=r[v];G=z;y=g;
A=new Float32Array(u);y=new DataView(y);for(L=0;L<u;L++)A[L]=y.getInt16(E+L*ea.l,!0)/32767;B[G]=A}else if(-1!=p.indexOf(z)){E=r[v][z][0]*ea.l+d.ushort+12;B=r[v];G=z;y=g;A=new Float32Array(u);y=new DataView(y);for(L=0;L<u;L++)A[L]=y.getUint16(E+L*ea.l,!0)/65535;B[G]=A}else if(-1!=w.indexOf(z)){E=r[v][z][0]*ea.g+d.uchar+12;B=r[v];G=z;y=g;A=new Float32Array(u);y=new DataView(y);for(L=0;L<u;L++)A[L]=y.getUint8(E+L*ea.g)/255;B[G]=A}}u=r[v];if(e[n].b4w_shape_keys.length)for(E=u.base_length,B=u.normal.length/
E/3,G=u.normal.length/3,u.tbn=ha.d(u.normal.subarray(0,3*E),u.tangent.subarray(0,4*E),ha.c(G)),G=1;G<B;G++)for(y=G*E,A=0;A<E;A++){var S=u.normal.subarray(3*A,3*(A+1)),J=H.add(u.normal.subarray(3*(y+A),3*(y+A+1)),S,Vc),L=ha.i(Kc);if(u.tangent.length){var ia=u.tangent.subarray(4*A,4*(A+1)),T=D.add(u.tangent.subarray(4*(y+A),4*(y+A+1)),ia,gd),S=ha.d(S,ia),J=ha.d(J,T);ha.l(J,S,L)}else J=M.rotationTo(S,J,lc),ha.o(L,J,0);ha.n(u.tbn,L,y+A)}else u.tbn=ha.d(u.normal,u.tangent);delete r[v].normal;delete r[v].tangent;
"texcoord2"in r[v]&&(u=new Float32Array(r[v].texcoord.length+r[v].texcoord2.length),u.set(r[v].texcoord),u.set(r[v].texcoord2,r[v].texcoord.length),r[v].texcoord=u,delete r[v].texcoord2)}for(z=0;z<f.length;z++)for(e=f[z].particle_systems,k=0;k<e.length;k++)m=e[k],m.transforms=va(g,m.transforms[0]*ea.h+d["float"]+12,m.transforms[1],l);for(f=0;f<a.length;f++){z=a[f];e=z.fcurves;k=z.frame_range;q=k[0];p=k[1];w=Ra.get_approx_curve_length(q,p);k=null;0>w&&(w=0);var r=n=!1,ma;for(ma in e)n|=-1<ma.indexOf("rotation_euler"),
r|=-1<ma.indexOf("rotation_quaternion");m=[];for(ma in e)if(n&&r&&-1<ma.indexOf("rotation_euler"))delete e[ma];else{var v=e[ma],F;for(F in v)u=v[F],E=va(g,d["float"]+u.bin_data_pos[0]*ea.h+12,u.bin_data_pos[1],l),B=new Float32Array(w),null===k&&(k=new Int8Array(w)),Ra.approximate_curve(u,E,B,k,q,p),u._pierced_points=B;-1<ma.indexOf("rotation_euler")&&(Ra.fcurve_replace_euler_by_quat(e[ma]),m.push(ma))}for(q=0;q<m.length;q++)p=m[q],w=p.replace("euler","quaternion"),e[w]=e[p],delete e[p];z._bflags=
k}h(b,c)}function va(a,b,c,g){if(g)g=new Float32Array(a,b,c);else{g=new Float32Array(c);a=new DataView(a);for(var h=0;h<c;h++)g[h]=a.getFloat32(b+h*ea.h,!0)}return g}function Ga(a,b,g,h,d,f){var e=a.cameras,l=a.groups,k=a.materials,m=a.meshes,q=a.node_groups,D=a.objects,p=a.particles,w=a.scenes,n=a.speakers,r=a.lamps,v=a.textures,z=a.worlds;q||(bb.warn('"node_groups" datablock undefined. reexport main scene.'),q=a.node_groups=[]);for(var u="actions armatures cameras curves groups images lamps materials meshes node_groups objects particles scenes sounds speakers textures worlds".split(" "),
E={},H=0;H<u.length;H++)for(var B=a[u[H]],G=0;G<B.length;G++){var y=B[G];E[y.uuid]=y}for(var A=0;A<w.length;A++){for(var L=w[A],S=L.objects,J=0;J<S.length;J++)Ja(S,J,E);L.camera&&Ja(L,"camera",E);L.world&&Ja(L,"world",E)}for(A=0;A<l.length;A++)for(var ia=l[A].objects,J=0;J<ia.length;J++)Ja(ia,J,E);for(A=0;A<D.length;A++){var T=D[A];T.dupli_group&&Ja(T,"dupli_group",E);T.parent&&Ja(T,"parent",E);T.dg_parent&&Ja(T,"dg_parent",E);var ma=T.animation_data;ma&&qa(ma,E);switch(T.type){case "MESH":T.data||
yb.panic("mesh not found for object "+T.name);Ja(T,"data",E);for(var F=!1,ra=T.modifiers,J=0;J<ra.length;J++){var M=ra[J];"ARMATURE"==M.type?(F&&bb.warn('Object "'+T.name+'" has more than one armature modifiers. Only the first one will be used.'),F=!0,Ja(M,"object",E)):"CURVE"==M.type&&Ja(M,"object",E)}var t=T.particle_systems;if(t)for(J=0;J<t.length;J++)Ja(t[J],"settings",E);break;case "ARMATURE":Ja(T,"data",E);for(var X=T.pose.bones,fa=T.data.bones,J=0;J<X.length;J++){var Y=X[J];Y.bone=fa[Y.bone];
var K=Y.constraints;if(K)for(var P=0;P<K.length;P++){var da=K[P];da.target&&Ja(da,"target",E)}for(var N=Y.parent_recursive,P=0;P<N.length;P++)N[P]=X[N[P]]}break;case "LAMP":case "CAMERA":case "SPEAKER":case "CURVE":Ja(T,"data",E)}if(K=T.constraints)for(J=0;J<K.length;J++)da=K[J],da.target&&Ja(da,"target",E);var ha=T.lod_levels;if(ha)for(J=0;J<ha.length;J++){var U=ha[J];U.object&&Ja(U,"object",E)}}for(A=0;A<m.length;A++)for(var I=m[A].materials,J=0;J<I.length;J++)Ja(I,J,E);for(A=0;A<k.length;A++){for(var ba=
k[A],Fb=ba.texture_slots,J=0;J<Fb.length;J++)Ja(Fb[J],"texture",E);var za=ba.node_tree;za&&na(za,E)}for(A=0;A<q.length;A++)(za=q[A].node_tree)&&na(za,E);for(A=0;A<v.length;A++){var W=v[A],la=W.type;"IMAGE"!=la&&"ENVIRONMENT_MAP"!=la||Ja(W,"image",E)}for(A=0;A<e.length;A++){var Ga=e[A];Ga.dof_object&&Ja(Ga,"dof_object",E)}for(A=0;A<n.length;A++){var O=n[A];O.sound&&Ja(O,"sound",E);(ma=O.animation_data)&&qa(ma,E)}for(A=0;A<p.length;A++){for(var ja=p[A],Fb=ja.texture_slots,J=0;J<Fb.length;J++)Ja(Fb[J],
"texture",E);ja.dupli_group&&Ja(ja,"dupli_group",E);ja.dupli_object&&Ja(ja,"dupli_object",E)}for(A=0;A<r.length;A++)(ma=r[A].animation_data)&&qa(ma,E);for(A=0;A<z.length;A++){var La=z[A];if(Fb=La.texture_slots)for(J=0;J<Fb.length;J++)Ja(Fb[J],"texture",E);(ma=La.animation_data)&&qa(ma,E);(za=La.node_tree)&&na(za,E)}Wc.check_bpy_data(a);xa(a);for(var Q=mb(b.filepath),Ka=a.textures,R=b.is_primary?a.scenes[0].b4w_anisotropic_filtering:zb.b4w_anisotropic_filtering,Sa=0;Sa<Ka.length;Sa++){var C=Ka[Sa];
b.is_primary||"SCENE"!=C.b4w_source_type||(C.b4w_source_id="");var sa=eb.create_texture_bpy(C,R,a.scenes,b.id,Q);C._render=sa}for(var oa={},va=a.objects,ib=0;ib<va.length;ib++){var ua=va[ib];if("MESH"===ua.type&&!ua.particle_systems.length)for(var V=ua.data,Xa=V.name,fb=V.submeshes,Z=V.materials,Pa=0;Pa<fb.length;Pa++)0!==fb[Pa].base_length||oa[Xa]||(Z[Pa]&&bb.warn('material "'+Z[Pa].name+'" is not assigned to any face (object "'+ua.name+'").'),oa[Xa]=!0)}var Ca=[];a.materials=[];for(var Ma=a.meshes,
Wa=0;Wa<Ma.length;Wa++){var Dc=Ma[Wa];if(0==Dc.materials.length){var ga=c.b();Dc.materials.push(ga);-1==Ca.indexOf(ga.uuid)&&(Ca.push(ga.uuid),a.materials.push(ga))}else for(var rc=0;rc<Dc.materials.length;rc++){var Ya=Dc.materials[rc],zc=c.c();c.d(Ya,zc);Dc.materials[rc]=zc;-1==Ca.indexOf(zc.uuid)&&(Ca.push(zc.uuid),a.materials.push(zc))}}for(var Aa=a.actions,Ia=b.id,Da=0;Da<Aa.length;Da++){var jc=Aa[Da];jc._data_id=Ia;Ra.append_action(jc)}for(var Ba={lod_parents:[],lod_levels_data:[]},Qa=a.scenes,
Db=0;Db<Qa.length;Db++)for(var cd=Qa[Db],Oa=Qa[Db].objects,sb=0;sb<Oa.length;sb++)Ua(cd,Oa,Oa[sb],null,Ba);for(Db=0;Db<Ba.lod_levels_data.length;Db++)for(var sc=Ba.lod_levels_data[Db],sb=0;sb<sc.old_lods.length;sb++){var Mb=sc.old_lods[sb],Ac=sc.new_lods[sb],ya=sc.scene_arrays[sb],Va=sc.objs_container_arrays[sb];sc.lod_levels[sb].object=Ac;for(var wa=0;wa<Va.length;wa++)ea.C(Va[wa],Ac);for(var Ta=Mb,fd=ya,Vb=0;Vb<fd.length;Vb++){for(var Ha=fd[Vb].objects,Wb=0;Wb<Ha.length;Wb++){var $a=Ha[Wb].dupli_group;
$a&&Na(Ta,$a)}var qb=Ha.indexOf(Ta);-1<qb&&Ha.splice(qb,1)}}!b.is_primary&&1<a.scenes.length&&(a.scenes=[jb.find_main_scene(a.scenes)],bb.warn("loading data contains multiple scenes.","Only the first one will be loaded."));var ob=b.is_primary?zb:jb.find_main_scene(a.scenes);fc.set_framerate(zb.fps);if(1<a.scenes.length){var Fa=a.scenes.indexOf(zb);a.scenes.splice(Fa,1);a.scenes.unshift(zb)}for(var rb=0;rb<a.scenes.length;rb++){var gc=a.scenes[rb];gc._render=jb.create_scene_render();gc._is_main=gc==
ob;gc._is_primary_thread=b.is_primary;var wb;if(wb=nb.enabled){var gb;if(gb="OFF"!=gc.b4w_enable_physics){var Za;if(!(Za="AUTO"!=gc.b4w_enable_physics))a:{for(var vb=ta(gc,"ALL"),Eb=0;Eb<vb.length;Eb++){if(vb[Eb].b4w_collision){Za=!0;break a}var db=vb[Eb].data;if(db.materials)for(var Bb=0;Bb<db.materials.length;Bb++)if(db.materials[Bb].physics_settings.use_coll_physics){Za=!0;break a}}Za=!1}gb=Za}wb=gb}wb&&(b.is_primary||!aa.scene_has_physics(zb)&&gc==jb.find_main_scene(a))&&aa.init_scene_physics(gc)}for(var cb=
0;cb<a.scenes.length;cb++){var lc=a.scenes[cb];if(lc.b4w_use_logic_editor){var Cb=ta(lc,"ALL");Wc.assign_logic_nodes_object_params(Cb,lc.world,lc)}}for(var tb=0;tb<a.scenes.length;tb++){for(var Nb=a.scenes[tb],Tb=ta(Nb,"ALL"),Rb=0;Rb<Tb.length;Rb++){var xb=Tb[Rb];pb.check_bpy_obj_scene_compatibility(xb,Nb,a)&&(xb._scenes||(xb._scenes=[]),xb._scenes.push(b.is_primary?Nb:zb))}for(var Zb=Tb,dc=0;dc<Zb.length;dc++){var Sb=Zb[dc];if(Sb._scenes&&"WORLD"!=Sb.type)for(var Vc=Sb.particle_systems,nc=0;nc<Vc.length;nc++){var qc=
Vc[nc].settings;if("HAIR"==qc.type)if("OBJECT"==qc.render_type){var kc=qc.dupli_object;kc._scenes||(kc._scenes=Sb._scenes.slice())}else if("GROUP"==qc.render_type)for(var Bc=qc.dupli_group,Be=0;Be<Bc.objects.length;Be++)kc=Bc.objects[Be],kc._scenes||(kc._scenes=Sb._scenes.slice())}}}for(var Ne=a.scenes,Ib=[],uc=0;uc<Ne.length;uc++)pa(Ne[uc].objects,0,b.is_primary,Ib);mc[b.id]=[];for(uc=0;uc<Ib.length;uc++)for(var gd=Ib[uc],vc=0;vc<gd.length;vc++)for(var Xc=gd[vc],Kc=0;Kc<Xc.length;Kc++)mc[b.id].push(Xc[Kc]);
for(var bd=a.particles,uc=0;uc<bd.length;uc++){var Td=bd[uc].dupli_object;Td&&(Td._is_hair_dupli=!0,mc[b.id].push(Td));var de=bd[uc].dupli_group;if(de)for(var Ce=de.objects,vc=0;vc<Ce.length;vc++)Td=Ce[vc],Td._is_hair_dupli=!0,mc[b.id].push(Td)}for(var Ic=mc[b.id],uc=Ic.length-1;0<=uc;uc--)Ic[uc]._scenes||Ic.splice(uc,1);for(var pd=mc[b.id],tb=0;tb<pd.length;tb++){xb=pd[tb];!b.is_primary&&xb.parent&&-1<Ec.indexOf(xb.parent.type)&&(xb.parent="");if("MESH"==xb.type){var re=Wc.apply_mesh_modifiers(xb);
re&&(a.meshes.push(re),xb.data=re)}xb._def_action_slots=pb.get_bpy_def_action_slots(xb,!1);xb._is_dynamic=pb.bpy_obj_is_dynamic(xb)}for(tb=0;tb<pd.length;tb++){for(var xb=pd[tb],De=xb._is_dynamic,Rb=0;Rb<xb.lod_levels.length;Rb++){var ee=xb.lod_levels[Rb].object;ee&&(De=De||ee._is_dynamic)}if(De)for(xb._is_dynamic=!0,Rb=0;Rb<xb.lod_levels.length;Rb++)if(ee=xb.lod_levels[Rb].object)ee._is_dynamic=!0}for(var x=0;x<a.scenes.length;x++){var Ud=a.scenes[x],Jc=Ud.world;Jc._scenes||(Jc._scenes=[]);Jc._scenes.push(b.is_primary?
Ud:zb)}for(var Vd=[],x=0;x<a.worlds.length;x++)Jc=a.worlds[x],Jc._scenes?(Jc._def_action_slots=pb.get_bpy_def_action_slots(Jc,!0),Jc._is_dynamic=pb.bpy_obj_is_dynamic(Jc)):Vd.push(Jc);for(x=0;x<Vd.length;x++){var Jc=Vd[x],Ee=a.worlds.indexOf(Jc);a.worlds.splice(Ee,1)}for(var ca=a.node_groups,fe=a.materials,yc=0;yc<ca.length;yc++){var se=ca[yc].node_tree;if(se){var Fe=[];Ea(se,Fe,!0);se._bsdf_types=Fe}}for(yc=0;yc<fe.length;yc++)if(se=fe[yc].node_tree)Fe=[],Ea(se,Fe,!1),se._bsdf_types=Fe;for(var Re=
0;Re<a.scenes.length;Re++){var Ze=a.scenes[Re],Se=b.is_primary?Ze:zb;ka(b.id,Se,"SPEAKER").length&&!Se._sfx&&Ub.attach_scene_sfx(Se)}d(b,g)}function ba(a,b,c,g,d,f){g=mb(b.filepath);f=[];for(var e=[],l=0;l<a.speakers.length;l++){var k=a.speakers[l],m=k.sound.uuid;if(-1==e.indexOf(m)){e.push(m);switch(k.b4w_behavior){case "POSITIONAL":case "BACKGROUND_SOUND":var q=N.AT_AUDIOBUFFER;break;case "BACKGROUND_MUSIC":q=N.AT_AUDIO_ELEMENT}k=Object(h.b)(g+k.sound.filepath);fb(f,m,q,k,b.is_preloading)}}f.length?
N.enqueue(f,function(){},function(){d(b,c)}):d(b,c)}function Ea(a,b,c){a=a.nodes;for(var g=0;g<a.length;g++){var h=a[g],d=h.type;if("GROUP"==d&&h.node_group){if(h=h.node_group.node_tree)if(c)Ea(h,b,!0);else for(h=h._bsdf_types,d=0;d<h.length;d++){var f=h[d];-1==b.indexOf(f)&&b.push(f)}}else-1!=bd.indexOf(d)&&-1==b.indexOf(d)&&b.push(d)}}function ta(a,b){b||(b="ALL");var c=[];-1==a.objects.indexOf(a.camera)&&a.objects.push(a.camera);X(a.objects,b,c);return c}function X(a,b,c){for(var g=0;g<a.length;g++){var h=
a[g];"ALL"!=b&&b!=h.type||c.push(h);(h=h.dupli_group)&&X(h.objects,b,c)}}function pa(a,b,c,g){g[b]=g[b]||[];for(var h=g[b],d=0;d<a.length;d++){var f=a[d],e=ib(f);h[e]=h[e]||[];(c||-1==Ec.indexOf(f.type))&&-1==h[e].indexOf(f)&&h[e].push(f);(f=f.dupli_group)&&pa(f.objects,b+1,c,g)}}function ka(a,b,c){var g=[];a=mc[a];for(var h=0;h<a.length;h++){var d=a[h];if(d.type==c||"ALL"==c)for(var f=0;f<d._scenes.length;f++)b==d._scenes[f]&&g.push(d)}return g}function Ca(a,b,c,g,h,d){d=mc[b.id];for(var f=0;f<d.length;f++){var e=
pb.create_object_from_bpy(d[f]);e.render.data_id=b.id}for(var l=a.worlds,f=0;f<l.length;f++)pb.create_object_from_bpy(l[f],!0);g=pb.get_all_objects("ALL",b.id);for(f=0;f<d.length;f++){var k=d[f],e=k._object;Eb.update_object(k,e)}for(f=0;f<l.length;f++)e=l[f],Eb.update_object(e,e._object);b.is_primary&&Ma(a,b.id);for(f=0;f<d.length;f++)k=d[f],e=k._object,e.is_hair_dupli||(Pa.prepare_object_relations(k,e),pb.update_object_relations(k,e),Bc.update_transform(e)),"MESH"==e.type&&pb.generate_mesh_render_boundings(k,
e);for(a=0;a<d.length;a++){var m=d[a],l=m._object,f=l.render;if(Fa.is_mesh(l)||Fa.is_empty(l)){var q=m.lod_levels.length;if(q){for(var l=[m],e=[0],D=Infinity,k=0;k<q;k++){var p=m.lod_levels[k].object,n=m.lod_levels[k].distance;if(!p){D=n;break}l.push(p);e.push(n)}e.push(D);for(k=0;k<l.length;k++)p=l[k],m=p._object.render,m.is_lod=!0,"DYNAMIC"==f.type&&0<k&&H.subtract(f.bs_world.center,m.bs_world.center,m.main_lod_offset),m.lod_dist_min=e[k],m.lod_dist_max=e[k+1],q=e[k+1]-e[k],D=k==l.length-1?Infinity:
e[k+2]-e[k+1],m.lod_lower_border_range=Math.min(0==k?0:e[k]-e[k-1],q),m.lod_upper_border_range=Math.min(q,D)}}}for(d=0;d<g.length;d++)if(a=g[d],"MESH"==a.type&&(f=a.armobj)){var f=f.render,l=a.render.bone_skinning_info,e=[],r;for(r in l)k=l[r],e.push(4*k.deform_bone_index,4*k.bone_index);f.mesh_to_arm_bone_maps.push(e);f.skinned_renders.push(a.render)}d=r=-1;a=Ra.get_max_bones();for(f=0;f<g.length;f++)l=g[f],e=l.render,Fa.is_mesh(l)&&e.is_skinning&&(l=e.max_bones,l>r&&(r=l),a>=l&&l>d&&(d=l));for(f=
0;f<g.length;f++)l=g[f],e=l.render,Fa.is_mesh(l)&&e.is_skinning&&(e.frames_blending=!0,r<a?e.max_bones=r:e.max_bones<=a?e.max_bones=d:(bb.warn('too many bones for "'+l.name+'" / '+e.max_bones+" bones (max "+a+" with blending, "+2*a+" without blending). Blending between frames will be disabled."),e.max_bones=r,e.frames_blending=!1),e.frames_blending=e.frames_blending&&!Xc.frames_blending_hack);for(r=0;r<g.length;r++)if(d=g[r],d.is_vehicle)if(a=d.vehicle_settings,"CHASSIS"==a.part){d.vehicle={};d.vehicle.force_max=
a.force_max;d.vehicle.brake_max=a.brake_max;d.vehicle.suspension_compression=a.suspension_compression;d.vehicle.suspension_stiffness=a.suspension_stiffness;d.vehicle.suspension_damping=a.suspension_damping;d.vehicle.wheel_friction=a.wheel_friction;d.vehicle.roll_influence=a.roll_influence;d.vehicle.max_suspension_travel_cm=a.max_suspension_travel_cm;d.vehicle.engine_force=0;d.vehicle.brake_force=1;d.vehicle.steering=0;d.vehicle.speed=0;d.vehicle.props=[];d.vehicle.prop_offsets=[];d.vehicle.steering_wheel=
null;l=(f=Fa.get_dg_parent(d))?Fa.get_dg_objects(f,g):g;for(f=0;f<l.length;f++)e=l[f],e.is_vehicle&&(k=e.vehicle_settings,aa.is_car_wheel(e)&&a.name==k.name?(k=aa.wheel_index(e.vehicle_settings.part),d.vehicle.props[k]=e,d.vehicle.prop_offsets[k]=w.b()):aa.is_vehicle_steering_wheel(e)&&a.name==k.name?(d.vehicle.steering_wheel=e,d.vehicle.steering_max=k.steering_max,d.vehicle.steering_ratio=k.steering_ratio,d.vehicle.inverse_control=k.inverse_control,k=w.p(d.render.world_tsr,w.b()),e=w.q(k,e.render.world_tsr,
k),d.vehicle.steering_wheel_tsr=e,k=new Float32Array([1,0,0]),w.y(k,e,k),d.vehicle.steering_wheel_axis=k):aa.is_vehicle_speedometer(e)&&a.name==k.name?(d.vehicle.speedometer=e,d.vehicle.speed_ratio=k.speed_ratio,d.vehicle.max_speed_angle=k.max_speed_angle,k=w.p(d.render.world_tsr,w.b()),e=w.q(k,e.render.world_tsr,k),d.vehicle.speedometer_tsr=e,k=new Float32Array([1,0,0]),w.y(k,e,k),d.vehicle.speedometer_axis=k):aa.is_vehicle_tachometer(e)&&a.name==k.name&&(d.vehicle.tachometer=e,d.vehicle.delta_tach_angle=
k.delta_tach_angle,k=w.p(d.render.world_tsr,w.b()),e=w.q(k,e.render.world_tsr,k),d.vehicle.tachometer_tsr=e,k=new Float32Array([1,0,0]),w.y(k,e,k),d.vehicle.tachometer_axis=k));4!=d.vehicle.props.length&&yb.panic("Not enough wheels for chassis "+d.name)}else if("HULL"==a.part)for(d.vehicle={},d.vehicle.props=[],d.vehicle.prop_offsets=[],d.vehicle.force_max=a.force_max,d.vehicle.brake_max=a.brake_max,d.vehicle.floating_factor=a.floating_factor,d.vehicle.water_lin_damp=a.water_lin_damp,d.vehicle.water_rot_damp=
a.water_rot_damp,d.vehicle.engine_force=0,d.vehicle.brake_force=1,d.vehicle.steering=0,d.vehicle.speed=0,d.vehicle.steering_wheel=null,l=(f=Fa.get_dg_parent(d))?Fa.get_dg_objects(f,g):g,f=0;f<l.length;f++)e=l[f],e.is_vehicle&&(k=e.vehicle_settings,aa.is_boat_bob(e)&&a.name==k.name?(d.vehicle.props.push(e),d.vehicle.prop_offsets.push(w.b())):aa.is_vehicle_steering_wheel(e)&&a.name==k.name?(d.vehicle.steering_wheel=e,d.vehicle.steering_max=k.steering_max,d.vehicle.steering_ratio=k.steering_ratio,d.vehicle.inverse_control=
k.inverse_control,k=w.p(d.render.world_tsr,w.b()),e=w.q(k,e.render.world_tsr,k),d.vehicle.steering_wheel_tsr=e,k=new Float32Array([1,0,0]),w.y(k,e,k),d.vehicle.steering_wheel_axis=k):aa.is_vehicle_speedometer(e)&&a.name==k.name?(d.vehicle.speedometer=e,d.vehicle.speed_ratio=k.speed_ratio,d.vehicle.max_speed_angle=k.max_speed_angle,k=w.p(d.render.world_tsr,w.b()),e=w.q(k,e.render.world_tsr,k),d.vehicle.speedometer_tsr=e,k=new Float32Array([1,0,0]),w.y(k,e,k),d.vehicle.speedometer_axis=k):aa.is_vehicle_tachometer(e)&&
a.name==k.name&&(d.vehicle.tachometer=e,d.vehicle.delta_tach_angle=k.delta_tach_angle,k=w.p(d.render.world_tsr,w.b()),e=w.q(k,e.render.world_tsr,k),d.vehicle.tachometer_tsr=e,k=new Float32Array([1,0,0]),w.y(k,e,k),d.vehicle.tachometer_axis=k));for(r=0;r<g.length;r++)if(d=g[r],d.is_floating&&(a=d.floating_settings,"MAIN_BODY"==a.part))for(d.floater={},d.floater.floating_factor=a.floating_factor,d.floater.water_lin_damp=a.water_lin_damp,d.floater.water_rot_damp=a.water_rot_damp,d.floater.bobs=[],f=
(f=Fa.get_dg_parent(d))?Fa.get_dg_objects(f,g):g,l=0;l<f.length;l++)e=f[l],e.is_floating&&(k=e.floating_settings,aa.is_floater_bob(e)&&a.name==k.name&&(d.floater.bobs.push(e),e.bob_synchronize_pos=e.floating_settings.synchronize_position));h(b,c)}function Ma(a,b){for(var c=0;c<a.scenes.length;c++){for(var g=a.scenes[c],h=pb.get_scene_objs(g,"LAMP",b),d=Array(h.length),f=0;f<h.length;f++)d[f]=f;d.sort(function(a,b){var c=h[a].light,g=h[b].light;return g.use_diffuse&&g.use_specular&&(!c.use_diffuse||
!c.use_specular)||!c.use_diffuse&&(g.use_diffuse||!c.use_specular&&g.use_specular)?1:0});for(f=0;f<d.length;f++)Fa.get_scene_data(h[d[f]],g).light_index=f}}function Aa(a,b,c,g,h,d){for(g=0;g<a.scenes.length;g++)d=a.scenes[g],d._camera=d.camera._object;for(g=0;g<a.scenes.length;g++){d=b.is_primary?a.scenes[g]:zb;var f=b.is_primary?pb.get_scene_objs(d,"LAMP",b.id):pb.get_scene_objs(d,"LAMP",0),e=pb.get_scene_objs(d,"ALL",b.id),l=ka(b.id,d,"MESH"),k=ka(b.id,d,"EMPTY");b.is_primary&&jb.append_scene(d,
e,f,l,k);for(var e=!1,m=0;m<k.length;m++)for(var q=k[m]._object,D=q.scenes_data,p=0;p<D.length;p++){var w=D[p].scene,n=jb.update_force_scene(w,q);d.name==w.name&&(e=e||n)}b.is_primary&&d._render.water_params&&!e&&bb.warn('Scene "'+d.name+'" has water but has no wind. Using default settings.');k=[];jb.set_active(d);la.generate_main_batches(d,l,f,k);m=pb.get_scene_objs(d,"LINE",b.id);la.generate_line_batches(d,m);q=jb.get_graph(d);if(b.is_primary){e=d._render.sky_params;m=d.world;if(e.render_sky||e.procedural_skydome)D=
m._object,la.append_sky_batch_to_world(d,e,D),la.create_forked_batches(D,q,d);jb.generate_auxiliary_batches(d,q);(e=d._render.world_light_set)&&(e.use_environment_light||e.ngraph_proxy_id)&&la.append_cube_sky_batch_to_world(d,m._object)}for(m=0;m<l.length;m++)la.create_forked_batches(l[m]._object,q,d);for(m=0;m<k.length;m++)la.create_forked_batches(k[m],q,d),pb.objects_storage_add(k[m]);e=pb.get_scene_objs(d,"ALL",b.id);jb.assign_scene_data_subs(d,e,f);for(m=0;m<e.length;m++)q=e[m],q.render.use_shape_keys&&
!q.is_boundings_overridden&&pb.update_boundings(q),Fa.check_inv_zup_tsr_is_needed(q)&&(q.need_inv_zup_tsr=!0),pb.update_lod_scene(q,d)}jb.append_scene_vtex(zb,a.textures,b.id);b.is_primary&&zb._render.video_textures.length&&(b.has_video_textures=!0);h(b,c)}function xa(a){var b=a.materials;a=a.images;for(var c=0;c<a.length;c++){var g=a[c];"FILE"==g.source&&-1<g.filepath.indexOf(".dds")&&"dds"==cb.compress_format?g._comp_method="dds":g._comp_method=""}if((tb.dds_available&&"dds"==cb.compress_format||
tb.pvr_available&&"pvr"==cb.compress_format)&&cb.use_compression)for(a=0;a<b.length;a++){for(var g=b[a],h=g.texture_slots,c=0;c<h.length;c++){var d=h[c],f=d.texture;if("IMAGE"==f.type||"ENVIRONMENT_MAP"==f.type){var e=f.image;e&&!e._comp_method&&(d=!f.b4w_disable_compression&&!d.use_map_normal&&"ENVIRONMENT_MAP"!=f.type&&!f.b4w_shore_dist_map&&"MOVIE"!=e.source,ga(e,d))}}if(c=g.node_tree)for(g=c.nodes,c=0;c<g.length;c++){h=g[c];d=!1;if("TEXTURE"==h.type){if((f=h.texture)&&(e=f.image)&&!e._comp_method&&
(d=!f.b4w_disable_compression&&"MOVIE"!=f.image.source&&"ENVIRONMENT_MAP"!=f.type)){a:{d=h.outputs;for(h=0;h<d.length;h++)if(f=d[h],f.is_linked&&"Normal"==f.identifier){d=!0;break a}d=!1}d=!d}}else"TEX_IMAGE"==h.type?(e=h.image)&&!e._comp_method&&(d="MOVIE"!=e.source):"TEX_ENVIRONMENT"==h.type&&(d=!1);e&&!e._comp_method&&ga(e,d)}}}function ga(a,b){-1<a.filepath.indexOf(".dds")?a._comp_method="dds":b?(a._comp_method=cb.compress_format,a.filepath="dds"==cb.compress_format?a.filepath+".dds":a.filepath+
".pvr"):a._comp_method=""}function ya(a,b,c,g,h,d){g=a.groups;d=a.objects;for(var f={},e={},l={},k={},m=0;m<g.length;m++){var q=g[m];f[q.uuid]=q;l[q.uuid]=q}for(m=0;m<d.length;m++)q=d[m],e[q.uuid]=q,k[q.uuid]=q;a=a.scenes;for(m=0;m<a.length;m++)O(a[m].objects,null,k,l,null);for(var D in l)D in f||g.push(l[D]);for(D in k)D in e||d.push(k[D]);h(b,c)}function O(a,b,c,g,h){for(var d=[],f=0;f<a.length;f++){var e=a[f],l=c[e.uuid];if(e=l.proxy){b&&-1==d.indexOf(e.uuid)&&d.push(e.uuid);for(var k=c[e.uuid],
q=k.constraints,e=0;e<q.length;e++){var D=ea.O(q[e]);D.name+="_CLONE";l.constraints.push(D)}"b4w_proxy_inherit_anim"in l&&!l.b4w_proxy_inherit_anim||(l.animation_data&&(k.animation_data=ea.O(l.animation_data)),k.b4w_use_default_animation=l.b4w_use_default_animation,k.b4w_auto_skel_anim=l.b4w_auto_skel_anim,k.b4w_anim_behavior=l.b4w_anim_behavior,k.b4w_cyclic_animation=l.b4w_cyclic_animation)}}for(f=0;f<d.length;f++)l=ea._9(a,"uuid",d[f]),-1<l&&a.splice(l,1);d={};if(b)for(f=0;f<a.length;f++)e=a[f],
l=c[e.uuid],q=ea.O(l),k="origin_name"in l?l.origin_name:l.name,q.name=Fa.gen_dupli_name(b.name,k),q.origin_name=k,q.dg_parent={uuid:b.uuid},wa(q),c[q.uuid]=q,d[e.uuid]=q.uuid,e.uuid=q.uuid,h&&h[l.uuid]&&(q.b4w_cluster_data=h[l.uuid]);for(f=0;f<a.length;f++)e=a[f],l=c[e.uuid],l.dupli_group&&(e=l.dupli_group,h=g[e.uuid],q=ea.O(h),q.name=Ac.unique_name(h.name+"_CLONE"),q.uuid=m.a("Group"+q.name),g[q.uuid]=q,e.uuid=q.uuid,O(q.objects,l,c,g,l.b4w_cluster_data));if(b)for(f=0;f<a.length;f++){e=a[f];l=c[e.uuid];
l.parent&&l.parent.uuid in d?l.parent.uuid=d[l.parent.uuid]:l.parent&&(bb.warn("Object's \""+l.name+'" parent is not in dupli group. Disabling parenting.'),l.parent=null);q=l.constraints;for(e=0;e<q.length;e++)b=q[e],b.target&&b.target.uuid in d&&(b.target.uuid=d[b.target.uuid]);if(b=l.pose)for(g=b.bones,e=0;e<g.length;e++)if(h=g[e].constraints)for(q=0;q<h.length;q++)b=h[q],b.target&&b.target.uuid in d&&(b.target.uuid=d[b.target.uuid]);b=l.modifiers;for(e=0;e<b.length;e++)g=b[e],g.object&&g.object.uuid in
d&&(g.object.uuid=d[g.object.uuid]);if((l=l.lod_levels)&&l.length)for(e=0;e<l.length;e++)b=l[e],b.object&&b.object.uuid in d&&(b.object.uuid=d[b.object.uuid])}for(var p in d)Sb[p]=d[p]}function wa(a){a.uuid=m.a("Object"+a.name)}function qa(a,b){a.action&&Ja(a,"action",b);if(a.nla_tracks)for(var c=0;c<a.nla_tracks.length;c++)for(var g=a.nla_tracks[c],h=0;h<g.strips.length;h++)g.strips[h].action&&Ja(g.strips[h],"action",b)}function na(a,b){for(var c=a.nodes,h=0;h<c.length;h++){var d=c[h];"TEXTURE"==
d.type&&d.texture&&Ja(d,"texture",b);"LAMP"==d.type&&d.lamp&&(d.lamp.uuid in Sb&&(d.lamp.uuid=Sb[d.lamp.uuid]),b[d.lamp.uuid]||(d.lamp=null));"GROUP"==d.type&&d.node_group&&Ja(d,"node_group",b);"TEX_IMAGE"!=d.type&&"TEX_ENVIRONMENT"!=d.type||!d.image||Ja(d,"image",b)}d=a.links;for(h=0;h<d.length;h++){var f=d[h];g(f,"from_node",c);g(f,"to_node",c);Da(f,"from_socket",f.from_node.outputs);Da(f,"to_socket",f.to_node.inputs)}(c=a.animation_data)&&qa(c,b)}function Ja(a,b,c){a[b]&&((c=c[a[b].uuid])||bb.error("Dangling link found:",
b,a),a[b]=c)}function g(a,b,c){c=ea._19("name",a[b].name,c);a[b]=c}function Da(a,b,c){c=ea._19("identifier",a[b].identifier,c);a[b]=c}function Ba(a,b,c,g,d,f){var e=[],l=[],k={};g=a.images;for(var m=eb.get_img_textures(),q=mb(b.filepath),D=0;D<g.length;D++){var p=g[D],w=p.uuid;if(w){var n=Object(h.b)(q+p.filepath),r=N.split_extension(n),v=r[1].toLowerCase(),z=p.source;if("FILE"===z){z=p._comp_method?N.AT_ARRAYBUFFER:N.AT_IMAGE_ELEMENT;if(!N.check_image_extension(v)){bb.error('image "'+p.name+'" has unsupported format or broken path.');
continue}tb.min50_available&&cb.use_min50&&(n=Ta(r))}else if("MOVIE"===z)if(cb.seq_video_fallback)n=r[0]+".altconv.seq",z=N.AT_SEQ_VIDEO_ELEMENT;else{z=Ub.detect_video_container(v);if(""==z){bb.error("failed to load video file (unsupported format)",n);continue}n=z!=v?r[0]+".altconv."+z:r[0]+"."+r[1];z=N.AT_VIDEO_ELEMENT}else{bb.error('Image "'+p.name+'" has unsupported format "'+z+'".');continue}w in k||(k[w]=[]);for(r=0;r<m.length;r++)v=m[r],(!eb.get_cache_loaded_status(v)&&v.img_comp_method==p._comp_method&&
v.img_uuid==w||b.is_preloading)&&k[w].push(v);p._comp_method&&cb.assets_gzip_available&&(z=N.AT_ARRAYBUFFER_ZIP,n+=".gz");k[w].length&&e.push({id:w,type:z,url:n,is_fetch:b.is_preloading})}}if(e.length){var u=0,E=function(g,h,d,m){if(g){if(b.is_preloading)h=d;else{h=k[h];for(var q=0;q<h.length;q++){var D=h[q];if(d==N.AT_SEQ_VIDEO_ELEMENT)D.seq_fps=g.fps,eb.update_texture(D,g.images,b.id);else if(eb.update_texture(D,g,b.id),"ENVIRONMENT_MAP"==D.source&&b.is_primary)for(var p=0;p<a.scenes.length;p++)jb.update_world_texture(a.scenes[p]);
eb.set_cache_loaded_status(D,!0)}h=h[0].img_comp_method}d==N.AT_VIDEO_ELEMENT||d==N.AT_SEQ_VIDEO_ELEMENT?(d==N.AT_VIDEO_ELEMENT?(h=g.videoWidth,g=g.videoHeight):(h=g.images[0].width,g=g.images[0].height),bb.log("%cLOAD VIDEO "+h+"x"+g,"color: #"+(2048<h||2048<g?"a00":1024<h||1024<g?"aa0":"0a0"),m),-1==m.indexOf(kc)&&bb.warn("video",m,"is not from app root.")):t(g,m,!0,h)}else{a:{g=b.is_preloading;m=m.split("?v")[0];d=N.split_extension(m);if("gz"==d[1])m=d[0],d=N.AT_ARRAYBUFFER;else if("dds"==d[1]||
"pvr"==d[1])for(m=d[0],d=N.AT_IMAGE_ELEMENT,q=k[h],D=0;D<q.length;D++)q[D].img_comp_method="";else if(-1!=m.indexOf(".min50"))m=m.split(".min50"),m=m[0]+m[1],d=N.AT_IMAGE_ELEMENT;else{h=null;break a}h={id:h,type:d,url:m,is_fetch:g}}h&&(bb.warn("Trying to load fallback image",h.url),l.push(h))}h=++u/(e.length+l.length);f(b,c,h)},H=function(){l.length?(N.enqueue(l,E,H),l.length=0):(bb.log("%cLOADED ALL IMAGES","color: #0a0"),d(b,c))};N.enqueue(e,E,H)}else d(b,c)}function Ta(a){return"dds"==a[1]?(a=
N.split_extension(a[0]),a[0]+".min50."+a[1]+".dds"):a[0]+".min50."+a[1]}function ma(a,b,c,g,h,d){a=jb.get_rendered_scenes();for(g=0;g<a.length;g++)if(d=a[g],d.b4w_use_nla){var f=d.b4w_nla_cyclic;d.b4w_use_logic_editor&&(f=!1);Eb.update_scene(d,f,b.id)}h(b,c)}function Ka(a,b,c,g,d,f){a=mb(b.filepath);var e=[],l={};g=pb.get_all_objects("ALL",b.id);for(var k=0;k<g.length;k++){var m=g[k];if(La(m)){var q=m.sfx.uuid;"BACKGROUND_MUSIC"==Ub.get_spk_behavior(m)?(q=ea._4(),b.has_background_music=!0):"NONE"!=
Ub.get_spk_behavior(m)&&cb.init_wa_context_hack&&(b.init_wa_context=!0);if(!(q in l)){l[q]=[];var D=Object(h.b)(a+m.sfx.filepath);switch(Ub.source_type(m)){case Ub.AST_ARRAY_BUFFER:var p=N.AT_AUDIOBUFFER;break;case Ub.AST_HTML_ELEMENT:p=N.AT_AUDIO_ELEMENT}fb(e,q,p,D,b.is_preloading)}l[q].push(m)}}if(e.length){var w=0;N.enqueue(e,function(a,g,h,d){if(a)for(bb.log("%cLOAD SOUND","color: #0aa",d),-1==d.indexOf(kc)&&bb.warn("sound",d,"is not from app root."),g=l[g],h=0;h<g.length;h++)Ub.update_spkobj(g[h],
a);a=++w/e.length;f(b,c,a)},function(){bb.log("%cLOADED ALL SOUNDS","color: #0aa");d(b,c)})}else d(b,c)}function fb(a,b,c,g,h){var d=N.split_extension(g),f=d[1].toLowerCase(),e=Ub.detect_audio_container(f);""!=e?(g=e!=f?d[0]+".altconv."+e:d[0]+"."+d[1],a.push({id:b,type:c,url:g,is_fetch:h})):bb.error("failed to load audio file (unsupported format)",g)}function La(a){return Fa.is_speaker(a)&&Ub.source_type(a)!=Ub.AST_NONE}function Xa(a,b,c){a=pb.get_scene_objs(a,"SPEAKER",b);for(b=0;b<a.length;b++){var g=
a[b];Fa.is_speaker(g)&&(Ub.is_autoplay(g)||c)&&Ub.play_def(g)}}function Wa(a,b){for(var c=a._render.video_textures,g=0;g<c.length;g++){var h=c[g]._render;a.b4w_use_nla&&c[g].b4w_nla_video||!c[g].use_auto_refresh||b!=h.vtex_data_id||(eb.reset_video(h),eb.play_video(h))}}function W(a,b,c,g,h,d){Eb.prepare();h(b,c)}function Ia(a,b,c,g,h,d){Eb.start();bb.log("%cSTART NLA","color: #0a0");h(b,c)}function Ua(a,b,c,g,h){for(var d=c.lod_levels.length,f=0;f<d;f++){var e=c.lod_levels[f],l=e.object;if(l){var k=
h.lod_parents.indexOf(c);if(-1==k){h.lod_parents.push(c);var m={old_lods:[],new_lods:[],lod_levels:[],scene_arrays:[],objs_container_arrays:[]};h.lod_levels_data.push(m)}else m=h.lod_levels_data[k];var q=m.old_lods.indexOf(l);-1!=k&&-1!=q?(m.scene_arrays[q].push(a),m.objs_container_arrays[q].push(b)):(k=ea.N(l),k.name=c.name+"_LOD_"+String(f+1),k.b4w_cluster_data=c.b4w_cluster_data,wa(k),k.lod_levels=[],g&&(k.dg_parent=g),m.old_lods.push(l),m.new_lods.push(k),m.lod_levels.push(e),m.scene_arrays.push([a]),
m.objs_container_arrays.push([b]))}}if(b=c.dupli_group)for(b=b.objects,g=0;g<b.length;g++)Ua(a,b,b[g],c,h)}function Na(a,b){var c=b.objects,g=c.indexOf(a);-1<g&&c.splice(g,1);for(g=0;g<c.length;g++)(b=c[g].dupli_group)&&Na(a,b)}function Va(a,b,c,g,h,d){g=!0;for(d=0;d<a.scenes.length;d++)if(!aa.check_worker_loaded(a.scenes[d])){g=!1;break}g&&(h(b,c),bb.log("%cPHYSICS READY","color: #0a0"))}function Z(a,b,c,g,h,d){for(g=0;g<a.scenes.length;g++){d=a.scenes[g];if(b.is_primary)var f=aa.scene_has_physics(d);
else f=aa.scene_has_physics(zb)||aa.scene_has_physics(d),d=zb;if(nb.enabled&&f)for(f=0;f<Nb.length;f++)for(var e=pb.get_scene_objs(d,Nb[f],b.id),l=0;l<e.length;l++){var k=e[l];k.render.data_id==b.id&&(aa.append_object(k,d),b.load_hidden&&aa.obj_has_physics(k)&&aa.disable_simulation(k))}}h(b,c)}function Oa(a,b,c,g,d,f){var e={};g=[];var l=a.scenes;for(f=0;f<a.scenes.length;f++){var k=l[f];if(k._render.water_params){var m=k._render.water_params.shoremap_image;if(m&&"FILE"===m.source){var k=m.uuid,q=
mb(b.filepath),q=Object(h.b)(q+m.filepath);g.push({id:k,type:m._comp_method?N.AT_ARRAYBUFFER:N.AT_IMAGE_ELEMENT,url:q});e[k]=m}}}g.length?N.enqueue(g,function(a,c,g,h){if(a){t(a,h,!0);g=[];h=eb.get_img_textures();for(var d=0;d<h.length;d++){var f=h[d];f.uri===c&&g.push(f)}for(c=0;c<g.length;c++)eb.update_texture(g[c],a,b.id);for(c=0;c<l.length;c++)if(g=l[c],g._render.water_params&&(h=g._render.water_params.shoremap_image,h===m)){var d=a,f=m,k=document.createElement("canvas");h=f.size[0];f=f.size[1];
k.width=h;k.height=f;k=k.getContext("2d");k.drawImage(d,0,0);d=k.getImageData(0,0,h,f).data;k=new Float32Array(4);k[0]=1/16581375;k[1]=1/65025;k[2]=1/255;k[3]=1;h*=f;for(var f=new Float32Array(h),q=0;q<h;q++)f[q]=k[1]*d[4*q+2]+k[2]*d[4*q+3];g._render.shore_distances=f}}else for(a=e[c],c=0;c<l.length;c++)g=l[c],h=g._render.water_params.shoremap_image,h===a&&(g._render.water_params.shoremap_image=null,bb.warn("image",h.filepath," was not found. Disabling water shore effects."))},function(){d(b,c)}):
d(b,c)}function Qa(a,b,c,g,h,d){g=a.scenes[0];a=[];var f=[nc.SMAA_EDGE_DETECTION,nc.SMAA_BLENDING_WEIGHT_CALCULATION,nc.SMAA_NEIGHBORHOOD_BLENDING,nc.SMAA_RESOLVE];for(d=0;d<f.length;d++){var e=jb.get_subs(g,f[d]);e&&a.push(e)}if(a.length){g=[];d=N.AT_IMAGE_ELEMENT;g.push({id:"SEARCH_TEXTURE",type:d,url:Db.paths.smaa_search_texture_path,is_fetch:b.is_preloading});g.push({id:"AREA_TEXTURE",type:d,url:Db.paths.smaa_area_texture_path,is_fetch:b.is_preloading});for(d=0;d<a.length;d++)if(f=a[d],f.type==
nc.SMAA_BLENDING_WEIGHT_CALCULATION){a=f.slinks_internal;for(d=0;d<a.length;d++)if(f=a[d],"u_search_tex"==f.to)var l=f.texture;else if("u_area_tex"==f.to)var k=f.texture;break}g.length?N.enqueue(g,function(a,c,g,h){a&&(t(a,h,!1),c="SEARCH_TEXTURE"==c?l:k,c.source="IMAGE",eb.update_texture(c,a,b.id),eb.set_filters(c,eb.TF_LINEAR,eb.TF_LINEAR))},function(){h(b,c)}):h(b,c)}else h(b,c)}function $a(a,b,c,g,h,d){for(c=0;c<a.scenes.length;c++){h=a.scenes[c];b.is_primary||(h=zb);var f=pb.get_scene_objs(h,
"LAMP",b.id);for(d=0;d<f.length;d++){var e=f[d];e.render.data_id==b.id&&g.added_objects.push({scene:h,obj:e})}f=pb.get_scene_objs(h,"ALL",b.id);for(d=0;d<f.length;d++)e=f[d],"LAMP"!=e.type&&e.render.data_id==b.id&&(b.load_hidden&&Fa.is_mesh(e)&&jb.change_visibility(e,!0),g.added_objects.push({scene:h,obj:e}))}}function rb(a,b,c,g,h,d){if(b.is_primary){a=jb.get_main();jb.update_world_texture(a);g=jb.get_rendered_scenes();for(d=0;d<g.length;d++){var f=g[d];jb.update_world_texture(f);jb.prepare_rendering(f,
a)}jb.set_active(a)}else jb.update_scene_permanent_uniforms(zb);a=pb.get_all_objects("ALL",b.id);pb.update_objects_dynamics(a);h(b,c)}function ob(a,b,c,g,h,d){if(b.is_primary)for(a=jb.get_rendered_scenes(),g=0;g<a.length;g++){d=a[g];for(var f=pb.get_scene_objs(d,"WORLD",0),e=0;e<f.length;e++)jb.init_cube_sky_dim(d,f[e]),jb.update_world_texture(d)}h(b,c)}function gb(a,b,c,g,h,d){if(b.is_primary)for(a=jb.get_rendered_scenes(),g=0;g<a.length;g++)d=a[g],d.b4w_use_logic_editor&&Bb.init_logic(d,b.id);h(b,
c)}function Ya(a,b,c,g,h,d){if(b.is_primary)for(g=0;g<a.scenes.length;g++)Wa(a.scenes[g],b.id),Xa(a.scenes[g],b.id,!1);else Wa(zb,b.id),Xa(zb,b.id,!1);h(b,c)}function sb(a,b,c,g,h,d){for(g=0;g<a.scenes.length;g++)a.scenes[g].camera=null;cb.media_auto_activation&&(b.has_video_textures||b.has_background_music||b.init_wa_context)?Cb||Mb(a,h,b,c):h(b,c)}function Mb(a,b,c,g){var h=vb.parentElement;Zb=h.style.zIndex;h.style.zIndex="999";Cb=document.createElement("div");Cb.style.position="relative";Cb.style.height=
"88px";Cb.style.width="88px";var d=Math.round(vb.offsetWidth/2-44);Cb.style.top=Math.round(vb.offsetHeight/2-44).toString()+"px";Cb.style.left=d.toString()+"px";Cb.style.backgroundImage="url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALAAAACwCAYAAACvt+ReAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAbrwAAG68BXhqRHAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAABVDSURBVHic7Z15kF1Vncc/v05Ys7JIQJZ0GLaAgCzCQARGFMIwZKTiqCPBAbTEEodBhYKALJKSVWYsCpTBcgCLAdQBHWZACCCyhCElIRiWEMOSBZAkCglJOoTQyW/++J3Xfe95971+273v3fvOp6qr+5573+vT3d8+93vP+Z3fTwjUhKoKsC0wLvKxDTA68rEVMNK9ZDiwpft6PdDvvl4LvA+sBt5zn1cCy4EVwDJgpYhouj9RMZB2d6ATUdWtgD2BXvcxARgPbJ5RFzYAS4BFwGL38YqIvJ/R988NQcCAqm4LHADsA+yLibannX1KYBMm6JeBBcA8EVnZ3i61n64UsKoOAyYCh7iPCeTvd6HA68BcYA6wQEQ2trdL2ZO3P1rDqGoPsD9wNHAkMKqBt1nNoFctfV7j2ldj/rbPXdsvIuvd994S88QAIzCfHPXOHyHurRvt21PALOAFEdnUwHvkjsILWFV7gcnAUcDYWl8GvAEsZNCDLhKR91rfw4RvrjoWuyv0us97ALtS+99rFfAEMFNElqTRx06hkAJ2I94ngRMwXzsUmzCxzsP85csisja9HtaPqo7CbM9EzK/vRW1/vwXATODJ0h2hSBRKwO5hbAom3KFuw2uAZzD/+JyIrEm5ey1FVUcDB2Ee/hPU9vM+ANwnIu+m3L3MKISAVXU3YCrwNwx6zSTWArOBJ7Gn+P4q1+YGVR0OfByzSX+N+exKfAg8DtwtIm9m0L1UybWAVfWjwJcw4Vb6WRT4A3YbnV0U0VZCVTfDRDwZOJDKv5dNwGPAXSLydja9az25FLCqbg9MA44FhlW4bDXwIPYgszyrvnUSqrojJuRqlqof+C1wp4i8k1XfWkWuBKyqmwN/D3wRW7ZN4m3gfzHhfpBV3zoZNyofBXwem81I4gPgHsxabMiqb82SGwGr6lHAV7A50yQWA3cCT4c4gmRcPMeRwCnY0ngSK4BbRGRWZh1rgo4XsJtZOAvzdUm8CfwSeKxbJu+bxQl5EnAqsEuFy+YAPxKRP2fWsQboWAG7X/JJwGkMRnVFWQXcDjwchNsYbnVyMibkMQmXvA/8DLi/U+9qHSlg95B2HvCxhNP9wG+AO0SkL+F8oE7cws9UzCNvlnDJAuA6EVmWacdqoOMErKpHA98keS7zReAGEXkr2151B6q6C3A2sF/C6bWYpXgy215Vp2MErKpbYMI9NuF0H3ArNrPQkbeyouCs2wnA6SQPIo8AN3XKDE9HCFhVdwK+iwWv+DwLXF+k5c88oKrbAecAByecfh24shMsRdsFrKqHYn53pHdqAzYtdk8YdduDG40nA18DtvBOrwP+TURmZ96xCG0VsKp+DrtV+f1YDFwrIkuz7lOgHBeSej6wm38KmzP+deadcrRFwG765kxsmszncexBrXChf3nGzVScg63o+cwEftyOHSGZC9htmLwAONQ71Y/9N/9P1n0K1I6qngycQXkMyjPANVkPPJkKWFVHApcDe3un1mIPBc9n2Z9AY6jqgcBFlM9SLAAuy3J+PjMBu20yM4DdvVPLge+JyBtZ9SXQPC4G+zJsD1+U14BLs9p+lYmAXTzDFZRHQi0EZojIqiz6EWgtqroNcCmWQyPKUuDiLKY+Uxewqo4BrqL8CfZF4PKQrCPfuIe7S7Dg+ShvARekPTilKmBVHYGNvHt4p54FrshT3GmgMm4V9SJsf16URcBFae43TE3Abrbh+5Q/sM0Gri761p5uwwXNTwcO904twOxEKrMTqaRPcvO851Eu3uewqZYg3oIhIh9iVnGOd2ofYLrLhtRy0sr/dSbl/4nzMdvwYUrfM9Bm3MB0JfCCd+pQbFNCy2m5gN3ysL/CthCbWgmrawXHPdfMAF7xTk12iyAtpaUCVtXDsNiGKMuxqbIg3i7BzSzNwPbXRfmqC95qGS0TsKqOA75N/MGwjzDP25W41K+XYausA83AeS58tiW0RMCRucBo7oF+zPMWOrlcoDJudfUqIBrkMxK40KVIaJpWjcBnUR6MfkuIbQiIyDzgNq95d+AbrXj/pgWsqpMo3wb0eIgqC5Rw8cL+Xrrj3P7HpmhKwKr6EeBfvOYlwA3NvG+gkFyPxUhEOcvtQG+YhgXstpucSzykbgO2kyLMOARiOE1ci2XHLDES+I7TUkM0MwJPoTxvw63hoS1QCRFZjCVKiXIAcGKj79mQgJ11+LLX/BxwX6MdCXQN92K7N6Kc1qiVaHQE/ibx7JB9wA/D7uHAUDiN3MhgMRyArWlwqbluAbsskf5qyq0hb0OgVlwe4tu85sPcjFZd1CVgN/l8htf8IrYrNRCohwexAK8oX3OxxTVT7wg8FdghctyPbYEP1iFQF04zNzBYQxpge+Cz9bxPzQJ2qYb+wWu+NyTaCzSKW2q+32v+gttDWRP1jMDTiOfpXYUllg4EmuFOrJ5JiS2xDPI1UZOAXTWgT3vNt4f8vIFmcRq63Wv+jCtQMyS1jsCnEM/E8haWZjO3qOrDqrp/u/sRAGwSIFqzbjjwj7W8cEgBuwQWftDFfxagMvpngLmqerNbmAm0CVci4ude87GquvNQr61lBP6cd90SrCJ6ERiO7d/7o6pe0KoY1UBDPI5lJS3Rg2mvKlUF7J4Gj/Ga7yjgtNk2wNXAC6r6+XZ3phtxmvqF1/wpl/2nIkONwFOI1x7+E/B0/d3LDXsBvwz+uG08hRWqLLEZySl4B6goYLdN6ASv+b8LOPomEfxxG3Be+F6v+cRqq3PVRuCjie9xWwM82nj3ckfwx+3hYeLzwqNITqoNVBfw8d7xg10aqB78cYa46kd+bM3kStcnCtjVRNgn2gQ81Gznck7wx9kxE9NciYluOreMSiOwr/g/iMjbiVd2H8Efp4wr3+XvaPcdAZAgYJeYz/ccIVwyTvDH6ePf8Y9x2oyRNALvD4yNHPdhKVED5QR/nB5PY7XoSmwD7OtflCRgf9n4/0I61CEJ/rjFuCSB/sBZNhsRE7DL4XqEd01Rlo2zIPjj1uJrb5JvI/wReCIwOnK8GpiXQseKTPDHrWMutv5QYix2txvAF7Bf42BOsA8NE/xxkzjtzfWaYxr1BezvNvbTxQfqJ/jj5njWO45pdEDALuqnN3JuE5asJNAagj9ujGeJL2rs4YpmAvER+EDiyakXplkeqUsJ/rhOXMXP16JNRFKaRQU80XtteHhLj+CP68PX4sB8cE9So+Pl1LoTKBH8cW34WowL2BUlHB+5QIE/pt+vgCP44+rMJ+6DJ7h49YEReE/io/Ebwf9mTvDHFRCR1dhO+BLDcOWLS6Lt9V7j1/gKZEfwx8ks9I4nwKCAd/dOLkq9O4GhCP44jp84vRcqj8BBwJ1D8MeGr8legB5Xn8CPdg9lAjqL4I/jOSMAxquq9ADbAtFfyJpQWbNj6Vp/7BKoR3PxbQmM7QHGedcuy6xXgUbpVn+83DselyRg/6JA59Jt/tjX5g5BwPmnm/xx4gjs5576S0adCbSWbvDHK7zj7XqI78AAy7weyC9F9serveNRSQIOS8jFoIj+2Bfw6CDgYlM0f+xrc3QPVnC52kWB/FMUf+yPwCN7sBysUT7IqDOB7Mm7P97gHW+eJOCwC7n45NUff+gdb5YkYP+iQDHJoz9OFPBwrzGMwN1FnvxxooADgRLvt7sD9dJD+Yjrj8iBYrMSmA7sLyL3tbszQ1Bmd4djw/Lm3kX+016gePQDtwAXi8if292ZGqko4ChhBC4+jwDfFpEX292ROqlJwBVLGgVyz0Lg3BxYhUr4MyUbeihfeRtFoGjkyedWoyzsYTgJ68sZdSaQPnn0udVIFHBZhE9GnQmkS159bjV8bb4XBFw88u5zq+Hb27XDMX8UZfuMOhNoLSuBa4AfugIpRWQH7/id4ZTvM9oxo84EWkPRfG41fG0uTxKwr/JA51JEn1sNX5uJAg4jcOdTZJ9bjbId9D3Au8SD2EdFaxAEOoqizOfWjapuC4yINL0PvNcjIgos9a7vzapjgZroB34C7C0i1xT4Ia0aE7zjJSIyUPUwMfNfoCN4BDhIRL7eBQ9p1ej1jhfBYODOYu+kr/ZA9nSrz63EeO94CQwK2B+B90y9O4FKdMN8biPs5R0vhkEBvwJsxGoPAOyqqqNCnYxM6ab53LpQ1dHAzpGmjcCr4DK0i8h64jZCgH0y6l8g+Nyh2Jd4Ec7XnWZjlYkq1uIKpMZCYIqIHNdFixGN4GvxpdIX1QScx8QXeaFr53Mb5EDveECr0e1Dz2PF5EpD9d6qOsbVqg20huBz60RVxxCvoqUkjcAishJ4PXKhAB9Pu4NdRPC5jXEIcf/7SrSGi58XYm7CiwPNEXxuc/ganBM98AU8xzs+TFXDLuXGCD63SZz2fAHHBllfwAuI79AYSbAR9RLiFlrHwcTT/67CKzkbE7CIbASe8t7kk6l0rZgEn9tajvaOZ4nIpmhDUm60Wd7xEarqJ5QIxAk+t8W4bJmHec2+NhMF/DwWI1xiBHB467pWKILPTY8jga0jx+8SmT4rUSZgFx/sK/2ElnYt/wSfmz7HecdPOG3GqJRedaZ3fKCq7tSSbuWf4HNTRlV3BA7wmh9KujZRwCKyBJuRGGgCjm9J7/JL8LnZMZn44sV8EfF3DQGVR2AoH4VPUNUtm+1ZDgk+N0NUdQvKLauvxQGqCfgJ4nnTRgHHNt613BF8bns4jngGnjUkzD6UqChgEfkA+I3XPFVVu6EsQfC5bcBp67Ne831Oi4kMJcb7iecP3hE4orHu5YLgc9vLJCA6WbAB02BFqgpYRN4FHveap6mqJF2fY4LPbTNu9D3Fa340GnmWRC124G4guny3G+VLfHkl+NzO4Rhg18jxRuBXQ71oSAGLyJvAY17zNFUdlnB5nngAOCD43PbjRt8ves2/E5E/DfXaWh/I7iJejuuj5HxeWEROFBF/G1WgPZwI7BI57gd+XssLaxKwiLwN/NZrPlVVRyRdHwjUiqqOBKZ5zQ+LyLJaXl/PlNidwPrI8RjgS3W8PhBIYhrxed/12B2/JmoWsIi8gz3QRTlJVXdJuj4QGApV3Q34W6/5F272qybqXZT4FfF8wsOBbxVwWi2QMk4z/0x8Z/wy4N563qcuAbtpplu95n0I4ZaB+jmR8oQlP613KrPuZWERmQX83ms+XVW3q/e9At2Jqm4PnOY1zxaR2fW+V6NxDTcCfZHjEQQrEaiBiHWI7rZYB/x7I+/XkICdyb7daz4ImNLI+wW6ipOBQ72220TkL428WTORZfcDL3htp6tqbxPvGSgwqro78E9e8zxsVbQhGhaw25/0r8DaSPPmwPldGvgeqIKqbgWcD0R3uK/BEnmX7XWrlaZie92wf4PXvBtwbvDDgRJOC+cQXy4G+HGj1qFE08HpIvIUFgAe5QjKA5MD3ctUyhPkzBSRJ5t941btrriJeGZLgDNU1c/rGugyVPUgyn3vq8DNrXj/lgjYbfn4PvG8asOA74aHuu7FLRVPZ7D2CpjvvapVsdct298mIiuAHxAPft8auERVt2nV9wnkA1dZ83vEq2sqcJ2I+OWNG6alGzRF5DnKl5rHAZe6p9BAF6CqWwOXUV6c+6ci8mwrv1fLdxiLyK8Bf1/ZnsCMML1WfFxeh0uBv/JOPSgidQXq1EJaW+R/Avjr2hOBi13WwUABcQmpLwQ+5p2agz3ot5xUBOxyuF5HPD0VWLLsC0K61uLh/qYXUb5MPB+42uWebjmpLja4LUdXAHt4p54HZpSK1QXyjbMNF2PxMFEWAReKyNryV7WG1FfLXJnQq7EVuigvAZeLyLq0+xBID/dccwnltdzeBKYPldehWVJPEyUiq7H/Tj+74H7AFWGKLb+4qbJrKBfvUuCitMULGYzAJdzu0xmUVx1/BxuJ/ZW8QAfjFim+R/lU2WvApVkVyMw04MZ54sspLyTeB1wpIvOy7E+gMdzy8HTiixRgD2yXi0hf+avSIfOIMeeZLgA+4Z3aiC2C3NtMeF0gPVxU2VQstsHPzPR74NqsH8zbEvLoUgmdCZyUcHo2FiOa2X9xYGjcwPMtksuuPQjclNZUWTXaGrOrqicDX03ox1Lsv3lx5p0KlOF2UpxPeTzvJuA/0lhhq5W2B52r6gHYL2esd+pD4A7gnmAp2oOzDFOAM4jvpACLKvuBiPj1tTOl7QIGUNVx2CqOv34OVhv3epcZKJARbuv7OZQvToDNNFzZyqiyRukIAcNAZcZvUF4fDGyW4mfAA2E0Thc36v4d9qC2dcIlM4GbOyWXcscIuISqTgLOJl7kucR84AYReSPbXnUHbm73bCzwymcNcKPbQtYxdJyAYeD29R3Ki92B5Y69D7grzFS0BrfIdAqW7ml4wiXzsJmhpjZgpkFHChhqupWtxpKrPNSO6Zsi4LLsnwCcSjzFaYl1wG10sHXrWAGXcOvtX8cq2CSxHPgvTMibKlwTiOAGh0nAl4GdK1z2DPCjThx1o3S8gEs4b/wVbItSEkuxxMizOnW0aDduAWkSZhd2rXDZMmxu9+nMOtYEuREwDET8n4jd8pJsBdiIfC82Iod4YwaCzY8CvkD5YkSJ9Vj+57s7ZYahFnIl4BLOVkwDPk3yQwfYU/ODmJDfzqpvnYSq7oQVzp5MsscFeyh+GHsorjkzeqeQSwGXUNUdsTodn6JybLNiO0BmYjloczO6NIKbTz8SqyK1P5X/xhuB32HCbfuCRKPkWsAlXJ2OqZiQq+23W4cFC80C5opIf5Vrc4OzCAdhNuFwKtsrsCX6R7El+iHrsHU6hRBwCbe74yTMJ1e6ZZbow56052JiTn33QCtR1bHAwcAh2EbKoUqercFS4t6Xt5+1GoUScAm3yfAo7Dbq12FIfAmWr+t5bLXvZbcVqmNQ1THYCtm+2Bae3ant7zcfeAh4slrV97xSSAFHccujx2P1nbet9WXAW1j1+iVY4sIlWT3kuHoj44EJQC+WGKaecmbvAk9gGSALvexeeAGXcJP3+2Ej8yTKwzdroQ+bJ12BTdetwFYE10Q+r8PiZPtL03guGHw49qC5NWZvRkc+74DNb5c+GqmAugrz9rOAl7plLrxrBBzFTejvhXnHQ7C8FXn7XSjwCvCs+1jYjSuRefujpYLzl/tj/nIi5i/9PV/tZiNmZV7Gcmq8mNXO304mCDgBd8vfA/OfvZgXHQ9klZxwPbAY89+L3NevhpXFcoKA68BN05V86g7Adgz62NGYd90KG72Hua8B3sdG0H5MnH2YZy755ncY9NTLijTNlTb/Dz+sKh/f1rAbAAAAAElFTkSuQmCC')";
Cb.style.backgroundSize="88px";Tb=document.createElement("div");Tb.style.position="relative";Tb.style.height=vb.offsetHeight.toString()+"px";Tb.style.width=vb.offsetWidth.toString()+"px";Tb.style.background="rgba(0, 0, 0, 0.5)";Tb.style.zIndex="999";h.appendChild(Tb);Tb.appendChild(Cb);Ib=function(){c.has_video_textures&&(eb.play(),eb.pause(),eb.reset());if(c.has_background_music){if(c.is_primary)for(var h=0;h<a.scenes.length;h++)Xa(a.scenes[h],c.id,!0);else Xa(zb,c.id,!0);Ub.pause()}c.init_wa_context&&
Ub.play_empty_sound();Fb();b(c,g)};qb.add_click_listener(Cb,Ib)}function Fb(){if(Cb){var a=vb.parentElement;a.style.zIndex=Zb;qb.remove_click_listener(Cb,Ib);Tb.removeChild(Cb);a.removeChild(Tb);Cb=Tb=null;Zb=0}}function mb(a){(a=a.split("/").slice(0,-1).join("/"))&&(a+="/");return a}function Sa(a){Ra.is_animated(a)&&Ra.remove(a);Wb.remove_obj_from_cache(a);pb.clear_outline_anim(a);zc.check_sensor_manifold(a)&&zc.remove_sensor_manifold(a);aa.obj_has_physics(a)&&aa.remove_object(a);jb.remove_object_bundles(a);
Fa.is_speaker(a)&&Ub.speaker_remove(a);ua.is_anchor(a)&&ua.remove(a)}function ib(a){var b=Ra.get_bpy_armobj(a);a=b&&b.parent==a?null:a.parent||b;return a?1+ib(a):0}var yb=Object(n.a)(e),ua=Object(R.a)(e),Ra=Object(V.a)(e),N=Object(y.a)(e),la=Object(d.a)(e),Db=Object(k.a)(e),Pa=Object(I.a)(e),zc=Object(A.a)(e),gc=Object(r.a)(e),Ac=Object(a.a)(e),Vb=Object(p.a)(e),wb=Object(u.a)(e),qb=Object(B.a)(e),Za=Object(l.a)(e),Eb=Object(b.a)(e),Bb=Object(f.a)(e),Wb=Object(T.a)(e),Ha=Object(fa.a)(e),pb=Object(z.a)(e),
Fa=Object(G.a)(e),aa=Object(E.a)(e),bb=Object(J.a)(e),Wc=Object(F.a)(e),db=Object(U.a)(e),jb=Object(K.a)(e),Ub=Object(sa.a)(e),dc=Object(v.a)(e),nc=Object(Y.a)(e),eb=Object(S.a)(e),fc=Object(L.a)(e),Bc=Object(q.a)(e),Xc=Db.animation,cb=Db.defaults,tb=Db.assets,nb=Db.physics,xb=Db.sfx,vc=null,mc=null,kc="",zb=null,Sb={},Vc=new Float32Array(3),gd=new Float32Array(4),lc=new Float32Array(4),Kc=ha.c(),Cb=null,Tb=null,Zb=0,qc=!1,Ib=null,Ec=["LAMP"],Nb=["MESH","CAMERA","EMPTY"],bd=["BSDF_PRINCIPLED","BSDF_GLOSSY",
"BSDF_DIFFUSE","BSDF_TRANSPARENT"],vb=null;ra.is_primary_loaded=function(a){return Za.is_primary_loaded(a)};ra.update=function(){Za.update_scheduler(vc)};var Rb=function(){var a=M.create(),b=H.create();return function(c,g,h,d,f,e){var l=d.added_objects;f=d.obj_counter;if(l.length){c=l[f].obj;var k=l[f].scene;f=Fa.get_scene_data(c,k);jb.append_object(k,c);!c.anchor||k._render.anaglyph_use||k._render.sidebyside_use||ua.append(c);d=++d.obj_counter/l.length;c.render.hide_children&&jb.change_visibility_rec(c,
!0);l=f.cube_refl_subs;if(-1!=c.render.cube_reflection_id&&l){var m=H.copy(c.render.bs_world.center,b);jb.update_cube_reflect_subs(l,m)}l=c.reflective_objs;if(l.length&&k._render.reflection_params)for(k=w.j(c.render.world_tsr,b),c=w.g(c.render.world_tsr,a),f=f.plane_refl_subs,m=0;m<f.length;m++)jb.update_plane_reflect_subs(f[m],k,c),Fa.update_refl_objects(l,f[m].camera.reflection_plane)}else d=1;e(g,h,d)}}();ra.setup_canvas=function(a){vb=a};ra.update_media_controls=function(a,b){if(Cb){Tb.style.height=
b.toString()+"px";Tb.style.width=a.toString()+"px";var c=Math.round(a/2-44);Cb.style.top=Math.round(b/2-44).toString()+"px";Cb.style.left=c.toString()+"px"}};ra.load=function(a,b,c,g,h){var d={load_main:{priority:Za.ASYNC_PRIORITY,background_loading:!1,inputs:[],is_resource:!1,relative_size:500,primary_only:!1,cb_before:C},duplicate_objects:{priority:Za.SYNC_PRIORITY,background_loading:!1,inputs:["load_main"],is_resource:!1,relative_size:50,primary_only:!1,cb_before:ya},load_binaries:{priority:Za.ASYNC_PRIORITY,
background_loading:!1,inputs:["load_main"],is_resource:!1,relative_size:500,primary_only:!1,cb_before:Q},wait_for_shaders:{priority:Za.SYNC_PRIORITY,background_loading:!1,inputs:[],is_resource:!1,relative_size:50,primary_only:!0,cb_loop:da},prepare_bindata:{priority:Za.SYNC_PRIORITY,background_loading:!1,inputs:["duplicate_objects","load_binaries"],is_resource:!1,relative_size:100,primary_only:!1,cb_before:ja},prepare_bpy_data:{priority:Za.SYNC_PRIORITY,background_loading:!1,inputs:["duplicate_objects",
"prepare_bindata"],is_resource:!1,relative_size:100,primary_only:!1,cb_before:Ga},process_objects:{priority:Za.SYNC_PRIORITY,background_loading:!1,inputs:["prepare_bpy_data"],is_resource:!1,relative_size:150,primary_only:!1,cb_before:Ca},process_scenes:{priority:Za.SYNC_PRIORITY,background_loading:!1,inputs:["process_objects","wait_for_shaders"],is_resource:!1,relative_size:300,primary_only:!1,cb_before:Aa},load_smaa_textures:{priority:Za.ASYNC_PRIORITY,background_loading:!1,inputs:["process_scenes"],
is_resource:!1,relative_size:30,primary_only:!0,cb_before:Qa},load_shoremap:{priority:Za.ASYNC_PRIORITY,background_loading:!1,inputs:["process_scenes"],is_resource:!1,relative_size:30,primary_only:!0,cb_before:Oa},load_images:{priority:Za.ASYNC_PRIORITY,background_loading:!0,inputs:["process_scenes"],is_resource:!0,relative_size:500,primary_only:!1,cb_before:Ba},update_scenes_nla:{priority:Za.SYNC_PRIORITY,background_loading:!1,inputs:["process_scenes","load_images"],is_resource:!1,relative_size:50,
primary_only:!1,cb_before:ma},wait_physics_workers:{priority:Za.SYNC_PRIORITY,background_loading:!1,inputs:["load_shoremap"],is_resource:!1,relative_size:20,primary_only:!1,cb_loop:Va},add_physics_objects:{priority:Za.SYNC_PRIORITY,background_loading:!1,inputs:["wait_physics_workers"],is_resource:!1,relative_size:50,primary_only:!1,cb_before:Z},add_objects:{priority:Za.SYNC_PRIORITY,background_loading:!1,inputs:["add_physics_objects"],is_resource:!1,relative_size:600,primary_only:!1,cb_before:$a,
cb_loop:Rb,cb_after:rb,cb_param:{added_objects:[],obj_counter:0}},init_cube_sky_dynamic_props:{priority:Za.SYNC_PRIORITY,background_loading:!1,inputs:["add_objects","load_images"],is_resource:!1,relative_size:50,primary_only:!1,cb_before:ob},init_logic_nodes:{priority:Za.SYNC_PRIORITY,background_loading:!1,inputs:["update_scenes_nla","add_objects"],is_resource:!1,relative_size:50,primary_only:!1,cb_before:gb},load_speakers:{priority:Za.ASYNC_PRIORITY,background_loading:!0,inputs:["add_objects"],is_resource:!0,
relative_size:100,primary_only:!1,cb_before:Ka},mobile_media_start:{priority:Za.SYNC_PRIORITY,background_loading:!1,inputs:["load_images","update_scenes_nla","load_speakers","init_logic_nodes"],is_resource:!0,relative_size:5,primary_only:!1,cb_before:sb,cb_loop:sb},synchronize_media:{priority:Za.SYNC_PRIORITY,background_loading:!0,inputs:["mobile_media_start"],is_resource:!0,relative_size:50,primary_only:!1,cb_before:Ya},prepare_nla:{priority:Za.SYNC_PRIORITY,background_loading:!1,inputs:["mobile_media_start"],
is_resource:!1,relative_size:5,primary_only:!0,cb_before:W},start_nla:{priority:Za.SYNC_PRIORITY,background_loading:!0,inputs:["prepare_nla"],is_resource:!1,relative_size:5,primary_only:!0,cb_before:Ia}},f=Za.get_scheduler();f||(f=Za.create_scheduler(),vc={},mc={},Sb={});vc[f.threads.length]={};return Za.create_thread(d,a,b,c,ia,g||xb.audio_loading_hack,cb.do_not_load_resources,h,!1)};ra.unload=function(a){var b=Za.get_scheduler();if(!b||!b.threads.length||a&&!Za.thread_is_finished(b.threads[a]))bb.error("Unable to unload data!");
else{if(0==a)bb.log("%cUNLOAD ALL","color: #00a"),ua.cleanup(),Ra.cleanup(),Ub.cleanup(),la.cleanup(),jb.cleanup(),Za.cleanup(),zc.cleanup(),aa.cleanup(),pb.cleanup(),Ac.cleanup(),db.cleanup(),Ha.cleanup(),dc.cleanup(),wb.cleanup(),N.cleanup(),eb.cleanup(),Bb.cleanup(),Wb.cleanup(),qb.cleanup(),Vb.cleanup(),mc=null,Sb={},vc=zb=null,qc=!1;else{bb.log("%cUNLOAD DATA "+a,"color: #00a");Ra.remove_actions(a);for(var b=pb.get_all_objects("ALL",pb.DATA_ID_ALL),c=0;c<b.length;c++){var g=b[c];Fa.get_object_data_id(g)!=
a&&pb.obj_switch_cleanup_flags(g,!1,!1,!1)}b=pb.get_all_objects("ALL",a);for(c=b.length-1;0<=c;c--)g=b[c],Sa(g),pb.remove_object(g);b=pb.get_all_objects("ALL",pb.DATA_ID_ALL);for(c=0;c<b.length;c++)pb.obj_switch_cleanup_flags(b[c],!0,!0,!0)}Eb.cleanup(a);Fb()}};ra.prepare_object_unloading=Sa;ra.set_debug_resources_root=function(a){kc=a};ra.activate_media=function(){qc||cb.media_auto_activation||(eb.play(),eb.pause(),eb.reset(),Xa(zb,pb.DATA_ID_ALL,!0),Ub.pause(),cb.init_wa_context_hack&&Ub.play_empty_sound(),
qc=!0)};ra.reset=function(){vb=null};ra.prefetch=function(a,b,c){var g={load_main:{priority:Za.ASYNC_PRIORITY,background_loading:!1,inputs:[],is_resource:!1,relative_size:500,primary_only:!1,cb_before:C},load_binaries:{priority:Za.ASYNC_PRIORITY,background_loading:!1,inputs:["load_main"],is_resource:!1,relative_size:500,primary_only:!1,cb_before:Q},load_images:{priority:Za.ASYNC_PRIORITY,background_loading:!1,inputs:["load_main"],is_resource:!1,relative_size:500,primary_only:!1,cb_before:Ba},preload_sounds:{priority:Za.ASYNC_PRIORITY,
background_loading:!1,inputs:["load_main"],is_resource:!1,relative_size:500,primary_only:!1,cb_before:ba}},h=Za.get_scheduler();h||(h=Za.create_scheduler(),vc={},mc={},Sb={});vc[h.threads.length]={};return Za.create_thread(g,a,b,c,ia,!1,cb.do_not_load_resources,!1,!0)};ra.unfetch=function(){N.clear_cache()}});t.a=e},function(C,t,e){C=e(0);var R=e(5),V=e(4),n=e(35),y=e(91),d=e(1),k=e(23),I=e(2),A=e(48),r=e(37);e=Object(C.a)("__assets",function(e,u){function a(){return F.is_built_in_data()?b4w.require(F.paths.built_in_data_module).data:
null}function p(){var b={_source_url:null,_parse_response:function(a){switch(b.responseType){case "json":case "text":return a;case "arraybuffer":a=atob(a);for(var c=a.length,h=new Int8Array(c),d=0;d<c;d++)h[d]=a.charCodeAt(d);return h.buffer;default:return a}},status:0,readyState:0,response:"",responseType:"",onreadystatechange:null,overrideMimeType:function(){},addEventListener:function(){},open:function(a,c,d){b._source_url=c;b.readyState=1},send:function(){b.status=404;b.readyState=4;var c=a();
c&&b._source_url in c&&(b.status=200,c[b._source_url]&&(b.response=b._parse_response(c[b._source_url])));if("[object Function]"==={}.toString.call(b.onreadystatechange))b.onreadystatechange()}};return b}function l(a){for(var h=0,d=0;d<a.length;d++){var e=a[d];20===e.state&&h++;if(h>=Y.max_requests)break;if(10===e.state)switch(e.state=20,h++,e.type){case u.AT_JSON_ZIP:case u.AT_ARRAYBUFFER:case u.AT_ARRAYBUFFER_ZIP:c(e,"arraybuffer");break;case u.AT_JSON:c(e,"json");break;case u.AT_TEXT:c(e,"text");
break;case u.AT_AUDIOBUFFER:m(e);break;case u.AT_IMAGE_ELEMENT:b(e);break;case u.AT_AUDIO_ELEMENT:f(e);break;case u.AT_VIDEO_ELEMENT:T(e);break;case u.AT_SEQ_VIDEO_ELEMENT:t(e);break;default:M.panic("Wrong asset type: "+e.type)}}}function c(b,c){var h=b.url.split("?v=")[0];if(h in q)"json"==c?b.asset_cb(I.O(q[h]),b.id,b.type,b.url,b.param):b.asset_cb(q[h],b.id,b.type,b.url,b.param);else{var d=a(),f=d&&b.url in d?new p:new XMLHttpRequest,d=null;if("GET"==b.request_method)f.open("GET",b.url,!0);else if("POST"==
b.request_method)switch(f.open("POST",b.url,!0),b.type){case u.AT_TEXT:d="text/plain";break;case u.AT_JSON:d="application/json"}if(b.overwrite_header)for(var e in b.overwrite_header)"Content-Type"==e?d=b.overwrite_header[e]:f.setRequestHeader(e,b.overwrite_header[e]);d&&f.setRequestHeader("Content-Type",d);"text"==c?(f.overrideMimeType("text/plain"),f.responseType="text"):"json"==c?(f.overrideMimeType("application/json"),f.responseType="text"):f.responseType=c;f.onreadystatechange=function(){if(40!=
b.state&&4==f.readyState){if(200==f.status||0==f.status){var a=f.response;if(!a||"arraybuffer"==c&&0==a.byteLength)K.error("empty responce when trying to get "+b.url),b.asset_cb(null,b.id,b.type,b.url,b.param);else{switch(b.type){case u.AT_JSON_ZIP:try{a=y.a(a,{to:"string"})}catch(Q){K.error(Q+" (parsing gzipped file "+b.url+")");b.asset_cb(null,b.id,b.type,b.url,b.param);return}case u.AT_JSON:try{a=JSON.parse(a,b.json_reviver)}catch(Q){K.error(Q+" (parsing JSON "+b.url+")");b.asset_cb(null,b.id,
b.type,b.url,b.param);return}break;case u.AT_ARRAYBUFFER_ZIP:try{a=y.a(a).buffer}catch(Q){K.error(Q+" (parsing gzipped file "+b.url+")");b.asset_cb(null,b.id,b.type,b.url,b.param);return}}b.is_fetch&&(q[h]=b.type==u.AT_JSON||b.type==u.AT_JSON_ZIP?I.O(a):a);b.asset_cb(a,b.id,b.type,b.url,b.param)}}else K.error(f.status+" when trying to get "+b.url),b.asset_cb(null,b.id,b.type,b.url,b.param);b.state=30}};f.addEventListener("progress",function(a){a.lengthComputable&&b.progress_cb(a.loaded/a.total)},
!1);f.send(b.post_data)}}function m(b){var c=b.url.split("?v=")[0];if(c in H)b.asset_cb(H[c],b.id,b.type,b.url,b.param),b.state=30;else{"GET"!=b.request_method&&M.panic("Unsupported request type for audio buffer");var d=(c=a())&&b.url in c?new p:new XMLHttpRequest;d.open("GET",b.url,!0);d.responseType="arraybuffer";d.onreadystatechange=function(){if(40!=b.state&&4==d.readyState)if(200==d.status||0==d.status){var a=d.response;a?C.decode_audio_data(a,function(a){b.asset_cb(a,b.id,b.type,b.url,b.param);
b.state=30;if(b.is_fetch){var c=b.url.split("?v=")[0];H[c]=a}},function(){K.error("failed to decode "+b.url);b.asset_cb(null,b.id,b.type,b.url,b.param);b.state=30}):(K.error("empty responce when trying to get "+b.url),b.asset_cb(null,b.id,b.type,b.url,b.param),b.state=30)}else K.error(d.status+" when trying to get "+b.url),b.asset_cb(null,b.id,b.type,b.url,b.param),b.state=30};d.send()}}function b(b){var c=b.url.split("?v=")[0];if(c in w)b.asset_cb(w[c],b.id,b.type,b.url,b.param),b.state=30;else{"GET"!=
b.request_method&&M.panic("Unsupported request type for image element");var d=document.createElement("img");v.allow_cors&&(d.crossOrigin="Anonymous");d.onload=function(){if(40!=b.state&&(b.asset_cb(d,b.id,b.type,b.url,b.param),b.state=30,b.is_fetch)){var a=b.url.split("?v=")[0];w[a]=d}};d.addEventListener("error",function(){40!=b.state&&(K.error("could not load image: "+b.url),b.asset_cb(null,b.id,b.type,b.url,b.param),b.state=30)},!1);if((c=a())&&b.url in c)if(c[b.url]){var f=G(b.url);d.src="data:"+
f+";base64,"+c[b.url]}else U.is_ie11()?(c=document.createEvent("CustomEvent"),c.initCustomEvent("error",!1,!1,null)):c=new CustomEvent("error"),d.dispatchEvent(c);else d.src=b.url}}function f(b){var c=b.url.split("?v=")[0];if(c in ea)b.asset_cb(ea[c],b.id,b.type,b.url,b.param),b.state=30;else{"GET"!=b.request_method&&M.panic("Unsupported request type for audio element");var d=document.createElement("audio");v.allow_cors&&(d.crossOrigin="Anonymous");d.addEventListener("loadeddata",function(){if(40!=
b.state&&(b.asset_cb(d,b.id,b.type,b.url,b.param),b.state=30,b.is_fetch)){var a=b.url.split("?v=")[0];ea[a]=d}},!1);d.addEventListener("error",function(){40!=b.state&&(K.error("could not load sound: "+b.url),b.asset_cb(null,b.id,b.type,b.url,b.param),b.state=30)},!1);d.addEventListener("stalled",function(){40!=b.state&&(K.error("could not load sound: "+b.url),b.asset_cb(null,b.id,b.type,b.url,b.param),b.state=30)},!1);if((c=a())&&b.url in c)if(c[b.url]){var f=E(b.url);d.src="data:"+f+";base64,"+c[b.url];
40!=b.state&&(b.asset_cb(d,b.id,b.type,b.url,b.param),b.state=30)}else U.is_ie11()?(c=document.createEvent("CustomEvent"),c.initCustomEvent("error",!1,!1,null)):c=new CustomEvent("error"),d.dispatchEvent(c);else d.src=b.url,v.is_mobile_device&&d.load();v.mobile_firefox_media_hack&&(d.autoplay=!0,d.pause());setTimeout(function(){d.some_prop_to_prevent_gc=1},5E3)}}function T(b){function c(a){40!=b.state&&(K.error("could not load video: "+b.url,b.param),b.asset_cb(null,b.id,b.type,b.url),b.state=30)}
var d=b.url.split("?v=")[0];if(d in w)b.asset_cb(w[d],b.id,b.type,b.url,b.param),b.state=30;else{"GET"!=b.request_method&&M.panic("Unsupported request type for video element");var f=document.createElement("video");f.muted=!0;v.allow_cors&&(f.crossOrigin="Anonymous");f.addEventListener("loadeddata",function(){f.removeEventListener("error",c,!1);if(40!=b.state&&(b.asset_cb(f,b.id,b.type,b.url,b.param),b.state=30,b.is_fetch)){var a=b.url.split("?v=")[0];w[a]=f}},!1);f.addEventListener("error",c,!1);
if((d=a())&&b.url in d)if(d[b.url]){var e=J(b.url);f.src="data:"+e+";base64,"+d[b.url];40!=b.state&&f.addEventListener("loadeddata",function(){b.asset_cb(f,b.id,b.type,b.url,b.param);b.state=30},!1)}else U.is_ie11()?(d=document.createEvent("CustomEvent"),d.initCustomEvent("error",!1,!1,null)):d=new CustomEvent("error"),f.dispatchEvent(d);else f.src=b.url,v.is_mobile_device&&f.load();if(v.mobile_firefox_media_hack||v.ipad_video_hack)f.autoplay=!0,f.pause();setTimeout(function(){f.some_prop_to_prevent_gc=
1},1E4)}}function t(b){function c(a){b.asset_cb(a,b.id,b.type,b.url,b.param);b.state=30;if(b.is_fetch){var c=b.url.split("?v=")[0];w[c]=a}}var d=b.url.split("?v=")[0];if(d in w)b.asset_cb(w[d],b.id,b.type,b.url,b.param),b.state=30;else{"GET"!=b.request_method&&M.panic("Unsupported request type for seq video element");var f=(d=a())&&b.url in d?new p:new XMLHttpRequest;f.open("GET",b.url,!0);f.responseType="arraybuffer";f.onreadystatechange=function(){if(40!=b.state&&4==f.readyState)if(200==f.status||
0==f.status){var a=f.response;a?z(a,c):(K.error("empty responce when trying to get "+b.url),b.asset_cb(null,b.id,b.type,b.url,b.param),b.state=30)}else K.error(f.status+" when trying to get "+b.url),b.asset_cb(null,b.id,b.type,b.url,b.param),b.state=30};f.addEventListener("progress",function(a){a.lengthComputable&&b.progress_cb(a.loaded/a.total)},!1);f.send()}}function z(a,b){for(var c=new Int32Array(a),h=new Int8Array(a),d=c[3],f={images:[],blobs:[],fps:c[4]},e=20,l=0;l<d;l++){var k=c[e/4],m=h.subarray(e+
4,e+4+k),m=new Blob([m],{type:"image/jpg"}),q=document.createElement("img");q.src=window.URL.createObjectURL(m);f.images.push(q);f.blobs.push(m);e+=k+8-k%4}q.onload=function(){for(var a=0;a<f.images.length;a++)window.URL.revokeObjectURL(f.images[a].src);delete f.blobs;b(f)}}function G(a){var b="image";switch(A.a(a).toLowerCase()){case "jpeg":case "jpg":b+="/jpeg";break;case "png":b+="/png"}return b}function E(a){var b="audio";switch(A.a(a).toLowerCase()){case "ogv":case "ogg":b+="/ogg";break;case "mp3":b+=
"/mpeg";break;case "m4v":case "mp4":b+="/mp4";break;case "webm":b+="/webm"}return b}function J(a){var b="video";switch(A.a(a).toLowerCase()){case "ogv":b+="/ogg";break;case "webm":b+="/webm";break;case "m4v":case "mp4":b+="/mp4"}return b}var M=Object(R.a)(e),F=Object(V.a)(e),U=Object(n.a)(e),K=Object(d.a)(e),C=Object(k.a)(e),v=F.defaults,Y=F.assets;u.AT_ARRAYBUFFER=10;u.AT_ARRAYBUFFER_ZIP=20;u.AT_JSON=30;u.AT_JSON_ZIP=40;u.AT_TEXT=50;u.AT_AUDIOBUFFER=60;u.AT_IMAGE_ELEMENT=70;u.AT_AUDIO_ELEMENT=80;
u.AT_VIDEO_ELEMENT=90;u.AT_SEQ_VIDEO_ELEMENT=100;var ha=[],S=0,L={},q={},w={},ea={},H={};u.split_extension=function(a){a=a.split(".");var b=Array(2);b[0]=a.slice(0,-1).join(".");b[1]=String(a.slice(-1));return b};u.get_text_sync=function(a){if(L[a])return L[a];var b=Y.prevent_caching?a+"?v="+Object(r.c)():a,c=new XMLHttpRequest;c.overrideMimeType("text/plain");c.open("GET",b,!1);c.send(null);if(200==c.status||0==c.status){b=c.responseText;if(b.length)return L[a]=b;M.panic("Error XHR: responce is empty, GET "+
a)}else M.panic("Error XHR: "+c.status+", GET "+a)};u.cleanup=function(){for(var a=0;a<ha.length;a++)ha[a].state=40;ha=[];S=0;L={}};u.enqueue=function(b,c,d,f,e){for(var h=0;h<b.length;h++){var k=b[h],k={id:k.id,type:k.type,url:k.url,is_fetch:k.is_fetch,request_method:k.request_method?k.request_method:"GET",overwrite_header:k.overwrite_header?k.overwrite_header:null,post_data:k.post_data?k.post_data:null,param:k.param?k.param:null,state:10,asset_cb:c||function(){},pack_cb:d||function(){},progress_cb:f||
function(){},json_reviver:e||null,pack_index:S};if(Y.prevent_caching){var m=a();m&&k.url in m||(k.url+="?v="+Object(r.c)())}ha.push(k)}l(ha);S++};u.update=function(){l(ha);for(var a=ha,b=0,c=!0,d=0;d<a.length;d++){var f=a[d];f.pack_index===a[b].pack_index?30!==f.state&&(c=!1):(c&&(a[d-1].pack_cb(),c=d-b,a.splice(b,c),d-=c),b=d,c=30===a[d].state?!0:!1);d===a.length-1&&c&&(f=a[d],a.splice(b),f.pack_cb())}};u.check_image_extension=function(a){return"png"==a||"jpg"==a||"jpeg"==a||"gif"==a||"bmp"==a||
"dds"==a||"pvr"==a?!0:!1};u.clear_cache=function(){q={};w={};ea={};H={}}});t.a=e},function(C,t,e){C=e(0);var R=e(5),V=e(4),n=e(1),y=e(17),d=e(2);e=Object(C.a)("__debug_check",function(e,t){var k=Object(R.a)(e),r=Object(V.a)(e),p=Object(n.a)(e),u=Object(y.a)(e),a=r.defaults,B=-1,l=-1,c=null,m=[];t.setup_context=function(a){for(var b="INVALID_ENUM INVALID_VALUE INVALID_OPERATION OUT_OF_MEMORY INVALID_FRAMEBUFFER_OPERATION CONTEXT_LOST_WEBGL".split(" "),d=0;d<b.length;d++){var f=b[d];f in a&&(m[a[f]]=
f)}c=a};t.browser=function(a){switch(a.toLowerCase()){case "chrome":return b("mozilla")&&b("applewebkit")&&b("chrome");case "firefox":return b("mozilla")&&b("gecko")&&b("firefox");case "msie":return b("mozilla")&&b("trident")&&b("msie");case "opera":return b("opera")&&b("presto");case "safari":return b("mozilla")&&b("applewebkit")&&b("safari")&&!b("chrome");default:return!1}};var b=function(a){return-1<navigator.userAgent.toLowerCase().indexOf(a)?!0:!1};t.finite=function(a){if(d._16(a)){for(var b=
0;b<a.length;b++)if(!isFinite(a[b]))return!1;return!!a.length}return isFinite(a)?!0:!1};t.gl=function(b){if(a.gl_debug){var d=c.getError();d!=c.NO_ERROR&&(d in m?k.panic("GL Error: "+d+", gl."+m[d]+" ("+b+")"):k.panic("Unknown GL error: "+d+" ("+b+")"))}};t.bound_fb=function(){if(!a.gl_debug&&!a.check_framebuffer_hack)return!0;switch(c.checkFramebufferStatus(c.FRAMEBUFFER)){case c.FRAMEBUFFER_COMPLETE:return!0;case c.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return p.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT"),
!1;case c.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return p.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT"),!1;case c.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return p.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS"),!1;case c.FRAMEBUFFER_UNSUPPORTED:return p.error("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED"),!1;case c.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:return p.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MULTISAMPLE"),!1;default:return p.error("FRAMEBUFFER CHECK FAILED"),
!1}};t.depth_only_issue=function(){if(-1!=l)return l;var a=c.createFramebuffer();c.bindFramebuffer(c.FRAMEBUFFER,a);var b=u.create_texture(u.TT_DEPTH,!1);u.resize(b,1,1);c.framebufferTexture2D(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,b.w_target,b.w_texture,0);c.checkFramebufferStatus(c.FRAMEBUFFER)!=c.FRAMEBUFFER_COMPLETE?(l=!0,p.warn("depth-only issue was found")):l=!1;c.bindFramebuffer(c.FRAMEBUFFER,null);c.deleteFramebuffer(a);return l};t.multisample_issue=function(){if(1==a.msaa_samples)return!1;if(-1!=
B)return B;var b=c.createRenderbuffer();c.bindRenderbuffer(c.RENDERBUFFER,b);c.renderbufferStorageMultisample(c.RENDERBUFFER,a.msaa_samples,c.RGBA8,1,1);b=c.getRenderbufferParameter(c.RENDERBUFFER,c.RENDERBUFFER_SAMPLES);b!=a.msaa_samples?(B=!0,p.warn("multisample issue was found: requested "+a.msaa_samples+", got "+b),c.getError()==c.INVALID_OPERATION&&p.warn("the error from multisample issue detected, ignoring")):B=!1;c.bindRenderbuffer(c.RENDERBUFFER,null);return B};t.ff_cubemap_out_of_memory=
function(){return b("firefox")&&c.getError()==c.OUT_OF_MEMORY?(p.warn("Firefox/old GPUs cubemap issue was found."),!0):!1};t.reset=function(){c=null}});t.a=e},function(C,t,e){C=e(0);C=Object(C.a)("__debug_subscene",function(e,t){t.DV_NONE=0;t.DV_OPAQUE_WIREFRAME=1;t.DV_TRANSPARENT_WIREFRAME=2;t.DV_FRONT_BACK_VIEW=3;t.DV_BOUNDINGS=4;t.DV_CLUSTERS_VIEW=5;t.DV_BATCHES_VIEW=6;t.DV_RENDER_TIME=7;var n=null;t.set_debug_view_subs=function(e){n=e};t.get_debug_view_subs=function(){return n};t.cleanup=function(){n=
null}});t.a=C},function(C,t,e){C=e(0);var R=e(5),V=e(4),n=e(16),y=e(30),d=e(20),k=e(36),I=e(17),A=e(18),r=e(6),p=e(2),u=e(3);e=Object(C.a)("__particles",function(a,e){function l(a,b){return{name:a,p_type:b,time:0,prev_time:-1,use_world_space:!1,count_factor:1,frame_start:0,frame_end:0,time_length:0,lifetime_frames:0,lifetime:0,cyclic:0,mass:0,nfactor:0,gravity:0,fade_in:0,fade_out:0,wind_factor:0,size:0,alpha_start:0,alpha_end:0,color_ramp_length:0,color_ramp:new Float32Array(16),need_buffers_update:!1,
positions:null,positions_cache:null,tbn:null,tbn_cache:null,delay_attrs:null,delay_attrs_masked:null,emitter_tsr_snapshots:null,p_data:null,tilt:0,tilt_rand:0}}function c(a,b,c,d,f,e){var l=a.delay_attrs,m=a.emitter_tsr_snapshots,q=a.time;a=a.prev_time;for(var p=0;p<l.length;p+=4){var h=l[p];q>a&&q>=h&&h>a||q<a&&(h>a||q>=h)?(r.u(d,m,p),r.a(d,F)):r.f(m,p,F);h=U;h[0]=b[3*p];h[1]=b[3*p+1];h[2]=b[3*p+2];r.D(h,F,h);f[3*p]=h[0];f[3*p+1]=h[1];f[3*p+2]=h[2];h=k.e(c,p,M);k.m(h,F,h);k.n(e,h,p);for(var n=1;4>
n;n++)f[3*(p+n)]=f[3*p],f[3*(p+n)+1]=f[3*p+1],f[3*(p+n)+2]=f[3*p+2],k.n(e,h,p+n)}}function m(a){a?(t.srand(a),C=function(){return t.rand()}):C=function(){return Math.random()}}var b=Object(R.a)(a),f=Object(V.a)(a),B=Object(n.a)(a),t=Object(y.a)(a),z=Object(d.a)(a),G=Object(I.a)(a),E=Object(A.a)(a),J=f.defaults,M=k.c(),F=r.b(),U=new Float32Array(3),K=[];e.clone_particles_data=function(a){var b=l(a.name,a.type);b.time=a.time;b.prev_time=a.prev_time;b.use_world_space=a.use_world_space;b.count_factor=
a.count_factor;b.frame_start=a.frame_start;b.frame_end=a.frame_end;b.time_length=a.time_length;b.lifetime_frames=a.lifetime_frames;b.lifetime=a.lifetime;b.cyclic=a.cyclic;b.mass=a.mass;b.nfactor=a.nfactor;b.gravity=a.gravity;b.fade_in=a.fade_in;b.fade_out=a.fade_out;b.wind_factor=a.wind_factor;b.size=a.size;b.alpha_start=a.alpha_start;b.alpha_end=a.alpha_end;b.color_ramp_length=a.color_ramp_length;b.color_ramp.set(a.color_ramp);b.need_buffers_update=a.need_buffers_update;b.positions=p.O(a.positions);
b.positions_cache=p.O(a.positions_cache);b.tbn=p.O(a.tbn);b.tbn_cache=p.O(a.tbn_cache);b.delay_attrs=p.O(a.delay_attrs);b.delay_attrs_masked=p.O(a.delay_attrs_masked);b.emitter_tsr_snapshots=p.O(a.emitter_tsr_snapshots);b.p_data=p.O(a.p_data);b.tilt=a.tilt;b.tilt_rand=a.tilt_rand;return b};var C=function(){b.panic("_rand() undefined")};e.update=function(){for(var a=0;a<K.length;a++)for(var b=K[a],d=b.scenes_data,f=0;f<d.length;f++)for(var e=b,l=d[f].batches,k=0;k<l.length;k++){var m=l[k],p=m.particles_data;
p&&p.use_world_space&&!m.forked_batch&&(c(p,p.positions,p.tbn,e.render.world_tsr,p.positions_cache,p.tbn_cache),p.need_buffers_update=!0)}};e.obj_has_particles=function(a){a=a.scenes_data;for(var b=0;b<a.length;b++)for(var c=a[b].batches,d=0;d<c.length;d++)if(c[d].particles_data)return!0;return!1};e.obj_has_psys=function(a,b){for(var c=a.scenes_data,d=0;d<c.length;d++)for(var f=c[d].batches,e=0;e<f.length;e++){var l=f[e].particles_data;if(l&&l.name==b)return!0}return!1};e.obj_has_anim_particles=function(a){a=
a.scenes_data;for(var b=0;b<a.length;b++)for(var c=a[b].batches,d=0;d<c.length;d++){var f=c[d].particles_data;if(f&&"EMITTER"==f.p_type)return!0}return!1};e.bpy_obj_has_particles=function(a){return 0<a.particle_systems.length};e.bpy_obj_has_anim_particles=function(a){for(var b=0;b<a.particle_systems.length;b++)if("EMITTER"==a.particle_systems[b].settings.type)return!0;return!1};e.has_dynamic_grass_particles=function(a){for(var b=0;b<a.particle_systems.length;b++){var c=a.particle_systems[b].settings;
if("HAIR"==c.type&&c.b4w_dynamic_grass)return!0}return!1};e.create_particles_data=function(a,b,c){var d=a.particles_data=l(b.name,b.settings.type);d.frame_start=b.settings.frame_start;d.frame_end=b.settings.frame_end;d.time_length=(d.frame_end-d.frame_start)/E.get_framerate();d.lifetime_frames=b.settings.lifetime;d.lifetime=d.lifetime_frames/E.get_framerate();d.cyclic=b.settings.b4w_cyclic?1:0;d.mass=b.settings.mass;d.nfactor=b.settings.normal_factor;d.gravity=9.81*b.settings.effector_weights.gravity;
d.fade_in=b.settings.b4w_fade_in/E.get_framerate();d.fade_out=b.settings.b4w_fade_out/E.get_framerate();d.wind_factor=b.settings.effector_weights.wind;d.use_world_space="WORLD"==b.settings.b4w_coordinate_system?!0:!1;var f,e,k;a.halo_particles?(f=c.halo_settings.size,e=c.halo_settings.hardness,30>e?(e=.5,k=.9):40>e?(e=.1,k=1):50>e?(e=0,k=.8):(e=0,k=.5)):(f=b.settings.particle_size,k=e=1);d.size=f;d.alpha_start=e;d.alpha_end=k;c.use_nodes&&"BILLBOARD"==b.settings.render_type&&(B.set_batch_directive(a,
"NODES",1),B.set_batch_directive(a,"PARTICLE_BATCH",1),a.has_nodes=!0);b=b.settings.texture_slots;b[0]&&b[0].use_map_size&&b[0].texture&&"BLEND"==b[0].texture.type&&b[0].texture.use_color_ramp&&J.allow_vertex_textures&&(b=b[0].texture,f=[],G.calc_color_ramp_data(b.color_ramp,G.PART_COLORRAMP_TEXT_SIZE,f),f=new Uint8Array(f.map(function(a){return p.M(255*a,0,255)})),f=G.create_color_ramp_texture(f,G.PART_COLORRAMP_TEXT_SIZE),B.append_texture(a,f,"u_color_ramp_tex",b.name),B.set_batch_directive(a,"USE_COLOR_RAMP",
1));c=c.texture_slots;a=[-1,0,0,0,-1,0,0,0,-1,0,0,0,-1,0,0,0];if(c[0]&&"STRAND"==c[0].texture_coords&&c[0].texture&&"BLEND"==c[0].texture.type&&c[0].texture.use_color_ramp){c=c[0].texture.color_ramp.elements;b=Math.min(4*c.length,a.length);for(f=0;f<b;f+=4)e=c[f/4],a[f]=e.position,a[f+1]=e.color[0],a[f+2]=e.color[1],a[f+3]=e.color[2];d.color_ramp_length=c.length}d.color_ramp.set(a)};e.generate_emitter_particles_submesh=function(a,d,f,e){var l=a.particles_data,q=e.world_tsr,w=f.settings.count,n=f.settings.frame_start/
E.get_framerate(),v=f.settings.frame_end/E.get_framerate(),D=f.settings.lifetime/E.get_framerate(),h=f.settings.lifetime_random,B=f.settings.emit_from,A=f.settings.factor_random;if(f.settings.use_rotations)var G=f.settings.angular_velocity_mode,y=f.settings.angular_velocity_factor;else G="NONE",y=0;var J=f.settings.b4w_randomize_emission,S=f.settings.b4w_cyclic;l.tilt=f.settings.billboard_tilt;l.tilt_rand=f.settings.billboard_tilt_random;m(f.seed);var T;d=z.extract_submesh_all_mats(d,["a_position",
"a_tbn"],null,e);switch(B){case "VERT":var t=d.va_frames[0].a_position;T=d.va_frames[0].a_tbn;d=t.length/3;B=[];for(f=0;f<w;f++)e=Math.round((d-1)*C()),B.push(e),B.push(e),B.push(e),B.push(e);d=[];for(f=0;f<B.length;f++)d.push(t[3*B[f]]),d.push(t[3*B[f]+1]),d.push(t[3*B[f]+2]);t=new Float32Array(d);d=k.c(B.length);for(f=0;f<B.length;f++)e=k.e(T,B[f],M),k.n(d,e,f);T=d;break;case "FACE":t=[];T=[];p._13(0,T);B=z.geometry_random_points(d,w,!1,T);p._13(0,T);d=z.geometry_random_points(d,w,!0,T);T=k.c(4*
B.length);for(f=0;f<B.length;f++)t.push(B[f][0],B[f][1],B[f][2]),t.push(B[f][0],B[f][1],B[f][2]),t.push(B[f][0],B[f][1],B[f][2]),t.push(B[f][0],B[f][1],B[f][2]),k.n(T,d[f],4*f),k.n(T,d[f],4*f+1),k.n(T,d[f],4*f+2),k.n(T,d[f],4*f+3);t=new Float32Array(t);break;case "VOLUME":b.panic("Particle emission from volume is not supported");break;default:b.panic("Wrong emit from option")}T=[t,T];t=T[0];T=T[1];l.positions=new Float32Array(t);l.tbn=new Float32Array(T);l.positions_cache=new Float32Array(t.length);
l.tbn_cache=new Float32Array(T.length);B=[];v=(v-n)/w;for(d=0;d<w;d++)f=J?v*d+10*v*(.5-C()):v*d,S||(f+=n),B.push(f),B.push(f),B.push(f),B.push(f);n=new Float32Array(B);l.delay_attrs=new Float32Array(n);l.delay_attrs_masked=new Float32Array(n);if(l.use_world_space){l.emitter_tsr_snapshots=new Float32Array(n.length*F.length);for(J=0;J<8*n.length;J++)r.u(q,l.emitter_tsr_snapshots,J);c(l,t,T,q,t,T)}q=z.init_submesh("EMITTER_PARTICLES");J=z.create_empty_va_frame();J.a_position=t;J.a_tbn=T;q.va_frames[0]=
J;a.draw_mode=z.DM_DYNAMIC_TRIANGLES;a=[];for(J=0;J<w;J++)a.push(4*J,4*J+2,4*J+1,4*J,4*J+3,4*J+2);a=new Uint16Array(a);q.indices=a;q.va_common.a_p_bb_vertex=z.gen_bb_vertices(w);q.base_length=t.length/3;a=[];h*=D;for(J=0;J<w;J++)S=h*C(),a.push(D-S),a.push(D-S),a.push(D-S),a.push(D-S);D=q.va_common;h=[];for(J=0;J<w;J++)S=Math.random(),h.push(a[4*J],n[4*J],S),h.push(a[4*J+1],n[4*J+1],S),h.push(a[4*J+2],n[4*J+2],S),h.push(a[4*J+3],n[4*J+3],S);h=new Float32Array(h);D.a_p_data=h;D=q.va_common;h=[];for(a=
0;a<w;a++){n=[C()-.5,C()-.5,C()-.5];u.normalize(n,n);h.push(A*n[0]);h.push(A*n[1]);h.push(A*n[2]);switch(G){case "NONE":h.push(0);break;case "SPIN":case "VELOCITY":h.push(y);break;case "RAND":h.push(2*y*(C()-.5));break;default:b.panic("Undefined velocity factor")}n=h.slice(-4);for(J=0;12>J;J++)h.push(n[J%4])}w=new Float32Array(h);D.a_p_vels=w;l.p_data=new Float32Array(q.va_common.a_p_data);return q};e.set_time=function(a,b,c){a=a.scenes_data;for(var d=0;d<a.length;d++)for(var f=a[d].batches,e=0;e<
f.length;e++){var l=f[e].particles_data;l&&l.name==b&&!f[e].forked_batch&&(l.prev_time=l.time,l.time=c)}};e.set_size=function(a,b,c){a=a.scenes_data;for(var d=0;d<a.length;d++)for(var f=a[d].batches,e=0;e<f.length;e++){var l=f[e].particles_data;l&&l.name==b&&(l.size=c)}};e.set_normal_factor=function(a,b,c){a=a.scenes_data;for(var d=0;d<a.length;d++)for(var f=a[d].batches,e=0;e<f.length;e++){var l=f[e].particles_data;l&&l.name==b&&(l.nfactor=c)}};e.get_normal_factor=function(a,b){for(var c=a.scenes_data,
d=0;d<c.length;d++)for(var f=c[d].batches,e=0;e<f.length;e++){var l=f[e].particles_data;if(l&&l.name==b)return l.nfactor}return 0};e.set_factor=function(a,b,c){a=a.scenes_data;for(var d=0;d<a.length;d++)for(var f=a[d].batches,e=0;e<f.length;e++){var l=f[e],k=l.particles_data;if(k&&k.name==b){k.count_factor=c;var m=k.delay_attrs;if(1==c)var p=m;else if(0==c)for(var p=k.delay_attrs_masked,h=0;h<p.length;h+=4)p[h]=1E4,p[h+1]=p[h],p[h+2]=p[h],p[h+3]=p[h];else for(var n=4/c,p=k.delay_attrs_masked,r=0,
h=0;h<p.length;h+=4)h>=r?(p[h]=m[h],r+=n):p[h]=1E4,p[h+1]=p[h],p[h+2]=p[h],p[h+3]=p[h];l=l.bufs_data;if(l.pointers.a_p_data){k=k.p_data;for(h=0;h<k.length;h+=3)k[h+1]=p[Math.round(h/3)];z.update_bufs_data_array(l,"a_p_data",3,k)}}}};e.update_start_pos=function(){var a=r.b();return function(b,c,d,f){b=b.scenes_data;r.v(c,a);r.s(d,a);c=r.r(f,a);for(d=0;d<b.length;d++){f=b[d].batches;for(var e=0;e<f.length;e++){var l=f[e].particles_data;if(l&&l.use_world_space)for(var k=0;k<8*l.delay_attrs.length;k++)r.u(c,
l.emitter_tsr_snapshots,k)}}}}();e.update_particles_submesh=function(a,b,c){a.va_common.a_tbn=k.c(4*c);k.i(a.va_common.a_tbn);if(b.part_node_data){for(var d=[],f=0;f<c;f++)d.push(f,f,f,f);a.va_common[b.part_node_data.name]=new Float32Array(d)}};e.update_particles_objs_cache=function(a){-1==K.indexOf(a)&&K.push(a)};e.remove_obj_from_cache=function(a){a=K.indexOf(a);-1!=a&&K.splice(a,1)};e.cleanup=function(){K.length=0}});t.a=e},function(C,t,e){function R(e){if(""==e)return".";var n=0==e.indexOf("/")|
0;n&&0==e.indexOf("//")&&0!=e.indexOf("///")&&(n=2);e=e.split("/");for(var y=[],d=0;d<e.length;d++){var k=e[d];""!=k&&"."!=k&&(".."!=k||!n&&!y.length||y.length&&".."==y[y.length-1]?y.push(k):y.length&&y.pop())}e=y.join("/");for(d=0;d<n;d++)e="/"+e;return e||"."}t.b=function(e){var n=e.split("://",2);return 1<n.length?(n[1]=R(n[1]),n.join("://")):R(e)};t.a=function(e){return/(?:\.([^.]+))?$/.exec(e)[1]}},function(C,t,e){C=e(0);var R=e(39),V=e(14),n=e(4),y=e(15),d=e(9),k=e(1),I=e(10),A=e(7);e=Object(C.a)("input",
function(e,p){function r(d){b.error_deprecated("enable_split_screen","screen.request_split_screen");var e=a.get_device_by_type_element(a.DEVICE_HMD);if(!e)return!1;if(z)return!0;var l=a.get_vector_param(e,a.HMD_FOV_LEFT,T),k=a.get_vector_param(e,a.HMD_FOV_RIGHT,t);B.set_hmd_fov(d,l,k);if(l=a.get_value_param(e,J))k=f.get_active(),d=m.get_scene_data(d,k).cameras,B.set_eye_distance(d,l);d={base_line_factor:.5,inter_lens_factor:.5,enable_hmd_stereo:!0};a.get_value_param(e,a.HMD_WEBVR_TYPE)&(a.HMD_NON_WEBVR|
a.HMD_WEBVR_MOBILE|a.HMD_WEBVR_DESKTOP)&&(d.distortion_coefs=[e.distortion_coefs[0],e.distortion_coefs[1]],d.chromatic_aberration_coefs=[e.chromatic_aberration_coefs[0],e.chromatic_aberration_coefs[1],e.chromatic_aberration_coefs[2],e.chromatic_aberration_coefs[3]],e.webvr_hmd_device||(e.base_line_dist&&e.height_dist&&e.bevel_size?d.base_line_factor=(e.base_line_dist-e.bevel_size)/e.height_dist:e.bevel_size||(d.base_line_factor=e.base_line_dist/e.height_dist)),e.inter_lens_dist&&e.width_dist&&!e.webvr_hmd_device&&
(d.inter_lens_factor=e.inter_lens_dist/e.width_dist),G.enabled||(l=1+e.distortion_coefs[0]+e.distortion_coefs[1],f.multiply_size_mult(l,l)));f.set_hmd_params(d);c.resize_to_container(!0);a.reset_device(e);return z=!0}var a=Object(R.a)(e),B=Object(V.a)(e),l=Object(n.a)(e),c=Object(y.a)(e),m=Object(d.a)(e),b=Object(k.a)(e),f=Object(I.a)(e),T=A.create(),t=A.create(),z=!1,G=l.debug_subs,E=l.defaults;p.GMPD_BUTTON_12=a.GMPD_BUTTON_12;p.GMPD_BUTTON_13=a.GMPD_BUTTON_13;p.GMPD_BUTTON_15=a.GMPD_BUTTON_15;
p.GMPD_BUTTON_14=a.GMPD_BUTTON_14;p.GMPD_BUTTON_3=a.GMPD_BUTTON_3;p.GMPD_BUTTON_0=a.GMPD_BUTTON_0;p.GMPD_BUTTON_1=a.GMPD_BUTTON_1;p.GMPD_BUTTON_2=a.GMPD_BUTTON_2;p.GMPD_BUTTON_5=a.GMPD_BUTTON_5;p.GMPD_BUTTON_7=a.GMPD_BUTTON_7;p.GMPD_BUTTON_4=a.GMPD_BUTTON_4;p.GMPD_BUTTON_6=a.GMPD_BUTTON_6;p.GMPD_BUTTON_8=a.GMPD_BUTTON_8;p.GMPD_BUTTON_9=a.GMPD_BUTTON_9;p.GMPD_BUTTON_10=a.GMPD_BUTTON_10;p.GMPD_BUTTON_11=a.GMPD_BUTTON_11;p.GMPD_BUTTON_16=a.GMPD_BUTTON_16;p.GMPD_BUTTON_17=a.GMPD_BUTTON_17;p.GMPD_BUTTON_18=
a.GMPD_BUTTON_18;p.GMPD_BUTTON_19=a.GMPD_BUTTON_19;p.GMPD_BUTTON_20=a.GMPD_BUTTON_20;p.GMPD_BUTTON_21=a.GMPD_BUTTON_21;p.GMPD_BUTTON_22=a.GMPD_BUTTON_22;p.GMPD_BUTTON_23=a.GMPD_BUTTON_23;p.GMPD_BUTTON_24=a.GMPD_BUTTON_24;p.GMPD_BUTTON_25=a.GMPD_BUTTON_25;p.GMPD_TRACKPAD_BUTTON=a.GMPD_TRACKPAD_BUTTON;p.GMPD_TRIGGER_BUTTON=a.GMPD_TRIGGER_BUTTON;p.GMPD_GRIPS_BUTTON=a.GMPD_GRIPS_BUTTON;p.GMPD_MENU_BUTTON=a.GMPD_MENU_BUTTON;p.GMPD_AXIS_0=a.GMPD_AXIS_0;p.GMPD_AXIS_1=a.GMPD_AXIS_1;p.GMPD_AXIS_2=a.GMPD_AXIS_2;
p.GMPD_AXIS_3=a.GMPD_AXIS_3;p.GMPD_AXIS_4=a.GMPD_AXIS_4;p.GMPD_AXIS_5=a.GMPD_AXIS_5;p.GMPD_AXIS_6=a.GMPD_AXIS_6;p.GMPD_AXIS_7=a.GMPD_AXIS_7;p.GMPD_AXIS_8=a.GMPD_AXIS_8;p.GMPD_AXIS_9=a.GMPD_AXIS_9;p.GMPD_AXIS_10=a.GMPD_AXIS_10;p.GMPD_AXIS_11=a.GMPD_AXIS_11;p.HMD_ORIENTATION_QUAT=a.HMD_ORIENTATION_QUAT;p.HMD_POSITION=a.HMD_POSITION;p.HMD_WEBVR_TYPE=a.HMD_WEBVR_TYPE;p.HMD_WEBVR_DESKTOP=a.HMD_WEBVR_DESKTOP;p.HMD_WEBVR_MOBILE=a.HMD_WEBVR_MOBILE;p.HMD_NON_WEBVR=a.HMD_NON_WEBVR;p.HMD_WEBVR1=a.HMD_WEBVR1;
p.HMD_WEBVR1_1=a.HMD_WEBVR1_1;var J=a.HMD_EYE_DISTANCE;p.HMD_EYE_DISTANCE=J;p.HMD_DISTORTION=a.HMD_DISTORTION;p.HMD_BASELINE_DIST=a.HMD_BASELINE_DIST;p.HMD_SCREEN_LENS_DIST=a.HMD_SCREEN_LENS_DIST;p.HMD_SCREEN_WIDTH=a.HMD_SCREEN_WIDTH;p.HMD_SCREEN_HEIGHT=a.HMD_SCREEN_HEIGHT;p.HMD_BEVEL_SIZE=a.HMD_BEVEL_SIZE;p.MOUSE_LOCATION=a.MOUSE_LOCATION;p.MOUSE_DOWN_WHICH=a.MOUSE_DOWN_WHICH;p.MOUSE_UP_WHICH=a.MOUSE_UP_WHICH;p.MOUSE_WHEEL=a.MOUSE_WHEEL;p.KEYBOARD_UP=a.KEYBOARD_UP;p.KEYBOARD_DOWN=a.KEYBOARD_DOWN;
p.TOUCH_START=a.TOUCH_START;p.TOUCH_MOVE=a.TOUCH_MOVE;p.TOUCH_END=a.TOUCH_END;p.GYRO_ORIENTATION_QUAT=a.GYRO_ORIENTATION_QUAT;p.GYRO_ORIENTATION_ANGLES=a.GYRO_ORIENTATION_ANGLES;var M={};M[a.DEVICE_HMD]=[a.HMD_ORIENTATION_QUAT,a.HMD_POSITION];M[a.DEVICE_MOUSE]=[a.MOUSE_LOCATION];var F={};F[a.DEVICE_HMD]=[a.HMD_WEBVR_TYPE];var U={};U[a.DEVICE_MOUSE]=[a.MOUSE_LOCATION,a.MOUSE_DOWN_WHICH,a.MOUSE_UP_WHICH,a.MOUSE_WHEEL];U[a.DEVICE_KEYBOARD]=[a.KEYBOARD_UP,a.KEYBOARD_DOWN];U[a.DEVICE_TOUCH]=[a.TOUCH_START,
a.TOUCH_MOVE,a.TOUCH_END];U[a.DEVICE_GYRO]=[a.GYRO_ORIENTATION_QUAT,a.GYRO_ORIENTATION_ANGLES];var K={};K[a.DEVICE_HMD]=[a.HMD_DISTORTION,a.HMD_EYE_DISTANCE,a.HMD_BASELINE_DIST,a.HMD_SCREEN_LENS_DIST,a.HMD_SCREEN_WIDTH,a.HMD_SCREEN_HEIGHT,a.HMD_BEVEL_SIZE];p.DEVICE_GYRO=a.DEVICE_GYRO;p.DEVICE_HMD=a.DEVICE_HMD;p.DEVICE_MOUSE=a.DEVICE_MOUSE;p.DEVICE_KEYBOARD=a.DEVICE_KEYBOARD;p.DEVICE_TOUCH=a.DEVICE_TOUCH;p.can_use_device=a.can_use_device;p.get_device_by_type_element=a.get_device_by_type_element;p.switch_prevent_default=
function(b,c){b&&a.switch_prevent_default(b,c)};p.register_device=function(){b.error_once("input.register_device() deprecated")};p.reset_device=function(c){c&&c.type==a.DEVICE_HMD?a.reset_device(c):b.error("reset_device is undefined for device.")};p.get_vector_param=function(c,d,f){if(c&&c.type in M&&0<=M[c.type].indexOf(d))return a.get_vector_param(c,d,f);b.error("device hasn't param: ",d);return null};p.get_value_param=function(c,d){if(c&&c.type in F&&0<=F[c.type].indexOf(d))return a.get_value_param(c,
d);b.error("device hasn't param: ",d);return null};p.attach_param_cb=function(c,d,f){f=f||null;if(c&&c.type in U&&0<=U[c.type].indexOf(d))return a.attach_param_cb(c,d,f);b.error("device hasn't param: ",d)};p.detach_param_cb=function(c,d,f){f=f||null;if(c&&c.type in U&&0<=U[c.type].indexOf(d))return a.detach_param_cb(c,d,f);b.error("device hasn't param: ",d)};p.set_config=function(c,d,f){if(c&&c.type in K&&0<=K[c.type].indexOf(d))return a.set_config(c,d,f);b.error("device hasn't config: ",d)};p.request_fullscreen_hmd=
function(){b.error_deprecated("request_fullscreen_hmd","screen.request_fullscreen_hmd");if(f.check_active()){var d=f.get_camera(f.get_active());if(d&&(r(d),d=a.get_device_by_type_element(a.DEVICE_HMD))){var e=d.webvr_display;e&&!e.isPresenting&&(e.capabilities.canPresent?(d=c.get_canvas(),e.requestPresent([{source:d}]).then(function(){if(!E.is_mobile_device){var a=e.getEyeParameters("left"),b=e.getEyeParameters("right");c.resize(2*Math.max(a.renderWidth,b.renderWidth),Math.max(a.renderHeight,b.renderHeight),
!1)}},function(){b.error("HMD fullscreen request failed.")})):b.error("HMD fullscreen request failed."))}}};p.enable_split_screen=r;p.disable_split_screen=function(){b.error_deprecated("disable_split_screen","screen.exit_split_screen");var d=a.get_device_by_type_element(a.DEVICE_HMD);if(!z||!d||!d.registered)return!1;f.set_hmd_params({enable_hmd_stereo:!1});d=1/(1+d.distortion_coefs[0]+d.distortion_coefs[1]);f.multiply_size_mult(d,d);c.resize_to_container(!0);return!0};p.set_gamepad_key=function(b,
c,d){switch(b){case 0:b=a.DEVICE_GAMEPAD0;break;case 1:b=a.DEVICE_GAMEPAD1;break;case 2:b=a.DEVICE_GAMEPAD2;break;case 3:b=a.DEVICE_GAMEPAD3;break;default:b=a.DEVICE_GAMEPAD0}b=a.get_device_by_type_element(b);a.set_config(b,c,d)};p.get_pressed_gmpd_btn=a.get_pressed_gmpd_btn;p.get_moved_gmpd_axis=a.get_moved_gmpd_axis;p.get_gamepad_position=a.get_gamepad_position;p.get_gamepad_orientation=a.get_gamepad_orientation;p.check_enable_gamepad_indices=function(){for(var a=navigator.getGamepads?navigator.getGamepads():
navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],b=[],c=0;c<a.length;c++)a[c]&&b.push(c);return b};p.get_vr_controller_id=function(a){for(var b=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],c=0,d=0;4>c;c++){var f=b[c];if(f&&(""==f.id||"OpenVR Gamepad"==f.id||"Oculus Touch (Left)"==f.id||"Oculus Touch (Right)"==f.id)){if(d==a)return d;d++}}return a};p.add_click_listener=function(b,c){b&&c&&a.add_click_listener(b,c)};p.remove_click_listener=
function(b,c){b&&c&&a.remove_click_listener(b,c)}});t.a=e},function(C,t,e){C=e(0);var R=e(14),V=e(15),n=e(4),y=e(51),d=e(39),k=e(79),I=e(9),A=e(1),r=e(10),p=e(7);e=Object(C.a)("screen",function(e,a){function u(a,c,d){function f(){document.fullscreenElement===a||document.webkitFullscreenElement===a||document.mozFullScreenElement===a||document.webkitIsFullScreen||document.msFullscreenElement===a?c():(document.removeEventListener("fullscreenchange",f,!1),document.removeEventListener("webkitfullscreenchange",
f,!1),document.removeEventListener("mozfullscreenchange",f,!1),document.removeEventListener("MSFullscreenChange",f,!1),d())}a=a||b.get_container();c=c||function(){};d=d||function(){};document.addEventListener("fullscreenchange",f,!1);document.addEventListener("webkitfullscreenchange",f,!1);document.addEventListener("mozfullscreenchange",f,!1);document.addEventListener("MSFullscreenChange",f,!1);a.requestFullScreen=a.requestFullScreen||a.webkitRequestFullScreen||a.mozRequestFullScreen||a.msRequestFullscreen;
a.requestFullScreen?a.requestFullScreen():E.error("B4W App: request fullscreen method is not supported")}function l(){var a=document.exitFullscreen||document.webkitExitFullscreen||document.mozCancelFullScreen||document.msExitFullscreen;"function"!=typeof a&&E.error("B4W App: exit fullscreen method is not supported");a.apply(document)}function c(a){var c=t.get_device_by_type_element(t.DEVICE_HMD);if(!c)return!1;if(U)return!0;var d=t.get_value_param(c,t.HMD_WEBVR_TYPE);if(d&t.HMD_WEBVR1_1){var f=c.webvr_display,
e=f.getEyeParameters("left"),f=f.getEyeParameters("right");b.resize(2*Math.max(e.renderWidth,f.renderWidth),Math.max(e.renderHeight,f.renderHeight),!1)}else e=b.get_canvas(),e=Math.max(2*e.height,e.width),b.resize(e,e/2,!1);e=t.get_vector_param(c,t.HMD_FOV_LEFT,M);f=t.get_vector_param(c,t.HMD_FOV_RIGHT,F);m.set_hmd_fov(a,e,f,!(d&t.HMD_WEBVR1_1));e={base_line_factor:.5,inter_lens_factor:.5,enable_hmd_stereo:!0};d&(t.HMD_NON_WEBVR|t.HMD_WEBVR_MOBILE|t.HMD_WEBVR_DESKTOP)&&(e.distortion_coefs=[c.distortion_coefs[0],
c.distortion_coefs[1]],e.chromatic_aberration_coefs=[c.chromatic_aberration_coefs[0],c.chromatic_aberration_coefs[1],c.chromatic_aberration_coefs[2],c.chromatic_aberration_coefs[3]],c.webvr_hmd_device||(c.base_line_dist&&c.height_dist&&c.bevel_size?e.base_line_factor=(c.base_line_dist-c.bevel_size)/c.height_dist:c.bevel_size||(e.base_line_factor=c.base_line_dist/c.height_dist)),c.inter_lens_dist&&c.width_dist&&!c.webvr_hmd_device&&(e.inter_lens_factor=c.inter_lens_dist/c.width_dist));v.enabled||J.multiply_size_mult(.5,
1);J.set_hmd_params(e);if(c=t.get_value_param(c,t.HMD_EYE_DISTANCE))d=J.get_active(),a=G.get_scene_data(a,d).cameras,m.set_eye_distance(a,c);J.render_both_eyes();return U=!0}var m=Object(R.a)(e),b=Object(V.a)(e),f=Object(n.a)(e),T=Object(y.a)(e),t=Object(d.a)(e),z=Object(k.a)(e),G=Object(I.a)(e),E=Object(A.a)(e),J=Object(r.a)(e),M=p.create(),F=p.create(),U=!1,K=function(){},C=function(){},v=f.debug_subs;a.draw_mixer_strip=T.draw_mixer_strip;a.plot_array=T.plot_array;a.request_fullscreen=u;a.exit_fullscreen=
l;a.check_fullscreen=t.check_fullscreen;a.request_fullscreen_hmd=function(a,c,d){if("HMD"!=!f.get("stereo")||"NONE"==f.get("stereo")&&f.get("is_mobile_device")){var e=t.get_device_by_type_element(t.DEVICE_HMD);if(e&&t.get_value_param(e,t.HMD_WEBVR_TYPE)&t.HMD_WEBVR1){var l=e.webvr_display;l&&!l.isPresenting&&(c=c||function(){},d=d||function(){},C=function(){l.isPresenting?c():(window.removeEventListener("vrdisplaypresentchange",C),d())},window.addEventListener("vrdisplaypresentchange",C,!1),l.capabilities.canPresent?
(a=b.get_canvas(),l.requestPresent([{source:a}]).then(function(){},function(){E.error("HMD fullscreen request failed.")})):E.error("HMD fullscreen request failed."))}else u(a,c,d)}};a.exit_fullscreen_hmd=function(){if("HMD"!=!f.get("stereo")||"NONE"==f.get("stereo")&&f.get("is_mobile_device")){var a=t.get_device_by_type_element(t.DEVICE_HMD);a&&t.get_value_param(a,t.HMD_WEBVR_TYPE)&t.HMD_WEBVR1?(a=a.webvr_display)&&a.isPresenting&&(a.exitPresent(),b.resize_to_container(!0)):l()}};a.check_fullscreen_hmd=
function(){var a=t.get_device_by_type_element(t.DEVICE_HMD),b=t.get_value_param(a,t.HMD_WEBVR_TYPE)&t.HMD_WEBVR1;return a&&(b&&a.webvr_display||!b&&t.check_fullscreen())?!0:!1};a.request_split_screen=function(a,b){var d=t.get_device_by_type_element(t.DEVICE_HMD);if(!d)return!1;if(U)return!0;K=b;if(J.check_active()){var f=J.get_camera(J.get_active());f&&(d.registered?(c(f),a&&a()):(t.request_register_device(d),d.registered_cb=function(){c(f);a&&a()}))}};a.exit_split_screen=function(){var a=t.get_device_by_type_element(t.DEVICE_HMD);
if(!U||!a||!a.registered)return!1;J.set_hmd_params({enable_hmd_stereo:!1});U=!1;K&&K();J.render_one_eye();v.enabled||J.multiply_size_mult(2,1);b.resize_to_container(!0);return!0};a.shot=function(a,b){a=a||"image/png";z.canvas_data_url(function(b){var c="screenshot."+a.split("/")[1];navigator.msSaveOrOpenBlob?navigator.msSaveOrOpenBlob(b,c):(c=window.document.createElement("a"),document.body.appendChild(c),c.style.display="none",c.href=b,c.download="screenshot."+a.split("/")[1],c.click(),document.body.removeChild(c))},
a,b||1,!0)}});t.a=e},function(C,t,e){C=e(0);var R=e(31),V=e(11);e=Object(C.a)("__hud",function(e,y){function d(a){a.font="bold 15px Courier New";a.textBaseline="middle";a.shadowBlur=0;a.shadowColor=null}function k(b){n(' SCENE "'+b.name+'"');n(" Active                 Subscene   Lamps   Size   RenderCalls   Time");if(b._render){var c=0,d=0,e=0;a.traverse(b._render.graph,function(a,b){if(b.type!=B.SINK){for(var f=Math.round(b.camera.width)+"x"+Math.round(b.camera.height),l=0,k=0;k<b.draw_data.length;k++)l+=
b.draw_data[k].bundles.length;k=b.debug_render_calls;if(b.type==B.MAIN_CUBE_REFLECT||b.type==B.MAIN_CUBE_REFLECT_BLEND)l*=6;var m=b.do_render&&!b.force_do_not_render,p=m?b.debug_render_time:0;b.enqueue||(b.debug_render_time=0);var r=m?" (\u2713)":" (\u2715)",z=B.subs_label(b);n(r,z,b.num_lights,f,k,"of",l,"  ",p.toFixed(3));b.debug_render_calls=0;c+=l;m&&(d+=k,e+=p)}});return[c,d,e]}n("No INFO")}function n(){for(var a=80+20*m[0],d=arguments[0],e=1;e<arguments.length;e++){for(var k=l[e]-String(arguments[e]).length,
p="",n=0;n<k;n++)p+=" ";d+=p+arguments[e]}m[0]++;c.fillText(d,30,a)}function A(a,c,d,e,l){l.x=a;l.y=c;l.w=d;l.h=e;return l}function r(a,c,d){c*=a.w;d.x=a.x+c;d.y=a.y;d.w=a.w-2*c;d.h=a.h;return d}function p(a){return a.x+a.w/2}function u(a){var b=c,d={x:0,y:0,w:0,h:0};A(0,0,b.canvas.width,b.canvas.height,d);r(d,.01,d);b=.02*d.h;d.x=d.x;d.y+=b;d.w=d.w;d.h-=2*b;b=d.w/8;d.x+=b*a;d.y=d.y;d.w=b;d.h=d.h;r(d,.02,d);return d}var a=Object(R.a)(e),B=Object(V.a)(e),l=[5,30,4,10,5,3,5],c=null,m=[0,0];y.init=function(a){a=
a.getContext("2d");d(a);return c=a};y.update_dim=function(){c&&d(c)};y.reset=function(){var a=c;a&&(a.clearRect(0,0,a.canvas.width,a.canvas.height),a.fillStyle="rgba(0,0,0,0.5)",a.fillRect(0,0,a.canvas.width,a.canvas.height),m[0]=0,m[1]=0)};y.show_debug_info=function(a,d){var b=c;if(b){b.textAlign="left";b.fillStyle="rgba(0,255,0,255)";n(" FPS",(1/d).toFixed(2));m[0]++;for(var f=b=0,e=0,l=0;l<a.length;l++){var p=k(a[l]),b=b+p[0],f=f+p[1],e=e+p[2];m[0]++}n(" ----------------------------------------------------------------");
n("    ","TOTAL ACTIVE","","",f,"of",b,"  ",e.toFixed(3))}};y.print=function(){var a=c;a&&(a.textAlign="left",a.fillStyle="rgba(0,255,0,255)",n.apply(Math,arguments))};y.plot_array=function(a,d,e,l,k,m,n){var b=c;if(b){d=u(d);var f=d.h/5;d.x=d.x;d.y+=4*f;d.w=d.w;d.h=f;b.textAlign="center";b.fillStyle="#00FF00";c.fillText(a,p(d),d.y-10);b.strokeStyle="#00FF00";b.lineWidth=.5;b.beginPath();b.moveTo(d.x,d.y);b.lineTo(d.x+d.w,d.y);b.lineTo(d.x+d.w,d.y+d.h);b.lineTo(d.x,d.y+d.h);b.closePath();b.stroke();
if(!m&&!n)for(m=1E6,n=-1E6,a=0;a<e.length;a++)m=Math.min(m,e[a]),n=Math.max(n,e[a]);b.textAlign="right";c.fillText(String(m),d.x-10,d.y+d.h);c.fillText(String(n),d.x-10,d.y);b.textAlign="center";c.fillText(String(l),d.x,d.y+d.h+15);c.fillText(String(k),d.x+d.w,d.y+d.h+15);b.strokeStyle="#FF0000";b.lineWidth=1.5;b.beginPath();l=d.w/(e.length-1);n=d.h/(n-m);for(a=0;a<e.length;a++)k=d.x+l*a,f=d.y+d.h-(e[a]-m)*n,0==a?b.moveTo(k,f):b.lineTo(k,f);b.stroke()}};y.draw_mixer_strip=function(a,d,e,l,k,m,n){var b=
c;if(b)for(b.textAlign="center",b.fillStyle="#00FF00",b.font="bold 12px Courier",e=u(e),c.fillText(d?"["+a+"]":a,p(e),e.y),0<=m&&c.fillText(m?"[M]":"[ ]",p(e)-15,e.y+30),0<=n&&c.fillText(n?"[S]":"[ ]",p(e)+15,e.y+30),a={x:0,y:0,w:0,h:0},d=0;d<l.length;d++){var f=l[d];(n="VOLUME"==f[0])?A(e.x,e.y+350,e.w,250,a):A(e.x,e.y+50+50*d,e.w,e.h,a);m=b;var r=a,z=d==k,E=f[0],B=f[1],v=f[2],y=f[3],G=f[5],f=(y-v)/f[4],f=1>f?Math.floor(1/f-1E-5).toFixed(0).length:0,G=G?Math.log(B/v)/Math.log(y/v):(B-v)/(y-v);m.textAlign=
"center";z?m.fillText("["+E+"]",p(r),r.y):m.fillText(E,p(r),r.y);m.strokeStyle="#00FF00";m.lineWidth=n?3:1;n?(m.textAlign="right",m.fillText(y.toFixed(f),p(r)-10,r.y+15),m.textAlign="right",m.fillText(v.toFixed(f),p(r)-10,r.y+r.h-15)):(m.textAlign="right",m.fillText(v.toFixed(f),r.x+28,r.y+15),m.textAlign="left",m.fillText(y.toFixed(f),r.x+r.w-28,r.y+15));m.beginPath();if(n){var t=r.y+15+(r.h-30)*(1-G);m.moveTo(p(r),r.y+15);m.lineTo(p(r),r.y+r.h-15);m.moveTo(p(r)-5,r.y+15);m.lineTo(p(r)+5,r.y+15);
m.moveTo(p(r)-5,r.y+r.h-15);m.lineTo(p(r)+5,r.y+r.h-15);m.moveTo(p(r)-5,t);m.lineTo(p(r)+5,t)}else{var L=r.x+30+(r.w-60)*G;m.moveTo(r.x+30,r.y+15);m.lineTo(r.x+r.w-30,r.y+15);m.moveTo(r.x+30,r.y+15-5);m.lineTo(r.x+30,r.y+15+5);m.moveTo(r.x+r.w-30,r.y+15-5);m.lineTo(r.x+r.w-30,r.y+15+5);m.moveTo(L,r.y+15-5);m.lineTo(L,r.y+15+5)}m.stroke();"EQ_Q"==E?(z=B,z=Math.log(1+1/(2*z*z)+Math.sqrt((2+1/(z*z))*(2+1/(z*z))/4-1))/Math.log(2),n?(m.textAlign="left",m.fillText(B.toFixed(f),p(r)+10,t),m.textAlign="left",
m.fillText("("+z.toFixed(f+1)+")",p(r)+10,t+10)):(m.textAlign="right",m.fillText(B.toFixed(f),L,r.y+30),m.textAlign="left",m.fillText("("+z.toFixed(f+1)+")",L,r.y+30))):n?(m.textAlign="left",m.fillText(B.toFixed(f),p(r)+10,t)):(m.textAlign="center",m.fillText(B.toFixed(f),L,r.y+30))}}});t.a=e},function(C,t,e){C=e(0);var R=e(38),V=e(12),n=e(9),y=e(1),d=e(10),k=e(23),I=e(17),A=e(18),r=e(2);e=Object(C.a)("__nla",function(e,u){function a(a,b){for(var c=E.get_all_actions(),d=[],f=0,e=0;e<a.length;e++){var l=
a[e];""!=l.anim_uuid?l=r._19("uuid",l.anim_uuid,c):(l=l.anim_name,l=r._19("name",l,c)||r._19("name",l+"_B4W_BAKED",c));if(l){var l=l.fcurves,h=[],k;for(k in l)h.push(k);d.push(h)}}for(e=0;e<d.length;e++){c=!1;for(k=0;k<e;k++)if(r.E(d[e],d[k])){a[e].anim_slot=a[k].anim_slot;c=!0;break}c||(a[e].anim_slot=b+f++)}return f}function p(){return{type:"CLIP",frame_start:0,frame_end:0,scheduled:!1,paused:!1,anim_name:"",anim_uuid:"",anim_slot:0,name_list:null,action_frame_start:0,action_frame_end:0,ext_frame_start:0,
ext_frame_end:0,use_reverse:!1,scale:1,repeat:1,action_frame_final:0}}function l(a,b,c){if(a.animation_data){var d=a.animation_data.nla_tracks;if(d)for(var f=0;f<d.length;f++)d[f].name_list=c,b.push(d[f])}a=a.nodes;for(f=0;f<a.length;f++)if(d=a[f],d.node_group){var e=d.node_group.node_tree;if(e){var k=c.slice();k.push(d.name);l(e,b,k)}}}function c(a,b){var c=Math.round(a)-b.frame_start;b.use_cyclic&&(c%=b.frame_duration,0>c&&(c+=b.frame_duration));return b.frame_offset+c}function m(a,b){var c=(b-
ha)*v.get_framerate()+a.frame_offset;c>a.frame_start?(c-=a.frame_start,a.cyclic&&(c%=a.frame_end-a.frame_start+1),c+=a.frame_start):c=a.frame_start;return c}function b(a,b){a=r.M(a,b.frame_start,b.frame_end);var c=a==b.frame_end?b.action_frame_final:b.action_frame_start+(a-b.frame_start)/b.scale%(b.action_frame_end-b.action_frame_start);b.use_reverse&&(c=b.action_frame_end-c+b.action_frame_start);return c}function f(a,b){for(var c=[],d=0;d<a.length;d++){var f=a[d],e=f.strips;if(e)for(var l=0;l<e.length;l++){var h=
e[l],k=p();k.type=h.type;k.frame_start=h.frame_start;k.frame_end=h.frame_end;k.anim_slot=b;k.action_frame_start=h.action_frame_start;k.action_frame_end=h.action_frame_end;k.use_reverse=h.use_reverse;k.scale=h.scale;k.repeat=h.repeat;h.action&&(k.anim_name=h.action.name,k.anim_uuid=h.action.uuid,k.name_list=f.name_list);c.push(k)}}return c}function t(a){return("SPEAKER"==a.type||"LAMP"==a.type)&&a.data.animation_data&&a.data.animation_data.nla_tracks.length?!0:!1}function fa(a){if("MESH"!=a.type||
!a.data)return!1;a=a.data.materials;if(!a)return!1;for(var b=0;b<a.length;b++){var c=a[b],d=c.node_tree;if(c.use_nodes&&d&&z(d))return!0}return!1}function z(a,b){if(a.animation_data){var c=a.animation_data.nla_tracks;if(c&&c.length)return!0}for(var c=a.nodes,d=0;d<c.length;d++){var f=c[d];f.node_group&&(f=f.node_group.node_tree)&&z(f,b)}return!1}function G(a,b){var c=U.get_active();if(c._nla){var d=m(c._nla,b);c._nla.frame_offset-=d-a;c._nla.force_update=!0}}var E=Object(R.a)(e),J=Object(V.a)(e),
M=Object(n.a)(e),F=Object(y.a)(e),U=Object(d.a)(e),K=Object(k.a)(e),C=Object(I.a)(e),v=Object(A.a)(e),Y=[],ha=-1;u.update_object=function(b,c){for(var d,e=null,k=c.scenes_data.length-1;0<=k&&(d=c.scenes_data[k],!d.scene.b4w_use_nla||(e=d,!d.scene._is_main));k--);if(d=e){d.obj_has_nla_on_scene=!0;e=0;if((k=b.animation_data)&&k.nla_tracks.length){var m=k.nla_tracks;if(M.is_armature(c)||M.is_camera(c)||M.is_mesh(c)||M.is_empty(c)||M.is_line(c)||M.is_lamp(c)||M.is_speaker(c)||M.is_world(c))m=f(m,e),m.length&&
(c.nla_events=c.nla_events.concat(m),e++)}t(b)&&(m=b.data.animation_data.nla_tracks,m=f(m,e),m.length&&(c.nla_events=c.nla_events.concat(m),e++));if(M.is_mesh(c))for(var n=c.materials,k=0;k<n.length;k++){var h=n[k];h.use_nodes&&h.node_tree&&(m=[],l(h.node_tree,m,[h.name]),m=f(m,e),m.length&&(e+=a(m,e),c.nla_events=c.nla_events.concat(m)))}if(M.is_world(c))b.use_nodes&&b.node_tree&&(m=[],l(b.node_tree,m,[b.name]),m=f(m,e),m.length&&(a(m,e),c.nla_events=c.nla_events.concat(m)));else{for(k=0;k<b.particle_systems.length;k++)m=
b.particle_systems[k],n=m.settings,"EMITTER"==n.type&&n.b4w_allow_nla&&(n=p(),n.type="CLIP",n.frame_start=d.scene.frame_start,n.frame_end=d.scene.frame_end+1,n.anim_name=m.name,n.anim_slot=e,n.action_frame_start=n.frame_start,n.action_frame_end=n.frame_end,c.nla_events.push(n),e++);d=e+1;for(k=0;k<c.vertex_anim.length;k++)m=c.vertex_anim[k],m.allow_nla&&(e=d,n=p(),n.type="CLIP",n.frame_start=m.frame_start,n.frame_end=m.frame_end,n.anim_name=m.name,n.anim_slot=e,n.action_frame_start=n.frame_start,
n.action_frame_end=n.frame_end,c.nla_events.push(n))}}};u.update_scene=function(a,b,c){a._nla||(a._nla={frame_start:a.frame_start,frame_end:a.frame_end,frame_offset:0,last_frame:-1,range_end:a.frame_end,range_start:a.frame_start,user_callback:null,cyclic:b,objects:[],textures:[],scene_name:a.name,is_stopped:!1,force_update:!1,rewinded_to_start:!0},Y.push(a._nla));b=a._nla;for(var d=J.get_scene_objs_derived(a,"ALL",c),f=0;f<d.length;f++){var e=d[f];if(e.nla_events.length){b.objects[c]||(b.objects[c]=
[]);for(var l=0;l<e.scenes_data.length;l++){var h=e.scenes_data[l];h.scene==a&&h.obj_has_nla_on_scene&&b.objects[c].push(e)}for(var l=e.nla_events,h=b,k=e.name,m=0;m<l.length;m++){var q=l[m];h.frame_start>q.frame_end||h.frame_end<q.frame_start?(F.warn("NLA: Strip is out of scene range: "+(k+" ["+q.frame_start+":"+q.frame_end+"]")),l.splice(m,1),m--):q.anim_name||"CLIP"!=q.type||(F.warn('NLA: no action in strip for object "'+k+'".'),l.splice(m,1),m--)}e=e.nla_events;l=b;for(h=0;h<e.length;h++){for(var k=
e[h],m=l.frame_start,q=l.frame_end+1,n=0;n<e.length;n++){var z=e[n];k.anim_slot==z.anim_slot&&(z.frame_end<=k.frame_start&&(m=k.frame_start),z.frame_start>=k.frame_end&&(q=Math.min(q,z.frame_start)))}k.ext_frame_start=m;k.ext_frame_end=q;k.action_frame_final=0===k.repeat%1?k.action_frame_end:k.action_frame_start+k.repeat%1*(k.action_frame_end-k.action_frame_start)}}}a=a._render.video_textures;for(f=0;f<a.length;f++)d=a[f]._render,d.use_nla&&(d.video_file||d.seq_video)&&d.vtex_data_id==c&&(e=p(),e.type=
"VIDEO",d.use_cyclic?(e.frame_start=0,e.frame_end=b.frame_end):(e.frame_start=r.M(d.frame_start,0,b.frame_end),e.frame_end=r.M(d.frame_start+d.frame_duration,0,b.frame_end)),e.anim_name=a[f].name,b.textures.push(d))};u.prepare=function(){for(var a=0;a<Y.length;a++)for(var b=Y[a],c=0;c<b.objects.length;c++){var d=b.objects[c];if(d)for(a=0;a<d.length;a++)for(var f=d[a],e=f.nla_events,l=0;l<e.length;l++){var h=e[l];E.init_action_cache(f,h.name_list,h.uuid,h.anim_name,h.anim_slot)}}};u.start=function(){ha=
0};u.get_start_time=function(){return ha};u.get_frame_offset=function(a){return a._nla?a._nla.frame_offset:null};u.set_frame_offset=function(a,b){return a._nla?(a._nla.frame_offset=b,!0):!1};u.update=function(a,d){if(!(0>ha)){0==ha&&(ha=a);for(var f=0;f<Y.length;f++){var e=Y[f];e.is_stopped&&(e.frame_offset-=v.get_framerate()*d);var l=m(e,a);if((!e.is_stopped||e.force_update)&&l>=e.range_end)if(e.cyclic){var l=e,k=a;l.user_callback&&l.user_callback();G(l.range_start,k);l.rewinded_to_start=!0;l=m(l,
k)}else{var k=e,p=l;k.is_stopped=!0;k.frame_offset-=p-k.range_end;k.user_callback&&k.user_callback()}if(!e.is_stopped||e.force_update){for(var k=e,p=l,h=0;h<k.objects.length;h++){var n=k.objects[h];if(n)for(var z=0;z<n.length;z++){for(var u=n[z],B=u.nla_events,A=0;A<B.length;A++){var y=B[A];"SOUND"==y.type&&p<k.last_frame-1E-6&&(y.scheduled=!1)}for(A=0;A<B.length;A++)switch(y=B[A],y.type){case "CLIP":if(y.ext_frame_start<=p&&p<y.ext_frame_end&&!y.scheduled){var h=u,J=y,t=J.name_list;""!=J.anim_uuid?
E.apply_by_uuid(h,t,J.anim_uuid,J.anim_slot):E.apply(h,t,J.anim_name,J.anim_slot);E.set_behavior(h,E.AB_FINISH_STOP,J.anim_slot);t=b(J.frame_start,J);E.set_frame(h,t,J.anim_slot);for(h=0;h<B.length;h++)B[h]!=y&&B[h].anim_slot==y.anim_slot&&(B[h].scheduled=!1);y.scheduled=!0}if(y.scheduled){var J=u,t=b(p,y),T=E.get_current_frame_float(J,y.anim_slot);1E-6<Math.abs(t-T)&&E.set_frame(J,t,y.anim_slot)}break;case "SOUND":(p<k.last_frame-1E-6||k.last_frame<y.frame_start)&&y.frame_start<=p&&p<y.frame_end&&
!y.scheduled&&(J=u,T=y,t=(T.frame_start-p)/v.get_framerate(),T=(T.frame_end-T.frame_start)/v.get_framerate(),K.play(J,t,T),y.scheduled=!0),k.last_frame<y.frame_end&&y.frame_end<=p&&y.scheduled&&(y.scheduled=!1)}}}k=a;p=e;n=l;for(z=0;z<p.textures.length;z++)if(u=p.textures[z],u.video_file||u.seq_video){B=C.video_get_current_frame(u);A=u;y=c(n,A);y=r.M(y,A.frame_offset,A.frame_offset+C.video_get_duration(A)-1);A.seq_video&&(y=C.video_frame_to_seq_frame(A,y),y==A.seq_movie_length&&y--);A=y;y=C.video_get_start_frame(u);
J=h=!1;if(p.force_update||p.rewinded_to_start)J=!0;p.is_stopped||(t=u,T=c(n,t),t=t.frame_offset<=T&&T<=t.frame_offset+C.video_get_duration(t),T=C.video_is_played(u),u.use_cyclic&&A==y&&(J=!0),T||B==A||(J=!0),t&&!T?C.play_video(u):t&&T?h=!0:!t&&T&&(u.video_file&&B<A?h=!0:C.pause_video(u)));J?(C.set_frame_video(u.video_tex_name,A,u.vtex_data_id),u.seq_video&&(u.seq_last_discrete_mark=C.seq_video_get_discrete_timemark(u,k))):h&&C.video_update_is_available(u)&&(u.video_file?C.update_video_texture(u):
(B=C.seq_video_get_discrete_timemark(u,k),B!=u.seq_last_discrete_mark&&(u.seq_cur_frame=A,C.update_seq_video_texture(u)),u.seq_last_discrete_mark=B))}e.last_frame=l}e.force_update=!1;e.rewinded_to_start=!1}}};u.cleanup=function(a){if(0==a)Y.length=0,ha=-1;else for(var b=0;b<Y.length;b++)Y[b].objects[a]=null};u.bpy_obj_has_nla=function(a){var b=a.animation_data;return b&&b.nla_tracks.length||t(a)||fa(a)?!0:!1};u.set_frame=G;u.get_frame=function(a){var b=U.get_active();return b._nla?m(b._nla,a):-1};
u.stop_nla=function(){var a=U.get_active();if(a._nla){a._nla.is_stopped=!0;for(var a=a._nla.textures,b=0;b<a.length;b++)C.pause_video(a[b])}};u.play_nla=function(a){var b=U.get_active();b._nla&&(b._nla.is_stopped=!1,b._nla.user_callback=a?a:null)};u.get_frame_start=function(){var a=U.get_active();return a._nla?a._nla.frame_start:-1};u.get_frame_end=function(){var a=U.get_active();return a._nla?a._nla.frame_end:-1};u.is_play=function(){var a=U.get_active();return a._nla?!a._nla.is_stopped:!1};u.check_nla=
function(){var a=U.get_active();return a._nla?a.b4w_use_nla:!1};u.check_logic_nodes=function(){var a=U.get_active();return a._nla?0<a.b4w_logic_nodes.length:!1};u.set_range=function(a,b){var c=U.get_active();if(c._nla)c._nla.range_start=a,c._nla.range_end=b;else return!1};u.set_range_end=function(a){var b=U.get_active();if(b._nla)b._nla.range_end=a;else return!1};u.set_range_start=function(a){var b=U.get_active();if(b._nla)b._nla.range_start=a;else return!1};u.reset_range=function(){var a=U.get_active();
if(a._nla)a=a._nla,a.range_start=a.frame_start,a.range_end=a.frame_end;else return!1};u.set_cyclic=function(a){var b=U.get_active();if(b._nla)b._nla.cyclic=a;else return!1};u.clear_callback=function(){var a=U.get_active();a._nla&&(a._nla.user_callback=null)};u.set_offset_from_range_start=function(a){var b=U.get_active()._nla;b&&(b.frame_offset=-(a-ha)*v.get_framerate()+b.range_start,b.force_update=!0)};u.get_frame_end=function(){var a=U.get_active()._nla;return a?a.frame_end:null}});t.a=e},function(C,
t,e){C=e(0);var R=e(5),V=e(4),n=e(15),y=e(39),d=e(12),k=e(1),I=e(19),A=e(8),r=e(18),p=e(6),u=e(2),a=e(3);e=Object(C.a)("__controls",function(e,l){function c(b,c){c||(c=U.get_container());return{type:b,value:0,payload:null,element:c,do_activation:!1,key:0,collision_id:"",calc_pos_norm:!1,collision_obj:null,collision_cb:function(){},col_imp_obj:null,col_imp_cb:function(){},source_object:null,from:new Float32Array(3),to:new Float32Array(3),is_binary_value:!1,ign_src_rot:!1,ray_test_id:0,ray_test_cb:function(){},
axis:"",time_last:0,trans_last:new Float32Array(3),quat_last:new Float32Array(4),threshold:0,quat_temp:new Float32Array(4),avg_linear_vel:0,avg_angular_vel:0,rotation_threshold:0,avg_vertical_vel:0,period:0,repeat:!1,enable_toggle_switch:!1,gamepad_id:0,position:a.create(),orientation:A.create(),callback:function(){}}}function m(b){function c(){return{coord:new Float32Array(2),is_updated:!0,obj:null,identifier:-1,touch_state:0}}b||(b=U.get_container());for(var d=0;d<D.length;d++){var f=D[d];if(b==
f.element)return f}f={element:b,is_updated_keyboard:!0,mouse_state:0,is_touch_ended:!0,mouse_last_x:0,mouse_last_y:0,mouse_curr_x:0,mouse_curr_y:0,pointerlock_dx:0,pointerlock_dy:0,touches_last_x:new Float32Array(2),touches_curr_x:new Float32Array(2),touches_last_y:new Float32Array(2),touches_curr_y:new Float32Array(2),touch_zoom_curr_dist:0,touch_zoom_last_dist:0,touch_start_rot:0,downed_keys:new Uint8Array(256),wheel_delta:0,global_selected_obj:null,mouse_select_data:c(),touch_select_dlist:Array(10),
is_updated_gyro_quat:!1,gyro_quat:A.create(),gyro_gamma_new:0,gyro_beta_new:0,gyro_alpha_new:0,gyro_gamma_last:0,gyro_beta_last:0,gyro_alpha_last:Infinity,orientation_quat_cb:null,orientation_angles_cb:null,mouse_wheel_cb:null,mouse_down_which_cb:null,mouse_select_cb:null,touch_select_start_cb:null,touch_select_end_cb:null,mouse_up_which_cb:null,mouse_location_cb:null,pointerlock_cb:null,keyboard_downed_keys_cb:null,touch_start_cb:null,touch_move_cb:null,touch_end_cb:null,registered_accum_values:{}};
for(d=0;10>d;++d)f.touch_select_dlist[d]=c();f.orientation_quat_cb=function(a){f.is_updated_gyro_quat||(K.gyro_angles_to_quat(a,f.gyro_quat),f.is_updated_gyro_quat=!0)};f.orientation_angles_cb=function(b){b=a.copy(b,ra);f.gyro_alpha_new=b[0];f.gyro_beta_new=b[1];f.gyro_gamma_new=b[2];Infinity==f.gyro_alpha_last&&(f.gyro_alpha_last=b[0],f.gyro_beta_last=b[1],f.gyro_gamma_last=b[2])};f.mouse_wheel_cb=function(a){f.wheel_delta+=a*S.mouse_wheel_notch_multiplier};f.mouse_down_which_cb=function(a){var b=
K.get_device_by_type_element(K.DEVICE_MOUSE,f.element),b=K.get_vector_param(b,K.MOUSE_LOCATION,h);f.mouse_last_x=b[0];f.mouse_last_y=b[1];f.mouse_curr_x=b[0];f.mouse_curr_y=b[1];if(3==f.mouse_state||0==f.mouse_state)f.mouse_state=1;f.which=a};f.mouse_select_cb=function(a){a=K.get_device_by_type_element(K.DEVICE_MOUSE,f.element);a=K.get_vector_param(a,K.MOUSE_LOCATION,h);a=U.client_to_canvas_coords(a[0],a[1],h);f.mouse_select_data.is_updated=!1;f.mouse_select_data.coord[0]=a[0];f.mouse_select_data.coord[1]=
a[1]};f.touch_select_start_cb=function(a){for(var b=0;b<a.length;++b){for(var c=a[b],d=null,e=null,l=0;l<f.touch_select_dlist.length;l++){var k=f.touch_select_dlist[l],m=3==k.touch_state||0==k.touch_state;if(k.identifier==c.identifier){m&&(e=k);break}else!d&&m&&(d=k,d.identifier=c.identifier)}if(c=e||d)d=U.client_to_canvas_coords(a[b].clientX,a[b].clientY,h),c.is_updated=!1,c.touch_state=1,c.coord[0]=d[0],c.coord[1]=d[1]}};f.touch_select_end_cb=function(a){for(var b=0;b<f.touch_select_dlist.length;++b){for(var c=
f.touch_select_dlist[b],d=!1,h=0;h<a.length;++h)if(a[h].identifier==c.identifier){d=!0;break}d||(0!=c.touch_state&&(c.touch_state=3),c.obj=null)}};f.mouse_up_which_cb=function(a){var b=K.get_device_by_type_element(K.DEVICE_MOUSE,f.element),b=K.get_vector_param(b,K.MOUSE_LOCATION,h);f.mouse_last_x=b[0];f.mouse_last_y=b[1];f.mouse_curr_x=b[0];f.mouse_curr_y=b[1];0!=f.mouse_state&&(f.mouse_state=3);f.which=a};f.mouse_location_cb=function(a){L.ie11_edge_touchscreen_hack&&0==f.mouse_state||(f.mouse_curr_x=
a[0],f.mouse_curr_y=a[1])};f.pointerlock_cb=function(a){f.pointerlock_dx+=a[0];f.pointerlock_dy+=a[1]};f.keyboard_down_keys_cb=function(a){2!=f.downed_keys[a]&&(f.downed_keys[a]=1,f.is_updated_keyboard=!1)};f.keyboard_down_mod_keys_cb=function(a){for(a=0;a<f.downed_keys.length;a++)0!=f.downed_keys[a]&&(f.downed_keys[a]=3,f.is_updated_keyboard=!1)};f.keyboard_up_keys_cb=function(a){f.is_updated_keyboard=!1;f.downed_keys[a]=3};f.touch_start_cb=function(a){f.is_touch_ended=!1;if(1==a.length)f.touches_last_x[0]=
a[0].clientX,f.touches_last_x[1]=-1,f.touches_last_y[0]=a[0].clientY,f.touches_last_y[1]=-1;else if(1<a.length){var b=E(a);f.touch_zoom_curr_dist=f.touch_zoom_last_dist=b;f.touches_last_x[0]=a[0].clientX;f.touches_last_x[1]=a[1].clientX;f.touches_last_y[0]=a[0].clientY;f.touches_last_y[1]=a[1].clientY;b=a[0];a=a[1];f.touch_start_rot=Math.atan2(b.clientY-a.clientY,b.clientX-a.clientX)}f.touches_curr_x.set(f.touches_last_x);f.touches_curr_y.set(f.touches_last_y)};f.touch_move_cb=function(a){1===a.length?
(f.touches_curr_x[0]=a[0].clientX,f.touches_curr_x[1]=-1,f.touches_curr_y[0]=a[0].clientY,f.touches_curr_y[1]=-1):1<a.length&&(f.touches_curr_x[0]=a[0].clientX,f.touches_curr_x[1]=a[1].clientX,f.touches_curr_y[0]=a[0].clientY,f.touches_curr_y[1]=a[1].clientY,a=E(a),f.touch_zoom_curr_dist=a)};f.touch_end_cb=function(a){0==a.length&&(f.is_touch_ended=!0)};D.push(f);return f}function b(a,b){if(b in a.registered_accum_values&&0<a.registered_accum_values[b])a.registered_accum_values[b]+=1;else switch(a.registered_accum_values[b]=
1,b){case "orientation_quat":var c=K.get_device_by_type_element(K.DEVICE_GYRO);c&&K.attach_param_cb(c,K.GYRO_ORIENTATION_ANGLES,a.orientation_quat_cb);break;case "orientation_angles":(c=K.get_device_by_type_element(K.DEVICE_GYRO))&&K.attach_param_cb(c,K.GYRO_ORIENTATION_ANGLES,a.orientation_angles_cb);break;case "mouse_wheel":(c=K.get_device_by_type_element(K.DEVICE_MOUSE,a.element))&&K.attach_param_cb(c,K.MOUSE_WHEEL,a.mouse_wheel_cb);break;case "mouse_down_which":(c=K.get_device_by_type_element(K.DEVICE_MOUSE,
a.element))&&K.attach_param_cb(c,K.MOUSE_DOWN_WHICH,a.mouse_down_which_cb);break;case "mouse_select":(c=K.get_device_by_type_element(K.DEVICE_MOUSE,a.element))&&K.attach_param_cb(c,K.MOUSE_DOWN_WHICH,a.mouse_select_cb);break;case "touch_select":if(c=K.get_device_by_type_element(K.DEVICE_TOUCH,a.element))K.attach_param_cb(c,K.TOUCH_START,a.touch_select_start_cb),K.attach_param_cb(c,K.TOUCH_END,a.touch_select_end_cb);break;case "mouse_up_which":(c=K.get_device_by_type_element(K.DEVICE_MOUSE,a.element))&&
K.attach_param_cb(c,K.MOUSE_UP_WHICH,a.mouse_up_which_cb);break;case "mouse_location":(c=K.get_device_by_type_element(K.DEVICE_MOUSE,a.element))&&K.attach_param_cb(c,K.MOUSE_LOCATION,a.mouse_location_cb);break;case "mouse_pointerlock":(c=K.get_device_by_type_element(K.DEVICE_MOUSE,a.element))&&K.attach_param_cb(c,K.MOUSE_LOCATION_PL,a.pointerlock_cb);break;case "keyboard_downed_keys":if(c=K.get_device_by_type_element(K.DEVICE_KEYBOARD,a.element))K.attach_param_cb(c,K.KEYBOARD_DOWN,a.keyboard_down_keys_cb),
K.attach_param_cb(c,K.KEYBOARD_DOWN_MODIFIED,a.keyboard_down_mod_keys_cb),K.attach_param_cb(c,K.KEYBOARD_UP,a.keyboard_up_keys_cb);break;case "touch_start":(c=K.get_device_by_type_element(K.DEVICE_TOUCH,a.element))&&K.attach_param_cb(c,K.TOUCH_START,a.touch_start_cb);break;case "touch_move":(c=K.get_device_by_type_element(K.DEVICE_TOUCH,a.element))&&K.attach_param_cb(c,K.TOUCH_MOVE,a.touch_move_cb);break;case "touch_end":(c=K.get_device_by_type_element(K.DEVICE_TOUCH,a.element))&&K.attach_param_cb(c,
K.TOUCH_END,a.touch_end_cb)}}function f(a,b){if(b in a.registered_accum_values&&0<a.registered_accum_values[b]&&(--a.registered_accum_values[b],!a.registered_accum_values[b]))switch(b){case "orientation_quat":var c=K.get_device_by_type_element(K.DEVICE_GYRO);c&&K.detach_param_cb(c,K.GYRO_ORIENTATION_QUAT,a.orientation_quat_cb);break;case "orientation_angles":(c=K.get_device_by_type_element(K.DEVICE_GYRO))&&K.detach_param_cb(c,K.GYRO_ORIENTATION_ANGLES,a.orientation_angles_cb);break;case "mouse_wheel":(c=
K.get_device_by_type_element(K.DEVICE_MOUSE,a.element))&&K.detach_param_cb(c,K.MOUSE_WHEEL,a.mouse_wheel_cb);break;case "mouse_down_which":(c=K.get_device_by_type_element(K.DEVICE_MOUSE,a.element))&&K.detach_param_cb(c,K.MOUSE_DOWN_WHICH,a.mouse_down_which_cb);break;case "mouse_select":(c=K.get_device_by_type_element(K.DEVICE_MOUSE,a.element))&&K.detach_param_cb(c,K.MOUSE_DOWN_WHICH,a.mouse_select_cb);break;case "touch_select":if(c=K.get_device_by_type_element(K.DEVICE_TOUCH,a.element))K.detach_param_cb(c,
K.TOUCH_START,a.touch_select_start_cb),K.detach_param_cb(c,K.TOUCH_END,a.touch_select_end_cb);break;case "mouse_up_which":(c=K.get_device_by_type_element(K.DEVICE_MOUSE,a.element))&&K.detach_param_cb(c,K.MOUSE_UP_WHICH,a.mouse_up_which_cb);break;case "mouse_location":(c=K.get_device_by_type_element(K.DEVICE_MOUSE,a.element))&&K.detach_param_cb(c,K.MOUSE_LOCATION,a.mouse_location_cb);break;case "mouse_pointerlock":(c=K.get_device_by_type_element(K.DEVICE_MOUSE,a.element))&&K.detach_param_cb(c,K.MOUSE_LOCATION_PL,
a.pointerlock_cb);break;case "keyboard_downed_keys":if(c=K.get_device_by_type_element(K.DEVICE_KEYBOARD,a.element))K.detach_param_cb(c,K.KEYBOARD_DOWN,a.keyboard_down_keys_cb),K.detach_param_cb(c,K.KEYBOARD_DOWN_MODIFIED,a.keyboard_down_mod_keys_cb),K.detach_param_cb(c,K.KEYBOARD_UP,a.keyboard_up_keys_cb);break;case "touch_start":(c=K.get_device_by_type_element(K.DEVICE_TOUCH,a.element))&&K.detach_param_cb(c,K.TOUCH_START,a.touch_start_cb);break;case "touch_move":(c=K.get_device_by_type_element(K.DEVICE_TOUCH,
a.element))&&K.detach_param_cb(c,K.TOUCH_MOVE,a.touch_move_cb);break;case "touch_end":(c=K.get_device_by_type_element(K.DEVICE_TOUCH,a.element))&&K.detach_param_cb(c,K.TOUCH_END,a.touch_end_cb)}}function B(a,b){a.value=Number(b)}function t(a){for(var b=a.sensors,c=a.sensor_values,d=0;d<b.length;d++)c[d]=b[d].value;return a.logic_fun(c)}function z(a,b){a=a||w;var c=a.sensor_manifolds;if(c){var d=a.sensor_manifolds_arr;if(b){var f=c[b];if(f){for(var h=f.sensors,e=0;e<h.length;e++){var l=h[e],k;k=H;
var m=ea.indexOf(l);k=-1<m?k[m]:[];1==k.length?(G(l),l=ea.indexOf(l),-1<l?(ea.splice(l,1),H.splice(l,1)):M.panic("Sensors cache is corrupted")):1<k.length&&k.splice(k.indexOf(f),1)}delete c[b];e=d.indexOf(f);-1<e?d.splice(e,1):M.panic("Incorrect manifolds array");Object.getOwnPropertyNames(c).length||(c=q.indexOf(a),-1<c?q.splice(c,1):v.error("Wrong object"))}}else{d=[];for(e in c)d.push(e);for(e=0;e<d.length;e++)z(a,d[e])}P=!0}}function G(a){switch(a.type){case 90:Y.remove_collision_test(a.collision_obj,
a.collision_id,a.collision_cb);a.do_activation=!0;break;case 100:Y.clear_collision_impulse_test(a.col_imp_obj);a.do_activation=!0;break;case 110:Y.remove_ray_test(a.ray_test_id);a.do_activation=!0;break;case 140:a.do_activation=!0;break;case 20:var b=m(a.element);f(b,"keyboard_downed_keys");a.do_activation=!0;break;case 30:b=m(a.element);f(b,"mouse_wheel");a.do_activation=!0;break;case 40:b=m(a.element);f(b,"mouse_down_which");f(b,"mouse_up_which");f(b,"mouse_location");a.do_activation=!0;break;case 280:b=
m(a.element);f(b,"mouse_pointerlock");a.do_activation=!0;break;case 50:b=m(a.element);f(b,"mouse_down_which");f(b,"mouse_up_which");a.do_activation=!0;break;case 60:b=m(a.element);f(b,"touch_start");f(b,"touch_move");f(b,"touch_end");a.do_activation=!0;break;case 70:b=m(a.element);f(b,"touch_start");f(b,"touch_move");a.do_activation=!0;break;case 75:b=m(a.element);f(b,"touch_start");f(b,"touch_move");a.do_activation=!0;break;case 80:b=m(a.element);f(b,"touch_start");f(b,"touch_end");a.do_activation=
!0;break;case 170:b=m(a.element);f(b,"mouse_select");f(b,"touch_select");f(b,"touch_start");f(b,"touch_end");f(b,"mouse_down_which");f(b,"mouse_up_which");a.do_activation=!0;break;case 180:case 190:b=m(a.element);f(b,"orientation_angles");a.do_activation=!0;break;case 200:b=m(a.element);f(b,"orientation_quat");a.do_activation=!0;break;case 210:case 220:a.do_activation=!0}}function E(a){var b=a[0],c=a[1];a=b.clientX-c.clientX;b=b.clientY-c.clientY;return Math.sqrt(a*a+b*b)}function J(a){return 0==
a?K.get_device_by_type_element(K.DEVICE_GAMEPAD0):1==a?K.get_device_by_type_element(K.DEVICE_GAMEPAD1):2==a?K.get_device_by_type_element(K.DEVICE_GAMEPAD2):K.get_device_by_type_element(K.DEVICE_GAMEPAD3)}var M=Object(R.a)(e),F=Object(V.a)(e),U=Object(n.a)(e),K=Object(y.a)(e),C=Object(d.a)(e),v=Object(k.a)(e),Y=Object(I.a)(e),ha=Object(r.a)(e),S=F.controls,L=F.defaults,q=[],w={},ea=[],H=[],D=[],h=new Float32Array(2),ia=new Float32Array(2),ra=a.create(),za=A.create(),P=!1,oa=0;l.CT_POSITIVE=10;l.CT_CONTINUOUS=
20;l.CT_TRIGGER=30;l.CT_SHOT=40;l.CT_LEVEL=50;l.CT_CHANGE=60;l.PL_SINGLE_TOUCH_MOVE=0;l.PL_MULTITOUCH_MOVE_ZOOM=1;l.PL_MULTITOUCH_MOVE_PAN=2;l.PL_MULTITOUCH_MOVE_ROTATE=3;var Q=1;l.update=function(b,c){for(var d=0;d<D.length;d++){var f=D[d];f.mouse_select_data.is_updated||(f.mouse_select_data.obj=C.pick_object(f.mouse_select_data.coord[0],f.mouse_select_data.coord[1]),f.mouse_select_data.is_updated=!0,f.global_selected_obj=f.mouse_select_data.obj);for(var e=0;10>e;++e){var k=f.touch_select_dlist[e];
k.is_updated||(k.obj=C.pick_object(k.coord[0],k.coord[1]),k.is_updated=!0,f.global_selected_obj=k.obj)}}for(d=0;d<ea.length;d++)if(f=ea[d],k=b,e=c)switch(f.type){case 120:var n=f.source_object,r=p.j(n.render.world_tsr,ra),n=p.g(n.render.world_tsr,za),z=a.dist(f.trans_last,r),E=f.quat_temp;A.invert(f.quat_last,E);A.multiply(n,E,E);A.normalize(E,E);E=Math.abs(2*Math.acos(E[3]));z/=e;f.avg_linear_vel=u._51(z,f.avg_linear_vel,e,.3);f.payload[0]=z;z=E/e;f.avg_angular_vel=u._51(z,f.avg_angular_vel,e,.3);
f.payload[1]=z;f.avg_linear_vel>=f.threshold||f.avg_angular_vel>=f.rotation_threshold?B(f,1):B(f,0);a.copy(r,f.trans_last);A.copy(n,f.quat_last);f.time_last=k;break;case 130:n=f.source_object;r=p.j(n.render.world_tsr,ra);n=Math.abs(r[1]-f.trans_last[1])/e;f.avg_vertical_vel=u._51(n,f.avg_vertical_vel,e,.3);f.payload=n;f.avg_vertical_vel>=f.threshold?B(f,1):B(f,0);a.copy(r,f.trans_last);f.time_last=k;break;case 140:!f.do_activation&&0<=f.period&&k-f.time_last>=f.period&&(B(f,1),f.repeat?f.time_last=
k:f.period=-f.period);break;case 150:f.time_last||(f.time_last=k);B(f,k-f.time_last);f.time_last=k;break;case 160:B(f,k);break;case 180:k=m(f.element);f.payload[0]=k.gyro_gamma_new-k.gyro_gamma_last;f.payload[1]=k.gyro_beta_new-k.gyro_beta_last;f.payload[2]=k.gyro_alpha_new-k.gyro_alpha_last;break;case 190:k=m(f.element);f.payload[0]=k.gyro_gamma_new;f.payload[1]=k.gyro_beta_new;f.payload[2]=k.gyro_alpha_new;break;case 200:k=m(f.element);A.copy(k.gyro_quat,f.payload);break;case 210:e=K.get_device_by_type_element(K.DEVICE_HMD);
K.get_vector_param(e,K.HMD_ORIENTATION_QUAT,f.payload);break;case 220:e=K.get_device_by_type_element(K.DEVICE_HMD);K.get_vector_param(e,K.HMD_POSITION,f.payload);break;case 240:e=J(f.gamepad_id);f.value=K.get_gamepad_btn_value(e,f.key);break;case 250:e=J(f.gamepad_id);f.value=K.get_gamepad_axis_value(e,f.key);break;case 260:e=J(f.gamepad_id);K.get_gamepad_position(e,f.payload);B(f,1);break;case 270:e=J(f.gamepad_id);K.get_gamepad_orientation(e,f.payload);B(f,1);break;case 230:B(f,f.callback());break;
case 30:k=m(f.element);B(f,k.wheel_delta);break;case 40:k=m(f.element);if(!L.ie11_edge_touchscreen_hack||1==k.mouse_state||2==k.mouse_state)switch(r=k.mouse_curr_x-k.mouse_last_x,n=k.mouse_curr_y-k.mouse_last_y,f.payload.coords[0]=k.mouse_curr_x,f.payload.coords[1]=k.mouse_curr_y,f.axis){case "X":B(f,r);break;case "Y":B(f,n);break;case "XY":e=Math.sqrt(r*r+n*n),B(f,e)}break;case 280:k=m(f.element);r=k.pointerlock_dx;n=k.pointerlock_dy;z=u._51(r,0,e,.1*Q);e=u._51(n,0,e,.1*Q);.01<Math.abs(r)||.01<Math.abs(n)?
(k.pointerlock_dx-=z,k.pointerlock_dy-=e,f.payload.coords[0]=z,f.payload.coords[1]=e):(f.payload.coords[0]=0,f.payload.coords[1]=0);B(f,Math.sqrt(r*r+n*n));break;case 50:k=m(f.element);B(f,0!=k.mouse_state|0);f.payload.which=k.which;f.payload.coords[0]=k.mouse_curr_x;f.payload.coords[1]=k.mouse_curr_y;break;case 170:k=m(f.element);B(f,0);if(f.enable_toggle_switch)k.global_selected_obj==f.source_object&&B(f,1);else if(0!=k.mouse_state&&k.mouse_select_data.obj==f.source_object)B(f,1);else for(e=0;10>
e;++e)if(r=k.touch_select_dlist[e],0!=r.touch_state&&r.obj==f.source_object){B(f,1);break}break;case 20:k=m(f.element);f.payload=k.downed_keys[f.key];1==f.payload||k.downed_keys[0]&&16==f.key?B(f,1):f.payload||B(f,0);break;case 60:k=m(f.element);if(-1==k.touches_curr_x[1]&&-1==k.touches_curr_y[1]){r=k.touches_curr_x[0]-k.touches_last_x[0];n=k.touches_curr_y[0]-k.touches_last_y[0];e=Math.sqrt(r*r+n*n);if(-1!=k.touches_last_x[1]&&-1!=k.touches_last_y[1]){var z=k.touches_curr_x[0]-k.touches_last_x[1],
E=k.touches_curr_y[0]-k.touches_last_y[1],v=Math.sqrt(z*z+E*E);v<e&&(r=z,n=E,e=v)}f.payload.gesture=l.PL_SINGLE_TOUCH_MOVE}else e=h,e[0]=(k.touches_curr_x[0]+k.touches_curr_x[1])/2,e[1]=(k.touches_curr_y[0]+k.touches_curr_y[1])/2,n=ia,n[0]=(k.touches_last_x[0]+k.touches_last_x[1])/2,n[1]=(k.touches_last_y[0]+k.touches_last_y[1])/2,r=e[0]-n[0],n=e[1]-n[1],e=Math.sqrt(r*r+n*n),f.payload.gesture=l.PL_MULTITOUCH_MOVE_PAN;f.payload.coords[0]=k.touches_curr_x[0];f.payload.coords[1]=k.touches_curr_y[0];
switch(f.axis){case "X":B(f,r);break;case "Y":B(f,n);break;case "XY":B(f,e)}break;case 70:k=m(f.element);e=k.touch_zoom_curr_dist-k.touch_zoom_last_dist;f.payload=l.PL_MULTITOUCH_MOVE_ZOOM;B(f,e);break;case 75:k=m(f.element);-1!=k.touches_curr_x[1]&&(e=Math.atan2(k.touches_curr_y[0]-k.touches_curr_y[1],k.touches_curr_x[0]-k.touches_curr_x[1]),f.payload=l.PL_MULTITOUCH_MOVE_ROTATE,B(f,e-k.touch_start_rot));break;case 80:k=m(f.element),f.payload.coords[0]=k.touches_curr_x[0],f.payload.coords[1]=k.touches_curr_y[0],
k.is_touch_ended?B(f,0):B(f,1)}for(d=0;d<q.length;d++)for(k=q[d],f=k.sensor_manifolds_arr,e=0;e<f.length;e++)if(r=f[e],r.update_counter!=oa){r.update_counter=oa;E=r;n=0;switch(E.type){case l.CT_POSITIVE:n=(z=t(E))?1:0;break;case l.CT_CONTINUOUS:n=E.last_pulse;(z=t(E))?(n=1,E.last_pulse=1):1==n?(n=-1,E.last_pulse=-1):n=0;break;case l.CT_TRIGGER:n=E.last_pulse;(z=t(E))&&-1==n?(n=1,E.last_pulse=1):z||1!=n?n=0:(n=-1,E.last_pulse=-1);break;case l.CT_SHOT:n=E.last_pulse;(z=t(E))&&-1==n?(n=1,E.last_pulse=
1):z||1!=n?n=0:(n=0,E.last_pulse=-1);break;case l.CT_LEVEL:z=t(E);E.last_logic_result!=z?(n=1,E.last_logic_result=z):n=0;break;case l.CT_CHANGE:z=E.sensors;E=E.last_sensor_values;for(v=0;v<z.length;v++){var y=z[v].value;n||y==E[v]||(n=1);E[v]=y}break;default:M.panic("Wrong sensor manifold type: "+E.type)}if(n&&(z=k==w?null:k,P=!1,r.callback(z,r.id,n,r.callback_param),P)){d=-1;break}}for(d=0;d<q.length;d++)for(k=q[d],f=k.sensor_manifolds_arr,e=0;e<f.length;e++)for(r=f[e],k=r.sensors,r=0;r<k.length;r++)switch(n=
k[r],n.type){case 30:B(n,0);break;case 40:B(n,0);break;case 60:B(n,0);break;case 70:B(n,0);break;case 75:B(n,0);break;case 80:B(n,0);break;case 140:B(n,0)}for(d=0;d<D.length;d++){f=D[d];if(!f.is_updated_keyboard){for(e=0;e<f.downed_keys.length;e++)1==f.downed_keys[e]?f.downed_keys[e]=2:3==f.downed_keys[e]&&(f.downed_keys[e]=0);f.is_updated_keyboard=!0}1==f.mouse_state?f.mouse_state=2:3==f.mouse_state&&(f.mouse_state=0);for(e=0;e<f.touch_select_dlist.length;e++)k=f.touch_select_dlist[e],1==k.touch_state?
k.touch_state=2:3==k.touch_state&&(k.touch_state=0);f.wheel_delta=0;f.mouse_last_x=f.mouse_curr_x;f.mouse_last_y=f.mouse_curr_y;f.downed_keys[0]=0;f.touches_last_x.set(f.touches_curr_x);f.touches_last_y.set(f.touches_curr_y);f.touch_zoom_last_dist=f.touch_zoom_curr_dist;f.gyro_gamma_last=f.gyro_gamma_new;f.gyro_beta_last=f.gyro_beta_new;f.gyro_alpha_last=f.gyro_alpha_new;f.is_updated_gyro_quat=!1}oa++};l.create_custom_sensor=function(a){var b=c(10);B(b,a);return b};l.create_keyboard_sensor=function(a){var b=
c(20,document);b.key=a;b.do_activation=!0;return b};l.create_gamepad_btn_sensor=function(a,b){var d=c(240,document);b=b||K.get_first_gmpd_id();d.gamepad_id=b;d.key=a;d.do_activation=!0;return d};l.create_gamepad_axis_sensor=function(a,b){var d=c(250,document);b=void 0==b?K.get_first_gmpd_id():b;d.gamepad_id=b;d.key=a;d.do_activation=!0;return d};l.create_gamepad_position_sensor=function(b){var d=c(260,document);b=void 0===b?K.get_first_gmpd_id():b;d.gamepad_id=b;d.do_activation=!0;d.payload=a.create();
return d};l.create_gamepad_orientation_sensor=function(a){var b=c(270,document);a=void 0===a?K.get_first_gmpd_id():a;b.gamepad_id=a;b.do_activation=!0;b.payload=A.create();return b};l.create_collision_sensor=function(a,b,d){if(!a||!Y.obj_has_physics(a))return v.error("Wrong collision object"),null;var f=c(90);f.collision_obj=a;f.collision_id=b;f.calc_pos_norm=d;f.payload={coll_obj:null,coll_pos:d?new Float32Array(3):null,coll_norm:d?new Float32Array(3):null,coll_dist:0};f.collision_cb=function(a,
b,c,d,h){B(f,a);a=f.payload;a.coll_obj=b;f.calc_pos_norm&&(a.coll_pos.set(c),a.coll_norm.set(d),a.coll_dist=h)};f.do_activation=!0;return f};l.create_collision_impulse_sensor=function(a){if(!a||!a.physics)return v.error("Wrong collision impulse object"),null;var b=c(100);b.col_imp_obj=a;b.col_imp_cb=function(a){B(b,a)};b.do_activation=!0;return b};l.create_ray_sensor=function(a,b,d,f,h,e,l){var k=c(110);k.source_object=a;k.from=b;k.to=d;k.collision_id=f;k.is_binary_value=h;k.calc_pos_norm=e;k.ign_src_rot=
l;k.payload={hit_fract:0,obj_hit:null,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),ray_test_id:0};k.ray_test_cb=function(a,b,c,d,f,h){k.is_binary_value?B(k,-1==b?0:1):B(k,b);k.payload.hit_fract=b;k.payload.obj_hit=c;k.payload.hit_time=d;k.calc_pos_norm&&(k.payload.hit_pos.set(f),k.payload.hit_norm.set(h))};k.do_activation=!0;return k};l.create_mouse_click_sensor=function(a){a=c(50,a);a.do_activation=!0;a.payload={coords:new Float32Array(2),which:null};return a};l.create_mouse_wheel_sensor=
function(a){a=c(30,a);a.do_activation=!0;return a};l.create_mouse_move_sensor=function(a,b){var d=c(40,b);d.axis=a||"XY";d.payload={coords:new Float32Array(2)};d.do_activation=!0;return d};l.create_touch_move_sensor=function(a,b){var d=c(60,b);d.axis=a||"XY";d.payload={coords:new Float32Array(2),gesture:0};d.do_activation=!0;return d};l.create_touch_zoom_sensor=function(a){a=c(70,a);a.payload=0;a.do_activation=!0;return a};l.create_touch_rotate_sensor=function(a){a=c(75,a);a.payload=0;a.do_activation=
!0;return a};l.create_touch_click_sensor=function(a){a=c(80,a);a.payload={coords:new Float32Array(2)};a.do_activation=!0;return a};l.create_motion_sensor=function(){var b=A.create(),d=a.create();return function(a,f,h){if(!a)return v.error("Wrong collision object"),null;var e=c(120);e.source_object=a;var l=p.j(a.render.world_tsr,d);a=p.g(a.render.world_tsr,b);e.quat_temp=new Float32Array(4);e.trans_last=new Float32Array(l);e.quat_last=new Float32Array(a);e.avg_linear_vel=0;e.avg_angular_vel=0;e.threshold=
f||.1;e.rotation_threshold=h||.1;e.time_last=0;e.payload=new Float32Array([0,0]);return e}}();l.create_vertical_velocity_sensor=function(){var b=A.create(),d=a.create();return function(a,f){if(!a)return v.error("Wrong collision object"),null;var h=c(130);h.source_object=a;var e=p.j(a.render.world_tsr,d),l=p.g(a.render.world_tsr,b);h.trans_last=new Float32Array(e);h.quat_last=new Float32Array(l);h.avg_vertical_vel=0;h.threshold=f||1;h.time_last=0;h.payload=0;return h}}();l.create_timer_sensor=function(a,
b){var d=c(140);d.period=a;d.repeat=b;d.do_activation=!0;return d};l.reset_timer_sensor=function(a,b,c,d){a=a||w;a=a.sensor_manifolds;if(!a||!a[b])return v.error("reset_timer_sensor(): wrong object"),null;b=a[b].sensors[c];if(!b)return v.error("reset_timer_sensor(): sensor not found"),null;b.time_last=ha.get_timeline();b.period=d};l.create_elapsed_sensor=function(){var a=c(150);a.time_last=0;return a};l.create_gyro_delta_sensor=function(){var a=c(180,window);a.payload=new Float32Array(3);K.get_device_by_type_element(K.DEVICE_GYRO)?
B(a,1):B(a,0);a.do_activation=!0;return a};l.create_gyro_angles_sensor=function(){var a=c(190,window);a.payload=new Float32Array(3);K.get_device_by_type_element(K.DEVICE_GYRO)?B(a,1):B(a,0);a.do_activation=!0;return a};l.create_gyro_quat_sensor=function(){var a=c(200,window);a.payload=A.create();K.get_device_by_type_element(K.DEVICE_GYRO)?B(a,1):B(a,0);a.do_activation=!0;return a};l.create_hmd_quat_sensor=function(){var a=c(210,window);a.payload=A.create();K.get_device_by_type_element(K.DEVICE_HMD)?
B(a,1):B(a,0);a.do_activation=!0;return a};l.create_hmd_position_sensor=function(){var b=c(220,window);b.payload=a.create();K.get_device_by_type_element(K.DEVICE_HMD)?B(b,1):B(b,0);b.do_activation=!0;return b};l.create_timeline_sensor=function(){return c(160)};l.create_selection_sensor=function(a,b){var d=c(170);d.source_object=a;d.enable_toggle_switch=b;d.do_activation=!0;return d};l.create_callback_sensor=function(a,b){var d=c(230);d.callback=a;B(d,b);return d};l.create_plock_mouse_sensor=function(a){a=
c(280,a);a.payload={coords:new Float32Array(2)};a.do_activation=!0;return a};l.create_plock_sensor=function(a){a=c(290,a);a.do_activation=!0;return a};l.sensor_set_value=B;l.get_sensor_value=function(a,b,c){a=a||w;a=a.sensor_manifolds;if(!a||!a[b])return v.error("get_sensor_value(): wrong object"),null;b=a[b].sensors[c];return b?b.value:(v.error("get_sensor_value(): sensor not found"),null)};l.get_sensor_payload=function(a,b,c){a=a||w;a=a.sensor_manifolds;if(!a||!a[b])return v.error("get_sensor_payload(): wrong object"),
null;b=a[b].sensors[c];return b?b.payload:(v.error("get_sensor_payload(): sensor not found"),null)};l.cleanup=function(){q=[];w={};for(var a=0;a<ea.length;a++)G(ea[a]);ea.length=0;H.length=0};l.check_sensor_manifold=function(a,b){a=a||w;if(!a.sensor_manifolds)return!1;if(b&&a.sensor_manifolds[b])return!0;if(!b)for(var c in a.sensor_manifolds)return!0;return!1};l.create_sensor_manifold=function(a,c,d,f,h,e,l){a=a||w;a.sensor_manifolds_arr=a.sensor_manifolds_arr||[];a.sensor_manifolds=a.sensor_manifolds||
{};var k=a.sensor_manifolds,n=a.sensor_manifolds_arr;k[c]&&z(a,c);d={id:c,type:d,sensors:f.slice(0),logic_fun:h,sensor_values:Array(f.length),callback:e,callback_param:l,last_pulse:-1,last_logic_result:0,last_sensor_values:Array(f.length),update_counter:-1};k[c]=d;n.push(d);-1==q.indexOf(a)&&q.push(a);for(a=0;a<d.sensors.length;a++){k=c=d.sensors[a];if(k.do_activation){switch(k.type){case 90:Y.append_collision_test(k.collision_obj,k.collision_id,k.collision_cb,k.calc_pos_norm);break;case 100:Y.apply_collision_impulse_test(k.col_imp_obj,
k.col_imp_cb);break;case 110:k.ray_test_id=Y.append_ray_test(k.source_object,k.from,k.to,k.collision_id,k.ray_test_cb,!1,!1,k.calc_pos_norm,k.ign_src_rot);k.payload.ray_test_id=k.ray_test_id;break;case 140:k.time_last=ha.get_timeline();0>k.period&&(k.period=-k.period);break;case 20:n=m(k.element);b(n,"keyboard_downed_keys");break;case 30:n=m(k.element);b(n,"mouse_wheel");break;case 40:n=m(k.element);b(n,"mouse_down_which");b(n,"mouse_up_which");b(n,"mouse_location");break;case 280:n=m(k.element);
b(n,"mouse_pointerlock");break;case 290:K.activate_pointerlock(k);break;case 50:n=m(k.element);b(n,"mouse_down_which");b(n,"mouse_up_which");break;case 60:n=m(k.element);b(n,"touch_start");b(n,"touch_move");b(n,"touch_end");break;case 70:n=m(k.element);b(n,"touch_start");b(n,"touch_move");break;case 75:n=m(k.element);b(n,"touch_start");b(n,"touch_move");break;case 80:n=m(k.element);b(n,"touch_start");b(n,"touch_end");break;case 170:n=m(k.element);b(n,"mouse_select");b(n,"touch_select");b(n,"touch_start");
b(n,"touch_end");b(n,"mouse_down_which");b(n,"mouse_up_which");break;case 180:case 190:n=m(k.element);b(n,"orientation_angles");break;case 200:n=m(k.element);b(n,"orientation_quat");break;case 240:case 260:case 270:0==k.gamepad_id?K.get_device_by_type_element(K.DEVICE_GAMEPAD0):1==k.gamepad_id?K.get_device_by_type_element(K.DEVICE_GAMEPAD1):2==k.gamepad_id?K.get_device_by_type_element(K.DEVICE_GAMEPAD2):K.get_device_by_type_element(K.DEVICE_GAMEPAD3)}k.do_activation=!1}k=ea.indexOf(c);-1==k?(ea.push(c),
H.push([d])):H[k].push(d)}P=!0};l.default_AND_logic_fun=function(a){for(var b=0;b<a.length;b++)if(!a[b])return a[b];return a[a.length-1]};l.default_OR_logic_fun=function(a){for(var b=0;b<a.length;b++)if(a[b])return a[b];return a[a.length-1]};l.remove_sensor_manifold=z;l.reset=function(){for(var a=0;a<q.length;a++){var b=q[a],c=b.sensor_manifolds,b=b.sensor_manifolds_arr,d;for(d in c)delete c[d];b.length=0}for(a=0;a<ea.length;a++)G(ea[a]);q.length=0;ea.length=0;H.length=0};l.debug=function(){v.log(String(q.length)+
" objects with manifolds",q);v.log(String(ea.length)+" sensors",ea);for(var a=[],b=[],c=0;c<ea.length;c++){var d=ea[c];90==d.type&&a.push(d);110==d.type&&b.push(d)}v.log(String(a.length)+" collision sensors",a);v.log(String(b.length)+" ray sensors",b)};l.set_plock_smooth_factor=function(a){Q=a}});t.a=e},function(C,t,e){C=e(0);var R=e(19),V=e(1),n=e(2),y=e(73);e=Object(C.a)("physics",function(d,e){function k(a,d,e,c,k){return n.V(a,c[e[0]],c[e[1]],c[e[2]])}function A(a,d,e,c,k){d=Math.abs(a[2]-d[2]);
return d<k&&u.is_vector_in_poly(a,e,c)?d:Number.MAX_VALUE}var r=Object(R.a)(d),p=Object(V.a)(d),u=Object(y.a)(d);e.CM_WALK=0;e.CM_RUN=1;e.CM_CLIMB=2;e.CM_FLY=3;e.enable_simulation=function(a){r.obj_has_physics(a)?r.enable_simulation(a):p.error_once("No physics for object "+a.name)};e.disable_simulation=function(a){r.obj_has_physics(a)?r.disable_simulation(a):p.error_once("No physics for object "+a.name)};e.has_physics=function(a){return r.obj_has_physics(a)};e.has_simulated_physics=function(a){return r.has_simulated_physics(a)};
e.has_dynamic_physics=function(a){return r.has_dynamic_physics(a)};e.set_gravity=function(a,d){p.error_deprecated("set_gravity","set_object_gravity");r.obj_has_physics(a)?r.set_gravity(a,0,0,-d):p.error_once("No physics for object "+a.name)};e.set_object_gravity=function(a,d){r.obj_has_physics(a)?r.set_gravity(a,d[0],d[1],d[2]):p.error_once("No physics for object "+a.name)};e.set_transform=function(a,d,e){r.obj_has_physics(a)?r.set_transform(a,d,e):p.error_once("No physics for object "+a.name)};e.sync_transform=
function(a){r.obj_has_physics(a)?r.sync_transform(a):p.error_once("No physics for object "+a.name)};e.apply_velocity=function(a,d,e,c){r.obj_has_physics(a)?r.apply_velocity(a,d,e,c):p.error_once("No physics for object "+a.name)};e.apply_velocity_world=function(a,d,e,c){r.obj_has_physics(a)?r.apply_velocity_world(a,d,e,c):p.error_once("No physics for object "+a.name)};e.apply_force=function(a,d,e,c){r.obj_has_physics(a)?r.apply_force(a,d,e,c,!1):p.error_once("No physics for object "+a.name)};e.apply_force_world=
function(a,d,e,c){r.obj_has_physics(a)?r.apply_force(a,d,e,c,!0):p.error_once("No physics for object "+a.name)};e.apply_torque=function(a,d,e,c){r.obj_has_physics(a)?r.apply_torque(a,d,e,c):p.error_once("No physics for object "+a.name)};e.set_angular_velocity=function(a,d,e,c){r.obj_has_physics(a)?r.set_angular_velocity(a,d,e,c):p.error_once("No physics for object "+a.name)};e.vehicle_throttle=function(a,d){r.obj_has_physics(a)?(r.is_vehicle_chassis(a)||r.is_vehicle_hull(a)||p.error("Wrong object"),
r.vehicle_throttle(a,n.M(d,-1,1))):p.error_once("No physics for object "+a.name)};e.vehicle_throttle_inc=function(a,d,e){if(r.obj_has_physics(a)){r.is_vehicle_chassis(a)||r.is_vehicle_hull(a)||p.error("Wrong object");d=n.M(d,0,1);var c=a.vehicle.engine_force;-1==e||1==e?c=Math.max(-1,Math.min(c+e*d,1)):0==e&&0<=c?c=Math.max(0,c-d):0==e&&0>c?c=Math.min(0,c+d):p.error("Wrong steering direction");r.vehicle_throttle(a,n.M(c,-1,1))}else p.error_once("No physics for object "+a.name)};e.vehicle_steer=function(a,
d){r.obj_has_physics(a)?(r.is_vehicle_chassis(a)||r.is_vehicle_hull(a)||p.error("Wrong object"),r.vehicle_steer(a,n.M(d,-1,1))):p.error_once("No physics for object "+a.name)};e.vehicle_steer_inc=function(a,d,e){if(r.obj_has_physics(a)){r.is_vehicle_chassis(a)||r.is_vehicle_hull(a)||p.error("Wrong object");d=n.M(d,0,1);var c=a.vehicle.steering;-1==e||1==e?c=Math.max(-1,Math.min(c+e*d,1)):0==e&&0<=c?c=Math.max(0,c-d):0==e&&0>c?c=Math.min(0,c+d):p.error("Wrong steering direction");r.vehicle_steer(a,
n.M(c,-1,1))}else p.error_once("No physics for object "+a.name)};e.vehicle_brake=function(a,d){r.obj_has_physics(a)?(r.is_vehicle_chassis(a)||r.is_vehicle_hull(a)||p.error("Wrong object"),r.vehicle_brake(a,n.M(d,0,1))):p.error_once("No physics for object "+a.name)};e.vehicle_brake_inc=function(a,d){if(r.obj_has_physics(a)){r.is_vehicle_chassis(a)||r.is_vehicle_hull(a)||p.error("Wrong object");d=n.M(d,-1,1);var e=a.vehicle.brake_force;r.vehicle_brake(a,n.M(e+e*d,0,1))}else p.error_once("No physics for object "+
a.name)};e.is_vehicle_chassis=function(a){return r.is_vehicle_chassis(a)};e.is_vehicle_hull=function(a){return r.is_vehicle_hull(a)};e.get_vehicle_name=function(a){if(!r.obj_has_physics(a))return p.error_once("No physics for object "+a.name),null;if(r.is_vehicle_chassis(a)||r.is_vehicle_hull(a))return a.vehicle_settings.name;p.error("Wrong object");return null};e.get_vehicle_throttle=function(a){if(!r.obj_has_physics(a))return p.error_once("No physics for object "+a.name),null;if(r.is_vehicle_chassis(a)||
r.is_vehicle_hull(a))return a.vehicle.engine_force;p.error("Wrong object");return null};e.get_vehicle_steering=function(a){if(!r.obj_has_physics(a))return p.error_once("No physics for object "+a.name),0;if(r.is_vehicle_chassis(a)||r.is_vehicle_hull(a))return a.vehicle.steering;p.error("Wrong object");return 0};e.get_vehicle_brake=function(a){if(!r.obj_has_physics(a))return p.error_once("No physics for object "+a.name),0;if(r.is_vehicle_chassis(a)||r.is_vehicle_hull(a))return a.vehicle.brake_force;
p.error("Wrong object");return 0};e.get_vehicle_speed=function(a){if(!r.obj_has_physics(a))return p.error_once("No physics for object "+a.name),0;if(r.is_vehicle_chassis(a)||r.is_vehicle_hull(a))return r.get_vehicle_speed(a);p.error("Wrong object");return 0};e.is_character=function(a){return r.has_character_physics(a)};e.set_character_move_dir=function(a,d,e){r.obj_has_physics(a)?r.set_character_move_dir(a,d,e):p.error_once("No physics for object "+a.name)};e.set_character_move_type=function(a,d){r.obj_has_physics(a)?
r.set_character_move_type(a,d):p.error_once("No physics for object "+a.name)};e.set_character_walk_velocity=function(a,d){r.obj_has_physics(a)?r.set_character_walk_velocity(a,d):p.error_once("No physics for object "+a.name)};e.set_character_run_velocity=function(a,d){r.obj_has_physics(a)?r.set_character_run_velocity(a,d):p.error_once("No physics for object "+a.name)};e.set_character_fly_velocity=function(a,d){r.obj_has_physics(a)?r.set_character_fly_velocity(a,d):p.error_once("No physics for object "+
a.name)};e.character_jump=function(a){r.obj_has_physics(a)?r.character_jump(a):p.error_once("No physics for object "+a.name)};e.character_rotation_inc=function(a,d,e){r.obj_has_physics(a)?r.character_rotation_inc(a,d,e):p.error_once("No physics for object "+a.name)};e.set_character_rotation=function(a,d,e){r.obj_has_physics(a)?r.set_character_rotation(a,d,e):p.error_once("No physics for object "+a.name)};e.set_character_rotation_v=function(a,d){r.obj_has_physics(a)?r.set_character_rotation_v(a,d):
p.error_once("No physics for object "+a.name)};e.set_character_rotation_h=function(a,d){r.obj_has_physics(a)?r.set_character_rotation_h(a,d):p.error_once("No physics for object "+a.name)};e.set_character_vert_move_dir_angle=function(a,d){r.obj_has_physics(a)?r.set_character_vert_move_dir_angle(a,d):p.error_once("No physics for object "+a.name)};e.append_collision_test=function(a,d,e,c){r.obj_has_physics(a)?r.append_collision_test(a,d||"ANY",e,c||!1):p.error_once("No physics for object "+a.name)};
e.remove_collision_test=function(a,d,e){r.obj_has_physics(a)?r.remove_collision_test(a,d||"ANY",e):p.error_once("No physics for object "+a.name)};e.apply_collision_impulse_test=function(a,d){r.obj_has_physics(a)?r.apply_collision_impulse_test(a,d):p.error_once("No physics for object "+a.name)};e.clear_collision_impulse_test=function(a){r.obj_has_physics(a)?r.clear_collision_impulse_test(a):p.error_once("No physics for object "+a.name)};e.append_ray_test=function(a,d,e,c,k,b){a=a||null;return null==
a||r.obj_has_physics(a)?r.append_ray_test(a,d,e,c||"ANY",k,b||!1,!1,!1,!1):(p.error_once("No physics for object "+a.name),0)};e.append_ray_test_ext=function(a,d,e,c,k,b,f,n,u){a=a||null;return null==a||r.obj_has_physics(a)?r.append_ray_test(a,d,e,c||"ANY",k,b||!1,f||!1,n||!1,u||!1):(p.error_once("No physics for object "+a.name),0)};e.remove_ray_test=function(a){r.is_ray_test(a)?r.remove_ray_test(a):p.error("Wrong ray test ID")};e.change_ray_test_from_to=function(a,d,e){r.is_ray_test(a)?r.change_ray_test_from_to(a,
d,e):p.error("Wrong ray test ID")};e.apply_constraint=function(a,d,e,c,k,b,f,n,u,z){r.obj_has_physics(d)&&r.obj_has_physics(k)?r.apply_constraint(a,d,e,c,k,b,f,n,u,z):p.error("Wrong objects")};e.clear_constraint=function(a){r.obj_has_physics(a)&&r.has_constraint(a)?r.clear_constraint(a):p.error("Wrong object")};e.pull_to_constraint_pivot=function(a,d,e,c,k,b){r.obj_has_physics(a)&&r.obj_has_physics(c)?r.pull_to_constraint_pivot(a,d,e,c,k,b):p.error("Wrong objects")};e.navmesh_get_island=function(a,
d,e){e||(e=k);if(r.obj_has_physics(a)){var c=a.physics.navmesh;return c?u.navmesh_get_island(c,d,e):(p.error(a.name+" is not a navigation mesh object"),null)}p.error_once("No physics for object "+a.name)};e.navmesh_find_path=function(a,d,e,c){if(r.obj_has_physics(a)){var l=a.physics.navmesh;if(!l)return p.error(a.name+" is not a navigation mesh object"),null;c=c||{};a={};a.do_not_pull_string=!!c.do_not_pull_string;a.distance_to_closest=c.distance_to_closest||k;a.distance_to_farthest=c.distance_to_farthest||
A;a.island=c.island||0;a.allowed_distance=c.allowed_distance||Number.MAX_VALUE;a.return_normals=c.return_normals||!1;return u.navmesh_find_path(l,d,e,a)}p.error_once("No physics for object "+a.name)};e.sync_bounding=function(a,d){d||(d=a.scenes_data[0].scene);r.scene_has_physics(d)&&r.sync_bounding(a,d)};e.sync_mesh=function(a,d){d||(d=a.scenes_data[0].scene);r.scene_has_physics(d)&&r.sync_mesh(a,d)}});t.a=e},function(C,t,e){C=e(0);var R=e(16),V=e(14),n=e(4),y=e(15),d=e(39),k=e(12),I=e(9),A=e(1),
r=e(22),p=e(10),u=e(11),a=e(18),B=e(13),l=e(6),c=e(3);e=Object(C.a)("__anchors",function(e,b){function f(a){if(!P&&!ia&&(a=ra))if("visible"==a.lastElementChild.style.visibility)m(),ra=null;else if(1==a.style.opacity){var b=a.lastElementChild;a=a.firstElementChild;var c=b.firstElementChild,d=Math.ceil(b.getBoundingClientRect().width),f=Math.ceil(b.getBoundingClientRect().height),h=Math.ceil(a.getBoundingClientRect().width),e=Math.ceil(a.getBoundingClientRect().height);b.style.position="absolute";b.style.visibility=
"visible";var l=!0,k=!0;a.style.display="none";P=!0;h!=d?ea.animate(h,d,200,function(a){a==d&&(l=!1,k||(P=!1,c.style.visibility="visible"));b.style.width=a+"px"}):(l=!1,k||(P=!1));e!=f?ea.animate(e,f,200,function(a){a==f&&(k=!1,l||(P=!1,c.style.visibility="visible"));b.style.height=a+"px"}):(k=!1,l||(P=!1))}}function m(){var a=ra.lastElementChild;ra.firstElementChild.style.display="";a.style.visibility="hidden";a.style.position="relative";a.firstElementChild.style.visibility="hidden"}function t(a){a.style.cssText+=
"color:       #fff;font-family: Arial;font-size:   12px;font-weight: bold;line-height: 1.25;"}function z(a,b,c){var d=document.createElement("div"),f=document.createElement("span");c&&(d.style.maxWidth=c+"px");d.style.cssText+="background-color:   #000;border-radius:      20px 20px 20px 0px;bottom:             0;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);left:               0;box-sizing:         border-box;opacity:            1.0;padding:            6px 12px 6px 12px;position:           relative;z-index:            2;";
t(f);f.innerHTML=a;d.style.visibility="hidden";f.style.visibility="hidden";d.appendChild(f);b.appendChild(d);v.add_click_listener(b,function(a){P||b==ra||1!=b.style.opacity||ia||(ra&&"visible"==ra.lastElementChild.style.visibility&&m(),ra=b)})}function G(){for(var a=0,b=0;b<h.length;b++)h[b].detect_visibility&&a++;oa=new Float32Array(3*a)}function E(a,b){return b.depth-a.depth}function J(a,b,c){a=a.element;D.ie_edge_anchors_floor_hack&&(b=Math.floor(b),c=Math.floor(c));"transform"in a.style?a.style.transform=
"translate3d("+b+"px, "+c+"px, 0px)":"webkitTransform"in a.style?a.style.webkitTransform="translate3d("+b+"px, "+c+"px, 0px)":(a.style.left=b+"px",a.style.top=c+"px")}function M(a){for(var b=0;b<h.length;b++)if(h[b].obj==a)return!0;return!1}var F=Object(R.a)(e),U=Object(V.a)(e),K=Object(n.a)(e),C=Object(y.a)(e),v=Object(d.a)(e),Y=Object(k.a)(e),ha=Object(I.a)(e),S=Object(A.a)(e),L=Object(r.a)(e),q=Object(p.a)(e),w=Object(u.a)(e),ea=Object(a.a)(e),H=Object(B.a)(e),D=K.defaults,h=[],ia=!1,ra=null,za=
!1,P=!1,oa=new Float32Array(0),Q=new Uint8Array(16),da=new Float32Array(2),ja=new Float32Array(3),va=new Float32Array(3);b.append=function(a){if(!M(a)){var b=a.anchor.detect_visibility&&!!q.get_subs(q.get_main(),w.ANCHOR_VISIBILITY),b={type:a.anchor.type,obj:a,x:0,y:0,depth:0,appearance:"out",detect_visibility:b,element:null,move_cb:null,annotation_max_width:a.anchor.max_width,element_id:a.anchor.element_id};switch(b.type){case "ANNOTATION":var c=b.obj;a=C.get_container();var d=Y.get_meta_tags(c),
c=c.name,e="",l=document.createElement("div"),k=l.cloneNode(!1),m=document.createElement("span");l.style.cssText+="position:        absolute;height:          0;top:             0;left:            0;transform-style: preserve-3d;";k.style.cssText+="background-color:   #000;border-radius:      20px 20px 20px 0px;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);opacity:            1.0;box-sizing:         border-box;bottom:             0;left:               0;padding:            6px 12px 6px 12px;position:           absolute;";
l.style.visibility="hidden";d&&(e=d.description||e,c=d.title||c);m.innerHTML=c;m.style.cssText+="-webkit-touch-callout: none;-webkit-user-select:   none;-khtml-user-select:    none;-moz-user-select:      none;-ms-user-select:       none;user-select:           none;cursor:                default;";t(m);m.style.whiteSpace="nowrap";k.appendChild(m);l.appendChild(k);e&&z(e,l,b.annotation_max_width);a.appendChild(l);b.element=l;break;case "ELEMENT":if(b.element=document.getElementById(a.anchor.element_id),
b.element)for(d=0;d<h.length;d++)"ELEMENT"==h[d].type&&h[d].element_id==a.anchor.element_id&&(S.warn("Anchor with the id '"+a.anchor.element_id+"' already exists, making the new anchor generic."),b.type="GENERIC");else S.warn("Anchor HTML element with the id '"+a.anchor.element_id+"' was not found, making it generic."),b.type="GENERIC"}h.push(b);G();za||(za=!0,C.get_container().addEventListener("mouseup",f))}};b.remove=function(a){for(var b=0;b<h.length;b++){var c=h[b];if(c.obj==a){"ANNOTATION"==
c.type&&(a=c,C.get_container().removeChild(a.element));h.splice(b,1);G();break}}};b.update=function(a){for(var b=0,c=h.length;c--;){var d=h[c];if(d.detect_visibility){var f=l.j(d.obj.render.world_tsr,ja);oa.set(f,3*b++)}var e=Ga(d,ja),f=e[0],k=e[1],e=e[2];if(a||f!=d.x||k!=d.y||e!=d.depth){switch(d.type){case "ANNOTATION":var m=f,n=k;J(d,m,n);break;case "ELEMENT":n=d.element.getBoundingClientRect(),m=f-n.width/2,n=k-n.height/2,J(d,m,n)}d.x=f;d.y=k;d.depth=e;d.move_cb&&d.move_cb(f,k,d.appearance,d.obj,
d.element)}}h.sort(E);for(c=0;c<h.length;c++)d=h[c],"GENERIC"!=d.type&&(d.element.style.zIndex=ra==d.element?h.length:c);0<b&&(a=q.get_subs(q.get_main(),w.ANCHOR_VISIBILITY),b=a.draw_data[0].bundles[0],F.update_anchor_visibility_batch(b.batch,oa),w.append_draw_data(a,b))};var Ga=function(){var a=c.create();return function(b,c){var d=q.get_camera(q.get_main()),f=l.j(b.obj.render.world_tsr,a);U.project_point(d,f,c);l.v(f,b.obj.render.world_tsr);return c}}();b.update_visibility=function(){for(var a=
C.get_container(),b=q.get_active(),b=q.get_subs(b,w.STEREO),b=!(!b||!b.enable_hmd_stereo),d=h.length;d--;){var f=h[d],e=f.obj,l=e.render,k=f.x,n=f.y,p=f.depth,r=q.get_camera(q.get_main()),z=H.get_translation(e,ja),r=H.get_translation(r,va),z=c.dist(z,r);(p=0>k||0>n||0>p||1<p||q.is_hidden(e)||k>=a.clientWidth||n>=a.clientHeight)||(l.is_lod?(p=l.lod_dist_max,l=z<l.lod_dist_min?!1:p==ha.LOD_DIST_MAX_INFINITY||z<p?!0:!1):l=!0,p=!l);l=p?"out":"visible";f.detect_visibility&&"out"!=l&&(l=f,p=q.get_subs(q.get_main(),
w.ANCHOR_VISIBILITY).camera,z=C.canvas_to_viewport_coords(l.x,l.y,da,p),L.read_pixels(p.framebuffer,z[0],p.height-z[1],2,2,Q),l=255<=Q[0]+Q[4]+Q[8]+Q[12]?"visible":"out"==l.appearance||0==Q[0]+Q[4]+Q[8]+Q[12]?"covered":l.appearance);b&&(l="out");if(l!=f.appearance){switch(f.type){case "ANNOTATION":case "ELEMENT":var u=f.element;u&&("out"==l?(u.style.visibility="hidden",u.children.length&&(u.children[0].style.visibility="hidden")):"visible"==l?(u.style.visibility="visible",u.children.length&&(u.children[0].style.visibility=
"visible"),u.style.opacity=1):(u.style.visibility="visible",u.style.opacity=.1,u.children.length&&(u.children[0].style.visibility="visible"),"ANNOTATION"==f.type&&1<u.children.length&&"visible"==u.lastElementChild.style.visibility&&(m(),u==ra&&(ra=null))))}f.appearance=l;f.move_cb&&f.move_cb(k,n,f.appearance,e,u)}}};b.attach_move_cb=function(a,b){for(var c=0;c<h.length;c++)h[c].obj==a&&(h[c].move_cb=b)};b.detach_move_cb=function(a){for(var b=0;b<h.length;b++)h[b].obj==a&&(h[b].move_cb=null)};b.cleanup=
function(){for(var a=0;a<h.length;a++){var b=h[a];"ANNOTATION"==b.type&&C.get_container().removeChild(b.element)}h.length=0};b.is_anchor=M;b.get_element_id=function(a){for(var b=0;b<h.length;b++)if(h[b].obj==a)return h[b].element_id;return!1};b.pause=function(){ia=!0};b.resume=function(){ia=!1};b.pick_anchor=function(a,b){for(var c=-1,d=0;d<h.length;d++){var f;if(f="visible"==h[d].appearance){var e=h[d];if(e.element){f=Math.round(e.element.offsetWidth)||0;var l=Math.round(e.element.offsetHeight)||
0}else l=f=0;var k=e.x,e=e.y;f=a>=k&&a<=k+f&&b<e&&b>=e-l?!0:!1}if(f)if(0>c)var m=h[d].depth,c=d;else h[d].depth<m&&(c=d,m=h[d].depth)}return 0>c?null:h[c].obj}});t.a=e},function(C,t,e){function R(a){a=a.render;for(var c=a.skinned_renders,d=a.mesh_to_arm_bone_maps,b=0;b<c.length;b++){for(var f=c[b],e=d[b],l=0;l<e.length;l+=2)for(var k=e[l],n=e[l+1],p=0;4>p;p++)f.quats_before[k+p]=a.quats_before[n+p],f.quats_after[k+p]=a.quats_after[n+p],f.trans_before[k+p]=a.trans_before[n+p],f.trans_after[k+p]=a.trans_after[n+
p];f.frame_factor=a.frame_factor}}t.e=function(a,c){for(var e=a.data.bones,b=a.pose.bones,f={},l=0;l<b.length;l++){var p=b[l],r=p.bone,u=r.name,E=u,u={bone_index:0,vgroup_index:-1,parent_bone_ptr:null,descend_bones_ptrs:[],chain:[],constraint:null,tsr_bone_rest:n.b(),tsr_bone_pose:n.b(),tsr_local_rest:n.b(),tsr_local_rest_i:n.b(),tsr_local_pose:n.b(),tsr_local_pose_b:n.b(),tsr_local_pose_a:n.b(),tsr_basis:n.b(),tsr_channel_cache:n.b(),tsr_channel_cache_valid:!1,tail:new Float32Array(3)},E=f[E]=u,
u=new Float32Array(r.matrix_local),y=new Float32Array(16);d.invert(u,y);var p=new Float32Array(p.matrix_basis),B=E.tail;k.subtract(V._1(r.tail_local),V._1(r.head_local),B);V._68(B,y,B);n.d(u,E.tsr_local_rest);n.d(p,E.tsr_basis);n.a(E.tsr_local_rest,E.tsr_local_pose);n.p(E.tsr_local_rest,E.tsr_local_rest_i)}for(l=0;l<e.length;l++){u=e[l].name;p=V._19("name",u,b);E=f[u];r=p.parent_recursive;E.chain.push(E);for(p=0;p<r.length;p++)y=r[p],y=y.name,y=f[y],E.chain.push(y);r.length?(y=r[0],y=y.name,y=f[y],
E.parent_bone_ptr=y,n.p(y.tsr_local_rest,A),n.q(A,E.tsr_local_rest,E.tsr_bone_rest),y.descend_bones_ptrs.push(E)):n.a(E.tsr_local_rest,E.tsr_bone_rest);E.bone_index=l;E.name=u;n.q(E.tsr_bone_rest,E.tsr_basis,E.tsr_bone_pose)}c.render.bone_pointers=f};t.b=function(d,c,e,b,f){var l=d.render,k=l.frame_factor;c=l.bone_pointers[c];var m=c.bone_index;d=c.tsr_local_rest;var B=p,E=l.trans_before,J=l.trans_after,t=l.quats_before,l=l.quats_after,F=E[4*m+1],U=E[4*m+2],K=E[4*m+3],I=J[4*m+1],v=J[4*m+2],Y=J[4*
m+3];B[0]=(1-k)*E[4*m]+k*J[4*m];B[1]=(1-k)*F+k*I;B[2]=(1-k)*U+k*v;B[3]=(1-k)*K+k*Y;E=u;J=a;E[0]=t[4*m];E[1]=t[4*m+1];E[2]=t[4*m+2];E[3]=t[4*m+3];J[0]=l[4*m];J[1]=l[4*m+1];J[2]=l[4*m+2];J[3]=l[4*m+3];y.slerp(E,J,k,E);k=A;n.w(B,k);n.r(E,k);e?(e=r,n.G(d,c.tail,e),n.q(k,e,k)):n.q(k,d,k);if(b){if(b=c.parent_bone_ptr)e=r,n.p(b.tsr_local_pose,e),n.q(e,k,k);b=r;n.p(c.tsr_bone_rest,b);n.q(b,k,k)}n.a(k,f)};t.c=function(a,c,d,b){var f=a.render;c=f.bone_pointers[c];var e=f.trans_before,l=f.quats_before;b?n.q(c.tsr_bone_rest,
d,c.tsr_bone_pose):n.a(d,c.tsr_local_pose);B(c,b,e,l);f.frame_factor=0;R(a)};t.f=R;e.d(t,"d",function(){return B});t.a=function(a,c){return c in a.render.bone_pointers};var V=e(2),n=e(6),y=e(8),d=e(21),k=e(3),I=e(7),A=n.b(),r=n.b(),p=new Float32Array(4),u=new Float32Array(4),a=new Float32Array(4),B=function(){var a=y.create(),c=n.b(),d=n.b(),b=I.create();return function T(e,l,k,m){var p=e.tsr_bone_pose,r=e.tsr_local_rest,z=e.tsr_local_pose,u=e.parent_bone_ptr;u?(u=u.tsr_local_pose,l?n.q(u,p,z):(n.p(u,
d),n.q(d,z,p))):l?n.a(p,z):n.a(z,p);n.p(r,c);n.q(z,c,c);l=e.bone_index;n.l(c,b);k[4*l]=b[0];k[4*l+1]=b[1];k[4*l+2]=b[2];k[4*l+3]=b[3];n.g(c,a);m[4*l]=a[0];m[4*l+1]=a[1];m[4*l+2]=a[2];m[4*l+3]=a[3];e=e.descend_bones_ptrs;for(l=0;l<e.length;l++)p=e[l],p.constraint||T(p,!0,k,m)}}()},function(C,t,e){function R(e){d.scale(e.color,e.energy,e.color_intensity)}e.d(t,"a",function(){return k});t.b=function(d,e){d.color[0]=e[0];d.color[1]=e[1];d.color[2]=e[2];R(d)};t.e=function(d,e){d.spot_blend=e};t.c=function(d,
e){d.distance=e};t.f=function(d,e){d.spot_size=e};t.d=function(d,e){d.energy=e;R(d)};e.d(t,"g",function(){return I});var V=e(8),n=e(6),y=e(2),d=e(3);new Float32Array(3);var k=function(){var e=V.create(),k=d.create();return function(p,r){var a=p.data,u={name:"",type:a.type,prev_direction:new Float32Array(3),direction:new Float32Array(3),color:new Float32Array(3),color_intensity:new Float32Array(3),default_energy:0,use_sphere:!1,spot_size:0,spot_blend:0,clip_start:.1,clip_end:30,generate_shadows:!1,
need_sun_fog_update:!1,dynamic_intensity:!1,use_diffuse:!0,use_specular:!0,energy:1,distance:25,falloff_type:"INVERSE_SQUARE"},u=r.light=u;u.name=r.name;u.use_diffuse=a.use_diffuse;u.use_specular=a.use_specular;var l=n.g(r.render.world_tsr,e),l=y._34(l,y.f,k);d.normalize(l,l);u.direction.set(l);u.color[0]=a.color[0];u.color[1]=a.color[1];u.color[2]=a.color[2];u.energy=u.default_energy=a.energy;R(u);u.distance=a.distance;u.use_sphere=a.use_sphere;u.clip_start=a.clip_start;u.clip_end=a.clip_end;if("POINT"===
u.type||"SPOT"===u.type)u.distance=a.distance;"SPOT"===u.type?(u.spot_blend=a.spot_blend,u.spot_size=a.spot_size):"POINT"===u.type&&(u.spot_size=Math.PI/2);u.generate_shadows=a.b4w_generate_shadows;u.dynamic_intensity=a.b4w_dynamic_intensity}}(),I=function(){var e=V.create();return function(k){var p=k.light;if(p){k=n.g(k.render.world_tsr,e);y._34(k,y.f,p.direction);d.normalize(p.direction,p.direction);if("SUN"==p.type){k=Math.acos(d.dot(p.prev_direction,y.n));var r=Math.acos(d.dot(p.direction,y.n));
p.need_sun_fog_update=Math.floor(k/.025)!=Math.floor(r/.025)?!0:!1}d.copy(p.direction,p.prev_direction)}}}()},function(C,t,e){C=e(0);var R=e(5),V=e(19),n=e(56),y=e(14),d=e(6),k=e(2),I=e(8),A=e(3);e=Object(C.a)("__constraints",function(e,p){function r(a){return{type:a,obj_parent:null,target:null,use_offset:!1,tsr_restore:null,tsr_offset:null,euler_offset:null,axes:null,track_axis:null,vertical_axis:null,use_target_z:!1,influence:0,bone_name:"",softness:0,clamp_left:0,clamp_right:0,clamp_up:0,clamp_down:0,
dist_min:0,dist_max:0,left_edge:!1,left_right_dist:0,top_edge:!1,top_bottom_dist:0,distance:0,hor_units:"",vert_units:""}}function a(a,b){a.constraint&&a.constraint.obj_parent&&B(a.constraint.obj_parent,a);if(b.obj_parent){var c=b.obj_parent;-1==c.cons_descends.indexOf(a)?c.cons_descends.push(a):G.panic("Descendant object override is forbidden")}a.constraint=b}function B(a,b){var c=a.cons_descends.indexOf(b);-1!=c?a.cons_descends.splice(c,1):G.panic("No descendant object")}function l(b,c,d,f,e,l){var k=
r(3);k.obj_parent=c;k.track_axis=new Float32Array(d);k.vertical_axis=new Float32Array(f);k.use_target_z=e;k.tsr_restore=new Float32Array(b.render.world_tsr);k.influence=l;a(b,k);v(b,k,0)}function c(b,c,f,e,l,k){var m=r(8);m.obj_parent=c;m.tsr_offset=d.b();d.v(f,m.tsr_offset);m.axes=new Float32Array(e);m.influence=k;m.use_offset=l;m.tsr_restore=new Float32Array(b.render.world_tsr);a(b,m);v(b,m,0)}function m(b,c,f){var e=r(11);e.obj_parent=c;e.tsr_offset=d.b();d.a(b.render.world_tsr,e.tsr_offset);e.tsr_restore=
new Float32Array(b.render.world_tsr);e.influence=f;a(b,e);v(b,e,0)}function b(b,c,d){var f=r(13);f.obj_parent=c;f.tsr_offset=new Float32Array(d);a(b,f);v(b,f,0)}function f(b,c,d,f){var e=r(14);e.obj_parent=c;e.bone_name=d;e.tsr_offset=new Float32Array(f);a(b,e);v(b,e,0)}function t(b,c,f){var e=r(17);e.obj_parent=c;e.tsr_restore=new Float32Array(b.render.world_tsr);e.tsr_offset=d.b();k._17(f.right)?(e.left_edge=!1,e.left_right_dist=f.right):k._17(f.left)?(e.left_edge=!0,e.left_right_dist=f.left):(e.left_edge=
!0,e.left_right_dist=0);k._17(f.bottom)?(e.top_edge=!1,e.top_bottom_dist=f.bottom):k._17(f.top)?(e.top_edge=!0,e.top_bottom_dist=f.top):(e.top_edge=!0,e.top_bottom_dist=0);k._17(f.distance)?e.distance=f.distance:e.distance=0;c=k._17(f.rotation)?new Float32Array(f.rotation):I.create();d.r(c,e.tsr_offset);k._17(f.hor_units)?e.hor_units=f.hor_units:e.hor_units="widths";k._17(f.vert_units)?e.vert_units=f.vert_units:e.vert_units="heights";a(b,e);v(b,e,0)}function fa(a,b){switch(b.type){case 18:var c=b.target.render.world_tsr,
f=U;d.p(a.render.world_tsr,f);d.q(f,c,f);n.c(a,b.bone_name,f,!1)}a.need_update_transform=!0}function z(a,b){for(var c=0;c<a.length;c++){var d=a[c];if(!z(d.cons_descends,b)||d.name==b.name)return!1}return!0}var G=Object(R.a)(e),E=Object(V.a)(e),J=Object(y.a)(e);p.CONS_TYPE_STIFF_OBJ=1;p.CONS_TYPE_STIFF_BONE=2;p.CONS_TYPE_TRACK_OBJ=3;p.CONS_TYPE_FOLLOW_OBJ=5;p.CONS_TYPE_STIFF_TRANS_OBJ=7;p.CONS_TYPE_COPY_LOC_OBJ=8;p.CONS_TYPE_SEMI_STIFF_OBJ=12;p.CONS_TYPE_CHILD_OF=13;p.CONS_TYPE_CHILD_OF_BONE=14;p.CONS_TYPE_SEMI_SOFT_OBJ=
15;p.CONS_TYPE_STIFF_TRANS_ROT_OBJ=16;p.CONS_TYPE_STIFF_VIEWPORT=17;p.BONE_CONS_TYPE_STIFF_OBJ=18;new Float32Array(2);new Float32Array(2);var M=new Float32Array(3);new Float32Array(3);var F=new Float32Array(4);new Float32Array(4);var U=d.b(),K=new Float32Array(3);p.append_stiff_obj=function(b,c,f,e,l){var k=r(1);k.obj_parent=c;k.tsr_offset=d.b();e=e?e:I.create();d.v(f,k.tsr_offset);d.s(l,k.tsr_offset);d.r(e,k.tsr_offset);k.tsr_restore=new Float32Array(b.render.world_tsr);a(b,k);v(b,k,0)};p.append_stiff_bone=
function(b,c,f,e,l,k){var m=r(2);m.obj_parent=c;m.bone_name=f;m.tsr_restore=new Float32Array(b.render.world_tsr);m.tsr_offset=d.b();d.v(new Float32Array(e),m.tsr_offset);d.r(new Float32Array(l),m.tsr_offset);d.s(k,m.tsr_offset);a(b,m);v(b,m,0)};p.append_semi_stiff_obj=function(){var b=I.create(),c=I.create();return function(f,e,l,m,n,p,h,z){var q=r(12),w=d.g(e.render.world_tsr,c);if(m){var u=I.copy(m,b);I.multiply(w,u,u);d.r(u,f.render.world_tsr)}else m=I.create();q.obj_parent=e;q.tsr_offset=d.b();
d.v(l,q.tsr_offset);d.r(m,q.tsr_offset);q.parent_prev_rotation=new Float32Array(w);q.clamp_left=k.A(n);q.clamp_right=k.A(p);q.clamp_up=k.B(h,-Math.PI,Math.PI);q.clamp_down=k.B(z,-Math.PI,Math.PI);q.tsr_restore=new Float32Array(f.render.world_tsr);a(f,q);v(f,q,0)}}();p.append_semi_soft_obj=function(b,c,f,e){var l=r(15);l.obj_parent=c;l.softness=e;l.tsr_restore=new Float32Array(b.render.world_tsr);l.tsr_offset=d.b();d.v(new Float32Array(f),l.tsr_offset);a(b,l);v(b,l,0)};p.append_stiff_trans_rot_obj=
function(b,c,f,e,l){var k=r(16);k.obj_parent=c;k.tsr_restore=new Float32Array(b.render.world_tsr);k.tsr_offset=d.b();d.v(new Float32Array(f),k.tsr_offset);d.r(new Float32Array(e),k.tsr_offset);d.s(l,k.tsr_offset);a(b,k);v(b,k,0)};p.remove_parent_descendant=B;p.append_track_obj=l;p.append_follow_obj=function(b,c,d,f){var e=r(5);e.obj_parent=c;e.dist_min=d;e.dist_max=f;e.tsr_restore=new Float32Array(b.render.world_tsr);a(b,e);v(b,e,0)};p.append_stiff_trans_obj=function(b,c,f){var e=r(7);e.obj_parent=
c;e.tsr_offset=d.b();e.tsr_restore=new Float32Array(b.render.world_tsr);d.v(new Float32Array(f),e.tsr_offset);a(b,e);v(b,e,0)};p.append_copy_loc_obj=c;var C=function(){var b=I.create();return function(c,f,e,l,m){var n=r(9);n.obj_parent=f;f=d.g(c.render.world_tsr,b);n.euler_offset=k._36(f,new Float32Array(3));n.axes=new Float32Array(e);n.influence=m;n.use_offset=l;n.tsr_restore=new Float32Array(c.render.world_tsr);a(c,n);v(c,n,0)}}();p.append_copy_rot_obj=C;p.append_copy_trans_obj=m;p.append_child_of=
b;p.append_child_of_bone=f;p.append_stiff_viewport=t;p.update_constraint=function(a,b){a.constraint&&v(a,a.constraint,b)};var v=function(){var a=I.create(),b=I.create(),c=I.create(),f=d.b(),e=A.create(),l=A.create(),m=A.create();return function(q,h,p){switch(h.type){case 1:d.q(h.obj_parent.render.world_tsr,h.tsr_offset,q.render.world_tsr);break;case 12:var r=d.j(q.render.world_tsr,e),w=d.g(q.render.world_tsr,a),z=d.j(h.tsr_offset,l),u=h.obj_parent.render.world_tsr;p=d.g(h.obj_parent.render.world_tsr,
b);I.multiply(I.invert(h.parent_prev_rotation,h.parent_prev_rotation),w,w);I.multiply(p,w,w);d.r(w,q.render.world_tsr);d.D(z,u,r);d.v(r,q.render.world_tsr);I.copy(p,h.parent_prev_rotation);Y(q,h);break;case 15:var r=d.j(q.render.world_tsr,e),w=d.g(q.render.world_tsr,a),u=h.obj_parent.render.world_tsr,E=d.j(u,l),v=h.softness,D=I.copy(w,b),z=d.j(h.tsr_offset,m),z=d.D(z,u,m);k._54(z,r,p,v,r);d.v(r,q.render.world_tsr);k._31(r,D,E,k.c);d.v(E,u);k._52(D,w,p,.16*v,w);d.r(w,q.render.world_tsr);break;case 2:z=
d.j(h.tsr_offset,l);E=d.i(h.tsr_offset);r=d.g(h.tsr_offset,b);u=n.b(h.obj_parent,h.bone_name,!0,!1,f);d.q(h.obj_parent.render.world_tsr,u,u);w=d.g(u,a);I.multiply(w,r,w);d.r(w,q.render.world_tsr);d.s(E*d.i(u),q.render.world_tsr);r=d.j(q.render.world_tsr,e);d.D(z,u,r);d.v(r,q.render.world_tsr);break;case 3:r=d.j(q.render.world_tsr,e);w=d.g(q.render.world_tsr,a);z=d.j(h.obj_parent.render.world_tsr,l);u=h.influence;h.use_target_z?(E=d.g(h.obj_parent.render.world_tsr,b),E=A.transformQuat(k.f,E,m)):E=
k.f;k._31(r,w,z,h.track_axis);z=A.subtract(z,r,l);A.normalize(z,z);k._32(w,h.vertical_axis,E,z);z=d.g(h.tsr_restore,b);I.slerp(z,w,u,w);d.r(w,q.render.world_tsr);d.v(r,h.tsr_restore);break;case 5:r=d.j(q.render.world_tsr,e);w=d.g(q.render.world_tsr,a);z=d.j(h.obj_parent.render.world_tsr,l);k._31(r,w,z,k.c);d.v(z,h.obj_parent.render.world_tsr);w=A.dist(r,z);if(w=w>h.dist_max?w-h.dist_max:w<h.dist_min?w-h.dist_min:0)A.sub(z,r,m),A.normalize(m,m),A.scale(e,w,m),A.add(r,m,r),d.v(r,q.render.world_tsr);
break;case 7:u=h.obj_parent.render.world_tsr;r=d.j(q.render.world_tsr,e);z=d.j(h.tsr_offset,l);d.D(z,u,r);d.v(r,q.render.world_tsr);d.r(d.g(q.render.world_tsr,a),h.tsr_restore);break;case 8:E=d.j(h.obj_parent.render.world_tsr,e);w=h.axes;p=d.j(h.tsr_offset,l);z=A.set(0,0,0,m);h.use_offset&&A.add(z,p,z);u=h.influence;r=e;w[0]&&(r[0]=(1-u)*p[0]+u*(k._50(w[0])*E[0]+z[0]));w[1]&&(r[1]=(1-u)*p[1]+u*(k._50(w[1])*E[1]+z[1]));w[2]&&(r[2]=(1-u)*p[2]+u*(k._50(w[2])*E[2]+z[2]));d.v(r,q.render.world_tsr);d.r(d.g(q.render.world_tsr,
a),h.tsr_restore);break;case 9:w=h.axes;p=d.g(h.obj_parent.render.world_tsr,a);r=k._35(p,h.euler_offset,l);k.Q(r,h.euler_offset);w[0]?(h.use_offset&&(u=A.set(h.euler_offset[0],0,0,e),k._45(r,u,r)),r[0]*=k._50(w[0])):r[0]=h.euler_offset[0];w[1]?(h.use_offset&&(u=A.set(0,h.euler_offset[1],0,e),k._45(r,u,r)),r[1]*=k._50(w[1])):r[1]=h.euler_offset[1];w[2]?(h.use_offset&&(u=A.set(0,0,h.euler_offset[2],e),k._45(r,u,r)),r[2]*=k._50(w[2])):r[2]=h.euler_offset[2];k.Q(r,h.euler_offset);u=h.influence;r=k.Y(r,
a);z=d.g(h.tsr_restore,b);w=I.slerp(z,r,u,a);d.r(w,q.render.world_tsr);d.v(d.j(q.render.world_tsr,e),h.tsr_restore);break;case 11:u=h.influence;E=d.j(h.obj_parent.render.world_tsr,e);p=d.g(h.obj_parent.render.world_tsr,a);r=d.j(h.tsr_offset,l);z=d.g(h.tsr_offset,b);r=k.G(r,E,u,e);d.v(r,q.render.world_tsr);w=I.slerp(z,p,u,a);d.r(w,q.render.world_tsr);d.v(d.j(q.render.world_tsr,e),h.tsr_restore);break;case 16:w=d.g(q.render.world_tsr,a);u=h.obj_parent.render.world_tsr;p=d.g(h.obj_parent.render.world_tsr,
b);z=d.j(h.tsr_offset,l);r=d.g(h.tsr_offset,c);I.multiply(p,r,w);d.r(w,q.render.world_tsr);r=d.D(z,u,e);d.v(r,q.render.world_tsr);break;case 13:d.q(h.obj_parent.render.world_tsr,h.tsr_offset,q.render.world_tsr);break;case 14:r=h.tsr_offset;u=f;n.b(h.obj_parent,h.bone_name,!0,!1,u);d.q(h.obj_parent.render.world_tsr,u,u);d.q(u,r,q.render.world_tsr);break;case 17:w=h.obj_parent,u=J.get_first_cam(w),r=e,p=J.get_edge(u,"LEFT"),v=J.get_edge(u,"RIGHT"),z=J.get_edge(u,"TOP"),E=J.get_edge(u,"BOTTOM"),D="heights"==
h.hor_units?z-E:v-p,r[0]=h.left_edge?p+D*h.left_right_dist:v-D*h.left_right_dist,p="heights"==h.vert_units?z-E:v-p,r[1]=h.top_edge?z-p*h.top_bottom_dist:E+p*h.top_bottom_dist,J.is_ortho(u)?r[2]=-h.distance:(r[2]=-1,A.normalize(r,r),A.scale(r,h.distance/Math.abs(r[2]),r)),d.y(r,w.render.world_tsr,r),u=d.j(w.render.world_tsr,l),A.add(u,r,r),d.v(r,q.render.world_tsr),z=d.g(q.render.world_tsr,a),w=d.g(w.render.world_tsr,b),r=d.g(h.tsr_offset,c),I.multiply(w,r,z),d.r(z,q.render.world_tsr)}"CAMERA"==q.render.type&&
q.render.move_style!=J.MS_STATIC&&(r=q.render.vertical_axis,12==h.type&&(p=d.g(h.obj_parent.render.world_tsr,a),r=A.transformQuat(r,p,K)),J.correct_up(q,r))}}();p.update_bone_constraint=function(a,b){var c=a.render.bone_pointers[b];c.constraint&&fa(a,c.constraint)};var Y=function(){var a=I.create(),b=I.create(),c=I.create(),f=I.create(),e=new Float32Array(2),l=new Float32Array(2);return function(m,q){var h=d.g(m.render.world_tsr,a),n=d.g(q.obj_parent.render.world_tsr,b),p=d.g(q.tsr_offset,c),n=I.multiply(n,
p,f),p=J.get_camera_angles_from_quat(n,m.render.vertical_axis,e),r=J.get_camera_angles_from_quat(h,m.render.vertical_axis,l),n=k.H(r[0],p[0]+q.clamp_right,p[0]+q.clamp_left),p=k.H(r[1],p[1]+q.clamp_down,p[1]+q.clamp_up);k._47(h,m.render.vertical_axis,n,p,h);d.r(h,m.render.world_tsr)}}();p.check_constraint=function(a){return a.constraint?!0:!1};p.remove=function(a,b){a.constraint.obj_parent&&B(a.constraint.obj_parent,a);b&&d.a(a.constraint.tsr_restore,a.render.world_tsr);a.constraint=null};p.get_type=
function(a){return a.constraint?a.constraint.type:null};p.has_child_of=function(a){a=a.constraint;return!a||13!=a.type&&14!=a.type?!1:!0};p.get_child_of_parent_tsr=function(a){if((a=a.constraint)&&13==a.type)return a.obj_parent.render.world_tsr;if(a&&14==a.type){var b=U;n.b(a.obj_parent,a.bone_name,!0,!1,b);d.q(a.obj_parent.render.world_tsr,b,b);return b}return null};p.get_child_of_offset=function(a){a=a.constraint;return!a||13!=a.type&&14!=a.type?null:a.tsr_offset};p.prepare_object_relations=function(a,
e){for(var p=e.render,q=0;q<a.constraints.length;q++){var n=a.constraints[q],u=n.type;if(n.target){var z=n.target._object;if("COPY_LOCATION"==u){var u=new Float32Array(d.j(e.render.world_tsr,M)),v=new Float32Array(n.axes);c(e,z,u,v,n.use_offset,n.influence)}else if("COPY_ROTATION"==u)v=new Float32Array(n.axes),C(e,z,v,n.use_offset,n.influence);else if("COPY_TRANSFORMS"==u)m(e,z,n.influence);else if("TRACK_TO"==u){u=n.track_axis;if("TRACK_Y"==u)var h=k.e;else"TRACK_NEGATIVE_Y"==u?h=k.b:"TRACK_X"==
u?h=k.d:"TRACK_NEGATIVE_X"==u?h=k.a:"TRACK_Z"==u?h=k.f:"TRACK_NEGATIVE_Z"==u&&(h=k.c);u=n.up_axis;if("UP_X"==u)var y=k.d;else"UP_Y"==u?y=k.e:"UP_Z"==u&&(y=k.f);l(e,z,h,y,n.use_target_z,n.influence)}}}if(e.parent){!e.parent_is_dupli&&e.physics_settings.use_collision_compound&&e.parent.physics_settings.use_collision_compound&&(e.use_obj_physics=!1);n=!1;for(q=0;q<e.scenes_data.length;q++)if(e.scenes_data[q].scene._physics){n=!0;break}if(n&&E.has_dynamic_settings(e))q=e.parent_is_dupli?d.a(p.world_tsr,
d.b()):p.world_tsr,d.q(e.parent.render.world_tsr,q,p.world_tsr);else if(e.parent_is_dupli||!e.parent_bone)if(q=d.a(p.world_tsr,d.b()),e.viewport_alignment&&"CAMERA"==e.parent.type){q={distance:e.viewport_alignment.distance,rotation:d.g(q,F)};switch(e.viewport_alignment.alignment){case "TOP_LEFT":q.top=0;q.left=0;break;case "TOP":q.top=0;q.left=.5;break;case "TOP_RIGHT":q.top=0;q.right=0;break;case "LEFT":q.top=.5;q.left=0;break;case "CENTER":q.top=.5;q.left=.5;break;case "RIGHT":q.top=.5;q.right=
0;break;case "BOTTOM_LEFT":q.bottom=0;q.left=0;break;case "BOTTOM":q.bottom=0;q.left=.5;break;case "BOTTOM_RIGHT":q.bottom=0,q.right=0}t(e,e.parent,q)}else b(e,e.parent,q);else q=d.a(p.world_tsr,d.b()),f(e,e.parent,e.parent_bone,q)}if("ARMATURE"==e.type)for(p=a.pose.bones,q=0;q<p.length;q++)if(n=p[q],h=n.constraints)for(y=0;y<h.length;y++)if(u=h[y],"COPY_TRANSFORMS"==u.type&&!u.subtarget&&!u.mute){var z=u.target._object,u=e,v=z,A=n.name,B=k.m,J=k.k,z=r(18);z.bone_name=A;z.target=v;z.tsr_offset=d.b();
d.v(new Float32Array(B),z.tsr_offset);d.r(new Float32Array(J),z.tsr_offset);d.s(1,z.tsr_offset);var v=u,A=z,B=A.target,J=A.bone_name,G=v.render.bone_pointers[J];a:for(var K=B.cons_armat_bone_descends,T=0;T<K;T++){var U=K[T];if(U[0]==v&&U[1]==J){K.splice(T,1);break a}}B.cons_armat_bone_descends.push([v,J]);G.constraint=A;fa(u,z)}};p.check_compatibility=function(a,b){return z(a.cons_descends,b)};p.check_self_applying=function(a,b){return a.name!=b.name}});t.a=e},function(C,t,e){C=e(0);var R=e(38),V=
e(5),n=e(44),y=e(14),d=e(52),k=e(12),I=e(1),A=e(10),r=e(4),p=e(53),u=e(16),a=e(20),B=e(27),l=e(21),c=e(19),m=e(8),b=e(23),f=e(18),T=e(13),fa=e(6),z=e(2),G=e(3),E=e(9);e=Object(C.a)("__logic_nodes",function(e,t){function J(a,b){return{name:a.name,type:a.type,label:a.label,slot_idx_order:a.slot_idx_order,slot_idx_jump:a.slot_idx_jump,frame_start:a.frame_range[0],frame_end:a.frame_range[1],frame_start_mask:a.frame_range_mask?a.frame_range_mask[0]:!0,frame_end_mask:a.frame_range_mask?a.frame_range_mask[1]:
!0,param_name:a.param_name,op:a.operation,mute:a.mute,dupli_name_list:a.object,anim_name:a.anim_name,parse_json_vars:a.parse_json_vars,parse_json_paths:a.parse_json_paths,objects_paths:a.objects_paths,nodes_paths:a.nodes_paths,floats:a.floats,bools:a.bools,vars:a.variables,strings:a.strings,logic_functions:a.logic_functions,logic_node_trees:a.logic_node_trees,materials_names:a.materials_names,shader_nd_type:a.shader_nd_type,common_usage_names:a.common_usage_names,encode_json_vars:a.encode_json_vars,
encode_json_paths:a.encode_json_paths,thread:b,process_node:Ja[a.type]?Ja[a.type]:Y,processed:!1,links_dict:a.links,instances:[],func_id:-1,links_keys:null,select_object_idx:-1}}function M(a,b,c){var d=b.thread_index+1-a.instances.length;if(0<d)for(var f=0;f<d;f++)a.instances.push(0);a.instances[b.thread_index]||(a.instances[b.thread_index]={objects:{},slot_idx_jump:-1,state:-1,sel_obj_idxs:[],timer:-1,camera_state:{},anim_slot:ra.SLOT_ALL,obj_state:null},c&&c(a,a.instances[b.thread_index],b));return a.instances[b.thread_index]}
function K(a,b,c){return a[0]?b[a[1]]:c[a[1]]}function C(a,b,c,d){a[0]?b[a[1]]=d:c[a[1]]=d}function v(a,b,c,d,f,g){switch(b.state){case 2:c.curr_node=a.slot_idx_order}}function Y(a,b,c,d,f,g){switch(b.state){case 1:ja.error("Unknown node type: "+a.type);break;case 2:c.curr_node=a.slot_idx_order}}function ha(a,b){for(var c=a.nodes,d=0;d<c.length;d++){var f=c[d];"SWITCH_SELECT"==f.type&&f!=b&&(M(f,a.thread_state).state=-3)}}function S(a,b,c){var d=da.get_selectable_objects(),f=M(a,c.thread_state);f.sel_obj_idxs=
[];f.links_idxs=[];for(var g in a.objects_paths){var e=a.bools[g]?K(a.vars[g],b.variables,c.thread_state.variables):da.get_object(da.GET_OBJECT_BY_DUPLI_NAME_LIST,a.objects_paths[g],0),e=d.indexOf(e);if(-1==e)return ja.error("logic script error: non-selectable object:",a.objects_paths[g][a.objects_paths[g].length-1]),-1;f.sel_obj_idxs.push(e);f.links_idxs.push(a.links_dict[g])}f.sel_objs_len=d.length;f=[];for(g=0;g<d.length;g++)f.push(ba.create_selection_sensor(d[g],!1));d=Ta();ba.create_sensor_manifold(null,
"LOGIC_NODES_SWITCH_SELECT_"+h(a.label),ba.CT_SHOT,f,ba.default_OR_logic_fun,d,[a,b,c])}function L(a,b,c,d,f){return c?K(a.vars[b],d,f):da.get_object(da.GET_OBJECT_BY_DUPLI_NAME_LIST,a.objects_paths[b],0)}function q(a){var b=a.thread_state.callstack;return 1>=b.length?a.nodes:b[b.length-1].logic_func.func.nodes}function w(a,b,c,d,f,g){a.thread_state.update_script_cycle=!1;var h=a.thread_state.callstack,e=1>=h.length?a.nodes:h[h.length-1].logic_func.func.nodes;if(e.length){if(!g)for(g=0;g<e.length;g++)e[g].processed=
!1;for(g=0;g<e.length;g++){if(0<=a.thread_state.curr_node)var l=e[a.thread_state.curr_node];else{if(1<a.thread_state.callstack.length){e=a.thread_state.callstack.pop().caller_node;h=h[h.length-1];a.thread_state.curr_node=e.slot_idx_order;e=a.thread_state.variables;a.thread_state.variables=h.variables;for(var k in a.thread_state.variables_references)h=a.thread_state.variables_references[k],void 0===a.thread_state.variables[k]?b.variables[k]=e[h]:a.thread_state.variables[k]=e[h];w(a,b,c,d,f,!0)}return}if(l.processed)return;
if(l.mute){if("ENTRYPOINT"==l.type)return;a.thread_state.curr_node=l.slot_idx_order;l.processed=!0}else if(l.process_node(l,b,a.thread_state,c,d,f),l.processed=!0,a.thread_state.update_script_cycle)return}h.splice(0,h.length)}}function ea(a,b){var c=a.b4w_logic_nodes,d=b.logic_threads,f=b.logic_functions;b.state=1;for(var h=-1,e=0;e<c.length;e++){for(var l={nodes:[],thread_state:{scene:a,curr_node:0,in_progress:!1,update_script_cycle:!1,thread_index:e,callstack:[],variables:{R1:0,R2:0,R3:0,R4:0,R5:0,
R6:0,R7:0,R8:0}}},k=c[e],m=0;m<k.length;m++){var q=J(k[m],l);l.nodes.push(q)}switch(l.nodes[0].type){case "ENTRYPOINT":h++;l.thread_state.thread_index=h;d.push(l);break;case "DEF_FUNC":q=l.nodes[0],l.thread_state=null,f.push({id:[q.logic_node_trees.id0,q.logic_functions.id0],func:l})}}for(e=0;e<d.length;e++)for(l=d[e],c=0;c<l.nodes.length;c++)q=l.nodes[c],q.mute||q.process_node(q,b,l.thread_state,0,0);for(e=0;e<f.length;e++)for(d=f[e].func,c=0;c<d.nodes.length;c++)q=d.nodes[c],q.mute||q.process_node(q,
b,0,0,0);var f=a.timeline_markers,n;for(n in f)b.sorted_markers_values.push(f[n]);b.sorted_markers_values.sort(function(a,b){return a-b});b.state=2;g.push(b)}function H(a,b){switch(b){case 0:return Number(a)?Number(a):0;case 1:return String(a);case 2:return a;default:return null}}function D(a){switch(typeof a){case "string":return H(a,1);case "number":return H(a,0);default:return H(a,1)}}function h(a){Ba[a]||(Ba[a]=0);var b=a+"_"+Ba[a],b=b.replace(/ /g,"_").replace(/\//g,"_");Ba[a]++;return b}function ia(a,
b){switch(b){case 0:return a.floats;case 1:return a.strings;case 2:return a.objects_paths}}var ra=Object(R.a)(e),za=Object(V.a)(e),P=Object(n.a)(e),oa=Object(y.a)(e),Q=Object(d.a)(e),da=Object(k.a)(e),ja=Object(I.a)(e),va=Object(A.a)(e),Ga=Object(r.a)(e),ba=Object(p.a)(e),Ea=Object(u.a)(e),ta=Object(a.a)(e),X=Object(c.a)(e),pa=Object(b.a)(e),ka=Object(f.a)(e),Ca=Object(T.a)(e),Ma=Object(E.a)(e),Aa=new Float32Array(4),xa=new Float32Array(3),ga=new Float32Array(3),ya=G.create(),O=G.create(),wa=new Float32Array(2),
qa=new Float32Array(9),na=new Float32Array(16);t.NT_NUMBER=0;t.NT_STRING=1;t.NT_OBJECT=2;t.NMO_DIV=0;t.NMO_SUB=1;t.NMO_MUL=2;t.NMO_ADD=3;t.NMO_RAND=4;t.NMO_SIN=5;t.NMO_COS=6;t.NMO_TAN=7;t.NMO_ARCSIN=8;t.NMO_ARCCOS=9;t.NMO_ARCTAN=10;t.NMO_LOG=11;t.NMO_MIN=12;t.NMO_MAX=13;t.NMO_ROUND=14;t.NMO_MOD=15;t.NMO_ABS=16;t.NSO_JOIN=0;t.NSO_FIND=1;t.NSO_REPLACE=2;t.NSO_SPLIT=3;t.NSO_COMPARE=4;t.NC_GEQUAL=0;t.NC_LEQUAL=1;t.NC_GREATER=2;t.NC_LESS=3;t.NC_NOTEQUAL=4;t.NC_EQUAL=5;t.NST_WORLD=0;t.NST_PARENT=1;t.NST_LOCAL=
2;t.NCMS_STATIC=0;t.NCMS_TARGET=1;t.NCMS_EYE=2;t.NCMS_HOVER=3;t.NCPT_OBJECT=0;t.NCPT_VARIABLE=1;var Ja={ENTRYPOINT:function(a,b,c,d,f,g){switch(b.state){case 2:0==c.callstack.length&&c.callstack.push({caller_node:null,variables:c.variables,logic_func:null}),c.curr_node=a.slot_idx_order}},HIDE:function(a,b,c,d,f,g){function h(a,b,c){e||(b.obj=da.get_object(da.GET_OBJECT_BY_DUPLI_NAME_LIST,a.objects_paths.id0,0),b.obj||(ja.error("Logic script error: object not found. Node: ",a.name),a.mute=!0))}var e=
a.bools.id0;switch(b.state){case 2:d=M(a,c,h),b=e?K(a.vars.id0,b.variables,c.variables):d.obj,a.bools.ch?va.change_visibility_rec(b,!0):va.change_visibility(b,!0),c.curr_node=a.slot_idx_order}},SHOW:function(a,b,c,d,f,g){function h(a,b,c){e||(b.obj=da.get_object(da.GET_OBJECT_BY_DUPLI_NAME_LIST,a.objects_paths.id0,0),b.obj||(ja.error("Logic script error: object not found. Node: ",a.name),a.mute=!0))}var e=a.bools.id0;switch(b.state){case 2:d=M(a,c,h),b=e?K(a.vars.id0,b.variables,c.variables):d.obj,
a.bools.ch?va.change_visibility_rec(b,!1):va.change_visibility(b,!1),c.curr_node=a.slot_idx_order}},PAGEPARAM:function(a,b,c,d,f,g){switch(b.state){case 2:d=a.vars.vd;b=b.variables;f=c.variables;a:{g=a.param_name;var h=a.floats.ptp,e=a.bools.hsh,l=Ga.get("url_params");if(l&&g in l)g=Number(l[g]);else{if(e=e?location.hash:location.search)for(e=e.slice(1).split("&"),l=0;l<e.length;l++){var k=e[l].split("=");if(1<k.length&&k[0]==g){g=H(k[1],h);break a}}g=0}}C(d,b,f,g);c.curr_node=a.slot_idx_order}},
SWITCH_SELECT:function(a,b,c,d,f,g){function e(a,b,c){b.state=-3}switch(b.state){case 2:if(d=M(a,c,e),-3==d.state)d.state=-2,ha(b.logic_threads[c.thread_index],a),S(a,b,b.logic_threads[c.thread_index]);else if(-2==d.state)d.state=-1;else if(0==d.state||1==d.state)a.vars.vd&&a.vars.vd[1]&&(f=da.get_selectable_objects(),C(a.vars.vd,b.variables,c.variables,f[d.select_object_idx])),c.curr_node=d.state?d.slot_idx_jump:a.slot_idx_order,d.state=-3,ba.remove_sensor_manifold(null,"LOGIC_NODES_SWITCH_SELECT_"+
h(a.label))}},SELECT:function(a,b,c,d,f,g){switch(b.state){case 1:ja.error("Logic script error: node is deprecated. Node: ",a.name),a.mute=!0}},PLAY:function(a,b,c,d,f,g){switch(b.state){case 1:Q.stop_nla();a.bools.not_wait||(a.bools.not_wait=!1);break;case 2:switch(f=M(a,c),f.state){case -1:if(Q.is_play(b._nla))if(b.curr_thread==b.nla_thread&&c.in_progress)break;else if(g=b.nla_thread){var h=q(g)[g.thread_state.curr_node];g.thread_state.curr_node=h.slot_idx_order;g=b.nla_thread;var e=g.thread_state.callstack,
l=e.length,h=[];1>=l&&h.push(g.nodes);for(var k=1;k<l;k++)h.push(e[k].logic_func.func.nodes);for(k=0;k<h.length;k++)for(e=0;e<h[k].length;e++)l=h[k][e],"PLAY"==l.type&&(M(l,g.thread_state).state=-1)}c.in_progress=!a.bools.not_wait;b.nla_thread=b.curr_thread;f.state=0;a.frame_start_mask&&(Q.set_range_start(a.frame_start),Q.set_offset_from_range_start(d));if(a.frame_end_mask)Q.set_range_end(a.frame_end);else{d=Q.get_frame(d);g=-1;for(var m in b.sorted_markers_values)if(d<b.sorted_markers_values[m]){g=
m;break}0<=g?Q.set_range_end(b.sorted_markers_values[g]):Q.set_range_end(Q.get_frame_end())}Q.play_nla(null);a.bools.not_wait&&(c.curr_node=a.slot_idx_order,f.state=-1,c.in_progress=!1);break;case 0:Q.is_play()||(c.curr_node=a.slot_idx_order,f.state=-1,c.in_progress=!1);break;case 1:c.curr_node=a.slot_idx_order;f.state=-1;b.nla_thread=null;c.in_progress=!1;break;default:za.panic("Unknown state of "+a.name),f.state=-1}}},REDIRECT:function(a,b,c,d,f,g){switch(b.state){case 2:a=a.bools.url?H(K(a.vars.url,
b.variables,c.variables),1):a.strings.url,window.location.href=a,b.state=3}},MATH:function(a,b,c,d,f,g){switch(b.state){case 2:d=-1==a.vars.id0[1]?a.floats.inp1:H(K(a.vars.id0,b.variables,c.variables),0);f=-1==a.vars.id1[1]?a.floats.inp2:H(K(a.vars.id1,b.variables,c.variables),0);g=0;switch(a.op){case 3:g=d+f;break;case 2:g=d*f;break;case 1:g=d-f;break;case 0:0==f&&za.panic("Division by zero in Logic script");g=d/f;break;case 4:g=Math.random()*(f-d)+d;break;case 5:g=Math.sin(d);break;case 6:g=Math.cos(d);
break;case 7:g=Math.tan(d);break;case 8:g=Math.asin(d);break;case 9:g=Math.acos(d);break;case 10:g=Math.atan(d);break;case 11:g=Math.log(d);break;case 12:g=Math.min(d,f);break;case 13:g=Math.max(d,f);break;case 14:g=Math.round(d);break;case 15:g=d%f;break;case 16:g=Math.abs(d)}C(a.vars.vd,b.variables,c.variables,g);c.curr_node=a.slot_idx_order}},CONDJUMP:function(a,b,c,d,f,g){switch(b.state){case 2:g=a.common_usage_names.variable_type;var h=ia(a,g);d=!1;if(2==g)switch(f=a.bools.id0?K(a.vars.id0,b.variables,
c.variables):da.get_object(da.GET_OBJECT_BY_DUPLI_NAME_LIST,a.objects_paths.id0,0),b=a.bools.id1?K(a.vars.id1,b.variables,c.variables):da.get_object(da.GET_OBJECT_BY_DUPLI_NAME_LIST,a.objects_paths.id1,0),a.common_usage_names.condition){case 5:f==b&&(d=!0);break;case 4:f!=b&&(d=!0)}else switch(f=-1==a.vars.id0[1]?h.inp1:H(K(a.vars.id0,b.variables,c.variables),g),b=-1==a.vars.id1[1]?h.inp2:H(K(a.vars.id1,b.variables,c.variables),g),a.common_usage_names.condition){case 5:f==b&&(d=!0);break;case 4:f!=
b&&(d=!0);break;case 3:f<b&&(d=!0);break;case 2:f>b&&(d=!0);break;case 1:f<=b&&(d=!0);break;case 0:f>=b&&(d=!0)}c.curr_node=d?a.slot_idx_jump:a.slot_idx_order}},REGSTORE:function(a,b,c,d,f,g){switch(b.state){case 2:a.bools.vs?d=K(a.vars.vs,b.variables,c.variables):(d=a.common_usage_names.variable_type,f=ia(a,d),d=2==d?da.get_object(da.GET_OBJECT_BY_DUPLI_NAME_LIST,f.id0,0):f.inp1),C([a.bools["new"]&&a.bools.gl||a.vars.vd[0],a.vars.vd[1]],b.variables,c.variables,d),c.curr_node=a.slot_idx_order}},PLAY_ANIM:function(a,
b,c,d,f,g){function h(a,b){for(var c=-1,d=0;8>d;d++){var f=a.anim_slots[d];if(f&&f.animation_name&&ra.strip_baked_suffix(f.animation_name)==ra.strip_baked_suffix(b))if(-1!=c)c=d;else return-1}return c}function e(a,c,d){c.obj=k?da.get_world_by_name(a.dupli_name_list[0],0):L(a,"id0",l,b.variables,d.variables);c.obj||l||(ja.error("Logic script error: object not found. Node: ",a.name),a.mute=!0)}var l=a.bools.id0,k=a.bools.env;switch(b.state){case 2:switch(d=M(a,c,e),k||(d.obj=l?K(a.vars.id0,b.variables,
c.variables):d.obj),0!=d.state||ra.is_play(d.obj,d.anim_slot)||(d.state=1),d.state){case -1:for(var m in b.logic_threads){f=b.logic_threads[m];g=q(f);var n=f.thread_state.curr_node;-1!=n&&(g=g[n],f=M(g,f.thread_state),"PLAY_ANIM"==g.type&&g!=a&&0==f.state&&f.obj==d.obj&&(f.state=1))}m=a.common_usage_names.param_anim_behavior;""==a.anim_name?(ra.apply_def(d.obj),ra.set_behavior(d.obj,m,ra.SLOT_ALL)):(f=h(d.obj,a.anim_name),-1==f?(d.anim_slot=ra.slot_by_anim_type(d.obj,a.anim_name),ra.apply(d.obj,null,
a.anim_name,d.anim_slot)):d.anim_slot=f,ra.set_behavior(d.obj,m,d.anim_slot));a.bools.not_wait||(c.in_progress=!0);ra.play(d.obj,null,d.anim_slot);d.state=0;a.bools.not_wait&&(c.curr_node=a.slot_idx_order,d.state=-1);break;case 0:break;case 1:a.bools.not_wait||(c.in_progress=!1);c.curr_node=a.slot_idx_order;d.state=-1;break;default:za.panic("Unknown state of "+a.name),d.state=-1}}},SELECT_PLAY:v,SEND_REQ:function(a,b,c,d,f,g){function h(a,c,d,f,g){a=JSON.stringify(a);c=g[1];d=M(g[0],c);C(g[0].vars.dst,
b.variables,c.variables,a);d.state=1}d=M(a,c);switch(b.state){case 2:switch(d.state){case -1:d.state=0;d=a.bools.url?H(K(a.vars.url,b.variables,c.variables),1):a.strings.url;f={};a.bools.ct&&(f["Content-Type"]=a.strings.ct);"GET"==a.common_usage_names.request_type?P.enqueue([{id:d,type:P.AT_JSON,url:d,overwrite_header:f,param:[a,c]}],h,null,null,null):"POST"==a.common_usage_names.request_type&&(g=H(K(a.vars.dst1,b.variables,c.variables),1),P.enqueue([{id:d,type:P.AT_JSON,url:d,overwrite_header:f,
request_method:"POST",post_data:g,param:[a,c]}],h,null,null,null));break;case 1:d.state=-1,c.curr_node=a.slot_idx_order}}},INHERIT_MAT:function(a,b,c,d,f,g){function h(a,b,c){for(c=0;2>c;c++)b.objects["id"+c]=da.get_object(da.GET_OBJECT_BY_DUPLI_NAME_LIST,a.objects_paths["id"+c],0),b.objects["id"+c]||(ja.error("Logic script error: object not found. Node: ",a.name),a.mute=!0)}switch(b.state){case 2:b=M(a,c,h),da.inherit_material(b.objects.id0,a.materials_names.id0,b.objects.id1,a.materials_names.id1),
c.curr_node=a.slot_idx_order}},SET_SHADER_NODE_PARAM:function(a,b,c,d,f,g){function h(a,b,c){a.objects_paths.id0&&(b.objects.id0=da.get_object(da.GET_OBJECT_BY_DUPLI_NAME_LIST,a.objects_paths.id0,0),a.objects_paths.id0||(ja.error("Logic script error: object not found. Node: ",a.name),a.mute=!0),a.nodes_paths.id0.unshift(a.materials_names.id0))}switch(b.state){case 2:d=M(a,c,h).objects.id0;g=a.nodes_paths.id0;f=g[0];g=Ea.name_list_to_node_name(g,1);var e=Ea.find_batch_material(d,f,"MAIN");c.curr_node=
a.slot_idx_order;null===e?ja.error('Material "'+f+'" was not found in the object "'+d.name+'".'):("ShaderNodeRGB"==a.shader_nd_type&&da.set_nodemat_rgb(d,f,g,a.bools.id0?H(K(a.vars.id0,b.variables,c.variables),0):a.floats.id0,a.bools.id1?H(K(a.vars.id1,b.variables,c.variables),0):a.floats.id1,a.bools.id2?H(K(a.vars.id2,b.variables,c.variables),0):a.floats.id2),"ShaderNodeValue"==a.shader_nd_type&&da.set_nodemat_value(d,f,g,a.bools.id0?H(K(a.vars.id0,b.variables,c.variables),0):a.floats.id0))}},DELAY:function(a,
b,c,d,f,g){d=M(a,c);switch(b.state){case 2:-1==d.state?(d.state=0,d.timer=0,c.in_progress=!0):0==d.state&&(d.timer+=f,(a.bools.dl?H(K(a.vars.dl,b.variables,c.variables),0):a.floats.dl)<d.timer&&(d.state=-1,c.curr_node=a.slot_idx_order,c.in_progress=!1))}},APPLY_SHAPE_KEY:function(a,b,c,d,f,g){function h(a,b,c){b=b.objects.id0=da.get_object(da.GET_OBJECT_BY_DUPLI_NAME_LIST,a.objects_paths.id0,0);b||(ja.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);c=a.common_usage_names.sk;
ta.check_shape_keys(b)?ta.has_shape_key(b,c)||(ja.error("Wrong key name:",c),a.mute=!0):(ja.error("No shape keys in object:",b.name),a.mute=!0)}switch(b.state){case 2:d=M(a,c,h),ta.apply_shape_key(d.objects.id0,a.common_usage_names.sk,a.bools.skv?H(K(a.vars.skv,b.variables,c.variables),0):a.floats.skv),c.curr_node=a.slot_idx_order}},OUTLINE:function(a,b,c,d,f,g){function h(a,b,c){e||(b.obj=da.get_object(da.GET_OBJECT_BY_DUPLI_NAME_LIST,a.objects_paths.id0,0),b.obj||(ja.error("Logic script error: object not found. Node: ",
a.name),a.mute=!0),b.obj&&b.obj.render&&b.obj.render.outlining||(ja.error("Can't evaluate 'Outline' logic node: wrong object"),a.mute=!0))}var e=a.bools.id0;switch(b.state){case 2:d=M(a,c,h);d=e?K(a.vars.id0,b.variables,c.variables):d.obj;switch(a.common_usage_names.outline_operation){case "PLAY":b=d.render.outline_anim_settings_default;da.apply_outline_anim(d,b.outline_duration,b.outline_period,b.outline_relapses);break;case "STOP":da.clear_outline_anim(d);break;case "INTENSITY":da.set_outline_intensity(d,
a.bools["in"]?H(K(a.vars["in"],b.variables,c.variables),0):a.floats["in"])}c.curr_node=a.slot_idx_order}},MOVE_CAMERA:function(a,b,c,d,f,g){function h(a,b,c,d){switch(oa.get_move_style(a)){case oa.MS_TARGET_CONTROLS:oa.set_trans_pivot(a,b,c);break;case oa.MS_EYE_CONTROLS:case oa.MS_STATIC:Ca.set_tsr(a,d);break;case oa.MS_HOVER_CONTROLS:G.sub(c,b,xa),G.normalize(xa,xa),oa.set_hover_pivot(a,c),ga[0]=xa[0],ga[1]=0,ga[2]=xa[2],b=G.dot(ga,xa),c=Math.acos(b/(G.length(ga)*G.length(xa))),b=xa[2]?Math.atan(xa[0]/
xa[2]):0<xa[0]?0:Math.PI,0<xa[2]&&0<xa[0]?wa[1]=-(Math.PI+wa[1]):0<xa[2]&&0>xa[0]?wa[1]=-(Math.PI+wa[1]):0>xa[2]&&0>xa[0]?(wa[0]+=Math.PI,b=-(Math.PI-b)):0>xa[2]&&0<xa[0]&&(wa[0]+=Math.PI,b-=Math.PI),oa.set_rotation_hover_angles(a,b+Math.PI,-c)}Ca.update_transform(a);X.sync_transform(a)}function e(a,b,c,d){l.lookAt(b,c,z.f,na);l.invert(na,na);B.fromMat4(na,qa);m.fromMat3(qa,Aa);m.normalize(Aa,Aa);a=fa.i(a.render.world_tsr);fa.t(b,a,Aa,d)}function k(a,c,d){(c.objects.ca=L(a,"id0",q,b.variables,d.variables))||
q||(ja.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);c.objects.tr=L(a,"id1",n,b.variables,d.variables);c.objects.tr||n||(ja.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);c.objects.ta=L(a,"id2",p,b.variables,d.variables);c.objects.ta||p||(ja.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);c.state=-1;c.camera_state={trans_start:new Float32Array(3),trans_end:new Float32Array(3),interp_trans:new Float32Array(3),target_start:new Float32Array(3),
target_end:new Float32Array(3),interp_target:new Float32Array(3),tsr_start:fa.b(),tsr_end:fa.b(),interp_tsr:fa.b()}}var q=a.bools.id0,n=a.bools.id1,p=a.bools.id2;switch(b.state){case 2:var r=M(a,c,k),w=q?K(a.vars.id0,b.variables,c.variables):r.objects.ca;d=n?K(a.vars.id1,b.variables,c.variables):r.objects.tr;f=p?K(a.vars.id2,b.variables,c.variables):r.objects.ta;d=fa.j(d.render.world_tsr,xa);f=fa.j(f.render.world_tsr,ya);switch(r.state){case -1:var u=a.bools.dur?H(K(a.vars.dur,b.variables,c.variables),
0):a.floats.dur;if(0==u){e(w,d,f,r.camera_state.tsr_end);h(w,d,f,r.camera_state.tsr_end);c.curr_node=a.slot_idx_order;break}a=fa.j(w.render.world_tsr,O);G.copy(a,r.camera_state.trans_start);var E=oa.get_move_style(w);E==oa.MS_HOVER_CONTROLS?G.copy(w.render.hover_pivot,r.camera_state.target_start):E==oa.MS_STATIC||E==oa.MS_EYE_CONTROLS?(fa.a(w.render.world_tsr,r.camera_state.tsr_start),e(w,d,f,r.camera_state.tsr_end)):G.copy(w.render.pivot,r.camera_state.target_start);G.copy(d,r.camera_state.trans_end);
G.copy(f,r.camera_state.target_end);r.state=0;u=ka.animate(0,1,1E3*u,function(a){va.check_active()&&(E==oa.MS_STATIC||E==oa.MS_EYE_CONTROLS?fa.o(r.camera_state.tsr_start,r.camera_state.tsr_end,z._53(a),r.camera_state.interp_tsr):(r.camera_state.interp_target=G.lerp(r.camera_state.target_start,r.camera_state.target_end,z._53(a),r.camera_state.interp_target),r.camera_state.interp_trans=G.lerp(r.camera_state.trans_start,r.camera_state.trans_end,z._53(a),r.camera_state.interp_trans)),h(w,r.camera_state.interp_trans,
r.camera_state.interp_target,r.camera_state.interp_tsr),1==a&&(r.state=1))});break;case 1:ka.clear_animation(u),r.state=-1,c.curr_node=a.slot_idx_order}}},SET_CAMERA_MOVE_STYLE:function(a,b,c,d,f,g){function h(a,b,c){e.id0||(b.objects.id0=da.get_object(da.GET_OBJECT_BY_DUPLI_NAME_LIST,a.objects_paths.id0,0))||(ja.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);e.pvo&&!e.id1&&(b.objects.id1=da.get_object(da.GET_OBJECT_BY_DUPLI_NAME_LIST,a.objects_paths.id1,0))}var e=a.bools;
switch(b.state){case 2:f=M(a,c,h);d=e.id0?K(a.vars.id0,b.variables,c.variables):f.objects.id0;g=d.render;f.cam_state={target_cam_upside_down:g.target_cam_upside_down,use_panning:g.use_panning,horizontal_limits:g.horizontal_limits,vertical_limits:g.vertical_limits,distance_limits:g.distance_limits,hover_horiz_trans_limits:g.hover_horiz_trans_limits,hover_vert_trans_limits:g.hover_vert_trans_limits,pivot_limits:g.pivot_limits,enable_hover_hor_rotation:g.enable_hover_hor_rotation};if(Ma.is_camera(d)){g=
d.render;var l=f.cam_state;oa.wipe_move_style(d);switch(a.common_usage_names.camera_move_style){case 0:g.move_style=oa.MS_STATIC;break;case 2:g.move_style=oa.MS_EYE_CONTROLS;var k=fa.j(g.world_tsr,xa);oa.setup_eye_model(d,k,null,l.horizontal_limits,l.vertical_limits);break;case 3:g.move_style=oa.MS_HOVER_CONTROLS;var k=fa.j(g.world_tsr,xa),m=ya;a.bools.pvo?(f=e.id1?K(a.vars.id1,b.variables,c.variables):f.objects.id1,m=fa.j(f.render.world_tsr,ya)):(m[0]=a.bools.pvx?H(K(a.vars.pvx,b.variables,c.variables),
0):a.floats.pvx,m[1]=a.bools.pvy?H(K(a.vars.pvy,b.variables,c.variables),0):a.floats.pvy,m[2]=a.bools.pvz?H(K(a.vars.pvz,b.variables,c.variables),0):a.floats.pvz);oa.setup_hover_model(d,k,m,l.distance_limits,l.vertical_limits,l.hover_horiz_trans_limits,l.hover_vert_trans_limits,l.enable_hover_hor_rotation);break;case 1:g.move_style=oa.MS_TARGET_CONTROLS,k=fa.j(g.world_tsr,xa),m=ya,a.bools.pvo?(f=e.id1?K(a.vars.id1,b.variables,c.variables):f.objects.id1,m=fa.j(f.render.world_tsr,ya)):(m[0]=a.bools.pvx?
H(K(a.vars.pvx,b.variables,c.variables),0):a.floats.pvx,m[1]=a.bools.pvy?H(K(a.vars.pvy,b.variables,c.variables),0):a.floats.pvy,m[2]=a.bools.pvz?H(K(a.vars.pvz,b.variables,c.variables),0):a.floats.pvz),oa.setup_target_model(d,k,m,l.horizontal_limits,l.vertical_limits,l.distance_limits,l.pivot_limits,l.use_panning)}ga[0]=a.bools.vtr?H(K(a.vars.vtr,b.variables,c.variables),0):a.floats.vtr;ga[1]=a.bools.vro?H(K(a.vars.vro,b.variables,c.variables),0):a.floats.vro;ga[2]=a.bools.vzo?H(K(a.vars.vzo,b.variables,
c.variables),0):a.floats.vzo;ga[0]=z.M(ga[0],0,Infinity);ga[1]=z.M(ga[1],0,Infinity);ga[2]=z.M(ga[2],0,.99);g.velocity_trans=ga[0];g.velocity_rot=ga[1];g.velocity_zoom=ga[2];Ca.update_transform(d);X.sync_transform(d);oa.init_ortho_props(d)}else ja.error("Logic script error: object is not a Camera. Node: ",a.name);c.curr_node=a.slot_idx_order}},SET_CAMERA_LIMITS:function(a,b,c,d,f,g){function h(a,b,c){e.id0||(b=b.objects.id0=da.get_object(da.GET_OBJECT_BY_DUPLI_NAME_LIST,a.objects_paths.id0,0),b||
(ja.error("Logic script error: object not found. Node: ",a.name),a.mute=!0))}var e=a.bools;switch(b.state){case 2:d=M(a,c,h);d=e.id0?K(a.vars.id0,b.variables,c.variables):d.objects.id0;if(Ma.is_camera(d)){switch(d.render.move_style){case oa.MS_TARGET_CONTROLS:if(a.bools.dsl){g=a.bools.dslmin?H(K(a.vars.dslmin,b.variables,c.variables),0):a.floats.dslmin;var l=a.bools.dslmax?H(K(a.vars.dslmax,b.variables,c.variables),0):a.floats.dslmax;f={};f.min=Math.max(g,0);f.max=Math.max(l,0);oa.set_distance_limits(d,
f)}a.bools.vrl&&(g=a.bools.vrldown?H(K(a.vars.vrldown,b.variables,c.variables),0):a.floats.vrldown,l=a.bools.vrlup?H(K(a.vars.vrlup,b.variables,c.variables),0):a.floats.vrlup,f={},f.down=g,f.up=l,f.camera_space="CAMERA"==a.common_usage_names.cam_lim_vert_rot_space_type,oa.set_vertical_rot_limits(d,f));a.bools.hrl&&(g=a.bools.hrlleft?H(K(a.vars.hrlleft,b.variables,c.variables),0):a.floats.hrlleft,l=a.bools.hrlright?H(K(a.vars.hrlright,b.variables,c.variables),0):a.floats.hrlright,f={},f.left=g,f.right=
l,f.camera_space="CAMERA"==a.common_usage_names.cam_lim_hor_rot_space_type,oa.set_horizontal_rot_limits(d,f));a.bools.pvl&&(g=a.bools.pvlmin?H(K(a.vars.pvlmin,b.variables,c.variables),0):a.floats.pvlmin,b=a.bools.pvlmax?H(K(a.vars.pvlmax,b.variables,c.variables),0):a.floats.pvlmax,f={},f.min_z=g,f.max_z=b,oa.set_pivot_limits(d,f));break;case oa.MS_HOVER_CONTROLS:a.bools.htl&&(g=a.bools.htlmin?H(K(a.vars.htlmin,b.variables,c.variables),0):a.floats.htlmin,l=a.bools.htlmax?H(K(a.vars.htlmax,b.variables,
c.variables),0):a.floats.htlmax,f={},f.min=g,f.max=l,oa.set_hor_trans_limits(d,f));a.bools.vtl&&(g=a.bools.vtlmin?H(K(a.vars.vtlmin,b.variables,c.variables),0):a.floats.vtlmin,l=a.bools.vtlmax?H(K(a.vars.vtlmax,b.variables,c.variables),0):a.floats.vtlmax,f={},f.min=g,f.max=l,oa.set_vert_trans_limits(d,f));a.bools.vrl&&(g=a.bools.vrldown?H(K(a.vars.vrldown,b.variables,c.variables),0):a.floats.vrldown,l=a.bools.vrlup?H(K(a.vars.vrlup,b.variables,c.variables),0):a.floats.vrlup,f={},f.down=g,f.up=l,f.camera_space=
"CAMERA"==a.common_usage_names.cam_lim_vert_rot_space_type,oa.hover_set_vertical_limits(d,f));a.bools.dsl&&(g=a.bools.dslmin?H(K(a.vars.dslmin,b.variables,c.variables),0):a.floats.dslmin,l=a.bools.dslmax?H(K(a.vars.dslmax,b.variables,c.variables),0):a.floats.dslmax,f={},f.min=Math.max(g,0),f.max=Math.max(l,0),oa.hover_set_distance_limits(d,f));break;case oa.MS_EYE_CONTROLS:a.bools.vrl&&(g=a.bools.vrldown?H(K(a.vars.vrldown,b.variables,c.variables),0):a.floats.vrldown,l=a.bools.vrlup?H(K(a.vars.vrlup,
b.variables,c.variables),0):a.floats.vrlup,f={},f.down=g,f.up=l,f.camera_space="CAMERA"==a.common_usage_names.cam_lim_vert_rot_space_type,oa.set_vertical_rot_limits(d,f)),a.bools.hrl&&(g=a.bools.hrlleft?H(K(a.vars.hrlleft,b.variables,c.variables),0):a.floats.hrlleft,l=a.bools.hrlright?H(K(a.vars.hrlright,b.variables,c.variables),0):a.floats.hrlright,f={},f.left=g,f.right=l,f.camera_space="CAMERA"==a.common_usage_names.cam_lim_hor_rot_space_type,oa.set_horizontal_rot_limits(d,f))}Ca.update_transform(d);
X.sync_transform(d)}else ja.error("Logic script error: object is not a Camera. Node: ",a.name);c.curr_node=a.slot_idx_order}},MOVE_TO:function(a,b,c,d,f,g){function h(a,b){Ca.set_tsr(a,b);Ca.update_transform(a);X.sync_transform(a)}function e(a,c,d){c.objects.id0=L(a,"id0",l,b.variables,d.variables);c.objects.id0||l||(ja.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);c.objects.id1=L(a,"id1",k,b.variables,d.variables);c.objects.id1||k||(ja.error("Logic script error: object not found. Node: ",
a.name),a.mute=!0);c.state=-1;c.obj_state={dest_tsr_start:fa.b(),dest_tsr_end:fa.b(),interp_tsr_dest:fa.b()}}d=a.bools;var l=d.id0,k=d.id1;switch(b.state){case 2:var m=M(a,c,e),q=d.id0?K(a.vars.id0,b.variables,c.variables):m.objects.id0;if(q.is_dynamic)switch(fa.a(q.render.world_tsr,m.obj_state.dest_tsr_start),d=d.id1?K(a.vars.id1,b.variables,c.variables):m.objects.id1,fa.a(d.render.world_tsr,m.obj_state.dest_tsr_end),m.state){case -1:var n=a.bools.dur?H(K(a.vars.dur,b.variables,c.variables),0):a.floats.dur;
if(0==n){h(q,m.obj_state.dest_tsr_end);c.curr_node=a.slot_idx_order;break}m.state=0;n=ka.animate(0,1,1E3*n,function(a){va.check_active()&&(m.obj_state.interp_dest=fa.o(m.obj_state.dest_tsr_start,m.obj_state.dest_tsr_end,z._53(a),m.obj_state.interp_tsr_dest),h(q,m.obj_state.interp_tsr_dest),1==a&&(m.state=1))});break;case 1:ka.clear_animation(n),m.state=-1,c.curr_node=a.slot_idx_order}else ja.error("Logic script error: object '"+q.name+"' must be dynamic. Node: ",a.name),c.curr_node=a.slot_idx_order}},
TRANSFORM_OBJECT:function(a,b,c,d,f,g){function h(a,b,c){0==c?Ca.set_tsr(a,b):Ca.set_tsr_rel(a,b);Ca.update_transform(a);X.sync_transform(a)}function e(a,c,d){c.obj=L(a,"id0",l,b.variables,d.variables);c.obj||l||(ja.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);c.state=-1;c.obj_state={space:0,tsr_start:fa.b(),tsr_end:fa.b(),interp_tsr:fa.b()}}var l=a.bools.id0;switch(b.state){case 2:var k=M(a,c,e),m=l?K(a.vars.id0,b.variables,c.variables):k.obj;switch(k.state){case -1:ga[0]=
a.bools.trx?H(K(a.vars.trx,b.variables,c.variables),0):a.floats.trx;ga[1]=a.bools["try"]?H(K(a.vars["try"],b.variables,c.variables),0):a.floats["try"];ga[2]=a.bools.trz?H(K(a.vars.trz,b.variables,c.variables),0):a.floats.trz;xa[0]=a.bools.rox?H(K(a.vars.rox,b.variables,c.variables),0)*Math.PI/180:a.floats.rox;xa[1]=a.bools.roy?H(K(a.vars.roy,b.variables,c.variables),0)*Math.PI/180:a.floats.roy;xa[2]=a.bools.roz?H(K(a.vars.roz,b.variables,c.variables),0)*Math.PI/180:a.floats.roz;d=a.bools.sc?K(a.vars.sc,
b.variables,c.variables):a.floats.sc;z.Y(xa,Aa);fa.t(ga,d,Aa,k.obj_state.tsr_end);k.obj_state.space=a.common_usage_names.space_type;switch(k.obj_state.space){case 0:Ca.get_tsr(m,k.obj_state.tsr_start);break;case 1:Ca.get_tsr_rel(m,k.obj_state.tsr_start);break;case 2:Ca.get_tsr_rel(m,k.obj_state.tsr_start),fa.q(k.obj_state.tsr_start,k.obj_state.tsr_end,k.obj_state.tsr_end)}d=a.bools.dur?H(K(a.vars.dur,b.variables,c.variables),0):a.floats.dur;if(0==d){h(m,k.obj_state.tsr_end,k.obj_state.space);c.curr_node=
a.slot_idx_order;break}k.state=0;var q=ka.animate(0,1,1E3*d,function(a){va.check_active()&&(fa.o(k.obj_state.tsr_start,k.obj_state.tsr_end,z._53(a),k.obj_state.interp_tsr),h(m,k.obj_state.interp_tsr,k.obj_state.space),1==a&&(k.state=1))});break;case 1:ka.clear_animation(q),k.state=-1,c.curr_node=a.slot_idx_order}}},SPEAKER_PLAY:function(a,b,c,d,f,g){function h(a,c,d){c.obj=L(a,"id0",e,b.variables,d.variables);c.obj||e||(ja.error("Logic script error: object not found. Node: ",a.name),a.mute=!0)}var e=
a.bools.id0;switch(b.state){case 1:void 0==a.bools.not_wait&&(a.bools.not_wait=!0);break;case 2:switch(d=M(a,c,h),d.obj=e?K(a.vars.id0,b.variables,c.variables):d.obj,pa.is_playing(d.obj)||0!=d.state||(d.state=1),d.state){case -1:for(var l in b.logic_threads)f=b.logic_threads[l].thread_state.curr_node,-1!=f&&(f=b.logic_threads[l].nodes[f],"SPEAKER_PLAY"==f.type&&f!=a&&0==d.state&&f.obj==a.obj&&(f.state=1));a.bools.not_wait||(c.in_progress=!0);pa.play_def(d.obj);d.state=0;break;case 0:a.bools.not_wait&&
(c.curr_node=a.slot_idx_order,d.state=-1);break;case 1:a.bools.not_wait||(c.in_progress=!1);c.curr_node=a.slot_idx_order;d.state=-1;break;default:za.panic("Unknown state of "+a.name),d.state=-1}}},SPEAKER_STOP:function(a,b,c,d,f,g){function h(a,c,d){c.obj=L(a,"id0",e,b.variables,d.variables);c.obj||e||(ja.error("Logic script error: object not found. Node: ",a.name),a.mute=!0)}var e=a.bools.id0;switch(b.state){case 2:d=M(a,c,h),d=e?K(a.vars.id0,b.variables,c.variables):d.obj,pa.stop(d),c.curr_node=
a.slot_idx_order}},STOP_ANIM:function(a,b,c,d,f,g){function h(a,c,d){c.obj=l?da.get_world_by_name(a.dupli_name_list[0],0):L(a,"id0",e,b.variables,d.variables);c.obj||e||(ja.error("Logic script error: object not found. Node: ",a.name),a.mute=!0)}var e=a.bools.id0,l=a.bools.env;switch(b.state){case 2:d=M(a,c,h),d.obj=e?K(a.vars.id0,b.variables,c.variables):d.obj,ra.stop(d.obj,ra.SLOT_ALL),a.bools.rst&&ra.set_first_frame(d.obj,ra.SLOT_ALL),c.curr_node=a.slot_idx_order}},STOP_TIMELINE:function(a,b,c,
d,f,g){switch(b.state){case 2:a.bools.rst&&Q.set_offset_from_range_start(d),Q.stop_nla(),c.curr_node=a.slot_idx_order}},CONSOLE_PRINT:function(a,b,c,d,f,g){switch(b.state){case 2:d=0;f="{";for(var h in a.vars){0<d&&(f+=", ");g=a.vars[h][1];var e=K(a.vars[h],b.variables,c.variables);f+='"'+g+'": ';try{f+=JSON.stringify(e)}catch(Ua){f=e?f+('{"name": "'+e.name+'", "type": "'+e.type+'"}'):f+"Object"}++d}ja.log(a.common_usage_names.msg,f+"}");c.curr_node=a.slot_idx_order}},STRING:function(a,b,c,d,f,g){switch(b.state){case 2:d=
a.bools.id0?H(K(a.vars.id0,b.variables,c.variables),1):a.strings.id0;f=a.bools.id1?H(K(a.vars.id1,b.variables,c.variables),1):a.strings.id1;g=0;switch(a.common_usage_names.string_operation){case 0:g=d+f;break;case 1:g=d.indexOf(f);break;case 2:g=a.bools.id2?H(K(a.vars.id2,b.variables,c.variables),1):a.strings.id2;g=d.replace(f,g);break;case 3:var h=a.vars;g=d.substring(0,d.indexOf(f));C(h.dst1,b.variables,c.variables,d.substring(d.indexOf(f)+1,d.length));""==K(h.dst,b.variables,c.variables)&&(g=K(h.dst1,
b.variables,c.variables),C(h.dst1,b.variables,c.variables,""));break;case 4:switch(a.common_usage_names.condition){case 5:g=d==f?1:0;break;case 4:g=d!=f?1:0;break;case 3:g=d<f?1:0;break;case 2:g=d>f?1:0;break;case 1:g=d<=f?1:0;break;case 0:g=d>=f?1:0}}C(a.vars.dst,b.variables,c.variables,g);c.curr_node=a.slot_idx_order}},GET_TIMELINE:function(a,b,c,d,f,g){switch(b.state){case 2:d=a.bools.nla?H(Q.get_frame(d),0):H(ka.get_frame(d),0),C(a.vars.vd,b.variables,c.variables,d),c.curr_node=a.slot_idx_order}},
JSON:function(a,b,c,d,f,g){function h(a,b,c,d){for(var f=0;f<b.length;f++){for(var g=b[f].split("."),h=a,e=c[f],l=0;l<g.length&&(h=h[g[l]],void 0!==h&&null!==h);l++);h=D(h);d[e]=h}}function e(a,b,c,d){d||(d={});for(var f=0;f<b.length;f++){var g=b[f].split("."),h=d,e=c[f];if(e in a){for(var l=0;l<g.length-1;l++)void 0===h[g[l]]&&(isNaN(g[l+1])?h[g[l]]={}:h[g[l]]=[]),h=h[g[l]];h[g[g.length-1]]=D(a[e])}}}switch(b.state){case 2:switch(a.common_usage_names.json_operation){case "PARSE":try{var l=H(K(a.vars.jsn,
b.variables,c.variables),1),k=JSON.parse(l);h(k,a.parse_json_paths,a.parse_json_vars,c.variables)}catch(Va){ja.error("logic script error: non valid JSON string")}break;case "ENCODE":d={},e(c.variables,a.encode_json_paths,a.encode_json_vars,d),d=H(JSON.stringify(d),1),C(a.vars.jsn,b.variables,c.variables,d)}c.curr_node=a.slot_idx_order}},JS_CALLBACK:function(a,b,c,d,f,g){switch(b.state){case 2:d=a.bools.cb?H(K(a.vars.cb,b.variables,c.variables),1):a.strings.cb;f=[];var h=0;g="id"+h;for(var e=a.common_usage_names.js_cb_params;g in
e;)g=0==e[g]?da.get_object(da.GET_OBJECT_BY_DUPLI_NAME_LIST,a.objects_paths[g],0):K(a.vars[g],b.variables,c.variables),f.push(g),h++,g="id"+h;e=[];h=0;for(g="out"+h;g in a.vars;)g=K(a.vars[g],b.variables,c.variables),e.push(g),h++,g="out"+h;h=1;if(d in Da){if(h=!Da[d](f,e))for(d=0;d<e.length;d++)g="out"+d,g in a.vars&&C(a.vars[g],b.variables,c.variables,D(e[d]))}else ja.error("logic script error: no custom callback with id "+d);h&&(c.curr_node=a.slot_idx_order)}},EMPTY:v,DATE_TIME:function(a,b,c,
d,f,g){switch(b.state){case 2:var h=new Date,e,l;"L"==a.common_usage_names.time_type?(d=h.getFullYear(),f=h.getMonth(),g=h.getDate(),e=h.getHours(),l=h.getMinutes(),h=h.getSeconds()):(d=h.getUTCFullYear(),f=h.getUTCMonth(),g=h.getUTCDate(),e=h.getUTCHours(),l=h.getUTCMinutes(),h=h.getUTCSeconds());a.bools.y&&C(a.vars.y,b.variables,c.variables,d);a.bools.M&&C(a.vars.M,b.variables,c.variables,f);a.bools.d&&C(a.vars.d,b.variables,c.variables,g);a.bools.h&&C(a.vars.h,b.variables,c.variables,e);a.bools.m&&
C(a.vars.m,b.variables,c.variables,l);a.bools.s&&C(a.vars.s,b.variables,c.variables,h);c.curr_node=a.slot_idx_order}},ELAPSED:function(a,b,c,d,f,g){switch(b.state){case 2:C(a.vars.s,b.variables,c.variables,f),c.curr_node=a.slot_idx_order}},CALL_FUNC:function(a,b,c,d,f,g){switch(b.state){case 1:c=a.logic_node_trees.id0;var h=a.logic_functions.id0;for(d=0;d<b.logic_functions.length;d++)if(f=b.logic_functions[d],f.id[0][0]==c[0]&&f.id[0][1]==c[1]&&f.id[1]==h){a.func_id=d;break}break;case 2:d={};c.variables_references=
{};for(h in a.vars)f=a.vars[h][1],g=a.strings[h],d[g]=a.vars[h][0]?b.variables[f]:c.variables[f],h.startsWith("out")&&(c.variables_references[f]=g);c.callstack.push({caller_node:a,variables:d,logic_func:b.logic_functions[a.func_id]});c.variables=d;c.update_script_cycle=!0;c.curr_node=b.logic_functions[a.func_id].func.nodes[0].slot_idx_order}},DEF_FUNC:v,SWITCH:function(a,b,c,d,f,g){switch(b.state){case 1:b=Object.keys(a.vars);for(var h in b)b[h].startsWith("id")||b.splice(h,1);a.links_keys=b;break;
case 2:d=K(a.vars.v,b.variables,c.variables);for(h in a.links_keys)if(f=K(a.vars[a.links_keys[h]],b.variables,c.variables),d==f){c.curr_node=a.links_dict[a.links_keys[h]];return}c.curr_node=a.slot_idx_order}}},g=[],Da={},Ba={};t.init_logic=function(a,b){var c={data_id:b,scene_name:a.name,state:0,nla_thread:null,scene:a,curr_thread:null,logic_threads:[],logic_functions:[],sorted_markers_values:[],variables:{},variables_references:{}};a._logic=c;ea(a,c)};t.update=function(a,b){var c=Q.get_start_time();
if(!(0>=c))for(var d=0;d<g.length;d++)for(var f=d,h=a,e=b,l=c,k=g[f],m=0;m<g[f].logic_threads.length;m++)k.curr_thread=g[f].logic_threads[m],w(g[f].logic_threads[m],k,h,e,l)};t.append_custom_cb=function(a,b){Da[a]=b};t.remove_custom_cb=function(a){delete Da[a]};t.run_ep=function(a,b){for(var c=0;c<g.length;c++)if(g[c].scene_name==a){for(var c=g[c],d=0;d<c.logic_threads.length;d++){var f=c.logic_threads[d].nodes[0];if(f.name==b){f.bools.js&&0<=[0,-1].indexOf(c.logic_threads[d].thread_state.curr_node)&&
(f.mute=!1,c.logic_threads[d].thread_state.curr_node=0);break}}break}};var Ta=function(){return function(a,b,c,d){c=d[1];var f=d[2];d=M(d[0],f.thread_state);if(-1==d.state){for(var g=0;g<d.sel_objs_len;g++)if(ba.get_sensor_value(a,b,g)){for(var h=0;h<d.sel_obj_idxs.length;h++)if(d.sel_obj_idxs[h]==g){c.nla_thread==d.thread?(Q.is_play(c._nla)&&(d.state=-3),f.thread_state.in_progress||(d.state=1,d.slot_idx_jump=d.links_idxs[h])):(d.state=1,d.slot_idx_jump=d.links_idxs[h]);d.select_object_idx=g;return}d.select_object_idx=
g}d.state=0}}};t.cleanup=function(){g.length=0;Da={};Ba={}}});t.a=e},function(C,t,e){C=e(0);var R=e(55),V=e(38),n=e(44),y=e(4),d=e(35),k=e(15),I=e(66),A=e(53),r=e(43),p=e(45),u=e(62),a=e(28),B=e(20),l=e(39),c=e(51),m=e(52),b=e(79),f=e(59),T=e(12),fa=e(19),z=e(1),G=e(22),E=e(10),J=e(23),M=e(34),F=e(17),U=e(18),K=e(13),sa=e(2),v=e(37),Y=e(47);e=Object(C.a)("main",function(e,t){function L(){window.performance||(ya.log("Apply performance workaround"),window.performance={});var a=Date.now();window.performance.now||
(ya.log("Apply performance.now() workaround"),window.performance.now=function(){return Date.now()-a});g.set_timeline(0)}function q(a,b){for(var c=null,d=b?Na:Ua,f=0;f<d.length;f++){var g=d[f];try{c=a.getContext(g,Ta)}catch(Ya){}if(c)break}c&&Q.detect_tegra_invalid_enum_issue(c);return c}function w(a,b,c){a.addEventListener("webglcontextlost",function(a){a.preventDefault();ya.error("WebGL context lost");H()},!1);ta.setup_context(c);var d=ta.get_renderer_info();d&&ya.log("%cRENDERER INFO:","color: #00a",
c.getParameter(d.UNMASKED_VENDOR_WEBGL)+", "+c.getParameter(d.UNMASKED_RENDERER_WEBGL));O.setup_context(c);X.setup_context(c);Ja.setup_context(c);na.setup_context(c);da.setup_context(c);ha.setup(c);ba.setup_context(c);Ga.setup_canvas(a);da.init(a,b);wa.setup_dim(a.width,a.height,1);qa.init();pa.init();W=ia();h()}function ea(){Ia=function(){}}function H(){D()||(fb=performance.now()/1E3,qa.pause(),ga.pause(),Ja.pause(),ra.pause())}function D(){return La<fb}function h(){var a="HMD"===ma.stereo&&pa.get_webvr_display();
a?a.requestAnimationFrame(h):Z(h);var b=performance.now()/1E3;Ka||(Ka=b);var c=b-Ka;if(!(c<1/ma.max_fps)){for(var d=g.get_timeline(),f=0;f<Xa.length;f++)Xa[f](d,c);D()||(La>Ka&&(c-=La-Math.max(fb,Ka)),g.set_delta(c),d+=c,g.set_timeline(d),Ea.update(),P.update(),Ga.update(),f=c,Ga.is_primary_loaded()&&(ka.reset(),Da.update(f),Aa.update(d,f),Ca.update(d,f),qa.update(d,f),f&&S.update(f),Ga.is_primary_loaded()&&(ga.update(d,f),Ga.is_primary_loaded()&&(pa.update(d),va.update(d,f),Ga.is_primary_loaded()&&
(ra.update(!1),xa.update(d,f),Ba.update(),Ia(f,d),Ga.is_primary_loaded()&&(wa.update(d,f),ra.update_visibility(),Ma.frame()))))),W(c));Ka=b;a&&a.isPresenting&&a.submitFrame()}}function ia(){var a=60,b=0,c=ma.fps_measurement_interval,d=ma.fps_callback_interval;return function(f){f<1/ma.max_fps||(a=sa._51(1/f,a,f,c),f=ga.get_fps(),b=(b+1)%d,0==b&&Wa(Math.round(a),f))}}var ra=Object(R.a)(e),S=Object(V.a)(e),P=Object(n.a)(e),C=Object(y.a)(e),Q=Object(d.a)(e),da=Object(k.a)(e),ha=Object(I.a)(e),va=Object(A.a)(e),
Ga=Object(r.a)(e),ba=Object(p.a)(e),Ea=Object(u.a)(e),ta=Object(a.a)(e),X=Object(B.a)(e),pa=Object(l.a)(e),ka=Object(c.a)(e),Ca=Object(m.a)(e),Ma=Object(b.a)(e),Aa=Object(f.a)(e),xa=Object(T.a)(e),ga=Object(fa.a)(e),ya=Object(z.a)(e),O=Object(G.a)(e),wa=Object(E.a)(e),qa=Object(J.a)(e),na=Object(M.a)(e),Ja=Object(F.a)(e),g=Object(U.a)(e),Da=Object(K.a)(e),Ba=Object(Y.a)(e),Ta=C.context,ma=C.defaults,Ka=0,fb=0,La=0,Xa=[],Wa=function(){},W=function(){},Ia=function(){},Ua=["webgl","experimental-webgl"],
Na=["webgl2","experimental-webgl2"],Va=null,Z=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return window.setTimeout(a,1E3/ma.max_fps)}}();t.init=function(a,b){ya.set_verbose(ma.console_verbose);var c=Object(v.f)()+" "+Object(v.d)()+" ("+Object(v.b)()+")";ya.log("%cINIT ENGINE","color: #00a",c);ya.log("%cUSER AGENT:","color: #00a",navigator.userAgent);if(!window.WebGLRenderingContext)return null;
L();b?ka.init(b):(C.defaults.show_hud_debug_info=!1,C.sfx.mix_mode=!1);Q.apply_context_alpha_hack();Q.check_user_agent("Chrome")||Q.check_user_agent("Firefox")||(ma.webgl2=!1);c=q(a,ma.webgl2);!c&&ma.webgl2&&(ma.webgl2=!1,c=q(a,!1));if(!c)return null;ya.log("%cINIT WEBGL "+(ma.webgl2?"2":"1"),"color: #00a");Va=c;w(a,b,c);C.apply_quality();Q.set_hardware_defaults(c,!0);C.set_paths();na.load_shaders();ma.ie11_edge_touchscreen_hack&&(a.style["touch-action"]="none");ya.log("%cSET PRECISION:","color: #00a",
ma.precision);return c};t.set_fps_callback=function(a){Wa=a};t.clear_fps_callback=function(){Wa=function(){}};t.set_render_callback=function(a){Ia=a};t.clear_render_callback=function(){ea()};t.pause=H;t.resume=function(){D()&&(La=performance.now()/1E3,qa.resume(),ga.resume(),Ja.play(!0),ra.resume())};t.is_paused=D;t.reset=function(){Ga.unload(0);ha.reset();Ga.reset();ta.reset();O.reset();X.reset();Ja.reset_mod();na.reset();ba.reset();da.reset();Ga.reset();da.reset();g.reset();qa.reset();La=fb=Ka=
0;Wa=function(){};W=function(){};Ia=function(){};Xa.length=0;Va=null};t.canvas_data_url=function(a,b,c,d){Ma.canvas_data_url(a,b,c,d)};t.detect_mobile=function(){return Q.detect_mobile()};t.append_loop_cb=function(a){for(var b=0;b<Xa.length;b++)if(Xa[b]==a)return;Xa.push(a)};t.remove_loop_cb=function(a){for(var b=0;b<Xa.length;b++)if(Xa[b]==a){Xa.splice(b,1);break}};t.get_renderer_info=function(){var a=ta.get_renderer_info();if(!a)return null;var b=Va.getParameter(a.UNMASKED_VENDOR_WEBGL),a=Va.getParameter(a.UNMASKED_RENDERER_WEBGL);
return{vendor:b,renderer:a}}});t.a=e},function(C,t,e){C=e(0);var R=e(5),V=e(4),n=e(88),y=e(31),d=e(27),k=e(21),I=e(1),A=e(34),r=e(2),p=e(3),u=e(17);e=Object(C.a)("__nodemat",function(a,e){function l(a,b,d,g,h,e){if(b in ob)return ob[b];var k={graph:null,id:b,cleanup_on_unload:!0};d||(Ya={},sb=0);if("SHADOW"!=g&&"COLOR_ID"!=g){for(var m=Z.create(),n=a.nodes,p=0;p<n.length;p++)if(null==ba(m,n[p],0,g,h,e))return ob[b]=null,k;if(d&&-1==ja(a,m,"GROUP_OUTPUT","group"))return k;p=Ta(m);h=d?a.links:a.links.slice();
if(!ma(m,h,p))return k;if(d)return k.graph=m,k;for(p=0;p<h.length;p++){d=h[p];for(var n=L(d.from_node,m),w=L(d.to_node,m),u=0;u<n.length;u++)for(var z=0;z<w.length;z++){var E=n[u],D=w[z],y=Z.get_node_attr(m,E),A=Z.get_node_attr(m,D);if(!Da(m,E,D,y,A,d))return ob[b]=null,k}}S(m);p=!1;h=-1;"GLOW"==g?h=ja(a,m,"B4W_GLOW_OUTPUT","material",!0):(h=ja(a,m,"OUTPUT","material",!1,!0),-1==h&&(h=ja(a,m,"OUTPUT_MATERIAL","material",!1,!0)),-1==h&&(h=ja(a,m,"OUTPUT_WORLD","material",!1,!0),p=!0));-1==h&&(m=C(),
h=0);q(m);a=Z.subgraph_node_conn(m,h,Z.BACKWARD_DIR);p?(J(a,g),M(a,g),F(a),U(a)):(c(a,g,e),f(a,g,e));v(a);ea(a);oa(a);ha(a,g);W(a)}else g=l(a,b,d,"MAIN",h,e),g=Z.clone(g.graph,function(a){var b=r.N(a);b.inputs=r.O(a.inputs);b.outputs=r.O(a.outputs);return b}),h=ja(a,g,"OUTPUT","material",!1,!0),-1==h&&(h=ja(a,g,"OUTPUT_MATERIAL","material",!1,!0)),K(g,h),a=Z.subgraph_node_conn(g,h,Z.BACKWARD_DIR),v(a);k.graph=a;return ob[b]=k}function c(a,b,c){var d=[];Z.traverse(a,function(a,b){"MATERIAL"!=b.type&&
"MATERIAL_EXT"!=b.type||d.push({node_id:a,node:b})});for(b=0;b<d.length;++b){var f=d[b].node_id,g=d[b].node,h=Z.gen_node_id(a);Z.append_node(a,h,g.data.material_begin);var e=Z.gen_node_id(a);Z.append_node(a,e,g.data.material_end);Z.append_edge(a,h,e,[4,2]);for(var l={5:["LIGHTING_APPLY",10],6:["LIGHTING_APPLY",6],7:["MATERIAL_END",3],8:["MATERIAL_END",4],9:["MATERIAL_END",5]},k=Z.in_edge_count(a,f),q=[],n=[],p=[],r={},w=0;w<k;w++){var u=Z.get_in_edge(a,f,w);u in r||(r[u]=0);var z=Z.get_edge_attr(a,
u,f,r[u]++);q.push([u,f,z]);var E=l[z[1]];if(E)switch(E[0]){case "MATERIAL_END":n.push([u,e,[z[0],E[1]]]);break;case "LIGHTING_APPLY":p.push([u,[z[0],E[1]]])}else n.push([u,h,z])}m(a,g.data.value,h,e,p,c);for(w=0;w<q.length;w++)Z.remove_edge_by_attr(a,q[w][0],q[w][1],q[w][2]);for(w=0;w<n.length;w++)Z.append_edge(a,n[w][0],n[w][1],n[w][2]);g=Z.out_edge_count(a,f);h=[];l=[];k={};for(w=0;w<g;w++)q=Z.get_out_edge(a,f,w),q in k||(k[q]=0),z=Z.get_edge_attr(a,f,q,k[q]++),h.push([f,q,z]),l.push([e,q,z]);
for(w=0;w<h.length;w++)Z.remove_edge_by_attr(a,h[w][0],h[w][1],h[w][2]);for(w=0;w<l.length;w++)Z.append_edge(a,l[w][0],l[w][1],l[w][2]);Z.remove_node(a,f)}}function m(a,c,d,f,g,h){var e={name:"LIGHTING_AMBIENT",type:"LIGHTING_AMBIENT"},l=ba(a,e,0,null,null,[]),k=l;b(a,d,l,"E");b(a,d,l,"A");b(a,d,l,"D");if(!c.use_shadeless)for(var m,q=0;q<h.length;q++){var n=h[q],e={name:"LIGHTING_LAMP",type:"LIGHTING_LAMP"};m=ba(a,e,0,null,null,[]);e={name:"LIGHTING_APPLY",type:"LIGHTING_APPLY"};l=ba(a,e,0,null,null,
[]);b(a,k,l,"color");b(a,k,l,"specular");b(a,m,l,"ldir");b(a,d,l,"normal");b(a,d,l,"D");b(a,d,l,"S");b(a,m,l,"lcolorint");b(a,d,m,"shadow_factor");e="SPECULAR_"+c.specular_shader;e={name:e,type:e,use_tangent_shading:c.use_tangent_shading};e=ba(a,e,0,null,null,[]);b(a,m,e,"ldir");b(a,m,e,"lfac");b(a,d,e,"normal");b(a,e,l,"sfactor");b(a,m,e,"norm_fac");b(a,d,e,"sp_params");n="HEMI"==n.type?"DIFFUSE_LAMBERT":"DIFFUSE_"+c.diffuse_shader;e={name:n,type:n,use_tangent_shading:c.use_tangent_shading};e=ba(a,
e,0,null,null,[]);b(a,m,e,"ldir");b(a,m,e,"lfac");b(a,d,e,"normal");b(a,m,e,"norm_fac");b(a,e,l,"lfactor");"DIFFUSE_LAMBERT"!=n&&b(a,d,e,"dif_params");for(m=0;m<g.length;m++)Z.append_edge(a,g[m][0],l,g[m][1]);k=l}b(a,k,f,"color");b(a,k,f,"specular")}function b(a,b,c,d){for(var f=Z.get_node_attr(a,b),g=-1,h=Z.get_node_attr(a,c).inputs,e=0;e<h.length;e++)if(d==h[e].identifier){g=e;break}if(-1!=g){for(var l=-1,f=f.outputs,e=0;e<f.length;e++)if(d==f[e].identifier){l=e;break}-1!=l&&(Z.append_edge(a,b,
c,[l,g]),f[l].is_linked=!0,h[g].is_linked=!0)}}function f(a,b,c){var d=[];Z.traverse(a,function(a,b){"OUTPUT_MATERIAL"==b.type&&d.push({node_id:a,node:b})});for(var f=0;f<d.length;++f){var g=d[f].node_id,h=d[f].node,e=!1,l=!1,k=Z.gen_node_id(a);Z.append_node(a,k,h.data.output_surface);for(var m=Z.in_edge_count(a,g),q=[],n=[],p={},r=0;r<m;r++){var w=Z.get_in_edge(a,g,r);w in p||(p[w]=0);var u=Z.get_edge_attr(a,w,g,p[w]++);q.push([w,g,u]);switch(u[1]){case 0:e=!0;n.push([w,k,u]);break;case 2:var l=
!0,z=Z.gen_node_id(a);Z.append_node(a,z,h.data.displacement_bump);n.push([w,z,[u[0],0]])}}for(r=0;r<q.length;r++)Z.remove_edge_by_attr(a,q[r][0],q[r][1],q[r][2]);for(r=0;r<n.length;r++)Z.append_edge(a,n[r][0],n[r][1],n[r][2]);Z.remove_node(a,g);e?(l&&B(a,k,z),G(a,b,c)):(g=Z.get_node_attr(a,k),a.nodes=[0,g],a.edges=[])}}function B(a,c,d){c=Z.subgraph_node_conn(a,c,Z.BACKWARD_DIR);var f=z(c);if(f.length){d=Z.subgraph_node_conn(a,d,Z.BACKWARD_DIR);d=Z.clone(d,Ga,g);Z.traverse(d,function(a,b){b.name=
"displacement%join%"+b.name});Z.append_subgraph(d,c,[],[]);var h=-1;Z.traverse(c,function(a,b){if("DISPLACEMENT_BUMP"==b.type)return h=a,1});for(d=0;d<f.length;d++){var e=f[d],l=Z.get_node_attr(c,e);b(c,h,e,"Normal");t(l,"USE_NORMAL_IN",1)}}a.nodes=c.nodes;a.edges=c.edges}function t(a,b,c){a=a.dirs;for(var d=0;d<a.length;d++){var f=a[d];f[0]==b&&(f[1]=c)}}function z(a){var b=[];Z.traverse(a,function(a,c){for(var d=!1,f=c.inputs,g=0;g<f.length;g++)if("Normal"==f[g].identifier){d=!f[g].is_linked;break}d&&
b.push(a)});return b}function G(a,b,c){var d=[];Z.traverse(a,function(a,b){"OUTPUT_SURFACE"==b.type&&d.push({node_id:a,node:b})});var f=[];d.length&&Z.traverse(a,function(a,b){"MIX_SHADER"==b.type&&f.push({node_id:a,node:b})});for(b=0;b<d.length;++b){var g=d[b].node_id,h=d[b].node,e=Z.gen_node_id(a);Z.append_node(a,e,h.data.bsdf_begin);var l=Z.gen_node_id(a);Z.append_node(a,l,h.data.bsdf_end);Z.append_edge(a,e,l,[4,2]);for(var k=Z.in_edge_count(a,g),m=[],q=[],n={},p=0;p<k;p++){var r=Z.get_in_edge(a,
g,p),w=Z.get_node_attr(a,r);r in n||(n[r]=0);var u=Z.get_edge_attr(a,r,g,n[r]++);m.push([r,g,u]);q.push([r,e,u]);if("BSDF_GLOSSY"==w.type||"BSDF_DIFFUSE"==w.type||"MIX_SHADER"==w.type||"EMISSION"==w.type||"BSDF_TRANSPARENT"==w.type||"BSDF_PRINCIPLED"==w.type)for(q.push([r,e,[1,1]]),q.push([r,e,[2,2]]),q.push([r,e,[3,3]]),q.push([r,e,[4,4]]),q.push([r,e,[5,5]]),q.push([r,e,[6,6]]),q.push([r,e,[7,7]]),q.push([r,e,[8,8]]),q.push([r,e,[9,9]]),q.push([r,e,[10,10]]),q.push([r,e,[11,11]]),q.push([r,e,[12,
12]]),r=0;r<f.length;++r)for(var w=f[r].node_id,u=Z.in_edge_count(a,w),z=0;z<u;z++){var v=Z.get_in_edge(a,w,z),D=Z.get_node_attr(a,v),y=Z.get_edge_attr(a,v,w,0);0==y[1]||"BSDF_GLOSSY"!=D.type&&"BSDF_DIFFUSE"!=D.type&&"MIX_SHADER"!=D.type&&"EMISSION"!=D.type&&"BSDF_TRANSPARENT"!=D.type&&"BSDF_PRINCIPLED"!=D.type||(D=1==y[1]?3:15,q.push([v,w,[1,D]]),q.push([v,w,[2,D+1]]),q.push([v,w,[3,D+2]]),q.push([v,w,[4,D+3]]),q.push([v,w,[5,D+4]]),q.push([v,w,[6,D+5]]),q.push([v,w,[7,D+6]]),q.push([v,w,[8,D+7]]),
q.push([v,w,[9,D+8]]),q.push([v,w,[10,D+9]]),q.push([v,w,[11,D+10]]),q.push([v,w,[12,D+11]]))}}E(a,h.data.value,e,l,[],c);q.push([l,g,[0,0]]);q.push([l,g,[1,1]]);for(p=0;p<m.length;p++)Z.remove_edge_by_attr(a,m[p][0],m[p][1],m[p][2]);for(p=0;p<q.length;p++)Z.append_edge(a,q[p][0],q[p][1],q[p][2])}}function E(a,c,d,f,g,h){var e={name:"LIGHTING_AMBIENT",type:"LIGHTING_AMBIENT"},l=ba(a,e,0,null,null,[]),k=l;b(a,d,l,"E");b(a,d,l,"A");b(a,d,l,"D");for(var m,q=0;q<h.length;q++){e={name:"LIGHTING_LAMP",
type:"LIGHTING_LAMP"};m=ba(a,e,0,null,null,[]);e={name:"LIGHTING_APPLY",type:"LIGHTING_APPLY"};l=ba(a,e,0,null,null,[]);b(a,k,l,"color");b(a,k,l,"specular");b(a,m,l,"ldir");b(a,d,l,"normal");b(a,d,l,"D");b(a,d,l,"S");b(a,m,l,"lcolorint");b(a,d,m,"shadow_factor");k=c.bsdf_shader;e={name:k,type:k};k=ba(a,e,0,null,null,[]);b(a,m,k,"ldir");b(a,m,k,"lfac");b(a,d,k,"normal");b(a,m,k,"norm_fac");b(a,d,k,"bsdf_params");b(a,k,l,"lfactor");b(a,k,l,"sfactor");for(m=0;m<g.length;m++)Z.append_edge(a,g[m][0],l,
g[m][1]);k=l}b(a,d,f,"bsdf_params");b(a,d,f,"refract_params");b(a,d,f,"d_color");b(a,d,f,"s_color");b(a,d,f,"e_color");b(a,d,f,"emission");b(a,d,f,"a_color");b(a,d,f,"alpha");b(a,k,f,"color");b(a,k,f,"specular")}function J(a,b){var c=[];Z.traverse(a,function(a,b){"OUTPUT_WORLD"==b.type&&c.push({node_id:a,node:b})});for(var d=0;d<c.length;++d){var f=c[d].node_id,g=c[d].node,h=Z.gen_node_id(a);Z.append_node(a,h,g.data.output_world_surface);for(var g=Z.in_edge_count(a,f),e=[],l=[],k={},m=0;m<g;m++){var q=
Z.get_in_edge(a,f,m);q in k||(k[q]=0);var n=Z.get_edge_attr(a,q,f,k[q]++);e.push([q,f,n]);switch(n[1]){case 0:l.push([q,h,n])}}for(m=0;m<e.length;m++)Z.remove_edge_by_attr(a,e[m][0],e[m][1],e[m][2]);for(m=0;m<l.length;m++)Z.append_edge(a,l[m][0],l[m][1],l[m][2]);Z.remove_node(a,f)}}function M(a,b){var c=[];Z.traverse(a,function(a,b){"MIX_SHADER"!=b.type&&"ADD_SHADER"!=b.type||c.push({node_id:a,node:b})});if(c.length)for(var d={name:"RGB_WORLD_NODE",type:"RGB_WORLD_NODE",factor:.5},f=0;f<c.length;f++){var g=
c[f].node_id,h=c[f].node;d.name=h.name;d.fac=h.inputs[0].default_value;d.fac_is_linked=h.inputs[0].is_linked;d.color1_is_linked=h.inputs[1].is_linked;d.color2_is_linked=h.inputs[2].is_linked;switch(h.type){case "ADD_SHADER":d.type="ADD_WORLD_RGB";break;case "MIX_SHADER":d.type="MIX_WORLD_RGB"}for(var h=ba(a,d,0,b,null,[]),e=Z.in_edge_count(a,g),l=[],k=[],m={},q=0;q<e;q++){var n=Z.get_in_edge(a,g,q);n in m||(m[n]=0);var p=Z.get_edge_attr(a,n,g,m[n]++);l.push([n,g,p]);k.push([n,h,p])}for(q=0;q<l.length;q++)Z.remove_edge_by_attr(a,
l[q][0],l[q][1],l[q][2]);for(q=0;q<k.length;q++)Z.append_edge(a,k[q][0],k[q][1],k[q][2]);e=Z.out_edge_count(a,g);l=[];k=[];m={};for(q=0;q<e;q++)n=Z.get_out_edge(a,g,q),n in m||(m[n]=0),p=Z.get_edge_attr(a,g,n,m[n]++),l.push([g,n,p]),k.push([h,n,p]);for(q=0;q<l.length;q++)Z.remove_edge_by_attr(a,l[q][0],l[q][1],l[q][2]);for(q=0;q<k.length;q++)Z.append_edge(a,k[q][0],k[q][1],k[q][2]);Z.remove_node(a,g)}}function F(a){var b=-1,c=[],d=[],f="OUTPUT_WORLD_SURFACE BACKGROUND RGB VALUE ADD_WORLD_RGB MIX_WORLD_RGB TEXTURE_ENVIRONMENT_EQUIRECTANGULAR TEXTURE_ENVIRONMENT_MIRROR_BALL GEOMETRY_NO GEOMETRY_TRN GEOMETRY_GL GEOMETRY_IN TEXTURE_COLOR TEX_COORD_GE TEX_COORD_OB TEX_COORD_NO COMBRGB COMBHSV CURVE_RGB CURVE_VEC B4W_LINEAR_TO_SRGB B4W_NORMAL_VIEW B4W_VECTOR_VIEW B4W_SRGB_TO_LINEAR B4W_REFLECT B4W_CLAMP B4W_TIME B4W_SMOOTHSTEP NORMAL MAPPING MATH_ADD MATH_SUBTRACT MATH_MULTIPLY MATH_DIVIDE MATH_SINE MATH_COSINE MATH_TANGENT MATH_ARCSINE MATH_ARCCOSINE MATH_ARCTANGENT MATH_POWER MATH_LOGARITHM MATH_MINIMUM MATH_MAXIMUM MATH_ROUND MATH_LESS_THAN MATH_GREATER_THAN MATH_MODULO MATH_ABSOLUTE MIX_RGB_MIX MIX_RGB_ADD MIX_RGB_MULTIPLY MIX_RGB_SUBTRACT MIX_RGB_SCREEN MIX_RGB_DIVIDE MIX_RGB_DIFFERENCE MIX_RGB_DARKEN MIX_RGB_LIGHTEN MIX_RGB_OVERLAY MIX_RGB_DODGE MIX_RGB_BURN MIX_RGB_HUE MIX_RGB_SATURATION MIX_RGB_VALUE MIX_RGB_COLOR MIX_RGB_SOFT_LIGHT MIX_RGB_LINEAR_LIGHT SEPRGB SEPHSV VALTORGB VECT_TRANSFORM VECT_MATH_ADD VECT_MATH_SUBTRACT VECT_MATH_AVERAGE VECT_MATH_DOT_PRODUCT VECT_MATH_CROSS_PRODUCT VECT_MATH_NORMALIZE".split(" ");
Z.traverse(a,function(a,d){switch(f.indexOf(d.type)){case -1:c.push({node_id:a,node:d});break;case 0:b=a}});for(var g=0;g<c.length;g++)for(var h=c[g].node_id,e=Z.out_edge_count(a,h),l={},k=0;k<e;k++){var m=Z.get_out_edge(a,h,k);m in l||(l[m]=0);var q=Z.get_edge_attr(a,h,m,l[m]++);d.push([h,m,q])}for(g=0;g<d.length;g++)Z.remove_edge_by_attr(a,d[g][0],d[g][1],d[g][2]);d.length&&(d=Z.subgraph_node_conn(a,b,Z.BACKWARD_DIR),a.nodes=d.nodes,a.edges=d.edges)}function U(a){var b=-1,c=[],d=[];Z.traverse(a,
function(a,d){switch(d.type){case "ADD_WORLD_RGB":case "MIX_WORLD_RGB":var f={node_id:a,node:d};c.push(f);break;case "OUTPUT_WORLD_SURFACE":b=a,f={node_id:a,node:d},c.push(f)}});for(var f=0;f<c.length;f++)for(var g=c[f].node_id,h=c[f].node,e=Z.in_edge_count(a,g),l={},k=0;k<e;k++){var m=Z.get_in_edge(a,g,k),q=Z.get_node_attr(a,m);m in l||(l[m]=0);var n=Z.get_edge_attr(a,m,g,l[m]++);"OUTPUT_WORLD_SURFACE"!=h.type&&0==n[1]||"ADD_WORLD_RGB"==q.type||"MIX_WORLD_RGB"==q.type||"BACKGROUND"==q.type||d.push([m,
g,n])}for(f=0;f<d.length;f++)Z.remove_edge_by_attr(a,d[f][0],d[f][1],d[f][2]);d.length&&(d=Z.subgraph_node_conn(a,b,Z.BACKWARD_DIR),a.nodes=d.nodes,a.edges=d.edges)}function K(a,b){Z.traverse_edges(a,function(c,d,f){var g=Z.get_node_attr(a,d);d==b&&"Color"==g.inputs[f[1]].identifier&&Z.remove_edge_by_attr(a,c,d,f)})}function C(){var a=Z.create(),b={data:null,dirs:[],params:[],inputs:[{default_value:new Float32Array([0,0,0]),identifier:"Color",is_linked:!1,name:"Color"},{default_value:1,identifier:"Alpha",
is_linked:!1,name:"Alpha"}],outputs:[],type:"OUTPUT",vparams:[]};Z.append_node(a,0,b);return a}function v(a){Z.traverse(a,function(b,c){for(var d=c.inputs,f=c.outputs,g=0;g<d.length;g++)Y(a,d[g],b,g,1);for(g=0;g<f.length;g++)Y(a,f[g],b,g,0)})}function Y(a,b,c,d,f){if(b.is_linked){var g=!0;Z.traverse_edges(a,function(a,b,h){if(!f&&a==c&&h[0]==d||f&&b==c&&h[1]==d)g=!1});g&&(b.is_linked=!1)}}function ha(a,b){var c=[];Z.traverse_edges(a,function(d,f,g){var h=Z.get_node_attr(a,d),e=Z.get_node_attr(a,f),
h=r._16(h.outputs[g[0]].default_value),e=r._16(e.inputs[g[1]].default_value);if(h!=e){var l,k={default_value:[0,0,0],identifier:"Vector",is_linked:!0,name:"Vector"},m={default_value:0,identifier:"Value",is_linked:!0,name:"Value"};h&&!e?l=va("vector_to_scalar","B4W_VECTOSCAL",[k],[m]):!h&&e&&(l=va("scalar_to_vector","B4W_SCALTOVEC",[m],[k]));ba(a,l,0,b,null,[]);c.push([d,f,a.nodes[a.nodes.length-2],g])}});for(var d=0;d<c.length;++d)Z.remove_edge_by_attr(a,c[d][0],c[d][1],c[d][3]),Z.append_edge(a,c[d][0],
c[d][2],[c[d][3][0],0]),Z.append_edge(a,c[d][2],c[d][1],[0,c[d][3][1]])}function S(a){var b=[];Z.traverse(a,function(c,d){switch(d.type){case "B4W_TRANSLUCENCY":Z.traverse_edges(a,function(f,g,h){var e=Z.get_node_attr(a,g);f==c&&"MATERIAL_EXT"==e.type&&"Translucency"==d.outputs[h[0]].name&&b.push(f,g,[h[0]+1,h[1]+1])})}});for(var c=0;c<b.length;c+=3)Z.append_edge(a,b[c],b[c+1],b[c+2])}function L(a,b){var c=[];Z.traverse(b,function(b,d){d.name==a.name&&c.push(b)});if(c.length)return c;Ua.panic("Node not found")}
function q(a){var b=[];Z.traverse(a,function(a,c){"B4W_PARALLAX"!=c.type&&"REROUTE"!=c.type||b.push(a,c)});for(var c=0;c<b.length;c+=2){var d=b[c],f=b[c+1];if("B4W_PARALLAX"==f.type)w(a,d,f);else if("REROUTE"==f.type){for(var g=Z.get_in_edge(a,d,0),h=Z.out_edge_count(a,d),e=[],l=[],k=[],m=0;m<h;m++){var q=Z.get_out_edge(a,d,m),n=l.indexOf(q),p=Z.get_edge_attr(a,d,q,0<=n?k[n]:0);if(p){var p=p[1],r=f.inputs[0].default_value,p=Z.get_node_attr(a,q).inputs[p];switch(typeof r){case "number":if("object"==
typeof p.default_value)for(var u=p.default_value,p=0;p<u.length;p++)u[p]=r;else"number"==typeof p.default_value&&(p.default_value=r);break;case "object":if("object"==typeof p.default_value)for(u=p.default_value,p=0;p<u.length;p++)u[p]=r[p];else"number"==typeof p.default_value&&(p.default_value=.35*r[0]+.45*r[1]+.2*r[2])}}r=f.outputs;for(p=0;p<r.length;p++)r[p].default_value=f.inputs[0].default_value;-1!=n?k[n]+=1:(l.push(q),k.push(1),e.push(d,q))}if(-1!=g)for(f=Z.get_edge_attr(a,g,d,0)[0],m=0;m<l.length;m++)for(p=
0;p<k[m];p++)h=Z.get_edge_attr(a,d,l[m],p)[1],Z.append_edge(a,g,l[m],[f,h]);for(m=0;m<e.length;m+=2)Z.remove_edge(a,e[m],e[m+1],-1)}}}function w(a,b,c){var d;a:{d=a.edges;for(var f=0;f<d.length;f+=3)if(d[f+1]==b&&1==d[f+2][1]){d=d[f];break a}d=-1}-1!=d&&(f=Z.get_node_attr(a,d),c.data=f.data,Z.remove_edge(a,d,b,-1),0==Z.out_edge_count(a,d)&&(b=Z.get_in_edge(a,d,0),-1!=b&&Z.remove_edge(a,b,d,-1),Z.remove_node(a,d)));c.inputs.splice(1,1)}function ea(a){h(a);za(a);H(a)}function H(a,b){var c={};Z.traverse(a,
function(a,b){if("GEOMETRY_UV"==b.type||"UVMAP"==b.type||"TEX_COORD_UV"==b.type){var d=b.data.value;d in c||(c[d]=[]);c[d].push(a,b)}});for(var d in c){var f=c[d];if(2<f.length)for(var g=D(d),g=ba(a,g,0,b,null,[]),h=Z.get_node_attr(a,g),e=0;e<f.length;e+=2){for(var l=f[e],k=f[e+1],m=[],q={},n=Z.out_edge_count(a,l),p=0;p<n;p++){var r=Z.get_out_edge(a,l,p);r in q||(q[r]=0);var w=Z.get_edge_attr(a,l,r,q[r]);q[r]++;m.push(l,r,w);w=w.splice(0,w.length);switch(k.type){case "GEOMETRY_UV":w[0]=0;h.outputs[0].is_linked=
!0;break;case "UVMAP":case "TEX_COORD_UV":w[0]=1,h.outputs[1].is_linked=!0}Z.append_edge(a,g,r,w)}for(p=0;p<m.length;p+=3)Z.remove_edge(a,m[p],m[p+1],0);Z.remove_node(a,l)}}}function D(a){var b=va("merged_uv","UV_MERGED",[],[{default_value:[0,0,0],identifier:"UV_geom",is_linked:!1,name:"UV_geom"},{default_value:[0,0,0],identifier:"UV_cycles",is_linked:!1,name:"UV_cycles"}]);b.uv_layer=a;return b}function h(a){var b=[];Z.traverse(a,function(a,c){"GEOMETRY_VC"!=c.type&&"GEOMETRY_NO"!=c.type&&"GEOMETRY_FB"!=
c.type&&"GEOMETRY_VW"!=c.type&&"GEOMETRY_GL"!=c.type&&"GEOMETRY_LO"!=c.type&&"GEOMETRY_OR"!=c.type&&"GEOMETRY_BF"!=c.type&&"GEOMETRY_IN"!=c.type||b.push(a,c)});for(var c=[],d=0;d<b.length;d+=2){for(var f=b[d],g=b[d+1],h=!0,e=0;e<c.length;e++){var l=c[e];if(P(g,l.attr)){for(var h=[],e=Z.out_edge_count(a,f),k=0;k<e;k++){var m=Z.get_out_edge(a,f,k),q=Z.get_edge_attr(a,f,m,0);h.push(f,m,q);Z.append_edge(a,l.id,m,q)}for(k=0;k<h.length;k+=3)Z.remove_edge(a,h[k],h[k+1],0);Z.remove_node(a,f);h=!1;break}}h&&
(l={id:f,attr:g},c.push(l))}}function ia(a){for(var b={},c=0;c<a.nodes.length;c+=2){var d=a.nodes[c];b[d]={ascs_ids:{},is_completed:!1}}for(c=0;c<a.edges.length;c+=3)b[a.edges[c+1]].ascs_ids[a.edges[c]]=!0;for(d in b)ra(d,b);for(d in b)b[d]=Object.keys(b[d].ascs_ids).map(function(a){return parseInt(a,10)});return b}function ra(a,b){var c=b[a];if(!c.is_completed){var d=r.O(c),f;for(f in c.ascs_ids){ra(f,b);var c=b[f],g;for(g in c.ascs_ids)d.ascs_ids[g]=!0}d.is_completed=!0;b[a]=d}}function za(a){var b=
[];Z.traverse(a,function(a,c){"TEXTURE_COLOR"!=c.type&&"TEXTURE_NORMAL"!=c.type||b.push(a,c)});if(b.length){for(var c=ia(a),d=[],f=0;f<b.length;f+=2){for(var g=b[f],h=b[f+1],e=!0,l=0;l<d.length;l++){var k=d[l];if(!(3<=k.merged_nodes.length||!P(h,k.attr)||-1<c[g].indexOf(k.id)||-1<c[k.id].indexOf(g))){for(var m=!1,q=0;q<k.merged_nodes.length;q++){var p=k.merged_nodes[q].id;if(-1<c[g].indexOf(p)||-1<c[p].indexOf(g)){m=!0;break}}if(!m){for(var l=[],p=Z.in_edge_count(a,g),n={},q=0;q<p;q++)m=Z.get_in_edge(a,
g,q),m in n||(n[m]=0),e=Z.get_edge_attr(a,m,g,n[m]++),l.push(m,g,e);for(var p=[],n=Z.out_edge_count(a,g),r={},q=0;q<n;q++)m=Z.get_out_edge(a,g,q),m in r||(r[m]=0),e=Z.get_edge_attr(a,g,m,r[m]++),p.push(g,m,e);e=l.concat(p);for(q=0;q<e.length;q+=3)Z.remove_edge(a,e[q],e[q+1],0);Z.remove_node(a,g);q={id:g,attr:h,edges_in:l,edges_out:p};k.merged_nodes.push(q);e=!1;break}}}e&&(k={id:g,attr:h,merged_nodes:[]},d.push(k))}for(f=0;f<d.length;f++){k=d[f];c=k.merged_nodes.length;for(l=0;l<c;l++){h=k.merged_nodes[l];
q=h.attr;g=h.edges_in;h=h.edges_out;k.attr.inputs[l+1].is_linked=q.inputs[0].is_linked;k.attr.inputs[l+1].default_value=q.inputs[0].default_value;k.attr.outputs[2*(l+1)].is_linked=q.outputs[0].is_linked;k.attr.outputs[2*(l+1)].default_value=q.outputs[0].default_value;k.attr.outputs[2*(l+1)+1].is_linked=q.outputs[1].is_linked;k.attr.outputs[2*(l+1)+1].default_value=q.outputs[1].default_value;for(q=0;q<g.length;q+=3)m=g[q],e=g[q+2],e[1]+=l+1,Z.append_edge(a,m,k.id,e);for(q=0;q<h.length;q+=3)m=h[q+1],
e=h[q+2],e[0]+=2*(l+1),Z.append_edge(a,k.id,m,e);k.attr.dirs.push(["USE_uv"+(l+2),1])}Z.remove_node(a,k.id);Z.append_node(a,k.id,k.attr)}}}function P(a,b){if(a.type!==b.type)return!1;switch(a.type){case "GEOMETRY_VC":return a.data.value==b.data.value;case "GEOMETRY_NO":for(var c=a.dirs,d=-1,f=0;f<c.length;f++){var g=c[f];if("USE_NORMAL_IN"==g[0]){d=g[1];break}}c=b.dirs;g=-1;for(f=0;f<c.length;f++){var h=c[f];if("USE_NORMAL_IN"==h[0]){g=h[1];break}}return d===g;case "GEOMETRY_FB":case "GEOMETRY_VW":case "GEOMETRY_GL":case "GEOMETRY_LO":case "GEOMETRY_OR":case "GEOMETRY_BF":case "GEOMETRY_IN":return!0;
case "TEXTURE_COLOR":case "TEXTURE_NORMAL":return a.data.bpy_uuid==b.data.bpy_uuid&&a.data.value.img_uuid==b.data.value.img_uuid;case "VALUE":case "RGB":return a.origin_name==b.origin_name;default:return!1}}function oa(a){var b=[],c=[];Z.traverse(a,function(a,d){"GEOMETRY_VC"==d.type&&b.push(a,d);"GEOMETRY_VW"==d.type&&c.push(a,d)});Q(a,b);da(a,c)}function Q(a,b){for(var c=0;c<b.length;c+=2){for(var d=b[c],f=b[c+1],g=!1,h=[],e=[],l=[[],[],[]],k=Z.out_edge_count(a,d),m=0;m<k;m++){var q=Z.get_out_edge(a,
d,m);if("SEPRGB"!=Z.get_node_attr(a,q).type){g=!1;break}h.push(d,q);for(var p={},n=Z.out_edge_count(a,q),g=0;g<n;g++){var w=Z.get_out_edge(a,q,g);w in p||(p[w]=0);var u=Z.get_edge_attr(a,q,w,p[w]++);h.push(q,w);l[u[0]].push(d,w,u)}e.push(q);g=!0}if(g){for(m=d=k=0;m<l.length;m++)l[m].length&&(k++,d|=1<<2-m);if(k){f.type+=k;f.outputs=[];for(m=0;m<l.length;m++)if(l[m].length)for(f.outputs.push({default_value:0,identifier:"RGB"[m],is_linked:!0,name:"RGB"[m]}),g=0;g<l[m].length;g+=3)l[m][g+2][0]=r._42(d,
m);for(m=0;m<h.length;m+=2)Z.remove_edge(a,h[m],h[m+1],0);for(m=0;m<e.length;m++)Z.remove_node(a,e[m]);for(m=0;m<l.length;m++)for(g=0;g<l[m].length;g+=3)Z.append_edge(a,l[m][g],l[m][g+1],l[m][g+2])}}}}function da(a,b){for(var c=0;c<b.length;c+=2){for(var d=b[c],f=!0,g=[],h=Z.out_edge_count(a,d),e=0;e<h;e++){var l=Z.get_out_edge(a,d,e);if("B4W_REFLECT"==Z.get_node_attr(a,l).type){var k=Z.get_edge_attr(a,d,l,0),m=Z.get_edge_attr(a,d,l,1);k&&1==k[1]||m&&1==m[1]?f=!1:g.push(d,l)}else f=!1}for(e=0;e<g.length;e+=
2)h=a,k=g[e],l=g[e+1],m=Z.get_node_attr(h,l),m.type+="_WORLD",Z.remove_edge(h,k,l,0),m.inputs.splice(0,1),k=Z.get_in_edge(h,l,0),k!=Z.NULL_NODE&&(Z.get_edge_attr(h,k,l,0)[1]=0);f&&Z.remove_node(a,d)}}function ja(a,b,c,d,f,g){a=a.nodes;for(var h=null,e=0;e<a.length;e++){var l=a[e];f?"GROUP"==l.type&&l.node_tree_name==c&&(h=l):l.type==c&&(h=l)}return h?L(h,b)[0]:(g||Oa.error('No "'+c+'" node in node '+d),-1)}function va(a,b,c,d){return{name:a,type:b,inputs:c,outputs:d}}function Ga(a){var b;b={name:"",
origin_name:"",type:"",vparams:[],inputs:[],outputs:[],params:[],data:null,dirs:[]};b.name=a.name;b.origin_name=a.origin_name;b.type=a.type;for(var c=b.vparams,d=a.vparams,f=0;f<d.length;f++)c.push(Ja(d[f]));c=b.params;d=a.params;for(f=0;f<d.length;f++)c.push(Ja(d[f]));c=b.inputs;d=a.inputs;for(f=0;f<d.length;f++){var g=d[f];c.push(O(g.name,g.identifier,g.default_value,g.is_linked))}c=b.outputs;d=a.outputs;for(f=0;f<d.length;f++)g=d[f],c.push(O(g.name,g.identifier,g.default_value,g.is_linked));c=
b.dirs;d=a.dirs;for(f=0;f<d.length;f++)c.push(d[f].slice());b.data=a.data;return b}function ba(a,b,c,f,g,h){var e=b.name,l=b.name,m=b.type,q=[],n=[],w=[],u=[],z=null,E="uv_layer"in b?b.uv_layer||g&&g.uv_name||"":"",v="color_layer"in b?b.color_layer||g&&g.vc_name||"":"",D=[];switch(m){case "BSDF_ANISOTROPIC":case "BSDF_GLASS":case "BSDF_HAIR":case "BSDF_TRANSLUCENT":case "BSDF_REFRACTION":case "BSDF_TOON":case "BSDF_VELVET":case "SUBSURFACE_SCATTERING":case "AMBIENT_OCCLUSION":case "VOLUME_ABSORPTION":case "VOLUME_SCATTER":case "BLACKBODY":case "WAVELENGTH":case "SEPXYZ":case "COMBXYZ":case "LIGHT_FALLOFF":case "TEX_SKY":case "TEX_NOISE":case "TEX_WAVE":case "TEX_MUSGRAVE":case "TEX_GRADIENT":case "TEX_MAGIC":case "TEX_CHECKER":case "TEX_BRICK":case "WIREFRAME":case "TANGENT":case "LIGHT_PATH":case "HOLDOUT":case "HAIR_INFO":case "SCRIPT":n=
wa(b);w=qa(b);Oa.warn(m+" node is not fully supported.");break;case "BRIGHTCONTRAST":case "ADD_SHADER":n=wa(b);w=qa(b);break;case "MIX_SHADER":n.push(xa(b,"Fac"));var y=xa(b,"Shader"),A=y.is_linked;n.push(y);var B=xa(b,"Shader_001");B||(B=xa(b,"Shader.001"));var t=B.is_linked;n.push(B);n.push(O("d_color1","d_color1",[0,0,0],A));n.push(O("d_roughness1","d_roughness1",0,A));n.push(O("s_color1","s_color1",[0,0,0],A));n.push(O("s_roughness1","s_roughness1",0,A));n.push(O("metalness1","metalness1",0,A));
n.push(O("normal1","normal1",[0,0,0],A));n.push(O("ior1","ior1",0,A));n.push(O("transmission1","transmission1",0,A));n.push(O("e_color1","e_color1",[0,0,0],A));n.push(O("emission1","emission1",0,A));n.push(O("a_color1","a_color1",[0,0,0],A));n.push(O("alpha1","alpha1",1,A));n.push(O("d_color2","d_color2",[0,0,0],t));n.push(O("d_roughness2","d_roughness2",0,t));n.push(O("s_color2","s_color2",[0,0,0],t));n.push(O("s_roughness2","s_roughness2",0,t));n.push(O("metalness2","metalness2",0,t));n.push(O("normal2",
"normal2",[0,0,0],t));n.push(O("ior2","ior2",0,t));n.push(O("transmission2","transmission2",0,t));n.push(O("e_color2","e_color2",[0,0,0],t));n.push(O("emission2","emission2",0,t));n.push(O("a_color2","a_color2",[0,0,0],t));n.push(O("alpha2","alpha2",1,t));var J=ga(b,"Shader"),G=J.is_linked,w=[J,O("d_color","d_color",[0,0,0],G),O("d_roughness","d_roughness",0,G),O("s_color","s_color",[0,0,0],G),O("s_roughness","s_roughness",0,G),O("metalness","metalness",0,G),O("normal","normal",[0,0,0],G),O("ior",
"ior",0,G),O("transmission","transmission",0,G),O("e_color","e_color",[0,0,0],G),O("emission","emission",0,G),O("a_color","a_color",[0,0,0],G),O("alpha","alpha",1,G)];break;case "OBJECT_INFO":var n=wa(b),w=[],H=ga(b,"Location"),F=ga(b,"Object Index"),K=ga(b,"Material Index"),T=ga(b,"Random");w.push(H);w.push(F);w.push(K);w.push(T);D.push(["USE_LOCATION_OUT",H.is_linked|0]);D.push(["USE_OBJ_IND_OUT",F.is_linked|0]);D.push(["USE_MAT_IND_OUT",K.is_linked|0]);D.push(["USE_RANDOM_OUT",T.is_linked|0]);
break;case "UVMAP":E||(m="EMPTY_UV");if("EMPTY_UV"!=m){var M=pa("param_"+m+"_a"),L=pa("param_"+m+"_v");q.push(na(M));q.push(na(L));u.push(na(L));z={name:M,value:E}}w=qa(b);break;case "UV_MERGED":M=pa("param_UV_MERGED_a");L=pa("param_UV_MERGED_v");q.push(na(M));q.push(na(L));w.push(ga(b,"UV_geom"));w.push(ga(b,"UV_cycles"));u.push(na(L));z={name:M,value:E};break;case "CAMERA":n=[];w=qa(b);break;case "COMBRGB":case "COMBHSV":n=wa(b);w=qa(b);break;case "CURVE_RGB":case "CURVE_VEC":"CURVE_RGB"==m?(Ia(b,
0,0,1)&&D.push(["READ_R",1]),Ia(b,1,0,1)&&D.push(["READ_G",1]),Ia(b,2,0,1)&&D.push(["READ_B",1]),Ia(b,3,0,1)&&D.push(["READ_A",1])):(Ia(b,0,-1,1)&&D.push(["READ_R",1]),Ia(b,1,-1,1)&&D.push(["READ_G",1]),Ia(b,2,-1,1)&&D.push(["READ_B",1]));n=wa(b);w=qa(b);z={value:b};break;case "PARTICLE_INFO":for(var n=wa(b),w=qa(b),ia=0;ia<b.outputs.length;ia++){var P=b.outputs[ia],I=P.identifier,fa=na("v_param_PART_INFO_"+I.replace(" ",""));if(P.is_linked)switch(I){case "Size":D.push(["PART_INFO_SIZE",Qa.glsl_value(1)]);
break;case "Age":D.push(["PART_INFO_AGE",Qa.glsl_value(1)]);break;case "Lifetime":D.push(["PART_INFO_LT",Qa.glsl_value(1)]);break;case "Location":D.push(["PART_INFO_LOC",Qa.glsl_value(1)]);break;case "Index":var U=na("a_param_PART_INFO_"+P.identifier.replace(" ","")),z=U;D.push(["PART_INFO_IND",Qa.glsl_value(1)]);break;case "Velocity":D.push(["PART_INFO_VEL",Qa.glsl_value(1)]);break;case "Angular Velocity":D.push(["PART_INFO_A_VEL",Qa.glsl_value(1)])}"Age"!=I&&"Lifetime"!=I&&"Size"!=I&&(q.push(fa),
u.push(fa))}U&&q.push(U);break;case "NEW_GEOMETRY":case "GEOMETRY":if(!ka(b))return!0;m=Ca(b,c);if(!m)return Oa.error("Geometry output is not supported"),null;switch(m){case "GEOMETRY_UV":E||(m="EMPTY_UV");"EMPTY_UV"!=m&&(M=pa("param_GEOMETRY_UV_a"),L=pa("param_GEOMETRY_UV_v"),q.push(na(M)),q.push(na(L)),u.push(na(L)),z={name:M,value:E});w.push(ga(b,"UV"));break;case "GEOMETRY_VC":v||(m="EMPTY_VC");if("EMPTY_VC"!=m){var ea=pa("param_GEOMETRY_VC_a"),ra=pa("param_GEOMETRY_VC_v");q.push(na(ea));q.push(na(ra));
u.push(na(ra));z={name:ea,value:v}}w.push(ga(b,"Vertex Color"));break;case "GEOMETRY_NO":n.push(O("Normal","Normal",[0,0,0],!1));D.push(["USE_NORMAL_IN",0]);w.push(ga(b,"Normal"));break;case "GEOMETRY_TRN":m="GEOMETRY_NO";n.push(O("Normal","Normal",[0,0,0],!1));w.push(ga(b,"True Normal"));D.push(["USE_NORMAL_IN",0]);Oa.warn("Geometry True Normal output is not fully supported.");break;case "GEOMETRY_FB":w.push(ga(b,"Front/Back"));break;case "GEOMETRY_VW":w.push(ga(b,"View"));break;case "GEOMETRY_GL":w.push(ga(b,
"Global")||ga(b,"Position"));break;case "GEOMETRY_LO":w.push(ga(b,"Local"));break;case "GEOMETRY_OR":var S=pa("param_GEOMETRY_OR_v");q.push(na(S));w.push(ga(b,"Orco"));u.push(na(S));break;case "GEOMETRY_IN":w.push(ga(b,"Incoming"));break;case "GEOMETRY_BF":w.push(ga(b,"Backfacing"))}break;case "ATTRIBUTE":if(!ka(b))return!0;m=v?"GEOMETRY_VC":"EMPTY_VC";"EMPTY_VC"!=m&&(ea=pa("param_GEOMETRY_VC_a"),ra=pa("param_GEOMETRY_VC_v"),q.push(na(ea)),q.push(na(ra)),u.push(na(ra)),z={name:ea,value:v});w.push(ga(b,
"Color"));break;case "TEX_COORD":if(!ka(b))return!0;m=Ma(b,c);switch(m){case "TEX_COORD_UV":E||(m="EMPTY_UV");"EMPTY_UV"!=m&&(M=pa("param_TEX_COORD_UV_a"),L=pa("param_TEX_COORD_UV_v"),q.push(na(M)),q.push(na(L)),u.push(na(L)),z={name:M,value:E});w.push(ga(b,"UV"));break;case "TEX_COORD_NO":w.push(ga(b,"Normal"));break;case "TEX_COORD_GE":var X=pa("param_TEX_COORD_GE_v");q.push(na(X));w.push(ga(b,"Generated"));u.push(na(X));break;case "TEX_COORD_OB":w.push(ga(b,"Object"));break;case "TEX_COORD_CA":w.push(ga(b,
"Camera"));break;case "TEX_COORD_WI":w.push(ga(b,"Window"));break;case "TEX_COORD_RE":w.push(ga(b,"Reflection"))}break;case "GROUP":var Y=b.node_tree_name;switch(Y){case "B4W_LINEAR_TO_SRGB":if(!Ea(b,[1],[1])){z=ta(b,f,g,[]);break}m="B4W_LINEAR_TO_SRGB";break;case "B4W_NORMAL_VIEW":case "B4W_VECTOR_VIEW":if(!Ea(b,[1],[1])){z=ta(b,f,g,[]);break}m="B4W_VECTOR_VIEW";break;case "B4W_SRGB_TO_LINEAR":if(!Ea(b,[1],[1])){z=ta(b,f,g,[]);break}m="B4W_SRGB_TO_LINEAR";break;case "B4W_REFLECT":if(!Ea(b,[1,1],
[1])){z=ta(b,f,g,[]);break}m="B4W_REFLECT";break;case "B4W_REFRACTION":if(!Ea(b,[1,0],[1])){z=ta(b,f,g,[]);break}m="B4W_REFRACTION";break;case "B4W_PARALLAX":if(!Ea(b,[1,1,0,0,0],[1])){z=ta(b,f,g,[]);break}var C=pa("param_B4W_PARALLAX_texture");u.push(na(C));m="B4W_PARALLAX";break;case "B4W_CLAMP":if(!Ea(b,[1],[1])){z=ta(b,f,g,[]);break}m="B4W_CLAMP";break;case "B4W_TRANSLUCENCY":if(!Ea(b,[0,0,0,0,0],[0])){z=ta(b,f,g,[]);break}m="B4W_TRANSLUCENCY";break;case "B4W_TIME":if(!Ea(b,[],[0])){z=ta(b,f,
g,[]);break}m="B4W_TIME";break;case "B4W_SMOOTHSTEP":if(!Ea(b,[0,0,0],[0])){z=ta(b,f,g,[]);break}m="B4W_SMOOTHSTEP";break;case "B4W_GLOW_OUTPUT":m="B4W_GLOW_OUTPUT";break;default:z=ta(b,f,g,h)}n=wa(b);w=qa(b);if("B4W_TRANSLUCENCY"==Y){var R=O("TranslucencyParams","TranslucencyParams",[0,0,0,0]);R.is_linked=w[0].is_linked;w.push(R)}break;case "LAMP":var za=b.lamp;za?(za.uuid in Ya?D.push(["LAMP_INDEX",String(Ya[za.uuid])]):(Ya[za.uuid]=sb,D.push(["LAMP_INDEX",String(sb++)])),z=Ya):(Oa.error("There is no lamp in node: "+
b.name),D.push(["LAMP_INDEX",-1]));w.push(ga(b,"Color"));w.push(ga(b,"Light Vector"));w.push(ga(b,"Distance"));w.push(ga(b,"Visibility Factor"));break;case "LIGHTING_AMBIENT":n=[O("E","E",[0,0,0],!0),O("A","A",[0,0,0],!0),O("D","D",[0,0,0],!0)];w=[O("color","color",[0,0,0],!0),O("specular","specular",[0,0,0],!0)];break;case "LIGHTING_BEGIN":w=[O("E","E",[0,0,0],!0),O("A","A",[0,0,0],!0),O("D","D",[0,0,0],!0),O("S","S",[0,0,0],!0),O("normal","normal",[0,0,0],!0),O("dif_params","dif_params",[0,0],!0),
O("sp_params","sp_params",[0,0],!0),O("shadow_factor","shadow_factor",0,!0),O("translucency_color","translucency_color",0,!0),O("translucency_params","translucency_params",[0,0,0,0],!0)];break;case "LIGHTING_END":n=[O("color","color",[0,0,0],!0),O("specular","specular",[0,0,0],!0)];break;case "LIGHTING_LAMP":n=[O("shadow_factor","shadow_factor",0,!0)];w=[O("ldir","ldir",[0,0,0],!0),O("lfac","lfac",[0,0],!0),O("lcolorint","lcolorint",[0,0,0],!0),O("norm_fac","norm_fac",0,!0)];break;case "DIFFUSE_LAMBERT":n=
[O("ldir","ldir",[0,0,0],!0),O("lfac","lfac",[0,0],!0),O("normal","normal",[0,0,0],!0),O("norm_fac","norm_fac",0,!0)];w=[O("lfactor","lfactor",0,!0)];D.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "DIFFUSE_FRESNEL":case "DIFFUSE_MINNAERT":case "DIFFUSE_OREN_NAYAR":case "DIFFUSE_TOON":n=[O("ldir","ldir",[0,0,0],!0),O("lfac","lfac",[0,0],!0),O("normal","normal",[0,0,0],!0),O("norm_fac","norm_fac",0,!0),O("dif_params","dif_params",[0,0],!0)];w=[O("lfactor","lfactor",0,!0)];D.push(["MAT_USE_TBN_SHADING",
b.use_tangent_shading|0]);break;case "SPECULAR_BLINN":case "SPECULAR_PHONG":case "SPECULAR_COOKTORR":n=[O("ldir","ldir",[0,0,0],!0),O("lfac","lfac",[0,0],!0),O("normal","normal",[0,0,0],!0),O("norm_fac","norm_fac",0,!0),O("sp_params","sp_params",[0,0],!0)];w=[O("sfactor","sfactor",0,!0)];D.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "SPECULAR_TOON":case "SPECULAR_WARDISO":n=[O("ldir","ldir",[0,0,0],!0),O("lfac","lfac",[0,0],!0),O("normal","normal",[0,0,0],!0),O("norm_fac","norm_fac",
0,!0),O("sp_params","sp_params",[0,0],!0)];w=[O("sfactor","sfactor",0,!0)];D.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "BSDF_COMPUTE":n=[O("ldir","ldir",[0,0,0],!0),O("lfac","lfac",[0,0],!0),O("normal","normal",[0,0,0],!0),O("norm_fac","norm_fac",0,!0),O("bsdf_params","bsdf_params",[0,0,0,0],!0)];w=[O("lfactor","lfactor",0,!0),O("sfactor","sfactor",0,!0)];break;case "LIGHTING_APPLY":n=[O("color","color",[0,0,0,0],!0),O("specular","specular",[0,0,0],!0),O("lfactor","lfactor",
0,!0),O("sfactor","sfactor",0,!0),O("ldir","ldir",[0,0,0],!0),O("normal","normal",[0,0,0],!0),O("translucency_params","translucency_params",[0,0,0,0],!0),O("D","D",[0,0,0],!0),O("S","S",[0,0,0],!0),O("lcolorint","lcolorint",[0,0,0],!0),O("translucency_color","translucency_color",0,!0)];w=[O("color","color",[0,0,0,0],!0),O("specular","specular",[0,0,0],!0)];break;case "NORMAL":var n=wa(b),w=qa(b),W=ga(b,"Normal");u.push(na(pa("param_NORMAL_Normal"),W.default_value,3));break;case "MAPPING":var Q=b.vector_type,
m="MAPPING";n.push(xa(b,"Vector"));w.push(ga(b,"Vector"));var da=r._1(b.rotation),V=r._1(b.scale),ha=r._1(b.translation),ma=d.create(),Ja=r.Z(da,d.create());if("TEXTURE"==Q||"NORMAL"==Q)V[0]=V[0]||1,V[1]=V[1]||1,V[2]=V[2]||1;var Fb=new Float32Array([V[0],0,0,0,V[1],0,0,0,V[2]]);d.multiply(Ja,Fb,ma);ma=r._23(ma,k.create());switch(Q){case "POINT":ma[12]=ha[0];ma[13]=ha[1];ma[14]=ha[2];break;case "TEXTURE":ma[12]=ha[0];ma[13]=ha[1];ma[14]=ha[2];ma=k.invert(ma,ma);break;case "NORMAL":k.invert(ma,ma),
k.transpose(ma,ma)}switch(Q){case "NORMAL":D.push(["MAPPING_IS_NORMAL",1]);case "TEXTURE":D.push(["MAPPING_TRS_MATRIX_DEF",1]);D.push(["MAPPING_TRS_MATRIX",Qa.glsl_value(ma,16)]);break;case "POINT":0!==p.length(da)?(D.push(["MAPPING_TRS_MATRIX_DEF",1]),D.push(["MAPPING_TRS_MATRIX",Qa.glsl_value(ma,16)])):(0!==p.sqrDist(V,r.n)&&(D.push(["MAPPING_SCALE_DEF",1]),D.push(["MAPPING_SCALE",Qa.glsl_value(V,3)])),0!==p.length(ha)&&(D.push(["MAPPING_TRANS_DEF",1]),D.push(["MAPPING_TRANS",Qa.glsl_value(ha,3)])));
break;case "VECTOR":0!==p.length(da)?(D.push(["MAPPING_TRS_MATRIX_DEF",1]),D.push(["MAPPING_TRS_MATRIX",Qa.glsl_value(ma,16)])):0!==p.sqrDist(V,r.n)&&(D.push(["MAPPING_SCALE_DEF",1]),D.push(["MAPPING_SCALE",Qa.glsl_value(V,3)]))}b.use_min&&(D.push(["MAPPING_MIN_CLIP_DEF",1]),D.push(["MAPPING_MIN_CLIP",Qa.glsl_value(b.min,3)]));b.use_max&&(D.push(["MAPPING_MAX_CLIP_DEF",1]),D.push(["MAPPING_MAX_CLIP",Qa.glsl_value(b.max,3)]));break;case "MATERIAL":case "MATERIAL_EXT":var sa=[],oa=[],ja=[],mb=[O("E",
"E",[0,0,0],!0),O("A","A",[0,0,0],!0),O("D","D",[0,0,0],!0),O("S","S",[0,0,0],!0),O("normal","normal",[0,0,0],!0),O("dif_params","dif_params",[0,0],!0),O("sp_params","sp_params",[0,0],!0),O("shadow_factor","shadow_factor",0,!0)],Sa=[O("color","color",[0,0,0],!0),O("specular","specular",[0,0,0],!0),O("normal","normal",[0,0,0],!0)],Da=[ga(b,"Color"),ga(b,"Alpha"),ga(b,"Normal")],Ba=[],ua=xa(b,"Color");ua.default_value.splice(3);ja.push(ua);n.push(ua);ua=xa(b,"Spec");ua.default_value.splice(3);ja.push(ua);
n.push(ua);(ua=xa(b,"DiffuseIntensity"))||(ua=xa(b,"Refl"));ua.default_value=b.diffuse_intensity;ja.push(ua);n.push(ua);var va=xa(b,"Normal");va.default_value.splice(3);ja.push(va);n.push(va);if("MATERIAL_EXT"==m){(ua=xa(b,"Emit"))||(ua=O("Emit","Emit",0));ja.push(ua);n.push(ua);(ua=xa(b,"Translucency"))?(ua.default_value=0,ua.name="Translucency",ua.identifier="Translucency"):ua=O("Translucency","Translucency",0);n.push(ua);(ua=xa(b,"Translucency"))?(ua.default_value=[0,0,0,0],ua.name="TranslucencyParams",
ua.identifier="TranslucencyParams"):ua=O("TranslucencyParams","TranslucencyParams",[0,0,0,0]);n.push(ua);var ib=xa(b,"Reflectivity"),yb=xa(b,"Ray Mirror");if(ib)var ua=ib,Ga="Reflectivity";else yb?(ua=yb,Ga="Ray Mirror"):(ua=ib,Ga="Reflectivity");ua||(ua=O(Ga,Ga,0));n.push(ua);Sa.push(ua);(ua=xa(b,"SpecTra"))||(ua=O("SpecTra","SpecTra",0));n.push(ua);Sa.push(ua);(ua=xa(b,"Alpha"))||(ua=O("Alpha","Alpha",b.alpha));n.push(ua);Sa.push(ua);Da.push(ga(b,"Diffuse"));Da.push(ga(b,"Spec"));sa.push(["MATERIAL_EXT",
1]);oa.push(["MATERIAL_EXT",1])}else ja.push(O("emit_intensity","emit_intensity",0)),Sa.push(O("reflect_factor","reflect_factor",0)),Sa.push(O("specular_alpha","specular_alpha",0)),Sa.push(O("alpha_in","alpha_in",0)),Da.push(O("diffuse_out","diffuse_out",0)),Da.push(O("spec_out","spec_out",0)),sa.push(["MATERIAL_EXT",0]),oa.push(["MATERIAL_EXT",0]);Ba.push(na(pa("param_MATERIAL_alpha"),b.alpha));Ba.push(na(pa("param_MATERIAL_spec_alpha"),b.specular_alpha));w=Da;sa.push(["USE_MATERIAL_NORMAL",va.is_linked|
0]);b.use_diffuse&&(sa.push(["USE_MATERIAL_DIFFUSE",1]),oa.push(["USE_MATERIAL_DIFFUSE",1]));b.use_specular&&oa.push(["USE_MATERIAL_SPECULAR",1]);var Xa=[],Ta,Ka=0;switch(b.specular_shader){case "COOKTORR":case "PHONG":Ta=b.specular_hardness;break;case "WARDISO":Ta=b.specular_slope;break;case "TOON":Ta=b.specular_toon_size;Ka=b.specular_toon_smooth;break;case "BLINN":Ta=b.specular_ior;Ka=b.specular_hardness;break;default:Oa.error("unsupported specular shader: "+b.specular_shader+' (material "'+b.material_name+
'")'),Ta=b.specular_hardness}var ya,La;switch(b.diffuse_shader){case "LAMBERT":La=ya=0;break;case "OREN_NAYAR":ya=b.roughness;La=0;break;case "FRESNEL":ya=b.diffuse_fresnel;La=b.diffuse_fresnel_factor;break;case "MINNAERT":ya=b.darkness;La=0;break;case "TOON":ya=b.diffuse_toon_size;La=b.diffuse_toon_smooth;break;default:Oa.error("unsupported diffuse shader: "+b.diffuse_shader+' (material "'+b.material_name+'")'),La=ya=0}Xa.push(na(pa("param_MATERIAL_diffuse"),[ya,La],2));Xa.push(na(pa("param_MATERIAL_spec"),
[b.specular_intensity,Ta,Ka],3));sa.push(["SHADELESS_MAT",b.use_shadeless?1:0]);var Wa={name:b.name,value:{specular_shader:b.specular_shader,diffuse_shader:b.diffuse_shader,use_shadeless:b.use_shadeless,use_tangent_shading:b.use_tangent_shading}},z={name:b.name,value:{specular_shader:b.specular_shader,diffuse_shader:b.diffuse_shader,use_shadeless:b.use_shadeless,use_tangent_shading:b.use_tangent_shading},material_begin:{name:"material_begin",type:"MATERIAL_BEGIN",inputs:ja,outputs:mb,params:Xa,data:Wa,
dirs:sa,vparams:[]},material_end:{name:"material_end",type:"MATERIAL_END",inputs:Sa,outputs:Da,params:Ba,data:Wa,dirs:oa,vparams:[]}};break;case "BSDF_PRINCIPLED":var n=wa(b),fb=xa(b,"Base Color"),Ua=xa(b,"Metallic"),Na=xa(b,"Roughness"),Va=xa(b,"IOR"),rb=xa(b,"Transmission"),gb=xa(b,"Normal"),n=[fb,Ua,Na,Va,rb,gb];D.push(["USE_NORMAL_IN",gb.is_linked|0]);var ob=ga(b,"BSDF"),ab=ob.is_linked,w=[ob,O("d_color","d_color",[0,0,0],ab),O("d_roughness","d_roughness",0,ab),O("s_color","s_color",[0,0,0],ab),
O("s_roughness","s_roughness",0,ab),O("metalness","metalness",1,ab),O("normal","normal",[0,0,0],ab),O("ior","ior",0,ab),O("transmission","transmission",0,ab),O("e_color","e_color",[0,0,0],ab),O("emisson","emisson",0,ab),O("a_color","a_color",[0,0,0],ab),O("alpha","alpha",1,ab)],z={value:{use_refract:rb.is_linked||rb.default_value}};break;case "BSDF_DIFFUSE":n=wa(b);D.push(["USE_NORMAL_IN",n[2].is_linked|0]);ob=ga(b,"BSDF");ab=ob.is_linked;w=[ob,O("d_color","d_color",[0,0,0],ab),O("d_roughness","d_roughness",
0,ab),O("s_color","s_color",[0,0,0],ab),O("s_roughness","s_roughness",0,ab),O("metalness","metalness",0,ab),O("normal","normal",[0,0,0],ab),O("ior","ior",0,ab),O("transmission","transmission",0,ab),O("e_color","e_color",[0,0,0],ab),O("emisson","emisson",0,ab),O("a_color","a_color",[0,0,0],ab),O("alpha","alpha",1,ab)];break;case "BSDF_GLOSSY":n=wa(b);D.push(["USE_NORMAL_IN",n[2].is_linked|0]);ob=ga(b,"BSDF");ab=ob.is_linked;w=[ob,O("d_color","d_color",[0,0,0],ab),O("d_roughness","d_roughness",0,ab),
O("s_color","s_color",[0,0,0],ab),O("s_roughness","s_roughness",0,ab),O("metalness","metalness",1,ab),O("normal","normal",[0,0,0],ab),O("ior","ior",0,ab),O("transmission","transmission",0,ab),O("e_color","e_color",[0,0,0],ab),O("emisson","emisson",0,ab),O("a_color","a_color",[0,0,0],ab),O("alpha","alpha",1,ab)];break;case "BSDF_TRANSPARENT":var Lc=b.b4w_use_alpha,n=wa(b),ob=ga(b,"BSDF"),ab=ob.is_linked,w=[ob,O("d_color","d_color",[0,0,0],ab),O("d_roughness","d_roughness",0,ab),O("s_color","s_color",
[0,0,0],ab),O("s_roughness","s_roughness",0,ab),O("metalness","metalness",0,ab),O("normal","normal",[0,0,0],ab),O("ior","ior",0,ab),O("transmission","transmission",0,ab),O("e_color","e_color",[0,0,0],ab),O("emisson","emisson",0,ab),O("a_color","a_color",[0,0,0],ab),O("alpha","alpha",Lc?0:1,ab)],z={value:{use_alpha:Lc}};D.push(["USE_ALPHA",Lc|0]);break;case "EMISSION":var n=wa(b),Dd=ga(b,"Emission"),tc=Dd.is_linked,w=[Dd,O("d_color","d_color",[0,0,0],tc),O("d_roughness","d_roughness",0,tc),O("s_color",
"s_color",[0,0,0],tc),O("s_roughness","s_roughness",0,tc),O("metalness","metalness",1,tc),O("normal","normal",[0,0,0],tc),O("ior","ior",0,ab),O("transmission","transmission",0,ab),O("e_color","e_color",[0,0,0],tc),O("emisson","emisson",1,tc),O("a_color","a_color",[0,0,0],ab),O("alpha","alpha",1,ab)];break;case "MATH":switch(b.operation){case "ADD":m="MATH_ADD";break;case "SUBTRACT":m="MATH_SUBTRACT";break;case "MULTIPLY":m="MATH_MULTIPLY";break;case "DIVIDE":m="MATH_DIVIDE";break;case "SINE":m="MATH_SINE";
break;case "COSINE":m="MATH_COSINE";break;case "TANGENT":m="MATH_TANGENT";break;case "ARCSINE":m="MATH_ARCSINE";break;case "ARCCOSINE":m="MATH_ARCCOSINE";break;case "ARCTANGENT":m="MATH_ARCTANGENT";break;case "POWER":m="MATH_POWER";break;case "LOGARITHM":m="MATH_LOGARITHM";break;case "MINIMUM":m="MATH_MINIMUM";break;case "MAXIMUM":m="MATH_MAXIMUM";break;case "ROUND":m="MATH_ROUND";break;case "LESS_THAN":m="MATH_LESS_THAN";break;case "GREATER_THAN":m="MATH_GREATER_THAN";break;case "MODULO":m="MATH_MODULO";
break;case "ABSOLUTE":m="MATH_ABSOLUTE";break;default:return Oa.error("Unsupported MATH operation: "+b.operation),null}D.push(["MATH_USE_CLAMP",Number(b.use_clamp)]);n=wa(b);w=qa(b);break;case "MIX_RGB":switch(b.blend_type){case "MIX":m="MIX_RGB_MIX";break;case "ADD":m="MIX_RGB_ADD";break;case "MULTIPLY":m="MIX_RGB_MULTIPLY";break;case "SUBTRACT":m="MIX_RGB_SUBTRACT";break;case "SCREEN":m="MIX_RGB_SCREEN";break;case "DIVIDE":m="MIX_RGB_DIVIDE";break;case "DIFFERENCE":m="MIX_RGB_DIFFERENCE";break;
case "DARKEN":m="MIX_RGB_DARKEN";break;case "LIGHTEN":m="MIX_RGB_LIGHTEN";break;case "OVERLAY":m="MIX_RGB_OVERLAY";break;case "DODGE":m="MIX_RGB_DODGE";break;case "BURN":m="MIX_RGB_BURN";break;case "HUE":m="MIX_RGB_HUE";break;case "SATURATION":m="MIX_RGB_SATURATION";break;case "VALUE":m="MIX_RGB_VALUE";break;case "COLOR":m="MIX_RGB_COLOR";break;case "SOFT_LIGHT":m="MIX_RGB_SOFT_LIGHT";break;case "LINEAR_LIGHT":m="MIX_RGB_LINEAR_LIGHT";break;default:return Oa.error("Unsupported MIX_RGB blend type: "+
b.blend_type),null}D.push(["MIX_RGB_USE_CLAMP",Number(b.use_clamp)]);n=wa(b);w=qa(b);break;case "MIX_WORLD_RGB":case "ADD_WORLD_RGB":n=[O("Factor","Factor",b.fac,b.fac_is_linked),O("Color1","Color1",[0,0,0],b.color1_is_linked),O("Color2","Color1",[0,0,0],b.color2_is_linked)];w=[O("Color","Color",[0,0,0],!0)];break;case "OUTPUT":n=wa(b);w=[];break;case "OUTPUT_MATERIAL":var n=wa(b),w=[],Jb=xa(b,"Surface"),Gb=Jb.is_linked,Id=[Jb,O("d_color","d_color",[0,0,0],Gb),O("d_roughness","d_roughness",0,Gb),
O("s_color","s_color",[0,0,0],Gb),O("s_roughness","s_roughness",0,Gb),O("metalness","metalness",0,Gb),O("normal","normal",[0,0,0],Gb),O("ior","ior",0,Gb),O("transmission","transmission",0,Gb),O("e_color","e_color",[0,0,0],Gb),O("emission","emission",0,Gb),O("a_color","a_color",[0,0,0],Gb),O("alpha","alpha",0,Gb)],Ed=[O("E","E",[0,0,0],!0),O("A","A",[0,0,0],!0),O("D","D",[0,0,0],!0),O("S","S",[0,0,0],!0),O("normal","normal",[0,0,0],!0),O("bsdf_params","bsdf_params",[0,0,0,0],!0),O("refract_params",
"refract_params",[0,0,0,0],!0),O("shadow_factor","shadow_factor",0,!0),O("d_color","d_color",[0,0,0],!0),O("s_color","s_color",[0,0,0],!0),O("e_color","e_color",[0,0,0],!0),O("emission","emission",0,!0),O("a_color","a_color",[0,0,0],!0),O("alpha","alpha",0,!0)],dd=[O("color","color",[0,0,0],!0),O("specular","specular",[0,0,0],!0),O("normal","normal",[0,0,0],!0),O("bsdf_params","bsdf_params",[0,0,0,0],!0),O("refract_params","refract_params",[0,0,0,0],!0),O("d_color","d_color",[0,0,0],!0),O("s_color",
"s_color",[0,0,0],!0),O("e_color","e_color",[0,0,0],!0),O("emission","emission",0,!0),O("a_color","a_color",[0,0,0],!0),O("alpha","alpha",0,!0)],Yd=[O("color","color",[0,0,0],Gb),O("alpha","alpha",1,Gb)],Fd={name:"bsdf_begin",type:"BSDF_BEGIN",inputs:Id,outputs:Ed,params:[],data:null,dirs:[],vparams:[]},Jd={name:"bsdf_end",type:"BSDF_END",inputs:dd,outputs:Yd,params:[],data:null,dirs:[],vparams:[]},Yc={name:"output_surface",type:"OUTPUT_SURFACE",inputs:[Jb,O("alpha","alpha",1,Gb)],outputs:[],params:[],
data:{value:{bsdf_shader:"BSDF_COMPUTE"},bsdf_begin:Fd,bsdf_end:Jd},dirs:[],vparams:[]},td=[O("Height","Height",0,!0)],Pc=[O("Normal","Normal",[0,0,0],!1)],z={name:b.name,output_surface:Yc,displacement_bump:{name:"displacement_bump",type:"DISPLACEMENT_BUMP",inputs:td,outputs:Pc,params:[],data:null,dirs:[],vparams:[]}};break;case "OUTPUT_WORLD":n=wa(b);w=qa(b);Jb=xa(b,"Surface");Yc={name:"output_world_surface",type:"OUTPUT_WORLD_SURFACE",inputs:[Jb],outputs:[],params:[],data:null,dirs:[],vparams:[]};
z={name:b.name,output_world_surface:Yc};break;case "RGB":var ub=b.name,Ob={name:"-1",value:ub};u.push(Ob);w.push(ga(b,"Color"));break;case "SEPRGB":case "SEPHSV":n=wa(b);w=qa(b);break;case "TEX_ENVIRONMENT":var Zc=b.image;if(Zc){m="TEXTURE_ENVIRONMENT_"+b.projection;"NONE"==b.color_space?D.push(["NON_COLOR",1]):D.push(["NON_COLOR",0]);n.push(xa(b,"Vector"));D.push(["USE_VECTOR_IN",n[0].is_linked|0]);w.push(ga(b,"Color"));C=pa("param_TEXTURE_texture");u.push(na(C));var kb=$a.create_texture($a.TT_RGBA_INT,
!1);kb.repeat=!0;kb.source="IMAGE";Mb.anisotropic_available&&(kb.anisotropic_filtering=16);$a.append_img_info(kb,Zc);z={bpy_name:b.name,bpy_uuid:"",name:C,value:kb}}else m="TEXTURE_EMPTY";break;case "TEX_IMAGE":if(Zc=b.image){m="TEXTURE_COLOR";"NONE"==b.color_space?D.push(["NON_COLOR",1]):D.push(["NON_COLOR",0]);D.push(["CONVERT_UV",0]);for(var Xb=0;4>Xb;++Xb){var hc,Fc;Xb?(ua=O("Vector"+Xb,"Vector"+Xb,[0,0,0],!1),hc=O("Color"+Xb,"Color"+Xb,[0,0,0],!1),Fc=O("Alpha"+Xb,"Alpha"+Xb,0,!1)):(ua=xa(b,"Vector"),
hc=ga(b,"Color"),Fc=ga(b,"Alpha"));n.push(ua);w.push(hc);w.push(Fc)}C=pa("param_TEXTURE_texture");u.push(na(C));kb=$a.create_texture($a.TT_RGBA_INT,!1);kb.repeat="REPEAT"==b.extension;kb.source="IMAGE";$a.append_img_info(kb,Zc);z={bpy_name:b.name,bpy_uuid:"",name:C,value:kb}}else m="TEXTURE_EMPTY";break;case "TEXTURE":m=Aa(b);if("TEXTURE_EMPTY"==m)w.push(ga(b,"Color")),w.push(ga(b,"Normal")),w.push(ga(b,"Value"));else if("TEXTURE_ENVIRONMENT_CUBE"==m)n.push(xa(b,"Vector")),w.push(ga(b,"Color")),w.push(ga(b,
"Value"));else{if("TEXTURE_NORMAL"==m&&"ENVIRONMENT_MAP"==b.texture.type)return Oa.error("Wrong output for ENVIRONMENT_MAP texture: "+b.name),null;if("TEXTURE_COLOR"==m){var Kb=!1,$b=b.texture.image;!$b||"Non-Color"!=$b.colorspace_settings_name&&"Non-Colour Data"!=$b.colorspace_settings_name||(Kb=!0);D.push(["NON_COLOR",Number(Kb)]);D.push(["CONVERT_UV",1])}for(Xb=0;4>Xb;++Xb){var wc="TEXTURE_COLOR"==m?"Color":"Normal";Xb?(ua=O("Vector"+Xb,"Vector"+Xb,[0,0,0],!1),hc=O(wc+Xb,wc+Xb,[0,0,0],!1),Fc=O("Value"+
Xb,"Value"+Xb,0,!1)):(ua=xa(b,"Vector"),hc=ga(b,wc),Fc=ga(b,"Value"));n.push(ua);w.push(hc);w.push(Fc)}}"TEXTURE_EMPTY"!=m&&(C=pa("param_TEXTURE_texture"),u.push(na(C)),kb=b.texture._render,z={bpy_name:b.texture.name,bpy_uuid:b.texture.uuid,name:C,value:kb});break;case "VALTORGB":var n=wa(b),w=qa(b),z={value:b},Qc=b.color_ramp.interpolation;"CONSTANT"!=Qc&&"LINEAR"!=Qc&&Oa.warn("Color Ramp node is not fully supported.");break;case "VALUE":m="VALUE";ub=b.name;Ob={name:"-1",value:ub};u.push(Ob);w.push(ga(b,
"Value"));break;case "VECT_MATH":switch(b.operation){case "ADD":m="VECT_MATH_ADD";break;case "SUBTRACT":m="VECT_MATH_SUBTRACT";break;case "AVERAGE":m="VECT_MATH_AVERAGE";break;case "DOT_PRODUCT":m="VECT_MATH_DOT_PRODUCT";break;case "CROSS_PRODUCT":m="VECT_MATH_CROSS_PRODUCT";break;case "NORMALIZE":m="VECT_MATH_NORMALIZE";break;default:return Oa.error("Unsupported VECT_MATH operation: "+b.operation),null}n=wa(b);w=qa(b);break;case "VECT_TRANSFORM":switch(b.vector_type){case "POINT":D.push(["VECTOR_TYPE",
Qa.glsl_value(0)]);break;case "VECTOR":D.push(["VECTOR_TYPE",Qa.glsl_value(1)]);break;case "NORMAL":D.push(["VECTOR_TYPE",Qa.glsl_value(2)]);break;default:return Oa.error("Unsupported VECT_TRANSFORM vector_type: "+b.vector_type),null}var ac=b.convert_from,Yb=b.convert_to,bc=0;if("WORLD"==ac)if("WORLD"==Yb)bc=0;else if("OBJECT"==Yb)bc=1;else if("CAMERA"==Yb)bc=2;else return Oa.error("Unsupported VECT_TRANSFORM convert_to: "+b.convert_to),null;else if("OBJECT"==ac)if("WORLD"==Yb)bc=3;else if("OBJECT"==
Yb)bc=4;else if("CAMERA"==Yb)bc=5;else return Oa.error("Unsupported VECT_TRANSFORM convert_to: "+b.convert_to),null;else if("CAMERA"==ac)if("WORLD"==Yb)bc=6;else if("OBJECT"==Yb)bc=7;else if("CAMERA"==Yb)bc=8;else return Oa.error("Unsupported VECT_TRANSFORM convert_to: "+b.convert_to),null;else return Oa.error("Unsupported VECT_TRANSFORM convert_from: "+b.convert_from),null;D.push(["CONVERT_TYPE",Qa.glsl_value(bc)]);n=wa(b);w=qa(b);break;case "NORMAL_MAP":var Pb=0;switch(b.space){case "TANGENT":Pb=
0;break;case "OBJECT":Pb=1;break;case "WORLD":Pb=2;break;case "BLENDER_OBJECT":Pb=3;break;case "BLENDER_WORLD":Pb=4;break;default:return Oa.error("Unsupported NORMAL_MAP space: "+b.space),null}D.push(["SPACE",Qa.glsl_value(Pb)]);n.push(xa(b,"Strength"));n.push(xa(b,"Color"));n.push(O("Normal","Normal",[0,0,0],!1));D.push(["USE_NORMAL_IN",0]);w.push(ga(b,"Normal"));break;case "FRESNEL":va=xa(b,"Normal");n.push(xa(b,"IOR"));n.push(va);w.push(ga(b,"Fac"));D.push(["USE_FRESNEL_NORMAL",va.is_linked|0]);
break;case "LAYER_WEIGHT":va=xa(b,"Normal");n.push(xa(b,"Blend"));n.push(va);w=qa(b);D.push(["USE_NORMAL_IN",va.is_linked|0]);break;case "BUMP":va=xa(b,"Normal");D.push(["INVERT",b.invert?1:0]);D.push(["USE_NORMAL_IN",va.is_linked|0]);n=wa(b);w=qa(b);break;case "BACKGROUND":n=wa(b);w=qa(b);break;default:n=wa(b),w=qa(b)}var Rc={name:e,origin_name:l,type:m,vparams:q,inputs:n,outputs:w,params:u,data:z,dirs:D},ic=Z.gen_node_id(a);Z.append_node(a,ic,Rc);var Lb;if(Lb="GEOMETRY"==b.type||"TEX_COORD"==b.type||
"NEW_GEOMETRY"==b.type)a:{for(var hb=b.outputs,hd=0,lb=0;lb<hb.length;lb++)if(hb[lb].is_linked&&hd++>c){Lb=!0;break a}Lb=!1}return Lb&&null==ba(a,b,++c,f,g,h)?null:ic}function Ea(a,b,c){for(var d=a.inputs,f=a.outputs,g=a.node_tree_name,h=0;h<b.length;h++){var e=d[h],l=b[h];if(!e||e.default_value instanceof Array!=l)return Oa.warn('Wrong inputs for custom node group "'+a.name+'" of type: "',g,'".Processing as general node group.'),!1}for(h=0;h<c.length;h++)if(b=f[h],d=c[h],!b||b.default_value instanceof
Array!=d)return Oa.warn('Wrong outputs for custom node group "'+a.name+'" of type: "',g,'".Processing as general node group.'),!1;return!0}function ta(a,b,c,d){var f=a.node_group.node_tree,g={},h;for(h in f)if("links"==h||"nodes"==h){g[h]=[];for(var e=0;e<f[h].length;e++){g[h][e]={};for(var k in f[h][e])if("links"==h){g[h][e][k]={};for(var m in f[h][e][k])g[h][e][k][m]=X(f[h][e][k][m])}else g[h][e][k]=X(f[h][e][k])}}else g[h]=X(f[h]);e=a.node_tree_name;if("B4W_REPLACE"==e||"B4W_LEVELS_OF_QUALITY"==
e)f=va("Group input","GROUP_INPUT",[],a.inputs),h=va("Group output","GROUP_OUTPUT",a.outputs,[]),e="B4W_REPLACE"==e||"B4W_LEVELS_OF_QUALITY"==e&&(Mb.quality==Na.P_LOW||Mb.force_low_quality_nodes)?{from_node:f,from_socket:f.outputs[1],to_node:h,to_socket:h.inputs[0]}:{from_node:f,from_socket:f.outputs[0],to_node:h,to_socket:h.inputs[0]},g.nodes=[f,h],g.links=[e];f=a.name;h=g.nodes;e=g.links;for(k=0;k<h.length;k++)h[k].name=Ba(h[k].type,f,h[k].name);for(k=0;k<e.length;k++)e[k].from_node.name=Ba(e[k].from_node.type,
f,e[k].from_node.name),e[k].to_node.name=Ba(e[k].to_node.type,f,e[k].to_node.name);return{node_group_graph:l(g,a.node_group.uuid,!0,b,c,d).graph,node_group_links:g.links}}function X(a){var b=typeof a;return"string"!=b&&"number"!=b&&"boolean"!=b&&a?r.N(a):a}function pa(a){rb[a]||(rb[a]=0);var b=a+"_"+rb[a],b=b.replace(/ /g,"_").replace(/\//g,"_");rb[a]++;return b}function ka(a){a=a.outputs;for(var b=0;b<a.length;b++)if(a[b].is_linked)return!0;return!1}function Ca(a,b){for(var c=a.outputs,d=0,f=0;f<
c.length;f++){var g=c[f];if(g.is_linked&&!(d++<b))switch(g.identifier){case "UV":return"GEOMETRY_UV";case "Vertex Color":return"GEOMETRY_VC";case "Normal":return"GEOMETRY_NO";case "True Normal":return"GEOMETRY_TRN";case "Front/Back":return"GEOMETRY_FB";case "View":return"GEOMETRY_VW";case "Global":case "Position":return"GEOMETRY_GL";case "Local":return"GEOMETRY_LO";case "Orco":return"GEOMETRY_OR";case "Incoming":return"GEOMETRY_IN";case "Backfacing":return"GEOMETRY_BF";default:return null}}}function Ma(a,
b){for(var c=a.outputs,d=0,f=0;f<c.length;f++){var g=c[f];if(g.is_linked&&!(d++<b))switch(g.identifier){case "Camera":return"TEX_COORD_CA";case "Generated":return"TEX_COORD_GE";case "Normal":return"TEX_COORD_NO";case "Object":return"TEX_COORD_OB";case "Reflection":return"TEX_COORD_RE";case "UV":return"TEX_COORD_UV";case "Window":return"TEX_COORD_WI";default:return null}}}function Aa(a){if(!a.texture||!a.texture._render)return"TEXTURE_EMPTY";for(var b=a.outputs,c=!1,d=!1,f=!1,g=0;g<b.length;g++){var h=
b[g];if(h.is_linked)switch(h.identifier){case "Color":c=!0;break;case "Normal":d=!0;break;case "Value":f=!0;break;default:Ua.panic("Unknown texture output")}}if(c)return d&&Oa.warn('Node "'+a.name+'" has both Color and Normal outputs. Normal will be omitted.'),"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT_CUBE":"TEXTURE_COLOR";if(d)return"TEXTURE_NORMAL";if(f)return"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT_CUBE":"TEXTURE_COLOR"}function xa(a,b){for(var c=a.inputs,d=0;d<c.length;d++){var f=
c[d];if(f.identifier==b)return ya(f)}return null}function ga(a,b){for(var c=a.outputs,d=0;d<c.length;d++){var f=c[d];if(f.identifier==b)return ya(f)}return null}function ya(a){var b=a.name,c=a.identifier,d=a.is_linked;a=a.default_value;a=r._16(a)?a.slice(0):a;return{name:b,identifier:c,is_linked:d,default_value:a}}function O(a,b,c,d){return{name:a,identifier:b,is_linked:d,default_value:c}}function wa(a){for(var b=[],c=0;c<a.inputs.length;c++){var d=ya(a.inputs[c]);d.default_value.length&&d.default_value.splice(3);
b.push(d)}return b}function qa(a){for(var b=[],c=0;c<a.outputs.length;c++){var d=ya(a.outputs[c]);b.push(d)}return b}function na(a,b,c){b=null===b||void 0===b?null:Qa.glsl_value(b,c);return{name:a,value:b}}function Ja(a){return{name:a.name,value:a.value}}function g(a){return a.slice()}function Da(a,b,c,d,f,g){var h=[],e=g.from_socket.identifier;g=g.to_socket.identifier;var l=d.outputs;for(d=0;d<l.length;d++)if(l[d].identifier==e){h.push(d);break}f=f.inputs;for(d=0;d<f.length;d++)if(f[d].identifier==
g){h.push(d);break}2==h.length&&Z.append_edge(a,b,c,h);return!0}function Ba(a,b,c){return"GROUP_INPUT"==a?b+"*GI*"+c:"GROUP_OUTPUT"==a?b+"*GO*"+c:b+"%join%"+c}function Ta(a){var b=[];Z.traverse(a,function(a,c){"GROUP"==c.type&&b.push(c)});return b}function ma(a,b,c){for(var d=0;d<c.length;d++){var f=c[d].data.node_group_graph,g=c[d].data.node_group_links;if(!f)return!1;Z.traverse(f,function(b,c){Z.append_node(a,Z.gen_node_id(a),c)});for(f=0;f<g.length;f++)b.push(g[f]);Wa(c[d],b,a)}return!0}function Ka(a,
b,c,d,f,g){switch(a.type){case "GROUP":a.name==b&&d.push(c);break;case "GROUP_INPUT":a.name.indexOf(b+"*GI*")||f.push(c);break;case "GROUP_OUTPUT":a.name.indexOf(b+"*GO*")||g.push(c)}}function fb(a,b,c){for(var d=[],f=0;f<c.length;f++){for(var g=c[f],h=null,e=0;e<b.length;e++)if(g.from_socket.identifier==b[e].to_socket.identifier){h=b[e];break}h?(g.from_node=h.from_node,g.from_socket=h.from_socket):d.push(g)}for(f=0;f<b.length;f++)a.splice(a.indexOf(b[f]),1);return d}function La(a,b){if(b.length)for(var c=
b[0].from_node.name,d=0;d<a.length;d++)a[d].from_node.name==c&&b.push(a[d])}function Xa(a,b,c,d){for(var f=0;f<d.length;f++){for(var g=d[f],h,e=0;e<c.inputs.length;e++)if(g.from_socket.identifier==c.inputs[e].identifier){h=c.inputs[e].default_value;break}for(var e=g,l=b,k=h,m=L(e.to_node,l),q=0;q<m.length;q++)for(var n=Z.get_node_attr(l,m[q]),p=0;p<n.inputs.length;p++){var r=n.inputs[p];if(r.identifier==e.to_socket.identifier){n=r.default_value instanceof Object?0:1;if((k instanceof Object?0:1)==
n)r.default_value=k;else switch(n){case 0:r=r.default_value;r[0]=r[1]=r[2]=k;break;case 1:r.default_value=(k[0]+k[1]+k[2])/3}break}}g=a.indexOf(g);-1!=g&&a.splice(g,1)}}function Wa(a,b,c){for(var d=a.name,f=[],g=[],h=[],e=[],l=0;l<b.length;l++){var k=b[l];Ka(k.from_node,d,k,f,h,e);Ka(k.to_node,d,k,g,h,e)}g=fb(b,g,h);f=fb(b,e,f);La(b,g);Xa(b,c,a,g);if(f.length){var m;Z.traverse(c,function(a,b){"GROUP_OUTPUT"!=b.type||b.name.indexOf(d+"*GO*")||(m=b)});Xa(b,c,m,f)}}function W(a){var b=[],c=[];Z.traverse(a,
function(a,d){switch(d.type){case "VALTORGB":b.push(d);break;case "CURVE_VEC":case "CURVE_RGB":c.push(d)}});var d=0,f=a=null,g=b.length+c.length;if(b.length){a=$a.extract_col_ramps_data(b,$a.COLORRAMP_TEXT_SIZE);for(var h=0;h<b.length;h++)b[h].dirs.push(["NODE_TEX_ROW",Qa.glsl_value((d+.5)/g)]),d++}if(c.length)for(f=$a.extract_vec_curves_data(c,$a.CURVE_NODES_TEXT_SIZE),h=0;h<c.length;h++)c[h].dirs.push(["NODE_TEX_ROW",Qa.glsl_value((d+.5)/g)]),d++;h=null;a&&f?(h=new Uint8Array(a.length+f.length),
h.set(a),h.set(f,a.length)):h=a?a:f;a=h?$a.create_color_ramp_texture(h,$a.CURVE_NODES_TEXT_SIZE):null;for(h=0;h<b.length;h++)b[h].data.texture=a;for(h=0;h<c.length;h++)c[h].data.texture=a}function Ia(a,b,c,d){a=a.curve_mapping.curves_data[b];return 2==a.length&&a[0][0]<c+.01&&a[0][1]<c+.01&&a[1][0]>d-.01&&a[1][1]>d-.01?!1:!0}var Ua=Object(R.a)(a),Na=Object(V.a)(a),Va=Object(n.a)(a),Z=Object(y.a)(a),Oa=Object(I.a)(a),Qa=Object(A.a)(a),$a=Object(u.a)(a),rb={},ob={},gb={},Ya={},sb=0,Mb=Na.defaults;e.VT_WORLD_TO_WORLD=
0;e.VT_WORLD_TO_OBJECT=1;e.VT_WORLD_TO_CAMERA=2;e.VT_OBJECT_TO_WORLD=3;e.VT_OBJECT_TO_OBJECT=4;e.VT_OBJECT_TO_CAMERA=5;e.VT_CAMERA_TO_WORLD=6;e.VT_CAMERA_TO_OBJECT=7;e.VT_CAMERA_TO_CAMERA=8;e.NM_TANGENT=0;e.NM_OBJECT=1;e.NM_WORLD=2;e.NM_BLENDER_OBJECT=3;e.NM_BLENDER_WORLD=4;e.get_ngraph_proxy_cached=function(a){return ob[a]};e.cleanup_ngraph_proxy=function(a){delete ob[a]};e.compose_ngraph_proxy=function(a,b,c,d,f,g,h,e){return l(a,b,c,g,h,e)};e.create_lighting_graph=function(a,b,c){if(a in gb)return gb[a];
var d=Z.create(),f={name:"LIGHTING_BEGIN",type:"LIGHTING_BEGIN"},g=ba(d,f,0,null,null,c),f={name:"LIGHTING_END",type:"LIGHTING_END"},f=ba(d,f,0,null,null,c);m(d,b,g,f,[[g,[8,10]],[g,[9,6]]],c);v(d);return gb[a]=d};e.generate_graph_id=function(a,b,c,d){a+=c;switch(b){case "GLOW":a+="11";case "COLOR_ID":case "SHADOW":a+="00";default:a+="10"}d&&d.vc_name&&(a+=d.vc_name);d&&d.uv_name&&(a+=d.uv_name);return a};e.compose_node_elements=function(a){var b=[],c={};rb={};var d=Z.topsort(a);Z.traverse(d,function(a,
d){var f;f=[];for(var g=[],h=[],e=[],l=[],k=[],m=0;m<d.inputs.length;m++){var q=d.inputs[m];if(q.is_linked)f.push(null),g.push(null);else{f.push(pa("in_"+d.type+"_"+q.identifier.replace(/\./g,"")));var n=Qa.glsl_value(q.default_value,0);Mb.shader_constants_hack&&(0<=d.type.indexOf("MIX_RGB_")&&("Color1"==q.identifier||"Color2"==q.identifier||"Fac"==q.identifier)||0<=d.type.indexOf("MATH_")&&("Value"==q.identifier||"Value_001"==q.identifier||"Value.001"==q.identifier)||0<=d.type.indexOf("VECT_MATH_")&&
("Vector_001"==q.identifier||"Vector.001"==q.identifier)||0<=d.type.indexOf("LIGHTING_APPLY")||0<=d.type.indexOf("MATERIAL_END")||0<=d.type.indexOf("MATERIAL_BEGIN"))&&(q=n,q=q.replace(/(,)/g,"$1 "),q=q.replace(/(^|[^0-9]|\s)(0\.0)($|[^0-9]|\s)/g,"$1_0_0$3"),q=q.replace(/(^|[^0-9]|\s)(1\.0)($|[^0-9]|\s)/g,"$1_1_0$3"),n=q=q.replace(/\s+/g,""));g.push(n)}}for(m=0;m<d.outputs.length;m++)q=d.outputs[m],q.is_linked?h.push(null):h.push(pa("out_"+d.type+"_"+q.identifier.replace(/\./g,"")));for(m=0;m<d.params.length;m++)q=
d.params[m],e.push(q.name),l.push(q.value);for(m=0;m<d.vparams.length;m++)k.push(d.vparams[m].name);f={id:d.type,inputs:f,input_values:g,outputs:h,params:e,param_values:l,vparams:k,dirs:JSON.parse(JSON.stringify(d.dirs))};b.push(f);c[a]=f});Z.traverse_edges(d,function(a,b,f){var g=Z.get_node_attr(d,a),h=g.outputs[f[0]];a=c[a].outputs;b=c[b].inputs;g=a[f[0]]||pa("out_"+g.type+"_"+h.identifier.replace(/\./g,""));a[f[0]]=g;b[f[1]]=g});return b};e.check_material_glow_output=function(a){if(a.node_tree)for(var b=
0;b<a.node_tree.nodes.length;b++){var c=a.node_tree.nodes[b];if("GROUP"==c.type&&"B4W_GLOW_OUTPUT"==c.node_tree_name)return!0}return!1};e.print_node_graph=function(a,b,c){Oa.log("\n====== USER: "+b+", MATERIAL: "+c+" ======\n"+Va.nodegraph_to_dot(a,!0)+"\n=============================================================")};e.cleanup=function(){for(var a in ob)delete ob[a];for(a in gb)delete gb[a];for(var b in Ya)delete Ya[b];sb=0};e.get_max_env_texture_height=function(a){var b=-1;Z.traverse(a,function(a,
c){if("TEXTURE_ENVIRONMENT_EQUIRECTANGULAR"==c.type||"TEXTURE_ENVIRONMENT_MIRROR_BALL"==c.type)b=Math.max(b,c.data.value.height)});return b}});t.a=e},function(C,t,e){C=e(0);var R=e(1),V=e(2);e=Object(C.a)("__debug_telemetry",function(e,y){var d=Object(R.a)(e),k=[],n={},A=["color: #3366FF","color: #CC33FF","color: #FF3366","color: #33FF66","color: #FFCC33"];y.fbmsg=function(){for(var d=[performance.now()],e=0;e<arguments.length;e++){var n=arguments[e];if(V._16(n))for(var a=0;a<n.length;a++)d.push(n[a]);
else d.push(arguments[e])}k.push(d)};y.msg=function(){for(var d=1,e=0;e<k.length;e++){var n=k[e];n[1]==arguments[0]&&d++}n=[d];for(e=0;e<arguments.length;e++)if(d=arguments[e],V._16(d))for(var a=0;a<d.length;a++)n.push(d[a]);else n.push(arguments[e]);k.push(n)};y.print_telemetry=function(e){e||(e=1);for(var n=0,r={},a=Math.max(0,performance.now()-1E3*e),y=0;y<k.length;y++){var l=k[y];e=l[0];if(!(e<a)){var c=String(l[1]);r[c]||(r[c]=A[n++%A.length]);var m=r[c];e=["%c"+(e/1E3).toFixed(6),m,c];for(c=
2;c<l.length;c++)e.push(l[c]);d.log.apply(this,e)}}k.splice(0)};y.plot_telemetry=function(e){e||(e=1);for(var n={},r=Math.max(0,performance.now()-1E3*e),a=0;a<k.length;a++){var y=k[a];e=y[0];if(!(e<r))for(var l=2;l<y.length;l++){var c=String(y[1]);3<y.length&&(c+="_"+String(l-2));n[c]||(n[c]=c+"\n");n[c]+=String(e)+" "+y[l]+"\n"}}e="";for(c in n)e+=n[c]+"\n\n";d.log(e);k.splice(0)};y.exec_count=function(d){n[d]=d in n?n[d]+1:1};y.update=function(){for(var e in n)d.log(e,n[e]),n[e]=0}});t.a=e},function(C,
t,e){C=e(0);var R=e(5),V=e(4),n=e(20),y=e(36),d=e(2);e=Object(C.a)("__primitives",function(e,t){function k(a,b,c,d){for(var f=[],e=[],k=[],m=a*b,n=2*c/(a-1),p=2*d/(b-1),r=0;r<a;r++)for(var u=-c+r*n,A=0;A<b;A++)if(e.push(u,-d+A*p,0),k.push(r/(a-1),A/(b-1)),r&&A){var t=r*b+A,v=t-1,B=(r-1)*b+A,T=B-1;f.push(t,v,B);f.push(v,T,B)}a=l.create_empty_va_frame();a.a_position=new Float32Array(e);a.a_tbn=y.c(m);m=l.init_submesh("GRID_PLANE");m.va_frames[0]=a;m.va_common.a_texcoord=new Float32Array(k);m.indices=
new Uint32Array(f);m.base_length=e.length/3;return m}function r(c){var b=c.length;b%4&&a.panic("Wrong array");for(var d=[],e=[],k=0;k<b;k+=4){var m=c[k+1],n=c[k+2],p=c[k+3];u(c[k],e);u(m,e);u(n,e);u(p,e);d.push(k,k+1,k+2);d.push(k,k+2,k+3)}c=l.create_empty_va_frame();c.a_position=new Float32Array(e);c.a_tbn=y.c(b/4);b=l.init_submesh("FROM_QUADS");b.va_frames[0]=c;b.indices=new Uint32Array(d);b.base_length=e.length/3;return b}function p(a,b){var c=3*b;return[a[c],a[c+1],a[c+2]]}function u(a,b){b.push(a[0],
a[1],a[2])}var a=Object(R.a)(e),B=Object(V.a)(e),l=Object(n.a)(e),c=B.defaults;t.generate_line=function(){var a=l.init_submesh("LINE"),b=l.create_empty_va_frame();b.a_position=new Float32Array(3);b.a_direction=new Float32Array(3);a.va_frames[0]=b;a.indices=new Uint32Array(1);a.base_length=1;return a};t.generate_plane=function(a,b){var c=k(2,2,a,b);c.name="PLANE";return c};t.generate_grid=k;t.generate_cascaded_grid=function(a,b,d){function f(a,b){return 1==a%2&&(0==b||b==n-1)||1==b%2&&(0==a||a==m-
1)?!0:!1}var e=d/=Math.pow(2,a-1),k=d,m=b+1,n=b+1;b=[];d=[];for(var p=0,r=0,u=0,A=-1,t=[],B=0;B<a;B++){for(var v=2*e/(m-1),I=2*k/(n-1),C=[],S=[],L=0,q=0;q<m;q++){for(var w=-e+q*v,ea=[],H=0;H<n;H++){var D=-k+H*I;if(w>-r&&w<r&&D>-u&&D<u)ea.push(-1),L++;else{for(var h=null,ia=0;ia<t.length;ia+=3)if(w==t[ia]&&D==t[ia+1]){h=t[ia+2];break}ia=null!==h?h:A+1;f(q,H)?(ea.push(-2),L++):(null==h&&(0==H||H==n-1||0==q||q==m-1?(h=B==a-1?v:2*v,C.push(w,D,ia)):h=v,d.push(w,D,h),p++,A++),ea.push(ia));if(q&&H)if(1==
q)if(f(q-1,H)){if(1<H){var D=ia-1,h=S[q-1][H+1],ra=h-1;b.push(ra,D,ia)}else h=S[q-1][H+1],ra=h-1;b.push(h,ra,ia)}else f(q,H)||(D=ia-1,h=S[q-1][H],b.push(h,D,ia));else if(q==m-1){if(!f(q,H))if(H==n-1)D=ia-1,h=S[q-1][H-1],ra=S[q-2][H],b.push(h,D,ia),b.push(ra,h,ia);else{var D=ia-1,h=S[q-1][H],ra=h-1,R=h+1;b.push(ra,D,ia);b.push(h,ra,ia);b.push(R,h,ia);2==H&&(R=S[q-2][H-2],b.push(ra,R,D))}}else 1==H?f(q,H-1)?(D=S[q-1][H],h=S[q-1][H-1],b.push(D,h,ia)):(D=ea[H-1],h=S[q-1][H],ra=S[q-2][H-1],b.push(h,D,
ia),b.push(h,ra,D)):H==n-1?f(q,H)||(D=ea[H-1],h=S[q-1][H-1],ra=S[q-2][H],b.push(h,D,ia),b.push(ra,h,ia)):-1!=S[q-1][H]&&-1!=S[q-1][H-1]&&-1!=ea[H-1]?(D=ea[H-1],h=S[q-1][H],ra=S[q-1][H-1],b.push(h,D,ia),b.push(h,ra,D),H==n-2&&f(q,H+1)&&(R=S[q-1][H+1],b.push(R,h,ia))):H==n-2&&f(q,H+1)&&(h=S[q-1][H],R=S[q-1][H+1],b.push(R,h,ia))}}S.push(ea)}t=C;r=e;u=k;e*=2;k*=2}2E4>r&&(a=-(2*r)/(m-1),d.push(-2E4,-2E4,a),d.push(-2E4,2E4,a),d.push(-r,-u,a),d.push(-r,u,a),d.push(2E4,-2E4,a),d.push(2E4,2E4,a),d.push(r,
-u,a),d.push(r,u,a),ia=A+1,b.push(ia+1,ia+2,ia+3,ia+1,ia+0,ia+2,ia+2,ia+4,ia+6,ia+2,ia+0,ia+4,ia+1,ia+7,ia+5,ia+1,ia+3,ia+7,ia+7,ia+4,ia+5,ia+6,ia+4,ia+7),p+=8);a=l.create_empty_va_frame();a.a_position=new Float32Array(d);a.a_tbn=y.c(p);y.j(a.a_tbn,[.707,0,0,.707],a.a_tbn);e=l.init_submesh("MULTIGRID_PLANE");e.va_frames[0]=a;e.indices=new Uint32Array(b);e.base_length=d.length/3;c.water_wireframe_debug&&(l.submesh_drop_indices(e,1,!0),a.a_polyindex=l.extract_polyindices(e));return e};t.generate_from_triangles=
function(c){var b=c.length;b%3&&a.panic("Wrong array");for(var d=[],e=[],k=0;k<b;k+=3){var m=c[k+1],n=c[k+2];u(c[k],e);u(m,e);u(n,e);d.push(k,k+1,k+2)}c=l.create_empty_va_frame();c.a_position=new Float32Array(e);b=l.init_submesh("FROM_TRIANGLES");b.va_frames[0]=c;b.indices=new Uint32Array(d);b.base_length=e.length/3;return b};t.generate_from_quads=r;t.generate_frustum=function(a){a=d._69(a,[]);var b=[];b.push(a[0],a[1],a[2],a[3]);b.push(a[0],a[3],a[5],a[4]);b.push(a[3],a[2],a[6],a[5]);b.push(a[1],
a[7],a[6],a[2]);b.push(a[0],a[4],a[7],a[1]);b.push(a[4],a[5],a[6],a[7]);a=r(b);a.name="FRUSTUM";return a};t.generate_fullscreen_tri=function(){var a=l.init_submesh("FULLSCREEN_TRI"),b=l.create_empty_va_frame();b.a_position=new Float32Array([0,0,1,0,0,1]);a.va_frames[0]=b;a.indices=new Uint32Array([0,1,2]);a.base_length=3;return a};t.generate_fullscreen_quad=function(){var a=l.init_submesh("FULLSCREEN_QUAD"),b=l.create_empty_va_frame();b.a_position=new Float32Array([-1,1,1,1,-1,-1,1,-1]);a.va_frames[0]=
b;a.indices=new Uint32Array([0,2,1,1,2,3]);a.base_length=4;return a};t.generate_billboard=function(){var a=l.init_submesh("BILLBOARD"),b=l.create_empty_va_frame();b.a_bb_vertex=l.gen_bb_vertices(1);a.va_frames[0]=b;a.indices=new Uint32Array([0,2,1,0,3,2]);a.base_length=4;return a};t.generate_uv_sphere=function(a,b,c,d,e,k){var f=l.init_submesh("UV_SPHERE"),m,n,r=[],z=[],A=[];for(n=0;n<=b;n++)for(m=0;m<=a;m++){var t=m/a,B=n/b,v=-c*Math.cos(2*t*Math.PI)*Math.sin(B*Math.PI),T=c*Math.cos(B*Math.PI),t=
c*Math.sin(2*t*Math.PI)*Math.sin(B*Math.PI);e&&(v=1E-5>Math.abs(v)?0:v,T=1E-5>Math.abs(T)?0:T,t=1E-5>Math.abs(t)?0:t);z.push(v+d[0],T+d[1],t+d[2])}for(n=e=0;n<b;n++)for(m=0;m<a;m++)v=p(z,(a+1)*n+m+1),T=p(z,(a+1)*n+m),t=p(z,(a+1)*(n+1)+m),B=p(z,(a+1)*(n+1)+m+1),Math.abs(v[1])==c+d[1]?(u(v,r),u(t,r),u(B,r),k?A.push(e,e+1,e+1,e+2,e+2,e):A.push(e,e+1,e+2),e+=3):Math.abs(t[1])==c+d[1]?(u(v,r),u(T,r),u(t,r),k?A.push(e,e+1,e+1,e+2,e+2,e):A.push(e,e+1,e+2),e+=3):(u(v,r),u(T,r),u(t,r),u(B,r),k?(A.push(e,e+
1),A.push(e+1,e+2),A.push(e+2,e+3),A.push(e+3,e)):(A.push(e,e+1,e+2),A.push(e,e+2,e+3)),e+=4);a={};a.a_position=r;k?a.a_tbn=y.c():(k=l.calc_shared_indices(A,z,r),k=l.calc_normals(A,r,k),a.a_tbn=y.d(k));f.va_frames[0]=a;f.indices=A;f.base_length=r.length/3;return f};t.generate_index=function(a){var b=l.init_submesh("INDEX"),c=l.create_empty_va_frame();c.a_index=new Float32Array(3*a);for(var d=new Uint16Array(3*a),e=0;e<3*a;e++)c.a_index[e]=e,d[e]=e;b.va_frames[0]=c;b.indices=d;b.base_length=3*a;return b}});
t.a=e},function(C,t,e){C=e(0);var R=e(5),V=e(14),n=e(4),y=e(45),d=e(46),k=e(30),I=e(31),A=e(22),r=e(11),p=e(17),u=e(2);e=Object(C.a)("__scenegraph",function(a,e){function l(a,b){var c=[];P.traverse_edges(a,function(b,d,f){-1<c.indexOf(f)?P.replace_edge_attr(a,b,d,f,Y(f)):c.push(f)});P.traverse(a,function(a,d){for(var f=0;f<d.slinks_internal.length;f++){var h=d.slinks_internal[f];b||d.type!=Q.MAIN_PLANE_REFLECT&&d.type!=Q.MAIN_CUBE_REFLECT&&d.type!=Q.MAIN_XRAY||(h.use_renderbuffer=!0);-1<c.indexOf(h)?
d.slinks_internal[f]=Y(h):c.push(h)}})}function c(a,b){P.traverse(a,function(c,d){d.type==Q.ANTIALIASING&&P.traverse_inputs(a,c,function(a,b,c){if(b.type==Q.MOTION_BLUR)for(a=0;a<b.slinks_internal.length;a++)c=b.slinks_internal[a],c.min_filter=da.TF_LINEAR,c.mag_filter=da.TF_LINEAR});b||P.traverse_inputs(a,c,function(a,b,c){"DEPTH"==c.from&&(c.use_renderbuffer=!0)})});P.traverse(a,function(b,c){var d={};m(a,b,d);for(var f in d){for(var h=d[f],e=h[0],l=0;l<h.length;l++)if(h[l].min_filter==da.TF_LINEAR){e=
h[l];break}for(var k=h[0],l=0;l<h.length;l++)if(h[l].mag_filter==da.TF_LINEAR){k=h[l];break}for(var q=h[0],l=0;l<h.length;l++)if(!h[l].use_renderbuffer){q=h[l];break}for(l=0;l<h.length;l++)h[l].min_filter=e.min_filter,h[l].mag_filter=k.mag_filter,h[l].use_renderbuffer=q.use_renderbuffer}})}function m(a,b,c){P.traverse_inputs(a,b,function(b,d,f){f.active&&f.from==f.to&&(c[f.from]=c[f.from]||[],-1==c[f.from].indexOf(f)&&c[f.from].push(f),m(a,b,c))});P.traverse_outputs(a,b,function(a,b,d){d.active&&
(c[d.from]=c[d.from]||[],-1==c[d.from].indexOf(d)&&c[d.from].push(d))});b=P.get_node_attr(a,b);if(b.type==Q.MOTION_BLUR)for(var d=0;d<b.slinks_internal.length;d++){var f=b.slinks_internal[d];c[f.from].push(f)}}function b(a){var b=[Q.MOTION_BLUR,Q.SMAA_RESOLVE,Q.SMAA_NEIGHBORHOOD_BLENDING,Q.MAIN_PLANE_REFLECT,Q.MAIN_CUBE_REFLECT,Q.PERFORMANCE];va.webgl2||b.push(Q.AVERAGE_LUMINANCE);var c=P.topsort(a),d=[];P.traverse(c,function(a,h){for(var e=0;e<h.slinks_internal.length;e++){var l=h.slinks_internal[e];
-1<b.indexOf(h.type)&&(l.unique_texture=!0);var k=G(d,l,f(l));l.texture=k;h.textures_internal[e]=k}for(e=0;e<h.textures_internal.length;e++)k=h.textures_internal[e],z(d,k);P.traverse_outputs(c,a,function(e,l,k){if(!k.texture){if(-1<b.indexOf(h.type))k.unique_texture=!0;else if((e=t(c,a,k.from))&&k.active&&!k.texture){B(d,e);k.texture=e;return}e=G(d,k,f(k));k.texture=e}});P.traverse_inputs(c,a,function(a,b,c){z(d,c.texture)});P.traverse_outputs(c,a,function(a,b,c){c.texture&&"NONE"==c.to&&z(d,c.texture)})})}
function f(a){var b=a.to,c=a.active,d=a.texture;a.to="";a.active=!1;a.texture=null;var f=za.calc_variable_id(a,0);a.to=b;a.active=c;a.texture=d;return f}function t(a,b,c){var d=null;P.traverse_inputs(a,b,function(a,b,f){if(f.active&&f.from==f.to&&f.from==c&&f.texture)return d=f.texture,!0});P.traverse_outputs(a,b,function(a,b,f){if(f.active&&f.from==c&&f.texture)return d=f.texture,!0});return d}function B(a,b){for(var c=0;c<a.length;c++){var d=a[c];d.tex===b&&d.ref++}}function z(a,b){for(var c=0;c<
a.length;c++){var d=a[c];d.tex===b&&d.ref&&d.ref--}}function G(a,b,c){if(b.parent_slink)return B(a,b.parent_slink.texture),b.parent_slink.texture;if(b.unique_texture)return E(b);for(var d=null,f=0;f<a.length;f++){var h=a[f];if(h.id==c&&0===h.ref){d=h;break}}if(d&&!va.firefox_tex_reuse_hack)return d.ref++,d.tex;b=E(b);a.push({id:c,ref:1,tex:b});return b}function E(a){var b=a.size_mult_x*a.size,c=a.size_mult_y*a.size,d=a.use_comparison,f=a.use_mipmap;switch(a.from){case "COLOR":return a.use_renderbuffer?
(d=da.create_texture(a.multisample?da.TT_RB_RGBA_MS:da.TT_RB_RGBA,d,f),da.resize(d,b,c)):(d=a.floating_point?da.create_texture(da.TT_RGBA_FLOAT,d,f):da.create_texture(da.TT_RGBA_INT,d,f),da.resize(d,b,c),da.set_filters(d,a.min_filter,a.mag_filter)),d;case "DEPTH":return a.use_renderbuffer?(d=da.create_texture(a.multisample?da.TT_RB_DEPTH_MS:da.TT_RB_DEPTH,d,f),da.resize(d,b,c)):(d=da.create_texture(da.TT_DEPTH,d,f),da.resize(d,b,c),da.set_filters(d,a.min_filter,a.mag_filter)),d;case "CUBEMAP":return d=
da.create_cubemap_texture(b,f);case "SCREEN":case "NONE":return null;default:H.panic("Wrong slink param: "+a.from)}}function J(a,b){var c=!1;P.traverse_edges(a,function(d,f,h){if(h&&(d=P.get_node_attr(a,d),f=P.get_node_attr(a,f),b(h,!1,d,f)))return c=!0});c||P.traverse(a,function(a,c){for(var d=0;d<c.slinks_internal.length;d++)if(b(c.slinks_internal[d],!0,c,null))return!0})}function M(a){P.traverse(a,function(b,c){if(c.type!=Q.SINK){var d=c.camera;P.traverse_outputs(a,b,function(a,b,c){c.texture&&
c.active&&c.texture&&(D.set_attachment(d,c.from,c.texture),c.from==c.to&&b.camera&&D.set_attachment(b.camera,c.from,c.texture))});for(var f=0;f<c.slinks_internal.length;f++){var h=c.slinks_internal[f];h.active&&h.from==h.to&&D.set_attachment(d,h.from,c.textures_internal[f])}!d.color_attachment&&!d.depth_attachment||d.framebuffer||(d.framebuffer=oa.render_target_create(d.color_attachment,d.depth_attachment))}});P.traverse(a,function(b,c){if(c.type==Q.RESOLVE||c.type==Q.COPY){var d=L(a,c);c.camera.framebuffer_prev=
d[0].camera.framebuffer}})}function F(a){var b=null,c=0;P.traverse(a,function(a,d){if(d.type==ja.subs_type){if(c==ja.subs_number)return b=d,!0;c++}});return b}function U(a,b){var c=P.node_by_attr(a,b),d=Q.create_subs_postprocessing("NONE"),f=P.append_node_attr(a,d),h=P.get_sink_nodes(a)[0];P.traverse_edges(a,function(b,c,d){c==h&&P.reconnect_edges(a,b,h,b,f)});var e=K(b,a);P.traverse_edges(a,function(f,h,l){if(f==c){if(e){f=Q.create_subs_resolve();P.append_node_attr(a,f);h=v("COLOR","RESOLVE",1,1,
1,!0,!0);h.multisample=!0;h.use_renderbuffer=!0;var k=v("DEPTH","RESOLVE",1,1,1,!0,!0);k.multisample=!0;k.use_renderbuffer=!0;P.append_edge_attr(a,b,f,h);P.append_edge_attr(a,b,f,k);b=f}P.append_edge_attr(a,b,d,v(ja.slink_type,"u_color",l.size,l.size_mult_x,l.size_mult_y,l.update_dim,l.apply_resolution_factors));return!0}});P.append_edge(a,f,h,v("SCREEN","NONE",.5,.5,.5,!0,!0))}function K(a,b){var c=!1,d=P.node_by_attr(b,a);P.out_edge_count(b,d)&&(c=P.get_out_edge(b,d,0),d=P.get_edge_attr(b,d,c,0),
"COLOR"==d.from&&"COLOR"==d.to||"DEPTH"==d.from&&"DEPTH"==d.to?(d=P.get_node_attr(b,c),c=K(d,b)):c="RESOLVE"==d.to);return c}function C(a,b,c,d){var f=c.cameras,h=b.hmd_stereo_use,e=b.anaglyph_use,l=b.reflection_params.plane_refl_subs,k=b.reflection_params.plane_refl_subs_blend;b=P.get_node_id(a,d);b=P.subgraph_node_conn(a,b,P.BACKWARD_DIR);var m=[],q=[],n=[];b=P.clone(b,function(b){var d;if(-1<ba.indexOf(b.type))q.push(b),d=b;else{d=Q.clone_subs(b);if(d.type==Q.MAIN_PLANE_REFLECT)for(var g=0;g<l.length;g++)if(l[g][0]==
b){l[g]=[b,d];d.camera.reflection_plane=b.camera.reflection_plane;c.cameras.push(d.camera);break}if(b.type==Q.MAIN_PLANE_REFLECT_BLEND)for(g=0;g<l.length;g++){if(k[g][0]==b){k[g]=[b,d];d.camera=l[g][1].camera;break}}else-1<f.indexOf(b.camera)&&(h?(D.make_stereo(b.camera,D.TYPE_HMD_LEFT),D.make_stereo(d.camera,D.TYPE_HMD_RIGHT),d.force_do_not_render=!0):(D.make_stereo(b.camera,D.TYPE_STEREO_LEFT),D.make_stereo(d.camera,D.TYPE_STEREO_RIGHT)),f.push(d.camera));var e=P.node_by_attr(a,b);P.traverse_inputs(a,
e,function(a,b,c){-1<ba.indexOf(b.type)&&m.push([b,d,c])});if(b.type!==Q.MOTION_BLUR)for(g=0;g<b.slinks_internal.length;g++)d.slinks_internal[g].parent_slink=b.slinks_internal[g];b=!0;for(g=0;g<P.in_edge_count(a,e);g++){var p=P.get_in_edge(a,e,g),p=P.get_node_attr(a,p);-1==ba.indexOf(p.type)&&(b=!1)}b&&n.push(d)}return d},function(a){var b=Y(a,!0);b.parent_slink=a;return b});for(var p=0;p<q.length;p++)P.remove_node(b,P.node_by_attr(b,q[p]));P.cleanup_loose_edges(b);e=Q.create_subs_stereo(h,e);p=P.append_node_attr(a,
e);if(va.ios_copy_tex_hack)var r=Q.create_subs_postprocessing("NONE"),w=v("COLOR","u_color",1,1,1,!0,!0);else r=Q.create_subs_copy(),w=v("COLOR","COPY",1,1,1,!0,!0);w.min_filter=da.TF_LINEAR;w.mag_filter=da.TF_LINEAR;P.append_node_attr(a,r);P.append_edge_attr(a,d,r,w);var u=v("COLOR","u_sampler_left",1,1,1,!0,!0);u.unique_texture=!0;u.min_filter=da.TF_LINEAR;u.mag_filter=da.TF_LINEAR;P.append_edge_attr(a,r,e,u);if(!d.is_pp){if(va.ios_copy_tex_hack)var u=Q.create_subs_postprocessing("NONE"),g=v("COLOR",
"u_color",1,1,1,!0,!0);else u=Q.create_subs_copy(),g=v("COLOR","COPY",1,1,1,!0,!0);P.append_node_attr(b,u);g.parent_slink=w;var z=P.get_sink_nodes(b)[0],z=P.get_node_attr(b,z);P.append_edge_attr(b,z,u,g)}u=v("COLOR","u_sampler_right",1,1,1,!0,!0);d.is_pp&&(u.parent_slink=w);u.min_filter=da.TF_LINEAR;u.mag_filter=da.TF_LINEAR;P.append_subgraph(b,a,[P.get_sink_nodes(b)[0],p,u]);for(p=0;p<m.length;p++)P.append_edge_attr(a,m[p][0],m[p][1],m[p][2]);d=v("SCREEN","NONE",0,0,0,!1,!1);for(p=0;p<n.length;p++)P.append_edge_attr(a,
r,n[p],d);P.traverse_edges(a,function(b,c,d){P.get_node_attr(a,b).type===Q.MOTION_BLUR&&(d.parent_slink=null)});return e}function v(a,b,c,d,f,h,e){return{from:a,to:b,size:c,size_mult_x:d,size_mult_y:f,update_dim:h,apply_resolution_factors:e,active:!0,texture:null,multisample:!1,floating_point:!1,use_renderbuffer:!1,min_filter:da.TF_NEAREST,mag_filter:da.TF_NEAREST,unique_texture:!1,use_comparison:!1,use_mipmap:!1}}function Y(a,b){var c=v(a.from,a.to,a.size,a.size_mult_x,a.size_mult_y,a.update_dim,
a.apply_resolution_factors);c.active=a.active;!b&&a.texture&&H.panic("Failed to clone slink with attached texture");c.texture=a.texture;c.multisample=a.multisample;c.use_renderbuffer=a.use_renderbuffer;c.min_filter=a.min_filter;c.mag_filter=a.mag_filter;c.unique_texture=a.unique_texture;c.use_comparison=a.use_comparison;c.use_mipmap=a.use_mipmap;return c}function ha(a,b,c){if(b.type==c)return!0;b=q(a,b);for(var d=0;d<b.length;d++)if(ha(a,b[d],c))return!0;return!1}function S(a,b,c){if(b.type==c)return!0;
b=L(a,b);for(var d=0;d<b.length;d++)if(S(a,b[d],c))return!0;return!1}function L(a,b){var c=P.node_by_attr(a,b);c==P.NULL_NODE&&H.panic("Subscene not in graph");for(var d=[],f=P.in_edge_count(a,c),h=0;h<f;h++){var e=P.get_in_edge(a,c,h);e!=c&&d.push(P.get_node_attr(a,e))}return d}function q(a,b){var c=P.node_by_attr(a,b);c==P.NULL_NODE&&H.panic("Subscene not in graph");for(var d=[],f=P.out_edge_count(a,c),h=0;h<f;h++){var e=P.get_out_edge(a,c,h);e!=c&&d.push(P.get_node_attr(a,e))}return d}function w(a){var b=
[],c=[];J(a,function(a,d,f,h){a.texture&&-1==b.indexOf(a.texture)&&(b.push(a.texture),c.push(a.texture,b.length-1))});return c}function ea(a,b,c,d){b=""+(a.from+"\\n");b+="NONE"!=a.to?a.to+"\\n":"";b+="(";if(a.update_dim){c=a.size_mult_x;var f=a.size_mult_y;Math.round(c)!=c&&(c=c.toFixed(2));Math.round(f)!=f&&(f=f.toFixed(2));b=b+((1==c?"":c)+"Sx"+((1==f?"":f)+"S"))+(a.apply_resolution_factors?" FACT":" VIEW")}else c=a.size_mult_x,f=a.size_mult_y,b+=a.size*c+"x"+a.size*f;if("SCREEN"!=a.from){b+=" ";
if(a.use_renderbuffer)b+="RR";else{c=a.min_filter;var f=a.mag_filter,h="";c==da.TF_LINEAR?h+="L":c==da.TF_NEAREST&&(h+="N");f==da.TF_LINEAR?h+="L":f==da.TF_NEAREST&&(h+="N");b+=h}for(c=0;c<d.length;c+=2)d[c]==a.texture&&(b+=" "+d[c+1])}return b+")\\n"}var H=Object(R.a)(a),D=Object(V.a)(a),h=Object(n.a)(a),ia=Object(y.a)(a),ra=Object(d.a)(a),za=Object(k.a)(a),P=Object(I.a)(a),oa=Object(A.a)(a),Q=Object(r.a)(a),da=Object(p.a)(a),ja=h.debug_subs,va=h.defaults,Ga=h.scenes,ba=[Q.GRASS_MAP,Q.SHADOW_CAST,
Q.MAIN_CUBE_REFLECT,Q.MAIN_CUBE_REFLECT_BLEND];e.check_slink_tex_conn=function(a){switch(a.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":case "NONE":return!1;default:return!0}};e.traverse_slinks=J;e.create_rendering_graph=function(a,d,f,h){var e=P.create(),k=[],m=[],n=[],p=[],r=[],w=[],z=[],E=[],y=[],A=a.lamps_number,t=a.water_params,g=a.shore_smoothing,B=a.soft_particles,J=a.ssao,G=a.god_rays,H=a.reflection_params,K=a.materials_params,T=a.bloom_params,
I=a.motion_blur,ea=a.compositing,S=a.antialiasing,fa=a.world_light_set,R=a.world_fog_set,X=a.shadow_params,za=a.mb_params,V=a.cc_params,ba=a.god_rays_params,ha=a.outline_params,ta=a.dof,oa=a.depth_tex,sa=a.refractions,pa=!!h.length,Ea=1<va.msaa_samples;va.reuse_depth_optimization=va.reuse_depth_optimization&&!!X&&!(Ea&&J);var Ya=va.reuse_depth_optimization,sb=v("COLOR","COLOR",1,1,1,!0,!0),Mb=v("DEPTH","DEPTH",1,1,1,!0,!0);if(Ea){var Fb=Y(Mb);sb.multisample=!0;sb.use_renderbuffer=!0;Mb.multisample=
!0;Mb.use_renderbuffer=!0}var mb=d.cameras[0];if(a.dynamic_grass){var Sa=Q.create_subs_grass_map();P.append_node_attr(e,Sa);var ib=Ga.grass_tex_size;Sa.camera.width=ib;Sa.camera.height=ib;var yb=v("DEPTH","u_grass_map_depth",ib,1,1,!1,!1);va.webgl2||(yb.min_filter=da.TF_LINEAR,yb.mag_filter=da.TF_LINEAR);var ua=v("COLOR","u_grass_map_color",ib,1,1,!1,!1);ua.min_filter=da.TF_LINEAR;ua.mag_filter=da.TF_LINEAR}else ua=yb=Sa=null;if(X){D.update_camera_shadows(mb,X);for(var Ra=0;Ra<X.lamp_types.length;Ra++)for(var N=
X.csm_num,la=0;la<N;la++){var Db=Q.create_subs_shadow_cast(la,Ra,X,A);P.append_node_attr(e,Db);n.push(Db);var ib=X.csm_resolution,Pa=Db.camera;d.shadow_cameras.push(Pa);Pa.width=ib;Pa.height=ib;Db.clear_color=!0;var zc=0<Ra?Ra:la;if(va.rgba_fallback_shadows){var gc=v("COLOR","u_shadow_map"+zc,ib,1,1,!1,!1);p.push(gc);var Ac=v("DEPTH","DEPTH",ib,1,1,!1,!1);Ac.use_renderbuffer=!0;Db.slinks_internal.push(Ac)}else{var Vb=v("DEPTH","u_shadow_map"+zc,ib,1,1,!1,!1);va.compared_mode_depth&&(Vb.min_filter=
da.TF_LINEAR,Vb.mag_filter=da.TF_LINEAR,Vb.use_comparison=!0);p.push(Vb);(ia.depth_only_issue()||va.shadows_color_slink_hack)&&Db.slinks_internal.push(v("COLOR","COLOR",ib,1,1,!1,!1))}Sa&&(P.append_edge_attr(e,Sa,Db,yb),P.append_edge_attr(e,Sa,Db,ua))}}if(H&&H.num_cube_refl&&!pa)for(la=0;la<H.num_cube_refl;la++){Pa=D.create_camera(D.TYPE_PERSP);Pa.width=a.cubemap_refl_size;Pa.height=a.cubemap_refl_size;D.set_frustum(Pa,Math.PI/2,.1,100);D.set_projection(Pa,!1);var wb=Q.create_subs_main(Q.MAIN_CUBE_REFLECT,
Pa,!1,t,A,R,fa,null,a.sun_exist);wb.cube_view_matrices=u._6();for(Ra=0;6>Ra;Ra++)wb.cube_cam_frustums.push(D.create_frustum_planes());P.append_node_attr(e,wb);var qb=v("CUBEMAP","u_cube_reflection",a.cubemap_refl_size,1,1,!1,!1);qb.min_filter=da.TF_LINEAR;qb.mag_filter=da.TF_LINEAR;E.push(qb);if(!H.has_reflexible){var Za=v("CUBEMAP","u_sky_reflection",1,1,1,!1);Za.use_mipmap=!0;Za.min_filter=da.TF_LINEAR_MIPMAP_LINEAR;Za.mag_filter=da.TF_LINEAR;y.push(Za)}Sa&&(P.append_edge_attr(e,Sa,wb,yb),P.append_edge_attr(e,
Sa,wb,ua));if(H.has_blend_reflexible){var Eb=Q.create_subs_main(Q.MAIN_CUBE_REFLECT_BLEND,Pa,!1,t,A,R,fa,null,a.sun_exist);Eb.cube_view_matrices=wb.cube_view_matrices;Eb.cube_cam_frustums=wb.cube_cam_frustums;P.append_node_attr(e,Eb);var Bb=v("DEPTH","DEPTH",a.cubemap_refl_size,1,1,!1,!1),Wb=v("COLOR","COLOR",a.cubemap_refl_size,1,1,!1,!1);P.append_edge_attr(e,wb,Eb,Bb);P.append_edge_attr(e,wb,Eb,Wb);z.push(Eb);H.cube_refl_subs_blend.push(Eb);Sa&&(P.append_edge_attr(e,Sa,Eb,yb),P.append_edge_attr(e,
Sa,Eb,ua))}else{var Ha=v("DEPTH","DEPTH",a.cubemap_refl_size,1,1,!1,!1);wb.slinks_internal.push(Ha);z.push(wb)}H.cube_refl_subs.push(wb)}if(H&&0<H.refl_plane_objs.length&&!pa)for(Ra=0;Ra<H.refl_plane_objs.length;Ra++)Pa=D.clone_camera(mb,!0),Pa.reflection_plane=new Float32Array(4),d.cameras.push(Pa),wb=Q.create_subs_main(Q.MAIN_PLANE_REFLECT,Pa,!1,t,A,R,fa,null,a.sun_exist),P.append_node_attr(e,wb),qb=v("COLOR","u_plane_reflection",1,a.plane_refl_size,a.plane_refl_size,!0,!0),qb.min_filter=da.TF_LINEAR,
qb.mag_filter=da.TF_LINEAR,w.push(qb),Sa&&(P.append_edge_attr(e,Sa,wb,yb),P.append_edge_attr(e,Sa,wb,ua)),H.has_blend_reflexible?(Eb=Q.create_subs_main(Q.MAIN_PLANE_REFLECT_BLEND,Pa,!1,t,A,R,fa,null,a.sun_exist),P.append_node_attr(e,Eb),Bb=v("DEPTH","DEPTH",1,a.plane_refl_size,a.plane_refl_size,!0,!0),Wb=v("COLOR","COLOR",1,a.plane_refl_size,a.plane_refl_size,!0,!0),Wb.min_filter=da.TF_NEAREST,Wb.mag_filter=da.TF_NEAREST,P.append_edge_attr(e,wb,Eb,Bb),P.append_edge_attr(e,wb,Eb,Wb),H.plane_refl_subs_blend.push([Eb]),
r.push(Eb),Sa&&(P.append_edge_attr(e,Sa,Eb,yb),P.append_edge_attr(e,Sa,Eb,ua))):(Ha=v("DEPTH","DEPTH",1,a.plane_refl_size,a.plane_refl_size,!0,!0),wb.slinks_internal.push(Ha),r.push(wb)),H.plane_refl_subs.push([wb]);if(X){var pb=D.clone_camera(mb,!0);d.cameras.push(pb);var Fa=Q.create_subs_shadow_receive(e,pb,A);P.append_node_attr(e,Fa);Fa.self_shadow_normal_offset=X.self_shadow_normal_offset;for(la=0;la<n.length;la++)Db=n[la],P.append_edge_attr(e,Db,Fa,p[la]);if(Ya){if(Vb=v("DEPTH","DEPTH",1,1,1,
!0,!0),Ea){Vb.multisample=!0;Vb.use_renderbuffer=!0;var aa=Q.create_subs_resolve();P.append_node_attr(e,aa);var bb=v("COLOR","RESOLVE",1,1,1,!0,!0);bb.multisample=!0;bb.use_renderbuffer=!0;var Wc=v("DEPTH","RESOLVE",1,1,1,!0,!0);Wc.multisample=!0;Wc.use_renderbuffer=!0;P.append_edge_attr(e,Fa,aa,bb);P.append_edge_attr(e,Fa,aa,Wc)}}else Ea?Vb=v("DEPTH","DEPTH",1,1,1,!0,!0):va.rgba_fallback_shadows?(Vb=v("DEPTH","DEPTH",1,1,1,!0,!0),Vb.use_renderbuffer=!0):Vb=Mb;if(J){var db=v("COLOR","u_color",1,1,
1,!0,!0),jb=v("DEPTH","u_depth",1,1,1,!0,!0),Ub=D.clone_camera(mb,!0);d.cameras.push(Ub);var dc=a.ssao_params,nc=Q.create_subs_ssao(Ub,R,dc);P.append_node_attr(e,nc);var eb=v("COLOR","u_ssao_mask",1,1,1,!0,!0);P.append_edge_attr(e,Fa,nc,db);P.append_edge_attr(e,Fa,nc,jb);var fc=D.clone_camera(mb,!0);d.cameras.push(fc);var Bc=Q.create_subs_ssao_blur(fc,dc);P.append_node_attr(e,Bc);var Xc=v("COLOR","u_shadow_mask",1,1,1,!0,!0);P.append_edge_attr(e,nc,Bc,eb);P.append_edge_attr(e,Fa,Bc,jb)}Sa&&(P.append_edge_attr(e,
Sa,Fa,yb),P.append_edge_attr(e,Sa,Fa,ua))}else Fa=null;var cb=Q.create_subs_main(Q.MAIN_OPAQUE,mb,!Ya,t,A,R,fa,null,a.sun_exist);P.append_node_attr(e,cb);X&&(Ya?P.append_edge_attr(e,Fa,cb,Vb):Fa.slinks_internal.push(Vb));if(Ea){var tb=Q.create_subs_resolve();P.append_node_attr(e,tb);m.push(tb);var nb=v("COLOR","RESOLVE",1,1,1,!0,!0);nb.multisample=!0;nb.use_renderbuffer=!0;var xb=v("DEPTH","RESOLVE",1,1,1,!0,!0);xb.multisample=!0;xb.use_renderbuffer=!0;P.append_edge_attr(e,cb,tb,nb);P.append_edge_attr(e,
cb,tb,xb)}else m.push(cb);if(Fa)if(eb)P.append_edge_attr(e,Bc,cb,Xc);else{var vc=v("COLOR","u_shadow_mask",1,1,1,!0,!0);P.append_edge_attr(e,Ya&&Ea?aa:Fa,cb,vc)}Sa&&(P.append_edge_attr(e,Sa,cb,yb),P.append_edge_attr(e,Sa,cb,ua));if(r.length)for(var mc=r.length,Ra=0;Ra<mc;Ra++)P.append_edge_attr(e,r[Ra],cb,w[Ra]);if(z.length)for(Ra=0;Ra<z.length;Ra++)P.append_edge_attr(e,z[Ra],cb,E[Ra]);k=m;m=[];if(!pa&&a.color_picking){var kc=ja.enabled&&(ja.subs_type===Q.COLOR_PICKING||ja.subs_type===Q.COLOR_PICKING_XRAY),
Pa=D.clone_camera(mb,!0);kc||(Pa.width=Pa.height=1);d.cameras.push(Pa);var zb=Q.create_subs_color_picking(Pa,!1,A);P.append_node_attr(e,zb);if(a.xray){Pa=D.clone_camera(mb,!0);kc||(Pa.width=Pa.height=1);d.cameras.push(Pa);var Sb=Q.create_subs_color_picking(Pa,!0,A);P.append_node_attr(e,Sb);var Vc=v("COLOR","COLOR",1,1,1,kc,!0);P.append_edge_attr(e,zb,Sb,Vc);var gd=v("DEPTH","DEPTH",1,1,1,kc,!0);P.append_edge_attr(e,zb,Sb,gd)}}else zb=null;if(!K.refractions&&!sa||pa)lc=null;else{if(Ea)lc=tb;else{if(va.ios_copy_tex_hack)var lc=
Q.create_subs_postprocessing("NONE"),Kc=v("COLOR","u_color",1,1,1,!0,!0);else lc=Q.create_subs_copy(),Kc=v("COLOR","COPY",1,1,1,!0,!0);P.append_node_attr(e,lc);P.append_edge_attr(e,k[0],lc,Kc)}var Cb=v("COLOR","u_refractmap",1,1,1,!0,!0);Cb.use_mipmap=!0;Cb.min_filter=da.TF_LINEAR_MIPMAP_LINEAR;Cb.mag_filter=da.TF_LINEAR}if(oa&&(sa||g||B)){var Tb=D.clone_camera(mb,!0);d.cameras.push(Tb);var Zb=Q.create_subs_depth_pack(Tb);P.append_node_attr(e,Zb);var qc=v("DEPTH","u_depth",1,1,1,!0,!0);P.append_edge_attr(e,
Ea?tb:cb,Zb,qc);var Ib=v("COLOR","u_scene_depth",1,1,1,!0,!0);Ib.min_filter=da.TF_NEAREST;Ib.mag_filter=da.TF_NEAREST}else Zb=null;var Ec=function(b){var c=D.clone_camera(mb,!0);d.cameras.push(c);c=Q.create_subs_main(b,c,!1,t,A,R,fa,X,a.sun_exist);P.append_node_attr(e,c);b==Q.MAIN_XRAY?(b=v("COLOR","COLOR",1,1,1,!0,!0),P.append_edge_attr(e,k[0],c,b),b=v("DEPTH","DEPTH",1,1,1,!0,!0),c.slinks_internal.push(b)):(b=Ea&&k[0].type==Q.RESOLVE?cb:k[0],P.append_edge_attr(e,cb,c,Mb),P.append_edge_attr(e,b,
c,sb));Sa&&(P.append_edge_attr(e,Sa,c,yb),P.append_edge_attr(e,Sa,c,ua));for(b=0;b<n.length;b++)P.append_edge_attr(e,n[b],c,p[b]);Zb&&P.append_edge_attr(e,Zb,c,Ib);if(r.length){var f=r.length;for(b=0;b<f;b++)P.append_edge_attr(e,r[b],c,w[b])}if(z.length)for(b=0;b<z.length;b++)P.append_edge_attr(e,z[b],c,E[b]);lc&&P.append_edge_attr(e,lc,c,Cb);return c};if(a.glow_over_blend){var Nb=Ec(Q.MAIN_BLEND);m.push(Nb);k=m;m=[]}if(a.glow_materials){var bd=D.clone_camera(mb,!0);d.cameras.push(bd);var vb=Q.create_subs_main(Q.MAIN_GLOW,
bd,!1,t,A,R,fa);P.append_node_attr(e,vb);Zb&&P.append_edge_attr(e,Zb,vb,Ib);lc&&P.append_edge_attr(e,lc,vb,Cb);Sa&&(P.append_edge_attr(e,Sa,vb,yb),P.append_edge_attr(e,Sa,vb,ua));if(r.length)for(mc=r.length,Ra=0;Ra<mc;Ra++)P.append_edge_attr(e,r[Ra],vb,w[Ra]);if(z.length)for(Ra=0;Ra<z.length;Ra++)P.append_edge_attr(e,z[Ra],vb,E[Ra]);a.glow_over_blend&&P.append_edge_attr(e,vb,Nb,v("SCREEN","NONE",0,0,0,!1,!1));P.append_edge_attr(e,Ea?tb:cb,vb,Ea?Fb:Mb);var Rb=Q.create_subs_postprocessing("X_GLOW_BLUR");
Rb.subtype="GLOW_MASK_SMALL";Rb.texel_size_multiplier=a.glow_params.small_glow_mask_width;var rc=v("COLOR","u_color",1,1,1,!0,!0);rc.min_filter=da.TF_LINEAR;rc.mag_filter=da.TF_LINEAR;P.append_node_attr(e,Rb);P.append_edge_attr(e,vb,Rb,rc);var jc=Q.create_subs_postprocessing("Y_GLOW_BLUR");jc.subtype="GLOW_MASK_SMALL";jc.texel_size_multiplier=a.glow_params.small_glow_mask_width;var sc=v("COLOR","u_color",1,.5,.5,!0,!0);sc.min_filter=da.TF_LINEAR;sc.mag_filter=da.TF_LINEAR;P.append_node_attr(e,jc);
P.append_edge_attr(e,Rb,jc,sc);var cd=Q.create_subs_postprocessing("X_GLOW_BLUR");cd.subtype="GLOW_MASK_LARGE";cd.texel_size_multiplier=a.glow_params.large_glow_mask_width;var fd=v("COLOR","u_color",1,.5,.5,!0,!0);fd.min_filter=da.TF_LINEAR;fd.mag_filter=da.TF_LINEAR;P.append_node_attr(e,cd);P.append_edge_attr(e,jc,cd,fd);var Dc=Q.create_subs_postprocessing("Y_GLOW_BLUR");Dc.subtype="GLOW_MASK_LARGE";Dc.texel_size_multiplier=a.glow_params.large_glow_mask_width;var ge=v("COLOR","u_color",1,.25,.25,
!0,!0);ge.min_filter=da.TF_LINEAR;ge.mag_filter=da.TF_LINEAR;P.append_node_attr(e,Dc);P.append_edge_attr(e,cd,Dc,ge);var te=D.clone_camera(mb,!0);d.cameras.push(te);var qd=Q.create_subs_glow_combine(te,a);P.append_node_attr(e,qd);var Hd=v("COLOR","u_src_color",1,1,1,!0,!0);Hd.min_filter=da.TF_LINEAR;Hd.mag_filter=da.TF_LINEAR;if(a.glow_over_blend)if(Ea){var Wd=Q.create_subs_resolve();P.append_node_attr(e,Wd);P.append_edge_attr(e,Nb,Wd,nb);P.append_edge_attr(e,Nb,Wd,xb);P.append_edge_attr(e,Wd,qd,
Hd)}else P.append_edge_attr(e,Nb,qd,Hd);else P.append_edge_attr(e,Ea?tb:cb,qd,Hd);var rd=v("COLOR","u_glow_mask_small",1,.5,.5,!0,!0);rd.min_filter=da.TF_LINEAR;rd.mag_filter=da.TF_LINEAR;P.append_edge_attr(e,jc,qd,rd);var he=v("COLOR","u_glow_mask_large",1,.25,.25,!0,!0);he.min_filter=da.TF_LINEAR;he.mag_filter=da.TF_LINEAR;P.append_edge_attr(e,Dc,qd,he);k=[qd];m=[]}a.glow_over_blend||(Nb=Ec(Q.MAIN_BLEND),m.push(Nb),k=m,m=[]);if(va.debug_view){Pa=D.clone_camera(mb,!0);d.cameras.push(Pa);var sd=Q.create_subs_debug_view(Pa);
m.push(sd);P.append_node_attr(e,sd);P.append_edge_attr(e,k[0],sd,sb);P.append_edge_attr(e,k[0],sd,Mb);Sa&&(P.append_edge_attr(e,Sa,sd,yb),P.append_edge_attr(e,Sa,sd,ua));ra.set_debug_view_subs(sd);k=m;m=[]}if(Ea){var Xd=Q.create_subs_resolve();P.append_node_attr(e,Xd);m.push(Xd);P.append_edge_attr(e,k[0],Xd,nb);P.append_edge_attr(e,k[0],Xd,xb);k=m;m=[]}var ue=k.slice(0);if(!pa&&a.anchor_visibility){Pa=D.clone_camera(mb,!0);d.cameras.push(Pa);var ab=Q.create_subs_anchor_visibility(Pa);P.append_node_attr(e,
ab);P.append_edge_attr(e,k[0],ab,Ea?Fb:Mb)}if(G&&oa&&!pa){var Lc=ba.max_ray_length,Dd=ba.intensity,tc=ba.steps_per_pass,Jb=k[0],Gb=t?!0:!1,Id=v("DEPTH","u_input",1,1,1,!0,!0),Ed=v("COLOR","u_input",1,.25,.25,!0,!0);Ed.min_filter=da.TF_LINEAR;Ed.mag_filter=da.TF_LINEAR;var dd=Lc/tc,Yd=D.clone_camera(mb,!0);d.cameras.push(Yd);var Fd=Q.create_subs_god_rays(Yd,Gb,Lc,!0,dd,A,tc);P.append_node_attr(e,Fd);P.append_edge_attr(e,Jb,Fd,Id);var dd=Lc/tc*.5,Jd=D.clone_camera(mb,!0);d.cameras.push(Jd);var Yc=Q.create_subs_god_rays(Jd,
Gb,Lc,!1,dd,A,tc);P.append_node_attr(e,Yc);P.append_edge_attr(e,Fd,Yc,Ed);var dd=Lc/tc*.25,td=D.clone_camera(mb,!0);d.cameras.push(td);var Pc=Q.create_subs_god_rays(td,Gb,Lc,!1,dd,A,tc);P.append_node_attr(e,Pc);P.append_edge_attr(e,Yc,Pc,Ed);var ub=Q.create_subs_god_rays_comb(Dd,A);m.push(ub);P.append_node_attr(e,ub);var Ob=v("COLOR","u_main",1,1,1,!0,!0);Ob.min_filter=da.TF_LINEAR;Ob.mag_filter=da.TF_LINEAR;P.append_edge_attr(e,Jb,ub,Ob);var Zc=v("COLOR","u_god_rays",1,1,1,!0,!0);Zc.min_filter=da.TF_LINEAR;
Zc.mag_filter=da.TF_LINEAR;P.append_edge_attr(e,Pc,ub,Zc);k=m;m=[]}if(T&&!pa){var Jb=k[0],kb=Q.create_subs_luminance();P.append_node_attr(e,kb);Ob=v("COLOR","u_input",1,1,1,!0,!0);Ob.min_filter=da.TF_LINEAR;Ob.mag_filter=da.TF_LINEAR;P.append_edge_attr(e,Jb,kb,Ob);var Xb=T.key,hc=T.edge_lum,Fc=D.clone_camera(mb,!0);d.cameras.push(Fc);var Kb=Q.create_subs_luminance_truncated(Xb,hc,A,Fc);P.append_node_attr(e,Kb);var $b=v("COLOR","u_luminance",1,.25,.25,!0,!0);$b.min_filter=da.TF_LINEAR;$b.mag_filter=
da.TF_LINEAR;if(T.adaptive){var wc=Q.create_subs_av_luminance();P.append_node_attr(e,wc);wc.camera.width=1;wc.camera.height=1;var Qc=v("COLOR","u_input",1,.25,.25,!0,!0);Qc.use_mipmap=!0;Qc.min_filter=da.TF_LINEAR_MIPMAP_LINEAR;Qc.mag_filter=da.TF_LINEAR;if(va.webgl2)$b.use_mipmap=!0,$b.min_filter=da.TF_LINEAR_MIPMAP_LINEAR,P.append_edge_attr(e,kb,wc,Qc);else{var ac=Q.create_resize_subs(),Yb=v("COLOR","u_color",1,.25,.25,!0,!0);P.append_node_attr(e,ac);P.append_edge_attr(e,kb,ac,Yb);P.append_edge_attr(e,
ac,wc,Qc)}P.append_edge_attr(e,wc,Kb,v("COLOR","u_average_lum",1,1,1,!1,!1));Kb.adaptive_bloom=!0}else Kb.adaptive_bloom=!1,Kb.average_luminance=T.average_luminance;P.append_edge_attr(e,Jb,Kb,v("COLOR","u_main",1,1,1,!0,!0));P.append_edge_attr(e,kb,Kb,$b);for(var bc=Kb,Pb=1,Rc=[],la=0;5>la;la++)Rb=Q.create_subs_postprocessing("X_BLOOM_BLUR"),Rb.texel_size_multiplier=a.glow_params.small_glow_mask_width,rc=v("COLOR","u_color",1,Pb,Pb,!0,!0),rc.min_filter=da.TF_LINEAR,rc.mag_filter=da.TF_LINEAR,P.append_node_attr(e,
Rb),P.append_edge_attr(e,bc,Rb,rc),Pb/=2,jc=Q.create_subs_postprocessing("Y_BLOOM_BLUR"),jc.texel_size_multiplier=a.glow_params.small_glow_mask_width,sc=v("COLOR","u_color",1,Pb,Pb,!0,!0),sc.min_filter=da.TF_LINEAR,sc.mag_filter=da.TF_LINEAR,P.append_node_attr(e,jc),P.append_edge_attr(e,Rb,jc,sc),bc=jc,jc.bloom_blur_scale=Pb,Rb.bloom_blur_scale=Pb,Rc.push(jc,Pb);var ic=Q.create_subs_bloom_combine(T.blur,5);P.append_node_attr(e,ic);for(la=0;la<Rc.length;la+=2){var jc=Rc[la],Lb=Rc[la+1],rd=v("COLOR",
"u_bloom_level_"+(la/2).toString(),1,Lb,Lb,!0,!0);rd.min_filter=da.TF_LINEAR;rd.mag_filter=da.TF_LINEAR;P.append_edge_attr(e,jc,ic,rd)}P.append_edge_attr(e,Jb,ic,v("COLOR","u_main",1,1,1,!0,!0));m.push(ic);k=m;m=[]}if(ta&&oa&&!pa){var Jb=k[0],hb=D.clone_camera(mb,!0);d.cameras.push(hb);var hd=va.tex_float_available&&va.cbuffer_float_available,lb=f.dof_bokeh&&hd;if(lb){var Cc=da.TF_NEAREST,oc=v("COLOR","u_color",1,1,1,!0,!0);oc.min_filter=Cc;oc.mag_filter=Cc;var Kd=v("DEPTH","u_depth",1,1,1,!0,!0),
Ab=v("COLOR","u_color",1,.5,.5,!0,!0);Ab.floating_point=!0;Ab.min_filter=da.TF_NEAREST;Ab.mag_filter=da.TF_NEAREST;var ud=v("COLOR","u_color",1,.5,.5,!0,!0);ud.floating_point=!0;ud.min_filter=da.TF_NEAREST;ud.mag_filter=da.TF_NEAREST;var Ld=v("COLOR","u_blurred1",1,.5,.5,!0,!0);Ld.floating_point=!0;Ld.min_filter=Cc;Ld.mag_filter=Cc;var vd=v("COLOR","u_blurred2",1,.5,.5,!0,!0);vd.floating_point=!0;vd.min_filter=Cc;vd.mag_filter=Cc;var Gd=ue[0];if(f.dof_foreground_blur){var pc=D.clone_camera(mb,!0);
d.cameras.push(pc);var $c=Q.create_subs_coc(pc,"COC_FOREGROUND");pc.dof_distance=f.dof_distance;pc.dof_object=f.dof_object;pc.dof_front_start=f.dof_front_start;pc.dof_front_end=f.dof_front_end;pc.dof_rear_start=f.dof_rear_start;pc.dof_rear_end=f.dof_rear_end;pc.dof_power=f.dof_power;pc.dof_bokeh=f.dof_bokeh;pc.dof_bokeh_intensity=f.dof_bokeh_intensity;pc.dof_foreground_blur=f.dof_foreground_blur;pc.dof_on=!0;P.append_node_attr(e,$c);P.append_edge_attr(e,Jb,$c,oc);P.append_edge_attr(e,Gd,$c,Kd);var wd=
Q.create_subs_postprocessing("X_ALPHA_BLUR");P.append_node_attr(e,wd);P.append_edge_attr(e,$c,wd,Ab);var xd=Q.create_subs_postprocessing("Y_ALPHA_BLUR");P.append_node_attr(e,xd);P.append_edge_attr(e,wd,xd,ud);var Hb=D.clone_camera(mb,!0),Mc=Q.create_subs_coc(Hb,"COC_COMBINE");d.cameras.push(Hb);Hb.dof_distance=f.dof_distance;Hb.dof_object=f.dof_object;Hb.dof_front_start=f.dof_front_start;Hb.dof_front_end=f.dof_front_end;Hb.dof_rear_start=f.dof_rear_start;Hb.dof_rear_end=f.dof_rear_end;Hb.dof_power=
f.dof_power;Hb.dof_bokeh=f.dof_bokeh;Hb.dof_bokeh_intensity=f.dof_bokeh_intensity;Hb.dof_foreground_blur=f.dof_foreground_blur;Hb.dof_on=!0;P.append_node_attr(e,Mc);P.append_edge_attr(e,Jb,Mc,oc);P.append_edge_attr(e,Gd,Mc,Kd);P.append_edge_attr(e,xd,Mc,v("COLOR","u_coc_fg",1,.5,.5,!0,!0))}else Hb=D.clone_camera(mb,!0),d.cameras.push(Hb),Mc=Q.create_subs_coc(Hb,"COC_ALL"),Hb.dof_distance=f.dof_distance,Hb.dof_object=f.dof_object,Hb.dof_front_start=f.dof_front_start,Hb.dof_front_end=f.dof_front_end,
Hb.dof_rear_start=f.dof_rear_start,Hb.dof_rear_end=f.dof_rear_end,Hb.dof_power=f.dof_power,Hb.dof_bokeh=f.dof_bokeh,Hb.dof_bokeh_intensity=f.dof_bokeh_intensity,Hb.dof_foreground_blur=f.dof_foreground_blur,Hb.dof_on=!0,P.append_node_attr(e,Mc),P.append_edge_attr(e,Jb,Mc,oc),P.append_edge_attr(e,Gd,Mc,Kd);var ec=Q.create_subs_postprocessing("X_DOF_BLUR");ec.camera.dof_bokeh_intensity=f.dof_bokeh_intensity;P.append_node_attr(e,ec);P.append_edge_attr(e,Mc,ec,Ab);var ed=Q.create_subs_postprocessing("Y_DOF_BLUR");
ed.camera.dof_bokeh_intensity=f.dof_bokeh_intensity;P.append_node_attr(e,ed);P.append_edge_attr(e,ec,ed,ud);var yd=Q.create_subs_postprocessing("Y_DOF_BLUR");yd.camera.dof_bokeh_intensity=f.dof_bokeh_intensity;P.append_node_attr(e,yd);P.append_edge_attr(e,ec,yd,ud);var Qb=Q.create_subs_dof(hb,lb);hb.dof_distance=f.dof_distance;hb.dof_object=f.dof_object;hb.dof_front_start=f.dof_front_start;hb.dof_front_end=f.dof_front_end;hb.dof_rear_start=f.dof_rear_start;hb.dof_rear_end=f.dof_rear_end;hb.dof_power=
f.dof_power;hb.dof_bokeh=f.dof_bokeh;hb.dof_bokeh_intensity=f.dof_bokeh_intensity;hb.dof_foreground_blur=f.dof_foreground_blur;hb.dof_on=!0;m.push(Qb);P.append_node_attr(e,Qb);P.append_edge_attr(e,Jb,Qb,v("COLOR","u_sharp",1,1,1,!0,!0));P.append_edge_attr(e,ed,Qb,Ld);P.append_edge_attr(e,yd,Qb,vd)}else{var zd=v("COLOR","u_color",1,1,1,!0,!0);zd.min_filter=da.TF_LINEAR;zd.mag_filter=da.TF_LINEAR;var id=v("COLOR","u_color",1,1,1,!0,!0);id.min_filter=da.TF_LINEAR;id.mag_filter=da.TF_LINEAR;ec=Q.create_subs_postprocessing("X_BLUR");
P.append_node_attr(e,ec);P.append_edge_attr(e,Jb,ec,zd);var ad=Q.create_subs_postprocessing("Y_BLUR");P.append_node_attr(e,ad);P.append_edge_attr(e,ec,ad,id);var Nc=ue[0],Qb=Q.create_subs_dof(hb,lb);hb.dof_distance=f.dof_distance;hb.dof_object=f.dof_object;hb.dof_front_start=f.dof_front_start;hb.dof_front_end=f.dof_front_end;hb.dof_rear_start=f.dof_rear_start;hb.dof_rear_end=f.dof_rear_end;hb.dof_power=f.dof_power;hb.dof_bokeh=f.dof_bokeh;hb.dof_bokeh_intensity=f.dof_bokeh_intensity;hb.dof_foreground_blur=
f.dof_foreground_blur;hb.dof_on=!0;m.push(Qb);P.append_node_attr(e,Qb);P.append_edge_attr(e,Jb,Qb,v("COLOR","u_sharp",1,1,1,!0,!0));P.append_edge_attr(e,ad,Qb,v("COLOR","u_blurred",1,1,1,!0,!0));P.append_edge_attr(e,Nc,Qb,v("DEPTH","u_depth",1,1,1,!0,!0))}k=m;m=[]}if(a.xray){var xc=Ec(Q.MAIN_XRAY);m.push(xc);k=m;m=[]}if(I&&!pa){var Md=k[0],Sc=Q.create_subs_motion_blur(za.mb_decay_threshold,za.mb_factor);m.push(Sc);P.append_node_attr(e,Sc);var Gc=v("COLOR","u_mb_tex_curr",1,1,1,!0,!0);P.append_edge_attr(e,
Md,Sc,Gc);var ie=v("COLOR","u_mb_tex_accum",1,1,1,!0,!0);Sc.slinks_internal.push(ie);k=m;m=[]}if(!pa&&a.outline){var Jb=k[0],je=D.clone_camera(mb,!0);d.cameras.push(je);var Nd=Q.create_subs_outline_mask(je,A);P.append_node_attr(e,Nd);var jd=Q.create_subs_postprocessing("X_EXTEND"),Od=v("COLOR","u_color",1,1,1,!0,!0),kd=v("COLOR","u_outline_mask",1,1,1,!0,!0);kd.min_filter=da.TF_LINEAR;kd.mag_filter=da.TF_LINEAR;jd.is_for_outline=!0;P.append_node_attr(e,jd);P.append_edge_attr(e,Nd,jd,Od);var Ad=v("COLOR",
"u_color",1,.5,.5,!0,!0);Ad.min_filter=da.TF_LINEAR;Ad.mag_filter=da.TF_LINEAR;var Tc=Q.create_subs_postprocessing("Y_EXTEND");Tc.is_for_outline=!0;P.append_node_attr(e,Tc);P.append_edge_attr(e,jd,Tc,Ad);ec=Q.create_subs_postprocessing("X_BLUR");ec.is_for_outline=!0;P.append_node_attr(e,ec);P.append_edge_attr(e,Tc,ec,Ad);var md=v("COLOR","u_color",1,.25,.25,!0,!0);md.min_filter=da.TF_LINEAR;md.mag_filter=da.TF_LINEAR;var Hc=v("COLOR","u_outline_mask_blurred",1,.25,.25,!0,!0);Hc.min_filter=da.TF_LINEAR;
Hc.mag_filter=da.TF_LINEAR;ad=Q.create_subs_postprocessing("Y_BLUR");ad.is_for_outline=!0;P.append_node_attr(e,ad);P.append_edge_attr(e,ec,ad,md);var ld=Q.create_subs_outline(ha);P.append_node_attr(e,ld);var Pd=v("COLOR","u_outline_src",1,1,1,!0,!0);Pd.min_filter=da.TF_LINEAR;Pd.mag_filter=da.TF_LINEAR;P.append_edge_attr(e,Jb,ld,Pd);P.append_edge_attr(e,Nd,ld,kd);P.append_edge_attr(e,ad,ld,Hc);m.push(ld);k=m;m=[]}l(e,oa);if((a.anaglyph_use||a.hmd_stereo_use||a.sidebyside_use)&&!pa){var Ge=C(e,a,d,
k[0]);m.push(Ge);k=m;m=[]}if(ea&&!pa){var Jb=k[0],ve=Q.create_subs_compositing(V.brightness,V.contrast,V.exposure,V.saturation),ke=v("COLOR","u_color",1,1,1,!0,!0);ke.min_filter=da.TF_LINEAR;ke.mag_filter=da.TF_LINEAR;(a.anaglyph_use||a.hmd_stereo_use||a.sidebyside_use)&&!pa&&(ke.unique_texture=!0);P.append_node_attr(e,ve);P.append_edge_attr(e,Jb,ve,ke);m.push(ve);k=m;m=[]}if(!k[0].is_pp||k[0].type==Q.MOTION_BLUR||k[0].type==Q.RESOLVE){var we=Q.create_subs_postprocessing("NONE");P.append_node_attr(e,
we);var le=v("COLOR","u_color",1,1,1,!0,!0);le.min_filter=da.TF_LINEAR;le.mag_filter=da.TF_LINEAR;P.append_edge_attr(e,k[0],we,le);m.push(we);k=m;m=[]}if(S){Jb=k[0];if(va.smaa){var Zd=v("COLOR","u_color",1,1,1,!0,!1);Zd.min_filter=da.TF_LINEAR;Zd.mag_filter=da.TF_LINEAR;var me=Q.create_subs_smaa(Q.SMAA_EDGE_DETECTION,a);P.append_node_attr(e,me);P.append_edge_attr(e,Jb,me,Zd);var $d=Q.create_subs_smaa(Q.SMAA_BLENDING_WEIGHT_CALCULATION,a);P.append_node_attr(e,$d);P.append_edge_attr(e,me,$d,Zd);var ne=
v("COLOR","u_search_tex",1,1,1,!1,!1),xe=v("COLOR","u_area_tex",1,1,1,!1,!1);ne.min_filter=da.TF_LINEAR;ne.mag_filter=da.TF_LINEAR;xe.min_filter=da.TF_LINEAR;xe.mag_filter=da.TF_LINEAR;$d.slinks_internal.push(ne);$d.slinks_internal.push(xe);var ae=Q.create_subs_smaa(Q.SMAA_NEIGHBORHOOD_BLENDING,a);P.append_node_attr(e,ae);P.append_edge_attr(e,Jb,ae,Zd);var ye=v("COLOR","u_blend",1,1,1,!0,!1);ye.min_filter=da.TF_LINEAR;ye.mag_filter=da.TF_LINEAR;P.append_edge_attr(e,$d,ae,ye);m.push(ae)}else{var oe=
Q.create_subs_aa(a);P.append_node_attr(e,oe);var pe=v("COLOR","u_color",1,1,1,!0,!1);pe.min_filter=da.TF_LINEAR;pe.mag_filter=da.TF_LINEAR;(a.anaglyph_use||a.hmd_stereo_use||a.sidebyside_use)&&!pa&&(pe.unique_texture=!0);P.append_edge_attr(e,Jb,oe,pe);m.push(oe)}k=m;m=[]}m.push(k[0]);zb&&(Sb?m.push(Sb):m.push(zb));ab&&m.push(ab);ib=1;if(a.sky_params.render_sky){var He=a.sky_params,Ie=a.world_light_set,ze=Ie.sky_texture_param,ib=ze?ze.tex_size:ib,Uc=Q.create_subs_sky(Ie,A,He,ib);P.append_node_attr(e,
Uc);m.push(Uc);y.length&&(P.append_edge_attr(e,Uc,cb,y[0]),Nb&&P.append_edge_attr(e,Uc,Nb,y[0]),vb&&P.append_edge_attr(e,Uc,vb,y[0]),xc&&P.append_edge_attr(e,Uc,xc,y[0]));if(H.has_pbr_reflexible)if(va.webgl2&&!va.is_mobile_device){var nd=Q.create_subs_irradiance(A,ib);P.append_node_attr(e,nd);var Oc=v("CUBEMAP","u_sky_reflection",ib,1,1,!1);Oc.use_mipmap=!0;Oc.min_filter=da.TF_LINEAR_MIPMAP_LINEAR;Oc.mag_filter=da.TF_LINEAR;P.append_edge_attr(e,Uc,nd,Oc);var Bd=v("CUBEMAP","u_irradiance",32,1,1,!1);
Bd.use_mipmap=!1;Bd.min_filter=da.TF_LINEAR;Bd.mag_filter=da.TF_LINEAR;P.append_edge_attr(e,nd,cb,Bd);Nb&&P.append_edge_attr(e,nd,Nb,Bd);vb&&P.append_edge_attr(e,nd,vb,Bd);xc&&P.append_edge_attr(e,nd,xc,Bd);m.push(nd);var Qd=Q.create_subs_rougness_convolution(A);P.append_node_attr(e,Qd);P.append_edge_attr(e,Uc,Qd,Oc);var Cd=v("CUBEMAP","u_cube_r_convolution",128,1,1,!1);Cd.use_mipmap=!1;Cd.min_filter=da.TF_LINEAR_MIPMAP_LINEAR;Cd.mag_filter=da.TF_LINEAR;P.append_edge_attr(e,Qd,cb,Cd);Nb&&P.append_edge_attr(e,
Qd,Nb,Cd);vb&&P.append_edge_attr(e,Qd,vb,Cd);xc&&P.append_edge_attr(e,Qd,xc,Cd);var be=Q.create_subs_brdf();P.append_node_attr(e,be);var Rd=v("COLOR","u_brdf",512,1,1,!1);Rd.min_filter=da.TF_LINEAR;Rd.mag_filter=da.TF_LINEAR;P.append_edge_attr(e,be,cb,Rd);Nb&&P.append_edge_attr(e,be,Nb,Rd);vb&&P.append_edge_attr(e,be,vb,Rd);xc&&P.append_edge_attr(e,be,xc,Rd)}else Oc=v("CUBEMAP","u_sky_reflection",ib,1,1,!1),Oc.use_mipmap=!0,Oc.min_filter=da.TF_LINEAR_MIPMAP_LINEAR,Oc.mag_filter=da.TF_LINEAR,P.append_edge_attr(e,
Uc,cb,Oc),Nb&&P.append_edge_attr(e,Uc,Nb,Oc),vb&&P.append_edge_attr(e,Uc,vb,Oc),xc&&P.append_edge_attr(e,Uc,xc,Oc)}var od=Q.create_subs_sink();P.append_node_attr(e,od);for(la=0;la<m.length;la++){var Sd=m[la];Sd.blend=!0;switch(Sd.type){case Q.COLOR_PICKING:case Q.COLOR_PICKING_XRAY:P.append_edge_attr(e,Sd,od,v("COLOR","NONE",1,1,1,kc,!1));P.append_edge_attr(e,Sd,od,v("DEPTH","NONE",1,1,1,kc,!1));break;case Q.SKY:var Oe=v("CUBEMAP","u_sky",ib,1,1,!1);P.append_edge_attr(e,Sd,od,Oe);break;case Q.IRRADIANCE:var qe=
v("CUBEMAP","u_irradiance",ib,1,1,!1);qe.use_mipmap=!0;qe.min_filter=da.TF_NEAREST;qe.mag_filter=da.TF_NEAREST;P.append_edge_attr(e,nd,od,qe);break;case Q.ANCHOR_VISIBILITY:var Pe=v("COLOR","NONE",1,1,1,!0,!1);P.append_edge_attr(e,Sd,od,Pe);break;default:if(pa){var Je=h[0],ce=v("COLOR","OFFSCREEN",1,1,1,!0,!0);ce.texture=Je;P.append_edge_attr(e,m[la],od,ce);for(Ra=1;Ra<h.length;Ra++){var Ke=h[Ra],Ae=Q.create_subs_postprocessing("NONE");P.append_node_attr(e,Ae);var Qe=v("COLOR","SCALE",1,1,1,!0,!0);
P.append_edge_attr(e,m[la],Ae,Qe);var Le=Ke.source_size/Je.source_size,ce=v("COLOR","OFFSCREEN",1,Le,Le,!0,!0);ce.texture=Ke;P.append_edge_attr(e,Ae,od,ce)}}else P.append_edge_attr(e,m[la],od,v("SCREEN","NONE",1,1,1,!0,!1))}}tb&&!q(e,tb).length&&(P.remove_node(e,P.node_by_attr(e,tb)),P.cleanup_loose_edges(e));l(e,oa);c(e,oa);if(ja.enabled){var Me=F(e);Me&&U(e,Me)}b(e);M(e);X&&P.traverse(e,function(a,b){if(b.type==Q.SHADOW_RECEIVE||b.type==Q.MAIN_BLEND||b.type==Q.MAIN_XRAY){for(var c=0,d=L(e,b),f=
0,g=0;g<d.length;g++){var h=d[g];h.type==Q.SHADOW_CAST&&(f++,b.p_light_matrix=b.p_light_matrix||[],b.p_light_matrix[0<h.shadow_lamp_index?h.shadow_lamp_index:c]=h.camera.proj_matrix,c++)}b.v_light_ts&&b.v_light_r||(va.mac_os_shadow_hack?b.v_light_tsr=new Float32Array(9*f):(b.v_light_ts=new Float32Array(4*f),b.v_light_r=new Float32Array(4*f)))}});if(!H.has_reflexible)for(la=0;la<E.length;la++)E[la].active=!1;return e};e.multiply_size_mult_by_graph=function(a,b,c){var d=[];P.traverse(a,function(b,c){if(-1==
ba.indexOf(c.type)&&c.slinks_internal.length&&ha(a,c,Q.STEREO))for(var f=0;f<c.slinks_internal.length;f++){var h=c.slinks_internal[f];-1==d.indexOf(h)&&d.push(h)}});P.traverse_edges(a,function(b,c,f){b=P.get_node_attr(a,b);c=P.get_node_attr(a,c);-1==ba.indexOf(b.type)&&ha(a,c,Q.STEREO)&&-1==d.indexOf(f)&&d.push(f)});for(var f=0;f<d.length;f++)d[f].size_mult_x*=b,d[f].size_mult_y*=c};e.set_texel_size=function(a,b,c){var d=a.texel_size_multiplier;a.texel_size[0]=b*a.texel_mask[0]*d;a.texel_size[1]=
c*a.texel_mask[1]*d};e.set_texel_size_mult=function(a,b){a.texel_size_multiplier=b};e.create_performance_graph=function(){var a=P.create(),c=Q.create_subs_perf(),d=D.create_camera(D.TYPE_NONE);d.width=512;d.height=512;c.camera=d;P.append_node_attr(a,c);c.slinks_internal.push(v("COLOR","u_color",512,1,1,!1,!1));d=Q.create_subs_sink();P.append_node_attr(a,d);P.append_edge_attr(a,c,d,v("COLOR","NONE",512,1,1,!1,!1));b(a);M(a);return a};e.find_on_screen=function(a){var b=null;P.traverse(a,function(a,
c){return c.camera&&null===c.camera.framebuffer?(b=c,!0):!1});return b};e.find_input=function(a,b,c){a=L(a,b);for(b=0;b<a.length;b++)if(a[b].type==c)return a[b];return null};e.get_inputs_by_type=function(a,b,c){a=L(a,b);b=[];for(var d=0;d<a.length;d++)a[d].type==c&&b.push(a[d]);return b};e.has_lower_subs=ha;e.has_upper_subs=S;e.get_inputs=L;e.get_outputs=q;e.find_subs=function(a,b){var c=null;P.traverse(a,function(a,d){return d.type==b?(c=d,!0):!1});return c};e.debug_convert_to_dot=function(a){var b=
"digraph scenegraph {\n",b=b+"    ",b=b+'size="11.7,16.5";\n',b=b+"    ",b=b+'ratio="fill";\n',b=b+"    ",b=b+'node [shape=box margin="0.25,0.055"];\n',c=w(a);P.traverse(a,function(a,d){var f=b+="    ",h=Q.subs_label(d);if(d.camera){for(var h=h+"\\n",e=0;e<c.length;e+=2){var l=d.camera.color_attachment;c[e]==l&&(h=da.is_renderbuffer(l)?h+("CR"+c[e+1]+" "):h+("C"+c[e+1]+" "))}for(e=0;e<c.length;e+=2)l=d.camera.depth_attachment,c[e]==l&&(h=da.is_renderbuffer(l)?h+("DR"+c[e+1]):h+("D"+c[e+1]))}d.slinks_internal.length&&
(h+="\\n-----\\n");for(e=0;e<d.slinks_internal.length;e++)h+=ea(d.slinks_internal[e],a,null,c);b=f+(String(a)+' [label="'+h+'" color="black" style="'+((d.type==Q.SINK?"dotted":d.enqueue?"solid":"dashed")+",bold")+'"];\n')});P.traverse_edges(a,function(a,d,f){var h=b+="    ",e=ea(f,a,d,c);b=h+(String(a)+" -> "+String(d)+' [label="'+e+'" style="'+(f.active?"solid":"dotted")+'"];\n')});return b+="}"};e.create_rendering_queue=function(a){a=P.topsort_attr(a);for(var b=[],c=0;c<a.length;c++){var d=a[c];
d.enqueue&&b.push(d)}return b}});t.a=e},function(C,t,e){C=e(0);var R=e(31),V=e(1),n=e(2),y=e(4);e=Object(C.a)("__loader",function(d,e){function k(a,b,c,d){var f=E,l=fa.create(),k;for(k in b){var m=A(b[k]);if(d&&m.is_resource||!a&&m.primary_only)m.skip=!0;fa.append_node_attr(l,m)}for(k in b)for(m=b[k],m.name=k,a=0;a<m.inputs.length;a++)fa.append_edge_attr(l,b[m.inputs[a]],m,null);b=A({name:"out",priority:e.FINISH_PRIORITY,cb_before:function(a,b,c,d,e,l){b.is_primary&&(f.start_secondary_threads=!0);
T(b)||(b.status=2);b.loaded_cb(b.id,!0);e(b,c);z.log("%cTHREAD "+b.id+": LOADED CALLBACK","color: #f0f;")},relative_size:5});if(c)c=fa.get_sink_nodes(l);else{k=fa.clone(l);do{c=fa.get_sink_nodes(k);m=[];for(a=0;a<c.length;a++){d=c[a];var n=fa.get_node_attr(k,d);n.background_loading&&m.push(d)}for(a=0;a<m.length;a++)fa.remove_node(k,m[a]);m.length&&fa.cleanup_loose_edges(k)}while(m.length)}fa.append_node_attr(l,b);for(a=0;a<c.length;a++)d=c[a],n=fa.get_node_attr(l,d),b.inputs.push(n.name),fa.append_edge_attr(l,
n,b,null);return l}function A(a){a.background_loading=a.background_loading||!1;a.priority||0===a.priority||(a.priority=a.SYNC_PRIORITY);a.inputs=a.inputs||[];a.is_finished=a.is_finished||!1;a.skip=a.skip||!1;a.relative_size=a.relative_size||0;a.is_resource=a.is_resource||!1;a.primary_only=a.primary_only||!1;a.status=0;a.loop_index=0;a.load_rate=0;a.cb_param=a.cb_param||null;return a}function r(a,b,c){b.complete_load_cb(c,b);b.status=3;a.active_threads--;G.debug_loading&&(a=Math.round(performance.now()-
b.time_load_start),z.log("%cTHREAD "+b.id+": 100% LOADING END "+a+"ms","color: #f0f;"));b.stageload_cb=null;b.complete_load_cb=null;G.debug_loading||(b.stage_graph=null);b.stages_queue=null}function p(a,b){for(var c=[],d=[],f=0;f<b.length;f++){var e=b[f];fa.get_node_attr(a.stage_graph,e).is_finished&&(fa.traverse_outputs(a.stage_graph,e,function(d,f,e){var l=!0;fa.traverse_inputs(a.stage_graph,d,function(a,b,c){if(!b.is_finished)return l=!1,1});l&&-1==c.indexOf(d)&&-1==b.indexOf(d)&&c.push(d)}),d.push(f))}for(f=
d.length-1;0<=f;f--)b.splice(d[f],1);return c}function u(a){var b=[],c=a.stages_queue,d=!1;do{var f=p(a,c);b.push.apply(b,c);0<f.length&&(d=!0);c=f}while(0<f.length);c=function(b,c){var d=fa.get_node_attr(a.stage_graph,b),f=fa.get_node_attr(a.stage_graph,c),e=f.priority-d.priority;0==e&&(e=d.background_loading-f.background_loading);return e};d&&b.sort(c);a.stages_queue=b;return a.stages_queue.length}function a(a,b,d){if(b.skip)return b.is_finished=!0,G.debug_loading&&z.log("%cTHREAD "+a.id+": SKIP STAGE "+
b.name,"color: #f0f;"),l(a,b),!1;if(G.debug_loading&&0==b.status){var f=t(a),e="LOADING START "+b.name,k=Math.round(performance.now()-a.time_load_start);z.log("%cTHREAD "+a.id+": "+f+"% "+e+" "+k+"ms ","color: #f0f;")}if(!b.cb_before&&!b.cb_loop&&!b.cb_after)return l(a,b),!1;if(0==b.status&&(b.status++,b.cb_before))return b.cb_before(d,a,b,b.cb_param,l,c),!0;if(1==b.status){if(b.cb_loop)return b.cb_loop(d,a,b,b.cb_param,l,c),!0;b.status++}return 2==b.status&&(b.status++,b.cb_after)?(b.cb_after(d,
a,b,b.cb_param,l,c),!0):!1}function t(a){if(0==a.stages_size_total)return 100;var b=0;fa.traverse(a.stage_graph,function(c,d){a.do_not_load_resources&&d.is_resource||(b+=d.load_rate*d.relative_size)});return n._64(100*b/a.stages_size_total)}function l(a,b){b.is_finished=!0;b.status=3;m(a,b,1);if(G.debug_loading){var c=t(a),d="LOADING END "+b.name,f=Math.round(performance.now()-a.time_load_start);z.log("%cTHREAD "+a.id+": "+c+"% "+d+" "+f+"ms ","color: #f0f;")}}function c(a,b,c){1>c?m(a,b,c):b.status++}
function m(a,b,c){var d=E;if(b.cb_before||b.cb_loop||b.cb_after)if(b.load_rate=c,b=t(a),a.curr_percents!=b||1==c)a.stageload_cb(b,performance.now()-a.time_load_start,a.id),a.curr_percents=b,d.make_idle_iteration=!0}function b(a,b){var c=null;fa.traverse(a.stage_graph,function(a,d){if(d.name==b)return c=d,1});return c}function f(){return 0==E.active_threads}function T(a){return a&&(3==a.status||4==a.status)}var fa=Object(R.a)(d),z=Object(V.a)(d),G=Object(y.a)(d).defaults;e.SYNC_PRIORITY=0;e.ASYNC_PRIORITY=
1;e.FINISH_PRIORITY=2;var E=null;e.get_scheduler=function(){return E};e.create_scheduler=function(){var a={threads:[],current_thread_index:0,active_threads:0,start_secondary_threads:!1,make_idle_iteration:!1};return E=a};e.create_thread=function(a,b,c,d,f,e,l,m,n){var p=E,r=p.threads.length,q={id:r,is_primary:0==r,status:0,filepath:b,binary_name:"",loaded_cb:c||function(){},load_hidden:m||!1,wait_complete_loading:e,time_load_start:0,curr_percents:0,stages_size_total:0,reset_time_cycle:!1,stageload_cb:d||
function(){},complete_load_cb:f||function(){},stage_graph:null,stages_queue:null,has_video_textures:!1,has_background_music:!1,init_wa_context:!1,is_preloading:n};a=k(q.is_primary,a,e,l);q.stage_graph=a;b=[];c=fa.get_source_nodes(a);for(d=0;d<c.length;d++)b.push(c[d]);q.stages_queue=b;fa.traverse(a,function(a,b){if(b.cb_before||b.cb_loop||b.cb_after)q.do_not_load_resources&&b.is_resource||(q.stages_size_total+=b.relative_size)});p.threads.push(q);p.active_threads++;return q.id};e.update_scheduler=
function(b){var c=E;if(c&&!f())if(c.make_idle_iteration)c.make_idle_iteration=!1;else{var d=performance.now();do{var l=c.threads[c.current_thread_index],k=b[l.id];if(!T(l))if(0==l.status&&(l.status=1,l.time_load_start=performance.now(),l.stageload_cb(0,0,l.id),G.debug_loading&&z.log("%cTHREAD "+l.id+": 0% LOADING START 0ms","color: #f0f;")),u(l)){var m=l,n=m.stages_queue.length;do{var p=fa.get_node_attr(m.stage_graph,m.stages_queue[0]),A=a(m,p,k);p.priority==e.ASYNC_PRIORITY&&(m.reset_time_cycle=
!0);p=m.stages_queue.shift();m.stages_queue.push(p);n--}while(!A&&0!=n)}else r(c,l,k);c.start_secondary_threads&&(c.current_thread_index=(c.current_thread_index+1)%c.threads.length);if(l.reset_time_cycle){l.reset_time_cycle=!1;break}}while(16>performance.now()-d)}};e.abort_thread=function(a){var b=E;r(b,a,null);a.status=4;a.is_primary&&(b.start_secondary_threads=!0);a.loaded_cb(a.id,!1)};e.stage_part_finish_cb=c;e.skip_stage_by_name=function(a,c){var d=b(a,c);null!==d&&(d.skip=!0)};e.is_finished=
f;e.thread_is_finished=T;e.is_primary_loaded=function(a){var b=E;if(!b)return!1;a|=0;return b.threads[a]&&(3==b.threads[a].status||2==b.threads[a].status)};e.graph_to_dot=function(a){if(G.debug_loading){var b=E;return b&&b.threads[a]&&b.threads[a].stage_graph?fa.debug_dot(b.threads[a].stage_graph,function(a,b){if(b.skip)return"SKIPPED\n("+b.name+")";var c=b.name+"\n",d=[];d.push(b.priority==e.ASYNC_PRIORITY?"ASYNC":"SYNC");b.background_loading&&d.push("BKG");b.is_resource&&d.push("RES");return c+
d.join(" | ")},null):null}z.error("Debug mode isn't enabled. Can not retrieve the graph.")};e.cleanup=function(){E=null}});t.a=e},function(C,t,e){C=e(0);C=Object(C.a)("__context",function(e,t){var n=null;t.setup=function(e){n=e};t.get_gl=function(){return n};t.reset=function(){n=null}});t.a=C},function(C,t,e){C=e(0);var R=e(14),V=e(58),n=e(9),y=e(19),d=e(1),k=e(13),I=e(2),A=e(3);e=Object(C.a)("constraints",function(e,p){var r=Object(R.a)(e),a=Object(V.a)(e),t=Object(n.a)(e),l=Object(y.a)(e),c=Object(d.a)(e),
m=Object(k.a)(e);p.append_stiff=function(b,d,e,k,n){t.is_dynamic(b)?a.check_self_applying(b,d)?a.check_compatibility(b,d)?(e=e||new Float32Array(3),n=n||1,k=k?k:[0,0,0,1],d instanceof Array&&2==d.length?a.append_stiff_bone(b,d[0],d[1],e,k,n):a.append_stiff_obj(b,d,e,k,n),m.update_transform(b),l.sync_transform(b)):c.error("Constraint recursion is forbidden."):c.error("Can not apply constraint. Object and target must be different."):c.error('Wrong object: "'+b.name+'" is not dynamic.')};p.append_semi_stiff=
function(b,d,e,k,n,p,r,u){t.is_dynamic(b)?a.check_self_applying(b,d)?a.check_compatibility(b,d)?(n=I._17(n)?n:Math.PI/2,p=I._17(p)?p:-Math.PI/2,r=I._17(r)?r:Math.PI/2,u=I._17(u)?u:-Math.PI/2,e=e||new Float32Array(3),k=k?new Float32Array(k):null,a.append_semi_stiff_obj(b,d,e,k,n,p,r,u),m.update_transform(b),l.sync_transform(b)):c.error("Constraint recursion is forbidden."):c.error("Can not apply constraint. Object and target must be different."):c.error('Wrong object: "'+b.name+'" is not dynamic.')};
p.append_semi_stiff_cam=function(a,d,e,l,k,m,n,u){c.error_deprecated("append_semi_stiff_cam","append_semi_stiff");r.is_eye_camera(a)?p.append_semi_stiff(a,d,e,l,k,m,n,u):c.error("append_semi_stiff_cam(): wrong object type, only EYE camera objects can be parented.")};p.append_semi_soft_cam=function(a,d,e,l){c.error_deprecated("append_semi_soft_cam","append_semi_soft");r.is_eye_camera(a)?p.append_semi_soft(a,d,e,l):c.error("append_semi_soft_cam(): wrong object type, only EYE camera objects can be parented.")};
p.append_semi_soft=function(b,d,e,k){if(t.is_dynamic(b))if(a.check_self_applying(b,d))if(a.check_compatibility(b,d)){if(!I._17(k)||0>k)k=.25;e=e||new Float32Array(3);a.append_semi_soft_obj(b,d,e,k);m.update_transform(b);l.sync_transform(b)}else c.error("Constraint recursion is forbidden.");else c.error("Can not apply constraint. Object and target must be different.");else c.error('Wrong object: "'+b.name+'" is not dynamic.')};p.append_stiff_trans=function(b,d,e){t.is_dynamic(b)?a.check_self_applying(b,
d)?a.check_compatibility(b,d)?(e=e||new Float32Array(3),a.append_stiff_trans_obj(b,d,e),m.update_transform(b),l.sync_transform(b)):c.error("Constraint recursion is forbidden."):c.error("Can not apply constraint. Object and target must be different."):c.error('Wrong object: "'+b.name+'" is not dynamic.')};p.append_copy_loc=function(b,d,e,k,n){if(t.is_dynamic(b))if(a.check_self_applying(b,d))if(a.check_compatibility(b,d)){k=k||!1;e=e||"XYZ";n=n||1;var f=m.get_translation(b,new Float32Array(3)),p=new Float32Array(3);
p[0]=-1!=e.indexOf("-X")?-1:-1!=e.indexOf("X")?1:0;p[1]=-1!=e.indexOf("-Y")?-1:-1!=e.indexOf("Y")?1:0;p[2]=-1!=e.indexOf("-Z")?-1:-1!=e.indexOf("Z")?1:0;a.append_copy_loc_obj(b,d,f,p,k,n);m.update_transform(b);l.sync_transform(b)}else c.error("Constraint recursion is forbidden.");else c.error("Can not apply constraint. Object and target must be different.");else c.error('Wrong object: "'+b.name+'" is not dynamic.')};p.append_copy_trans=function(b,d,e){t.is_dynamic(b)?a.check_self_applying(b,d)?a.check_compatibility(b,
d)?(a.append_copy_trans_obj(b,d,e||1),m.update_transform(b),l.sync_transform(b)):c.error("Constraint recursion is forbidden."):c.error("Can not apply constraint. Object and target must be different."):c.error('Wrong object: "'+b.name+'" is not dynamic.')};p.append_copy_rot=function(b,d,e,k,n){if(t.is_dynamic(b))if(a.check_self_applying(b,d))if(a.check_compatibility(b,d)){k=k||!1;e=e||"XYZ";n=n||1;var f=new Float32Array(3);f[0]=-1!=e.indexOf("-X")?-1:-1!=e.indexOf("X")?1:0;f[1]=-1!=e.indexOf("-Y")?
-1:-1!=e.indexOf("Y")?1:0;f[2]=-1!=e.indexOf("-Z")?-1:-1!=e.indexOf("Z")?1:0;a.append_copy_rot_obj(b,d,f,k,n);m.update_transform(b);l.sync_transform(b)}else c.error("Constraint recursion is forbidden.");else c.error("Can not apply constraint. Object and target must be different.");else c.error('Wrong object: "'+b.name+'" is not dynamic.')};p.append_stiff_trans_rot=function(b,d,e,k){t.is_dynamic(b)?a.check_self_applying(b,d)?a.check_compatibility(b,d)?(e=e||new Float32Array(3),k=k?new Float32Array(k):
[0,0,0,1],a.append_stiff_trans_rot_obj(b,d,e,k,1),m.update_transform(b),l.sync_transform(b)):c.error("Constraint recursion is forbidden."):c.error("Can not apply constraint. Object and target must be different."):c.error('Wrong object: "'+b.name+'" is not dynamic.')};p.append_track=function(b,d,e,k,n,p){if(t.is_dynamic(b))if(a.check_self_applying(b,d))if(a.check_compatibility(b,d)){var f=I.e;"-Y"==e?f=I.b:"Y"==e?f=I.e:"-X"==e?f=I.a:"X"==e?f=I.d:"-Z"==e?f=I.c:"Z"==e&&(f=I.f);e=I.f;"X"==k?e=I.d:"Y"==
k&&(e=I.e);1==Math.abs(A.dot(f,e))?c.error("Can not use parallel vectors for track and up axes."):(a.append_track_obj(b,d,f,e,n||!1,p||1),m.update_transform(b),l.sync_transform(b))}else c.error("Constraint recursion is forbidden.");else c.error("Can not apply constraint. Object and target must be different.");else c.error('Wrong object: "'+b.name+'" is not dynamic.')};p.append_follow=function(b,d,e,k){t.is_dynamic(b)?a.check_self_applying(b,d)?a.check_compatibility(b,d)?(a.append_follow_obj(b,d,e,
k),m.update_transform(b),l.sync_transform(b)):c.error("Constraint recursion is forbidden."):c.error("Can not apply constraint. Object and target must be different."):c.error('Wrong object: "'+b.name+'" is not dynamic.')};p.append_stiff_viewport=function(b,d,e){t.is_dynamic(b)?a.check_self_applying(b,d)?a.check_compatibility(b,d)?(e=e||{},a.append_stiff_viewport(b,d,e),m.update_transform(b),l.sync_transform(b)):c.error("Constraint recursion is forbidden."):c.error("Can not apply constraint. Object and target must be different."):
c.error('Wrong object: "'+b.name+'" is not dynamic.')};p.remove=function(b,c){c=c||!1;b.constraint&&a.remove(b,c);c&&m.update_transform(b)}});t.a=e},function(C,t,e){C=e(0);var R=e(18);e=Object(C.a)("time",function(e,n){var y=Object(R.a)(e);n.set_timeout=y.set_timeout;n.clear_timeout=y.clear_timeout;n.get_timeline=y.get_timeline;n.animate=y.animate;n.clear_animation=y.clear_animation});t.a=e},function(C,t,e){C=e(0);var R=e(1);e=Object(C.a)("storage",function(e,n){function y(d){return t[d?d:k]?JSON.parse(t[d?
d:k]):{}}var d=Object(R.a)(e),k="b4w",t=null;n.init=function(e){e?"b4w"!==e?k=e:d.error("b4w prefix denied"):d.warn("Prefix should be a string. Last declared storage prefix will be used.")};n.set=function(d,e,n){var p=y(n);p[d]=String(e);t[n?n:k]=JSON.stringify(p)};n.cleanup=function(d){delete t[d?d:k]};n.get=function(d,e){var k=y(e);return k[d]?k[d]:""};n.debug=function(e){d.log(y(e?e:k))};try{t=window.localStorage;try{t.tmp=null,delete t.tmp}catch(A){d.warn("localStorage quota is limited. Disabling localStorage"),
t=null}}catch(A){d.warn("Applying chrome localStorage bug workaround"),t=null}t||(d.warn("localStorage is not available, initializing temporary storage"),t={})});t.a=e},function(C,t,e){C=e(0);var R=e(5),V=e(1);e(2);e=Object(C.a)("__texcomp",function(e,y){function d(d,c,e,b){var f=new Int32Array(e,0,31),l,k,m,n,r,y;if(542327876!=f[0])return p.error("Invalid magic number in DDS header"),0;if(!f[20]&4)return p.error("Unsupported format, must contain a FourCC code"),0;l=f[21];switch(l){case u:k=8;m=c?
c.COMPRESSED_RGB_S3TC_DXT1_EXT:null;break;case a:k=16;m=c?c.COMPRESSED_RGBA_S3TC_DXT3_EXT:null;break;case t:k=16;m=c?c.COMPRESSED_RGBA_S3TC_DXT5_EXT:null;break;default:return p.error("Unsupported FourCC code:",A(l)),null}y=1;f[2]&131072&&!1!==b&&(y=Math.max(1,f[7]));n=f[4];r=f[3];f=f[1]+4;if(c)for(l=0;l<y;++l)b=Math.max(4,n)/4*Math.max(4,r)/4*k,c=new Uint8Array(e,f,b),d.compressedTexImage2D(d.TEXTURE_2D,l,m,n,r,0,c),f+=b,n=Math.max(.5*n,1),r=Math.max(.5*r,1);else if(l==u){e=c=new Uint16Array(e);k=
f/2;m=n;var B=r,f=new Uint16Array(4);c=new Uint16Array(m*B);var F,I,K,C,v,Y;l=m/4;for(var R=B/4,S=0;S<R;S++)for(var L=0;L<l;L++)B=k+4*(S*l+L),f[0]=e[B],f[1]=e[B+1],F=f[0]&31,I=f[0]&2016,K=f[0]&63488,C=f[1]&31,v=f[1]&2016,Y=f[1]&63488,f[2]=5*F+3*C>>3|5*I+3*v>>3&2016|5*K+3*Y>>3&63488,f[3]=5*C+3*F>>3|5*v+3*I>>3&2016|5*Y+3*K>>3&63488,F=e[B+2],I=4*S*m+4*L,c[I]=f[F&3],c[I+1]=f[F>>2&3],c[I+2]=f[F>>4&3],c[I+3]=f[F>>6&3],I+=m,c[I]=f[F>>8&3],c[I+1]=f[F>>10&3],c[I+2]=f[F>>12&3],c[I+3]=f[F>>14],F=e[B+3],I+=m,
c[I]=f[F&3],c[I+1]=f[F>>2&3],c[I+2]=f[F>>4&3],c[I+3]=f[F>>6&3],I+=m,c[I]=f[F>>8&3],c[I+1]=f[F>>10&3],c[I+2]=f[F>>12&3],c[I+3]=f[F>>14];d.texImage2D(d.TEXTURE_2D,0,d.RGB,n,r,0,d.RGB,d.UNSIGNED_SHORT_5_6_5,c);b&&d.generateMipmap(d.TEXTURE_2D)}else return p.error("No manual decoder for",A(l),"and no native support"),0;return y}function k(a,c,e,b,f,k){var l=new XMLHttpRequest;l.open("GET",e,!0);l.responseType="arraybuffer";l.onload=function(){if(200==l.status){a.bindTexture(a.TEXTURE_2D,b);var e=d(a,
c,l.response,f);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,1<e?a.LINEAR_MIPMAP_LINEAR:a.LINEAR)}k&&k(b)};l.send(null);return b}function n(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}function A(a){return String.fromCharCode(a&255,a>>8&255,a>>16&255,a>>24&255)}var r=Object(R.a)(e),p=Object(V.a)(e),u=n("DXT1"),a=n("DXT3"),t=n("DXT5");y.upload_dds_levels=d;y.upload_pvr_levels=function(a,c,
d){var b=new Uint32Array(d,0,13);if(55727696==b[0]){var f=b[7],e=b[6],l=b[11],k=52+b[12];switch(b[2]){case 0:var m=2,n=1;break;case 1:m=2;n=3;break;case 2:m=4;n=0;break;case 3:m=4;n=2;break;default:r.panic("Unsupported PVR V3 format.")}}else if(559044176==b[11]){f=b[2];e=b[1];l=b[3];k=b[0];l++;var p=b[4]&255,b=0<b[10];25==p?(m=4,n=b?2:0):24==p?(m=2,n=b?3:1):r.panic("Unsupported PVR V2 format.")}else r.panic("Unsupported PVR version.");p=2==m?8:4;b=4;switch(n){case 0:var u=c.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;
break;case 1:u=c.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;break;case 2:u=c.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;break;case 3:u=c.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}c=p*b*m/8;for(m=0;m<l;m++){var n=Math.max(f>>m,1),y=Math.max(e>>m,1),A=n/p,t=y/b;2>A&&(A=2);2>t&&(t=2);A=A*t*c;t=new Uint8Array(d,k,A);a.compressedTexImage2D(a.TEXTURE_2D,m,u,n,y,0,t);k+=A}};y.get_width_height=function(a,c){switch(c){case "dds":var d=new Int32Array(a,0,31);return{width:d[4],height:d[3]};case "pvr":d=new Uint32Array(a,0,13);if(55727696==
d[0])var b=d[7],d=d[6];else b=d[2],d=d[1];return{width:b,height:d}}};y.get_compress_ratio=function(d,c){var e=1;if("dds"==c){var b=new Int32Array(d,0,31),f=b[21];switch(f){case u:e=6;break;case a:case t:e=4;break;default:p.error("Unsupported FourCC code:",A(f))}}else if("pvr"==c)if(b=new Uint32Array(d,0,13),55727696==b[0])switch(b[2]){case 0:e=12;break;case 1:e=16;break;case 2:e=6;break;case 3:e=8}else f=b[4]&255,b=0<b[10],25==f?e=b?8:6:24==f&&(e=b?16:12);return e};y.load_dds_texture=function(a,c,
d,b){var f=a.createTexture();k(a,c,d,f,!0,b);return f}});t.a=e},function(C,t,e){C=e(0);var R=e(1);e=Object(C.a)("__debug",function(e,n){var y=Object(R.a)(e),d={};n.fill_vbo_garbage_info=function(e,n,y,r,p){d[e]||(d[e]={shaders:n,attrs:{}});y in d[e].attrs||(d[e].attrs[y]=r);p&&(d[e].attrs[y]=0)};n.calc_vbo_garbage_byte_size=function(){var e=0,n;for(n in d)for(var y in d[n].attrs)e+=d[n].attrs[y];return e};n.show_vbo_garbage_info=function(){var e={},n;for(n in d)for(var A in d[n].attrs){var r=d[n].attrs[A];
if(r){var p=d[n].shaders;p in e||(e[p]={total_size:0,attrs:{}});A in e[p].attrs||(e[p].attrs[A]=0);e[p].attrs[A]+=r;e[p].total_size+=r}}for(p in e){y.groupCollapsed(p,e[p].total_size);for(A in e[p].attrs)y.log_raw(A,e[p].attrs[A]);y.groupEnd()}};n.cleanup=function(){d={}}});t.a=e},function(C,t,e){C=e(0);var R=e(4),V=e(46),n=e(28),y=e(11),d=e(2);e=Object(C.a)("__debug_rendertime",function(e,t){function k(){var a=B.get_disjoint_timer_query();if(a){var b=a.createQuery();a.beginQuery(b)}else b=performance.now();
return b}function r(){var c=a.get_debug_view_subs();return c&&c.debug_view_mode==a.DV_RENDER_TIME}function p(a,b,c){var f=B.get_disjoint_timer_query(),e=0;if(f)for(c&&f.endQuery(),c=0;c<a.length;c++){var l=a[c],k=f.getQueryAvailable(l),m=f.getDisjoint();k&&!m&&(e=f.getQueryObject(l)/1E6,b&&(e=d._51(e,b,1,10)),a.splice(c,1),c--)}else e=performance.now()-a.pop(),b&&(e=d._51(e,b,1,10));return e}var u=Object(R.a)(e),a=Object(V.a)(e),B=Object(n.a)(e),l=Object(y.a)(e),c=u.defaults;t.start_subs=function(a){if(c.show_hud_debug_info||
a.type==l.PERFORMANCE)a.do_not_debug||a.debug_render_time_queries.push(k())};t.start_batch=function(a){"MAIN"==a.type&&r()&&a.debug_render_time_queries.push(k())};t.stop_subs=function(a){if((c.show_hud_debug_info||a.type==l.PERFORMANCE)&&!a.do_not_debug){var b=p(a.debug_render_time_queries,a.debug_render_time,!0);b&&(a.debug_render_time=b)}};t.stop_batch=function(a){if("MAIN"==a.type&&r()){var b=p(a.debug_render_time_queries,a.debug_render_time,!0);b&&(a.debug_render_time=b)}};t.is_debug_view_render_time_mode=
r;t.process_timer_queries=function(a){var b=p(a.debug_render_time_queries,a.debug_render_time,!1);b&&(a.debug_render_time=b)}});t.a=e},function(C,t,e){C=e(0);var R=e(20),V=e(42),n=e(21),y=e(2),d=e(3),k=e(7);e=Object(C.a)("__navmesh",function(e,t){function r(a){a=a.polygons;for(var b=[],c=0,d=function(a){for(var b=a.neighbours,c=0;c<b.length;c++){var f=b[c];void 0==f.island&&(f.island=a.island,d(f))}},f=0;f<a.length;f++){var e=a[f];void 0==e.island&&(e.island=c++,d(e));b[e.island]||(b[e.island]=[]);
b[e.island].push(a[f])}return b}function p(a,b){if(a.indexOf)return a.indexOf(b);for(var c=0;c<a.length;c++)if(a[c]==b)return c;return-1}function u(a){for(var b={},c=a.vertices,d=0;d<c.length;d++)c[d][0]=parseFloat(c[d][0].toFixed(2)),c[d][1]=parseFloat(c[d][1].toFixed(2)),c[d][2]=parseFloat(c[d][2].toFixed(2));b.vertices=a.vertices;a=r(a);b.islands=[];c=function(a,b){for(var c=0;c<a.length;c++)if(b===a[c])return c};for(d=0;d<a.length;d++){for(var f=[],e=a[d],l=0;l<e.length;l++){for(var k=[],m=e[l],
n=0;n<m.neighbours.length;n++)k.push(c(e,m.neighbours[n]));for(var p=[],n=0;n<m.neighbours.length;n++)p.push(q(m,m.neighbours[n]));m.centroid[0]=parseFloat(m.centroid[0].toFixed(2));m.centroid[1]=parseFloat(m.centroid[1].toFixed(2));m.centroid[2]=parseFloat(m.centroid[2].toFixed(2));f.push({id:c(e,m),neighbours:k,vertex_ids:m.vertex_ids,centroid:m.centroid,normal:m.normal,portals:p,f:0,g:0,h:0,cost:1,visited:!1,closed:!1,parent:null})}b.islands.push(f)}return b}function a(a,b,c,f,h,e){function l(a,
b){d.subtract(a,b,G);return d.dot(G,G)}function k(a,b){for(var c=[],d=0;d<b.neighbours.length;d++)c.push(a[b.neighbours[d]]);return c}(function(a){for(var b=0;b<a.length;b++){var c=a[b];c.f=0;c.g=0;c.h=0;c.cost=1;c.visited=!1;c.closed=!1;c.parent=null}})(a);e=V.a(function(a){return a.f});for(V.c(e,b);0<e.content.length;){var m=V.b(e);if(m===c){a=m;for(c=[];a.parent;)c.push(a),a=a.parent;c.push(b);return c.reverse()}m.closed=!0;for(var n=k(a,m),q=0,p=n.length;q<p;q++){var r=n[q];if(!r.closed){var w=
m.g+d.dist(r.centroid,m.centroid),u=r.visited;if(!u||w<r.g)r.visited=!0,r.parent=m,r.h=r.h||l(r.centroid,h)+l(r.centroid,f),r.g=w,r.f=r.g+r.h,u?V.d(e,r):V.c(e,r)}}}return[]}function A(a,b){a.push(b[0]);a.push(b[1]);a.push(b[2])}function l(a,b,c,f){b=d.subtract(b,a,G);a=d.subtract(c,a,E);a=d.cross(b,a,G);return y._50(d.dot(f,a))}function c(a,b){d.subtract(a,b,G);return 1E-5>d.dot(G,G)}function m(a,b,c){var f=d.subtract(b.right,b.left,G),h=c.normal,e=b.normal;c=Math.acos(d.dot(h,e));h=y._50(d.dot(f,
d.cross(h,e,E)));c*=-h;h=n.identity(C);n.translate(h,b.left,h);n.rotate(h,c,f,h);n.translate(h,d.scale(b.left,-1,E),h);n.multiply(a,h,a);return a}function b(a,b,c,f,h,e,l,q,p){for(var r=n.identity(U),w=h;w<c;w++)if(a[w].is_crucial&&(w>h||!w)){var u,z=b,v=f;u=a[w].left;var E=a[w].right,D=e,y=r,t=d.create(),B=d.transformMat4(u,y,J);B[3]=1;y=d.transformMat4(E,y,G);y=d.subtract(y,B,M);z=d.subtract(v,z,G);D=d.cross(D,z,F);.01>Math.abs(d.dot(D,y))?v=.5:(d.normalize(D,D),D[3]=-d.dot(D,v),v=-k.dot(D,B)/k.dot(D,
y));E=d.subtract(E,u,G);u=d.scaleAndAdd(u,E,v,t);A(l,u);q&&A(p,a[w].normal);w&&m(r,a[w],a[w-1])}}function f(a,f){function e(b,c){t=y=E=c;r=p=q=b;d.copy(b,w);d.copy(b,u);d.copy(a[E].normal,z)}var k=[],h=[],q,p,r,w,u,z,E=0,y=0,t=0;q=a[0].right;p=a[0].left;r=a[0].right;w=d.copy(p,v);u=d.copy(r,Y);z=d.copy(a[0].normal,L);A(k,q);f&&A(h,a[0].normal);for(var B=n.identity(K),G=1;G<a.length;G++){var J=a[G].left,F=a[G].right,T=d.transformMat4(J,B,ha),I=d.transformMat4(F,B,S);a[G].is_crucial&&m(B,a[G],a[G-1]);
if(0>=l(q,u,I,z)){var M=c(q,r);if(M||0<l(q,w,I,z))r=F,d.copy(I,u),t=G;else{(J=c(w,q))||b(a,w,y,q,E,z,k,f,h);B=n.identity(B);e(p,y);G=E;J||(A(k,q),f&&A(h,a[G].normal));continue}}0<=l(q,w,T,z)&&((M=c(q,p))||0>l(q,u,T,z)?(p=J,d.copy(T,w),y=G):((J=c(u,q))||b(a,u,t,q,E,z,k,f,h),B=n.identity(B),e(r,t),G=E,J||(A(k,q),f&&A(h,a[G].normal))))}B=a.length-1;G=a[B].left;(J=c(q,G))||b(a,w,B,q,E,z,k,f,h);J&&E||A(k,G);return f?(A(h,a[B].normal),{positions:new Float32Array(k),normals:new Float32Array(h)}):{positions:new Float32Array(k),
normals:null}}function T(a,b,c,d,f){for(var h=null,e=Number.MAX_VALUE,l=0;l<a.length;l++){var k=a[l],m=f(c,k.centroid,k.vertex_ids,b,e);m<e&&(h=k,e=m)}return 0<d&&e>d?null:h}function I(a,b,c,d,f){a.push({left:b,right:c,is_crucial:d,normal:f})}var z=Object(R.a)(e),G=d.create(),E=d.create(),J=k.create(),M=k.create(),F=k.create(),U=n.create(),K=n.create(),C=n.create(),v=d.create(),Y=d.create(),ha=d.create(),S=d.create(),L=d.create(),q=function(a,b){function c(a){var b=a[0];a[0]=a[1];a[1]=a[2];a[2]=b}
for(var d=a.vertex_ids,f=b.vertex_ids,e=[],l=0;l<d.length;l++)0<=p(f,d[l])&&e.push(d[l]);if(2>e.length)return[];0<=p(e,d[0])&&0<=p(e,d[d.length-1])&&c(d);0<=p(e,f[0])&&0<=p(e,f[f.length-1])&&c(f);e=[];for(l=0;l<d.length;l++)0<=p(f,d[l])&&e.push(d[l]);return e};t.navmesh_build_from_bufs_data=function(a){var b=z.get_vbo_source_by_type(a.vbo_source_data,z.VBO_FLOAT),c=a.ibo_array;a=[];for(var f=0;f<c.length;f+=3)a.push({indices:new Uint32Array([c[f],c[f+1],c[f+2]]),centroid:new Float32Array(3),normal:new Float32Array(3)});
c=[];for(f=0;f<b.length;f+=3){var h=new Float32Array(3);h[0]=b[f];h[1]=b[f+1];h[2]=b[f+2];c.push(h)}for(b=0;b<a.length;b++)f=a[b],d.add(c[f.indices[0]],c[f.indices[1]],G),d.add(G,c[f.indices[2]],G),d.scale(G,1/3,f.centroid);for(b=0;b<a.length;b++){var f=a[b],h=d.subtract(c[f.indices[1]],c[f.indices[0]],G),e=d.subtract(c[f.indices[2]],c[f.indices[0]],E),h=d.cross(h,e,G);d.normalize(h,h);d.copy(h,f.normal)}for(var l={},b=[],f=[],k,m,n=Math.pow(10,4),h=0,e=c.length;h<e;h++)k=c[h],m=Math.round(k[0]*n)+
"_"+Math.round(k[1]*n)+"_"+Math.round(k[2]*n),void 0===l[m]?(l[m]=h,b.push(k),f[h]=b.length-1):f[h]=f[l[m]];l=[];h=0;for(e=a.length;h<e;h++)for(k=a[h],k.indices[0]=f[k.indices[0]],k.indices[1]=f[k.indices[1]],k.indices[2]=f[k.indices[2]],k=[k.indices[0],k.indices[1],k.indices[2]],m=0;3>m;m++)if(k[m]==k[(m+1)%3]){l.push(h);break}for(h=l.length-1;0<=h;h--)a.splice(l[h],1);for(h=c.length=0;h<b.length;h++)c.push(b[h]);f=[];for(b=h=0;b<a.length;b++)e=a[b],f.push({id:h++,vertex_ids:e.indices,centroid:e.centroid,
normal:e.normal,neighbours:[]});a={polygons:f,vertices:c};c={};for(b=0;b<f.length;b++)for(h=0;3>h;h++)e=f[b].vertex_ids[h],l=f[b].vertex_ids[(h+1)%3],e=e>l?l+"-"+e:e+"-"+l,e in c||(c[e]=[]),c[e].push(f[b]);f=Object.keys(c);b=0;for(l=f.length;b<l;b++)for(e=f[b],h=0;h<c[e].length;h++)for(k=h+1;k<c[e].length;k++)c[e][h].neighbours.push(c[e][k]),c[e][k].neighbours.push(c[e][h]);return u(a)};t.navmesh_get_island=function(a,b,c){for(var f=null,h=Number.MAX_VALUE,e=a.islands,l=0;l<e.length;l++)for(var k=
0;k<e[l].length;k++){var m=e[l][k];d.subtract(m.centroid,b,G);m=c(b,m.centroid,m.vertex_ids,a.vertices,h);m<h&&(f=l,h=m)}return f};t.is_vector_in_poly=function(a,b,c){for(var d=[],f=0;f<b.length;f++)d.push(c[b[f]]);b=!1;c=-1;for(var f=d.length,e=f-1;++c<f;e=c)(d[c][1]<=a[1]&&a[1]<d[e][1]||d[e][1]<=a[1]&&a[1]<d[c][1])&&a[0]<(d[e][0]-d[c][0])*(a[1]-d[c][1])/(d[e][1]-d[c][1])+d[c][0]&&(b=!b);return b?!0:!1};t.navmesh_find_path=function(b,c,e,l){var h;h=b.islands[l.island];var k=b.vertices,m=T(h,k,c,
l.allowed_distance,l.distance_to_closest);if(m){var n=T(h,k,e,l.allowed_distance,l.distance_to_farthest);h=n?a(h,m,n,c,e,k):null}else h=null;if(!h||!h.length)return null;if(l.do_not_pull_string){e=h;if(l.return_normals){c=new Float32Array(3*e.length);for(h=0;h<e.length;h++)c.set(e[h].centroid,3*h);e={positions:c,normals:null}}else{c=new Float32Array(3*e.length);b=new Float32Array(3*e.length);for(h=0;h<e.length;h++)c.set(e[h].centroid,3*h),b.set(e[h].normal,3*h);e={positions:c,normals:b}}return e}b=
b.vertices;l=l.return_normals;k=[];I(k,c,c,!1,h[0]&&h[0].normal||y.f);for(c=0;c<h.length;c++){var q=h[c];if(m=h[c+1]){n=.999>Math.abs(d.dot(q.normal,m.normal));a:{for(var p=0;p<q.neighbours.length;p++)if(q.neighbours[p]===m.id){q=q.portals[p];break a}q=void 0}I(k,b[q[0]],b[q[1]],n,m.normal)}}I(k,e,e,!1,k[k.length-1].normal);return f(k,l)}});t.a=e},function(C,t,e){function R(){return{name:"",type:"",uuid:"",use_nodes:!1,node_tree:null,texture_slots:[],blend_mode:"",use_shadeless:!1,use_transparency:!1,
use_backface_culling:!1,use_tangent_shading:!1,use_orco_tex_coord:!1,use_vertex_color_paint:!1,use_double_sided_lighting:!1,do_not_render:!1,render_above_all:!1,is_lens_flares:!1,is_wettable:!1,is_refractive:!1,refr_bump:0,pass_index:0,offset_z:0,diffuse_shader:"",diffuse_color:new Float32Array(3),diffuse_intensity:0,diffuse_toon_size:0,diffuse_toon_smooth:0,roughness:0,diffuse_fresnel:0,diffuse_fresnel_factor:0,darkness:0,alpha:0,specular_shader:"",specular_color:new Float32Array(3),specular_intensity:0,
specular_toon_size:0,specular_toon_smooth:0,specular_hardness:0,specular_ior:0,specular_slope:0,specular_alpha:0,emit:0,ambient:0,water_settings:{is_water:!1,shore_smoothing:!1,absorb_factor:0,foam_factor:0,shallow_col:new Float32Array(3),shore_col:new Float32Array(3),shallow_col_fac:0,shore_col_fac:0,fog_color:new Float32Array(3),fog_density:0,sss_strength:0,sss_width:0,norm_uv_velocity:0,is_dynamic:!1,waves_height:0,waves_length:0,dst_noise_scale0:0,dst_noise_scale1:0,dst_noise_freq0:0,dst_noise_freq1:0,
dir_min_shore_fac:0,dir_freq:0,dir_noise_scale:0,dir_noise_freq:0,dir_min_noise_fac:0,dst_min_fac:0,waves_hor_fac:0,is_generated_mesh:!1,num_cascads:0,num_subdivs:0,detailed_dist:0,enable_caust:!1,caust_scale:0,caust_brightness:0},terrain_settings:{is_terrain:!1,dynamic_grass_size:"",dynamic_grass_color:""},raytrace_mirror:{reflect_factor:0,fresnel:0,fresnel_factor:0},halo_settings:{size:0,hardness:0,rings_color:new Float32Array(3),lines_color:new Float32Array(3),ring_count:0,line_count:0,star_tip_count:0,
is_sky_stars:!1,stars_blend_height:0,stars_min_height:0},physics_settings:{use_coll_physics:!1,use_ghost:!1,friction:0,elasticity:0,collision_id:"",collision_margin:0,collision_group:0,collision_mask:0}}}t.c=R;t.b=function(){var e=R();e.name="DEFAULT";e.type="SURFACE";e.uuid=V._4();e.use_nodes=!1;e.node_tree=null;e.texture_slots=[];e.blend_mode="OPAQUE";e.use_shadeless=!1;e.use_transparency=!1;e.use_backface_culling=!0;e.use_vertex_color_paint=!1;e.use_double_sided_lighting=!1;e.render_above_all=
!1;e.is_refractive=!1;e.refr_bump=0;e.pass_index=0;e.offset_z=0;e.diffuse_shader="LAMBERT";e.diffuse_color.set([.8,.8,.8]);e.diffuse_intensity=.8;e.alpha=1;e.specular_shader="COOKTORR";e.specular_color.set([1,1,1]);e.specular_intensity=.5;e.specular_hardness=50;e.specular_alpha=1;e.emit=0;e.ambient=1;e.water_settings.is_water=!1;e.terrain_settings.is_terrain=!1;e.raytrace_mirror.reflect_factor=0;e.raytrace_mirror.fresnel=0;e.raytrace_mirror.fresnel_factor=1.25;e.physics_settings.use_coll_physics=
!1;return e};t.d=function(e,y){y.name=e.name;y.type=e.type;y.uuid=e.uuid;y.use_nodes=e.use_nodes;y.node_tree=e.node_tree;y.texture_slots=e.texture_slots;y.blend_mode=e.game_settings.alpha_blend;y.use_shadeless=e.use_shadeless;y.use_transparency=e.use_transparency;y.use_backface_culling=e.game_settings.use_backface_culling;y.use_tangent_shading=e.use_tangent_shading;y.use_orco_tex_coord=e.use_orco_tex_coord;y.use_vertex_color_paint=e.use_vertex_color_paint;y.use_double_sided_lighting=e.b4w_double_sided_lighting;
y.do_not_render=e.b4w_do_not_render;y.render_above_all=e.b4w_render_above_all;y.is_lens_flares=e.b4w_lens_flares;y.is_wettable=e.b4w_wettable;y.is_refractive=e.b4w_refractive;y.refr_bump=e.b4w_refr_bump;y.pass_index=e.pass_index;y.offset_z=e.offset_z;y.diffuse_shader=e.diffuse_shader;y.diffuse_color.set(e.diffuse_color);y.diffuse_intensity=e.diffuse_intensity;y.diffuse_toon_size=e.diffuse_toon_size;y.diffuse_toon_smooth=e.diffuse_toon_smooth;y.roughness=e.roughness;y.diffuse_fresnel=e.diffuse_fresnel;
y.diffuse_fresnel_factor=e.diffuse_fresnel_factor;y.darkness=e.darkness;y.alpha=e.alpha;y.specular_shader=e.specular_shader;y.specular_color.set(e.specular_color);y.specular_intensity=e.specular_intensity;y.specular_toon_size=e.specular_toon_size;y.specular_toon_smooth=e.specular_toon_smooth;y.specular_hardness=e.specular_hardness;y.specular_ior=e.specular_ior;y.specular_slope=e.specular_slope;y.specular_alpha=e.specular_alpha;y.emit=e.emit;y.ambient=e.ambient;var d=y.water_settings;d.is_water=e.b4w_water;
d.shore_smoothing=e.b4w_water_shore_smoothing;d.absorb_factor=e.b4w_water_absorb_factor;d.foam_factor=e.b4w_foam_factor;d.shallow_col.set(e.b4w_shallow_water_col);d.shore_col.set(e.b4w_shore_water_col);d.shallow_col_fac=e.b4w_shallow_water_col_fac;d.shore_col_fac=e.b4w_shore_water_col_fac;d.fog_color.set(e.b4w_water_fog_color);d.fog_density=e.b4w_water_fog_density;d.sss_strength=e.b4w_water_sss_strength;d.sss_width=e.b4w_water_sss_width;d.norm_uv_velocity=e.b4w_water_norm_uv_velocity;d.is_dynamic=
e.b4w_water_dynamic;d.waves_height=e.b4w_waves_height;d.waves_length=e.b4w_waves_length;d.dst_noise_scale0=e.b4w_water_dst_noise_scale0;d.dst_noise_scale1=e.b4w_water_dst_noise_scale1;d.dst_noise_freq0=e.b4w_water_dst_noise_freq0;d.dst_noise_freq1=e.b4w_water_dst_noise_freq1;d.dir_min_shore_fac=e.b4w_water_dir_min_shore_fac;d.dir_freq=e.b4w_water_dir_freq;d.dir_noise_scale=e.b4w_water_dir_noise_scale;d.dir_noise_freq=e.b4w_water_dir_noise_freq;d.dir_min_noise_fac=e.b4w_water_dir_min_noise_fac;d.dst_min_fac=
e.b4w_water_dst_min_fac;d.waves_hor_fac=e.b4w_water_waves_hor_fac;d.is_generated_mesh=e.b4w_generated_mesh;d.num_cascads=e.b4w_water_num_cascads;d.num_subdivs=e.b4w_water_subdivs;d.detailed_dist=e.b4w_water_detailed_dist;d.enable_caust=e.b4w_water_enable_caust;d.caust_scale=e.b4w_water_caust_scale;d.caust_brightness=e.b4w_water_caust_brightness;d=y.terrain_settings;d.is_terrain=e.b4w_terrain;d.dynamic_grass_size=e.b4w_dynamic_grass_size;d.dynamic_grass_color=e.b4w_dynamic_grass_color;d=y.raytrace_mirror;
d.reflect_factor=e.raytrace_mirror.reflect_factor;d.fresnel=e.raytrace_mirror.fresnel;d.fresnel_factor=e.raytrace_mirror.fresnel_factor;d=y.halo_settings;d.size=e.halo.size;d.hardness=e.halo.hardness;d.rings_color.set(e.halo.b4w_halo_rings_color);d.lines_color.set(e.halo.b4w_halo_lines_color);d.ring_count=e.halo.ring_count;d.line_count=e.halo.line_count;d.star_tip_count=e.halo.star_tip_count;d.is_sky_stars=e.b4w_halo_sky_stars;d.stars_blend_height=e.b4w_halo_stars_blend_height;d.stars_min_height=
e.b4w_halo_stars_min_height;d=y.physics_settings;d.use_coll_physics=e.b4w_collision;d.use_ghost=e.b4w_use_ghost;d.friction=e.physics.friction;d.elasticity=e.physics.elasticity;d.collision_id=e.b4w_collision_id;d.collision_margin=e.b4w_collision_margin;d.collision_group=e.b4w_collision_group;d.collision_mask=e.b4w_collision_mask};t.a=function(e){e.name=e.name;e.type=e.type;e.uuid=e.uuid;e.use_nodes=e.use_nodes;e.node_tree=e.node_tree;e.texture_slots=e.texture_slots.slice();e.blend_mode=e.blend_mode;
e.use_shadeless=e.use_shadeless;e.use_transparency=e.use_transparency;e.use_backface_culling=e.use_backface_culling;e.use_tangent_shading=e.use_tangent_shading;e.use_orco_tex_coord=e.use_orco_tex_coord;e.use_vertex_color_paint=e.use_vertex_color_paint;e.use_double_sided_lighting=e.use_double_sided_lighting;e.do_not_render=e.do_not_render;e.render_above_all=e.render_above_all;e.is_lens_flares=e.is_lens_flares;e.is_wettable=e.is_wettable;e.is_refractive=e.is_refractive;e.refr_bump=e.refr_bump;e.pass_index=
e.pass_index;e.offset_z=e.offset_z;e.diffuse_shader=e.diffuse_shader;e.diffuse_color.set(e.diffuse_color);e.diffuse_intensity=e.diffuse_intensity;e.diffuse_toon_size=e.diffuse_toon_size;e.diffuse_toon_smooth=e.diffuse_toon_smooth;e.roughness=e.roughness;e.diffuse_fresnel=e.diffuse_fresnel;e.diffuse_fresnel_factor=e.diffuse_fresnel_factor;e.darkness=e.darkness;e.alpha=e.alpha;e.specular_shader=e.specular_shader;e.specular_color.set(e.specular_color);e.specular_intensity=e.specular_intensity;e.specular_toon_size=
e.specular_toon_size;e.specular_toon_smooth=e.specular_toon_smooth;e.specular_hardness=e.specular_hardness;e.specular_ior=e.specular_ior;e.specular_slope=e.specular_slope;e.specular_alpha=e.specular_alpha;e.emit=e.emit;e.ambient=e.ambient;var n=e.water_settings,d=e.water_settings;d.is_water=n.is_water;d.shore_smoothing=n.shore_smoothing;d.absorb_factor=n.absorb_factor;d.foam_factor=n.foam_factor;d.shallow_col.set(n.shallow_col);d.shore_col.set(n.shore_col);d.shallow_col_fac=n.shallow_col_fac;d.shore_col_fac=
n.shore_col_fac;d.fog_color=n.fog_color;d.fog_density=n.fog_density;d.sss_strength=n.sss_strength;d.sss_width=n.sss_width;d.norm_uv_velocity=n.norm_uv_velocity;d.is_dynamic=n.is_dynamic;d.waves_height=n.waves_height;d.waves_length=n.waves_length;d.dst_noise_scale0=n.dst_noise_scale0;d.dst_noise_scale1=n.dst_noise_scale1;d.dst_noise_freq0=n.dst_noise_freq0;d.dst_noise_freq1=n.dst_noise_freq1;d.dir_min_shore_fac=n.dir_min_shore_fac;d.dir_freq=n.dir_freq;d.dir_noise_scale=n.dir_noise_scale;d.dir_noise_freq=
n.dir_noise_freq;d.dir_min_noise_fac=n.dir_min_noise_fac;d.dst_min_fac=n.dst_min_fac;d.waves_hor_fac=n.waves_hor_fac;d.is_generated_mesh=n.is_generated_mesh;d.num_cascads=n.num_cascads;d.num_subdivs=n.num_subdivs;d.detailed_dist=n.detailed_dist;d.enable_caust=n.enable_caust;d.caust_scale=n.caust_scale;d.caust_brightness=n.caust_brightness;d=n=e.terrain_settings;d.is_terrain=n.is_terrain;d.dynamic_grass_size=n.dynamic_grass_size;d.dynamic_grass_color=n.dynamic_grass_color;d=n=e.raytrace_mirror;d.reflect_factor=
n.reflect_factor;d.fresnel=n.fresnel;d.fresnel_factor=n.fresnel_factor;d=n=e.halo_settings;d.size=n.size;d.hardness=n.hardness;d.rings_color.set(n.rings_color);d.lines_color.set(n.lines_color);d.ring_count=n.ring_count;d.line_count=n.line_count;d.star_tip_count=n.star_tip_count;d.is_sky_stars=n.is_sky_stars;d.stars_blend_height=n.stars_blend_height;d.stars_min_height=n.stars_min_height;d=n=e.physics_settings;d.use_coll_physics=n.use_coll_physics;d.use_ghost=n.use_ghost;d.friction=n.friction;d.elasticity=
n.elasticity;d.collision_id=n.collision_id;d.collision_margin=n.collision_margin;d.collision_group=n.collision_group;d.collision_mask=n.collision_mask;return e};var V=e(2)},function(C,t,e){C=e(0);var R=e(5),V=e(2),n=e(3);e=Object(C.a)("__curve",function(e,d){function k(a,d,e,c,k){var b=c.length;k||(k=new Float32Array(b));for(var f=b+a,l=new Float32Array(f),m=1;m<=f-1;m++)l[m-1]=d>=e[m-1]&&d<e[m+1-1]?1:0;for(var n=2;n<=a;n++)for(m=1;m<=f-n;m++)l[m-1]=(0!=l[m-1]?(d-e[m-1])*l[m-1]/(e[m+n-1-1]-e[m-1]):
0)+(0!=l[m+1-1]?(e[m+n-1]-d)*l[m+1-1]/(e[m+n-1]-e[m+1-1]):0);d==e[f-1]&&(l[b-1]=1);a=0;for(m=1;m<=b;m++)a+=l[m-1]*c[m-1];for(m=1;m<=b;m++)k[m-1]=0!=a?l[m-1]*c[m-1]/a:0;return k}function t(a){a=a.knot;return a[a.length-1]}function A(a){a=a.cumulative_length;return a[a.length-1]}function r(a,d,e,c,k,b,f,n){var l=a+(d-a)/2,m=p(l,c,k,b,f)-e;n=n?n:.01;return Math.abs(m)<n?l:0<m?r(a,l,e,c,k,b,f,n):r(l,d,e,c,k,b,f,n)}function p(a,d,e,c,k){var b=1-a;return d*b*b*b+3*e*b*b*a+3*c*b*a*a+k*a*a*a}var u=Object(R.a)(e);
d.create_spline=function(a){var d={},e=a.data;a=e.splines[0];if(!a||"NURBS"!=a.type||!a.use_endpoint_u)return null;var c=a.order_u;d.order=c;a=a.points;var m=a.length/5,b=[],f=m+c,m=m+2;b[0]=0;for(var n=2;n<=f;n++)b[n-1]=n>c&&n<m?b[n-2]+1:b[n-2];d.knot=b;"2D"==e.dimensions?d.is_3d=!1:"3D"==e.dimensions?d.is_3d=!0:u.panic("Wrong curve dimensions");c=[];b=[];for(e=0;e<a.length;e+=5)c.push(a[e]),c.push(a[e+1]),c.push(a[e+2]),d.is_3d&&c.push(a[e+3]),b.push(a[e+4]);d.cpoints=c;d.weights=b;a=[];for(var e=
d.cpoints,c=d.is_3d?4:3,b=d.weights,f=d.knot,m=d.order,n=e.length/c,p=n+m,r=0,t=f[p-1]/999,E=0;1E3>E;E++){5E-6>f[p-1]-r&&(r=f[p-1]);for(var A=k(m,r,f,b),y=0;y<c;y++)for(var F=a[c*E+y]=0;F<n;F++)a[c*E+y]+=A[F]*e[c*F+y];r+=t}c=d.is_3d?4:3;b=new Float32Array(1E3);b[0]=0;for(e=1;1E3>e;e+=1)f=a[(e-1)*c],m=a[(e-1)*c+1],n=a[(e-1)*c+2],p=a[e*c],r=a[e*c+1],t=a[e*c+2],b[e]=b[e-1]+Math.sqrt((p-f)*(p-f)+(r-m)*(r-m)+(t-n)*(t-n));d.cumulative_length=b;return d};d.spline_point=function(a,d,e){e||(e=[]);var c=d,
l=t(a);d=Math.min(c,l);var c=a.cpoints,l=a.is_3d?4:3,b=a.weights,f=a.knot,n=a.order;a=c.length/l;var p=a+n;5E-6>f[p-1]-d&&(d=f[p-1]);p=new Float32Array(a);k(n,d,f,b,p);for(d=0;d<l;d++)for(b=e[d]=0;b<a;b++)e[d]+=p[b]*c[l*b+d];return e};d.spline_derivative=function(a,d,e){e||(e=[]);var c=a.cpoints,l=a.is_3d?4:3,b=a.weights,f=a.knot,k=a.order;a=c.length/l;var n=a+k;5E-6>f[n-1]-d&&(d=f[n-1]);var n=new Float32Array(a),p=d;d=n;var r=b.length;d||(d=new Float32Array(r));var u=new Float32Array(r),t=new Float32Array(r),
A=u,y=t;A||(A=new Float32Array(r));y||(y=new Float32Array(r));for(var B=r+k,K=new Float32Array(B),I=new Float32Array(B),v=1;v<=B-1;v++)K[v-1]=p>=f[v-1]&&p<f[v+1-1]?1:0;p==f[B-1]&&(K[r-1]=1);for(var C=2;C<=k;C++)for(v=1;v<=B-C;v++){var R=0!=K[v-1]?K[v-1]/(f[v+C-1-1]-f[v-1]):0,S=0!=K[v+1-1]?-K[v+1-1]/(f[v+C-1]-f[v+1-1]):0,L=0!=I[v-1]?(p-f[v-1])*I[v-1]/(f[v+C-1-1]-f[v-1]):0,q=0!=I[v+1-1]?(f[v+C-1]-p)*I[v+1-1]/(f[v+C-1]-f[v+1-1]):0;K[v-1]=(0!=K[v-1]?(p-f[v-1])*K[v-1]/(f[v+C-1-1]-f[v-1]):0)+(0!=K[v+1-
1]?(f[v+C-1]-p)*K[v+1-1]/(f[v+C-1]-f[v+1-1]):0);I[v-1]=R+S+L+q}for(v=1;v<=r;v++)A[v-1]=K[v-1],y[v-1]=I[v-1];f=0;for(k=1;k<=r;k++)f+=u[k-1]*b[k-1];p=0;for(k=1;k<=r;k++)p+=t[k-1]*b[k-1];for(k=1;k<=r;k++)d[k-1]=0!=f?t[k-1]*b[k-1]/f+u[k-1]*b[k-1]*p/(f*f):0;for(b=0;b<l;b++)for(f=e[b]=0;f<a;f++)e[b]+=n[f]*c[l*f+b];return e};d.spline_max_t=t;d.spline_length=A;d.spline_len_to_t=function(a,d){if(0>=d)return 0;var e=t(a);if(d>=A(a))return e;var c=a.cumulative_length,k=V.F(c,d,0,c.length-1);return e*(k+(d-c[k])/
(c[k+1]-c[k]))/1E3};d.linear_interpolation=function(a,d,e,c,k){return e+(k-c)*(a-e)/(d-c)};d.linear=function(a,d,e){var c=d[0];d=d[1];e=(e[1]-d)/(e[0]-c);return e*a+(d-e*c)};d.bezier=function(a,d,e,c,k,b){a=r(0,1,a,d[0],e[0],c[0],k[0],b);return p(a,d[1],e[1],c[1],k[1])};d.calchandle_curvemap=function(a,d,e,c,k){var b=new Float32Array(3),f=new Float32Array(3),l=new Float32Array(3),m=new Float32Array(3),p=new Float32Array(3),r=new Float32Array(3);n.copy(a[1],f);null==d?(n.copy(e[1],l),b[0]=2*f[0]-l[0],
b[1]=2*f[1]-l[1]):n.copy(d[1],b);null==e?(n.copy(d[1],b),l[0]=2*f[0]-b[0],l[1]=2*f[1]-b[1]):n.copy(e[1],l);n.subtract(f,b,m);n.subtract(l,f,p);d=n.length(m);e=n.length(p);0==d&&(d=1);0==e&&(e=1);if("AUTO"==c||"AUTO"==k)r[0]=p[0]/e+m[0]/d,r[1]=p[1]/e+m[1]/d,b=2.5614*n.length(r),0!=b&&("AUTO"==c&&n.scaleAndAdd(f,r,-(d/b),a[0]),"AUTO"==k&&n.scaleAndAdd(f,r,e/b,a[2]));"VECTOR"==c&&n.scaleAndAdd(f,m,-1/3,a[0]);"VECTOR"==k&&n.scaleAndAdd(f,p,1/3,a[2])};d.correct_bezpart=function(a,d,e,c){var l=[],b=[],
f,k,n;l[0]=a[0]-d[0];l[1]=a[1]-d[1];b[0]=c[0]-e[0];b[1]=c[1]-e[1];n=c[0]-a[0];f=Math.abs(l[0]);k=Math.abs(b[0]);0!=f+k&&f+k>n&&(f=n/(f+k),d[0]=a[0]-f*l[0],d[1]=a[1]-f*l[1],e[0]=c[0]-f*b[0],e[1]=c[1]-f*b[1])}});t.a=e},function(C,t,e){C=e(0);var R=e(4),V=e(66),n=e(35),y=e(43),d=e(1);e=Object(C.a)("config",function(e,t){var k=Object(R.a)(e),r=Object(n.a)(e),p=Object(V.a)(e),u=Object(y.a)(e),a=Object(d.a)(e);t.P_LOW=k.P_LOW;t.P_HIGH=k.P_HIGH;t.P_ULTRA=k.P_ULTRA;t.P_CUSTOM=k.P_CUSTOM;t.P_AUTO=k.P_AUTO;
t.set=k.set;t.get=k.get;t.reset=k.reset;t.reset_limits=k.reset_limits;t.get_std_assets_path=k.get_assets_path;t.get_assets_path=k.get_assets_path;t.apply_quality=function(d){u.is_primary_loaded()?a.error("Cannot change quality profile after a scene is loaded."):(k.set("quality",d),p.get_gl()&&(k.apply_quality(),r.set_hardware_defaults(p.get_gl(),!1)))}});t.a=e},function(C,t,e){C=e(0);var R=e(43),V=e(65);e=Object(C.a)("data",function(e,t){var d=Object(R.a)(e),k=Object(V.a)(e);t.load=d.load;t.unload=
function(e){d.unload(e|0)};t.set_debug_resources_root=d.set_debug_resources_root;t.is_primary_loaded=d.is_primary_loaded;t.is_idle=k.is_finished;t.load_and_add_new=d.load;t.cleanup=t.unload;t.activate_media=d.activate_media;t.prefetch=d.prefetch;t.unfetch=d.unfetch});t.a=e},function(C,t,e){var R=e(32);C=e(0);var V=e(5),n=e(16),y=e(4),d=e(66),k=e(35),I=e(53),A=e(15),r=e(43),p=e(71),u=e(96),a=e(45),B=e(46),l=e(62),c=e(72),m=e(28),b=e(20),f=e(65),T=e(12),fa=e(9),z=e(19),G=e(1),E=e(22),J=e(10),M=e(64),
F=e(23),U=e(34),K=e(11),sa=e(17),v=e(18),Y=e(13),ha=e(6),S=e(2),L=e(3);e=Object(C.a)("debug",function(e,w){function q(a,b,c,d){na.group(ma.subs_label(a),d);for(a=0;a<c.length;a++){var f=c[a],e=f.render;if(e.type==d)for(var g=!1,h=0;h<b.length;h++){for(var l=b[h].bundles,k=0;k<l.length;k++){var m=l[k];if(m.do_render&&m.obj_render==e){"STATIC"==d?na.log_raw(f.origin_name,f):na.log_raw(f.name,f);g=!0;break}}if(g)break}}na.groupEnd()}function t(a){var b={};if(!a)return b;a=a.split("\n");for(var c=0;c<
a.length;c++){var d=a[c];if(-1!=d.search(new RegExp(/^[A-Z.]+ ?/))){var f=d.split(" ")[0];f in b||(b[f]=0);b[f]++}}d=c=a=0;for(f in b)switch(f){case "KIL":case "TEX":case "TXB":case "TXP":case "KIL.F":case "TEX.F":case "TXB.F":case "TXD.F":case "TXL.F":case "TXQ.F":case "TXP.F":c+=b[f];a+=b[f];break;case "ATTRIB":d+=b[f];break;case "ADDRESS":case "PARAM":case "TEMP":case "ALIAS":case "OUTPUT":break;case "END":break;default:a+=b[f]}b.ALL_OPS=a;b.TEX_OPS=c;b.ATTRIBS=d;return b}function D(a,b){var c=
new XMLHttpRequest;c.open("POST",a,!1);c.send(b);if(200==c.status)return c.responseText;na.error(c.responseText);throw"Error POST XHR: "+c.status;}function h(a){a.sort(function(a,b){return b.fstats.ALL_OPS-a.fstats.ALL_OPS});for(var b=0;b<a.length;b++){var c=a[b],d=c.fstats,f=c.vstats,e=ia(c.cshader),e=e.length?"\t\t("+e.join(", ")+")":"\t\t(NA)";na.groupCollapsed("VERT ->","OPS",f.ALL_OPS,"ATT",f.ATTRIBS,"TEX",f.TEX_OPS,"\t\tFRAG ->","OPS",d.ALL_OPS,"TEX",d.TEX_OPS,e);na.groupCollapsed("directives");
for(var g=c.shaders_info.directives.slice().sort(),e=0;e<g.length;e++){var h=g[e];na.log_raw(h[0],h[1])}na.groupEnd();na.groupCollapsed("node elements");g=c.shaders_info.node_elements;for(e=0;e<g.length;e++)na.log_raw(g[e]);na.groupEnd();na.groupCollapsed("vert source");na.log_raw(c.vsrc);na.groupEnd();na.groupCollapsed("vert translated source");na.log_raw(c.vsrc_trans);na.groupEnd();e=["ALL_OPS","TEX_OPS","ATTRIBS"];na.groupCollapsed("vert ops stats");for(var l in f)-1==e.indexOf(l)&&na.log_raw(l,
f[l]);na.groupEnd();na.groupCollapsed("vert assembly");na.log_raw(c.vout);na.groupEnd();na.groupCollapsed("frag source");na.log_raw(c.fsrc);na.groupEnd();na.groupCollapsed("frag translated source");na.log_raw(c.fsrc_trans);na.groupEnd();na.groupCollapsed("frag ops stats");for(l in d)-1==e.indexOf(l)&&na.log_raw(l,d[l]);na.groupEnd();na.groupCollapsed("frag assembly");na.log_raw(c.fout);na.groupEnd();na.groupEnd()}}function ia(a){for(var b=[],c=g.get_all_scenes(),d=0;d<c.length;d++)for(var f=c[d],
e=O.get_scene_objs(f,"MESH",O.DATA_ID_ALL),h=0;h<e.length;h++){var l=wa.get_scene_data(e[h],f);if(l&&l.batches.length)for(var l=l.batches,k=0;k<l.length;k++){var m=l[k];if(m.shader==a)for(var q=0;q<m.material_names.length;q++){var n=m.material_names[q];-1==b.indexOf(n)&&b.push(n)}}}return b}function ra(a,b){var c=function(){Z.push(c);return a.apply(a,arguments)};return c}function C(a,b,c,d,f){if(typeof b!=typeof a)throw"debug.eqv: wrong expected data type";if(a.length!=b.length)throw"debug.eqv: wrong expected vector length";
c=c?c:1E-6;for(var e=0;e<a.length;e++){if("number"!=typeof b[e]||isNaN(b[e]))throw"debug.eqv: wrong expected data type";if("number"!=typeof a[e]||isNaN(a[e]))throw"debug.eqv: wrong result data type";if(b[e]>a[e]+c||b[e]<a[e]-c)throw"debug.eqv: wrong result";}P(d,f,"eqv")}function P(a,b,c){a=a||"";b=b||"";if(rb){if(""==a)throw"debug."+c+': no error is expected, but got "'+Qa+'"';if(Qa!=a)throw"debug."+c+': error "'+a+'" is expected, but got "'+Qa+'"';}else if(""!=a)throw"debug."+c+': error "'+a+'" is expected, but got nothing';
if($a){if(""==b)throw"debug."+c+': no warning is expected, but got "'+Oa+'"';if(Oa!=b)throw"debug."+c+': warning "'+b+'" is expected, but got "'+Oa+'"';}else if(""!=b)throw"debug."+c+': warning "'+b+'" is expected, but got nothing';rb=$a=!1}function oa(){Na&&(O.obj_switch_cleanup_flags(Na,!1,!1,!1),ta.prepare_object_unloading(Na),O.obj_switch_cleanup_flags(Na,!0,!0,!0),O.remove_object(Na),Na=null)}var Q=Object(V.a)(e),da=Object(n.a)(e),ja=Object(y.a)(e),va=Object(k.a)(e),Ga=Object(I.a)(e),ba=Object(A.a)(e),
Ea=Object(d.a)(e),ta=Object(r.a)(e),X=Object(p.a)(e),pa=Object(u.a)(e),ka=Object(a.a)(e),Ca=Object(B.a)(e),Ma=Object(l.a)(e),Aa=Object(c.a)(e),xa=Object(m.a)(e),ga=Object(b.a)(e),ya=Object(f.a)(e),O=Object(T.a)(e),wa=Object(fa.a)(e),qa=Object(z.a)(e),na=Object(G.a)(e),Ja=Object(E.a)(e),g=Object(J.a)(e),Da=Object(M.a)(e),Ba=Object(F.a)(e),Ta=Object(U.a)(e),ma=Object(K.a)(e),Ka=Object(v.a)(e),fb=Object(sa.a)(e),La=Object(Y.a)(e),Xa=ha.b(),Wa=new Float32Array(2),W=L.create(),Ia=L.create(),Ua=L.create(),
Na=null,Va=ja.defaults,Z=[],Oa="",Qa="",$a=!1,rb=!1,ob=!0,gb=new Uint8Array(4);w.DV_NONE=Ca.DV_NONE;w.DV_OPAQUE_WIREFRAME=Ca.DV_OPAQUE_WIREFRAME;w.DV_TRANSPARENT_WIREFRAME=Ca.DV_TRANSPARENT_WIREFRAME;w.DV_FRONT_BACK_VIEW=Ca.DV_FRONT_BACK_VIEW;w.DV_BOUNDINGS=Ca.DV_BOUNDINGS;w.DV_CLUSTERS_VIEW=Ca.DV_CLUSTERS_VIEW;w.DV_BATCHES_VIEW=Ca.DV_BATCHES_VIEW;w.DV_RENDER_TIME=Ca.DV_RENDER_TIME;w.physics_stats=function(){qa.debug_workers()};w.physics_id=function(a){na.log("O",qa.find_obj_by_body_id(a));var b=
qa.get_active_scene();if(b)for(var b=b._physics.bundles,c=0;c<b.length;c++){var d=b[c];d.physics.body_id==a&&na.log("B",d)}else na.error("No active physics scene.")};w.visible_objects=function(){for(var a=g.get_active(),b=O.get_scene_objs(a,"MESH",O.DATA_ID_ALL),a=g.subs_array(a,[ma.MAIN_OPAQUE,ma.MAIN_BLEND,ma.MAIN_GLOW]),c=0;c<a.length;c++){var d=a[c],f=d.draw_data;f.length&&(q(d,f,b,"DYNAMIC"),q(d,f,b,"STATIC"))}};w.object_info=function(a){for(var b=g.get_active(),c=O.get_scene_objs(b,"MESH",O.DATA_ID_ALL),
d=0;d<c.length;d++){var f=c[d];if(f.name==a){na.log("Object",f);for(var e=g.get_all_subscenes(b),h=0;h<e.length;h++){for(var l=e[h],k=[],m=l.draw_data,q=0;q<m.length;q++)for(var n=m[q].bundles,p=0;p<n.length;p++)n[p].obj_render==f.render&&k.push(n[p]);na.log("Subscene "+l.type,k)}}}};w.objects_stat=function(){var a=g.get_active();na.log("Armatures: "+O.get_scene_objs(a,"ARMATURE",O.DATA_ID_ALL).length);na.log("Cameras: "+O.get_scene_objs(a,"CAMERA",O.DATA_ID_ALL).length);na.log("Curves: "+O.get_scene_objs(a,
"CURVE",O.DATA_ID_ALL).length);na.log("Empties: "+O.get_scene_objs(a,"EMPTY",O.DATA_ID_ALL).length);na.log("Lamps: "+O.get_scene_objs(a,"LAMP",O.DATA_ID_ALL).length);na.log("Meshes: "+O.get_scene_objs(a,"MESH",O.DATA_ID_ALL).length);na.log("Speakers: "+O.get_scene_objs(a,"SPEAKER",O.DATA_ID_ALL).length)};w.num_vertices=function(){for(var a=0,b=g.get_active(),b=g.subs_array(b,[ma.MAIN_OPAQUE,ma.MAIN_BLEND,ma.MAIN_GLOW]),c=0;c<b.length;c++)for(var d=b[c].draw_data,f=0;f<d.length;f++)for(var e=d[f].bundles,
h=0;h<e.length;h++){var l=e[h].batch;l&&(a+=l.num_vertices)}return a};w.num_triangles=function(){for(var a=0,b=g.get_active(),b=g.subs_array(b,[ma.MAIN_OPAQUE,ma.MAIN_BLEND,ma.MAIN_GLOW]),c=0;c<b.length;c++)for(var d=b[c].draw_data,f=0;f<d.length;f++)for(var e=d[f].bundles,h=0;h<e.length;h++){var l=e[h].batch;l&&(a+=l.num_triangles)}return a};w.num_draw_calls=function(){for(var a=g.get_active(),b=g.subs_array(a,[ma.MAIN_OPAQUE,ma.MAIN_BLEND,ma.MAIN_GLOW,ma.MAIN_PLANE_REFLECT,ma.MAIN_PLANE_REFLECT_BLEND]),
c=0,d=0;d<b.length;d++)for(var f=b[d],f=f.draw_data,e=0;e<f.length;e++)c+=f[e].bundles.length;a=g.subs_array(a,[ma.MAIN_CUBE_REFLECT,ma.MAIN_CUBE_REFLECT_BLEND]);for(d=0;d<a.length;d++)for(f=a[d],f=f.draw_data,e=0;e<f.length;e++)c+=6*f[e].bundles.length;return c};w.num_shaders=function(){var a=Ta.get_compiled_shaders();return S._8(a)};w.geometry_stats=function(){for(var a=g.get_active(),b=g.get_all_subscenes(a),a={},c=0;c<b.length;c++){var d=b[c];if(d.type!=ma.SINK&&d.type!=ma.DEBUG_VIEW)for(var f=
d.draw_data,e=0;e<f.length;e++)for(var h=f[e].bundles,l=0;l<h.length;l++){var k=h[l].batch,m=h[l].obj_render;k&&(d.type!=ma.COLOR_PICKING&&d.type!=ma.OUTLINE_MASK||m.origin_selectable||m.origin_outlining)&&(a[k.id]=k)}}var c=b=0,q;for(q in a)d=a[q].bufs_data,d.debug_ibo_bytes&&(c+=d.debug_ibo_bytes/1048576),b+=d.debug_vbo_bytes/1048576;return{vbo_memory:b,ibo_memory:c}};w.num_textures=function(){for(var a=[],b=0,c=g.get_active(),c=g.subs_array(c,[ma.MAIN_OPAQUE,ma.MAIN_BLEND,ma.MAIN_GLOW]),d=0;d<
c.length;d++)for(var f=c[d].draw_data,e=0;e<f.length;e++)for(var h=f[e].bundles,l=0;l<h.length;l++){var k=h[l].batch;if(k)for(var k=k.textures,m=0;m<k.length;m++){var q=k[m];if("IMAGE"===q.source||"ENVIRONMENT_MAP"===q.source){var n=q.w_texture;-1===a.indexOf(n)&&(a.push(n),q=q.width*q.height*4/1048576/q.compress_ratio,q*=1.3333,b+=q)}}}return{number:a.length,memory:b}};w.num_render_targets=function(){for(var a=[],b=0,c=g.get_active(),c=g.get_all_subscenes(c),d=0;d<c.length;d++){var f=c[d];if(f.type!=
ma.SINK){var e=f.camera,h=[e.color_attachment,e.depth_attachment];h.push.apply(h,f.textures_internal);for(f=0;f<h.length;f++){var l=h[f];fb.is_texture(l)&&-1==a.indexOf(l)&&(a.push(l),b+=e.width*e.height*fb.get_texture_texel_size(l))}}}return{number:a.length,memory:b/1024/1024}};w.make_camera_frustum_shot=function(){var a=g.get_active();(a=g.get_subs(a,ma.MAIN_OPAQUE))&&g.make_frustum_shot(a.camera,a,[1,1,0])};w.make_light_frustum_shot=function(){var a=g.get_active(),b=g.get_subs(a,ma.MAIN_OPAQUE),
a=g.subs_array(a,[ma.SHADOW_CAST]);if(b)for(var c=0;c<a.length;c++){var d=a[c],f;switch(c){case 0:f=[1,0,0];break;case 1:f=[0,1,0];break;case 2:f=[0,0,1];break;default:f=[1,0,1]}g.make_frustum_shot(d.camera,b,f)}};w.scenegraph_to_dot=function(){for(var a=g.get_all_scenes(),b=0;b<a.length;b++){var c=g.get_graph(a[b]);na.log("\n"+Da.debug_convert_to_dot(c))}};w.loading_graph_to_dot=function(a){na.log("\n"+ya.graph_to_dot(a|0))};w.controls_info=Ga.debug;w.object_distance=function(a,b){var c=ha.j(a.render.world_tsr,
W),d=ha.j(b.render.world_tsr,Ia);return L.dist(c,d)};w.msg=function(){Ma.msg.apply(Ma,arguments)};w.fbmsg=function(){Ma.fbmsg.apply(Ma,arguments)};w.print_telemetry=function(){Ma.print_telemetry.apply(Ma,arguments)};w.plot_telemetry=function(){Ma.plot_telemetry.apply(Ma,arguments)};w.fbres=function(a,b){b||(b=16);var c=function(){Ma.fbmsg("FBRES",a());setTimeout(c,b)};c()};w.assert_constants=function(){var a=new Float32Array(3),b=new Float32Array([0,0,0,1]),c=new Float32Array([1,0,0]),d=new Float32Array([0,
1,0]),f=new Float32Array([0,0,1]),e=new Float32Array([-1,0,0]),g=new Float32Array([0,-1,0]),h=new Float32Array([0,0,-1]);if(!S.P(a,S.m))throw"Wrong VEC3_IDENT";if(!S.P(b,S.k))throw"Wrong QUAT4_IDENT";if(!S.P(c,S.d))throw"Wrong AXIS_X";if(!S.P(d,S.e))throw"Wrong AXIS_Y";if(!S.P(f,S.f))throw"Wrong AXIS_Z";if(!S.P(e,S.a))throw"Wrong AXIS_MX";if(!S.P(g,S.b))throw"Wrong AXIS_MY";if(!S.P(h,S.c))throw"Wrong AXIS_MZ";};w.mute_music=function(){for(var a=Ba.get_speaker_objects(),b=0;b<a.length;b++){var c=a[b];
"BACKGROUND_MUSIC"==Ba.get_spk_behavior(c)&&Ba.mute(c,!0)}};w.check_finite=function(a){return ka.finite(a)};w.set_debug_params=function(a){var b=g.get_active(),b=g.subs_array(b,[ma.DEBUG_VIEW]);if(b.length)for(var c=0;c<b.length;c++){var d=b[c];if("number"==typeof a.debug_view_mode)switch(a.debug_view_mode){case Ca.DV_NONE:case Ca.DV_OPAQUE_WIREFRAME:case Ca.DV_TRANSPARENT_WIREFRAME:case Ca.DV_FRONT_BACK_VIEW:case Ca.DV_BOUNDINGS:case Ca.DV_CLUSTERS_VIEW:case Ca.DV_BATCHES_VIEW:case Ca.DV_RENDER_TIME:g.set_debug_view_mode(d,
a.debug_view_mode);break;default:na.error("set_debug_params(): Wrong debug view mode")}"number"==typeof a.debug_colors_seed&&g.set_debug_colors_seed(d,a.debug_colors_seed);"number"==typeof a.render_time_threshold&&g.set_render_time_threshold(d,a.render_time_threshold);"object"==typeof a.wireframe_edge_color&&g.set_wireframe_edge_color(d,S._1(a.wireframe_edge_color))}else na.error("Debugging is not available on the scene.")};w.get_error_quantity=function(){return na.get_error_count()};w.get_warning_quantity=
function(){return na.get_warning_count()};w.clear_errors_warnings=function(){return na.clear_errors_warnings()};w.analyze_shaders=function(a){var b=Ta.get_compiled_shaders(),c=0,d;for(d in b)a&&-1===d.indexOf(a)||c++;var c="of "+c+" analyzing...",f={};for(d in b)if(!a||-1!==d.indexOf(a)){var e=b[d],g;g=e.vshader;var l=e.fshader,k=xa.get_debug_shaders();if(k){var m=k.getTranslatedShaderSource(g),k=k.getTranslatedShaderSource(l);if(va.detect_mobile())var m=m.replace("#version","#version 300 //"),k=
k.replace("#version","#version 300 //"),q=D("/analyze_shader/vert_gles",m),n=D("/analyze_shader/frag_gles",k);else m=m.replace("#version","#version 400 //"),k=k.replace("#version","#version 400 //"),q=D("/analyze_shader/vert",m),n=D("/analyze_shader/frag",k);var p=t(q),r=t(n);g={vsrc:Ea.get_gl().getShaderSource(g),vsrc_trans:m,vout:q,vstats:p,fsrc:Ea.get_gl().getShaderSource(l),fsrc_trans:k,fout:n,fstats:r}}else na.warn("WEBGL_debug_shaders extension not found"),g=void 0;if(g){var l=e.shaders_info,
w=l.vert+" + "+l.frag;g.cshader=e;g.shaders_info=l;e=f[w]=f[w]||[];e.push(g);na.log_raw(c)}}for(w in f)na.group("%c"+w,"color: #800"),e=f[w],h(e),na.groupEnd()};w.fake_load=function(a,b,c,d,f){(a=a||null)||Q.panic("Stage load callback is undefined");b=b||5E3;c=c||0;d=d||100;100<d&&Q.panic("Max percentage must be less than 100");0>c&&Q.panic("Min percentage must be greater than 0");c>d&&Q.panic("Max percentage must be greater than min percentage");var e=Ka.animate(c,d,b,function(b){b=b.toFixed();a(b);
100==b&&(Ka.clear_animation(e),f&&f())})};w.test_performance=function(a){if(Ta.check_shaders_loaded())if(xa.get_disjoint_timer_query()){var b=Va.gl_debug;Va.gl_debug=!0;var c=Da.create_performance_graph();g.generate_auxiliary_batches(null,c);for(var d=Da.find_subs(c,ma.PERFORMANCE),f=d.camera,c=0;5>c;c++)Ja.draw(d);Va.gl_debug=b;window.setTimeout(function(){Aa.process_timer_queries(d);var b=d.debug_render_time;a(b,f.width*f.height*40/(b/1E3)/Math.pow(10,9))},100)}else a(0,0);else window.setTimeout(function(){w.test_performance(a)},
100)};w.calc_vbo_garbage_byte_size=X.calc_vbo_garbage_byte_size;w.show_vbo_garbage_info=X.show_vbo_garbage_info;w.print_batches_stat=function(){pa.print_batches_stat()};w.start_debug=function(a){Z=[];ob=!0;"string"===typeof a&&(a=R.a.require(a));for(var b in a)"function"===typeof a[b]&&(a[b]=ra(a[b],b))};w.check_debug_result=function(){return ob};w.test=function(a,b){var c=na.error,d=na.error_once,f=na.warn;na.error=na.error_once=function(){Qa=na.compose_args_prefix(arguments,"B4W ERROR").join(" ");
rb=!0};na.warn=function(){Oa=na.compose_args_prefix(arguments,"B4W WARN").join(" ");$a=!0};rb=$a=!1;try{b();var e=!0}catch(ib){ob=!1,console.error('Test "'+a+'" failed with exception: "'+ib+'"'),rb=$a=e=!1}na.error=c;na.error_once=d;na.warn=f;return e};w.pix=function(a){var b=ba.get_viewport_width(),c=ba.get_viewport_height(),d=b/2,f=c/2;ba.resize(b,c,!1);b=g.get_active()._render.graph;(c=Da.find_on_screen(b))||Q.panic("Couldn't find onscreen subscene");b=c.camera;d=ba.canvas_to_viewport_coords(d,
f,Wa,c.camera);d[1]=b.height-d[1];d=Ja.read_pixels(b.framebuffer,d[0],d[1],1,1,gb);C(a,d,1)};w.eqs=function(a,b,c,d){if(JSON.stringify(a)!=JSON.stringify(b))throw"debug.eqs: wrong result";P(c,d,"eqs")};w.eqv=C;w.eqf=function(a,b,c,d,f){if("number"!=typeof b||isNaN(b))throw"debug.eqf: wrong expected data type";if("number"!=typeof a||isNaN(a))throw"debug.eqf: wrong result data type";c=c?c:1E-6;if(b>a+c||b<a-c)throw"debug.eqf: wrong result";P(d,f,"eqf")};w.eq=function(a,b,c,d){if(a!==b)throw"debug.eq: wrong result";
P(c,d,"eq")};w.ok=function(a,b,c){if(!a)throw"debug.ok: wrong result";P(b,c,"ok")};w.stat=function(a){var b=[];"string"===typeof a&&(a=R.a.require(a));for(var c in a)-1==Z.indexOf(a[c])&&"function"===typeof a[c]&&b.push(c);if(b.length){na.groupCollapsed(b.length+" function(s) not tested.");for(a=0;a<b.length;a++)na.log_raw(b[a]);na.groupEnd()}else na.group("All functions were tested.")};w.show_normals=function(a,b,c,d){oa();b=da.find_batch_material(a,b,"MAIN");if(!ga.has_dyn_geom(a)||!b)return na.error("Normals are not avaliable for the dynamic object:",
a.name),!1;var f=b.bufs_data;if(!(f&&f.pointers&&f.pointers.a_position&&f.pointers.a_tbn))return na.error("Normals are not avaliable for the object:",a.name),!1;b=ga.extract_array_float(f,"a_position");f=ga.extract_array_float(f,"a_normal");a=La.get_tsr(a,Xa);var e=ha.i(a,Ua),e=L.inverse(e,Ua),g=L.multiply(e,e,Ua);Na=O.create_line("normal_line");for(var e=new Float32Array(2*b.length),h=0;h<b.length;h+=3){var l=W;l[0]=b[h+0];l[1]=b[h+1];l[2]=b[h+2];var k=ha.D(l,a,Ia);e[2*h+0]=k[0];e[2*h+1]=k[1];e[2*
h+2]=k[2];k=f.subarray(h,h+3);k=L.multiply(k,g,Ia);k=L.normalize(k,k);k=L.scale(k,c,Ia);l=L.add(l,k,Ia);l=ha.D(l,a,Ia);e[2*h+3]=l[0];e[2*h+4]=l[1];e[2*h+5]=l[2]}c=da.get_first_batch(Na);ga.draw_line(c,e,!0);Ja.assign_attribute_setters(c);c.diffuse_color.set([1,1,1,1]);c.line_width=d};w.hide_normals=oa});t.a=e},function(C,t,e){C=e(0);var R=e(15);e=Object(C.a)("__main",function(e,n){function t(a,e,l){var c=d.get_canvas();if(c.toBlob)c.toBlob(a,e,l);else{l=atob(c.toDataURL(e,l).split(",")[1]);for(var c=
new Uint8Array(l.length),k=0;k<l.length;k++)c[k]=l.charCodeAt(k);a(new Blob([c],{type:e||"image/png"}))}}var d=Object(R.a)(e),k=null,I="image/png",A=1,r="",p=!1,u=!1;n.canvas_data_url=function(a,d,e,c){p=u="undefined"===typeof c?c:!0;k=a;I=d||I;A=e||A};n.frame=function(a,d){var e=k;e&&(p&&r&&URL.revokeObjectURL(r),t(function(a){navigator.msSaveOrOpenBlob?e(a):(r=URL.createObjectURL(a),e(r))},I,A),k=null,I="image/png",A=1)}});t.a=e},function(C,t,e){C=e(0);var R=e(21),V=e(6),n=e(1);e=Object(C.a)("tsr",
function(e,d){var k=Object(n.a)(e);d.create=V.b;d.from_values=V.e;d.copy=V.a;d.identity=V.m;d.set_sep=V.t;d.set_trans=V.v;d.set_scale=V.s;d.set_transcale=function(d,e){k.error_once("set_transcale is deprecated, use the tsr.set_trans and tsr.set_scale functions instead.");return V.w(d,e)};d.set_quat=V.r;d.get_trans_view=function(d){k.error_once("get_trans_view is deprecated, use the tsr.get_trans functions.");return V.k(d)};d.get_trans=V.j;d.get_scale=V.i;d.get_quat_view=function(d){k.error_once("get_quat_view is deprecated, use the tsr.get_quat functions.");
return V.h(d)};d.get_quat=V.g;d.invert=V.p;d.to_mat4=function(d,e){e||(e=R.create());V.x(d,e);return e};d.from_mat4=V.d;d.multiply=V.q;d.transform_vec3=V.D;d.transform_vec3_inv=V.E;d.transform_vectors=V.F;d.transform_dir_vectors=V.z;d.transform_dir_vec3=V.y;d.transform_tangents=V.C;d.translate=V.G;d.interpolate=function(d,e,k,n){n||(n=V.b());V.o(d,e,k,n);return n}});t.a=e},function(C,t,e){C=e(0);var R=e(33),V=e(24),n=e(49),y=e(8),d=e(29),k=e(50),I=e(41),A=e(26),r=e(3);e=Object(C.a)("hmd",function(e,
u){function a(){c.remove_sensor_manifold(null,"VR_CONTROLLERS")}function p(a,d){function e(d,f,e){if(0<e&&(e=b.get_active_camera())&&l.is_eye_camera(e)){var h=c.get_sensor_payload(d,f,1);d=c.get_sensor_payload(d,f,2);d=r.add(d,L,F);t.set_translation_v(e,d);if(h)if(1==a){var h=y.multiply(S,h,ha),k=r.transformQuat(C.AXIS_MY,h,F);l.set_vertical_axis(e,k);t.set_rotation_v(e,h)}else if(2==a||3==a){d=t.get_rotation(e,v);d=y.invert(d,v);f=y.multiply(z,d,v);d=l.get_vertical_axis(e,F);Math.abs(d[2])<Math.PI/
4?k=r.cross(d,C.AXIS_MY,U):Math.abs(d[1])<Math.PI/4&&(k=r.cross(d,C.AXIS_Z,U));r.normalize(k,k);f=r.transformQuat(k,f,K);var m=r.dot(d,f);f=r.scaleAndAdd(f,d,-m,K);r.normalize(f,f);d=r.cross(d,k,F);k=Math.acos(C.clamp(r.dot(k,f),0,1));d=C.sign(r.dot(f,d));G+=k*d;k=y.setAxisAngle(C.AXIS_Z,-G,v);3!=a&&(d=C.quat_project(h,C.AXIS_MZ,C.AXIS_Z,C.AXIS_Y,Y),d=y.invert(d,Y),h=y.multiply(d,h,Y));h=y.multiply(k,h,sa);k=r.transformQuat(C.AXIS_MY,h,F);l.set_vertical_axis(e,k);t.set_rotation_v(e,h);y.copy(h,z)}}}
if(d){var k=b.get_active_camera();k&&f.request_split_screen(function(){l.is_eye_camera(k)||(E=l.is_target_camera(k),J=l.is_hover_camera(k),M=l.is_static_camera(k),l.eye_setup(k));var a=c.create_elapsed_sensor(),b=c.create_hmd_position_sensor();z=t.get_rotation(k,z);c.create_sensor_manifold(null,"HMD_ROTATE_CAMERA",c.CT_CONTINUOUS,[a,d,b],null,e)})}}var l=Object(R.a)(e),c=Object(V.a)(e),m=Object(n.a)(e),b=Object(d.a)(e),f=Object(k.a)(e),t=Object(I.a)(e),C=Object(A.a)(e),z=y.create(),G=0,E=!1,J=!1,
M=!1,F=r.create(),U=r.create(),K=r.create(),sa=y.create(),v=y.create(),Y=y.create(),ha=y.create(),S=y.create(),L=r.create(),q={pivot:r.create()};u.HMD_NONE_MOUSE_ALL_AXES=0;u.HMD_ALL_AXES_MOUSE_NONE=1;u.HMD_ROLL_PITCH_MOUSE_YAW=2;u.HMD_ALL_AXES_MOUSE_YAW=3;u.enable_hmd=function(a){var b;if(b=m.get_device_by_type_element(m.DEVICE_HMD))b=m.get_value_param(b,m.HMD_WEBVR_TYPE)&(m.HMD_WEBVR_MOBILE|m.HMD_WEBVR_DESKTOP|m.HMD_WEBVR1)?c.create_hmd_quat_sensor():c.create_gyro_quat_sensor(),p(a,b)};u.check_browser_support=
function(){return!!m.can_use_device(m.DEVICE_HMD)};u.enable_controllers=function(b,d){a();if(b||d){var f=m.get_vr_controller_id(0),e=c.create_gamepad_position_sensor(f),f=c.create_gamepad_orientation_sensor(f),h=m.get_vr_controller_id(1),l=c.create_gamepad_position_sensor(h),h=c.create_gamepad_orientation_sensor(h);c.create_sensor_manifold(null,"VR_CONTROLLERS",c.CT_CONTINUOUS,[e,l,f,h],null,function(a,f,e){if(b){e=c.get_sensor_payload(a,f,0);var h=c.get_sensor_payload(a,f,2);r.add(L,e,e);t.set_translation_v(b,
e);t.set_rotation_v(b,h)}d&&(e=c.get_sensor_payload(a,f,1),a=c.get_sensor_payload(a,f,3),r.add(L,e,e),t.set_translation_v(d,e),t.set_rotation_v(d,a))})}};u.disable_controllers=a;u.disable_hmd=function(){if(c.check_sensor_manifold(null,"HMD_ROTATE_CAMERA")){c.remove_sensor_manifold(null,"HMD_ROTATE_CAMERA");f.exit_split_screen();var a=b.get_active_camera();E?l.target_setup(a,q):J?l.hover_setup(a,q):M&&l.static_setup(a,q);l.set_vertical_axis(a,C.AXIS_Z);var d=t.get_rotation(a,sa);t.set_rotation_v(a,
d)}};u.set_rotate_quat=function(a){y.copy(a,S)};u.get_rotate_quat=function(a){y.copy(S,a);return a};u.set_position=function(a){y.copy(a,L)};u.get_position=function(a){y.copy(L,a);return a}});t.a=e},function(C,t,e){C=e(0);var R=e(9),V=e(10),n=e(23),y=e(1);e=Object(C.a)("sfx",function(d,e){var k=Object(R.a)(d),t=Object(V.a)(d),r=Object(n.a)(d),p=Object(y.a)(d);e.play=function(d,a,e){r.play(d,a||0,e||0)};e.play_def=function(d){r.play_def(d)};e.is_playing=function(d){return r.is_playing(d)};e.stop=function(d){r.stop(d)};
e.pause=function(d){r.speaker_pause(d)};e.resume=function(d){r.speaker_resume(d)};e.loop_stop=function(d,a,e){r.loop_stop(d,a||0,e||!1)};e.playrate=function(d,a){r.playrate(d,a)};e.get_playrate=function(d){return r.get_playrate(d)};e.cyclic=function(d,a){r.cyclic(d,a)};e.is_cyclic=function(d){return r.is_cyclic(d)};e.listener_reset_speed=function(d,a){r.listener_stride()};e.listener_stride=function(){r.listener_stride()};e.speaker_reset_speed=function(d,a,e){r.speaker_stride(d)};e.speaker_stride=
function(d){r.speaker_stride(d)};e.get_volume=function(d){return d&&"object"===typeof d?r.get_volume(d):r.get_master_volume()};e.set_volume=function(d,a){d&&"object"===typeof d?r.set_volume(d,a):r.set_master_volume(a)};e.mute=function(d,a){d&&"object"===typeof d?r.mute(d,a):r.mute_master(a)};e.is_muted=function(d){return d&&"object"===typeof d?r.is_muted(d):r.is_master_muted()};e.get_speaker_objects=function(){return r.get_speaker_objects().slice(0)};e.check_active_speakers=r.check_active_speakers;
e.set_compressor_params=function(d){r.set_compressor_params(t.get_active(),d)};e.get_compressor_params=function(){return r.get_compressor_params(t.get_active())};e.duck=function(d,a,e){d&&"object"===typeof d?r.duck(d,a,e):r.duck_master(a,e)};e.unduck=function(d){d&&"object"===typeof d?r.unduck(d):r.unduck_master()};e.apply_playlist=r.apply_playlist;e.clear_playlist=r.clear_playlist;e.detect_audio_container=r.detect_audio_container;e.detect_video_container=r.detect_video_container;e.set_positional_params=
r.set_positional_params;e.get_positional_params=r.get_positional_params;e.set_filter_params=r.set_filter_params;e.get_filter_params=r.get_filter_params;e.get_filter_freq_response=r.get_filter_freq_response;e.get_duration=function(d){return d&&k.is_speaker(d)?r.get_duration(d):(p.error('Object "'+(d?d.name:void 0)+'" is not a valid speaker'),0)}});t.a=e},function(C,t,e){C=e(0);var R=e(38),V=e(9),n=e(1);e=Object(C.a)("animation",function(e,d){var k=Object(R.a)(e),t=Object(V.a)(e),A=Object(n.a)(e);d.SLOT_0=
k.SLOT_0;d.SLOT_1=k.SLOT_1;d.SLOT_2=k.SLOT_2;d.SLOT_3=k.SLOT_3;d.SLOT_4=k.SLOT_4;d.SLOT_5=k.SLOT_5;d.SLOT_6=k.SLOT_6;d.SLOT_7=k.SLOT_7;d.SLOT_ALL=k.SLOT_ALL;d.OBJ_ANIM_TYPE_NONE=k.OBJ_ANIM_TYPE_NONE;d.OBJ_ANIM_TYPE_ARMATURE=k.OBJ_ANIM_TYPE_ARMATURE;d.OBJ_ANIM_TYPE_OBJECT=k.OBJ_ANIM_TYPE_OBJECT;d.OBJ_ANIM_TYPE_VERTEX=k.OBJ_ANIM_TYPE_VERTEX;d.OBJ_ANIM_TYPE_SOUND=k.OBJ_ANIM_TYPE_SOUND;d.OBJ_ANIM_TYPE_PARTICLES=k.OBJ_ANIM_TYPE_PARTICLES;d.OBJ_ANIM_TYPE_MATERIAL=k.OBJ_ANIM_TYPE_MATERIAL;d.OBJ_ANIM_TYPE_STATIC=
k.OBJ_ANIM_TYPE_STATIC;d.AB_CYCLIC=k.AB_CYCLIC;d.AB_FINISH_RESET=k.AB_FINISH_RESET;d.AB_FINISH_STOP=k.AB_FINISH_STOP;d.is_animated=function(d){return k.is_animated(d)};d.get_anim_names=function(d){return k.obj_is_animatable(d)?k.get_anim_names(d):[]};d.get_current_anim_name=function(d,e){if(!k.is_animated(d))return null;e=e||k.SLOT_0;return k.get_anim_by_slot_num(d,e)};d.apply=function(d,e,n){if(n>k.SLOT_7)A.error("Can't apply animation to slot "+n+' for object "'+d.name+'". Object can have maximum of 8 animation slots');
else{n=n||k.SLOT_0;if(k.is_animated(d)){var a=k.get_slot_num_by_anim(d,e);if(-1!=a&&a!=n){A.error('Animation "'+e+'" is already applied to object "'+d.name+'" (slot "'+a+'").');return}}k.validate_action_by_name(d,e)?k.apply(d,null,e,n):A.error('No fcurves in action "'+e+'"')}};d.apply_ext=function(d,e,n){if(n>k.SLOT_7)A.error("Can't apply animation to slot "+n+' for object "'+d.name+'". Object can have maximum of 8 animation slots');else{n=n||k.SLOT_0;var a=e[0];k.validate_action_by_name(d,a)?(e=
e.slice(1),k.apply(d,e,a,n)):A.error('No fcurves in action "'+a+'"')}};d.remove=function(d){k.remove(d)};d.remove_slot_animation=function(d,e){k.is_animated(d)&&(e=e||k.SLOT_0,k.remove_slot_animation(d,e))};d.apply_def=function(d){k.apply_def(d)};d.play=function(d,e,n){k.is_animated(d)?(n=n||k.SLOT_0,k.play(d,e,n),k.update_object_animation(d,0,n,!0)):A.error('Object "'+d.name+'" has no applied animation')};d.stop=function(d,e){k.is_animated(d)&&(e=e||k.SLOT_0,k.stop(d,e))};d.is_play=function(d,e){if(!k.is_animated(d))return!1;
e=e||k.SLOT_0;return k.is_play(d,e)};d.set_frame=function(d,e,n){k.is_animated(d)&&(n=n||k.SLOT_0,k.set_frame(d,e,n))};d.set_first_frame=function(d,e){k.is_animated(d)&&k.set_first_frame(d,e)};d.set_last_frame=function(d,e){if(k.is_animated(d)){e=e||k.SLOT_0;var n=k.get_anim_start_frame(d,e),a=k.get_anim_length(d,e);k.set_frame(d,n+a-k.LAST_FRAME_EPSILON,e)}};d.get_frame=function(d,e){if(!k.is_animated(d))return 0;e=e||k.SLOT_0;return k.get_current_frame_float(d,e)};d.set_speed=function(d,e,n){k.is_animated(d)&&
(n=n||k.SLOT_0,k.set_speed(d,e||1,n))};d.get_speed=function(d,e){if(!k.is_animated(d))return 0;e=e||k.SLOT_0;return d.anim_slots[e]?k.get_speed(d,e):0};d.get_anim_start_frame=function(d,e){return k.is_animated(d)&&(e=e||k.SLOT_0,d.anim_slots[e])?k.get_anim_start_frame(d,e):-1};d.get_anim_length=function(d,e){return k.is_animated(d)&&(e=e||k.SLOT_0,d.anim_slots[e])?k.get_anim_length(d,e):-1};d.set_behavior=function(d,e,n){k.is_animated(d)&&(n=n||k.SLOT_0,k.set_behavior(d,e,n))};d.get_behavior=function(d,
e){if(!k.is_animated(d))return null;e=e||k.SLOT_0;return k.get_behavior(d,e)};d.apply_smoothing=function(d,e,n,a){a=a||k.SLOT_0;k.is_animated(d)&&k.apply_smoothing(d,e,n,a)};d.frame_to_sec=function(d){return k.frame_to_sec(d)};d.get_slot_num_by_anim=function(d,e){return k.is_animated(d)&&e?k.get_slot_num_by_anim(d,e):-1};d.get_anim_type=function(d,e){return k.is_animated(d)?k.get_anim_type(d,e):null};d.apply_to_first_empty_slot=function(d,e){return k.apply_to_first_empty_slot(d,e)};d.get_skel_mix_factor=
function(d){return d.render.anim_mix_factor};d.set_skel_mix_factor=function(d,e,n,a){t.is_armature(d)?(e=Math.min(Math.max(e,0),1),d.render.anim_mix_factor!=e&&k.set_skel_mix_factor(d,e,n||0,a||null)):A.error("Can't blend animation. Object \""+d.name+'" is not armature')};d.set_skeletal_slots=function(d,e,k,a){e=void 0==e?-1:e;k=void 0==e?-1:k;var n=d.render.blend_skel_slots;0<=e&&(n[0]=e);0<=k&&(n[1]=k);d.render.anim_mix_factor=a||0};d.get_first_skeletal_slot=function(d){return d.render.blend_skel_slots[0]};
d.get_second_skeletal_slot=function(d){return d.render.blend_skel_slots[1]};d.mix_from_cur_pos=function(d,e,n,a){k.mix_from_cur_pos(d,e,n||0,a||null)}});t.a=e},function(C,t,e){C.exports=e(85)},function(C,t,e){function R(a){G.update_preloader(a)}function V(a,c){navigator.mediaDevices?navigator.mediaDevices.enumerateDevices().then(d)["catch"](k):k(Error("WebRTC: It seems WebRTC is not supported on your device."));document.querySelector(".control").style.display=F.is_ie11()?"block":"grid";if(c){l.enable_camera_controls();
y();ja={front:J.get_object_by_name("orbits_front"),back:J.get_object_by_name("orbits_back"),start_scale:1,start_time:-Infinity};n();var f=b.create_mouse_click_sensor(),e=b.create_touch_click_sensor(),h=b.create_timeline_sensor();b.create_sensor_manifold(null,"TRIG_ANIMATION",b.CT_SHOT,[f,e,h],function(a){return a[0]||a[1]},function(a,c,d){var f=b.get_sensor_value(a,c,0),e=b.get_sensor_value(a,c,1);d=b.get_sensor_value(a,c,2);if(f||e)if(a=f?b.get_sensor_payload(a,c,0):b.get_sensor_payload(a,c,1),a=
m.client_to_canvas_coords(a.coords[0],a.coords[1],sa),a=J.pick_object(a[0],a[1])){a:{for(c=0;c<oa.length;c++)if(f=oa[c],f.geom===a){c=f;break a}c=null}if(c)for(Q=c.focused?!1:!0,da.start_time=d,c=M.get_translation_rel(da.geom,v),da.start_trans_length=U.length(c),ja.start_time=d,ja.start_scale=M.get_scale(ja.front),c=0;c<oa.length;c++)f=oa[c],e=M.get_translation_rel(f.armature,v),Q?(U.copy(e,f.original_trans),f.focused=f.geom==a?!0:!1):f.focused=!1,f.start_scale=M.get_scale(f.armature),f.start_time=
d,f.start_trans_length=U.length(e)}});h=b.create_timeline_sensor();b.create_sensor_manifold(null,"ANIMATION",b.CT_POSITIVE,[h],null,function(a,c,d){a=b.get_sensor_value(a,c,0);d=a-da.start_time;1>=d&&(c=U.copy(F.AXIS_X,v),d=Q?z.ease_out_expo(d,da.start_trans_length,50,1):z.ease_out_expo(d,da.start_trans_length,-da.start_trans_length,1),c=U.scale(c,d,v),c=U.add(c,da.origin_trans,c),M.set_translation_rel_v(da.geom,c),M.set_translation_rel_v(da.crown_geom,c),M.set_translation_rel_v(da.lamp,c));Q&&(va=
!1);for(c=0;c<oa.length;c++){d=oa[c];var f=a-d.start_time;if(1>=f){var e,h;if(Q)d.focused?(e=z.ease_out_bounce(f,d.start_scale,20/(za[d.name]*P[d.name]),1),f=z.ease_out_expo(f,d.start_trans_length,-d.start_trans_length,1)):(e=z.ease_in_circ(f,d.start_scale,-d.start_scale,1),f=z.ease_in_expo(f,d.start_trans_length,500,1)),h=U.normalize(d.original_trans,v),h=U.scale(h,f,v),B.stop(d.empty);else{e=z.ease_out_expo(f,d.start_scale,P[d.name]-d.start_scale,1);h=U.normalize(d.original_trans,v);var l=U.length(d.original_trans),
f=z.ease_out_expo(f,d.start_trans_length,l-d.start_trans_length,1);h=U.scale(h,f,v)}M.set_translation_rel_v(d.armature,h);M.set_scale(d.armature,e)}else if(Q)for(c=0;c<oa.length;c++)d=oa[c],d.focused||M.set_scale(d.armature,0);else if(!va)for(c=0;c<oa.length;c++)d=oa[c],M.set_translation_rel_v(d.armature,d.original_trans),B.play(d.empty),va=!0}a-=ja.start_time;1>=a?(Q?a=z.ease_in_expo(a,ja.start_scale,50,1):(J.is_hidden(ja.front)&&(J.show_object(ja.front),J.show_object(ja.back)),a=z.ease_out_expo(a,
ja.start_scale,1-ja.start_scale,1)),M.set_scale(ja.front,a),M.set_scale(ja.back,a)):Q?J.is_hidden(ja.front)||(J.hide_object(ja.front),J.hide_object(ja.back)):(M.set_scale(ja.front,1),M.set_scale(ja.back,1))})}else console.log("b4w load failure")}function n(){var a=J.get_object_by_name("Sun_geom");da={geom:J.get_object_by_name("Sun_geom"),crown_geom:J.get_object_by_name("Sun_crown_geom"),lamp:J.get_object_by_name("Lamp"),start_time:-Infinity,start_trans_length:0,origin_trans:M.get_translation_rel(a,
new Float32Array(3))}}function y(){for(var a=0;a<ra.length;a++){var b;b=ra[a];b={name:b,empty:J.get_object_by_name(b+"_Emty"),geom:J.get_object_by_name(b+"_geom"),empty_action:b+"_EmtyAction",geom_action:b+"_ArmatureAction",armature:J.get_object_by_name(b+"_Armature"),focused:!1,start_time:-Infinity,start_scale:1,original_trans:new Float32Array(3),start_trans_length:1};M.set_scale(b.armature,P[b.name]);oa.push(b)}}function d(a){for(var b=document.querySelector("select#video_source");b.firstChild;)b.removeChild(b.firstChild);
if(!a.length)throw Error("Camera devices are unavailable. Try to plug in your Web camera. If the camera is actually present, try closing any other tabs which use the camera, and reboot the current tab.");for(var c=0;c!==a.length;++c){var d=a[c];if("videoinput"===d.kind){var f=document.createElement("option");f.value=d.deviceId;f.text=d.label||"Camera "+(b.length+1);b.appendChild(f)}}T.set_render_callback(r)}function k(b){var d=J.get_active_camera();c.target_setup(d,{pos:q,pivot:L,use_panning:!0});
window.removeEventListener("resize",a);window.addEventListener("resize",u);u();d=J.get_object_by_name("Empty");J.show_object(d);M.set_translation_v(d,L);T.clear_render_callback();if(d=document.getElementById("error"))d.style.display=F.is_ie11()?"block":"grid","DevicesNotFoundError"==b.name?d.textContent="Camera devices are unavailable. Try to plug in your Web camera. If the camera is actually present, try closing any other tabs which use the camera, and reboot the current tab.":"TrackStartError"==
b.name?(d.textContent="Media devices are unavailable.",d.textContent+=" Try to close another program using Web camera."):d.textContent="Error: "+b.name+" "+b.message}function I(a){window.stream=a;H.srcObject=a;return navigator.mediaDevices.enumerateDevices()}function A(){window.stream&&window.stream.getTracks().forEach(function(a){a.stop()});var a=document.querySelector("select#video_source");a.onchange=A;a=a.value;navigator.mediaDevices.getUserMedia({video:{deviceId:a?{exact:a}:void 0}}).then(I).then(d).then(p)["catch"](k)}
function r(){p();window.addEventListener("resize",a);H||(H=document.getElementById("v"),A());var b=J.get_object_by_name("Empty");ea.detectMarker(H);if(0<ea.getMarkerNum())if(-Infinity===h)h=performance.now();else{if(100<performance.now()-h){D?(ea.getTransMatSquareCont(0,1,Y,Y),J.is_hidden(b)&&J.show_object(b)):ea.getTransMatSquare(0,1,Y);ea.getTransMatSquare(0,1,Y);var c=ea.transMatToGLMat(Y,ha);if(T.detect_mobile()&&-1<navigator.userAgent.indexOf("Firefox")){var d=ha;d[0]=c[0];d[1]=-c[1];d[2]=c[2];
d[3]=c[3];d[4]=-c[4];d[5]=c[5];d[6]=-c[6];d[7]=-c[7];d[8]=c[8];d[9]=-c[9];d[10]=c[10];d[11]=c[11];d[12]=c[12];d[13]=-c[13];d[14]=c[14];d[15]=c[15];c=d}d=fa.fromXRotation(-Math.PI,S);c=fa.multiply(d,c,ha);c=E.from_mat4(c,K);d=E.get_trans(c,v);d=U.scale(d,20,v);E.set_trans(d,c);M.set_tsr(b,c);D=!0}}else J.hide_object(b),D=!1,h=-Infinity}function p(){if(ea&&(a(),!ia)){ba=ea.getCameraMatrix();var b=J.get_active_camera(),d=fa.fromXRotation(-Math.PI,ha),d=fa.multiply(ba,d,ha);c.set_projection(b,d);ia=!0}}
function u(){m.resize_to_container(!0)}function a(){var a=document.getElementById("v"),b=m.get_canvas();if(a&&b){var c=window.innerWidth,d=window.innerHeight,f=a.videoWidth/a.videoHeight;c/d<f?(f*=d,b.style.width=f+"px",b.style.marginLeft=-(f-c)/2+"px",b.style.height=d+"px",b.style.marginTop="0px"):(f=1/(f/c),b.style.height=f+"px",b.style.marginTop=-(f-d)/2+"px",b.style.width=c+"px",b.style.marginLeft="0px");a.style.width=b.style.width;a.style.height=b.style.height;a.style.marginLeft=b.style.marginLeft;
a.style.marginTop=b.style.marginTop}}Object.defineProperty(t,"__esModule",{value:!0});t=e(86);var B=t.a.animation,l=t.a.app,c=t.a.camera;C=t.a.config;var m=t.a.container,b=t.a.controls,f=t.a.data,T=t.a.main,fa=t.a.mat4,z=t.a.math,G=t.a.preloader,E=t.a.tsr,J=t.a.scenes,M=t.a.transform,F=t.a.util;e=t.a.version;var U=t.a.vec3,K=E.create(),sa=new Float32Array(2),v=U.create(),Y=new Float64Array(12),ha=new Float32Array(16),S=new Float32Array(16),L=new Float32Array([0,0,0]),q=new Float32Array([30,30,30]);
t="DEBUG"==e.type();var w=C.get_std_assets_path("AR"),ea=null,H=null,D=!1,h=-Infinity,ia=!1,ra="Earth Jupiter Mars Mercury Neptune Saturn Uranus Venus".split(" "),za={Mercury:.964,Venus:1.845,Earth:2,Mars:1.374,Jupiter:8.439,Saturn:5.539,Uranus:3.986,Neptune:3.995},P={Mercury:2,Venus:1.5,Earth:1.5,Mars:1.7,Jupiter:1,Saturn:1,Uranus:1,Neptune:1},oa=[],Q=!1,da=null,ja=null,va=!0,Ga=new ARCameraParam,ba=null;Ga.onload=function(){ea=new ARController(320,240,Ga);ea.setThreshold(100);ea.setPatternDetectionMode(artoolkit.AR_MARKER_INFO_CUTOFF_PHASE_POSE_ERROR_MULTI);
ea.loadMarker(w+"solar.patt")};Ga.load(w+"camera_para.dat");l.init({canvas_container_id:"main_canvas_container",callback:function(a,b){b?(G.create_preloader(),a.oncontextmenu=function(a){a.preventDefault();a.stopPropagation();return!1},f.load(w+"AR.json",V,R)):console.log("b4w init failure")},show_fps:t,console_verbose:t,autoresize:!1})},function(C,t,e){C=e(32);var R=e(87),V=e(97),n=e(98),y=e(99),d=e(100),k=e(81),I=e(101),A=e(102),r=e(103),p=e(104),u=e(105),a=e(106),B=e(69),l=e(107),c=e(83),m=e(108),
b=e(109),f=e(33),T=e(76),fa=e(67),z=e(40),G=e(24),E=e(77),J=e(78),M=e(110),F=e(111),U=e(49),K=e(112),sa=e(113),v=e(60),Y=e(114),ha=e(115),S=e(116),L=e(117),q=e(118),w=e(54),ea=e(119),H=e(29),D=e(50),h=e(82),ia=e(120),ra=e(68),za=e(41),P=e(80),oa=e(26),Q=e(121),da=e(1),ja=e(3),va=e(7),Ga=e(27),ba=e(21),Ea=e(8);C.a.app=R.a;C.a.camera_anim=V.a;C.a.fps=n.a;C.a.gp_conf=y.a;C.a.gyroscope=d.a;C.a.hmd=k.a;C.a.hmd_conf=I.a;C.a.mixer=A.a;C.a.mouse=r.a;C.a.npc_ai=p.a;C.a.preloader=u.a;C.a.screenshooter=a.a;
C.a.storage=B.a;C.a.anchors=l.a;C.a.animation=c.a;C.a.armature=m.a;C.a.assets=b.a;C.a.camera=f.a;C.a.config=T.a;C.a.constraints=fa.a;C.a.container=z.a;C.a.controls=G.a;C.a.data=E.a;C.a.debug=J.a;C.a.geometry=M.a;C.a.hud=F.a;C.a.input=U.a;C.a.lights=K.a;C.a.logic_nodes=sa.a;C.a.main=v.a;C.a.material=Y.a;C.a.math=ha.a;C.a.nla=S.a;C.a.objects=L.a;C.a.particles=q.a;C.a.physics=w.a;C.a.rgb=ea.a;C.a.scenes=H.a;C.a.screen=D.a;C.a.sfx=h.a;C.a.textures=ia.a;C.a.time=ra.a;C.a.transform=za.a;C.a.tsr=P.a;C.a.util=
oa.a;C.a.version=Q.a;C.a.print=da.a;C.a.vec3=ja;C.a.vec4=va;C.a.mat3=Ga;C.a.mat4=ba;C.a.quat=Ea;C.a.register("vec3",function(a,b){for(var c in ja)a[c]=ja[c]});C.a.register("vec4",function(a,b){for(var c in va)a[c]=va[c]});C.a.register("mat3",function(a,b){for(var c in Ga)a[c]=Ga[c]});C.a.register("mat4",function(a,b){for(var c in ba)a[c]=ba[c]});C.a.register("quat",function(a,b){for(var c in Ea)a[c]=Ea[c]});t.a=C.a},function(C,t,e){C=e(0);var R=e(33),V=e(76),n=e(67),y=e(40),d=e(24),k=e(77),I=e(78),
A=e(49),r=e(60),p=e(54),u=e(1),a=e(50),B=e(29),l=e(41),c=e(26),m=e(3);e=Object(C.a)("app",function(b,f){function e(){var a=P.is_paused();document.addEventListener("visibilitychange",function(){document.hidden?(a=P.is_paused(),P.pause()):a||P.resume()},!1)}function t(){var a=0,b=D.get_container(),c=P.is_paused(),d=!0;P.append_loop_cb(function(){if(0==a%10){var f=b.getBoundingClientRect();f.top>window.innerHeight||0>f.bottom?(d&&(c=P.is_paused()),P.pause(),d=!1):c||d||(P.resume(),d=!0)}a++})}function z(a,
b,c,d){var f=document.createElement("canvas"),e=document.getElementById(a);e||(Q.error('Warning: canvas container "'+a+'" not found, appending to body'),e=document.body);f.style.position="absolute";f.style.left=0;f.style.top=0;f.style.width=e.offsetWidth+"px";f.style.height=e.offsetHeight+"px";f.width=e.offsetWidth*window.devicePixelRatio;f.height=e.offsetHeight*window.devicePixelRatio;b?(a=document.createElement("canvas"),a.style.position="absolute",f.style.left=0,f.style.top=0,a.style.pointerEvents=
"none"):a=null;e.appendChild(f);if(!P.init(f,a))return c&&L("Browser could not initialize WebGL","For more info visit","https://www.blend4web.com/doc/en/problems_and_solutions.html#problems-upon-startup",d),!1;a&&D.insert_to_container(a,"LAST");return!0}function G(a,b){a?(b&&(document.getElementById(b).style.display="block"),Ea=document.getElementById(a)):(Ea=document.createElement("div"),Ea.innerHTML=0,Ea.style.cssText="position:absolute;font-family: Arial, sans-serif;top: 20px;right: 20px;text-shadow: 0px 0px 6px #000;font-size: 40px;line-height: 50px;font-weight: bold;color: #fff;",
D.insert_to_container(Ea,"JUST_AFTER_CANVAS"))}function E(a,b){var c=String(a);b&&(c+="/"+String(b));Ea.innerHTML=c}function J(a){a=document.getElementById(a);var b=a.cloneNode(!0);a.parentNode.replaceChild(b,a);return b}function M(a,b,c){var d=Math.max(w.hover_get_distance(a),1),f=va.get_rotation(a,O);b=Ga.quat_to_dir(f,b,ga);b[2]=0;m.normalize(b,b);m.scale(b,d*c,b);c=va.get_translation(a,ya);m.add(c,b,c);w.set_translation(a,c)}function F(a,b){var c=w.hover_get_vertical_limits(a,qa);if(c.up!=c.down){var d=
w.get_camera_angles(a,xa)[1],c=(c.down-d)/(c.down-c.up),d=w.hover_get_distance_limits(a,qa),c=Math.max(c,2/d.max);w.rotate_camera(a,0,c*b)}}function C(a,b,c,d){va.move_local(a,5*b,5*c,5*d)}function K(a,b,c){var d=w.target_get_distance(a),f=Math.abs(b);c=Math.pow(f*c,1-Math.pow(f*c,.15));va.move_local(a,0,0,0>b?.001<d?-d*c:0:c/(1-c)*d)}function sa(a,b,c,d,f){for(a=d*c;0<b;--b)d+=a,f+=a,a=d*c;return f}function v(a,b,c,d,f,e){e?(f=w.target_get_pivot(a,ga),e=w.get_translation(a),f=m.dist(f,e)+d,d=0<b?
sa(a,b,-c,f,d):sa(a,-b,c/(1-c),f,d)):d-=b*f*c;return d}function Y(a,b,c,d,f,e){ta=a;X=b;pa=c;ka=d;Ca=f;Ma=e;var g=ja.get_active_camera();ha(g);var l=!1,k=null,q=!1;switch(w.get_move_style(g)){case w.MS_TARGET_CONTROLS:l=!a;break;case w.MS_EYE_CONTROLS:k=ja.get_first_character();break;case w.MS_STATIC:return;case w.MS_HOVER_CONTROLS:q=!0}var n=w.get_velocities(g,wa);a=h.create_elapsed_sensor();if(oa.has_simulated_physics(g)){var p=h.create_collision_sensor(g,null,!0);h.create_sensor_manifold(g,"CAMERA_COLLISION",
h.CT_POSITIVE,[p],null,function(a,b,c){c=h.get_sensor_payload(a,b,0).coll_dist;if(0>c){var d=h.get_sensor_payload(a,b,0).coll_norm;b=ga;m.scale(d,-.25*c,b);c=va.get_translation(a,ya);m.add(c,b,c);va.set_translation_v(a,c)}})}if(k){var p=va.get_translation(g),r=va.get_rotation(g),r=Ga.cam_quat_to_mesh_quat(r);p[2]-=.5;oa.set_transform(k,p,r);H.append_stiff_trans(g,k,[0,0,.5]);var u=new Float32Array(2),z=!0;oa.set_character_move_type(k,oa.CM_FLY);h.create_kb_sensor_manifold(g,"TOGGLE_CHAR_MOVE_TYPE",
h.CT_SHOT,h.KEY_C,function(){z=!z;oa.set_character_move_type(k,z?oa.CM_FLY:oa.CM_WALK)})}var E=function(a,b,c){if(1==c)switch(c=h.get_sensor_value(a,b,0),w.get_velocities(a,n),b){case "FORWARD":k?u[0]=1:q?(b=w.get_camera_angles(a,xa)[1],b=Math.abs(b)>=Math.PI/4?Ga.AXIS_Y:Ga.AXIS_MZ,M(a,b,.5*n.trans*c)):l?K(a,-n.zoom,c):C(a,0,0,-n.trans*c);break;case "BACKWARD":k?u[0]=-1:q?(b=w.get_camera_angles(a,xa)[1],b=Math.abs(b)>=Math.PI/4?Ga.AXIS_MY:Ga.AXIS_Z,M(a,b,.5*n.trans*c)):l?K(a,n.zoom,c):C(a,0,0,n.trans*
c);break;case "UP":q?F(a,30*-n.zoom*c):k||C(a,0,n.trans*c,0);break;case "DOWN":q?F(a,30*n.zoom*c):k||C(a,0,-n.trans*c,0);break;case "LEFT":k?u[1]=1:q?M(a,Ga.AXIS_MX,.5*n.trans*c):C(a,-n.trans*c,0,0);break;case "RIGHT":k?u[1]=-1:q?M(a,Ga.AXIS_X,.5*n.trans*c):C(a,n.trans*c,0,0);break;case "ROT_LEFT":l?w.rotate_camera(a,.75*-n.rot*c,0):w.rotate_camera(a,.75*n.rot*c,0);break;case "ROT_RIGHT":l?w.rotate_camera(a,.75*n.rot*c,0):w.rotate_camera(a,.75*-n.rot*c,0);break;case "ROT_UP":l?w.rotate_camera(a,0,
.75*-n.rot*c):w.rotate_camera(a,0,.75*n.rot*c);break;case "ROT_DOWN":l?w.rotate_camera(a,0,.75*n.rot*c):w.rotate_camera(a,0,.75*-n.rot*c)}else switch(b){case "FORWARD":case "BACKWARD":k&&(u[0]=0);break;case "LEFT":case "RIGHT":k&&(u[1]=0)}k&&(oa.set_character_move_dir(k,u[0],u[1]),a=w.get_camera_angles_char(a,Aa),oa.set_character_rotation_h(k,a[0]),oa.set_character_vert_move_dir_angle(k,a[1]))},t,D,A,y,B,G,J,L,I;e?p=r=G=J=L=I=h.create_custom_sensor(0):(I=za.check_enable_gamepad_indices(),r=I.length?
I[I.length-1]:0,p=h.create_gamepad_btn_sensor(za.GMPD_BUTTON_6,r),r=h.create_gamepad_btn_sensor(za.GMPD_BUTTON_7,r),G=h.create_gamepad_axis_sensor(za.GMPD_AXIS_0,I),J=h.create_gamepad_axis_sensor(za.GMPD_AXIS_1,I),L=h.create_gamepad_axis_sensor(za.GMPD_AXIS_2,I),I=h.create_gamepad_axis_sensor(za.GMPD_AXIS_3,I));b?b=t=D=A=y=B=h.create_custom_sensor(0):(b=h.create_keyboard_sensor(h.KEY_W),t=h.create_keyboard_sensor(h.KEY_S),D=h.create_keyboard_sensor(h.KEY_A),A=h.create_keyboard_sensor(h.KEY_D),y=h.create_keyboard_sensor(h.KEY_R),
B=h.create_keyboard_sensor(h.KEY_F));var S=h.create_keyboard_sensor(h.KEY_UP),T=h.create_keyboard_sensor(h.KEY_DOWN),P=h.create_keyboard_sensor(h.KEY_LEFT),ia=h.create_keyboard_sensor(h.KEY_RIGHT),ra=function(a){return a[0]&&(a[1]||a[2]||a[3])},U=function(a){return a[0]&&(a[1]||.1<a[2])},ea=function(a){return a[0]&&(a[1]||-.1>a[2])},Y=function(a){return a[0]&&(a[1]||a[2]||.1<a[3])},R=function(a){return a[0]&&(a[1]||a[2]||-.1>a[3])};q||(h.create_sensor_manifold(g,"FORWARD",h.CT_CONTINUOUS,[a,b,J],
ea,E),h.create_sensor_manifold(g,"BACKWARD",h.CT_CONTINUOUS,[a,t,J],U,E));l?(h.create_sensor_manifold(g,"ROT_UP",h.CT_CONTINUOUS,[a,S,y,I],R,E),h.create_sensor_manifold(g,"ROT_DOWN",h.CT_CONTINUOUS,[a,T,B,I],Y,E),h.create_sensor_manifold(g,"ROT_LEFT",h.CT_CONTINUOUS,[a,P,D,L],R,E),h.create_sensor_manifold(g,"ROT_RIGHT",h.CT_CONTINUOUS,[a,ia,A,L],Y,E)):q?(h.create_sensor_manifold(g,"LEFT",h.CT_CONTINUOUS,[a,P,D,G],R,E),h.create_sensor_manifold(g,"RIGHT",h.CT_CONTINUOUS,[a,ia,A,G],Y,E),h.create_sensor_manifold(g,
"FORWARD",h.CT_CONTINUOUS,[a,S,b,J],R,E),h.create_sensor_manifold(g,"BACKWARD",h.CT_CONTINUOUS,[a,T,t,J],Y,E),h.create_sensor_manifold(g,"UP",h.CT_CONTINUOUS,[a,B,I],U,E),h.create_sensor_manifold(g,"DOWN",h.CT_CONTINUOUS,[a,y,I],ea,E)):(h.create_sensor_manifold(g,"UP",h.CT_CONTINUOUS,[a,y,p],ra,E),h.create_sensor_manifold(g,"DOWN",h.CT_CONTINUOUS,[a,B,r],ra,E),h.create_sensor_manifold(g,"LEFT",h.CT_CONTINUOUS,[a,D,G],ea,E),h.create_sensor_manifold(g,"RIGHT",h.CT_CONTINUOUS,[a,A,G],U,E),h.create_sensor_manifold(g,
"ROT_UP",h.CT_CONTINUOUS,[a,S,I],ea,E),h.create_sensor_manifold(g,"ROT_DOWN",h.CT_CONTINUOUS,[a,T,I],U,E),h.create_sensor_manifold(g,"ROT_LEFT",h.CT_CONTINUOUS,[a,P,L],ea,E),h.create_sensor_manifold(g,"ROT_RIGHT",h.CT_CONTINUOUS,[a,ia,L],U,E));if(!c){var N=0;c=h.create_mouse_wheel_sensor(d);var O=0,E=h.create_touch_zoom_sensor(d);h.create_sensor_manifold(g,"MOUSE_WHEEL",h.CT_LEVEL,[c],null,function(a,b,c){1==c&&(b=h.get_sensor_value(a,b,0),w.get_velocities(a,n),l||q?N=v(a,b,n.zoom,N,2,l):(n.trans*=
1+b*n.zoom,w.set_velocities(a,n)))});h.create_sensor_manifold(g,"TOUCH_ZOOM",h.CT_LEVEL,[E],null,function(a,b,c,d){1==c&&(c=h.get_sensor_value(a,b,0),w.get_velocities(a,n),h.get_sensor_payload(a,b,0)===h.PL_MULTITOUCH_MOVE_ZOOM&&(O=v(a,c,.03*n.zoom,O,2,l)))});h.create_sensor_manifold(g,"ZOOM_INTERPOL",h.CT_POSITIVE,[a],null,function(a,b,c){if(l||q)1E-5<Math.abs(N)||1E-5<Math.abs(O)?(c=h.get_sensor_value(a,b,0),b=Ga.smooth(N,0,c,.1*ba),N-=b,c=Ga.smooth(O,0,c,.15*ba),O-=c,q?F(a,-(b+c)):(b=w.target_get_distance(a)+
b+c,b=Math.max(b,.001),w.target_set_distance(a,b))):O=N=0})}var fa=0,V=0,da=0,Q=0;c=function(a,b,c,d){if(1==c){c=h.get_sensor_value(a,b,1);w.get_velocities(a,n);if(q)f=.003*n.trans,e=7.5E-4*n.rot;else var f=.003*n.rot,e=7.5E-4*n.trans;if(1===h.get_sensor_payload(a,b,0).which)fa+="X"==d?-c*f:0,V+="Y"==d?-c*f:0;else if(2===h.get_sensor_payload(a,b,0).which||3===h.get_sensor_payload(a,b,0).which)da+="X"==d?-c*e:0,Q+="Y"==d?-c*e:0}};var na=0,qa=0;e||(e=function(a,b,c){w.get_velocities(a,n);na+=.002*n.trans},
E=function(a,b,c){w.get_velocities(a,n);qa+=.05*n.zoom},J=function(a,b,c){w.get_velocities(a,n);na-=.002*n.trans},I=function(a,b,c){w.get_velocities(a,n);qa-=.05*n.zoom},l?(h.create_sensor_manifold(g,"GMPD_PAN_Y_POS",h.CT_CONTINUOUS,[p],null,E),h.create_sensor_manifold(g,"GMPD_PAN_Y_NEG",h.CT_CONTINUOUS,[r],null,I),h.create_sensor_manifold(g,"GMPD_PAN_X_POS",h.CT_CONTINUOUS,[G],function(a){return-.1>a[0]},J),h.create_sensor_manifold(g,"GMPD_PAN_X_NEG",h.CT_CONTINUOUS,[G],function(a){return.1<a[0]},
e)):q&&(h.create_sensor_manifold(g,"GMPD_PAN_X_POS",h.CT_CONTINUOUS,[L],function(a){return-.1>a[0]},J),h.create_sensor_manifold(g,"GMPD_PAN_X_NEG",h.CT_CONTINUOUS,[L],function(a){return.1<a[0]},e)));if(f){f=h.create_mouse_move_sensor("X",window);e=h.create_mouse_move_sensor("Y",window);var p=h.create_mouse_click_sensor(d),r=h.create_mouse_click_sensor(window),Ja=!1;G=function(a){a[2]?Ja=!0:a[0]||(Ja=!1);return Ja&&a[0]};h.create_sensor_manifold(g,"MOUSE_X",h.CT_POSITIVE,[r,f,p],G,c,"X");h.create_sensor_manifold(g,
"MOUSE_Y",h.CT_POSITIVE,[r,e,p],G,c,"Y");f=za.get_device_by_type_element(za.DEVICE_MOUSE,window);za.switch_prevent_default(f,!1)}else f=h.create_mouse_move_sensor("X",d),e=h.create_mouse_move_sensor("Y",d),p=h.create_mouse_click_sensor(d),h.create_sensor_manifold(g,"MOUSE_X",h.CT_POSITIVE,[p,f],null,c,"X"),h.create_sensor_manifold(g,"MOUSE_Y",h.CT_POSITIVE,[p,e],null,c,"Y");var sa=0,Da=0,Ba=0,Ea=0;f=h.create_touch_move_sensor("X",d);d=h.create_touch_move_sensor("Y",d);e=function(a,b,c,d){if(1==c){w.get_velocities(a,
n);var f=q?.003*n.trans:.003*n.rot;c=h.get_sensor_value(a,b,0);h.get_sensor_payload(a,b,0).gesture===h.PL_SINGLE_TOUCH_MOVE?(sa+="X"==d?-c*f:0,Da+="Y"==d?-c*f:0):h.get_sensor_payload(a,b,0).gesture===h.PL_MULTITOUCH_MOVE_PAN&&(a=q?.003*n.rot:7.5E-4*n.trans,Ba+="X"==d?-c*a:0,Ea+="Y"==d?-c*a:0)}};h.create_sensor_manifold(g,"TOUCH_X",h.CT_POSITIVE,[f],null,e,"X");h.create_sensor_manifold(g,"TOUCH_Y",h.CT_POSITIVE,[d],null,e,"Y");h.create_sensor_manifold(g,"ROT_TRANS_INTERPOL",h.CT_POSITIVE,[a],null,
function(a,b,c){if(1E-5<Math.abs(fa)||1E-5<Math.abs(V)||1E-5<Math.abs(sa)||1E-5<Math.abs(Da)||1E-5<Math.abs(da)||1E-5<Math.abs(Q)||1E-5<Math.abs(Ba)||1E-5<Math.abs(Ea)||1E-5<Math.abs(na)||1E-5<Math.abs(qa)){var d=h.get_sensor_value(a,b,0),f=Ga.smooth(fa,0,d,.08*ba),e=Ga.smooth(V,0,d,.08*ba);fa-=f;V-=e;var g=Ga.smooth(sa,0,d,.12*ba),m=Ga.smooth(Da,0,d,.12*ba);sa-=g;Da-=m;b=Ga.smooth(da,0,d,.08*ba);var n=Ga.smooth(Q,0,d,.08*ba);da-=b;Q-=n;c=Ga.smooth(Ba,0,d,.12*ba);var p=Ga.smooth(Ea,0,d,.12*ba);Ba-=
c;Ea-=p;var r=Ga.smooth(na,0,d,.08*ba),d=Ga.smooth(qa,0,d,.08*ba);na-=r;qa-=d;l?(w.rotate_camera(a,f+g,e+m),e=w.target_get_distance(a),w.target_pan_pivot(a,e*(b+c+r),e*(n+p+d))):q?(f+g&&M(a,Ga.AXIS_X,.2*(f+g)),e+m&&(n=w.get_camera_angles(a,xa)[1],M(a,Math.abs(n)>Math.PI/4?Ga.AXIS_MY:Ga.AXIS_Z,.2*(e+m))),w.rotate_camera(a,b+c+r,0)):(w.rotate_camera(a,.5*(f+g),.5*(e+m)),k&&(a=w.get_camera_angles_char(a,Aa),oa.set_character_rotation_h(k,a[0]),oa.set_character_vert_move_dir_angle(k,a[1])))}});h.create_kb_sensor_manifold(g,
"DEC_STEREO_DIST",h.CT_SHOT,h.KEY_LEFT_SQ_BRACKET,function(a,b,c){b=w.get_stereo_distance(a);w.set_stereo_distance(a,.9*b)});h.create_kb_sensor_manifold(g,"INC_STEREO_DIST",h.CT_SHOT,h.KEY_RIGHT_SQ_BRACKET,function(a,b,c){b=w.get_stereo_distance(a);w.set_stereo_distance(a,1.1*b)})}function ha(a){var b=w.get_move_style(a),c=h.create_callback_sensor(function(){var c=w.get_move_style(a),d=c!=b;b=c;return d});h.create_sensor_manifold(a,"CHANGE_MOVE_STYLE",h.CT_POSITIVE,[c],null,function(a,b,c){S();Y(ta,
X,pa,ka,Ca,Ma)})}function S(){var a=ja.get_active_camera();h.check_sensor_manifold(a,"TOGGLE_CHAR_MOVE_TYPE")&&ja.get_first_character()&&H.remove(a);for(var b="FORWARD BACKWARD ROT_UP ROT_DOWN ROT_LEFT ROT_RIGHT UP DOWN LEFT RIGHT MOUSE_WHEEL TOUCH_ZOOM ZOOM_INTERPOL MOUSE_X MOUSE_Y TOUCH_X TOUCH_Y ROT_TRANS_INTERPOL CHANGE_MOVE_STYLE TOGGLE_CHAR_MOVE_TYPE".split(" "),c=0;c<b.length;c++)h.remove_sensor_manifold(a,b[c])}function L(a,b,c,d){var f=document.createElement("div"),e=document.createElement("div"),
g=document.createElement("div");if(d)for(var h=0;h<d.length;h++){var l=document.getElementById(d[h]);l&&l.parentNode.removeChild(l)}f.style.cssText="z-index:10;width:100%;height:auto;position:absolute;top:50%;margin-top:150px;text-align:center;";e.style.cssText="color:#fff;font-size:24px;";g.style.cssText="color:#fff;font-size:20px;";e.innerHTML=a;g.innerHTML=b+'   <a style="color:#fff;font-size:20px;width:100%;" href="'+c+'">'+c.replace("https://www.","")+"</a>";f.appendChild(e);f.appendChild(g);
document.body.appendChild(f)}function q(a,b,c,d,f){function e(){var h=performance.now()-g;f(b+h*(c-b)/d);(h>=d||!a.parentNode)&&P.remove_loop_cb(e)}var g=performance.now();P.append_loop_cb(e)}var w=Object(R.a)(b),ea=Object(V.a)(b),H=Object(n.a)(b),D=Object(y.a)(b),h=Object(d.a)(b),ia=Object(k.a)(b),ra=Object(I.a)(b),za=Object(A.a)(b),P=Object(r.a)(b),oa=Object(p.a)(b),Q=Object(u.a)(b),da=Object(a.a)(b),ja=Object(B.a)(b),va=Object(l.a)(b),Ga=Object(c.a)(b),ba=1,Ea=null,ta=!1,X=!1,pa=!1,ka=null,Ca=
!1,Ma=!1,Aa=new Float32Array(2),xa=new Float32Array(2),ga=new Float32Array(3),ya=new Float32Array(3),O=new Float32Array(4),wa={},qa={};f.init=function(a){a=a||{};var b=!1,c=null,d=function(){},f=null,l=null,k=0,m=null,n=!0,q=!1,p=!0,r=!0,w=!1,u=!1,v=!1,A=!1,y=ea.get("quality"),B;for(B in a)switch(B){case "canvas_container_id":c=a.canvas_container_id;break;case "callback":d=a.callback;break;case "autoresize":b=a.autoresize;break;case "show_hud_debug_info":v=a.show_hud_debug_info;break;case "sfx_mix_mode":w=
a.sfx_mix_mode;break;case "show_fps":u=a.show_fps;break;case "track_container_position":A=a.track_container_position;Q.error_once("track_container_position deprecated. Not needed anymore. Use the container.get_coords_target_space method.");break;case "fps_wrapper_id":m=a.fps_wrapper_id;break;case "fps_elem_id":l=a.fps_elem_id;break;case "error_purge_elements":f=a.error_purge_elements;break;case "report_init_failure":r=a.report_init_failure;break;case "pause_invisible":p=a.pause_invisible;break;case "key_pause_enabled":n=
a.key_pause_enabled;break;case "force_container_ratio":k=a.force_container_ratio;break;case "min_capabilities":q=a.min_capabilities;break;case "quality":y=a.quality;break;default:ea.set(B,a[B])}y!=ea.P_AUTO&&ea.set("quality",y);a=function(a){a.keyCode==h.KEY_P&&(P.is_paused()?P.resume():P.pause())};n&&document.addEventListener("keydown",a,!1);ea.set("show_hud_debug_info",v);ea.set("sfx_mix_mode",w);var H=v||w||null,n=function(){var a=z(c,H,r,f),g=D.get_canvas();if(a){var h=D.get_container();D.resize_to_container();
u&&(G(l,m),P.set_fps_callback(E));p&&(e(),t());k&&P.append_loop_cb(function(){h.style.height=h.clientWidth/k+"px"});b&&P.append_loop_cb(function(){D.resize_to_container()});A&&P.append_loop_cb(function(){D.force_offsets_updating()});q&&ea.reset_limits();y==ea.P_AUTO?ra.test_performance(function(a,b){0==a?(Q.log("QUALITY TEST RESULT: UNSUPPORTED, using HIGH"),ea.apply_quality(ea.P_HIGH)):1.5>b?(Q.log("QUALITY TEST RESULT: LOW ("+b.toFixed(1)+" GB/s)"),ea.apply_quality(ea.P_LOW)):(Q.log("QUALITY TEST RESULT: HIGH ("+
b.toFixed(1)+" GB/s)"),ea.apply_quality(ea.P_HIGH));d(g,!0)}):d(g,!0)}else d(g,!1)};"complete"==document.readyState?window.setTimeout(n,0):window.addEventListener("load",n,!1);window.addEventListener("unload",function(){ia.cleanup()},!1)};f.set_onclick=function(a,b){var c=J(a);c.addEventListener("mouseup",function(a){b(c.value)},!1)};f.set_onchange=function(a,b){var c=J(a);c.addEventListener("change",function(a){a=c.checked;b(void 0!=a?a:c.value)},!1)};f.set_onkeypress=function(a,b){var c=J(a);c.addEventListener("keypress",
function(a){b(a.keyCode,c.value)},!1)};f.enable_camera_controls=Y;f.disable_camera_controls=S;f.enable_object_controls=function(a,b){var c=oa.is_vehicle_chassis(a)||oa.is_vehicle_hull(a),d=function(a,b,d){if(1==d)switch(d=h.get_sensor_value(a,b,0),b){case "FORWARD":c?oa.vehicle_throttle(a,1):va.move_local(a,0,-1*d,0);break;case "BACKWARD":c?oa.vehicle_throttle(a,-1):va.move_local(a,0,1*d,0);break;case "LEFT":c?oa.vehicle_steer(a,-1):va.move_local(a,1*d,0,0);break;case "RIGHT":c?oa.vehicle_steer(a,
1):va.move_local(a,-1*d,0,0)}else switch(b){case "FORWARD":case "BACKWARD":c&&oa.vehicle_throttle(a,0);break;case "LEFT":case "RIGHT":c&&oa.vehicle_steer(a,0)}},f=h.create_elapsed_sensor(),e=h.create_keyboard_sensor(h.KEY_W),l=h.create_keyboard_sensor(h.KEY_S),k=h.create_keyboard_sensor(h.KEY_A),m=h.create_keyboard_sensor(h.KEY_D),n=h.create_keyboard_sensor(h.KEY_UP),q=h.create_keyboard_sensor(h.KEY_DOWN),p=h.create_keyboard_sensor(h.KEY_LEFT),r=h.create_keyboard_sensor(h.KEY_RIGHT),w=function(a){return a[0]&&
(a[1]||a[2])};h.create_sensor_manifold(a,"FORWARD",h.CT_CONTINUOUS,[f,e,n],w,d);h.create_sensor_manifold(a,"BACKWARD",h.CT_CONTINUOUS,[f,l,q],w,d);h.create_sensor_manifold(a,"LEFT",h.CT_CONTINUOUS,[f,k,p],w,d);h.create_sensor_manifold(a,"RIGHT",h.CT_CONTINUOUS,[f,m,r],w,d)};f.disable_object_controls=function(a){for(var b=["FORWARD","BACKWARD","LEFT","RIGHT"],c=0;c<b.length;c++)h.remove_sensor_manifold(a,b[c])};f.enable_debug_controls=function(){h.create_kb_sensor_manifold(null,"CAMERA_SHOT",h.CT_SHOT,
h.KEY_K,function(){ra.make_camera_frustum_shot()});h.create_kb_sensor_manifold(null,"LIGHT_SHOT",h.CT_SHOT,h.KEY_L,function(){ra.make_light_frustum_shot()});h.create_kb_sensor_manifold(null,"TELEMETRY",h.CT_SHOT,h.KEY_T,function(){ra.plot_telemetry()})};f.request_fullscreen=function(a,b,c){Q.error_deprecated("request_fullscreen","screen.request_fullscreen");da.request_fullscreen(a,b,c)};f.exit_fullscreen=function(){Q.error_deprecated("exit_fullscreen","screen.exit_fullscreen");da.exit_fullscreen()};
f.check_fullscreen=function(){Q.error_deprecated("check_fullscreen","screen.check_fullscreen");return da.check_fullscreen()};f.report_app_error=L;f.get_url_params=function(a){a=!!a;var b=decodeURIComponent(location.href.toString());if(-1==b.indexOf("?"))return null;for(var b=b.split("?")[1].split("&"),c={},d=0;d<b.length;d++){var f=b[d].split("="),e=f[0];1<f.length?(f=f[1],a?e in c?c[e].push(f):c[e]=[f]:c[e]=f):a?e in c||(c[e]=[]):c[e]=""}return c};f.css_animate=function(a,b,c,d,f,e,h,l){if(a&&b&&
isFinite(c)&&isFinite(d)&&isFinite(f)){e=e||"";h=h||"";l=l||function(){};var g=a.style,k=b.charAt(0).toUpperCase()+b.slice(1);if(void 0==g[b])if(void 0!=g["webkit"+k])b="webkit"+k;else if(void 0!=g["ms"+k])b="ms"+k;else if(void 0!=g["moz"+k])b="moz"+k;else return;q(a,c,d,f,function(f){a&&(g[b]=e+f+h,c>d&&f<=d||c<d&&f>=d)&&(g[b]=e+d+h,l())})}};f.attr_animate=function(a,b,c,d,f,e){a&&b&&isFinite(c)&&isFinite(d)&&isFinite(f)&&(e=e||function(){},q(a,c,d,f,function(f){a&&(0<=f&&a.setAttribute(b,f),c>d&&
f<=d||c<d&&f>=d)&&(a.setAttribute(b,d),e())}))};f.queue_animate=function(a){if(a.length){var b=a.shift(),c=b.elem,d=b.prop,e=b.from,h=b.to,l=b.duration,k=b.opt_prefix,m=b.opt_suffix,n=function(){b.cb&&b.cb();f.queue_animate(a)};"css"==b.type?f.css_animate(c,d,e,h,l,k,m,n):"attr"==b.type&&f.attr_animate(c,d,e,h,l,n)}};f.set_camera_smooth_factor=function(a){ba=a};f.get_camera_smooth_factor=function(){return ba}});t.a=e},function(C,t,e){C=e(0);var R=e(31);e=Object(C.a)("__debug_nodegraph",function(e,
n){var t=Object(R.a)(e);n.nodegraph_to_dot=function(d,e){if(e)var k=function(d,e){var k=e.type+"("+e.name+")",a=e.inputs,k=k+"\n\nINPUTS:";if(a.length)for(var n=0;n<a.length;n++)k+="\n"+a[n].identifier+": ",k=a[n].is_linked?k+"linked":k+a[n].default_value;else k+="\n---";a=e.outputs;k+="\n\nOUTPUTS:";if(a.length)for(n=0;n<a.length;n++)k+="\n"+a[n].identifier+": ",k=a[n].is_linked?k+("linked(default "+a[n].default_value+")"):k+"not used";else k+="\n---";n="";switch(e.type){case "GEOMETRY_UV":n="\nuv_layer: "+
e.data.value;break;case "TEXTURE_COLOR":case "TEXTURE_NORMAL":n="\ntexture: "+e.data.value.name+"\n("+e.data.value.img_filepath+")"}""==n&&(n="\n---");return k=k+"\n\nDATA:"+n},n=function(e,k,n){e=t.get_node_attr(d,e);k=t.get_node_attr(d,k);return e.outputs[n[0]].identifier+"\n==>\n"+k.inputs[n[1]].identifier};else k=function(d,e){return e.type},n=function(e,k,n){e=t.get_node_attr(d,e);k=t.get_node_attr(d,k);return e.outputs[n[0]].identifier+"\n==>\n"+k.inputs[n[1]].identifier};return t.debug_dot(d,
k,n)}});t.a=e},function(C,t,e){C=e(0);var R=e(32),V=e(5),n=e(30),y=e(48);e=Object(C.a)("__ipc",function(d,e){function k(a){var b=document.getElementsByTagName("script");a=Object(y.b)(a);for(var c=0;c<b.length;c++)if(b[c].src==a)return b[c];return null}function t(a,b,c){for(var d=0;d<z.length;d+=2)z[d+1]==a&&(C[d+Number(!b)]=c)}function r(a){for(var b=0;b<a.length;b++){var c=a[b],d=0,f;for(f in c){var e=c[f];switch(e.constructor){case Float32Array:d+=e.length;break;case Number:d+=1}}--d;c.len=d}}var p=
Object(V.a)(d),u=Object(n.a)(d),a=!0;e.IN_LOADED=0;e.IN_COLLISION=1;e.IN_COLLISION_POS_NORM=2;e.IN_COLLISION_IMPULSE=3;e.IN_ERROR=4;e.IN_FBMSG=5;e.IN_FLOATER_BOB_TRANSFORM=6;e.IN_LOG=7;e.IN_PROP_OFFSET=8;e.IN_RAY_HIT=9;e.IN_RAY_HIT_POS_NORM=10;e.IN_REMOVE_RAY_TEST=11;e.IN_TRANSFORM=12;e.IN_VEHICLE_SPEED=13;e.IN_PING=14;e.IN_FPS=15;e.IN_DEBUG_STATS=16;var B=e.IN_COLLISION,l=e.IN_COLLISION_POS_NORM,c=e.IN_PROP_OFFSET,m=e.IN_RAY_HIT,b=e.IN_RAY_HIT_POS_NORM,f=e.IN_TRANSFORM;e.OUT_INIT=100;e.OUT_ACTIVATE=
101;e.OUT_ADD_BOAT_BOB=102;e.OUT_ADD_CAR_WHEEL=103;e.OUT_ADD_FLOATER_BOB=104;e.OUT_APPEND_BOUNDING_BODY=105;e.OUT_APPEND_BOAT=106;e.OUT_APPEND_CAR=107;e.OUT_APPEND_CHARACTER=108;e.OUT_APPEND_COLLISION_TEST=109;e.OUT_APPEND_CONSTRAINT=110;e.OUT_APPEND_FLOATER=111;e.OUT_APPEND_GHOST_MESH_BODY=112;e.OUT_APPEND_STATIC_MESH_BODY=113;e.OUT_APPEND_WATER=114;e.OUT_REMOVE_BODY=115;e.OUT_APPLY_CENTRAL_FORCE=116;e.OUT_APPLY_COLLISION_IMPULSE_TEST=117;e.OUT_APPLY_TORQUE=118;e.OUT_CHARACTER_JUMP=119;e.OUT_CHARACTER_ROTATION_INCREMENT=
120;e.OUT_CLEAR_COLLISION_IMPULSE_TEST=121;e.OUT_DISABLE_SIMULATION=122;e.OUT_ENABLE_SIMULATION=123;e.OUT_PAUSE=124;e.OUT_APPEND_RAY_TEST=125;e.OUT_REMOVE_RAY_TEST=126;e.OUT_CHANGE_RAY_TEST_FROM_TO=127;e.OUT_REMOVE_COLLISION_TEST=128;e.OUT_REMOVE_CONSTRAINT=129;e.OUT_RESUME=130;e.OUT_SET_CHARACTER_FLY_VELOCITY=131;e.OUT_SET_CHARACTER_HOR_ROTATION=132;e.OUT_SET_CHARACTER_MOVE_DIR=133;e.OUT_SET_CHARACTER_MOVE_TYPE=134;e.OUT_SET_CHARACTER_ROTATION=135;e.OUT_SET_CHARACTER_RUN_VELOCITY=136;e.OUT_SET_CHARACTER_VERT_ROTATION=
137;e.OUT_SET_CHARACTER_WALK_VELOCITY=138;e.OUT_SET_GRAVITY=139;e.OUT_SET_LINEAR_VELOCITY=140;e.OUT_SET_TRANSFORM=141;e.OUT_SET_WATER_TIME=142;e.OUT_ADD_WATER_WRAPPER=143;e.OUT_UPDATE_BOAT_CONTROLS=144;e.OUT_UPDATE_CAR_CONTROLS=145;e.OUT_PING=146;e.OUT_DEBUG=147;e.OUT_UPDATE_WORLD=148;e.OUT_SET_ANGULAR_VELOCITY=149;e.OUT_SET_CHARACTER_VERT_MOVE_DIR_ANGLE=150;e.OUT_UPDATE_BOUNDING_BODY=151;e.OUT_UPDATE_STATIC_MESH_BODY=152;var T=e.OUT_SET_TRANSFORM,C=R.a.worker_listeners,z=R.a.worker_namespaces,G=
{msg_id:f,body_id:0,time:0,trans:new Float32Array(3),quat:new Float32Array(4),linvel:new Float32Array(3),angvel:new Float32Array(3),len:0},E={msg_id:c,chassis_hull_body_id:0,prop_ind:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},J={msg_id:m,id:0,body_id_hit:0,hit_fract:0,hit_time:0,len:0},M={msg_id:b,id:0,body_id_hit:0,hit_fract:0,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),len:0},F={msg_id:B,body_id_a:0,body_id_b:0,result:0,len:0},U={msg_id:l,body_id_a:0,body_id_b:0,
result:0,coll_point:new Float32Array(3),coll_norm:new Float32Array(3),coll_dist:0,len:0},K={msg_id:T,body_id:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},sa=[G,E,J,M,F,U,K];e.create_worker=function(b,c){var f={is_main:b?!0:!1,web_worker:null,buf_arr:[],fb_worker_ns:""};if(c)if(f.web_worker={addEventListener:function(a,b,c){"message"!=a&&p.panic("Wrong web worker event");t(f.fb_worker_ns,f.is_main,b)},removeEventListener:function(a,b,c){"message"!=a&&p.panic("Wrong web worker event");
t(f.fb_worker_ns,f.is_main,null)},postMessage:function(a,b){var c;a:{for(c=0;c<z.length;c+=2)if(z[c+1]==f.fb_worker_ns){c=C[c+Number(!!f.is_main)];break a}c=null}c({data:a})},terminate:function(){for(var a=0;a<z.length;a+=2)if(z[a+1]==f.fb_worker_ns){C.splice(a,2);z.splice(a,2);break}}},f.is_main){var e=u.unique_name(d+"_worker");z.push(d);z.push(e);C.push(null);C.push(null);f.fb_worker_ns=e;(e=k(b))?a?e.addEventListener("load",function(){R.a.require("__bindings",f.fb_worker_ns)},!1):(R.a.cleanup("__bindings",
f.fb_worker_ns),R.a.cleanup("__ipc",f.fb_worker_ns),R.a.require("__bindings",f.fb_worker_ns)):(e=document.createElement("script"),e.src=b,e.defer="defer",e.async="async",e.addEventListener("load",function(){a=!1;R.a.require("__bindings",f.fb_worker_ns)},!1),document.head.appendChild(e))}else f.fb_worker_ns=d;else f.web_worker=b?new Worker(b):self;return f};e.attach_handler=function(a,d){r(sa);var e=function(k){if(k.constructor==ArrayBuffer)k=new Float32Array(k);else if(k[0].constructor==ArrayBuffer){for(var n=
0;n<k.length;n++)e(k[n]);return}n=k[0]|0;switch(n){case f:var q=G;q.body_id=k[1]|0;q.time=k[2];q.trans[0]=k[3];q.trans[1]=k[4];q.trans[2]=k[5];q.quat[0]=k[6];q.quat[1]=k[7];q.quat[2]=k[8];q.quat[3]=k[9];q.linvel[0]=k[10];q.linvel[1]=k[11];q.linvel[2]=k[12];q.angvel[0]=k[13];q.angvel[1]=k[14];q.angvel[2]=k[15];break;case c:q=E;q.chassis_hull_body_id=k[1]|0;q.prop_ind=k[2]|0;q.trans[0]=k[3];q.trans[1]=k[4];q.trans[2]=k[5];q.quat[0]=k[6];q.quat[1]=k[7];q.quat[2]=k[8];q.quat[3]=k[9];break;case m:q=J;
q.id=k[1]|0;q.body_id_hit=k[2]|0;q.hit_fract=k[3];q.hit_time=k[4];break;case b:q=M;q.id=k[1]|0;q.body_id_hit=k[2]|0;q.hit_fract=k[3];q.hit_time=k[4];q.hit_pos[0]=k[5];q.hit_pos[1]=k[6];q.hit_pos[2]=k[7];q.hit_norm[0]=k[8];q.hit_norm[1]=k[9];q.hit_norm[2]=k[10];break;case B:q=F;q.body_id_a=k[1]|0;q.body_id_b=k[2]|0;q.result=!!k[3];break;case l:q=U;q.body_id_a=k[1]|0;q.body_id_b=k[2]|0;q.result=!!k[3];q.coll_point[0]=k[4];q.coll_point[1]=k[5];q.coll_point[2]=k[6];q.coll_norm[0]=k[7];q.coll_norm[1]=
k[8];q.coll_norm[2]=k[9];q.coll_dist=k[10];break;case T:q=K;q.body_id=k[1]|0;q.trans[0]=k[2];q.trans[1]=k[3];q.trans[2]=k[4];q.quat[0]=k[5];q.quat[1]=k[6];q.quat[2]=k[7];q.quat[3]=k[8];break;default:q=k}d(a,n,q)};a.web_worker.addEventListener("message",function(a){e(a.data)},!1)};e.cleanup=function(){};e.post_msg=function(a,d){if(a)switch(d){case f:var e=G,k=new Float32Array(e.len);k[0]=e.msg_id;k[1]=e.body_id;k[2]=e.time;k[3]=e.trans[0];k[4]=e.trans[1];k[5]=e.trans[2];k[6]=e.quat[0];k[7]=e.quat[1];
k[8]=e.quat[2];k[9]=e.quat[3];k[10]=e.linvel[0];k[11]=e.linvel[1];k[12]=e.linvel[2];k[13]=e.angvel[0];k[14]=e.angvel[1];k[15]=e.angvel[2];a.buf_arr.push(k.buffer);break;case c:e=E;k=new Float32Array(e.len);k[0]=e.msg_id;k[1]=e.chassis_hull_body_id;k[2]=e.prop_ind;k[3]=e.trans[0];k[4]=e.trans[1];k[5]=e.trans[2];k[6]=e.quat[0];k[7]=e.quat[1];k[8]=e.quat[2];k[9]=e.quat[3];a.buf_arr.push(k.buffer);break;case m:e=J;k=new Float32Array(e.len);k[0]=e.msg_id;k[1]=e.id;k[2]=e.body_id_hit;k[3]=e.hit_fract;k[4]=
e.hit_time;a.buf_arr.push(k.buffer);break;case b:e=M;k=new Float32Array(e.len);k[0]=e.msg_id;k[1]=e.id;k[2]=e.body_id_hit;k[3]=e.hit_fract;k[4]=e.hit_time;k[5]=e.hit_pos[0];k[6]=e.hit_pos[1];k[7]=e.hit_pos[2];k[8]=e.hit_norm[0];k[9]=e.hit_norm[1];k[10]=e.hit_norm[2];a.buf_arr.push(k.buffer);break;case B:e=F;k=new Float32Array(e.len);k[0]=e.msg_id;k[1]=e.body_id_a;k[2]=e.body_id_b;k[3]=e.result;a.buf_arr.push(k.buffer);break;case l:e=U;k=new Float32Array(e.len);k[0]=e.msg_id;k[1]=e.body_id_a;k[2]=
e.body_id_b;k[3]=e.result;k[4]=e.coll_point[0];k[5]=e.coll_point[1];k[6]=e.coll_point[2];k[7]=e.coll_norm[0];k[8]=e.coll_norm[1];k[9]=e.coll_norm[2];k[10]=e.coll_dist;a.buf_arr.push(k.buffer);break;case T:e=K;k=new Float32Array(e.len);k[0]=e.msg_id;k[1]=e.body_id;k[2]=e.trans[0];k[3]=e.trans[1];k[4]=e.trans[2];k[5]=e.quat[0];k[6]=e.quat[1];k[7]=e.quat[2];k[8]=e.quat[3];a.buf_arr.push(k.buffer);break;default:k=[];for(e=1;e<arguments.length;e++)k.push(arguments[e]);a.web_worker.postMessage(k)}};e.post_msg_arr=
function(a){a&&a.buf_arr.length&&(a.web_worker.postMessage(a.buf_arr),a.buf_arr.length=0)};e.get_msg_cache=function(a){switch(a){case f:return G;case c:return E;case m:return J;case b:return M;case B:return F;case l:return U;case T:return K;default:return null}};e.terminate=function(a){a.web_worker.terminate();a.web_worker=null};e.is_active=function(a){return!!a.web_worker};e.is_fallback=function(a){return!!a.fb_worker_ns}});t.a=e},function(C,t,e){C=e(0);var R=e(46),V=e(20),n=e(12),y=e(22),d=e(11),
k=e(6),I=e(2),A=e(3);e=Object(C.a)("__prerender",function(e,p){function r(a,b){return a.z_index-b.z_index}function a(a,b){var c=a.obj_render;c.is_visible=!1;if(c.hide)return!1;var d=b.camera,e=b.type==f.SHADOW_CAST?d.lod_eye:k.j(d.world_tsr,C),n=a.batch;if(!m.update_lod_visibility(n,c,e))return!1;c.is_visible=!0;if(b.type==f.DEBUG_VIEW)return b.debug_view_mode==l.DV_BOUNDINGS?n.debug_sphere:!n.debug_sphere;if(b.type==f.OUTLINE_MASK&&0==c.outline_intensity)return!1;if(c=!(n.do_not_cull||!a.world_bounds)&&
!0){var d=d.frustum_planes,e=a.world_bounds.bs,c=a.world_bounds.be,p=n.use_be,n=e.center;if(I._56(n,d,e.radius))c=!0;else if(p)var e=c.axis_x,p=c.axis_y,r=c.axis_z,n=c.center,c=I.X(n,d,e,p,r);else c=!1}return c?!1:!0}function t(a){var b=a.particles_data;if(b&&b.need_buffers_update){a=a.bufs_data;c.make_dynamic(a);var d=a.pointers;c.vbo_source_data_set_attr(a.vbo_source_data,"a_position",b.positions_cache,d.a_position.offset);c.vbo_source_data_set_attr(a.vbo_source_data,"a_tbn",b.tbn_cache,d.a_tbn.offset);
c.update_gl_buffers(a)}}var l=Object(R.a)(e),c=Object(V.a)(e),m=Object(n.a)(e),b=Object(y.a)(e),f=Object(d.a)(e),T=[f.MAIN_OPAQUE,f.MAIN_BLEND,f.MAIN_PLANE_REFLECT,f.MAIN_CUBE_REFLECT,f.MAIN_PLANE_REFLECT_BLEND,f.MAIN_CUBE_REFLECT_BLEND,f.MAIN_GLOW,f.MAIN_XRAY,f.SHADOW_CAST,f.SHADOW_RECEIVE,f.OUTLINE_MASK,f.DEBUG_VIEW,f.COLOR_PICKING,f.COLOR_PICKING_XRAY],C=new Float32Array(3);p.prerender_subs=function(c){if(-1<T.indexOf(c.type)){for(var d=!1,e=c.type==f.MAIN_CUBE_REFLECT||c.type==f.MAIN_CUBE_REFLECT_BLEND,
l=c.draw_data,m=0;m<l.length;m++){for(var n=l[m],p=n.bundles,u=!1,z=0;z<p.length;z++){var v=p[z],y=v.batch;if(e)for(var B=0;6>B;B++)c.camera.frustum_planes=c.cube_cam_frustums[B],v.do_render_cube[B]=a(v,c),v.do_render_cube[B]&&(u=d=!0,t(y));else v.do_render=a(v,c),v.do_render&&(u=d=!0,t(y));c.need_perm_uniforms_update&&(y.shader.need_uniforms_update=!0);v.do_render?(y=k.j(c.camera.world_tsr,C),v.world_bounds?(B=v.world_bounds.bs,y=A.squaredDistance(B.center,y)+B.radius*B.radius):y=Infinity,v.z_index=
y):v.z_index=Infinity}0<p.length&&!p[0].batch.blend&&(p.sort(r),l.z_index=p[0].z_index);n.do_render=u}c.need_perm_uniforms_update=!1;switch(c.type){case f.DEBUG_VIEW:break;default:c.type==f.MAIN_OPAQUE||c.type==f.SHADOW_RECEIVE||c.type==f.MAIN_GLOW||c.type==f.MAIN_PLANE_REFLECT||c.type==f.MAIN_CUBE_REFLECT||d?c.do_render=!0:(c.do_render&&b.clear(c),c.do_render=!1)}}else if(c.need_perm_uniforms_update){l=c.draw_data;for(m=0;m<l.length;m++)for(p=l[m].bundles,z=0;z<p.length;z++)v=p[z],y=v.batch,y.shader.need_uniforms_update=
!0;c.need_perm_uniforms_update=!1}c.need_draw_data_sort&&f.sort_draw_data(c)}});t.a=e},function(C,t,e){e.d(t,"a",function(){return R});(function(e){"object"===typeof exports&&"undefined"!==typeof C?C.exports=e():("undefined"!==typeof window?window:"undefined"!==typeof self?self:this).pako=e()})(function(){return function n(e,d,k){function t(p,r){if(!d[p]){if(!e[p]){if(A)return A(p,!0);var a=Error("Cannot find module '"+p+"'");throw a.code="MODULE_NOT_FOUND",a;}a=d[p]={exports:{}};e[p][0].call(a.exports,
function(a){var d=e[p][1][a];return t(d?d:a)},a,a.exports,n,e,d,k)}return d[p].exports}for(var A=!1,r=0;r<k.length;r++)t(k[r]);return t}({1:[function(e,t,d){e="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Int32Array;d.assign=function(d){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var k=e.shift();if(k){if("object"!==typeof k)throw new TypeError(k+"must be non-object");for(var n in k)k.hasOwnProperty(n)&&(d[n]=k[n])}}return d};d.shrinkBuf=function(d,
e){if(d.length===e)return d;if(d.subarray)return d.subarray(0,e);d.length=e;return d};var k={arraySet:function(d,e,k,n,a){if(e.subarray&&d.subarray)d.set(e.subarray(k,k+n),a);else for(var p=0;p<n;p++)d[a+p]=e[k+p]},flattenChunks:function(d){var e,k,n,a,t;e=n=0;for(k=d.length;e<k;e++)n+=d[e].length;t=new Uint8Array(n);e=n=0;for(k=d.length;e<k;e++)a=d[e],t.set(a,n),n+=a.length;return t}},n={arraySet:function(d,e,k,n,a){for(var p=0;p<n;p++)d[a+p]=e[k+p]},flattenChunks:function(d){return[].concat.apply([],
d)}};d.setTyped=function(e){e?(d.Buf8=Uint8Array,d.Buf16=Uint16Array,d.Buf32=Int32Array,d.assign(d,k)):(d.Buf8=Array,d.Buf16=Array,d.Buf32=Array,d.assign(d,n))};d.setTyped(e)},{}],2:[function(e,t,d){function k(d,a){if(65537>a&&(d.subarray&&r||!d.subarray&&y))return String.fromCharCode.apply(null,n.shrinkBuf(d,a));for(var e="",l=0;l<a;l++)e+=String.fromCharCode(d[l]);return e}var n=e("./common"),y=!0,r=!0;try{String.fromCharCode.apply(null,[0])}catch(u){y=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(u){r=
!1}var p=new n.Buf8(256);for(e=0;256>e;e++)p[e]=252<=e?6:248<=e?5:240<=e?4:224<=e?3:192<=e?2:1;p[254]=p[254]=1;d.string2buf=function(d){var a,e,l,c,k,b=d.length,f=0;for(c=0;c<b;c++)e=d.charCodeAt(c),55296===(e&64512)&&c+1<b&&(l=d.charCodeAt(c+1),56320===(l&64512)&&(e=65536+(e-55296<<10)+(l-56320),c++)),f+=128>e?1:2048>e?2:65536>e?3:4;a=new n.Buf8(f);for(c=k=0;k<f;c++)e=d.charCodeAt(c),55296===(e&64512)&&c+1<b&&(l=d.charCodeAt(c+1),56320===(l&64512)&&(e=65536+(e-55296<<10)+(l-56320),c++)),128>e?a[k++]=
e:(2048>e?a[k++]=192|e>>>6:(65536>e?a[k++]=224|e>>>12:(a[k++]=240|e>>>18,a[k++]=128|e>>>12&63),a[k++]=128|e>>>6&63),a[k++]=128|e&63);return a};d.buf2binstring=function(d){return k(d,d.length)};d.binstring2buf=function(d){for(var a=new n.Buf8(d.length),e=0,l=a.length;e<l;e++)a[e]=d.charCodeAt(e);return a};d.buf2string=function(d,a){var e,l,c,m,b=a||d.length,f=Array(2*b);for(e=l=0;e<b;)if(c=d[e++],128>c)f[l++]=c;else if(m=p[c],4<m)f[l++]=65533,e+=m-1;else{for(c&=2===m?31:3===m?15:7;1<m&&e<b;)c=c<<6|
d[e++]&63,m--;1<m?f[l++]=65533:65536>c?f[l++]=c:(c-=65536,f[l++]=55296|c>>10&1023,f[l++]=56320|c&1023)}return k(f,l)};d.utf8border=function(d,a){var e;a=a||d.length;a>d.length&&(a=d.length);for(e=a-1;0<=e&&128===(d[e]&192);)e--;return 0>e||0===e?a:e+p[d[e]]>a?e:a}},{"./common":1}],3:[function(e,t,d){t.exports=function(d,e,n,r){var k=d&65535|0;d=d>>>16&65535|0;for(var u;0!==n;){u=2E3<n?2E3:n;n-=u;do k=k+e[r++]|0,d=d+k|0;while(--u);k%=65521;d%=65521}return k|d<<16|0}},{}],4:[function(e,t,d){t.exports=
{Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],5:[function(e,t,d){var k=function(){for(var d,e=[],k=0;256>k;k++){d=k;for(var n=0;8>n;n++)d=d&1?3988292384^d>>>1:
d>>>1;e[k]=d}return e}();t.exports=function(d,e,n,p){n=p+n;for(d^=-1;p<n;p++)d=d>>>8^k[(d^e[p])&255];return d^-1}},{}],6:[function(e,t,d){t.exports=function(){this.os=this.xflags=this.time=this.text=0;this.extra=null;this.extra_len=0;this.comment=this.name="";this.hcrc=0;this.done=!1}},{}],7:[function(e,t,d){t.exports=function(d,e){var k,n,p,u,a,t,l,c,m,b,f,y,I,z,G,E,J,M,F,C,K,R,v,Y;k=d.state;n=d.next_in;v=d.input;p=n+(d.avail_in-5);u=d.next_out;Y=d.output;a=u-(e-d.avail_out);t=u+(d.avail_out-257);
l=k.dmax;c=k.wsize;m=k.whave;b=k.wnext;f=k.window;y=k.hold;I=k.bits;z=k.lencode;G=k.distcode;E=(1<<k.lenbits)-1;J=(1<<k.distbits)-1;a:do b:for(15>I&&(y+=v[n++]<<I,I+=8,y+=v[n++]<<I,I+=8),M=z[y&E];;){F=M>>>24;y>>>=F;I-=F;F=M>>>16&255;if(0===F)Y[u++]=M&65535;else if(F&16){C=M&65535;if(F&=15)I<F&&(y+=v[n++]<<I,I+=8),C+=y&(1<<F)-1,y>>>=F,I-=F;15>I&&(y+=v[n++]<<I,I+=8,y+=v[n++]<<I,I+=8);M=G[y&J];c:for(;;){F=M>>>24;y>>>=F;I-=F;F=M>>>16&255;if(F&16){M&=65535;F&=15;I<F&&(y+=v[n++]<<I,I+=8,I<F&&(y+=v[n++]<<
I,I+=8));M+=y&(1<<F)-1;if(M>l){d.msg="invalid distance too far back";k.mode=30;break a}y>>>=F;I-=F;F=u-a;if(M>F){F=M-F;if(F>m&&k.sane){d.msg="invalid distance too far back";k.mode=30;break a}K=0;R=f;if(0===b){if(K+=c-F,F<C){C-=F;do Y[u++]=f[K++];while(--F);K=u-M;R=Y}}else if(b<F){if(K+=c+b-F,F-=b,F<C){C-=F;do Y[u++]=f[K++];while(--F);K=0;if(b<C){F=b;C-=F;do Y[u++]=f[K++];while(--F);K=u-M;R=Y}}}else if(K+=b-F,F<C){C-=F;do Y[u++]=f[K++];while(--F);K=u-M;R=Y}for(;2<C;)Y[u++]=R[K++],Y[u++]=R[K++],Y[u++]=
R[K++],C-=3;C&&(Y[u++]=R[K++],1<C&&(Y[u++]=R[K++]))}else{K=u-M;do Y[u++]=Y[K++],Y[u++]=Y[K++],Y[u++]=Y[K++],C-=3;while(2<C);C&&(Y[u++]=Y[K++],1<C&&(Y[u++]=Y[K++]))}}else if(0===(F&64)){M=G[(M&65535)+(y&(1<<F)-1)];continue c}else{d.msg="invalid distance code";k.mode=30;break a}break}}else if(0===(F&64)){M=z[(M&65535)+(y&(1<<F)-1)];continue b}else{F&32?k.mode=12:(d.msg="invalid literal/length code",k.mode=30);break a}break}while(n<p&&u<t);C=I>>3;n-=C;I-=C<<3;d.next_in=n;d.next_out=u;d.avail_in=n<p?
5+(p-n):5-(n-p);d.avail_out=u<t?257+(t-u):257-(u-t);k.hold=y&(1<<I)-1;k.bits=I}},{}],8:[function(e,t,d){function k(a){return(a>>>24&255)+(a>>>8&65280)+((a&65280)<<8)+((a&255)<<24)}function n(){this.mode=0;this.last=!1;this.wrap=0;this.havedict=!1;this.total=this.check=this.dmax=this.flags=0;this.head=null;this.wnext=this.whave=this.wsize=this.wbits=0;this.window=null;this.extra=this.offset=this.length=this.bits=this.hold=0;this.distcode=this.lencode=null;this.have=this.ndist=this.nlen=this.ncode=
this.distbits=this.lenbits=0;this.next=null;this.lens=new B.Buf16(320);this.work=new B.Buf16(288);this.distdyn=this.lendyn=null;this.was=this.back=this.sane=0}function y(a){var b;if(!a||!a.state)return-2;b=a.state;a.total_in=a.total_out=b.total=0;a.msg="";b.wrap&&(a.adler=b.wrap&1);b.mode=1;b.last=0;b.havedict=0;b.dmax=32768;b.head=null;b.hold=0;b.bits=0;b.lencode=b.lendyn=new B.Buf32(852);b.distcode=b.distdyn=new B.Buf32(592);b.sane=1;b.back=-1;return 0}function r(a){var b;if(!a||!a.state)return-2;
b=a.state;b.wsize=0;b.whave=0;b.wnext=0;return y(a)}function p(a,b){var c,d;if(!a||!a.state)return-2;d=a.state;0>b?(c=0,b=-b):(c=(b>>4)+1,48>b&&(b&=15));if(b&&(8>b||15<b))return-2;null!==d.window&&d.wbits!==b&&(d.window=null);d.wrap=c;d.wbits=b;return r(a)}function u(a,b){var c;if(!a)return-2;c=new n;a.state=c;c.window=null;c=p(a,b);0!==c&&(a.state=null);return c}function a(a,b,c,d){var e=a.state;null===e.window&&(e.wsize=1<<e.wbits,e.wnext=0,e.whave=0,e.window=new B.Buf8(e.wsize));d>=e.wsize?(B.arraySet(e.window,
b,c-e.wsize,e.wsize,0),e.wnext=0,e.whave=e.wsize):(a=e.wsize-e.wnext,a>d&&(a=d),B.arraySet(e.window,b,c-d,a,e.wnext),(d-=a)?(B.arraySet(e.window,b,c-d,d,0),e.wnext=d,e.whave=e.wsize):(e.wnext+=a,e.wnext===e.wsize&&(e.wnext=0),e.whave<e.wsize&&(e.whave+=a)));return 0}var B=e("../utils/common"),l=e("./adler32"),c=e("./crc32"),m=e("./inffast"),b=e("./inftrees"),f=!0,C,R;d.inflateReset=r;d.inflateReset2=p;d.inflateResetKeep=y;d.inflateInit=function(a){return u(a,15)};d.inflateInit2=u;d.inflate=function(d,
e){var n,p,r,u,z,t,y,v,A,G,I,L,q,w,T,H,D,h,ia=new B.Buf8(4),ra=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!d||!d.state||!d.output||!d.input&&0!==d.avail_in)return-2;n=d.state;12===n.mode&&(n.mode=13);z=d.next_out;r=d.output;y=d.avail_out;u=d.next_in;p=d.input;t=d.avail_in;v=n.hold;A=n.bits;G=t;I=y;h=0;a:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;16>A;){if(0===t)break a;t--;v+=p[u++]<<A;A+=8}if(n.wrap&2&&35615===v){n.check=0;ia[0]=v&255;ia[1]=v>>>8&255;n.check=c(n.check,
ia,2,0);A=v=0;n.mode=2;break}n.flags=0;n.head&&(n.head.done=!1);if(!(n.wrap&1)||(((v&255)<<8)+(v>>8))%31){d.msg="incorrect header check";n.mode=30;break}if(8!==(v&15)){d.msg="unknown compression method";n.mode=30;break}v>>>=4;A-=4;q=(v&15)+8;if(0===n.wbits)n.wbits=q;else if(q>n.wbits){d.msg="invalid window size";n.mode=30;break}n.dmax=1<<q;d.adler=n.check=1;n.mode=v&512?10:12;A=v=0;break;case 2:for(;16>A;){if(0===t)break a;t--;v+=p[u++]<<A;A+=8}n.flags=v;if(8!==(n.flags&255)){d.msg="unknown compression method";
n.mode=30;break}if(n.flags&57344){d.msg="unknown header flags set";n.mode=30;break}n.head&&(n.head.text=v>>8&1);n.flags&512&&(ia[0]=v&255,ia[1]=v>>>8&255,n.check=c(n.check,ia,2,0));A=v=0;n.mode=3;case 3:for(;32>A;){if(0===t)break a;t--;v+=p[u++]<<A;A+=8}n.head&&(n.head.time=v);n.flags&512&&(ia[0]=v&255,ia[1]=v>>>8&255,ia[2]=v>>>16&255,ia[3]=v>>>24&255,n.check=c(n.check,ia,4,0));A=v=0;n.mode=4;case 4:for(;16>A;){if(0===t)break a;t--;v+=p[u++]<<A;A+=8}n.head&&(n.head.xflags=v&255,n.head.os=v>>8);n.flags&
512&&(ia[0]=v&255,ia[1]=v>>>8&255,n.check=c(n.check,ia,2,0));A=v=0;n.mode=5;case 5:if(n.flags&1024){for(;16>A;){if(0===t)break a;t--;v+=p[u++]<<A;A+=8}n.length=v;n.head&&(n.head.extra_len=v);n.flags&512&&(ia[0]=v&255,ia[1]=v>>>8&255,n.check=c(n.check,ia,2,0));A=v=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(n.flags&1024&&(L=n.length,L>t&&(L=t),L&&(n.head&&(q=n.head.extra_len-n.length,n.head.extra||(n.head.extra=Array(n.head.extra_len)),B.arraySet(n.head.extra,p,u,L,q)),n.flags&512&&(n.check=
c(n.check,p,L,u)),t-=L,u+=L,n.length-=L),n.length))break a;n.length=0;n.mode=7;case 7:if(n.flags&2048){if(0===t)break a;L=0;do q=p[u+L++],n.head&&q&&65536>n.length&&(n.head.name+=String.fromCharCode(q));while(q&&L<t);n.flags&512&&(n.check=c(n.check,p,L,u));t-=L;u+=L;if(q)break a}else n.head&&(n.head.name=null);n.length=0;n.mode=8;case 8:if(n.flags&4096){if(0===t)break a;L=0;do q=p[u+L++],n.head&&q&&65536>n.length&&(n.head.comment+=String.fromCharCode(q));while(q&&L<t);n.flags&512&&(n.check=c(n.check,
p,L,u));t-=L;u+=L;if(q)break a}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(n.flags&512){for(;16>A;){if(0===t)break a;t--;v+=p[u++]<<A;A+=8}if(v!==(n.check&65535)){d.msg="header crc mismatch";n.mode=30;break}A=v=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0);d.adler=n.check=0;n.mode=12;break;case 10:for(;32>A;){if(0===t)break a;t--;v+=p[u++]<<A;A+=8}d.adler=n.check=k(v);A=v=0;n.mode=11;case 11:if(0===n.havedict)return d.next_out=z,d.avail_out=y,d.next_in=u,d.avail_in=t,n.hold=v,n.bits=
A,2;d.adler=n.check=1;n.mode=12;case 12:if(5===e||6===e)break a;case 13:if(n.last){v>>>=A&7;A-=A&7;n.mode=27;break}for(;3>A;){if(0===t)break a;t--;v+=p[u++]<<A;A+=8}n.last=v&1;v>>>=1;--A;switch(v&3){case 0:n.mode=14;break;case 1:q=n;if(f){C=new B.Buf32(512);R=new B.Buf32(32);for(L=0;144>L;)q.lens[L++]=8;for(;256>L;)q.lens[L++]=9;for(;280>L;)q.lens[L++]=7;for(;288>L;)q.lens[L++]=8;b(1,q.lens,0,288,C,0,q.work,{bits:9});for(L=0;32>L;)q.lens[L++]=5;b(2,q.lens,0,32,R,0,q.work,{bits:5});f=!1}q.lencode=
C;q.lenbits=9;q.distcode=R;q.distbits=5;n.mode=20;if(6===e){v>>>=2;A-=2;break a}break;case 2:n.mode=17;break;case 3:d.msg="invalid block type",n.mode=30}v>>>=2;A-=2;break;case 14:v>>>=A&7;for(A-=A&7;32>A;){if(0===t)break a;t--;v+=p[u++]<<A;A+=8}if((v&65535)!==(v>>>16^65535)){d.msg="invalid stored block lengths";n.mode=30;break}n.length=v&65535;A=v=0;n.mode=15;if(6===e)break a;case 15:n.mode=16;case 16:if(L=n.length){L>t&&(L=t);L>y&&(L=y);if(0===L)break a;B.arraySet(r,p,u,L,z);t-=L;u+=L;y-=L;z+=L;
n.length-=L;break}n.mode=12;break;case 17:for(;14>A;){if(0===t)break a;t--;v+=p[u++]<<A;A+=8}n.nlen=(v&31)+257;v>>>=5;A-=5;n.ndist=(v&31)+1;v>>>=5;A-=5;n.ncode=(v&15)+4;v>>>=4;A-=4;if(286<n.nlen||30<n.ndist){d.msg="too many length or distance symbols";n.mode=30;break}n.have=0;n.mode=18;case 18:for(;n.have<n.ncode;){for(;3>A;){if(0===t)break a;t--;v+=p[u++]<<A;A+=8}n.lens[ra[n.have++]]=v&7;v>>>=3;A-=3}for(;19>n.have;)n.lens[ra[n.have++]]=0;n.lencode=n.lendyn;n.lenbits=7;L={bits:n.lenbits};h=b(0,n.lens,
0,19,n.lencode,0,n.work,L);n.lenbits=L.bits;if(h){d.msg="invalid code lengths set";n.mode=30;break}n.have=0;n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;;){T=n.lencode[v&(1<<n.lenbits)-1];L=T>>>24;T&=65535;if(L<=A)break;if(0===t)break a;t--;v+=p[u++]<<A;A+=8}if(16>T)v>>>=L,A-=L,n.lens[n.have++]=T;else{if(16===T){for(q=L+2;A<q;){if(0===t)break a;t--;v+=p[u++]<<A;A+=8}v>>>=L;A-=L;if(0===n.have){d.msg="invalid bit length repeat";n.mode=30;break}q=n.lens[n.have-1];L=3+(v&3);v>>>=2;A-=2}else if(17===
T){for(q=L+3;A<q;){if(0===t)break a;t--;v+=p[u++]<<A;A+=8}v>>>=L;A-=L;q=0;L=3+(v&7);v>>>=3;A-=3}else{for(q=L+7;A<q;){if(0===t)break a;t--;v+=p[u++]<<A;A+=8}v>>>=L;A-=L;q=0;L=11+(v&127);v>>>=7;A-=7}if(n.have+L>n.nlen+n.ndist){d.msg="invalid bit length repeat";n.mode=30;break}for(;L--;)n.lens[n.have++]=q}}if(30===n.mode)break;if(0===n.lens[256]){d.msg="invalid code -- missing end-of-block";n.mode=30;break}n.lenbits=9;L={bits:n.lenbits};h=b(1,n.lens,0,n.nlen,n.lencode,0,n.work,L);n.lenbits=L.bits;if(h){d.msg=
"invalid literal/lengths set";n.mode=30;break}n.distbits=6;n.distcode=n.distdyn;L={bits:n.distbits};h=b(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,L);n.distbits=L.bits;if(h){d.msg="invalid distances set";n.mode=30;break}n.mode=20;if(6===e)break a;case 20:n.mode=21;case 21:if(6<=t&&258<=y){d.next_out=z;d.avail_out=y;d.next_in=u;d.avail_in=t;n.hold=v;n.bits=A;m(d,I);z=d.next_out;r=d.output;y=d.avail_out;u=d.next_in;p=d.input;t=d.avail_in;v=n.hold;A=n.bits;12===n.mode&&(n.back=-1);break}for(n.back=
0;;){T=n.lencode[v&(1<<n.lenbits)-1];L=T>>>24;q=T>>>16&255;T&=65535;if(L<=A)break;if(0===t)break a;t--;v+=p[u++]<<A;A+=8}if(q&&0===(q&240)){w=L;H=q;for(D=T;;){T=n.lencode[D+((v&(1<<w+H)-1)>>w)];L=T>>>24;q=T>>>16&255;T&=65535;if(w+L<=A)break;if(0===t)break a;t--;v+=p[u++]<<A;A+=8}v>>>=w;A-=w;n.back+=w}v>>>=L;A-=L;n.back+=L;n.length=T;if(0===q){n.mode=26;break}if(q&32){n.back=-1;n.mode=12;break}if(q&64){d.msg="invalid literal/length code";n.mode=30;break}n.extra=q&15;n.mode=22;case 22:if(n.extra){for(q=
n.extra;A<q;){if(0===t)break a;t--;v+=p[u++]<<A;A+=8}n.length+=v&(1<<n.extra)-1;v>>>=n.extra;A-=n.extra;n.back+=n.extra}n.was=n.length;n.mode=23;case 23:for(;;){T=n.distcode[v&(1<<n.distbits)-1];L=T>>>24;q=T>>>16&255;T&=65535;if(L<=A)break;if(0===t)break a;t--;v+=p[u++]<<A;A+=8}if(0===(q&240)){w=L;H=q;for(D=T;;){T=n.distcode[D+((v&(1<<w+H)-1)>>w)];L=T>>>24;q=T>>>16&255;T&=65535;if(w+L<=A)break;if(0===t)break a;t--;v+=p[u++]<<A;A+=8}v>>>=w;A-=w;n.back+=w}v>>>=L;A-=L;n.back+=L;if(q&64){d.msg="invalid distance code";
n.mode=30;break}n.offset=T;n.extra=q&15;n.mode=24;case 24:if(n.extra){for(q=n.extra;A<q;){if(0===t)break a;t--;v+=p[u++]<<A;A+=8}n.offset+=v&(1<<n.extra)-1;v>>>=n.extra;A-=n.extra;n.back+=n.extra}if(n.offset>n.dmax){d.msg="invalid distance too far back";n.mode=30;break}n.mode=25;case 25:if(0===y)break a;L=I-y;if(n.offset>L){L=n.offset-L;if(L>n.whave&&n.sane){d.msg="invalid distance too far back";n.mode=30;break}L>n.wnext?(L-=n.wnext,q=n.wsize-L):q=n.wnext-L;L>n.length&&(L=n.length);w=n.window}else w=
r,q=z-n.offset,L=n.length;L>y&&(L=y);y-=L;n.length-=L;do r[z++]=w[q++];while(--L);0===n.length&&(n.mode=21);break;case 26:if(0===y)break a;r[z++]=n.length;y--;n.mode=21;break;case 27:if(n.wrap){for(;32>A;){if(0===t)break a;t--;v|=p[u++]<<A;A+=8}I-=y;d.total_out+=I;n.total+=I;I&&(d.adler=n.check=n.flags?c(n.check,r,I,z-I):l(n.check,r,I,z-I));I=y;if((n.flags?v:k(v))!==n.check){d.msg="incorrect data check";n.mode=30;break}A=v=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;32>A;){if(0===t)break a;t--;v+=
p[u++]<<A;A+=8}if(v!==(n.total&4294967295)){d.msg="incorrect length check";n.mode=30;break}A=v=0}n.mode=29;case 29:h=1;break a;case 30:h=-3;break a;case 31:return-4;default:return-2}d.next_out=z;d.avail_out=y;d.next_in=u;d.avail_in=t;n.hold=v;n.bits=A;if((n.wsize||I!==d.avail_out&&30>n.mode&&(27>n.mode||4!==e))&&a(d,d.output,d.next_out,I-d.avail_out))return n.mode=31,-4;G-=d.avail_in;I-=d.avail_out;d.total_in+=G;d.total_out+=I;n.total+=I;n.wrap&&I&&(d.adler=n.check=n.flags?c(n.check,r,I,d.next_out-
I):l(n.check,r,I,d.next_out-I));d.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0);(0===G&&0===I||4===e)&&0===h&&(h=-5);return h};d.inflateEnd=function(a){if(!a||!a.state)return-2;var b=a.state;b.window&&(b.window=null);a.state=null;return 0};d.inflateGetHeader=function(a,b){var c;if(!a||!a.state)return-2;c=a.state;if(0===(c.wrap&2))return-2;c.head=b;b.done=!1;return 0};d.inflateSetDictionary=function(b,c){var d=c.length,e,f;if(!b||!b.state)return-2;e=b.state;if(0!==
e.wrap&&11!==e.mode)return-2;if(11===e.mode&&(f=l(1,c,d,0),f!==e.check))return-3;if(a(b,c,d,d))return e.mode=31,-4;e.havedict=1;return 0};d.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":1,"./adler32":3,"./crc32":5,"./inffast":7,"./inftrees":9}],9:[function(e,t,d){var k=e("../utils/common"),n=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],A=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,
78],r=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],p=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(d,a,e,l,c,m,b,f){var u=f.bits,t,z,y,E,B,I,F,C,K,R,v,Y,ha,S=0,L,q=new k.Buf16(16);B=new k.Buf16(16);var w,ea=0,H,D,h;for(t=0;15>=t;t++)q[t]=0;for(z=0;z<l;z++)q[a[e+z]]++;E=u;for(y=15;1<=y&&0===q[y];y--);E>y&&(E=y);if(0===y)return c[m++]=20971520,c[m++]=20971520,
f.bits=1,0;for(u=1;u<y&&0===q[u];u++);E<u&&(E=u);for(t=I=1;15>=t;t++)if(I<<=1,I-=q[t],0>I)return-1;if(0<I&&(0===d||1!==y))return-1;B[1]=0;for(t=1;15>t;t++)B[t+1]=B[t]+q[t];for(z=0;z<l;z++)0!==a[e+z]&&(b[B[a[e+z]]++]=z);0===d?(ha=w=b,L=19):1===d?(ha=n,S-=257,w=A,ea-=257,L=256):(ha=r,w=p,L=-1);z=C=0;t=u;Y=m;l=E;B=0;R=-1;F=1<<E;v=F-1;if(1===d&&852<F||2===d&&592<F)return 1;for(;;){H=t-B;b[z]<L?(D=0,h=b[z]):b[z]>L?(D=w[ea+b[z]],h=ha[S+b[z]]):(D=96,h=0);I=1<<t-B;u=K=1<<l;do K-=I,c[Y+(C>>B)+K]=H<<24|D<<
16|h|0;while(0!==K);for(I=1<<t-1;C&I;)I>>=1;0!==I?(C&=I-1,C+=I):C=0;z++;if(0===--q[t]){if(t===y)break;t=a[e+b[z]]}if(t>E&&(C&v)!==R){0===B&&(B=E);Y+=u;l=t-B;for(I=1<<l;l+B<y;){I-=q[l+B];if(0>=I)break;l++;I<<=1}F+=1<<l;if(1===d&&852<F||2===d&&592<F)return 1;R=C&v;c[R]=E<<24|l<<16|Y-m|0}}0!==C&&(c[Y+C]=t-B<<24|4194304);f.bits=E;return 0}},{"../utils/common":1}],10:[function(e,t,d){t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory",
"-5":"buffer error","-6":"incompatible version"}},{}],11:[function(e,t,d){t.exports=function(){this.input=null;this.total_in=this.avail_in=this.next_in=0;this.output=null;this.total_out=this.avail_out=this.next_out=0;this.msg="";this.state=null;this.data_type=2;this.adler=0}},{}],"/lib/inflate.js":[function(e,t,d){function k(c){if(!(this instanceof k))return new k(c);var b=this.options=r.assign({chunkSize:16384,windowBits:0,to:""},c||{});b.raw&&0<=b.windowBits&&16>b.windowBits&&(b.windowBits=-b.windowBits,
0===b.windowBits&&(b.windowBits=-15));!(0<=b.windowBits&&16>b.windowBits)||c&&c.windowBits||(b.windowBits+=32);15<b.windowBits&&48>b.windowBits&&0===(b.windowBits&15)&&(b.windowBits|=15);this.err=0;this.msg="";this.ended=!1;this.chunks=[];this.strm=new y;this.strm.avail_out=0;c=A.inflateInit2(this.strm,b.windowBits);if(c!==u.Z_OK)throw Error(a[c]);this.header=new l;A.inflateGetHeader(this.strm,this.header)}function n(c,b){var d=new k(b);d.push(c,!0);if(d.err)throw d.msg||a[d.err];return d.result}
var A=e("./zlib/inflate"),r=e("./utils/common"),p=e("./utils/strings"),u=e("./zlib/constants"),a=e("./zlib/messages"),y=e("./zlib/zstream"),l=e("./zlib/gzheader"),c=Object.prototype.toString;k.prototype.push=function(a,b){var d=this.strm,e=this.options.chunkSize,l=this.options.dictionary,k,m,n,t,y,B=!1;if(this.ended)return!1;m=b===~~b?b:!0===b?u.Z_FINISH:u.Z_NO_FLUSH;"string"===typeof a?d.input=p.binstring2buf(a):"[object ArrayBuffer]"===c.call(a)?d.input=new Uint8Array(a):d.input=a;d.next_in=0;d.avail_in=
d.input.length;do{0===d.avail_out&&(d.output=new r.Buf8(e),d.next_out=0,d.avail_out=e);k=A.inflate(d,u.Z_NO_FLUSH);k===u.Z_NEED_DICT&&l&&(k="string"===typeof l?p.string2buf(l):"[object ArrayBuffer]"===c.call(l)?new Uint8Array(l):l,k=A.inflateSetDictionary(this.strm,k));k===u.Z_BUF_ERROR&&!0===B&&(k=u.Z_OK,B=!1);if(k!==u.Z_STREAM_END&&k!==u.Z_OK)return this.onEnd(k),this.ended=!0,!1;if(d.next_out&&(0===d.avail_out||k===u.Z_STREAM_END||0===d.avail_in&&(m===u.Z_FINISH||m===u.Z_SYNC_FLUSH)))if("string"===
this.options.to)n=p.utf8border(d.output,d.next_out),t=d.next_out-n,y=p.buf2string(d.output,n),d.next_out=t,d.avail_out=e-t,t&&r.arraySet(d.output,d.output,n,t,0),this.onData(y);else this.onData(r.shrinkBuf(d.output,d.next_out));0===d.avail_in&&0===d.avail_out&&(B=!0)}while((0<d.avail_in||0===d.avail_out)&&k!==u.Z_STREAM_END);k===u.Z_STREAM_END&&(m=u.Z_FINISH);if(m===u.Z_FINISH)return k=A.inflateEnd(this.strm),this.onEnd(k),this.ended=!0,k===u.Z_OK;m===u.Z_SYNC_FLUSH&&(this.onEnd(u.Z_OK),d.avail_out=
0);return!0};k.prototype.onData=function(a){this.chunks.push(a)};k.prototype.onEnd=function(a){a===u.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):r.flattenChunks(this.chunks));this.chunks=[];this.err=a;this.msg=this.strm.msg};d.Inflate=k;d.inflate=n;d.inflateRaw=function(a,b){b=b||{};b.raw=!0;return n(a,b)};d.ungzip=n},{"./utils/common":1,"./utils/strings":2,"./zlib/constants":4,"./zlib/gzheader":6,"./zlib/inflate":8,"./zlib/messages":10,"./zlib/zstream":11}]},{},[])("/lib/inflate.js")});
var R=window.pako.inflate},function(C,t,e){e(32).a.module.shader_texts=function(e,t){e["anchors.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ; }".split(" ")}]};e["anchors.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"ANCHOR_NUM",TOKENS:["0"]},{TYPE:"include",
FILE:"std.glsl"},{TYPE:"txt",TOKENS:"uniform vec3 u_position [ ANCHOR_NUM ] ; uniform mat4 u_view_proj_matrix ; uniform vec2 u_texel_size ; GLSL_IN float a_index ; void main ( ) { int c = int ( mod ( a_index , 3.0 ) ) ; int d = int ( a_index / 3.0 ) ; vec2 e ; if ( c == 0 ) { e = vec2 ( - 4.0 * u_texel_size [ 0 ] , - u_texel_size [ 1 ] ) ; } else if ( c == 1 ) { e = vec2 ( 4.0 * u_texel_size [ 0 ] , - u_texel_size [ 1 ] ) ; } else { e = vec2 ( 0.0 , 5.0 * u_texel_size [ 1 ] ) ; } vec4 f = u_view_proj_matrix * vec4 ( u_position [ d ] , 1.0 ) ; f . xy += e * f . w ; gl_Position = f ; }".split(" ")}]};
e["color_id.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"NODES",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},{TYPE:"var",NAME:"USE_OUTLINE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_VIEW_TSR",TOKENS:["0"]},{TYPE:"var",
NAME:"USE_VIEW_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_MODEL_TSR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_MODEL_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"CAMERA_TYPE",TOKENS:["CAM_TYPE_PERSP"]},{TYPE:"var",NAME:"USE_POSITION_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"USE_REFRACTION",TOKENS:["0"]},{TYPE:"var",NAME:"USE_REFRACTION_CORRECTION",TOKENS:["0"]},{TYPE:"var",NAME:"USE_ENVIRONMENT_LIGHT",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_BLEND_TYPE",
TOKENS:["TEXTURE_BLEND_TYPE_MIX"]},{TYPE:"var",NAME:"NUM_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LAMP_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_TEXTURE",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_VALUES",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_RGBS",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"POISSON_DISK_NUM",TOKENS:["NO_SOFT_SHADOWS"]},{TYPE:"var",NAME:"USE_DERIVATIVES_EXT",TOKENS:["0"]},{TYPE:"var",NAME:"USE_LOD_SMOOTHING",
TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1","USE_DERIVATIVES_EXT",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"extension",TOKENS:["GL_OES_standard_derivatives",":","enable"]}]}}]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"math.glslv"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],
GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"coverage.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LIGHTS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},
{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_eye_frag",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{TYPE:"logical_or_expr",PLACES:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_direction",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_VIEW_TSR",{TYPE:"logical_or_expr",
PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_VIEW_TSR_INVERSE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR_INVERSE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_texture",";"]}]}},{TYPE:"elif",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]}]}},{TYPE:"else",
GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_diffuse_color",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform sampler2D u_sampler ; uniform float u_alpha_factor ;".split(" ")}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_OUTLINE",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_color_id",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_CURVE_VEC",
"USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_plane_reflection",";"]}]}},{TYPE:"elif",
EXPRESSION:["REFLECTION_TYPE","REFL_CUBE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_cube_reflection",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_refractmap",
";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:"uniform float u_emit ; uniform float u_ambient ; uniform vec2 u_fresnel_params ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform",
"float","u_mirror_factor",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_refl_plane",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_LAMP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_VALUE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec4 u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_RGB"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POISSON_DISK_NUM",
"NO_SOFT_SHADOWS",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{TYPE:"txt",TOKENS:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map1 ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map2 ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map3 ; uniform sampler2D u_shadow_mask ;".split(" ")}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_OUTLINE"],
GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_outline_intensity",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_OBJECT_INFO"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_obj_info",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform float u_lod_coverage ; uniform float u_lod_cmp_logic ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",
PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"GLSL_IN vec3 h ; GLSL_IN vec4 i ; GLSL_IN vec3 j ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","k",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","l",";"]}]}}]},{TYPE:"cond",
PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","m",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"GLSL_IN vec4 n ; GLSL_IN vec4 o ; GLSL_IN vec4 u ; GLSL_IN vec4 v ;".split(" ")}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",
EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","B",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"nodes.glslf"}]}}]},{TYPE:"txt",TOKENS:["void",
"main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"if ( ! C ( u_lod_coverage , u_lod_cmp_logic ) ) discard ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 D = normalize ( u_camera_eye_frag - h ) ; vec3 E ; vec3 F ; vec3 G ; vec4 H ; float I ; J ( D , E , F , G , H , I ) ; float L = I ;".split(" ")}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float L = ( GLSL_TEXTURE ( u_sampler , A ) ) . a ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float M = u_alpha_factor * L ; M += ( 1.0 - step ( 0.0 , M ) ) ; L = mix ( M , 1.0 , u_diffuse_color . a ) ;".split(" ")}]}}]}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float L = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA_CLIP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"if ( L < 0.5 ) discard ; L = 1.0 ;".split(" ")}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_OUTLINE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , u_outline_intensity ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:"GLSL_OUT_FRAG_COLOR = vec4 ( u_color_id , 1.0 ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["}"]}]};e["color_id.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"NODES",TOKENS:["0"]},{TYPE:"var",NAME:"CAUSTICS",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"MAIN_BEND_COL",TOKENS:["0"]},{TYPE:"var",NAME:"DETAIL_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN",TOKENS:["0"]},{TYPE:"var",
NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"USE_POSITION_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"AU_QUALIFIER",TOKENS:["GLSL_IN"]},{TYPE:"var",NAME:"STATIC_BATCH",TOKENS:["0"]},{TYPE:"var",NAME:"WIND_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"BEND_CENTER_ONLY",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD_JITTERED",TOKENS:["0"]},{TYPE:"var",NAME:"DYNAMIC_GRASS",TOKENS:["0"]},
{TYPE:"var",NAME:"SKINNED",TOKENS:["0"]},{TYPE:"var",NAME:"FRAMES_BLENDING",TOKENS:["0"]},{TYPE:"var",NAME:"VERTEX_ANIM",TOKENS:["0"]},{TYPE:"var",NAME:"SMAA_JITTER",TOKENS:["0"]},{TYPE:"var",NAME:"VERTEX_ANIM_MIX_NORMALS_FACTOR",TOKENS:["u_va_frame_factor"]},{TYPE:"var",NAME:"MAX_BONES",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"REFRACTIVE",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"to_world.glslv"},
{TYPE:"include",FILE:"scale_texcoord.glslv"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 1.0 , 1.0 , 0.0 , 0.0 , 0.0 ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","mat3","u_model_tsr",";"]}]}}]},{TYPE:"txt",TOKENS:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD",
"DYNAMIC_GRASS",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_eye",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_JITTER"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FRAMES_BLENDING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD_JITTERED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_va_frame_factor",
";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_texture_scale",";"]}]}}]},{TYPE:"txt",TOKENS:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_shade_tangs",
";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_influence",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAIN_BEND_COL"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","a_bending_col_main",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DETAIL_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},
{TYPE:"txt",TOKENS:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BEND_CENTER_ONLY"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","BILLBOARD",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",
EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position_next",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{TYPE:"logical_or_expr",PLACES:5}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_tbn_next",";"]}]}}]}]}}]}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","B",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"GLSL_OUT vec3 h ; GLSL_OUT vec4 i ; GLSL_OUT vec3 j ;".split(" ")},{TYPE:"cond",
PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","k",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:["GLSL_OUT","float","m",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec2","A",";"]}]}}]}]}}]},{TYPE:"include",FILE:"skin.glslv"},{TYPE:"include",FILE:"wind_bending.glslv"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"nodes.glslv"}]}}]},{TYPE:"txt",TOKENS:"void main ( ) { mat3 N = u_view_tsr ; vec3 O = a_position ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA","CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:3},{TYPE:"logical_or_expr",PLACES:6},{TYPE:"logical_and_expr",PLACES:3},"USE_TBN_SHADING","CALC_TBN",{TYPE:"logical_and_expr",PLACES:2},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:7}],
GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float P , Q ; vec4 S = R ( a_tbn , P , Q ) ; vec3 U = T ( S , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 V = T ( S , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 W = Q * cross ( U , V ) ; vec4 Y = X ( W , Q * P ) ; V = T ( Y , U ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 V = vec3 ( 0.0 ) ; vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 U = vec3 ( 0.0 ) ; vec3 V = vec3 ( 0.0 ) ; vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["mat3","Z","=","u_model_tsr",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 ac = normalize ( _ ( u_model_tsr , U ) ) ; vec3 ad = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , ac ) ; vec3 ae = cross ( ac , ad ) ;".split(" ")}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ae","=","a_shade_tangs",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 ae = vec3 ( 0.0 ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"O = mix ( O , a_position_next , u_va_frame_factor ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",
PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{TYPE:"logical_or_expr",PLACES:5}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float af , ah ; vec4 ai = R ( a_tbn_next , af , ah ) ; vec3 aj = T ( ai , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; U = mix ( U , aj , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 ak = T ( ai , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 al = ah * cross ( aj , ak ) ; vec4 am = X ( al , ah * af ) ; ak = T ( am , aj ) ; V = mix ( V , ak , u_va_frame_factor ) ; W = mix ( W , al , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"an ( O , V , W , U ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","BILLBOARD",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ao","=","au_center_pos",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 ao = vec3 ( 0.0 ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD"],GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:"vec3 aq = ap ( Z , ao ) ; Z = as ( u_camera_eye , aq , N , Z ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","BILLBOARD_JITTERED",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"Z = at ( u_wind , u_time , u_jitter_amp , u_jitter_freq , aq , Z ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"au aw = av ( O - ao , ao , V , ae , W , U , Z ) ; aw . ao = aq ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"au aw = av ( O , ao , V , ae , W , U , Z ) ;".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"ax ( aw . O , aw . ao , U , mat4 ( 0.0 ) ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAIN_BEND_COL","DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 ay = T ( a_tbn , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 ay = vec3 ( 0.0 ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"ax ( aw . O , aw . ao , ay , mat4 ( 0.0 ) ) ;".split(" ")}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"A = az ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"h = aw . O ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",
{TYPE:"logical_or_expr",PLACES:12}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"j = aw . U ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float aA = ( dot ( cross ( aw . U , aw . V ) , aw . W ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( aw . V , aA ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"B = aw . aB ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"i = vec4 ( ap ( N , aw . O ) , 1.0 ) ; vec4 f = u_proj_matrix * i ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_JITTER"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"f . xy += u_subpixel_jitter * f . w ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"l = aC ( f ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{TYPE:"logical_and_expr",
PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"m = - i . z / u_view_max_depth ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["J","(",")",";"]}]}}]},{TYPE:"txt",TOKENS:"gl_Position = u_proj_matrix * vec4 ( ap ( N , aw . O ) , 1.0 ) ; }".split(" ")}]};e["debug_view.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"DEBUG_SPHERE",TOKENS:["0"]},{TYPE:"var",NAME:"WIREFRAME_QUALITY",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"DEBUG_SPHERE_DYNAMIC",
TOKENS:["0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_SPHERE",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform int u_debug_view_mode ; uniform float u_cluster_id ; uniform float u_batch_debug_id_color ; uniform float u_batch_debug_main_render_time ; uniform float u_debug_colors_seed ; uniform float u_debug_render_time_threshold ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},
{TYPE:"txt",TOKENS:"GLSL_IN vec3 aD ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; const float aE = 1.0 ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_SPHERE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_SPHERE_DYNAMIC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"const vec3 aF = vec3 ( 1.0 , 0.05 , 0.05 ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"const vec3 aF = vec3 ( 0.05 , 0.05 , 1.0 ) ;".split(" ")}]}}]}]}},{TYPE:"else",
GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"const vec3 aG = vec3 ( 0.4 , 0.4 , 1.0 ) ; const vec3 aH = vec3 ( 1.0 , 0.4 , 0.4 ) ; const vec3 aI = vec3 ( 1.0 , 1.0 , 1.0 ) ; const vec3 aJ = vec3 ( 0.0 , 133.0 / 255.0 , 66.0 / 255.0 ) ; const vec3 aK = vec3 ( 160.0 / 255.0 , 38.0 / 255.0 , 33.0 / 255.0 ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_SPHERE",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float aP ( ) { float aL = 1.0 ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIREFRAME_QUALITY",0,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 aM = sign ( aD - vec3 ( 0.02 * aE ) ) ; if ( aM . x < 0.0 || aM . y < 0.0 || aM . z < 0.0 ) aL = 0.0 ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["WIREFRAME_QUALITY",1,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"extension",TOKENS:["GL_OES_standard_derivatives",":",
"enable"]}]}}]},{TYPE:"txt",TOKENS:"vec3 aN = fwidth ( aD ) ; vec3 aO = smoothstep ( vec3 ( 0.0 ) , aN * aE , aD ) ; aL = min ( min ( aO . x , aO . y ) , aO . z ) ; aL = clamp ( aL , 0.0 , 1.0 ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["return","aL",";","}"]}]}}]},{TYPE:"txt",TOKENS:"void main ( ) { vec3 aQ = vec3 ( 0.0 ) ; float L = 0.0 ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_SPHERE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 aM = sign ( aD - vec3 ( 0.02 * aE ) ) ; if ( aM . x < 0.0 || aM . y < 0.0 || aM . z < 0.0 ) { aQ = aF ; L = 1.0 ; } else discard ;".split(" ")}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"if ( u_debug_view_mode == DV_OPAQUE_WIREFRAME ) { float aL = aP ( ) ; aQ = vec3 ( mix ( u_wireframe_edge_color , aI , aL ) ) ; L = 1.0 ; } else if ( u_debug_view_mode == DV_TRANSPARENT_WIREFRAME ) { float aL = aP ( ) ; aQ = u_wireframe_edge_color ; L = mix ( 1.0 , 0.0 , aL ) ; } else if ( u_debug_view_mode == DV_FRONT_BACK_VIEW ) { float aL = aP ( ) ; if ( gl_FrontFacing ) aQ = mix ( u_wireframe_edge_color , aG , aL ) ; else aQ = mix ( u_wireframe_edge_color , aH , aL ) ; L = 1.0 ; } else if ( u_debug_view_mode == DV_CLUSTERS_VIEW ) { float aR = u_cluster_id + u_debug_colors_seed + 2.0 ; aQ = vec3 ( fract ( aR * 19.73 ) , fract ( aR * 6.34 ) , fract ( aR * 1.56 ) ) ; L = 1.0 ; } else if ( u_debug_view_mode == DV_BATCHES_VIEW ) { float aR = u_batch_debug_id_color + u_debug_colors_seed ; aQ = vec3 ( fract ( aR * 19.73 ) , fract ( aR * 6.34 ) , fract ( aR * 1.56 ) ) ; L = 1.0 ; } else if ( u_debug_view_mode == DV_RENDER_TIME ) { float aS ; if ( u_debug_render_time_threshold > 0.0 ) aS = clamp ( u_batch_debug_main_render_time , 0.0 , u_debug_render_time_threshold ) / u_debug_render_time_threshold ; else aS = 1.0 ; float aT = clamp ( 2.0 * aS , 0.0 , 1.0 ) ; float aU = clamp ( 2.0 * aS - 1.0 , 0.0 , 1.0 ) ; float aV = aS ; aQ = mix ( aJ , aK , vec3 ( aT , aU , aV ) ) ; L = 1.0 ; }".split(" ")}]}}]},
{TYPE:"txt",TOKENS:["aW","(","aQ",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"aX ( aQ , L ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"GLSL_OUT_FRAG_COLOR = vec4 ( aQ , L ) ; }".split(" ")}]};e["debug_view.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"USE_INSTANCED_PARTCLS",TOKENS:["0"]},{TYPE:"var",NAME:"DEBUG_VIEW_SPECIAL_SKYDOME",TOKENS:["0"]},{TYPE:"var",
NAME:"DEBUG_SPHERE",TOKENS:["0"]},{TYPE:"var",NAME:"WIND_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"DYNAMIC_GRASS",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD",TOKENS:["0"]},{TYPE:"var",NAME:"VERTEX_ANIM",TOKENS:["0"]},{TYPE:"var",NAME:"SKINNED",TOKENS:["0"]},{TYPE:"var",NAME:"STATIC_BATCH",TOKENS:["0"]},{TYPE:"var",NAME:"AU_QUALIFIER",TOKENS:["GLSL_IN"]},{TYPE:"var",NAME:"BEND_CENTER_ONLY",TOKENS:["0"]},{TYPE:"var",NAME:"FRAMES_BLENDING",TOKENS:["0"]},{TYPE:"var",NAME:"MAIN_BEND_COL",TOKENS:["0"]},{TYPE:"var",
NAME:"MAX_BONES",TOKENS:["0"]},{TYPE:"var",NAME:"DETAIL_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD_JITTERED",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"to_world.glslv"},{TYPE:"txt",TOKENS:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn ; GLSL_IN float a_polyindex ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_INSTANCED_PARTCLS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_SPHERE",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAIN_BEND_COL"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","a_bending_col_main",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DETAIL_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},
{TYPE:"txt",TOKENS:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BEND_CENTER_ONLY"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{TYPE:"logical_or_expr",PLACES:3},"USE_INSTANCED_PARTCLS",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position_next",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_influence",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","aD",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 1.0 , 1.0 , 0.0 , 0.0 , 0.0 ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr",";"]}]}}]},{TYPE:"txt",TOKENS:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_SPHERE",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:"uniform vec3 u_wind ; uniform float u_time ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD","BILLBOARD_JITTERED",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS","BILLBOARD",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_eye",";"]}]}}]},{TYPE:"cond",
PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_va_frame_factor",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FRAMES_BLENDING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_SPHERE",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"skin.glslv"},{TYPE:"include",
FILE:"wind_bending.glslv"},{TYPE:"include",FILE:"dynamic_grass.glslv"}]}}]},{TYPE:"txt",TOKENS:"void main ( ) { if ( a_polyindex == 0.0 ) aD = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) aD = vec3 ( 0.0 , 0.0 , 1.0 ) ; else aD = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_VIEW_SPECIAL_SKYDOME"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"gl_Position = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",
PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_INSTANCED_PARTCLS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"mat3 Z = aZ ( a_part_ts . xyz , aY ( ) ) ; Z = a_ ( vec3 ( a_part_ts . w ) , Z ) ; Z = bc ( a_part_r , Z ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"Z = bd ( u_model_tsr , Z ) ;".split(" ")}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","Z",
"=","u_model_tsr",";"]}]}}]},{TYPE:"txt",TOKENS:"mat3 N = u_view_tsr ; vec3 O = a_position ; vec4 S = R ( a_tbn ) ; vec3 U = T ( S , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_SPHERE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"au aw = av ( O , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , Z ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:"O = mix ( O , a_position_next , u_va_frame_factor ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 V = vec3 ( 0.0 ) ; vec3 W = vec3 ( 0.0 ) ; an ( O , V , W , U ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{TYPE:"logical_or_expr",PLACES:3},"USE_INSTANCED_PARTCLS",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],
GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ao","=","au_center_pos",";"]}]}},{TYPE:"elif",EXPRESSION:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 ao = a_part_ts . xyz ; O = ap ( Z , O ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 ao = vec3 ( 0.0 ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"au aw = be ( O , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , ao , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , N , Z ) ;".split(" ")}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 aq = ap ( Z , ao ) ; Z = as ( u_camera_eye , aq , N , Z ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","BILLBOARD_JITTERED",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 bf = aq ; Z = at ( u_wind , u_time , u_jitter_amp , u_jitter_freq , bf , Z ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"au aw = av ( O - ao , ao , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , Z ) ; aw . ao = aq ;".split(" ")}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"au aw = av ( O , ao , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , Z ) ;".split(" ")}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"ax ( aw . O , aw . ao , U , mat4 ( 0.0 ) ) ;".split(" ")}]}}]}]}}]},{TYPE:"txt",TOKENS:"gl_Position = u_proj_matrix * vec4 ( ap ( N , aw . O ) , 1.0 ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["}"]}]};e["error.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",
TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 0.0 , 1.0 , 1.0 ) ; }".split(" ")}]};e["error.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"txt",TOKENS:"GLSL_IN vec3 a_position ; uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; void main ( ) { gl_Position = u_proj_matrix * bh ( u_view_tsr ) * vec4 ( a_position , 1.0 ) ; }".split(" ")}]};
e["grass_map.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"DYNAMIC_GRASS_SIZE",TOKENS:["0"]},{TYPE:"var",NAME:"DYNAMIC_GRASS_COLOR",TOKENS:["0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_SIZE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","bi",";"]}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","bi",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","bi",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) {".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_SIZE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_COLOR"],
GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","bi",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"GLSL_OUT_FRAG_COLOR = vec4 ( bi , vec3 ( 1.0 ) ) ;".split(" ")}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , bi ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ;".split(" ")}]}}]}]}}]},
{TYPE:"txt",TOKENS:["}"]}]};e["grass_map.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"DYNAMIC_GRASS_SIZE",TOKENS:["0"]},{TYPE:"var",NAME:"DYNAMIC_GRASS_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"WIND_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"STATIC_BATCH",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD_JITTERED",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"to_world.glslv"},
{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_SIZE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","a_grass_size",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_grass_color",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_SIZE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_COLOR"],
GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","bi",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","float","bi",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","bi",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 1.0 , 1.0 , 0.0 , 0.0 , 0.0 ) ;".split(" ")}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr",";"]}]}}]},{TYPE:"txt",TOKENS:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_eye",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","BILLBOARD_JITTERED",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec3 u_wind ; uniform float u_time ; uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},
{TYPE:"txt",TOKENS:"void main ( ) { mat3 N = u_view_tsr ; mat3 Z = u_model_tsr ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 aq = ap ( Z , vec3 ( 0.0 ) ) ; Z = as ( u_camera_eye , aq , N , u_model_tsr ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","BILLBOARD_JITTERED",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"Z = at ( u_wind , u_time , u_jitter_amp , u_jitter_freq , vec3 ( 0.0 ) , Z ) ;".split(" ")}]}}]},
{TYPE:"txt",TOKENS:"au aw = av ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , Z ) ; aw . ao = aq ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"au aw = av ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , Z ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"vec4 f = u_proj_matrix * vec4 ( ap ( N , aw . O ) , 1.0 ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_SIZE"],GROUP:{TYPE:"grp",
PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"bi = vec4 ( a_grass_size , a_grass_color ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bi","=","a_grass_size",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bi","=","a_grass_color",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=",
"f",";","}"]}]};e["halo.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"SKY_STARS",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:"uniform vec4 u_diffuse_color ; uniform vec3 u_halo_rings_color ; uniform vec3 u_halo_lines_color ; uniform float u_halo_hardness ; uniform float u_halo_size ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKY_STARS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_sun_intensity",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ; uniform float u_cam_water_depth ;".split(" ")}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKY_STARS",
"WATER_EFFECTS","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","bj",";"]}]}}]},{TYPE:"txt",TOKENS:"GLSL_IN vec2 A ; GLSL_IN float bk ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"include",FILE:"halo_color.glslf"},{TYPE:"txt",TOKENS:"void main ( ) { vec4 bm = bl ( ) ; vec3 aQ = bm . rgb ; float aM = bm . a ; aW ( aQ ) ; aX ( aQ , aM ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aQ , aM ) ; }".split(" ")}]};
e["halo.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_STARS",TOKENS:["0"]},{TYPE:"var",NAME:"STATIC_BATCH",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"to_world.glslv"},{TYPE:"txt",TOKENS:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform PRECISION float u_halo_size ; uniform vec3 u_camera_eye ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 1.0 , 1.0 , 0.0 , 0.0 , 0.0 ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr",";"]}]}}]},{TYPE:"txt",TOKENS:"GLSL_IN vec3 a_position ; GLSL_IN vec2 a_halo_bb_vertex ; GLSL_IN float a_random_vals ; GLSL_OUT vec2 A ; GLSL_OUT float bk ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS",
"DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","bj",";"]}]}}]},{TYPE:"txt",TOKENS:"void main ( ) { mat3 N = u_view_tsr ; mat3 Z = u_model_tsr ; vec3 O = ap ( Z , a_position ) ; A = a_halo_bb_vertex * 2.0 - 1.0 ; bk = a_random_vals ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKY_STARS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"mat3 bo = bn ( O , N ) ; mat3 bp = N ; bp [ 0 ] [ 0 ] = 0.0 ; bp [ 0 ] [ 1 ] = 0.0 ; bp [ 0 ] [ 2 ] = 0.0 ;".split(" ")}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"mat3 bo = bn ( O , N ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"vec2 bq = ( a_halo_bb_vertex * 2.0 - 1.0 ) * u_halo_size ; vec3 bs = vec3 ( bq [ 0 ] , 0.0 , bq [ 1 ] ) ; vec3 bt = ap ( bo , bs ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKY_STARS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 f = u_proj_matrix * vec4 ( ap ( bp , bt ) , 1.0 ) ; f . z = 0.99999 * f . w ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS",
"DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"bj = vec4 ( bt , 1.0 ) ;".split(" ")}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 f = u_proj_matrix * vec4 ( ap ( N , bt ) , 1.0 ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=","f",";","}"]}]};e["irradiance_skybox.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},
{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:"uniform samplerCube u_sky_reflection ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; GLSL_IN vec3 bu ; void main ( ) { vec3 bv = normalize ( bu ) ; vec3 bw ; vec3 bx = vec3 ( 0.0 ) ; vec3 by = vec3 ( 0.0 , 0.0 , 1.0 ) ; vec3 bz = vec3 ( 1.0 , 0.0 , 0.0 ) ; const float bA = 0.025 ; float bB = 0.0 ; for ( float bC = 0.0 ; bC < 2.0 * M_PI ; bC += bA ) { for ( float bD = 0.0 ; bD < 0.5 * M_PI ; bD += bA ) { vec3 bE = vec3 ( sin ( bD ) * cos ( bC ) , sin ( bD ) * sin ( bC ) , cos ( bD ) ) ; vec3 bF = bE . x * bz + bE . y * by + bE . z * bv ; vec3 bw = GLSL_TEXTURE_CUBE ( u_sky_reflection , bF ) . rgb ; bG ( bw ) ; bx += bw * cos ( bD ) * sin ( bD ) ; bB ++ ; } } bx = M_PI * bx * ( 1.0 / float ( bB ) ) ; GLSL_OUT_FRAG_COLOR = vec4 ( bx , 1.0 ) ; }".split(" ")}]};
e["lens_flares.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:"uniform sampler2D u_sampler ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aQ = GLSL_TEXTURE ( u_sampler , A ) ; aW ( aQ . rgb ) ; aX ( aQ . rgb , aQ . a ) ; GLSL_OUT_FRAG_COLOR = aQ ; }".split(" ")}]};e["lens_flares.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",
TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"NUM_LIGHTS",TOKENS:["0"]},{TYPE:"define",NAME:"LIGHT_INDEX",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"txt",TOKENS:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; GLSL_IN float a_lf_dist ; GLSL_IN vec2 a_lf_bb_vertex ; GLSL_IN vec2 a_texcoord ; GLSL_OUT vec2 A ; void main ( ) { A = a_texcoord ; vec3 bH = normalize ( u_light_directions [ LIGHT_INDEX ] ) ; vec4 f = u_proj_matrix * vec4 ( bI ( u_view_tsr , bH ) , 0.0 ) ; f . x /= f . w ; f . y /= f . w ; f += 99999.0 * step ( f . z , 0.0 ) ; f += 100.0 * ( step ( 1.0 , abs ( f . x ) ) + step ( 1.0 , abs ( f . y ) ) ) ; f . x = a_lf_dist * f . x ; f . y = a_lf_dist * f . y ; float bJ = u_proj_matrix [ 1 ] [ 1 ] / u_proj_matrix [ 0 ] [ 0 ] ; vec2 bK = vec2 ( a_lf_bb_vertex . x / bJ , a_lf_bb_vertex . y ) ; if ( a_lf_dist < 0.999 ) { const float bL = 1.9 ; bK *= ( 1.0 + bL * length ( f . xy ) ) ; } gl_Position = vec4 ( f . xy + bK , 0.999999 , 1.0 ) ; }".split(" ")}]};
e["line.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:"uniform vec4 u_diffuse_color ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec3 aQ = u_diffuse_color . xyz ; float L = u_diffuse_color . a ; aW ( aQ ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA"],GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:"aX ( aQ , L ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"GLSL_OUT_FRAG_COLOR = vec4 ( aQ , L ) ; }".split(" ")}]};e["line.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"to_world.glslv"},{TYPE:"txt",TOKENS:"GLSL_IN vec3 a_position ; GLSL_IN vec3 a_direction ; uniform mat3 u_model_tsr ; uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform float u_height ; uniform float u_line_width ; void main ( ) { mat3 N = u_view_tsr ; mat3 Z = u_model_tsr ; au aw = av ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , normalize ( a_direction ) , Z ) ; vec4 bM = u_proj_matrix * vec4 ( ap ( N , aw . O ) , 1.0 ) ; bM . xyz /= bM . w ; vec4 bN = u_proj_matrix * vec4 ( ap ( N , aw . O + aw . U ) , 1.0 ) ; bN . xyz /= bN . w ; float bJ = u_proj_matrix [ 1 ] [ 1 ] / u_proj_matrix [ 0 ] [ 0 ] ; vec2 bO = ( bN - bM ) . xy ; bO . x *= bJ ; float bP = M_PI / 2.0 ; mat2 bQ = mat2 ( cos ( bP ) , sin ( bP ) , - sin ( bP ) , cos ( bP ) ) ; bO = bQ * bO ; bO = normalize ( bO ) ; vec2 bR = ( u_line_width / u_height ) * vec2 ( 1.0 / bJ , 1.0 ) ; gl_Position = vec4 ( bM . xy + bO . xy * bR / 2.0 , bM . z , 1.0 ) ; gl_Position *= bM . w ; }".split(" ")}]};
e["main.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"SHADELESS",TOKENS:["0"]},{TYPE:"var",NAME:"CAUSTICS",TOKENS:["0"]},{TYPE:"var",NAME:"USE_ENVIRONMENT_LIGHT",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_TEXTURE",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"NORMAL_TEXCOORD",TOKENS:["0"]},{TYPE:"var",NAME:"USE_VIEW_TSR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_VIEW_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",
NAME:"USE_MODEL_TSR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_MODEL_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_PROJ_MATRIX_FRAG",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"USE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_NORM_CO",TOKENS:["TEXTURE_COORDS_NONE"]},{TYPE:"var",NAME:"PARALLAX",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"CAMERA_TYPE",TOKENS:["CAM_TYPE_PERSP"]},{TYPE:"var",
NAME:"USE_POSITION_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"RGBA_SHADOWS",TOKENS:["0"]},{TYPE:"var",NAME:"USE_BSDF_SKY_DIM",TOKENS:["0"]},{TYPE:"var",NAME:"NODES",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"WETTABLE",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_VALUES",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_RGBS",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},{TYPE:"var",NAME:"NUM_LIGHTS",
TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LAMP_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"SSAO_ONLY",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"PROCEDURAL_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"REFRACTIVE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_REFRACTION",TOKENS:["0"]},{TYPE:"var",NAME:"USE_REFRACTION_CORRECTION",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION1",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION2",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION3",TOKENS:["0"]},{TYPE:"var",
NAME:"NUM_CAST_LAMPS",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_LEVEL",TOKENS:["0.0"]},{TYPE:"var",NAME:"POISSON_DISK_NUM",TOKENS:["NO_SOFT_SHADOWS"]},{TYPE:"var",NAME:"USE_DERIVATIVES_EXT",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TEXTURE_LOD_EXT",TOKENS:["0"]},{TYPE:"var",NAME:"USE_LOD_SMOOTHING",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1","USE_DERIVATIVES_EXT",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"extension",TOKENS:["GL_OES_standard_derivatives",":","enable"]}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1","USE_TEXTURE_LOD_EXT",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"extension",TOKENS:["GL_EXT_shader_texture_lod",":","enable"]}]}}]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"coverage.glslf"}]}}]},{TYPE:"cond",
PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CAUSTICS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"caustics.glslf"}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["RGBA_SHADOWS","USE_REFRACTION_CORRECTION",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"pack.glslf"}]}}]},{TYPE:"txt",TOKENS:"uniform float u_time ; uniform vec2 u_texel_size ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_texture",";"]}]}},{TYPE:"elif",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1","USE_BSDF_SKY_DIM",
{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_bsdf_cube_sky_dim",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_environment_energy",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LIGHTS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CAUSTICS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec4 u_sun_quaternion ; uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")}]}}]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_eye_frag",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{TYPE:"logical_or_expr",PLACES:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_direction",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_VIEW_TSR",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_VIEW_TSR_INVERSE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{TYPE:"cond",
PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR_INVERSE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_PROJ_MATRIX_FRAG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_proj_matrix_frag",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",
{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_color_density",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_cube_fog",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",
EXPRESSION:["USE_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform float u_lod_coverage ; uniform float u_lod_cmp_logic ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_plane_reflection",";"]}]}},
{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_CUBE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_cube_reflection",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_mirrormap",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_PBR_SIMPLE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform",
"samplerCube","u_sky_reflection",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_PBR_STANDARD",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform samplerCube u_cube_irradiance ; uniform samplerCube u_cube_r_convolution ; uniform sampler2D u_brdf ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_shadow_mask",
";"]}]}},{TYPE:"elif",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{TYPE:"txt",TOKENS:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1",
"NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3",
"NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_refractmap",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION","USE_NODE_BSDF_PRINCIPLED",
{TYPE:"logical_or_expr",PLACES:2},"USE_REFRACTION","REFRACTIVE","USE_REFRACTION_CORRECTION",{TYPE:"logical_and_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{TYPE:"txt",TOKENS:"uniform float u_emit ; uniform float u_ambient ; uniform vec2 u_fresnel_params ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFLECTION_TYPE","REFL_CUBE",{TYPE:"equal_expr",PLACES:2},
{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_mirror_factor",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_refl_plane",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_LAMP","NUM_LAMP_LIGHTS",
0,{TYPE:"non_equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_VALUE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec4 u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",
EXPRESSION:["USE_NODE_RGB"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_OBJECT_INFO"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_obj_info",
";"]}]}}]},{TYPE:"txt",TOKENS:"GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"PARALLAX",{TYPE:"logical_and_expr",PLACES:2},"SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"CAUSTICS","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",
{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:6}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","i",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"CALC_TBN_SPACE",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","k",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN",
"vec3","B",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","n",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","o",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",
PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","u",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",
PLACES:2},"REFRACTIVE","USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","m",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"include",FILE:"nodes.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",
{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"fog.glslf"}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"if ( ! C ( u_lod_coverage , u_lod_cmp_logic ) ) discard ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",
PLACES:2},"PARALLAX",{TYPE:"logical_and_expr",PLACES:2},"SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"CAUSTICS","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:3},{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float bS = length ( i ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float bT = h . z - WATER_LEVEL ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"vec3 D = normalize ( u_camera_eye_frag - h ) ; vec3 E ; vec3 F ; vec3 G ; vec4 H ; float I ; J ( D , E , F , G , H , I ) ; vec3 aQ = E ; float L = I ; vec3 U = G ; vec4 bU = H ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WETTABLE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"aQ = max ( aQ - sqrt ( 0.01 * - min ( bT , 0.0 ) ) , 0.5 * aQ ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CAUSTICS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"bV ( aQ , bT , u_time , bU , U , u_sun_direction , u_sun_intensity , u_sun_quaternion , h , bS ) ;".split(" ")}]}}]}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA_CLIP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"if ( L < 0.5 ) discard ; L = 1.0 ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"L = min ( 1.0 , L ) ;".split(" ")}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["L","=","1.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],
GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"bW ( aQ , bS , D , bT ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"bW ( aQ , bS , D , 1.0 ) ;".split(" ")}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float bX = GLSL_TEXTURE_PROJ ( u_shadow_mask , l ) . a ; aQ = vec3 ( bX ) ;".split(" ")}]}}]},
{TYPE:"txt",TOKENS:"aQ = max ( vec3 ( 0.0 ) , aQ ) ; aW ( aQ ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA","ALPHA_CLIP",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"aX ( aQ , L ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"GLSL_OUT_FRAG_COLOR = vec4 ( aQ , L ) ; }".split(" ")}]};e["main.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",
NAME:"SHADELESS",TOKENS:["0"]},{TYPE:"var",NAME:"CAUSTICS",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"MAIN_BEND_COL",TOKENS:["0"]},{TYPE:"var",NAME:"DETAIL_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN",TOKENS:["0"]},{TYPE:"var",NAME:"USE_INSTANCED_PARTCLS",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_NORM_CO",TOKENS:["TEXTURE_COORDS_NONE"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"PARALLAX",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",
TOKENS:["0"]},{TYPE:"var",NAME:"SMAA_JITTER",TOKENS:["0"]},{TYPE:"var",NAME:"USE_POSITION_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"NODES",TOKENS:["0"]},{TYPE:"var",NAME:"AU_QUALIFIER",TOKENS:["GLSL_IN"]},{TYPE:"var",NAME:"STATIC_BATCH",TOKENS:["0"]},{TYPE:"var",NAME:"WIND_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"BEND_CENTER_ONLY",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD_JITTERED",TOKENS:["0"]},{TYPE:"var",NAME:"DYNAMIC_GRASS",TOKENS:["0"]},{TYPE:"var",NAME:"SKINNED",
TOKENS:["0"]},{TYPE:"var",NAME:"FRAMES_BLENDING",TOKENS:["0"]},{TYPE:"var",NAME:"VERTEX_ANIM",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},{TYPE:"var",NAME:"REFLECTION_PASS",TOKENS:["REFL_PASS_NONE"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"REFRACTIVE",TOKENS:["0"]},{TYPE:"var",NAME:"MAC_OS_SHADOW_HACK",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION1",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION2",
TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION3",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_CAST_LAMPS",TOKENS:["0"]},{TYPE:"var",NAME:"TEXCOORD",TOKENS:["0"]},{TYPE:"var",NAME:"VERTEX_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"VERTEX_ANIM_MIX_NORMALS_FACTOR",TOKENS:["u_va_frame_factor"]},{TYPE:"var",NAME:"MAX_BONES",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"to_world.glslv"},{TYPE:"include",FILE:"scale_texcoord.glslv"},{TYPE:"txt",TOKENS:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_INSTANCED_PARTCLS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_influence",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",
EXPRESSION:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{TYPE:"logical_or_expr",PLACES:3},"USE_INSTANCED_PARTCLS",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAIN_BEND_COL"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","a_bending_col_main",
";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DETAIL_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{TYPE:"txt",TOKENS:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BEND_CENTER_ONLY"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position_next",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_TEX_COORD_RE",{TYPE:"logical_or_expr",PLACES:9}],GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_tbn_next",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXCOORD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_color",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:"GLSL_OUT vec3 h ; GLSL_OUT vec3 j ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"PARALLAX",{TYPE:"logical_and_expr",PLACES:2},"SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"CAUSTICS","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:6}],
GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","i",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"CALC_TBN_SPACE",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","k",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","bY",";"]},{TYPE:"cond",
PARTS:[{TYPE:"if",EXPRESSION:["TEXCOORD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec2","A",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_COLOR","DYNAMIC_GRASS",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","bZ",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","n",";"]},{TYPE:"cond",
PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","o",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","u",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",
PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","v",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE","USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE",
"NODES",{TYPE:"logic_negative_expr",PLACES:1},"USE_NODE_B4W_REFRACTION",{TYPE:"logical_or_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","float","m",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","B",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 1.0 , 1.0 , 0.0 , 0.0 , 0.0 ) ;".split(" ")}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","mat3","u_model_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_view_refl_matrix",";"]}]}}]},{TYPE:"txt",TOKENS:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1},"BILLBOARD",
"DYNAMIC_GRASS",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_eye",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_JITTER"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FRAMES_BLENDING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",
EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD_JITTERED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_va_frame_factor",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",
EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_texture_scale",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_normal_offset",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAC_OS_SHADOW_HACK"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform mat3 u_v_light_tsr [ NUM_CAST_LAMPS ] ;".split(" ")}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec4 u_v_light_ts [ NUM_CAST_LAMPS ] ; uniform vec4 u_v_light_r [ NUM_CAST_LAMPS ] ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["uniform","mat4","u_p_light_matrix0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2",
"NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{TYPE:"logical_or_expr",
PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{TYPE:"include",FILE:"dynamic_grass.glslv"},{TYPE:"include",FILE:"shadow.glslv"},{TYPE:"include",FILE:"skin.glslv"},{TYPE:"include",FILE:"wind_bending.glslv"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"nodes.glslv"}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS",
"REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat4","b_","=","u_view_refl_matrix",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"mat4 b_ = mat4 ( 0.0 ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["mat3","N","=","u_view_tsr",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_INSTANCED_PARTCLS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"mat3 Z = aZ ( a_part_ts . xyz , aY ( ) ) ; Z = a_ ( vec3 ( a_part_ts . w ) , Z ) ; Z = bc ( a_part_r , Z ) ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"Z = bd ( u_model_tsr , Z ) ;".split(" ")}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","Z","=","u_model_tsr",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","O","=","a_position",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL",
"DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:3},"NODES",{TYPE:"logic_negative_expr",PLACES:1},"USE_TBN_SHADING","CALC_TBN",{TYPE:"logical_and_expr",PLACES:2},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:14}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float P , Q ; vec4 S = R ( a_tbn , P , Q ) ; vec3 ca = T ( S , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",
EXPRESSION:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:3},"NODES",{TYPE:"logic_negative_expr",PLACES:1},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:13}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","U","=","ca",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:"vec3 U = vec3 ( 0.0 ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE","NODES",{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_UV_ORCO",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 V = T ( S , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 W = Q * cross ( U , V ) ; vec4 Y = X ( W , Q * P ) ; V = T ( Y , U ) ;".split(" ")}]}},{TYPE:"elif",
EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 cb = ap ( Z , O ) ; vec3 ac = normalize ( bI ( Z , ca ) ) ; vec3 D = cb - u_camera_eye ; vec3 W = cross ( D , ac ) ; vec3 V = cross ( ac , W ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 V = vec3 ( 0.0 ) ; vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]},{TYPE:"cond",
PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 ac = normalize ( bI ( Z , ca ) ) ; vec3 ad = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , ac ) ; vec3 ae = cross ( ac , ad ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ae","=","a_shade_tangs",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 ae = vec3 ( 0.0 ) ;".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"O = mix ( O , a_position_next , u_va_frame_factor ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"USE_NODE_BSDF_BEGIN","USE_NODE_TEX_COORD_RE","USE_NODE_BUMP",{TYPE:"logical_or_expr",
PLACES:10}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float af , ah ; vec4 ai = R ( a_tbn_next , af , ah ) ; vec3 aj = T ( ai , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_BSDF_BEGIN","USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:8}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"U = mix ( U , aj , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 ak = T ( ai , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 al = ah * cross ( aj , ak ) ; vec4 am = X ( al , ah * af ) ; ak = T ( am , aj ) ; V = mix ( V , ak , u_va_frame_factor ) ; W = mix ( W , al , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"an ( O , V , W , U ) ;".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{TYPE:"logical_or_expr",PLACES:3},"USE_INSTANCED_PARTCLS",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ao","=","au_center_pos",";"]}]}},{TYPE:"elif",EXPRESSION:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 ao = a_part_ts . xyz ; O = ap ( Z , O ) ;".split(" ")}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 ao = vec3 ( 0.0 ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"au aw = be ( O , V , ae , W , U , ao , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , N , Z ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:"vec3 aq = ap ( Z , ao ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"O = ( b_ * vec4 ( O , 1.0 ) ) . xyz ; ao = ( b_ * vec4 ( ao , 1.0 ) ) . xyz ; aq = ( b_ * vec4 ( aq , 1.0 ) ) . xyz ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"Z = as ( u_camera_eye , aq , N , Z ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","BILLBOARD_JITTERED",{TYPE:"logical_and_expr",
PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 bf = aq ; Z = at ( u_wind , u_time , u_jitter_amp , u_jitter_freq , bf , Z ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"au aw = av ( O - ao , ao , V , ae , W , U , Z ) ; aw . ao = aq ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"au aw = av ( O , ao , V , ae , W , U , Z ) ;".split(" ")}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},
"CALC_TBN_SPACE",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float aA = ( dot ( cross ( aw . U , aw . V ) , aw . W ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( aw . V , aA ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"B = aw . aB ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"ax ( aw . O , aw . ao , U , b_ ) ;".split(" ")}]}}]},
{TYPE:"txt",TOKENS:"h = aw . O ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:13}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:"j = aw . U ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"bY = u_camera_eye - aw . O ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXCOORD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"A = az ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"bZ = aw . aQ ;".split(" ")}]}},
{TYPE:"elif",EXPRESSION:["VERTEX_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bZ","=","a_color",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2},"BILLBOARD",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 cc = b_ * vec4 ( aw . O , 1.0 ) ; cc . xyz = ap ( N , cc . xyz ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 cc = vec4 ( ap ( N , aw . O ) , 1.0 ) ;".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"PARALLAX",{TYPE:"logical_and_expr",PLACES:2},"SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"CAUSTICS","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:6}],
GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["i","=","cc",";"]}]}}]},{TYPE:"txt",TOKENS:"vec4 f = u_proj_matrix * cc ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_JITTER"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"f . xy += u_subpixel_jitter * f . w ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE","USE_POSITION_CLIP",{TYPE:"logical_or_expr",
PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"l = aC ( f ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"cd ( aw . O , aw . U ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE","NODES",{TYPE:"logic_negative_expr",PLACES:1},"USE_NODE_B4W_REFRACTION",{TYPE:"logical_or_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:"m = - cc . z / u_view_max_depth ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["J","(",")",";"]}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=","f",";","}"]}]};e["main_stack.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"TEXTURE_NORM_CO",TOKENS:["TEXTURE_COORDS_NONE"]},{TYPE:"var",NAME:"TEXTURE_SPEC_CO",TOKENS:["TEXTURE_COORDS_NONE"]},
{TYPE:"var",NAME:"CAUSTICS",TOKENS:["0"]},{TYPE:"var",NAME:"USE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_COLOR0_CO",TOKENS:["TEXTURE_COORDS_NONE"]},{TYPE:"var",NAME:"TEXTURE_COLOR1_CO",TOKENS:["TEXTURE_COORDS_NONE"]},{TYPE:"var",NAME:"PARALLAX",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_PASS",TOKENS:["REFL_PASS_PLANE"]},{TYPE:"var",NAME:"RGBA_SHADOWS",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_SPEC",
TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA_AS_SPEC",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_STENCIL_ALPHA_MASK",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_STENCIL_ALPHA_MASK_CO",TOKENS:["TEXTURE_COORDS_NONE"]},{TYPE:"var",NAME:"NORMAL_TEXCOORD",TOKENS:["0"]},{TYPE:"var",NAME:"USE_REFRACTION_CORRECTION",TOKENS:["0"]},{TYPE:"var",NAME:"DOUBLE_SIDED_LIGHTING",TOKENS:["0"]},{TYPE:"var",NAME:"SHADELESS",TOKENS:["0"]},{TYPE:"var",NAME:"TEXCOORD",TOKENS:["0"]},{TYPE:"var",NAME:"VERTEX_COLOR",TOKENS:["0"]},{TYPE:"var",
NAME:"WETTABLE",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION1",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION2",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION3",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_CAST_LAMPS",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_LEVEL",TOKENS:["0.0"]},{TYPE:"var",NAME:"PROCEDURAL_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_BLEND_TYPE",TOKENS:["TEXTURE_BLEND_TYPE_MIX"]},{TYPE:"var",NAME:"SKY_TEXTURE",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_COLOR",
TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"PARALLAX_LOD_DIST",TOKENS:["5.0"]},{TYPE:"var",NAME:"PARALLAX_STEPS",TOKENS:["5.0"]},{TYPE:"var",NAME:"USE_ENVIRONMENT_LIGHT",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"REFRACTIVE",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},
{TYPE:"var",NAME:"DYNAMIC_GRASS",TOKENS:["0"]},{TYPE:"var",NAME:"POISSON_DISK_NUM",TOKENS:["NO_SOFT_SHADOWS"]},{TYPE:"var",NAME:"SSAO_ONLY",TOKENS:["0"]},{TYPE:"var",NAME:"USE_LOD_SMOOTHING",TOKENS:["0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"coverage.glslf"}]}}]},{TYPE:"cond",
PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CAUSTICS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"caustics.glslf"}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["RGBA_SHADOWS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"pack.glslf"}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_time",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{TYPE:"logical_and_expr",
PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_texture",";"]}]}},{TYPE:"elif",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_environment_energy",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",
PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LIGHTS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CAUSTICS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec4 u_sun_quaternion ; uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")}]}}]}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_color_density",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],
GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_cube_fog",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],
GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform float u_lod_coverage ; uniform float u_lod_cmp_logic ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_colormap0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_SPEC","ALPHA_AS_SPEC",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_specmap0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_STENCIL_ALPHA_MASK"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform sampler2D u_colormap1 ; uniform sampler2D u_stencil0 ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",
EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_plane_reflection",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_CUBE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_cube_reflection",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube",
"u_mirrormap",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_shadow_mask",";"]}]}},{TYPE:"elif",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform",
"vec4","u_pcf_blur_radii",";"]}]}}]},{TYPE:"txt",TOKENS:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},
{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform",
"sampler2D","u_refractmap",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE","USE_REFRACTION_CORRECTION",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{TYPE:"txt",TOKENS:"uniform float u_emit ; uniform float u_ambient ; uniform vec2 u_fresnel_params ; uniform float u_specular_alpha ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",
PLACES:2},"REFLECTION_TYPE","REFL_CUBE",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_reflect_factor",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_mirror_factor",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:["uniform","vec4","u_refl_plane",";"]}]}}]},{TYPE:"txt",TOKENS:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_normal_factor",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2}],
GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform float u_diffuse_color_factor ; uniform float u_alpha_factor ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_SPEC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_specular_color_factor",";"]}]}}]},{TYPE:"txt",TOKENS:"uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},
"PARALLAX",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_parallax_scale",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_refr_bump",";"]}]}}]},{TYPE:"txt",TOKENS:"GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",
PLACES:2},"PARALLAX",{TYPE:"logical_and_expr",PLACES:2},"SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"CAUSTICS",{TYPE:"logical_and_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:5}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","i",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",
PLACES:2},"CALC_TBN_SPACE",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","k",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","bY",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","B",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXCOORD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_COLOR",
"DYNAMIC_GRASS",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","bZ",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","n",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN",
"vec4","o",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","u",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE",
"REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","m",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",
PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"shadow.glslf"}]}}]},{TYPE:"include",FILE:"mirror.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"refraction.glslf"}]}}]},{TYPE:"include",FILE:"environment.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"lighting_nodes.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",
{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"fog.glslf"}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"if ( ! C ( u_lod_coverage , u_lod_cmp_logic ) ) discard ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},
"PARALLAX",{TYPE:"logical_and_expr",PLACES:2},"SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"CAUSTICS","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:3},{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float bS = length ( i ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float bT = h . z - WATER_LEVEL ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXCOORD"],GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:["vec2","ce","=","A",";"]}]}}]},{TYPE:"txt",TOKENS:"vec3 cf = normalize ( j ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DOUBLE_SIDED_LIGHTING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"if ( gl_FrontFacing == false )".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","gl_FrontFacing",")"]}]}}]},
{TYPE:"txt",TOKENS:"cf = cf ; else cf = - cf ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 W = cross ( cf , k . xyz ) * k . w ; mat3 cg = mat3 ( k . xyz , W , cf ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:["mat3","N","=","u_view_tsr_frag",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NORMAL_TEXCOORD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec2 ch = normalize ( bI ( N , j ) ) . st ; ch = ch * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"PARALLAX",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"if ( bS < PARALLAX_LOD_DIST ) { float ci = clamp ( 0.5 * ( PARALLAX_LOD_DIST - bS ) , 0.0 , 1.0 ) ; float cj = u_parallax_scale * ci ; vec3 ck = normalize ( bY * cg ) ; float cl = 1.0 / PARALLAX_STEPS ; vec2 cm = ck . xy * cj / ( PARALLAX_STEPS * ck . z ) ; float cn = 1.0 ; float co ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","cp","=","ch",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","cp","=","ce",";"]}]}}]},{TYPE:"txt",TOKENS:"co = GLSL_TEXTURE ( u_normalmap0 , cp ) . a ; for ( float cq = 1.0 ; cq <= PARALLAX_STEPS ; cq ++ ) { if ( co < cn ) { cn -= cl ; cp -= cm ; co = GLSL_TEXTURE ( u_normalmap0 , cp ) . a ; } } vec2 cr = cp + cm ; float cs = GLSL_TEXTURE ( u_normalmap0 , cr ) . a - ( cn + cl ) ; float ct = co - cn ; float cu = ct / ( ct - cs ) ; cp = cu * cr + ( 1.0 - cu ) * cp ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXCOORD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"ce += cp - ch ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["ch","=","cp",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NORMAL_TEXCOORD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"ch += cp - ce ;".split(" ")}]}}]},{TYPE:"txt",
TOKENS:["ce","=","cp",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","cv",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"cv = GLSL_TEXTURE ( u_normalmap0 , ch ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:"cv = GLSL_TEXTURE ( u_normalmap0 , ce ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"vec3 cw = cv . rgb - 0.5 ; cw = mix ( vec3 ( 0.0 , 0.0 , 1.0 ) , cw , u_normal_factor ) ; vec3 U = cg * cw ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","U","=","cf",";"]}]}}]},{TYPE:"txt",TOKENS:"U = normalize ( U ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NORMAL_TEXCOORD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"ch = normalize ( bI ( N , U ) ) . st ; ch = ch * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},
{TYPE:"txt",TOKENS:"vec3 D = normalize ( bY ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_COLOR","DYNAMIC_GRASS",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 cx = bZ ; bG ( cx ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_COLOR","DYNAMIC_GRASS",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 cy = vec4 ( cx , 1.0 ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:["vec4","cy","=","u_diffuse_color",";"]}]}}]},{TYPE:"txt",TOKENS:["float","cz","=","1.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NORMAL",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 cA = GLSL_TEXTURE ( u_colormap0 , ch ) ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_UV_ORCO",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 cA = GLSL_TEXTURE ( u_colormap0 , ce ) ;".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"bG ( cA . rgb ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_STENCIL_ALPHA_MASK"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","cB",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR1_CO","TEXTURE_COORDS_NORMAL",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"cB = GLSL_TEXTURE ( u_colormap1 , ch ) ;".split(" ")}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"cB = GLSL_TEXTURE ( u_colormap1 , ce ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"bG ( cB . rgb ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_STENCIL_ALPHA_MASK_CO","TEXTURE_COORDS_NORMAL",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 cC = GLSL_TEXTURE ( u_stencil0 , ch ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 cC = GLSL_TEXTURE ( u_stencil0 , ce ) ;".split(" ")}]}}]},
{TYPE:"txt",TOKENS:"cA = mix ( cA , cB , cC . r ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"cy . rgb = mix ( cy . rgb , cA . rgb , u_diffuse_color_factor ) ; float M = u_alpha_factor * cA . a ; M += ( 1.0 - step ( 0.0 , M ) ) ; cy . a = mix ( M , 1.0 , u_diffuse_color . a ) ; cz = cA . a ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",
{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"cy . rgb *= mix ( vec3 ( 1.0 ) , cA . rgb , u_diffuse_color_factor ) ; cy . a = cA . a ; cz = cA . a ;".split(" ")}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 aQ = cy . rgb ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 cD = u_diffuse_intensity * cy . rgb ; vec3 cF = u_environment_energy * cE ( U ) ; vec3 cG = u_ambient * cF ; vec4 bU = cH ( cD ) ; vec3 cI = u_emit * cy . rgb ; vec3 cJ = u_specular_color ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_SPEC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA_AS_SPEC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 cK = vec3 ( cz ) ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["TEXTURE_SPEC_CO","TEXTURE_COORDS_NORMAL",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 cK = GLSL_TEXTURE ( u_specmap0 , ch ) . rgb ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 cK = GLSL_TEXTURE ( u_specmap0 , ce ) . rgb ;".split(" ")}]}}]},
{TYPE:"txt",TOKENS:"bG ( cK . rgb ) ; cJ = mix ( cJ , cK , u_specular_color_factor ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"float cL = u_specular_params [ 0 ] ; vec2 cM = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 cN = cL * cJ ; vec3 aQ ; vec3 cO ; cP ( cI , cG , cD , cN , h , U , D , cM , u_diffuse_params , bU , 0.0 , vec4 ( 0.0 ) , aQ , cO ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:"cQ ( aQ , D , U , u_reflect_factor , N ) ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_CUBE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"cQ ( aQ , D , U , u_reflect_factor , mat3 ( 0.0 ) ) ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"cQ ( aQ , D , U , u_mirror_factor , mat3 ( 0.0 ) ) ;".split(" ")}]}}]},{TYPE:"cond",
PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aQ","+=","cO",";"]}]}}]},{TYPE:"txt",TOKENS:"float L = cy . a ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WETTABLE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"aQ = max ( aQ - sqrt ( 0.01 * - min ( bT , 0.0 ) ) , 0.5 * aQ ) ;".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CAUSTICS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"bV ( aQ , bT , u_time , bU , U , u_sun_direction , u_sun_intensity , u_sun_quaternion , h , bS ) ;".split(" ")}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA_CLIP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"if ( L < 0.5 ) discard ; L = 1.0 ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",
PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float t = max ( max ( cO . r , cO . g ) , cO . b ) * u_specular_alpha ; L = cy . a * ( 1.0 - t ) + t ;".split(" ")}]}}]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["L","=","1.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec2 cR = - ( bI ( N , U ) ) . xy ; aQ = mix ( cS ( l , cR * u_refr_bump ) , aQ , L ) ; L = 1.0 ;".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"bW ( aQ , bS , D , bT ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"bW ( aQ , bS , D , 1.0 ) ;".split(" ")}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",
PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float bX = GLSL_TEXTURE_PROJ ( u_shadow_mask , l ) . a ; aQ = vec3 ( bX ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["aW","(","aQ",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA","ALPHA_CLIP",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"aX ( aQ , L ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"GLSL_OUT_FRAG_COLOR = vec4 ( aQ , L ) ; }".split(" ")}]};e["node_skybox.glslf"]=
{TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"USE_VIEW_TSR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_VIEW_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_MODEL_TSR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_MODEL_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_VALUES",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_RGBS",TOKENS:["0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",
EXPRESSION:["USE_NODE_VALUE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec4 u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_RGB"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_VIEW_TSR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_VIEW_TSR_INVERSE"],
GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR_INVERSE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",
{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{TYPE:"txt",TOKENS:"GLSL_IN vec3 bu ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{TYPE:"include",FILE:"nodes.glslf"},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_TEXTURE_ENVIRONMENT_EQUIRECTANGULAR","USE_NODE_TEXTURE_ENVIRONMENT_MIRROR_BALL","USE_NODE_GEOMETRY_NO","USE_NODE_GEOMETRY_GL","USE_NODE_GEOMETRY_IN",
"USE_NODE_TEX_COORD_GE","USE_NODE_TEX_COORD_OB","USE_NODE_TEX_COORD_NO","USE_NODE_B4W_REFLECT_WORLD",{TYPE:"logical_or_expr",PLACES:9}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 D = - normalize ( bu ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","D",";"]}]}}]},{TYPE:"txt",TOKENS:"vec3 E ; vec3 F ; vec3 G ; vec4 H ; float I ; J ( D , E , F , G , H , I ) ; E = max ( vec3 ( 0.0 ) , E ) ; aW ( E ) ; GLSL_OUT_FRAG_COLOR = vec4 ( E , _1_0 ) ; }".split(" ")}]};
e["particle_system.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"NUM_VALUES",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_RGBS",TOKENS:["0"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"NUM_LAMP_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"PROCEDURAL_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_TEXTURE",TOKENS:["0"]},{TYPE:"var",NAME:"NORMAL_TEXCOORD",TOKENS:["0"]},{TYPE:"var",NAME:"USE_VIEW_TSR",TOKENS:["0"]},
{TYPE:"var",NAME:"USE_VIEW_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_MODEL_TSR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_MODEL_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"SOFT_STRENGTH",TOKENS:["0.25"]},{TYPE:"var",NAME:"SOFT_PARTICLES",TOKENS:["0"]},{TYPE:"var",NAME:"NODES",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"USE_FOG",TOKENS:["0"]},
{TYPE:"var",NAME:"USE_ENVIRONMENT_LIGHT",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"TEXTURE_NORM_CO",TOKENS:["TEXTURE_COORDS_NONE"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"CAMERA_TYPE",TOKENS:["CAM_TYPE_PERSP"]},{TYPE:"var",NAME:"USE_POSITION_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"USE_DERIVATIVES_EXT",
TOKENS:["0"]},{TYPE:"var",NAME:"USE_TEXTURE_LOD_EXT",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1","USE_DERIVATIVES_EXT",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"extension",TOKENS:["GL_OES_standard_derivatives",":","enable"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1","USE_TEXTURE_LOD_EXT",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"extension",TOKENS:["GL_EXT_shader_texture_lod",":","enable"]}]}}]},{TYPE:"include",
FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES","NODES",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"pack.glslf"}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_environment_energy",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LIGHTS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_color_density",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform",
"mat4","u_cube_fog",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_texture",";"]}]}},{TYPE:"elif",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"uniform float u_emit ; uniform float u_ambient ; uniform float u_time ; uniform vec3 u_camera_eye_frag ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{TYPE:"logical_or_expr",PLACES:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform",
"vec3","u_camera_direction",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_LAMP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_VALUE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec4 u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_RGB"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_VIEW_TSR",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_VIEW_TSR_INVERSE"],GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR_INVERSE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_OBJECT_INFO"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_obj_info",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},
"CALC_TBN_SPACE","USE_TBN_SHADING",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","k",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES","USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR",
"USE_NODE_TEX_COORD_GE",{TYPE:"logical_or_expr",PLACES:7}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","h",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"NODES",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","i",";"]}]}}]},{TYPE:"txt",TOKENS:"GLSL_IN vec3 j ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"fog.glslf"}]}}]},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"particles_nodes.glslf"},{TYPE:"txt",TOKENS:"void main ( ) { vec3 D = normalize ( u_camera_eye_frag - h ) ; vec3 E ; vec3 F ; vec3 G ; vec4 H ; float I ; J ( D , E , F , G , H , I ) ; vec3 aQ = E ; float L = I ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA"],GROUP:{TYPE:"grp",
PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA_CLIP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"if ( L < 0.5 ) discard ; L = 1.0 ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"L = min ( 1.0 , L ) ;".split(" ")}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["L","=","1.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"bW ( aQ , length ( i ) , D , 1.0 ) ;".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float cT = - i . z / u_view_max_depth ; vec4 cU = GLSL_TEXTURE_PROJ ( u_scene_depth , l ) ; float cW = cV ( cU ) ; float cX = cW - cT ; float cY = u_view_max_depth / SOFT_STRENGTH * cX ; L = L * min ( cY , 1.0 ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["aW","(","aQ",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA","ALPHA_CLIP",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",
PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"aX ( aQ , L ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"GLSL_OUT_FRAG_COLOR = vec4 ( aQ , L ) ; }".split(" ")}]};e["particle_system.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"BILLBOARD_ALIGN",TOKENS:["BILLBOARD_ALIGN_VIEW"]},{TYPE:"var",NAME:"TEXTURE_NORM_CO",TOKENS:["TEXTURE_COORDS_NONE"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TBN_SHADING",
TOKENS:["0"]},{TYPE:"var",NAME:"NODES",TOKENS:["0"]},{TYPE:"var",NAME:"HALO_PARTICLES",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"PARTICLES_SHADELESS",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"SOFT_PARTICLES",TOKENS:["0"]},{TYPE:"var",NAME:"COLOR_RAMP_LENGTH",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_PASS",TOKENS:["REFL_PASS_NONE"]},{TYPE:"var",NAME:"WORLD_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_COLOR_RAMP",TOKENS:["0"]},{TYPE:"var",
NAME:"USE_POSITION_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"CAUSTICS",TOKENS:["0"]},{TYPE:"var",NAME:"WIND_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"MAIN_BEND_COL",TOKENS:["0"]},{TYPE:"var",NAME:"DETAIL_BEND",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn ; GLSL_IN vec3 a_p_data ; GLSL_IN vec4 a_p_vels ; GLSL_IN vec2 a_p_bb_vertex ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",
PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","float","cZ",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","bZ",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","k",";"]}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR","HALO_PARTICLES","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{TYPE:"logical_or_expr",PLACES:8}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec2","A",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","h",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PARTICLES_SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"DISABLE_FOG",{TYPE:"logic_negative_expr",
PLACES:1},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","bY",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"NODES",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","i",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES","USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:["GLSL_OUT","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","float","bk",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","j",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COLOR_RAMP_LENGTH",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec4 u_p_color_ramp [ COLOR_RAMP_LENGTH ] ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"uniform float u_p_time ; uniform float u_p_length ; uniform int u_p_cyclic ; uniform float u_p_fade_in ; uniform float u_p_fade_out ; uniform float u_p_nfactor ; uniform float u_p_gravity ; uniform float u_p_mass ; uniform float u_p_wind_fac ; uniform float u_p_max_lifetime ; uniform float u_p_tilt ; uniform float u_p_tilt_rand ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_view_refl_matrix",";"]}]}}]},{TYPE:"txt",TOKENS:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_wind ; uniform float u_p_size ; uniform vec3 u_camera_eye ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WORLD_SPACE",{TYPE:"logic_negative_expr",PLACES:1},"NODES","HALO_PARTICLES",{TYPE:"logical_or_expr",
PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","mat3","u_model_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_COLOR_RAMP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_color_ramp_tex",";"]}]}}]},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"to_world.glslv"},{TYPE:"include",FILE:"particles.glslv"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"particles_nodes.glslv"}]}}]},
{TYPE:"txt",TOKENS:"float db ( vec2 c_ , vec2 da ) { return ( atan ( da . y , da . x ) - atan ( c_ . y , c_ . x ) ) ; } void main ( ) {".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat4","b_","=","u_view_refl_matrix",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"mat4 b_ = mat4 ( 0.0 ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"mat3 N = u_view_tsr ; dc pp ; pp = dd ( ) ; float de ; mat3 bo = aY ( ) ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 df = ( b_ * vec4 ( pp . O , 1.0 ) ) . xyz ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 df = pp . O ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"vec3 U = vec3 ( 0.0 , - 1.0 , 0.0 ) ; if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_VIEW ) { de = pp . bP ; bo = bn ( df , N ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_XY ) { de = db ( vec2 ( EPSILON , 1.0 ) , vec2 ( U . x , - U . y ) ) + pp . bP ; bo = aZ ( df , bo ) ; vec4 dg = X ( RIGHT_VECTOR , - M_PI / 2.0 ) ; bo = bc ( dg , bo ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_YZ ) { de = pp . bP ; bo = aZ ( df , bo ) ; vec4 dh = X ( UP_VECTOR , M_PI / 2.0 ) ; bo = bc ( dh , bo ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_ZX ) { de = pp . bP ; bo = aZ ( df , bo ) ; } vec3 bs = vec3 ( ( a_p_bb_vertex [ 0 ] * 2.0 - 1.0 ) * pp . di * u_p_size , 0.0 , ( a_p_bb_vertex [ 1 ] * 2.0 - 1.0 ) * pp . di * u_p_size ) ; float dj = a_p_data [ 2 ] ; float dk = u_p_tilt * u_p_tilt_rand * ( 2.0 * dj - 1.0 ) ; float dl = ( dk + u_p_tilt ) * M_PI ; vec4 dm = X ( TOWARD_VECTOR , dl + de ) ; vec3 bt = ap ( bo , T ( dm , bs ) ) ; vec4 cc = vec4 ( ap ( N , bt ) , 1.0 ) ; vec4 f = u_proj_matrix * cc ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bk","=","dj",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","PARTICLES_SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"mat3 dn = aY ( ) ; dm = X ( TOWARD_VECTOR , de ) ; dn = bc ( dm , dn ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",
PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE","NODES",{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_UV_ORCO",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2},"USE_TBN_SHADING",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 V = vec3 ( 1.0 , 0.0 , 0.0 ) ; vec3 W = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 V = vec3 ( 0.0 ) ; vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]},
{TYPE:"txt",TOKENS:"au aw = av ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , V , vec3 ( 0.0 ) , W , U , bd ( bo , dn ) ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float aA = ( dot ( cross ( aw . U , aw . V ) , aw . W ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( aw . V , aA ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"J ( pp . O , pp . dp , pp . dq , pp . dr , pp . di , a_p_bb_vertex , a_p_data [ 0 ] ) ;".split(" ")}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PARTICLES_SHADELESS",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"au aw = av ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , U , bd ( bo , dn ) ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["A","=","a_p_bb_vertex",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES"],
GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"A = a_p_bb_vertex * 2.0 - 1.0 ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"cZ = pp . L ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"bZ = pp . aQ ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1},"PARTICLES_SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND",
"MAIN_BEND_COL","DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT",{TYPE:"logical_or_expr",PLACES:11}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"j = aw . U ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES","USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"l = aC ( f ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",
EXPRESSION:["SOFT_PARTICLES","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"NODES",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["i","=","cc",";"]}]}}]},{TYPE:"txt",TOKENS:"gl_Position = f ; h = bt ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PARTICLES_SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"bY = u_camera_eye - bt ;".split(" ")}]}}]},
{TYPE:"txt",TOKENS:["}"]}]};e["particle_system_stack.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"NUM_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_TEXTURE",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"PROCEDURAL_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_BLEND_TYPE",TOKENS:["TEXTURE_BLEND_TYPE_MIX"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA_CLIP",TOKENS:["0"]},
{TYPE:"var",NAME:"SOFT_STRENGTH",TOKENS:["0.25"]},{TYPE:"var",NAME:"SOFT_PARTICLES",TOKENS:["0"]},{TYPE:"var",NAME:"NODES",TOKENS:["0"]},{TYPE:"var",NAME:"HALO_PARTICLES",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_ENVIRONMENT_LIGHT",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_STARS",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"USE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"PARTICLES_SHADELESS",
TOKENS:["0"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES","NODES",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"pack.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",
EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_sampler",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_environment_energy",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LIGHTS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",
EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_diffuse_color_factor",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_texture",";"]}]}},{TYPE:"elif",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{TYPE:"txt",TOKENS:"uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_emit ; uniform float u_ambient ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform float u_halo_size ; uniform vec3 u_halo_rings_color ; uniform float u_halo_hardness ; uniform vec3 u_halo_lines_color ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKY_STARS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:"uniform vec3 u_sun_intensity ; uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"uniform float u_p_alpha_start ; uniform float u_p_alpha_end ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_color_density",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_cube_fog",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec4","u_diffuse_color",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES"],
GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR","HALO_PARTICLES","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{TYPE:"logical_or_expr",
PLACES:8}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","h",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","cZ",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","bZ",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",
EXPRESSION:["PARTICLES_SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","bY",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"NODES",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","i",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES"],
GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","bk",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKY_STARS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","bj",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","B",";"]}]}}]},{TYPE:"txt",TOKENS:"GLSL_IN vec3 j ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{TYPE:"include",FILE:"lighting_nodes.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",
EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"fog.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"environment.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"halo_color.glslf"}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",
EXPRESSION:["PARTICLES_SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 D = normalize ( bY ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 bm = bl ( ) ; vec3 aQ = bm . rgb * bZ ; float ds = 0.9 * length ( A ) ; float dt = smoothstep ( u_p_alpha_start , u_p_alpha_end , ds ) ; float L = bm . a * ( 1.0 - dt ) ;".split(" ")}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","cy","=","u_diffuse_color",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 cA = GLSL_TEXTURE ( u_sampler , A ) ; bG ( cA . rgb ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"cy . rgb = mix ( cy . rgb , cA . rgb , u_diffuse_color_factor ) ;".split(" ")}]}},
{TYPE:"elif",EXPRESSION:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"cy . rgb *= mix ( vec3 ( 1.0 ) , cA . rgb , u_diffuse_color_factor ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"cy . a = cA . a ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"cy . rgb *= bZ ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PARTICLES_SHADELESS",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 cD = u_diffuse_intensity * cy . rgb ; vec3 cI = u_emit * cy . rgb ; vec3 U = normalize ( j ) ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{TYPE:"logic_negative_expr",PLACES:1},"SKY_COLOR",{TYPE:"logical_and_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 cF = u_environment_energy * cE ( vec3 ( 0.0 ) ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 cF = u_environment_energy * cE ( U ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"vec3 cG = u_ambient * cF ; float cL = u_specular_params [ 0 ] ; vec2 cM = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 cN = cL * u_specular_color ; vec3 aQ ; vec3 cO ; cP ( cI , cG , cD , cN , h , U , D , cM , u_diffuse_params , vec4 ( 1.0 ) , 0.0 , vec4 ( 0.0 ) , aQ , cO ) ;".split(" ")}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 aQ = cy . rgb ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"float L = cy . a * cZ ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA_CLIP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"if ( L < 0.5 ) discard ; L = 1.0 ;".split(" ")}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["L","=","1.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",
EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"bW ( aQ , length ( i ) , D , 1.0 ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float cT = - i . z / u_view_max_depth ; vec4 cU = GLSL_TEXTURE_PROJ ( u_scene_depth , l ) ; float cW = cV ( cU ) ; float cX = cW - cT ; float cY = u_view_max_depth / SOFT_STRENGTH * cX ; L = L * min ( cY , 1.0 ) ;".split(" ")}]}}]},
{TYPE:"txt",TOKENS:["aW","(","aQ",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA","ALPHA_CLIP",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"aX ( aQ , L ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"GLSL_OUT_FRAG_COLOR = vec4 ( aQ , L ) ; }".split(" ")}]};e["proc_skybox.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},
{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:"uniform vec3 u_sky_color ; uniform vec3 u_sun_direction ; uniform float u_rayleigh_brightness ; uniform float u_mie_brightness ; uniform float u_spot_brightness ; uniform float u_scatter_strength ; uniform float u_rayleigh_strength ; uniform float u_mie_strength ; uniform float u_rayleigh_collection_power ; uniform float u_mie_collection_power ; uniform float u_mie_distribution ; GLSL_IN vec3 bu ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; const float du = 0.99 ; const float dv = 1.8 ; const int dw = 8 ; float dB ( vec3 O , vec3 bH ) { float a = dot ( bH , bH ) ; float b = 2.0 * dot ( bH , O ) ; float dx = dot ( O , O ) - 1.0 ; float dy = b * b - 4.0 * a * dx ; float dz = sqrt ( dy ) ; float q = ( - b - dz ) / 2.0 ; float dA = dx / q ; return dA ; } float dD ( float L , float g ) { float a = 3.0 * ( 1.0 - g * g ) ; float b = 2.0 * ( 2.0 + g * g ) ; float dx = 1.0 + L * L ; float dC = pow ( 1.0 + g * g - 2.0 * g * L , 1.5 ) ; dC = max ( dC , 0.00001 ) ; return ( a / b ) * ( dx / dC ) ; } float dI ( vec3 O , vec3 bH , float dE ) { float dF = dot ( bH , - O ) ; if ( dF < 0.0 ) { return 1.0 ; } vec3 dG = O + dF * bH ; if ( length ( dG ) < dE ) { return 0.0 ; } else if ( length ( dG ) >= dE ) { vec3 da = normalize ( dG ) * dE - O ; float dH = acos ( dot ( normalize ( da ) , bH ) ) ; return smoothstep ( 0.0 , 1.0 , pow ( dH * 2.0 , 3.0 ) ) ; } else return 1.0 ; } vec3 dJ ( float aM , vec3 aQ , float aL ) { return aQ - aQ * pow ( u_sky_color , vec3 ( aL / aM ) ) ; } void main ( ) { vec3 bv = normalize ( bu ) ; vec3 dK = u_sun_direction ; float L = dot ( bv , dK ) ; float dL = dD ( L , - 0.01 ) * u_rayleigh_brightness * dK . z ; float dM = dD ( L - 0.5 , u_mie_distribution ) * u_mie_brightness * ( 1.0 - dK . z ) ; float dN = smoothstep ( 0.0 , 100.0 , dD ( L , 0.9995 ) ) * u_spot_brightness ; vec3 dO = vec3 ( 0.0 , 0.0 , du ) ; float dP = dB ( dO , bv ) ; float dQ = dP / float ( dw ) ; float dR = dI ( dO , bv , du - 0.3 ) ; vec3 dS = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 dT = vec3 ( 0.0 , 0.0 , 0.0 ) ; for ( int cq = 0 ; cq < dw ; cq ++ ) { float dU = dQ * float ( cq ) ; vec3 O = dO + bv * dU ; float dV = dI ( O , dK , du - 0.2 ) ; float dW = dB ( O , dK ) ; vec3 dX = dJ ( dW , vec3 ( dv ) , u_scatter_strength ) * dV ; dS += dJ ( sqrt ( dU ) , u_sky_color * dX , u_rayleigh_strength ) ; dT += dJ ( dU , dX , u_mie_strength ) ; } dS = dS * dR * pow ( dP , u_rayleigh_collection_power ) / float ( dw ) ; dT = ( dT * dR * pow ( dP , u_mie_collection_power ) ) / float ( dw ) ; vec3 aQ = vec3 ( dN * dT + dM * dT + dL * dS ) ; aW ( aQ ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aQ , 1.0 ) ; }".split(" ")}]};
e["r_convolution_skybox.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:"uniform samplerCube u_sky_reflection ; uniform float u_roughness ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; GLSL_IN vec3 bu ; float eb ( int cw , int dY ) { float dZ = 1.0 / float ( dY ) ; float d_ = 1.0 ; float ea = 0.0 ; for ( int cq = 0 ; cq < 32 ; ++ cq ) { if ( cw > 0 ) { d_ = mod ( float ( cw ) , 2.0 ) ; ea += d_ * dZ ; dZ = dZ / 2.0 ; cw = int ( float ( cw ) / 2.0 ) ; } } return ea ; } vec2 ed ( int cq , int ec ) { return vec2 ( float ( cq ) / float ( ec ) , eb ( cq , 2 ) ) ; } vec3 ek ( vec2 ee , vec3 ec , float ef ) { float a = ef * ef ; float bC = 2.0 * M_PI * ee . x ; float eg = sqrt ( ( 1.0 - ee . y ) / ( 1.0 + ( a * a - 1.0 ) * ee . y ) ) ; float eh = sqrt ( 1.0 - eg * eg ) ; vec3 ei ; ei . x = cos ( bC ) * eh ; ei . y = sin ( bC ) * eh ; ei . z = eg ; vec3 by = abs ( ec . z ) < 0.999 ? vec3 ( 0.0 , 0.0 , 1.0 ) : vec3 ( 1.0 , 0.0 , 0.0 ) ; vec3 V = normalize ( cross ( by , ec ) ) ; vec3 ej = cross ( ec , V ) ; vec3 bF = V * ei . x + ej * ei . y + ec * ei . z ; return normalize ( bF ) ; } void main ( ) { vec3 el = vec3 ( 0.0 ) ; if ( u_roughness != 0.0 ) { vec3 ec = normalize ( bu ) ; vec3 em = ec ; vec3 en = em ; const int eo = 1024 ; float ep = 0.0 ; for ( int cq = 0 ; cq < eo ; ++ cq ) { vec2 ee = ed ( cq , eo ) ; vec3 ei = ek ( ee , ec , u_roughness ) ; vec3 eq = normalize ( 2.0 * dot ( en , ei ) * ei - en ) ; float er = max ( dot ( ec , eq ) , 0.0 ) ; if ( er > 0.0 ) { vec3 bw = GLSL_TEXTURE_CUBE ( u_sky_reflection , eq ) . rgb ; bG ( bw ) ; el += bw * er ; ep += er ; } } el = el / ep ; } else { vec3 bw = GLSL_TEXTURE_CUBE ( u_sky_reflection , normalize ( bu ) ) . rgb ; bG ( bw ) ; el = bw ; } GLSL_OUT_FRAG_COLOR = vec4 ( el , 1.0 ) ; }".split(" ")}]};
e["shadow.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"NODES",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"SHADELESS",TOKENS:["0"]},{TYPE:"var",NAME:"RGBA_SHADOWS",TOKENS:["0"]},{TYPE:"var",NAME:"USE_VIEW_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_MODEL_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_VIEW_TSR",TOKENS:["0"]},
{TYPE:"var",NAME:"USE_MODEL_TSR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_ENVIRONMENT_LIGHT",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_TEXTURE",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_REFRACTION",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"CAMERA_TYPE",TOKENS:["CAM_TYPE_PERSP"]},{TYPE:"var",NAME:"USE_POSITION_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"USE_REFRACTION_CORRECTION",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION1",TOKENS:["0"]},{TYPE:"var",
NAME:"CSM_SECTION2",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION3",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LAMP_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_BLEND_TYPE",TOKENS:["TEXTURE_BLEND_TYPE_MIX"]},{TYPE:"var",NAME:"NUM_VALUES",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_RGBS",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_CAST_LAMPS",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},
{TYPE:"var",NAME:"POISSON_DISK_NUM",TOKENS:["NO_SOFT_SHADOWS"]},{TYPE:"var",NAME:"USE_DERIVATIVES_EXT",TOKENS:["0"]},{TYPE:"var",NAME:"CAMERA_TYPE",TOKENS:["CAM_TYPE_PERSP"]},{TYPE:"var",NAME:"USE_LOD_SMOOTHING",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1","USE_DERIVATIVES_EXT",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"extension",TOKENS:["GL_OES_standard_derivatives",":","enable"]}]}}]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",
FILE:"std.glsl"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"math.glslv"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["RGBA_SHADOWS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"depth_fetch.glslf"},{TYPE:"include",FILE:"pack.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"coverage.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",
EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LIGHTS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["uniform",
"vec3","u_camera_eye_frag",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{TYPE:"logical_or_expr",PLACES:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_direction",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_VIEW_TSR",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_VIEW_TSR_INVERSE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR_INVERSE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform",
"mat3","u_model_tsr_inverse",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_texture",";"]}]}},{TYPE:"elif",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",
EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_plane_reflection",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_CUBE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_cube_reflection",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube",
"u_mirrormap",";"]}]}}]},{TYPE:"txt",TOKENS:"uniform float u_emit ; uniform float u_ambient ; uniform vec2 u_fresnel_params ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_mirror_factor",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_refl_plane",";"]}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_LAMP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_VALUE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec4 u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",
EXPRESSION:["USE_NODE_RGB"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform sampler2D u_colormap0 ; uniform float u_alpha_factor ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["uniform","vec4","u_diffuse_color",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",
{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{TYPE:"txt",TOKENS:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",
PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",
PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_shadow_mask",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_refractmap",";"]},{TYPE:"cond",
PARTS:[{TYPE:"if",EXPRESSION:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_OBJECT_INFO"],
GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_obj_info",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["RGBA_SHADOWS","SHADOW_USAGE","SHADOW_CASTING",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec2","u_camera_range",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform float u_lod_coverage ; uniform float u_lod_cmp_logic ;".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","k",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";"]}]}}]}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2},"SHADOW_USAGE","SHADOW_CASTING",{TYPE:"equal_expr",PLACES:2},"RGBA_SHADOWS",{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","i",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","n",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","o",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","u",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",
EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",
PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","m",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","B",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",
{TYPE:"logic_negative_expr",PLACES:1},"NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"shadow.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"nodes.glslf"}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],
GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"if ( ! C ( u_lod_coverage , u_lod_cmp_logic ) ) discard ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 D = normalize ( u_camera_eye_frag - h ) ; vec3 E ; vec3 F ; vec3 G ; vec4 H ; float I ; J ( D , E , F , G , H , I ) ; float L = I ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",
EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float L = ( GLSL_TEXTURE ( u_colormap0 , A ) ) . a ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float M = u_alpha_factor * L ; M += ( 1.0 - step ( 0.0 , M ) ) ; L = mix ( M , 1.0 , u_diffuse_color . a ) ;".split(" ")}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float L = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},
{TYPE:"txt",TOKENS:"if ( L < 0.5 ) discard ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","NO_SHADOWS",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_CASTING",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["RGBA_SHADOWS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float et = es ( - i . z , u_camera_range ) ; GLSL_OUT_FRAG_COLOR = eu ( et ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ;".split(" ")}]}}]}]}},{TYPE:"elif",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"GLSL_OUT_FRAG_COLOR = ev ( i . z ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"GLSL_OUT_FRAG_COLOR . a *= clamp ( k . r , 0.999999999 , 1.0 ) ;".split(" ")}]}}]}]}}]},
{TYPE:"txt",TOKENS:["}"]}]};e["shadow.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"CAUSTICS",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"MAIN_BEND_COL",TOKENS:["0"]},{TYPE:"var",NAME:"DETAIL_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN",TOKENS:["0"]},{TYPE:"var",NAME:"USE_INSTANCED_PARTCLS",TOKENS:["0"]},{TYPE:"var",NAME:"NODES",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TBN_SHADING",
TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"SMAA_JITTER",TOKENS:["0"]},{TYPE:"var",NAME:"MAC_OS_SHADOW_HACK",TOKENS:["0"]},{TYPE:"var",NAME:"USE_POSITION_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"RGBA_SHADOWS",TOKENS:["0"]},{TYPE:"var",NAME:"REFRACTIVE",TOKENS:["0"]},{TYPE:"var",NAME:"AU_QUALIFIER",TOKENS:["GLSL_IN"]},{TYPE:"var",NAME:"BEND_CENTER_ONLY",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION1",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION2",TOKENS:["0"]},
{TYPE:"var",NAME:"CSM_SECTION3",TOKENS:["0"]},{TYPE:"var",NAME:"HAIR_BILLBOARD",TOKENS:["0"]},{TYPE:"var",NAME:"FRAMES_BLENDING",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_TEX_RES",TOKENS:["2048.0"]},{TYPE:"var",NAME:"VERTEX_ANIM",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_CAST_LAMPS",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"VERTEX_ANIM_MIX_NORMALS_FACTOR",TOKENS:["u_va_frame_factor"]},{TYPE:"var",NAME:"MAX_BONES",TOKENS:["0"]},{TYPE:"var",
NAME:"WIND_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},{TYPE:"var",NAME:"SKINNED",TOKENS:["0"]},{TYPE:"var",NAME:"DYNAMIC_GRASS",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD",TOKENS:["0"]},{TYPE:"var",NAME:"STATIC_BATCH",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD_JITTERED",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"to_world.glslv"},{TYPE:"include",FILE:"scale_texcoord.glslv"},{TYPE:"txt",TOKENS:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_INSTANCED_PARTCLS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_influence",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",
EXPRESSION:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{TYPE:"logical_or_expr",PLACES:3},"USE_INSTANCED_PARTCLS",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAIN_BEND_COL"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","a_bending_col_main",
";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DETAIL_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{TYPE:"txt",TOKENS:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BEND_CENTER_ONLY"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position_next",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{TYPE:"logical_or_expr",PLACES:5}],
GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_tbn_next",";"]}]}}]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_COLOR",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"GLSL_OUT vec3 h ; GLSL_OUT vec3 j ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","k",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec2","A",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2},"SHADOW_USAGE",
"SHADOW_CASTING",{TYPE:"equal_expr",PLACES:2},"RGBA_SHADOWS",{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","i",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","n",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",
PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","o",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","u",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4",
"v",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","float","m",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","B",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 1.0 , 1.0 , 0.0 , 0.0 , 0.0 ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","mat3",
"u_model_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_JITTER"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{TYPE:"txt",TOKENS:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS","BILLBOARD",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_eye",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD",
"SHADOW_USAGE","SHADOW_CASTING",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_shadow_cast_billboard_view_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FRAMES_BLENDING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",
EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD_JITTERED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_va_frame_factor",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",
EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_COLOR",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_texture_scale",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_normal_offset",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAC_OS_SHADOW_HACK"],
GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform mat3 u_v_light_tsr [ NUM_CAST_LAMPS ] ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec4 u_v_light_ts [ NUM_CAST_LAMPS ] ; uniform vec4 u_v_light_r [ NUM_CAST_LAMPS ] ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["uniform","mat4","u_p_light_matrix0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_p_light_matrix3",
";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{TYPE:"include",FILE:"dynamic_grass.glslv"},{TYPE:"include",FILE:"shadow.glslv"},{TYPE:"include",FILE:"skin.glslv"},{TYPE:"include",FILE:"wind_bending.glslv"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"nodes.glslv"}]}}]},
{TYPE:"txt",TOKENS:"void main ( ) { mat3 N = u_view_tsr ; vec3 O = a_position ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:3},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",
{TYPE:"logical_or_expr",PLACES:13}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float P , Q ; vec4 S = R ( a_tbn , P , Q ) ; vec3 ca = T ( S , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; vec3 U = ca ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 U = vec3 ( 0.0 ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA","CALC_TBN_SPACE",{TYPE:"logical_and_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 V = T ( S , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 W = Q * cross ( U , V ) ; vec4 Y = X ( W , Q * P ) ; V = T ( Y , U ) ;".split(" ")}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 V = vec3 ( 0.0 ) ; vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"O = mix ( O , a_position_next , u_va_frame_factor ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO",
"USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{TYPE:"logical_or_expr",PLACES:5}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float af , ah ; vec4 ai = R ( a_tbn_next , af , ah ) ; vec3 aj = T ( ai , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; U = mix ( U , aj , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 ak = T ( ai , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 al = ah * cross ( aj , ak ) ; vec4 am = X ( al , ah * af ) ; ak = T ( am , aj ) ; V = mix ( V , ak , u_va_frame_factor ) ; W = mix ( W , al , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"an ( O , V , W , U ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_INSTANCED_PARTCLS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"mat3 Z = aZ ( a_part_ts . xyz , aY ( ) ) ; Z = a_ ( vec3 ( a_part_ts . w ) , Z ) ; Z = bc ( a_part_r , Z ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:"Z = bd ( u_model_tsr , Z ) ;".split(" ")}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","Z","=","u_model_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{TYPE:"logical_or_expr",PLACES:3},"USE_INSTANCED_PARTCLS",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ao","=","au_center_pos",";"]}]}},{TYPE:"elif",EXPRESSION:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",
{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 ao = a_part_ts . xyz ; O = ap ( Z , O ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 ao = vec3 ( 0.0 ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 ac = normalize ( _ ( Z , ca ) ) ; vec3 ad = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , ac ) ; vec3 ae = cross ( ac , ad ) ;".split(" ")}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ae","=","a_shade_tangs",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 ae = vec3 ( 0.0 ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"au aw = be ( O , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , U , ao , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , N , Z ) ;".split(" ")}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 aq = ap ( Z , ao ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HAIR_BILLBOARD",{TYPE:"logic_negative_expr",PLACES:1},"SHADOW_USAGE","SHADOW_CASTING",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","ew","=","u_shadow_cast_billboard_view_tsr",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:["mat3","ew","=","N",";"]}]}}]},{TYPE:"txt",TOKENS:"Z = as ( u_camera_eye , aq , ew , Z ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","BILLBOARD_JITTERED",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"Z = at ( u_wind , u_time , u_jitter_amp , u_jitter_freq , aq , Z ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"au aw = av ( O - ao , ao , V , ae , W , U , Z ) ; aw . ao = aq ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:"au aw = av ( O , ao , V , ae , W , U , Z ) ;".split(" ")}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAIN_BEND_COL","DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ay","=","ca",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 ay = vec3 ( 0.0 ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"ax ( aw . O , aw . ao , ay , mat4 ( 0.0 ) ) ;".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"h = aw . O ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",
{TYPE:"logical_or_expr",PLACES:12}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"j = aw . U ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float aA = ( dot ( cross ( aw . U , aw . V ) , aw . W ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( aw . V , aA ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"B = aw . aB ;".split(" ")}]}}]}]}}]},{TYPE:"txt",TOKENS:"vec4 cc = vec4 ( ap ( N , aw . O ) , 1.0 ) ; vec4 f = u_proj_matrix * cc ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_JITTER"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"f . xy += u_subpixel_jitter * f . w ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"l = aC ( f ) ;".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"m = - cc . z / u_view_max_depth ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["J","(",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"A = az ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE",
"SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"cd ( aw . O , aw . U ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2},"SHADOW_USAGE","SHADOW_CASTING",{TYPE:"equal_expr",PLACES:2},"RGBA_SHADOWS",{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["i",
"=","cc",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_CASTING",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec2 ey = ( u_proj_matrix * vec4 ( ex ( N ) , 1.0 ) ) . xy ; float ez = SHADOW_TEX_RES / 2.0 ; ey = floor ( ey * ez + 0.5 ) / ez - ey ; f . xy += ey ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=","f",";","}"]}]};e["sky.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"WO_SKYTEX",TOKENS:["0"]},
{TYPE:"var",NAME:"WO_SKYREAL",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYBLEND",TOKENS:["0"]},{TYPE:"var",NAME:"PROCEDURAL_SKYDOME",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYPAPER",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_PASS",TOKENS:["REFL_PASS_NONE"]},{TYPE:"var",NAME:"WATER_LEVEL",TOKENS:["0.0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},
{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"REFLECTION_PASS","REFL_PASS_NONE",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec3 u_camera_eye_frag ; uniform vec4 u_underwater_fog_color_density ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYBLEND","WO_SKYPAPER",{TYPE:"logical_and_expr",
PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec4 u_sky_tex_fac ; uniform vec3 u_sky_tex_color ; uniform float u_sky_tex_dvar ; uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYBLEND","WO_SKYPAPER","WO_SKYTEX",{TYPE:"logical_and_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"sky_blending.glslf"}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","bu",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_SKYDOME",
{TYPE:"logic_negative_expr",PLACES:1},"WO_SKYTEX","WO_SKYBLEND",{TYPE:"logical_or_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";"]}]}}]},{TYPE:"txt",TOKENS:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec3 bw ; vec3 bv = normalize ( bu ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYBLEND","WO_SKYPAPER",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","eA","=",
"0.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYREAL"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"eA = abs ( A . y ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"eA = ( A . y + 1.0 ) * 0.5 ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"vec3 eB = u_horizon_color ; vec3 eC = u_zenith_color ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYTEX"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 eD = vec3 ( A , 0.0 ) ; vec4 eE = GLSL_TEXTURE_CUBE ( u_sky , bv ) ; bG ( eE . rgb ) ; bw = eF ( eB , eC , eE , eA , eD ) ;".split(" ")}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"bw = mix ( eB , eC , eA ) ;".split(" ")}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"bw = GLSL_TEXTURE_CUBE ( u_sky , bv ) . rgb ; bG ( bw ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"REFLECTION_PASS","REFL_PASS_NONE",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float eG = WATER_LEVEL - u_camera_eye_frag . z ; vec3 eH = vec3 ( 0.0 ) ; vec3 eI = mix ( u_underwater_fog_color_density . rgb , eH , min ( - bv . z , 1.0 ) ) ; eI *= min ( 1.0 - min ( 0.03 * eG , 0.8 ) , 1.0 ) ; float aL = clamp ( sign ( 0.01 * eG - bv . z ) , 0.0 , 1.0 ) ; bw = mix ( bw , eI , aL ) ;".split(" ")}]}}]},
{TYPE:"txt",TOKENS:"aW ( bw ) ; GLSL_OUT_FRAG_COLOR = vec4 ( bw , 1.0 ) ; }".split(" ")}]};e["sky.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PROCEDURAL_SKYDOME",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYTEX",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYBLEND",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:"uniform mat4 u_sky_vp_inverse ; GLSL_IN vec3 a_position ; GLSL_OUT vec3 bu ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_SKYDOME",
{TYPE:"logic_negative_expr",PLACES:1},"WO_SKYTEX","WO_SKYBLEND",{TYPE:"logical_or_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec2","A",";"]}]}}]},{TYPE:"txt",TOKENS:"void main ( ) { vec4 O = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ; vec4 bv = u_sky_vp_inverse * O ; bu = bv . xyz ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_SKYDOME",{TYPE:"logic_negative_expr",PLACES:1},"WO_SKYTEX","WO_SKYBLEND",{TYPE:"logical_or_expr",
PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"A = a_position . xy ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=","O",";","}"]}]};e["skybox.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PROCEDURAL_SKYDOME",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYTEX",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYBLEND",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:"uniform mat4 u_cube_view_matrix ; GLSL_IN vec3 a_position ; GLSL_OUT vec3 bu ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_SKYDOME",{TYPE:"logic_negative_expr",PLACES:1},"WO_SKYTEX","WO_SKYBLEND",{TYPE:"logical_or_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec2","A",";"]}]}}]},{TYPE:"txt",TOKENS:"void main ( ) { vec4 O = vec4 ( a_position . xy , 0.999999 , 1.0 ) ; vec4 bv = u_cube_view_matrix * O ; bu = bv . xyz ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_SKYDOME",{TYPE:"logic_negative_expr",
PLACES:1},"WO_SKYTEX","WO_SKYBLEND",{TYPE:"logical_or_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"A = a_position . xy ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=","O",";","}"]}]};e["tex_skybox.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"WO_SKYTEX",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYREAL",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYBLEND",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYPAPER",TOKENS:["0"]},
{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; GLSL_IN vec3 bu ; GLSL_IN vec2 A ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYTEX"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_texture",";"]}]}}]},{TYPE:"txt",TOKENS:"uniform vec4 u_sky_tex_fac ; uniform vec3 u_sky_tex_color ; uniform float u_sky_tex_dvar ; uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYTEX"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"sky_blending.glslf"}]}}]},{TYPE:"txt",TOKENS:"void main ( ) { vec3 bv = normalize ( bu ) ; vec3 bw ; float eA = 0.0 ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYPAPER"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYTEX"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"bw = GLSL_TEXTURE_CUBE ( u_sky_texture , bv ) . xyz ; bG ( bw ) ;".split(" ")}]}},{TYPE:"else",
GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"bw = vec3 ( 1.0 ) ;".split(" ")}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYBLEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float L = acos ( bv . z ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYREAL"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"eA = abs ( L * INV_PI - 0.5 ) * 2.0 ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"eA = 1.0 - L * INV_PI ;".split(" ")}]}}]}]}}]},
{TYPE:"txt",TOKENS:"vec3 eB = u_horizon_color ; vec3 eC = u_zenith_color ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYTEX"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 eE = GLSL_TEXTURE_CUBE ( u_sky_texture , bv ) ; bG ( eE . rgb ) ; vec3 eD = vec3 ( bu . xy , 0.0 ) ; bw = eF ( eB , eC , eE , eA , eD ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYBLEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"bw = mix ( eB , eC , eA ) ;".split(" ")}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bw","=","eB",";"]}]}}]}]}}]}]}}]},{TYPE:"txt",TOKENS:"aW ( bw ) ; GLSL_OUT_FRAG_COLOR = vec4 ( bw , 1.0 ) ; }".split(" ")}]};e["water.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"USE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"DEBUG_WIREFRAME",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_NORMALMAPS",TOKENS:["0"]},{TYPE:"var",
NAME:"FOAM",TOKENS:["0"]},{TYPE:"var",NAME:"SHORE_PARAMS",TOKENS:["0"]},{TYPE:"var",NAME:"GENERATED_MESH",TOKENS:["0"]},{TYPE:"var",NAME:"ABSORB",TOKENS:["6.0"]},{TYPE:"var",NAME:"SSS_STRENGTH",TOKENS:["1.0"]},{TYPE:"var",NAME:"SSS_WIDTH",TOKENS:["0.45"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"WAVES_HEIGHT",TOKENS:["1.0"]},{TYPE:"var",NAME:"WATER_LEVEL",TOKENS:["0.0"]},{TYPE:"var",NAME:"PROCEDURAL_FOG",
TOKENS:["0"]},{TYPE:"var",NAME:"SKY_TEXTURE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_REFRACTION_CORRECTION",TOKENS:["0"]},{TYPE:"var",NAME:"SHORE_SMOOTHING",TOKENS:["0"]},{TYPE:"var",NAME:"DYNAMIC",TOKENS:["0"]},{TYPE:"var",NAME:"USE_ENVIRONMENT_LIGHT",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"REFRACTIVE",TOKENS:["0"]},{TYPE:"include",FILE:"precision_statement.glslf"},
{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"pack.glslf"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"define",NAME:"REFL_BUMP",TOKENS:["0.002"]},{TYPE:"txt",TOKENS:["uniform","float","u_time",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_texture",";"]}]}},{TYPE:"elif",EXPRESSION:["USE_ENVIRONMENT_LIGHT",
"SKY_COLOR",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_environment_energy",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LIGHTS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},
{TYPE:"txt",TOKENS:"uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"SHORE_SMOOTHING","WATER_EFFECTS","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_cam_water_depth",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",
{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_color_density",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_underwater_fog_color_density",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_cube_fog",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_FOG"],GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_refractmap",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],
GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_plane_reflection",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FOAM"],GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_foam",";"]}]}}]},{TYPE:"txt",TOKENS:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_ambient ; uniform vec2 u_fresnel_params ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ; uniform vec3 u_shallow_water_col ; uniform vec3 u_shore_water_col ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:"uniform float u_water_norm_uv_velocity ; uniform vec2 u_normalmap0_scale ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",1,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec2","u_normalmap1_scale",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",2,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec2","u_normalmap2_scale",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",
3,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec2","u_normalmap3_scale",";"]}]}}]}]}}]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_mirror_factor",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_reflect_factor",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING",
"DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_view_max_depth",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform float u_water_shallow_col_fac ; uniform float u_water_shore_col_fac ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FOAM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform float u_foam_factor ; uniform vec2 u_foam_uv_freq ; uniform vec2 u_foam_mag ; uniform vec2 u_foam_scale ;".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_refr_bump",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_WIREFRAME"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"const float aE = 1.0 ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"GLSL_IN vec3 bY ; GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2},
"FOAM",{TYPE:"logical_or_expr",PLACES:2},"GENERATED_MESH",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"GLSL_IN vec3 k ; GLSL_IN vec3 eJ ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2},"FOAM",{TYPE:"logical_or_expr",
PLACES:2},"GENERATED_MESH","DYNAMIC",{TYPE:"logical_and_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","eK",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","eL",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN",
"vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","m",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_WIREFRAME"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","aD",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],
GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","B",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"include",FILE:"environment.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE","SHORE_SMOOTHING","USE_REFRACTION_CORRECTION",{TYPE:"logical_and_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"refraction.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",
PARTS:[{TYPE:"include",FILE:"fog.glslf"}]}}]},{TYPE:"txt",TOKENS:"vec3 eT ( in vec2 eM , in vec3 U , in vec3 eN , in vec3 eO , out float eP , in float eQ ) { eP = 0.0 ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec2 eR = eM . xy + U . xy * REFL_BUMP / m ; eP = u_reflect_factor ; vec3 eS ; if ( u_cam_water_depth < 0.0 ) {".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",
{TYPE:"logic_negative_expr",PLACES:1},"WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"eS = u_underwater_fog_color_density . rgb ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"eS = u_diffuse_color . rgb ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"} else { eS = GLSL_TEXTURE ( u_plane_reflection , eR ) . rgb ; bG ( eS ) ; }".split(" ")}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],
GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"eP = u_mirror_factor ; vec3 eS = eO * GLSL_TEXTURE_CUBE ( u_mirrormap , eN ) . rgb ; bG ( eS ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"eP = u_reflect_factor ; vec3 eS = eO * vec3 ( 0.3 , 0.5 , 1.0 ) ; bG ( eS ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"eP = min ( eP * eQ , 1.0 ) ; return eS ; }".split(" ")},{TYPE:"include",FILE:"lighting_nodes.glslf"},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",
EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"mat3 cg = mat3 ( k , eJ , j ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"vec3 U = normalize ( j ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC","FOAM",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float bT = h . z - WATER_LEVEL ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:"float bT = h . z ;".split(" ")}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2},"FOAM",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GENERATED_MESH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec2 ce = vec2 ( eK . x , - eK . y ) + 0.5 ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:"vec2 ce = vec2 ( h . x , - h . y ) + 0.5 ;".split(" ")}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","ce","=","A",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 eU = vec3 ( 0.0 ) ; eU += GLSL_TEXTURE ( u_normalmap0 , ce * u_normalmap0_scale + vec2 ( 0.3 , 0.5 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",
EXPRESSION:["NUM_NORMALMAPS",1,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"eU += GLSL_TEXTURE ( u_normalmap0 , ce * u_normalmap1_scale + vec2 ( - 0.3 , 0.7 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",2,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"eU += GLSL_TEXTURE ( u_normalmap0 , ce * u_normalmap2_scale + vec2 ( 0.0 , 1.1 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ;".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",3,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"eU += GLSL_TEXTURE ( u_normalmap0 , ce * u_normalmap3_scale + vec2 ( - 0.66 , - 0.3 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"U = mix ( U , normalize ( cg * eU ) , 0.3 ) ;".split(" ")}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"U = mix ( U , normalize ( cg * eU ) , 0.5 ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"U = normalize ( U ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"vec3 D = normalize ( bY ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec2 eM = l . xy / l . z ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:"vec2 eM = vec2 ( 0.0 ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec2 eV = eM + U . xy * u_refr_bump / m ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float L = u_diffuse_color . a ; vec4 cU = GLSL_TEXTURE_PROJ ( u_scene_depth , l ) ; float cW = cV ( cU ) ; float cX = max ( cW - m , 0.0 ) ;".split(" ")},{TYPE:"cond",
PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float eX = eW ( cW , eV , eM ) ; float eY = max ( eX - m , 0.0 ) ; float eZ = u_view_max_depth / ABSORB * eY ; float e_ = min ( L * eZ , 1.0 ) ; L = min ( 15.0 * L * u_view_max_depth * cX , 1.0 ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float cY = u_view_max_depth / ABSORB * cX ; if ( u_cam_water_depth > 0.0 ) L = min ( L * cY , 1.0 ) ;".split(" ")}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:"float L = u_diffuse_color . a ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","e_","=","L",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"if ( u_cam_water_depth < 0.0 ) e_ = 0.0 ; vec3 fa = GLSL_TEXTURE ( u_refractmap , eV ) . rgb ; bG ( fa ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:"float fb = pow ( min ( eL . b / u_water_shallow_col_fac , 1.0 ) , 0.3 ) ; vec3 cy = mix ( u_shallow_water_col , u_diffuse_color . rgb , fb ) ; fb = pow ( min ( eL . b / u_water_shore_col_fac , 1.0 ) , 0.3 ) ; cy = mix ( u_shore_water_col , cy , fb ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 cy = u_diffuse_color . rgb ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FOAM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",
EXPRESSION:["SHORE_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float fc = max ( 1.0 - u_view_max_depth * cX , 0.0 ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float fc = 1.0 - L ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float fd = max ( bT / WAVES_HEIGHT + 0.1 , 0.0 ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:"vec3 fe = normalize ( vec3 ( eL . rg , 0.0 ) ) ; vec3 ff = normalize ( mix ( UP_VECTOR , fe , 0.8 ) ) ; float fg = 1.25 * max ( dot ( U , ff ) - 0.2 , 0.0 ) ; fg += max ( dot ( U , - UP_VECTOR ) , 0.0 ) ; fc += fg * ( 1.0 - eL . b ) ; fd *= ( 1.0 - 0.95 * pow ( eL . b , 0.1 ) ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"fc += fd ; fc = min ( u_foam_factor * fc , 1.0 ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"vec4 fh = GLSL_TEXTURE ( u_foam , u_foam_mag * sin ( u_foam_uv_freq * u_time ) + ce * u_foam_scale ) ;".split(" ")}]}}]},
{TYPE:"txt",TOKENS:"float cL = u_specular_params [ 0 ] ; vec2 cM = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 cN = cL * u_specular_color ; vec3 cF = u_environment_energy * cE ( U ) ; vec3 cG = u_ambient * cF ; vec3 eO = cG + u_sun_intensity ; float eP ; vec3 eN = reflect ( - D , U ) ; vec3 fi = normalize ( eN + D ) ; float fj = 1.0 - dot ( D , fi ) ; float ec = u_fresnel_params [ 0 ] ; float fk = u_fresnel_params [ 1 ] ; float fl = fk + ( 1.0 - fk ) * pow ( fj , ec ) ; vec3 eS = eT ( eM , U , eN , eO , eP , fl ) ; vec3 cD = u_diffuse_intensity * cy ; vec3 aQ ; vec3 cO ; cP ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , cD , cN , h , U , D , cM , u_diffuse_params , vec4 ( 1.0 ) , 0.0 , vec4 ( 0.0 ) , aQ , cO ) ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float fm = max ( dot ( u_sun_direction , - j ) + SSS_WIDTH , 0.0 ) * max ( dot ( - D , u_sun_direction ) - 0.5 , 0.0 ) * max ( 0.0 , length ( u_sun_intensity ) - 0.1 ) ; fm = clamp ( SSS_STRENGTH * fm , 0.0 , 1.0 ) ; aQ = mix ( aQ , u_shallow_water_col , fm ) ; aQ = mix ( aQ , u_shore_water_col , fm ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:"aQ = mix ( fa , aQ , e_ ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"aQ = mix ( aQ , eS , eP ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FOAM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float fn = mix ( fh . g , fh . r , max ( 4.0 * ( fc - 0.75 ) , 0.0 ) ) ; fn = mix ( fh . b , fn , max ( 2.0 * fc - 1.0 , 0.0 ) ) ; fn = mix ( 0.0 , fn , fc ) ; aQ = mix ( aQ , eO , fn ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["aQ","+=","cO",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS",
"DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float fo = m * u_view_max_depth ; float fp = 1.0 ; if ( u_cam_water_depth > 1.0 ) fp = 2.0 ; bW ( aQ , fo , D , fp ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["aW","(","aQ",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"L = max ( L , cO . r ) ;".split(" ")},{TYPE:"cond",
PARTS:[{TYPE:"if",EXPRESSION:["FOAM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["L","+=","fn",";"]}]}}]}]}},{TYPE:"elif",EXPRESSION:["SHORE_SMOOTHING",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["L","=","1.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"aX ( aQ , L ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_WIREFRAME",1,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",
PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"extension",TOKENS:["GL_OES_standard_derivatives",":","enable"]}]}}]},{TYPE:"txt",TOKENS:"vec3 aN = fwidth ( aD ) ; vec3 aO = smoothstep ( vec3 ( 0.0 ) , aN * aE , aD ) ; float fq = min ( min ( aO . x , aO . y ) , aO . z ) ; fq = clamp ( fq , 0.0 , 1.0 ) ; aQ = mix ( u_wireframe_edge_color , aQ , fq ) ; L = mix ( 1.0 , L , fq ) ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["DEBUG_WIREFRAME",2,{TYPE:"equal_expr",
PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 aM = sign ( aD - vec3 ( 0.02 * aE ) ) ; float fq = 1.0 ; if ( aM . x < 0.0 || aM . y < 0.0 || aM . z < 0.0 ) fq = 0.0 ; aQ = mix ( u_wireframe_edge_color , aQ , fq ) ; L = mix ( 1.0 , L , fq ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"GLSL_OUT_FRAG_COLOR = vec4 ( aQ , L ) ; }".split(" ")}]};e["water.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"USE_TBN_SHADING",
TOKENS:["0"]},{TYPE:"var",NAME:"DEBUG_WIREFRAME",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_NORMALMAPS",TOKENS:["0"]},{TYPE:"var",NAME:"FOAM",TOKENS:["0"]},{TYPE:"var",NAME:"SHORE_PARAMS",TOKENS:["0"]},{TYPE:"var",NAME:"MAX_SHORE_DIST",TOKENS:["100.0"]},{TYPE:"var",NAME:"SHORE_MAP_SIZE_X",TOKENS:["1.0"]},{TYPE:"var",NAME:"SHORE_MAP_SIZE_Y",TOKENS:["1.0"]},{TYPE:"var",NAME:"SHORE_MAP_CENTER_X",TOKENS:["0.0"]},{TYPE:"var",NAME:"SHORE_MAP_CENTER_Y",TOKENS:["0.0"]},{TYPE:"var",NAME:"GENERATED_MESH",TOKENS:["0"]},
{TYPE:"var",NAME:"DST_NOISE_SCALE_0",TOKENS:["0.05"]},{TYPE:"var",NAME:"DST_NOISE_SCALE_1",TOKENS:["0.03"]},{TYPE:"var",NAME:"DST_NOISE_FREQ_0",TOKENS:["1.3"]},{TYPE:"var",NAME:"DST_NOISE_FREQ_1",TOKENS:["1.0"]},{TYPE:"var",NAME:"DIR_MIN_SHR_FAC",TOKENS:["0.4"]},{TYPE:"var",NAME:"DIR_FREQ",TOKENS:["0.5"]},{TYPE:"var",NAME:"DIR_NOISE_SCALE",TOKENS:["0.05"]},{TYPE:"var",NAME:"DIR_NOISE_FREQ",TOKENS:["0.07"]},{TYPE:"var",NAME:"DIR_MIN_NOISE_FAC",TOKENS:["0.5"]},{TYPE:"var",NAME:"DST_MIN_FAC",TOKENS:["0.2"]},
{TYPE:"var",NAME:"WAVES_HOR_FAC",TOKENS:["5.0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"WAVES_HEIGHT",TOKENS:["1.0"]},{TYPE:"var",NAME:"WAVES_LENGTH",TOKENS:["10.0"]},{TYPE:"var",NAME:"WATER_LEVEL",TOKENS:["0.0"]},{TYPE:"var",NAME:"SHORE_SMOOTHING",TOKENS:["0"]},{TYPE:"var",NAME:"DYNAMIC",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"REFRACTIVE",TOKENS:["0"]},{TYPE:"var",NAME:"STATIC_BATCH",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",
TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"to_world.glslv"},{TYPE:"include",FILE:"procedural.glslf"},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GENERATED_MESH",{TYPE:"logic_negative_expr",PLACES:1},"DYNAMIC",{TYPE:"logic_negative_expr",PLACES:1},"NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:["GLSL_IN","vec4","a_tbn",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GENERATED_MESH",{TYPE:"logic_negative_expr",PLACES:1},"NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2},"FOAM",{TYPE:"logical_or_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_WIREFRAME"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","a_polyindex",";"]}]}}]},{TYPE:"txt",
TOKENS:"GLSL_OUT vec3 bY ; GLSL_OUT vec3 h ; GLSL_OUT vec3 j ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2},"FOAM",{TYPE:"logical_or_expr",PLACES:2},"GENERATED_MESH",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec2","A",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"GLSL_OUT vec3 k ; GLSL_OUT vec3 eJ ;".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2},"FOAM",{TYPE:"logical_or_expr",PLACES:2},"GENERATED_MESH","DYNAMIC",{TYPE:"logical_and_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","eK",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","eL",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",
PLACES:2},"REFRACTIVE",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","float","m",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_WIREFRAME"],GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","aD",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","B",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 1.0 , 1.0 , 0.0 , 0.0 , 0.0 ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr",";"]}]}}]},
{TYPE:"txt",TOKENS:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_camera_eye ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform PRECISION float u_time ; uniform vec3 u_wind ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_or_expr",PLACES:4}],
GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_shore_dist_map",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 fx ( in vec2 fr ) { vec2 fs = 0.5 + vec2 ( ( fr . x - SHORE_MAP_CENTER_X ) / SHORE_MAP_SIZE_X , ( fr . y - SHORE_MAP_CENTER_Y ) / SHORE_MAP_SIZE_Y ) ; vec4 ft = GLSL_TEXTURE ( u_shore_dist_map , fs ) ; const vec2 fu = vec2 ( 1.0 / 255.0 , 1.0 ) ; float fv = dot ( ft . ba , fu ) ; vec2 fw = normalize ( ft . rg * 2.0 - 1.0 ) ; return vec3 ( fw , fv ) ; }".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMALL_WAVES_FAC",TOKENS:["0.2"]},{TYPE:"txt",TOKENS:"void fM ( inout vec3 fr , in float fy , in vec3 ft ) { float fA = fz ( DST_NOISE_SCALE_0 * ( fr . xy + DST_NOISE_FREQ_0 * fy ) ) * fz ( DST_NOISE_SCALE_1 * ( fr . yx - DST_NOISE_FREQ_1 * fy ) ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float fB = WAVES_LENGTH / MAX_SHORE_DIST / M_PI ; float fv = ft . b ; float fC = sqrt ( fv ) ; float fD = max ( fv , DIR_MIN_SHR_FAC ) * sin ( fC / fB + DIR_FREQ * fy ) ; float fE = max ( fz ( DIR_NOISE_SCALE * ( fr . xy + DIR_NOISE_FREQ * fy ) ) , DIR_MIN_NOISE_FAC ) ; fD *= fE ; float fF = WAVES_HEIGHT * mix ( fD , fA , max ( fC , DST_MIN_FAC ) ) ; vec2 fw = ft . rg ; float fG = WAVES_HOR_FAC * fD * max ( MAX_SHORE_DIST / 35.0 * ( 0.05 - fv ) , 0.0 ) ; vec2 fH = fG * fw ;".split(" ")}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float fF = WAVES_HEIGHT * fA ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GENERATED_MESH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec2 fI = 1.0 * ( fr . xy - 0.3 * fy ) ; vec2 fJ = 0.7 * ( fr . yx + 0.07 * fy ) ; float fL = fK ( fI ) . x + fK ( fJ ) . x - 1.0 ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"fr . xy += fH ; fL *= fv ;".split(" ")}]}}]},
{TYPE:"txt",TOKENS:"fF += SMALL_WAVES_FAC * fL ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"fr . z += fF ; }".split(" ")}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_WIREFRAME"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"if ( a_polyindex == 0.0 ) aD = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) aD = vec3 ( 0.0 , 0.0 , 1.0 ) ; else aD = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GENERATED_MESH"],
GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 O = a_position ; float fN = abs ( O . z ) ; vec2 fO = u_camera_eye . xy - mod ( u_camera_eye . xy , fN ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"O . z = WATER_LEVEL ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"O . z = 0.0 ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"O . xy += fO ; vec3 cb = O ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",
PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2},"FOAM",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["A","=","a_texcoord",";"]}]}}]},{TYPE:"txt",TOKENS:"au aw = av ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_tsr ) ; vec3 cb = aw . O ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"eL = fx ( cb . xy ) ;".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float fP = length ( u_wind ) ; if ( fP == 0.0 ) fP = 1.0 ; float fQ = u_time ; fQ *= fP ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GENERATED_MESH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float fR = fN ; vec3 fS = cb + vec3 ( fR , 0.0 , 0.0 ) ; vec3 fT = cb + vec3 ( 0.0 , fR , 0.0 ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2},
"FOAM",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eK","=","cb",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 fS = cb + vec3 ( 0.05 , 0.0 , 0.0 ) ; vec3 fT = cb + vec3 ( 0.0 , 0.05 , 0.0 ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 fU = fx ( fS . xy ) ; vec3 fV = fx ( fT . xy ) ; fM ( fS , fQ , fU ) ; fM ( fT , fQ , fV ) ; fM ( cb , fQ , eL ) ;".split(" ")}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"fM ( fS , fQ , vec3 ( 0.0 ) ) ; fM ( fT , fQ , vec3 ( 0.0 ) ) ; fM ( cb , fQ , vec3 ( 0.0 ) ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GENERATED_MESH","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"if ( a_position . z < 0.0 ) { cb . z = WATER_LEVEL - 1.0 ; fS . z = cb . z ; fT . z = cb . z ; }".split(" ")}]}}]},{TYPE:"txt",TOKENS:"vec3 ej = normalize ( fS - cb ) ; vec3 V = normalize ( fT - cb ) ; j = normalize ( cross ( ej , V ) ) ; float fW = dot ( j , UP_VECTOR ) ; float aL = clamp ( 0.8 - fW , 0.0 , 1.0 ) ; j = mix ( j , UP_VECTOR , aL ) ;".split(" ")}]}},
{TYPE:"elif",EXPRESSION:["GENERATED_MESH",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 S = R ( a_tbn ) ; j = T ( S , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"j = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC",{TYPE:"logic_negative_expr",
PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GENERATED_MESH",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 V = T ( S , vec3 ( 1.0 , 0.0 , 0.0 ) ) ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["DYNAMIC",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 V = vec3 ( 1.0 , 0.0 , 0.0 ) ;".split(" ")}]}}]}]}}]},{TYPE:"txt",TOKENS:"k = V ; eJ = cross ( j , k ) ;".split(" ")}]}}]},{TYPE:"txt",
TOKENS:"h = cb ; bY = u_camera_eye - cb ; vec4 cc = vec4 ( ap ( u_view_tsr , cb ) , 1.0 ) ; vec4 f = u_proj_matrix * cc ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float fX = f . x ; float fY = f . y ; float fZ = f . w ; l . x = ( fX + fZ ) / 2.0 ; l . y = ( fY + fZ ) / 2.0 ; l . z = fZ ;".split(" ")}]}}]},{TYPE:"cond",
PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"m = - cc . z / u_view_max_depth ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=","f",";","}"]}]};e["postprocessing/antialiasing.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"AA_METHOD",TOKENS:["AA_METHOD_FXAA_LIGHT"]},
{TYPE:"var",NAME:"AA_QUALITY",TOKENS:["AA_QUALITY_LOW"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:"uniform sampler2D u_color ; uniform vec2 u_texel_size ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_REDUCE_MIN",TOKENS:["(",
"1.0","/","128.0",")"]},{TYPE:"define",NAME:"FXAA_REDUCE_MUL",TOKENS:["(","1.0","/","8.0",")"]},{TYPE:"define",NAME:"FXAA_SPAN_MAX",TOKENS:["8.0"]},{TYPE:"txt",TOKENS:"vec4 gc ( float x , float y ) { vec2 f_ = A + vec2 ( x , y ) * u_texel_size ; return GLSL_TEXTURE ( u_color , f_ ) ; } vec4 gx ( ) { vec4 gd = gc ( - 1.0 , - 1.0 ) ; vec4 ge = gc ( 1.0 , - 1.0 ) ; vec4 gf = gc ( - 1.0 , 1.0 ) ; vec4 gh = gc ( 1.0 , 1.0 ) ; vec4 gi = gc ( 0.0 , 0.0 ) ; float gk = gj ( gi ) ; float gl = gj ( gd ) ; float gm = gj ( ge ) ; float gn = gj ( gf ) ; float go = gj ( gh ) ; float gp = min ( gk , min ( min ( gl , gm ) , min ( gn , go ) ) ) ; float gq = max ( gk , max ( max ( gl , gm ) , max ( gn , go ) ) ) ; vec2 bH ; bH . x = - ( ( gl + gm ) - ( gn + go ) ) ; bH . y = ( ( gl + gn ) - ( gm + go ) ) ; float gs = max ( ( gl + gm + gn + go ) * ( 0.25 * FXAA_REDUCE_MUL ) , FXAA_REDUCE_MIN ) ; float gt = 1.0 / ( min ( abs ( bH . x ) , abs ( bH . y ) ) + gs ) ; bH = min ( vec2 ( FXAA_SPAN_MAX , FXAA_SPAN_MAX ) , max ( vec2 ( - FXAA_SPAN_MAX , - FXAA_SPAN_MAX ) , bH * gt ) ) * u_texel_size ; vec4 gu = 0.5 * ( GLSL_TEXTURE ( u_color , A + bH * ( 1.0 / 3.0 - 0.5 ) ) + GLSL_TEXTURE ( u_color , A + bH * ( 2.0 / 3.0 - 0.5 ) ) ) ; vec4 gv = gu * 0.5 + 0.25 * ( GLSL_TEXTURE ( u_color , A + bH * - 0.5 ) + GLSL_TEXTURE ( u_color , A + bH * 0.5 ) ) ; float gw = gj ( gv ) ; if ( ( gw < gp ) || ( gw > gq ) ) return gu ; else return gv ; }".split(" ")}]}},
{TYPE:"elif",EXPRESSION:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_GREEN_AS_LUMA",TOKENS:["1"]},{TYPE:"include",FILE:"fxaa.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["AA_QUALITY","AA_QUALITY_HIGH",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PRESET",TOKENS:["39"]},{TYPE:"define",NAME:"FXAA_QUALITY_SUBPIX",TOKENS:["1.00"]},{TYPE:"define",NAME:"FXAA_QUALITY_EDGE_THRESHOLD",
TOKENS:["0.063"]},{TYPE:"define",NAME:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",TOKENS:["0.0312"]}]}},{TYPE:"elif",EXPRESSION:["AA_QUALITY","AA_QUALITY_MEDIUM",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PRESET",TOKENS:["20"]},{TYPE:"define",NAME:"FXAA_QUALITY_SUBPIX",TOKENS:["0.65"]},{TYPE:"define",NAME:"FXAA_QUALITY_EDGE_THRESHOLD",TOKENS:["0.166"]},{TYPE:"define",NAME:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",TOKENS:["0.0625"]}]}},{TYPE:"elif",EXPRESSION:["AA_QUALITY",
"AA_QUALITY_LOW",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PRESET",TOKENS:["12"]},{TYPE:"define",NAME:"FXAA_QUALITY_SUBPIX",TOKENS:["0.50"]},{TYPE:"define",NAME:"FXAA_QUALITY_EDGE_THRESHOLD",TOKENS:["0.166"]},{TYPE:"define",NAME:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",TOKENS:["0.0833"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:"GLSL_OUT_FRAG_COLOR = gx ( ) ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec2 gy = u_texel_size ; GLSL_OUT_FRAG_COLOR = gz ( A , u_color , gy , FXAA_QUALITY_SUBPIX , FXAA_QUALITY_EDGE_THRESHOLD , FXAA_QUALITY_EDGE_THRESHOLD_MIN ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["}"]}]};e["postprocessing/bloom_combine.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},
{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"var",NAME:"BLUR_PASS_NUM",TOKENS:["BLUR_PASS_5"]},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_main",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_1",{TYPE:"ge_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_bloom_level_0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_2",{TYPE:"ge_expr",PLACES:2}],GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_bloom_level_1",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_3",{TYPE:"ge_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_bloom_level_2",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_4",{TYPE:"ge_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_bloom_level_3",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",
EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_5",{TYPE:"ge_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_bloom_level_4",";"]}]}}]},{TYPE:"txt",TOKENS:"GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gA = GLSL_TEXTURE ( u_main , A ) ; vec4 gB = vec4 ( 0.0 ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_1",{TYPE:"ge_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"gB += GLSL_TEXTURE ( u_bloom_level_0 , A ) ;".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_2",{TYPE:"ge_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"gB += GLSL_TEXTURE ( u_bloom_level_1 , A ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_3",{TYPE:"ge_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"gB += GLSL_TEXTURE ( u_bloom_level_2 , A ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_4",{TYPE:"ge_expr",
PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"gB += GLSL_TEXTURE ( u_bloom_level_3 , A ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_5",{TYPE:"ge_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"gB += GLSL_TEXTURE ( u_bloom_level_4 , A ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"GLSL_OUT_FRAG_COLOR = gA + gB ; }".split(" ")}]};e["postprocessing/coc.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",
TOKENS:["highp"]},{TYPE:"var",NAME:"COC_TYPE",TOKENS:["COC_ALL"]},{TYPE:"txt",TOKENS:["precision","PRECISION","sampler2D",";"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"depth_fetch.glslf"},{TYPE:"txt",TOKENS:"uniform sampler2D u_color ; uniform sampler2D u_depth ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COC_TYPE","COC_COMBINE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D",
"u_coc_fg",";"]}]}}]},{TYPE:"txt",TOKENS:"uniform float u_view_max_depth ; uniform float u_dof_dist ; uniform float u_dof_front_start ; uniform float u_dof_front_end ; uniform float u_dof_rear_start ; uniform float u_dof_rear_end ; uniform vec2 u_camera_range ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aQ = GLSL_TEXTURE ( u_color , A ) ; if ( u_dof_dist > 0.0 ) { float et = gC ( u_depth , A , u_camera_range ) ; et *= u_view_max_depth ; float gD = 0.0 ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COC_TYPE","COC_COMBINE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 gE = GLSL_TEXTURE ( u_coc_fg , A ) ; float gF = gE . a ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"if ( et < u_dof_dist ) gD = ( u_dof_dist - et - u_dof_front_start ) / ( u_dof_front_end - u_dof_front_start ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COC_TYPE","COC_FOREGROUND",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:"else gD = ( et - u_dof_dist - u_dof_rear_start ) / ( u_dof_rear_end - u_dof_rear_start ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"gD = clamp ( gD , 0.0 , 1.0 ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COC_TYPE","COC_COMBINE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"gD = max ( gD , gF ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COC_TYPE","COC_FOREGROUND",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:"GLSL_OUT_FRAG_COLOR = vec4 ( gD ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"GLSL_OUT_FRAG_COLOR = vec4 ( aQ . xyz * gD , gD ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"} else GLSL_OUT_FRAG_COLOR = vec4 ( aQ . xyz , 0.0 ) ; }".split(" ")}]};e["postprocessing/compositing.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},
{TYPE:"txt",TOKENS:"uniform sampler2D u_color ; uniform float u_brightness ; uniform float u_contrast ; uniform float u_exposure ; uniform float u_saturation ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gG = GLSL_TEXTURE ( u_color , A ) ; vec3 aQ = gG . rgb ; if ( u_brightness < 0.0 ) aQ = aQ * ( 1.0 + u_brightness ) ; else aQ = aQ + ( ( 1.0 - aQ ) * u_brightness ) ; aQ = ( aQ - 0.5 ) * ( tan ( ( u_contrast + 1.0 ) * M_PI_4 ) ) + 0.5 ; aQ *= u_exposure ; float dv = gj ( vec4 ( aQ , 0.0 ) ) ; aQ = mix ( vec3 ( dv ) , aQ , u_saturation ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aQ , gG . a ) ; }".split(" ")}]};
e["postprocessing/depth_pack.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"txt",TOKENS:["precision","PRECISION","sampler2D",";"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"pack.glslf"},{TYPE:"include",FILE:"depth_fetch.glslf"},{TYPE:"txt",TOKENS:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = eu ( clamp ( gC ( u_depth , A , u_camera_range ) , 0.0 , 0.999999 ) ) ; }".split(" ")}]};
e["postprocessing/dof.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"DOF_TYPE",TOKENS:["DOF_SIMPLE"]},{TYPE:"txt",TOKENS:["precision","PRECISION","sampler2D",";"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DOF_TYPE","DOF_BOKEH",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform highp sampler2D u_sharp ; uniform highp sampler2D u_blurred1 ; uniform highp sampler2D u_blurred2 ; uniform float u_dof_dist ;".split(" ")}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"depth_fetch.glslf"},{TYPE:"txt",TOKENS:"uniform sampler2D u_sharp ; uniform sampler2D u_blurred ; uniform sampler2D u_depth ; uniform float u_view_max_depth ; uniform float u_dof_dist ; uniform float u_dof_front_end ; uniform float u_dof_rear_end ; uniform vec2 u_camera_range ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gH = GLSL_TEXTURE ( u_sharp , A ) ; if ( u_dof_dist > 0.0 ) {".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DOF_TYPE","DOF_BOKEH",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float gD ; vec4 gI = GLSL_TEXTURE ( u_blurred1 , A ) ; vec4 gJ = GLSL_TEXTURE ( u_blurred2 , A ) ; vec4 gK = min ( gI . rgba , gJ . rgba ) ; gD = gK . a ; if ( gD > 0.0 ) { gK = vec4 ( gK . rgb / gD , gH . a ) ; GLSL_OUT_FRAG_COLOR = mix ( gH , gK , min ( gD * 5.0 , 1.0 ) ) ; } else GLSL_OUT_FRAG_COLOR = gH ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["DOF_TYPE",
"DOF_SIMPLE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float et = gC ( u_depth , A , u_camera_range ) ; et *= u_view_max_depth ; float gL ; if ( et < u_dof_dist ) gL = ( u_dof_dist - et ) / u_dof_front_end ; else gL = ( et - u_dof_dist ) / u_dof_rear_end ; gL = clamp ( gL , 0.0 , 1.0 ) ; vec4 gM = GLSL_TEXTURE ( u_blurred , A ) ; GLSL_OUT_FRAG_COLOR = mix ( gH , gM , gL ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR",
"=","gH",";"]}]}}]},{TYPE:"txt",TOKENS:"} else GLSL_OUT_FRAG_COLOR = gH ; }".split(" ")}]};e["postprocessing/glow.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:"uniform sampler2D u_src_color ; uniform sampler2D u_glow_mask_small ; uniform sampler2D u_glow_mask_large ; uniform float u_glow_mask_small_coeff ; uniform float u_glow_mask_large_coeff ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gN = GLSL_TEXTURE ( u_src_color , A ) ; vec4 gO = GLSL_TEXTURE ( u_glow_mask_small , A ) ; vec4 gP = GLSL_TEXTURE ( u_glow_mask_large , A ) ; GLSL_OUT_FRAG_COLOR = gN ; if ( gP . a != 0.0 ) { float gQ = u_glow_mask_large_coeff * gP . a ; gQ = clamp ( gQ , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR . rgb = mix ( GLSL_OUT_FRAG_COLOR . rgb , gP . rgb / gP . a , gQ ) ; GLSL_OUT_FRAG_COLOR . a = mix ( GLSL_OUT_FRAG_COLOR . a , 1.0 , gQ ) ; } if ( gO . a != 0.0 ) { float gR = u_glow_mask_small_coeff * gO . a ; gR = clamp ( gR , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR . rgb = mix ( GLSL_OUT_FRAG_COLOR . rgb , gO . rgb / gO . a , gR ) ; GLSL_OUT_FRAG_COLOR . a = mix ( GLSL_OUT_FRAG_COLOR . a , 1.0 , gR ) ; } }".split(" ")}]};
e["postprocessing/god_rays.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"DEPTH_RGBA",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"STEPS_PER_PASS",TOKENS:["10.0"]},{TYPE:"txt",TOKENS:["precision","PRECISION","sampler2D",";"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"depth_fetch.glslf"},{TYPE:"include",FILE:"procedural.glslf"},
{TYPE:"include",FILE:"pack.glslf"},{TYPE:"txt",TOKENS:"uniform float u_time ; uniform float u_radial_blur_step ; uniform sampler2D u_input ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEPTH_RGBA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec2","u_camera_range",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEPTH_RGBA","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"GLSL_IN float gS ; GLSL_IN vec2 gT ;".split(" ")}]}}]},
{TYPE:"txt",TOKENS:"GLSL_IN vec2 A ; GLSL_IN vec4 gU ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec2 cX = ( gU . xy - A ) ; float aM = length ( cX ) ; vec2 gV = u_radial_blur_step * cX / aM ; float gW = aM / u_radial_blur_step ; gV *= min ( gW , STEPS_PER_PASS ) / STEPS_PER_PASS ; gW = max ( gW , STEPS_PER_PASS ) ; vec2 gX = A ; float gY = 0.0 ; const int gZ = int ( STEPS_PER_PASS ) ; int g_ = int ( gW + 0.5 ) ; for ( int cq = 0 ; cq < gZ ; cq += 1 ) { if ( cq <= g_ ) {".split(" ")},{TYPE:"cond",
PARTS:[{TYPE:"if",EXPRESSION:["DEPTH_RGBA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float et = gC ( u_input , gX , u_camera_range ) ; gY += max ( ( 1.0 - pow ( aM , 0.3 ) ) * step ( 0.9 , et ) , 0.0 ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 ha = GLSL_TEXTURE ( u_input , gX ) ; gY += cV ( ha ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"} gX += gV ; }".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEPTH_RGBA","WATER_EFFECTS",{TYPE:"logical_and_expr",
PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec2 ce = A + gT ; float hb = fK ( vec2 ( 2.5 * ( ce . x ) , 2.5 * ( ce . y ) + 1.0 * u_time ) ) . x + 0.75 * fK ( vec2 ( 5.0 * ( ce . x ) - 0.66 * u_time , 5.0 * ( ce . y ) + 0.66 * u_time ) ) . x + 0.5 * fz ( vec2 ( 7.5 * ( ce . x ) + 0.33 * u_time , 7.5 * ( ce . y ) - 0.33 * u_time ) ) ; hb *= clamp ( 1.2 - sqrt ( 0.2 * aM ) , 0.0 , 1.0 ) * gS ; gY = max ( hb , gY ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"GLSL_OUT_FRAG_COLOR = eu ( gY / STEPS_PER_PASS ) ; }".split(" ")}]};
e["postprocessing/god_rays.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"DEPTH_RGBA",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"txt",TOKENS:"uniform mat4 u_view_proj_matrix ; uniform vec3 u_sun_direction ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEPTH_RGBA","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform vec4 u_camera_quat ; uniform float u_cam_water_depth ;".split(" ")}]}}]},
{TYPE:"txt",TOKENS:["GLSL_IN","vec2","a_bb_vertex",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEPTH_RGBA","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"GLSL_OUT float gS ; GLSL_OUT vec2 gT ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"GLSL_OUT vec2 A ; GLSL_OUT vec4 gU ; void main ( ) { A = a_bb_vertex ; vec3 bH = normalize ( u_sun_direction ) ; gU = u_view_proj_matrix * vec4 ( bH , 0.0 ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEPTH_RGBA",
"WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"if ( u_cam_water_depth < 0.0 ) { gS = 1.0 ; vec3 hc = vec3 ( 0.0 , 1.0 , 0.0 ) ; vec3 hd = T ( u_camera_quat , hc ) ; hd = normalize ( hd ) ; float he = dot ( hd , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; float hf = atan ( hd . x , hd . z ) ; gT = vec2 ( - hf , acos ( he ) ) ; } else { gS = 0.0 ; }".split(" ")}]}}]},{TYPE:"txt",TOKENS:"gU . xy = 0.5 * ( gU . xy / gU . w + 1.0 ) ; gU += 99999.0 * step ( gU . z , 0.0 ) ; gl_Position = vec4 ( 2.0 * a_bb_vertex . xy - 1.0 , 0.0 , 1.0 ) ; }".split(" ")}]};
e["postprocessing/god_rays_combine.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"SAFARI_CANVAS_ALPHA_HACK",TOKENS:["0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"include",FILE:"pack.glslf"},{TYPE:"txt",TOKENS:"uniform sampler2D u_main ; uniform sampler2D u_god_rays ; uniform float u_god_rays_intensity ; uniform vec3 u_sun_intensity ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 hg = GLSL_TEXTURE ( u_main , A ) ; vec3 hh = clamp ( u_sun_intensity , 0.4 , 0.8 ) ; bG ( hg . rgb ) ; float hi = cV ( GLSL_TEXTURE ( u_god_rays , A ) ) ; vec3 hj = hg . rgb + u_god_rays_intensity * vec3 ( hi ) * hh ; aW ( hj ) ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SAFARI_CANVAS_ALPHA_HACK"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"GLSL_OUT_FRAG_COLOR = vec4 ( hj , max ( 0.01 , hg . a ) ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"GLSL_OUT_FRAG_COLOR = vec4 ( hj , hg . a ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["}"]}]};e["postprocessing/luminance.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",
FILE:"std.glsl"},{TYPE:"txt",TOKENS:"uniform sampler2D u_input ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gA = GLSL_TEXTURE ( u_input , A ) ; float hk = dot ( gA . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ; GLSL_OUT_FRAG_COLOR = vec4 ( vec3 ( hk ) , 1.0 ) ; }".split(" ")}]};e["postprocessing/luminance_av.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",
TOKENS:"uniform sampler2D u_input ; uniform float u_mipmap_1x1 ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float hl = max ( GLSL_TEXTURE ( u_input , A , u_mipmap_1x1 ) . r , 0.01 ) ; GLSL_OUT_FRAG_COLOR = vec4 ( vec3 ( hl ) , 1.0 ) ; }".split(" ")}]};e["postprocessing/luminance_truncated.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"var",NAME:"ADAPTIVE_BLOOM",
TOKENS:["0"]},{TYPE:"txt",TOKENS:"uniform sampler2D u_main ; uniform sampler2D u_luminance ; uniform sampler2D u_average_lum ; uniform float u_bloom_edge_lum ; uniform float u_bloom_key ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ADAPTIVE_BLOOM",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_average_lum_val",";"]}]}}]},{TYPE:"txt",TOKENS:"GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) {".split(" ")},{TYPE:"cond",
PARTS:[{TYPE:"if",EXPRESSION:["ADAPTIVE_BLOOM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float hl = GLSL_TEXTURE ( u_average_lum , vec2 ( 0.5 ) ) . r ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","hl","=","u_average_lum_val",";"]}]}}]},{TYPE:"txt",TOKENS:"float hm = GLSL_TEXTURE ( u_luminance , A ) . r ; vec4 aQ = GLSL_TEXTURE ( u_main , A ) ; float hn = hm / hl ; float ho = u_bloom_edge_lum ; GLSL_OUT_FRAG_COLOR = aQ * u_bloom_key * smoothstep ( ho , ho + 1.2 , hn ) ; }".split(" ")}]};
e["postprocessing/motion_blur.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:"uniform sampler2D u_mb_tex_curr ; uniform sampler2D u_mb_tex_accum ; uniform float u_motion_blur_exp ; uniform float u_motion_blur_decay_threshold ; float hp = 0.0042 ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 hq = GLSL_TEXTURE ( u_mb_tex_curr , A ) ; vec4 hr = GLSL_TEXTURE ( u_mb_tex_accum , A ) ; if ( length ( hq - hr ) > u_motion_blur_decay_threshold ) { vec4 hs = ( 1.0 - u_motion_blur_exp ) * hq + u_motion_blur_exp * hr ; vec4 ht = hs - hr ; vec4 hu = hq - hr ; vec4 cX = min ( max ( abs ( ht ) , vec4 ( hp ) ) , abs ( hu ) ) * sign ( ht ) ; GLSL_OUT_FRAG_COLOR = hr + cX ; } else { GLSL_OUT_FRAG_COLOR = hq ; } }".split(" ")}]};
e["postprocessing/outline.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:"uniform sampler2D u_outline_src ; uniform sampler2D u_outline_mask ; uniform sampler2D u_outline_mask_blurred ; uniform vec3 u_outline_color ; uniform float u_draw_outline ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 hv = GLSL_TEXTURE ( u_outline_src , A ) ; GLSL_OUT_FRAG_COLOR = hv ; if ( u_draw_outline != 0.0 ) { vec4 hw = GLSL_TEXTURE ( u_outline_mask , A ) ; vec4 hx = GLSL_TEXTURE ( u_outline_mask_blurred , A ) ; float hy = hx . a - hw . a ; if ( hy != 0.0 ) { float hz = smoothstep ( 0.0 , 1.0 , hx . a ) ; if ( hw . a == 0.0 ) { vec3 hA = u_outline_color ; aW ( hA ) ; vec4 hB = vec4 ( clamp ( hA , 0.0 , 1.0 ) , 1.0 ) ; GLSL_OUT_FRAG_COLOR = mix ( hv , hB , hz ) ; } } } }".split(" ")}]};
e["postprocessing/performance.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:"uniform sampler2D u_color ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aQ = vec4 ( 0.0 ) ; for ( int cq = 0 ; cq < 10 ; cq ++ ) { vec2 hC = vec2 ( fract ( A * vec2 ( cq ) * vec2 ( 1.431 , 3.921 ) ) ) ; aQ += 0.01 * GLSL_TEXTURE ( u_color , hC ) ; } GLSL_OUT_FRAG_COLOR = aQ ; }".split(" ")}]};
e["postprocessing/postprocessing.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"POST_EFFECT",TOKENS:["POST_EFFECT_NONE"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:"uniform vec2 u_texel_size ; uniform sampler2D u_color ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POST_EFFECT","FLIP_CUBEMAP_COORDS",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform int u_tex_number ; uniform vec2 u_delta ;".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POST_EFFECT","POST_EFFECT_DOF_BLUR",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_dof_bokeh_intensity",";"]}]}}]},{TYPE:"txt",TOKENS:"GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) {".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POST_EFFECT","POST_EFFECT_NONE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , A ) ;".split(" ")}]}},
{TYPE:"elif",EXPRESSION:["POST_EFFECT","POST_EFFECT_GRAYSCALE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 dx = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR . rgb = vec3 ( ( dx . r + dx . g + dx . b ) / 3.0 ) ; GLSL_OUT_FRAG_COLOR . a = 1.0 ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["POST_EFFECT","POST_EFFECT_BLUR",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec2 fM = vec2 ( 0.0 , 0.0 ) ; vec2 cX = u_texel_size ; vec4 aQ ; aQ = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = aQ * 0.2270270270 ; fM += cX ; aQ = GLSL_TEXTURE ( u_color , A + fM ) ; GLSL_OUT_FRAG_COLOR += aQ * 0.1945945946 ; aQ = GLSL_TEXTURE ( u_color , A - fM ) ; GLSL_OUT_FRAG_COLOR += aQ * 0.1945945946 ; fM += cX ; aQ = GLSL_TEXTURE ( u_color , A + fM ) ; GLSL_OUT_FRAG_COLOR += aQ * 0.1216216216 ; aQ = GLSL_TEXTURE ( u_color , A - fM ) ; GLSL_OUT_FRAG_COLOR += aQ * 0.1216216216 ; fM += cX ; aQ = GLSL_TEXTURE ( u_color , A + fM ) ; GLSL_OUT_FRAG_COLOR += aQ * 0.0540540541 ; aQ = GLSL_TEXTURE ( u_color , A - fM ) ; GLSL_OUT_FRAG_COLOR += aQ * 0.0540540541 ; fM += cX ; aQ = GLSL_TEXTURE ( u_color , A + fM ) ; GLSL_OUT_FRAG_COLOR += aQ * 0.0162162162 ; aQ = GLSL_TEXTURE ( u_color , A - fM ) ; GLSL_OUT_FRAG_COLOR += aQ * 0.0162162162 ;".split(" ")}]}},
{TYPE:"elif",EXPRESSION:["POST_EFFECT","POST_EFFECT_GLOW_BLUR",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec2 fM = vec2 ( 0.0 , 0.0 ) ; vec2 cX = u_texel_size ; vec4 aQ ; aQ = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = aQ * ( 1.0 - step ( 0.0 , - aQ . a ) ) * 0.152507 ; fM += cX ; aQ = GLSL_TEXTURE ( u_color , A + fM ) ; GLSL_OUT_FRAG_COLOR += aQ * ( 1.0 - step ( 0.0 , - aQ . a ) ) * 0.141763 ; aQ = GLSL_TEXTURE ( u_color , A - fM ) ; GLSL_OUT_FRAG_COLOR += aQ * ( 1.0 - step ( 0.0 , - aQ . a ) ) * 0.141763 ; fM += cX ; aQ = GLSL_TEXTURE ( u_color , A + fM ) ; GLSL_OUT_FRAG_COLOR += aQ * ( 1.0 - step ( 0.0 , - aQ . a ) ) * 0.113861 ; aQ = GLSL_TEXTURE ( u_color , A - fM ) ; GLSL_OUT_FRAG_COLOR += aQ * ( 1.0 - step ( 0.0 , - aQ . a ) ) * 0.113861 ; fM += cX ; aQ = GLSL_TEXTURE ( u_color , A + fM ) ; GLSL_OUT_FRAG_COLOR += aQ * ( 1.0 - step ( 0.0 , - aQ . a ) ) * 0.079019 ; aQ = GLSL_TEXTURE ( u_color , A - fM ) ; GLSL_OUT_FRAG_COLOR += aQ * ( 1.0 - step ( 0.0 , - aQ . a ) ) * 0.079019 ; fM += cX ; aQ = GLSL_TEXTURE ( u_color , A + fM ) ; GLSL_OUT_FRAG_COLOR += aQ * ( 1.0 - step ( 0.0 , - aQ . a ) ) * 0.047383 ; aQ = GLSL_TEXTURE ( u_color , A - fM ) ; GLSL_OUT_FRAG_COLOR += aQ * ( 1.0 - step ( 0.0 , - aQ . a ) ) * 0.047383 ; fM += cX ; aQ = GLSL_TEXTURE ( u_color , A + fM ) ; GLSL_OUT_FRAG_COLOR += aQ * ( 1.0 - step ( 0.0 , - aQ . a ) ) * 0.024549 ; aQ = GLSL_TEXTURE ( u_color , A - fM ) ; GLSL_OUT_FRAG_COLOR += aQ * ( 1.0 - step ( 0.0 , - aQ . a ) ) * 0.024549 ; fM += cX ; aQ = GLSL_TEXTURE ( u_color , A + fM ) ; GLSL_OUT_FRAG_COLOR += aQ * ( 1.0 - step ( 0.0 , - aQ . a ) ) * 0.01099 ; aQ = GLSL_TEXTURE ( u_color , A - fM ) ; GLSL_OUT_FRAG_COLOR += aQ * ( 1.0 - step ( 0.0 , - aQ . a ) ) * 0.01099 ; fM += cX ; aQ = GLSL_TEXTURE ( u_color , A + fM ) ; GLSL_OUT_FRAG_COLOR += aQ * ( 1.0 - step ( 0.0 , - aQ . a ) ) * 0.00425 ; aQ = GLSL_TEXTURE ( u_color , A - fM ) ; GLSL_OUT_FRAG_COLOR += aQ * ( 1.0 - step ( 0.0 , - aQ . a ) ) * 0.00425 ; fM += cX ; aQ = GLSL_TEXTURE ( u_color , A + fM ) ; GLSL_OUT_FRAG_COLOR += aQ * ( 1.0 - step ( 0.0 , - aQ . a ) ) * 0.00142 ; aQ = GLSL_TEXTURE ( u_color , A - fM ) ; GLSL_OUT_FRAG_COLOR += aQ * ( 1.0 - step ( 0.0 , - aQ . a ) ) * 0.00142 ; GLSL_OUT_FRAG_COLOR = clamp ( GLSL_OUT_FRAG_COLOR , 0.0 , 1.0 ) ;".split(" ")}]}},
{TYPE:"elif",EXPRESSION:["POST_EFFECT","POST_EFFECT_DOF_BLUR",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec2 fM = vec2 ( 0.0 , 0.0 ) ; vec2 cX = u_texel_size ; vec4 aQ ; vec4 hD ; vec4 hE ; float gD ; float hF = u_dof_bokeh_intensity ; aQ = GLSL_TEXTURE ( u_color , A ) ; hD = aQ ; hE = aQ ; gD = aQ . a ; cX = gD * cX ; for ( int cq = 0 ; cq < 12 ; cq += 2 ) { fM += cX ; aQ = GLSL_TEXTURE ( u_color , A + fM ) ; hD += aQ ; hE = max ( hE , aQ ) ; aQ = GLSL_TEXTURE ( u_color , A - fM ) ; hD += aQ ; hE = max ( hE , aQ ) ; } hD /= 13.0 ; GLSL_OUT_FRAG_COLOR = mix ( hD , hE , hF ) ;".split(" ")}]}},
{TYPE:"elif",EXPRESSION:["POST_EFFECT","POST_EFFECT_ALPHA_BLUR",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec2 fM = vec2 ( 0.0 , 0.0 ) ; vec2 cX = u_texel_size ; vec4 aQ ; vec4 hD ; vec4 hE ; aQ = GLSL_TEXTURE ( u_color , A ) ; hE = max ( hE , aQ ) ; hD = aQ ; hD . a = aQ . a * 0.2270270270 ; fM += cX ; aQ = GLSL_TEXTURE ( u_color , A + fM ) ; hE . a = max ( hE . a , aQ . a ) ; hD . a += aQ . a * 0.1945945946 ; aQ = GLSL_TEXTURE ( u_color , A - fM ) ; hE . a = max ( hE . a , aQ . a ) ; hD . a += aQ . a * 0.1945945946 ; fM += cX ; aQ = GLSL_TEXTURE ( u_color , A + fM ) ; hE . a = max ( hE . a , aQ . a ) ; hD . a += aQ . a * 0.1216216216 ; aQ = GLSL_TEXTURE ( u_color , A - fM ) ; hE . a = max ( hE . a , aQ . a ) ; hD . a += aQ . a * 0.1216216216 ; fM += cX ; aQ = GLSL_TEXTURE ( u_color , A + fM ) ; hE . a = max ( hE . a , aQ . a ) ; hD . a += aQ . a * 0.0540540541 ; aQ = GLSL_TEXTURE ( u_color , A - fM ) ; hE . a = max ( hE . a , aQ . a ) ; hD . a += aQ . a * 0.0540540541 ; fM += cX ; aQ = GLSL_TEXTURE ( u_color , A + fM ) ; hE . a = max ( hE . a , aQ . a ) ; hD . a += aQ . a * 0.0162162162 ; aQ = GLSL_TEXTURE ( u_color , A - fM ) ; hE . a = max ( hE . a , aQ . a ) ; hD . a += aQ . a * 0.0162162162 ; GLSL_OUT_FRAG_COLOR = mix ( hD , hE , 0.5 ) ;".split(" ")}]}},
{TYPE:"elif",EXPRESSION:["POST_EFFECT","POST_EFFECT_EXTEND",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec2 cX = u_texel_size ; vec4 aQ = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = aQ ; if ( aQ . a == 0.0 ) { aQ = GLSL_TEXTURE ( u_color , A + cX ) ; if ( aQ . a > 0.0 ) GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , aQ . a ) ; else { aQ = GLSL_TEXTURE ( u_color , A - cX ) ; if ( aQ . a > 0.0 ) GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , aQ . a ) ; } }".split(" ")}]}},
{TYPE:"elif",EXPRESSION:["POST_EFFECT","FLIP_CUBEMAP_COORDS",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float hG = u_delta [ 0 ] ; float hH = u_delta [ 1 ] ; float hI = 1.0 / 3.0 ; float hJ = 0.5 ; vec2 hK = vec2 ( hI , hJ ) ; if ( u_tex_number == 0 ) { vec2 ce = mat2 ( 0.0 , - 1.0 , 1.0 , 0.0 ) * A * hK + vec2 ( 2.0 * hI , hJ ) ; ce [ 0 ] = max ( ce [ 0 ] , 2.0 * hI + hG ) ; ce [ 1 ] = max ( ce [ 1 ] , hH ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( ce [ 0 ] , hJ - ce [ 1 ] ) ) ; } else if ( u_tex_number == 1 ) { vec2 ce = mat2 ( 0.0 , - 1.0 , 1.0 , 0.0 ) * A * hK + vec2 ( 0.0 , hJ ) ; ce [ 0 ] = max ( ce [ 0 ] , hG ) ; ce [ 1 ] = min ( ce [ 1 ] , hJ - hH ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( hI - ce [ 0 ] , ce [ 1 ] ) ) ; } else if ( u_tex_number == 2 ) { vec2 ce = A * hK + vec2 ( 2.0 * hI , hJ ) ; ce [ 0 ] = max ( ce [ 0 ] , 2.0 * hI + hG ) ; ce [ 1 ] = min ( ce [ 1 ] , 1.0 - hH ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( ce [ 0 ] , 1.5 - ce [ 1 ] ) ) ; } else if ( u_tex_number == 3 ) { vec2 ce = A * hK + vec2 ( hI , 0.0 ) ; ce [ 0 ] = max ( ce [ 0 ] , hI + hG ) ; ce [ 0 ] = min ( ce [ 0 ] , 2.0 * hI - hG ) ; ce [ 1 ] = min ( ce [ 1 ] , hJ - hH ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( 1.0 - ce [ 0 ] , ce [ 1 ] ) ) ; } else if ( u_tex_number == 4 ) { vec2 ce = A * hK + vec2 ( hI , hJ ) ; ce [ 0 ] = max ( ce [ 0 ] , hI + hG ) ; ce [ 0 ] = min ( ce [ 0 ] , 2.0 * hI - hG ) ; ce [ 1 ] = min ( ce [ 1 ] , 1.0 - hH ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( ce [ 0 ] , 3.0 * hJ - ce [ 1 ] ) ) ; } else { vec2 ce = A * hK + vec2 ( 0.0 , hJ ) ; ce [ 0 ] = max ( ce [ 0 ] , hG ) ; ce [ 1 ] = min ( ce [ 1 ] , 1.0 - hH ) ; ce [ 1 ] = max ( ce [ 1 ] , hJ + hH ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( hI - ce [ 0 ] , ce [ 1 ] ) ) ; }".split(" ")}]}}]},
{TYPE:"txt",TOKENS:["}"]}]};e["postprocessing/postprocessing.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:"GLSL_IN vec2 a_position ; GLSL_OUT vec2 A ; void main ( ) { A = 2.0 * a_position ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};e["postprocessing/precompute_brdf.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},
{TYPE:"include",FILE:"std.glsl"},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"txt",TOKENS:"precision PRECISION sampler2D ; precision PRECISION float ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; float eb ( int cw , int dY ) { float dZ = 1.0 / float ( dY ) ; float d_ = 1.0 ; float ea = 0.0 ; for ( int cq = 0 ; cq < 32 ; ++ cq ) { if ( cw > 0 ) { d_ = mod ( float ( cw ) , 2.0 ) ; ea += d_ * dZ ; dZ = dZ / 2.0 ; cw = int ( float ( cw ) / 2.0 ) ; } } return ea ; } vec2 ed ( int cq , int ec ) { return vec2 ( float ( cq ) / float ( ec ) , eb ( cq , 2 ) ) ; } vec3 ek ( vec2 ee , vec3 ec , float ef ) { float a = ef * ef ; float bC = 2.0 * M_PI * ee . x ; float eg = sqrt ( ( 1.0 - ee . y ) / ( 1.0 + ( a * a - 1.0 ) * ee . y ) ) ; float eh = sqrt ( 1.0 - eg * eg ) ; vec3 ei ; ei . x = cos ( bC ) * eh ; ei . y = sin ( bC ) * eh ; ei . z = eg ; vec3 by = abs ( ec . z ) < 0.999 ? vec3 ( 0.0 , 0.0 , 1.0 ) : vec3 ( 1.0 , 0.0 , 0.0 ) ; vec3 V = normalize ( cross ( by , ec ) ) ; vec3 ej = cross ( ec , V ) ; vec3 bF = V * ei . x + ej * ei . y + ec * ei . z ; return normalize ( bF ) ; } float hO ( float hL , float ef ) { float a = ef ; float hM = ( a * a ) / 2.0 ; float hN = hL ; float d_ = hL * ( 1.0 - hM ) + hM ; return hN / d_ ; } float hR ( vec3 ec , vec3 en , vec3 eq , float ef ) { float hL = max ( dot ( ec , en ) , 0.0 ) ; float er = max ( dot ( ec , eq ) , 0.0 ) ; float hP = hO ( hL , ef ) ; float hQ = hO ( er , ef ) ; return hQ * hP ; } vec2 hY ( float hL , float ef ) { vec3 en ; en . x = sqrt ( 1.0 - hL * hL ) ; en . y = 0.0 ; en . z = hL ; float cG = 0.0 ; float hS = 0.0 ; vec3 ec = vec3 ( 0.0 , 0.0 , 1.0 ) ; const int eo = 1024 ; for ( int cq = 0 ; cq < eo ; ++ cq ) { vec2 ee = ed ( cq , eo ) ; vec3 ei = ek ( ee , ec , ef ) ; vec3 eq = normalize ( 2.0 * dot ( en , ei ) * ei - en ) ; float er = max ( eq . z , 0.0 ) ; float hT = max ( ei . z , 0.0 ) ; float hU = max ( dot ( en , ei ) , 0.0 ) ; if ( er > 0.0 ) { float hV = hR ( ec , en , eq , ef ) ; float hW = ( hV * hU ) / ( hT * hL ) ; float hX = pow ( 1.0 - hU , 5.0 ) ; cG += ( 1.0 - hX ) * hW ; hS += hX * hW ; } } cG /= float ( eo ) ; hS /= float ( eo ) ; return vec2 ( cG , hS ) ; } void main ( ) { vec2 hZ = hY ( A . x , A . y ) ; GLSL_OUT_FRAG_COLOR = vec4 ( hZ , 0.0 , 1.0 ) ; }".split(" ")}]};
e["postprocessing/smaa.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"SMAA_PASS",TOKENS:["SMAA_RESOLVE"]},{TYPE:"var",NAME:"SMAA_REPROJECTION",TOKENS:["0"]},{TYPE:"var",NAME:"SMAA_PREDICATION",TOKENS:["0"]},{TYPE:"var",NAME:"SMAA_DISABLE_CORNER_DETECTION",TOKENS:["0"]},{TYPE:"var",NAME:"AA_METHOD",TOKENS:["AA_METHOD_SMAA_ULTRA"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"pack.glslf"},{TYPE:"txt",
TOKENS:["uniform","sampler2D","u_color",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_RESOLVE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_color_prev",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_blend",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_REPROJECTION"],
GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_velocity_tex",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_EDGE_DETECTION",{TYPE:"equal_expr",PLACES:2},"SMAA_PREDICATION",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_predication_tex",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:"uniform sampler2D u_search_tex ; uniform sampler2D u_area_tex ; uniform vec4 u_subsample_indices ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"uniform vec2 u_texel_size ; GLSL_IN vec2 A ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","h_",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"GLSL_IN vec4 ia ; GLSL_IN vec4 ib ; GLSL_IN vec4 ic ;".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","id",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["AA_METHOD","AA_METHOD_SMAA_LOW",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_THRESHOLD",TOKENS:["0.15"]},{TYPE:"define",NAME:"SMAA_DISABLE_DIAG_DETECTION",TOKENS:["1"]},
{TYPE:"define",NAME:"SMAA_DISABLE_CORNER_DETECTION",TOKENS:["1"]}]}},{TYPE:"elif",EXPRESSION:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_THRESHOLD",TOKENS:["0.1"]},{TYPE:"define",NAME:"SMAA_DISABLE_DIAG_DETECTION",TOKENS:["1"]},{TYPE:"define",NAME:"SMAA_DISABLE_CORNER_DETECTION",TOKENS:["1"]}]}},{TYPE:"elif",EXPRESSION:["AA_METHOD","AA_METHOD_SMAA_HIGH",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_THRESHOLD",
TOKENS:["0.1"]},{TYPE:"define",NAME:"SMAA_DISABLE_DIAG_DETECTION",TOKENS:["0"]},{TYPE:"define",NAME:"SMAA_MAX_SEARCH_STEPS_DIAG",TOKENS:["8"]},{TYPE:"define",NAME:"SMAA_CORNER_ROUNDING",TOKENS:["25"]}]}},{TYPE:"elif",EXPRESSION:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_THRESHOLD",TOKENS:["0.05"]},{TYPE:"define",NAME:"SMAA_DISABLE_DIAG_DETECTION",TOKENS:["0"]},{TYPE:"define",NAME:"SMAA_MAX_SEARCH_STEPS_DIAG",TOKENS:["16"]},
{TYPE:"define",NAME:"SMAA_CORNER_ROUNDING",TOKENS:["25"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_THRESHOLD",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_THRESHOLD",TOKENS:["0.1"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_DEPTH_THRESHOLD",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_DEPTH_THRESHOLD",TOKENS:["(","0.1","*","SMAA_THRESHOLD",")"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_MAX_SEARCH_STEPS_DIAG",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_MAX_SEARCH_STEPS_DIAG",
TOKENS:["8"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_CORNER_ROUNDING",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_CORNER_ROUNDING",TOKENS:["25"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",TOKENS:["2.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_PREDICATION",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_PREDICATION",TOKENS:["0"]}]}}]},{TYPE:"cond",
PARTS:[{TYPE:"ifndef",NAME:"SMAA_PREDICATION_THRESHOLD",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_PREDICATION_THRESHOLD",TOKENS:["0.01"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_PREDICATION_SCALE",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_PREDICATION_SCALE",TOKENS:["2.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_PREDICATION_STRENGTH",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_PREDICATION_STRENGTH",TOKENS:["0.4"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",
NAME:"SMAA_REPROJECTION",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_REPROJECTION",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_REPROJECTION_WEIGHT_SCALE",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_REPROJECTION_WEIGHT_SCALE",TOKENS:["30.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_MAX_SEARCH_STEPS",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_MAX_SEARCH_STEPS",TOKENS:["16"]}]}}]},{TYPE:"define",NAME:"SMAA_AREATEX_MAX_DISTANCE",TOKENS:["16"]},{TYPE:"define",
NAME:"SMAA_AREATEX_MAX_DISTANCE_DIAG",TOKENS:["20"]},{TYPE:"define",NAME:"SMAA_AREATEX_PIXEL_SIZE",TOKENS:"( 1.0 / vec2 ( 160.0 , 560.0 ) )".split(" ")},{TYPE:"define",NAME:"SMAA_AREATEX_SUBTEX_SIZE",TOKENS:["(","1.0","/","7.0",")"]},{TYPE:"define",NAME:"SMAA_SEARCHTEX_SIZE",TOKENS:"vec2 ( 66.0 , 33.0 )".split(" ")},{TYPE:"define",NAME:"SMAA_SEARCHTEX_PACKED_SIZE",TOKENS:"vec2 ( 64.0 , 16.0 )".split(" ")},{TYPE:"define",NAME:"SMAA_CORNER_ROUNDING_NORM",TOKENS:"( float ( SMAA_CORNER_ROUNDING ) / 100.0 )".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_EDGE_DETECTION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 ii ( vec2 ce , sampler2D ie ) { float p = GLSL_TEXTURE ( ie , ce ) . r ; float ig = GLSL_TEXTURE ( ie , ia . xy ) . r ; float ih = GLSL_TEXTURE ( ie , ia . zw ) . r ; return vec3 ( p , ig , ih ) ; }".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_EDGE_DETECTION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:"vec2 im ( vec2 ce , sampler2D ij ) { vec3 ik = ii ( ce , ij ) ; vec2 cX = abs ( ik . xx - ik . yz ) ; vec2 il = step ( SMAA_PREDICATION_THRESHOLD , cX ) ; return SMAA_PREDICATION_SCALE * SMAA_THRESHOLD * ( 1.0 - SMAA_PREDICATION_STRENGTH * il ) ; }".split(" ")}]}}]},{TYPE:"txt",TOKENS:"void ir ( bvec2 io , inout vec2 ip , vec2 iq ) { if ( io . x ) ip . x = iq . x ; if ( io . y ) ip . y = iq . y ; } void ir ( bvec4 io , inout vec4 ip , vec4 iq ) { ir ( io . xy , ip . xy , iq . xy ) ; ir ( io . zw , ip . zw , iq . zw ) ; } vec2 is ( vec2 x ) { return sign ( x ) * floor ( abs ( x ) + .5 ) ; } vec4 is ( vec4 x ) { return sign ( x ) * floor ( abs ( x ) + .5 ) ; }".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_EDGE_DETECTION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec2 iE ( vec2 ce , sampler2D it".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PREDICATION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:[",","sampler2D","ij"]}]}}]},{TYPE:"txt",TOKENS:[")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PREDICATION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec2 iu = im ( ce , ij ) ;".split(" ")}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec2 iu = vec2 ( SMAA_THRESHOLD , SMAA_THRESHOLD ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"vec3 iv = vec3 ( 0.2126 , 0.7152 , 0.0722 ) ; float eq = dot ( GLSL_TEXTURE ( it , ce ) . rgb , iv ) ; float iw = dot ( GLSL_TEXTURE ( it , ia . xy ) . rgb , iv ) ; float ix = dot ( GLSL_TEXTURE ( it , ia . zw ) . rgb , iv ) ; vec4 cX ; cX . xy = abs ( eq - vec2 ( iw , ix ) ) ; vec2 il = step ( iu , cX . xy ) ; if ( dot ( il , vec2 ( 1.0 , 1.0 ) ) == 0.0 ) discard ; float iy = dot ( GLSL_TEXTURE ( it , ib . xy ) . rgb , iv ) ; float iz = dot ( GLSL_TEXTURE ( it , ib . zw ) . rgb , iv ) ; cX . zw = abs ( eq - vec2 ( iy , iz ) ) ; vec2 iA = max ( cX . xy , cX . zw ) ; float iB = dot ( GLSL_TEXTURE ( it , ic . xy ) . rgb , iv ) ; float iC = dot ( GLSL_TEXTURE ( it , ic . zw ) . rgb , iv ) ; cX . zw = abs ( vec2 ( iw , ix ) - vec2 ( iB , iC ) ) ; iA = max ( iA . xy , cX . zw ) ; float iD = max ( iA . x , iA . y ) ; il . xy *= step ( iD , SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR * cX . xy ) ; return il ; }".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_DISABLE_DIAG_DETECTION",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec2 iG ( vec2 iF ) { iF . r = iF . r * abs ( 5.0 * iF . r - 5.0 * 0.75 ) ; return is ( iF ) ; } vec4 iG ( vec4 iF ) { iF . rb = iF . rb * abs ( 5.0 * iF . rb - 5.0 * 0.75 ) ; return is ( iF ) ; } vec2 iI ( sampler2D iH , vec2 ce , vec2 bH , out vec2 iF ) { vec4 f_ = vec4 ( ce , - 1.0 , 1.0 ) ; vec3 t = vec3 ( u_texel_size , 1.0 ) ; for ( int cq = 0 ; cq < SMAA_MAX_SEARCH_STEPS_DIAG ; cq ++ ) { if ( f_ . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && f_ . w > 0.9 ) { f_ . xyz += t * vec3 ( bH , 1.0 ) ; iF = GLSL_TEXTURE ( iH , f_ . xy , 0.0 ) . rg ; f_ . w = dot ( iF , vec2 ( 0.5 , 0.5 ) ) ; } } return f_ . zw ; } vec2 iJ ( sampler2D iH , vec2 ce , vec2 bH , out vec2 iF ) { vec4 f_ = vec4 ( ce , - 1.0 , 1.0 ) ; f_ . x += 0.25 * u_texel_size . x ; vec3 t = vec3 ( u_texel_size , 1.0 ) ; for ( int cq = 0 ; cq < SMAA_MAX_SEARCH_STEPS_DIAG ; cq ++ ) { if ( f_ . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && f_ . w > 0.9 ) { f_ . xyz = t * vec3 ( bH , 1.0 ) + f_ . xyz ; iF = GLSL_TEXTURE ( iH , f_ . xy , 0.0 ) . rg ; iF = iG ( iF ) ; f_ . w = dot ( iF , vec2 ( 0.5 , 0.5 ) ) ; } } return f_ . zw ; } vec2 iL ( sampler2D iK , vec2 aM , vec2 iF , float fM ) { vec2 ce = vec2 ( SMAA_AREATEX_MAX_DISTANCE_DIAG , SMAA_AREATEX_MAX_DISTANCE_DIAG ) * iF + aM ; ce = SMAA_AREATEX_PIXEL_SIZE * ce + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; ce . x += 0.5 ; ce . y += SMAA_AREATEX_SUBTEX_SIZE * fM ; return GLSL_TEXTURE ( iK , ce , 0.0 ) . rg ; } vec2 iQ ( sampler2D iH , sampler2D iK , vec2 ce , vec2 iF , vec4 iM ) { vec2 iv = vec2 ( 0.0 , 0.0 ) ; vec4 dC ; vec2 iN ; if ( iF . r > 0.0 ) { dC . xz = iI ( iH , ce , vec2 ( - 1.0 , 1.0 ) , iN ) ; dC . x += float ( iN . y > 0.9 ) ; } else dC . xz = vec2 ( 0.0 , 0.0 ) ; dC . yw = iI ( iH , ce , vec2 ( 1.0 , - 1.0 ) , iN ) ; if ( dC . x + dC . y > 2.0 ) { vec4 iO = vec4 ( - dC . x + 0.25 , dC . x , dC . y , - dC . y - 0.25 ) * u_texel_size . xyxy + ce . xyxy ; vec4 dx ; dx . xy = GLSL_TEXTURE ( iH , iO . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . rg ; dx . zw = GLSL_TEXTURE ( iH , iO . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . rg ; dx . yxwz = iG ( dx . xyzw ) ; vec2 iP = vec2 ( 2.0 , 2.0 ) * dx . xz + dx . yw ; ir ( bvec2 ( step ( 0.9 , dC . zw ) ) , iP , vec2 ( 0.0 , 0.0 ) ) ; iv += iL ( iK , dC . xy , iP , iM . z ) ; } dC . xz = iJ ( iH , ce , vec2 ( - 1 , - 1 ) , iN ) ; if ( GLSL_TEXTURE ( iH , ce + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r > 0.0 ) { dC . yw = iJ ( iH , ce , vec2 ( 1 , 1 ) , iN ) ; dC . y += float ( iN . y > 0.9 ) ; } else dC . yw = vec2 ( 0.0 , 0.0 ) ; if ( dC . x + dC . y > 2.0 ) { vec4 iO = vec4 ( - dC . x , - dC . x , dC . y , dC . y ) * u_texel_size . xyxy + ce . xyxy ; vec4 dx ; dx . x = GLSL_TEXTURE ( iH , iO . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . g ; dx . y = GLSL_TEXTURE ( iH , iO . xy + u_texel_size * vec2 ( 0 , - 1 ) , 0.0 ) . r ; dx . zw = GLSL_TEXTURE ( iH , iO . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . gr ; vec2 iP = vec2 ( 2.0 , 2.0 ) * dx . xz + dx . yw ; ir ( bvec2 ( step ( 0.9 , dC . zw ) ) , iP , vec2 ( 0 , 0 ) ) ; iv += iL ( iK , dC . xy , iP , iM . w ) . gr ; } return iv ; }".split(" ")}]}}]},
{TYPE:"txt",TOKENS:"float iT ( sampler2D iR , vec2 iF , float fM ) { vec2 hK = SMAA_SEARCHTEX_SIZE * vec2 ( 0.5 , - 1.0 ) ; vec2 iS = SMAA_SEARCHTEX_SIZE * vec2 ( fM , 1.0 ) ; hK += vec2 ( - 1.0 , 1.0 ) ; iS += vec2 ( 0.5 , - 0.5 ) ; hK *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; iS *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; return GLSL_TEXTURE ( iR , hK * iF + iS , 0.0 ) . r ; } float iU ( sampler2D iH , sampler2D iR , vec2 ce , float iN ) { vec2 iF = vec2 ( 0.0 , 1.0 ) ; for ( int cq = 0 ; cq < SMAA_MAX_SEARCH_STEPS ; cq ++ ) { if ( ce . x > iN && iF . g > 0.8281 && iF . r == 0.0 ) { iF = GLSL_TEXTURE ( iH , ce , 0.0 ) . rg ; ce = - vec2 ( 2.0 , 0.0 ) * u_texel_size + ce ; } } float fM = - ( 255.0 / 127.0 ) * iT ( iR , iF , 0.0 ) + 3.25 ; return u_texel_size . x * fM + ce . x ; } float iV ( sampler2D iH , sampler2D iR , vec2 ce , float iN ) { vec2 iF = vec2 ( 0.0 , 1.0 ) ; for ( int cq = 0 ; cq < SMAA_MAX_SEARCH_STEPS ; cq ++ ) { if ( ce . x < iN && iF . g > 0.8281 && iF . r == 0.0 ) { iF = GLSL_TEXTURE ( iH , ce , 0.0 ) . rg ; ce = vec2 ( 2.0 , 0.0 ) * u_texel_size + ce ; } } float fM = - ( 255.0 / 127.0 ) * iT ( iR , iF , 0.5 ) + 3.25 ; return - u_texel_size . x * fM + ce . x ; } float iW ( sampler2D iH , sampler2D iR , vec2 ce , float iN ) { vec2 iF = vec2 ( 1.0 , 0.0 ) ; for ( int cq = 0 ; cq < SMAA_MAX_SEARCH_STEPS ; cq ++ ) { if ( ce . y > iN && iF . r > 0.8281 && iF . g == 0.0 ) { iF = GLSL_TEXTURE ( iH , ce , 0.0 ) . rg ; ce = - vec2 ( 0.0 , 2.0 ) * u_texel_size + ce ; } } float fM = - ( 255.0 / 127.0 ) * iT ( iR , iF . gr , 0.0 ) + 3.25 ; return u_texel_size . y * fM + ce . y ; } float iX ( sampler2D iH , sampler2D iR , vec2 ce , float iN ) { vec2 iF = vec2 ( 1.0 , 0.0 ) ; for ( int cq = 0 ; cq < SMAA_MAX_SEARCH_STEPS ; cq ++ ) { if ( ce . y < iN && iF . r > 0.8281 && iF . g == 0.0 ) { iF = GLSL_TEXTURE ( iH , ce , 0.0 ) . rg ; ce = vec2 ( 0.0 , 2.0 ) * u_texel_size + ce ; } } float fM = - ( 255.0 / 127.0 ) * iT ( iR , iF . gr , 0.5 ) + 3.25 ; return - u_texel_size . y * fM + ce . y ; } vec2 i_ ( sampler2D iK , vec2 aM , float iY , float iZ , float fM ) { vec2 ce = vec2 ( SMAA_AREATEX_MAX_DISTANCE , SMAA_AREATEX_MAX_DISTANCE ) * is ( 4.0 * vec2 ( iY , iZ ) ) + aM ; ce = SMAA_AREATEX_PIXEL_SIZE * ce + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; ce . y = SMAA_AREATEX_SUBTEX_SIZE * fM + ce . y ; return GLSL_TEXTURE ( iK , ce , 0.0 ) . rg ; } void jc ( sampler2D iH , inout vec2 iv , vec4 ce , vec2 dC ) {".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_DISABLE_CORNER_DETECTION",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec2 ja = step ( dC . xy , dC . yx ) ; vec2 jb = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * ja ; jb /= ja . x + ja . y ; vec2 aL = vec2 ( 1.0 , 1.0 ) ; aL . x -= jb . x * GLSL_TEXTURE ( iH , ce . xy + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . r ; aL . x -= jb . y * GLSL_TEXTURE ( iH , ce . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . r ; aL . y -= jb . x * GLSL_TEXTURE ( iH , ce . xy + u_texel_size * vec2 ( 0 , - 2 ) , 0.0 ) . r ; aL . y -= jb . y * GLSL_TEXTURE ( iH , ce . zw + u_texel_size * vec2 ( 1 , - 2 ) , 0.0 ) . r ; iv *= clamp ( aL , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{TYPE:"txt",TOKENS:"} void jd ( sampler2D iH , inout vec2 iv , vec4 ce , vec2 dC ) {".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_DISABLE_CORNER_DETECTION",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec2 ja = step ( dC . xy , dC . yx ) ; vec2 jb = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * ja ; jb /= ja . x + ja . y ; vec2 aL = vec2 ( 1.0 , 1.0 ) ; aL . x -= jb . x * GLSL_TEXTURE ( iH , ce . xy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . g ; aL . x -= jb . y * GLSL_TEXTURE ( iH , ce . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . g ; aL . y -= jb . x * GLSL_TEXTURE ( iH , ce . xy + u_texel_size * vec2 ( - 2 , 0 ) , 0.0 ) . g ; aL . y -= jb . y * GLSL_TEXTURE ( iH , ce . zw + u_texel_size * vec2 ( - 2 , 1 ) , 0.0 ) . g ; iv *= clamp ( aL , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{TYPE:"txt",TOKENS:["}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 jg ( vec2 ce , vec2 je , sampler2D iH , sampler2D iK , sampler2D iR , vec4 iM ) { vec4 iv = vec4 ( 0.0 , 0.0 , 0.0 , 0.0 ) ; vec2 iF = GLSL_TEXTURE ( iH , ce ) . rg ; if ( iF . g > 0.0 ) {".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_DISABLE_DIAG_DETECTION",{TYPE:"logic_negative_expr",PLACES:1}],
GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"iv . rg = iQ ( iH , iK , ce , iF , iM ) ; if ( iv . r == - iv . g ) {".split(" ")}]}}]},{TYPE:"txt",TOKENS:"vec2 dC ; vec3 iO ; iO . x = iU ( iH , iR , ia . xy , ic . x ) ; iO . y = ib . y ; dC . x = iO . x ; float iY = GLSL_TEXTURE ( iH , iO . xy , 0.0 ) . r ; iO . z = iV ( iH , iR , ia . zw , ic . y ) ; dC . y = iO . z ; dC = abs ( is ( dC / u_texel_size . xx - je . xx ) ) ; vec2 jf = sqrt ( dC ) ; float iZ = GLSL_TEXTURE ( iH , iO . zy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r ; iv . rg = i_ ( iK , jf , iY , iZ , iM . y ) ; iO . y = ce . y ; jc ( iH , iv . rg , iO . xyzy , dC ) ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_DISABLE_DIAG_DETECTION",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"} else iF . r = 0.0 ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"} if ( iF . r > 0.0 ) { vec2 dC ; vec3 iO ; iO . y = iW ( iH , iR , ib . xy , ic . z ) ; iO . x = ia . x ; dC . x = iO . y ; float iY = GLSL_TEXTURE ( iH , iO . xy , 0.0 ) . g ; iO . z = iX ( iH , iR , ib . zw , ic . w ) ; dC . y = iO . z ; dC = abs ( is ( dC / u_texel_size . yy - je . yy ) ) ; vec2 jf = sqrt ( dC ) ; float iZ = GLSL_TEXTURE ( iH , iO . xz + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . g ; iv . ba = i_ ( iK , jf , iY , iZ , iM . x ) ; iO . x = ce . x ; jd ( iH , iv . ba , iO . xyxz , dC ) ; } return iv ; }".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 jp ( vec2 ce , sampler2D it , sampler2D jh".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_REPROJECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:[",","sampler2D","ji"]}]}}]},{TYPE:"txt",TOKENS:") { vec4 a ; a . x = GLSL_TEXTURE ( jh , h_ . xy ) . a ; a . y = GLSL_TEXTURE ( jh , h_ . zw ) . g ; a . wz = GLSL_TEXTURE ( jh , ce ) . xz ; if ( dot ( a , vec4 ( 1.0 , 1.0 , 1.0 , 1.0 ) ) < 1e-5 ) { vec4 aQ = GLSL_TEXTURE ( it , ce , 0.0 ) ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_REPROJECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 jj = GLSL_TEXTURE ( ji , A ) ; vec2 dp = 2.0 * jk ( jj ) - 1.0 ; aQ . a = sqrt ( 2.0 * length ( dp ) ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"return aQ ; } else { bool co = max ( a . x , a . z ) > max ( a . y , a . w ) ; vec4 jl = vec4 ( 0.0 , a . y , 0.0 , a . w ) ; vec2 jm = a . yw ; ir ( bvec4 ( co , co , co , co ) , jl , vec4 ( a . x , 0.0 , a . z , 0.0 ) ) ; ir ( bvec2 ( co , co ) , jm , a . xz ) ; jm /= dot ( jm , vec2 ( 1.0 , 1.0 ) ) ; vec4 jn = jl * vec4 ( u_texel_size , - u_texel_size ) + ce . xyxy ; vec4 aQ = jm . x * GLSL_TEXTURE ( it , jn . xy , 0.0 ) ; aQ += jm . y * GLSL_TEXTURE ( it , jn . zw , 0.0 ) ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_REPROJECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 jj = GLSL_TEXTURE ( ji , jn . xy ) ; vec2 jo = 2.0 * jk ( jj ) - 1.0 ; vec2 dp = jm . x * jo ; jj = GLSL_TEXTURE ( ji , jn . zw ) ; jo = 2.0 * jk ( jj ) - 1.0 ; dp += jm . y * jo ; aQ . a = sqrt ( 2.0 * length ( dp ) ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["return","aQ",";","}","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_RESOLVE",{TYPE:"equal_expr",PLACES:2}],
GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 ju ( vec2 ce , sampler2D jq , sampler2D jr".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_REPROJECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:[",","sampler2D","ji"]}]}}]},{TYPE:"txt",TOKENS:[")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_REPROJECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 jj = GLSL_TEXTURE ( ji , A ) ; vec2 dp ; dp = 2.0 * jk ( jj ) - 1.0 ; vec4 js = GLSL_TEXTURE ( jq , ce ) ; vec4 jt = GLSL_TEXTURE ( jr , ce - dp ) ; float cX = abs ( js . a * js . a - jt . a * jt . a ) / 2.0 ; float cu = 0.5 * clamp ( 1.0 - sqrt ( cX ) * SMAA_REPROJECTION_WEIGHT_SCALE , 0.0 , 1.0 ) ; vec4 aQ = mix ( js , jt , cu ) ; aQ . a = 1.0 ; return aQ ;".split(" ")}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 js = GLSL_TEXTURE ( jq , ce ) ; vec4 jt = GLSL_TEXTURE ( jr , ce ) ; return mix ( js , jt , 0.5 ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_EDGE_DETECTION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 aQ = vec4 ( iE ( A , u_color".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PREDICATION"],
GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:[",","u_predication_tex"]}]}}]},{TYPE:"txt",TOKENS:") , 0.0 , 0.0 ) ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 aQ = jg ( A , id , u_color , u_area_tex , u_search_tex , u_subsample_indices ) ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:"vec4 aQ = jp ( A , u_color , u_blend".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_REPROJECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:[",","u_velocity_tex"]}]}}]},{TYPE:"txt",TOKENS:[")",";"]}]}},{TYPE:"elif",EXPRESSION:["SMAA_PASS","SMAA_RESOLVE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 aQ = vec4 ( ju ( A , u_color , u_color_prev".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_REPROJECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:[",","u_velocity_tex"]}]}}]},{TYPE:"txt",TOKENS:[")",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 aQ = GLSL_TEXTURE ( u_color , A ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","aQ",";","}"]}]};e["postprocessing/smaa.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"SMAA_PASS",TOKENS:["SMAA_RESOLVE"]},{TYPE:"var",NAME:"AA_METHOD",TOKENS:["AA_METHOD_SMAA_LOW"]},
{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:"uniform PRECISION vec2 u_texel_size ; GLSL_IN vec2 a_position ; GLSL_OUT vec2 A ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","h_",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"GLSL_OUT vec4 ia ; GLSL_OUT vec4 ib ; GLSL_OUT vec4 ic ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",
EXPRESSION:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec2","id",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["AA_METHOD","AA_METHOD_SMAA_LOW",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_MAX_SEARCH_STEPS",TOKENS:["4"]}]}},{TYPE:"elif",EXPRESSION:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_MAX_SEARCH_STEPS",
TOKENS:["8"]}]}},{TYPE:"elif",EXPRESSION:["AA_METHOD","AA_METHOD_SMAA_HIGH",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_MAX_SEARCH_STEPS",TOKENS:["16"]}]}},{TYPE:"elif",EXPRESSION:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_MAX_SEARCH_STEPS",TOKENS:["32"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_MAX_SEARCH_STEPS",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_MAX_SEARCH_STEPS",
TOKENS:["16"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_EDGE_DETECTION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"void jv ( vec2 ce ) { ia = u_texel_size . xyxy * vec4 ( - 1.0 , 0.0 , 0.0 , - 1.0 ) + ce . xyxy ; ib = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + ce . xyxy ; ic = u_texel_size . xyxy * vec4 ( - 2.0 , 0.0 , 0.0 , - 2.0 ) + ce . xyxy ; }".split(" ")}]}},{TYPE:"elif",EXPRESSION:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",
{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"void jw ( vec2 ce , out vec2 je ) { je = ce / u_texel_size ; ia = u_texel_size . xyxy * vec4 ( - 0.25 , - 0.125 , 1.25 , - 0.125 ) + ce . xyxy ; ib = u_texel_size . xyxy * vec4 ( - 0.125 , - 0.25 , - 0.125 , 1.25 ) + ce . xyxy ; ic = u_texel_size . xxyy * vec4 ( - 2.0 , 2.0 , - 2.0 , 2.0 ) * float ( SMAA_MAX_SEARCH_STEPS ) + vec4 ( ia . xz , ib . yw ) ; }".split(" ")}]}},{TYPE:"elif",EXPRESSION:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",
{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"void jx ( vec2 ce ) { h_ = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + ce . xyxy ; }".split(" ")}]}}]},{TYPE:"txt",TOKENS:"void main ( ) { A = 2.0 * a_position ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_EDGE_DETECTION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["jv","(","A",")",";"]}]}},{TYPE:"elif",EXPRESSION:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",
{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"jw ( A , id ) ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["jx","(","A",")",";"]}]}}]},{TYPE:"txt",TOKENS:"gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};e["postprocessing/ssao.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",
TOKENS:["highp"]},{TYPE:"var",NAME:"SSAO_WHITE",TOKENS:["0"]},{TYPE:"var",NAME:"SSAO_QUALITY",TOKENS:["SSAO_QUALITY_8"]},{TYPE:"var",NAME:"SSAO_HEMISPHERE",TOKENS:["0"]},{TYPE:"txt",TOKENS:["precision","PRECISION","sampler2D",";"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"depth_fetch.glslf"},{TYPE:"txt",TOKENS:"uniform sampler2D u_color ; uniform sampler2D u_depth ; uniform sampler2D u_ssao_special_tex ; uniform vec2 u_camera_range ; uniform vec2 u_texel_size ; uniform float u_ssao_radius_increase ; uniform float u_ssao_influence ; uniform float u_ssao_dist_factor ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; float jy ( in vec2 f_ ) { return gC ( u_depth , f_ , u_camera_range ) ; } void main ( ) { vec3 gG = GLSL_TEXTURE ( u_color , A ) . rgb ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_WHITE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"GLSL_OUT_FRAG_COLOR = vec4 ( gG , 1.0 ) ; return ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"vec3 jz = normalize ( 2.0 * GLSL_TEXTURE ( u_ssao_special_tex , A * 0.25 / u_texel_size ) . rgb - 1.0 ) ; float et = jy ( A ) ; float jA = et * ( u_camera_range . y - u_camera_range . x ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_QUALITY","SSAO_QUALITY_8",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:"const float jB = 8.0 ; const int jC = 1 ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["SSAO_QUALITY","SSAO_QUALITY_16",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"const float jB = 16.0 ; const int jC = 2 ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["SSAO_QUALITY","SSAO_QUALITY_24",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"const float jB = 24.0 ; const int jC = 3 ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["SSAO_QUALITY",
"SSAO_QUALITY_32",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"const float jB = 32.0 ; const int jC = 4 ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"float jD = u_ssao_radius_increase * 0.001 ; const float jE = 1.0 + 2.4 / jB ; float jF = 0.0 ; for ( int cq = 0 ; cq < jC ; cq ++ ) for ( int x = - 1 ; x <= 1 ; x += 2 ) for ( int y = - 1 ; y <= 1 ; y += 2 ) for ( int z = - 1 ; z <= 1 ; z += 2 ) { vec3 jG = reflect ( normalize ( vec3 ( x , y , z ) ) , jz ) * ( jD *= jE ) ; vec3 jH = vec3 ( A , jA ) ; jH += vec3 ( jG . xy , jG . z * jA * 2.0 ) ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_HEMISPHERE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"jH . z -= 1.4 * ( jH . z - jA ) * step ( jA , jH . z ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"float jI = jy ( jH . xy ) * ( u_camera_range . y - u_camera_range . x ) ; float jJ = clamp ( ( jA - jI ) / jI , 0.0 , 1.0 ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_HEMISPHERE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"jF += mix ( 1.0 , jJ , step ( jI , jH . z ) ) ;".split(" ")}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"jF += mix ( step ( jH . z , jI ) , 0.5 , jJ ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"} jF = jF / jB ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_HEMISPHERE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"jF = clamp ( jF * jF + 0.6 * jF , 0.0 , 1.0 ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"jF = clamp ( jF * jF + jF , 0.0 , 1.0 ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"float jK = u_ssao_influence * ( 1.0 - u_ssao_dist_factor * et ) ; jF = mix ( 1.0 , jF , jK ) ; GLSL_OUT_FRAG_COLOR = vec4 ( gG , jF ) ; }".split(" ")}]};
e["postprocessing/ssao_blur.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"SSAO_BLUR_DEPTH",TOKENS:["0"]},{TYPE:"txt",TOKENS:["precision","PRECISION","sampler2D",";"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_BLUR_DEPTH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"depth_fetch.glslf"}]}}]},{TYPE:"txt",TOKENS:"uniform sampler2D u_ssao_mask ; uniform vec2 u_texel_size ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_BLUR_DEPTH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; uniform float u_ssao_blur_discard_value ; float jy ( in vec2 f_ ) { return gC ( u_depth , f_ , u_camera_range ) ; }".split(" ")}]}}]},{TYPE:"txt",TOKENS:"void main ( ) { float jL = 0.0 ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_BLUR_DEPTH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float jM = jy ( A ) ; float cu = 0.0 ; float jN = u_ssao_blur_discard_value * 100.0 ;".split(" ")}]}}]},
{TYPE:"txt",TOKENS:"vec2 jO = vec2 ( - 2.0 ) ; for ( int cq = 0 ; cq < 4 ; ++ cq ) { for ( int jP = 0 ; jP < 4 ; ++ jP ) { vec2 fM = ( jO + vec2 ( float ( cq ) , float ( jP ) ) ) * u_texel_size ; float jQ = GLSL_TEXTURE ( u_ssao_mask , A + fM ) . a ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_BLUR_DEPTH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float jR = jy ( A + fM ) ; float jS = 1.0 - clamp ( abs ( jR - jM ) * jN , 0.0 , 1.0 ) ; jL += jQ * jS ; cu += jS ;".split(" ")}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["jL","+=","jQ",";"]}]}}]},{TYPE:"txt",TOKENS:["}","}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_BLUR_DEPTH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"GLSL_OUT_FRAG_COLOR = vec4 ( GLSL_TEXTURE ( u_ssao_mask , A ) . rgb , jL / cu ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"GLSL_OUT_FRAG_COLOR = vec4 ( GLSL_TEXTURE ( u_ssao_mask , A ) . rgb , jL / 16.0 ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["}"]}]};
e["postprocessing/stereo.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"ANAGLYPH",TOKENS:["0"]},{TYPE:"var",NAME:"SIDEBYSIDE",TOKENS:["0"]},{TYPE:"var",NAME:"EPSILON",TOKENS:["0.000001"]},{TYPE:"var",NAME:"DISTOR_SCALE",TOKENS:["0.8"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:"uniform sampler2D u_sampler_left ; uniform sampler2D u_sampler_right ; uniform vec2 u_texel_size ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ANAGLYPH",{TYPE:"logic_negative_expr",PLACES:1},"SIDEBYSIDE",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"uniform int u_enable_hmd_stereo ; uniform vec4 u_distortion_params ; uniform vec4 u_chromatic_aberration_coefs ; void ka ( vec2 ce , vec2 ao , float di , sampler2D jT ) { vec2 bD = ( ce - ao ) * 4.0 * u_texel_size [ 0 ] / u_texel_size [ 1 ] / di ; float jU = bD . x * bD . x + bD . y * bD . y ; vec2 jV = bD * ( 1.0 + u_distortion_params [ 0 ] * jU + u_distortion_params [ 1 ] * jU * jU ) ; vec2 jW = jV * 0.5 / ( 1.0 + u_distortion_params [ 0 ] + u_distortion_params [ 1 ] ) ; if ( length ( u_chromatic_aberration_coefs ) > 0.0 ) { vec2 jX = jW * ( 1.0 + u_chromatic_aberration_coefs [ 0 ] + jU * u_chromatic_aberration_coefs [ 1 ] ) + 0.5 ; vec2 jY = jW + 0.5 ; vec2 jZ = jW * ( 1.0 + u_chromatic_aberration_coefs [ 2 ] + jU * u_chromatic_aberration_coefs [ 3 ] ) + 0.5 ; if ( clamp ( jZ , 0.0 , 1.0 ) != jZ ) { GLSL_OUT_FRAG_COLOR = vec4 ( 0.0 ) ; } else { vec4 j_ = GLSL_TEXTURE ( jT , jY ) ; GLSL_OUT_FRAG_COLOR [ 0 ] = GLSL_TEXTURE ( jT , jX ) . x ; GLSL_OUT_FRAG_COLOR [ 1 ] = j_ . y ; GLSL_OUT_FRAG_COLOR [ 2 ] = GLSL_TEXTURE ( jT , jZ ) . z ; GLSL_OUT_FRAG_COLOR [ 3 ] = j_ . w ; } } else { jW += 0.5 ; if ( clamp ( jW , 0.0 , 1.0 ) != jW ) { GLSL_OUT_FRAG_COLOR = vec4 ( 0.0 ) ; } else { GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( jT , jW ) ; } } }".split(" ")}]}}]},
{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ANAGLYPH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 kb = GLSL_TEXTURE ( u_sampler_left , A ) ; vec4 kc = GLSL_TEXTURE ( u_sampler_right , A ) ; vec3 kd = vec3 ( kb [ 0 ] , kb [ 1 ] , kb [ 2 ] ) ; bG ( kd ) ; vec3 ke = vec3 ( kc [ 0 ] , kc [ 1 ] , kc [ 2 ] ) ; bG ( ke ) ; mat3 kf = mat3 ( 0.437 , - 0.062 , - 0.048 , 0.449 , - 0.062 , - 0.050 , 0.164 , - 0.024 , - 0.017 ) ; mat3 bz = mat3 ( - 0.011 , 0.377 , - 0.026 , - 0.032 , 0.761 , - 0.093 , - 0.007 , 0.009 , 1.234 ) ; vec3 aQ = clamp ( kf * kd , 0.0 , 1.0 ) + clamp ( bz * ke , 0.0 , 1.0 ) ; aW ( aQ ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aQ , kb [ 3 ] + kc [ 3 ] ) ;".split(" ")}]}},
{TYPE:"elif",EXPRESSION:["SIDEBYSIDE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"if ( A [ 0 ] < 0.5 ) { vec2 ce = vec2 ( 2.0 * A [ 0 ] , A [ 1 ] ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_sampler_left , ce ) ; } else { vec2 ce = vec2 ( 2.0 * ( A [ 0 ] - 0.5 ) , A [ 1 ] ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_sampler_right , ce ) ; }".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"if ( u_enable_hmd_stereo != 0 ) { if ( abs ( u_distortion_params [ 0 ] ) > EPSILON || abs ( u_distortion_params [ 1 ] ) > EPSILON ) if ( A [ 0 ] < 0.5 ) { vec2 ce = vec2 ( 2.0 * A [ 0 ] , A [ 1 ] ) ; vec2 ao = vec2 ( 0.5 - ( u_distortion_params [ 3 ] - 0.5 ) / 2.0 , u_distortion_params [ 2 ] ) ; float di = 2.0 * u_distortion_params [ 3 ] * DISTOR_SCALE ; ka ( ce , ao , di , u_sampler_left ) ; } else { vec2 ce = vec2 ( 2.0 * ( A [ 0 ] - 0.5 ) , A [ 1 ] ) ; vec2 ao = vec2 ( 0.5 + ( u_distortion_params [ 3 ] - 0.5 ) / 2.0 , u_distortion_params [ 2 ] ) ; float di = 2.0 * u_distortion_params [ 3 ] * DISTOR_SCALE ; ka ( ce , ao , di , u_sampler_right ) ; } else if ( A [ 0 ] < 0.5 ) { vec2 ce = vec2 ( 2.0 * A [ 0 ] , A [ 1 ] ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_sampler_left , ce ) ; } else { vec2 ce = vec2 ( 2.0 * ( A [ 0 ] - 0.5 ) , A [ 1 ] ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_sampler_right , ce ) ; } } else { GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_sampler_left , A ) ; }".split(" ")}]}}]},
{TYPE:"txt",TOKENS:["}"]}]};e["postprocessing/velocity.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"pack.glslf"},{TYPE:"txt",TOKENS:"uniform sampler2D u_depth ; uniform mat4 u_view_proj_inverse ; uniform mat4 u_view_proj_prev ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float et = GLSL_TEXTURE ( u_depth , A ) . x ; vec4 kg = vec4 ( A * 2.0 - 1.0 , 2.0 * et - 1.0 , 1.0 ) ; vec4 cD = u_view_proj_inverse * kg ; vec4 kh = cD / cD . w ; vec4 ki = u_view_proj_prev * kh ; ki /= ki . w ; vec2 dp = ( kg . xy - ki . xy ) / 4.0 + 0.5 ; dp = clamp ( dp , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR = eu ( dp ) ; }".split(" ")}]};
e["include/blending.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"BLENDING_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"BLENDING_GLSLF",TOKENS:[""]},{TYPE:"txt",TOKENS:"vec3 kj ( vec3 rgb ) { vec4 hM = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , hM . wz ) , vec4 ( rgb . gb , hM . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float dC = q . x - min ( q . w , q . y ) ; float iF = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * dC + iF ) ) , dC / ( q . x + iF ) , q . x ) ; } vec3 kl ( vec3 kk ) { vec4 hM = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( kk . r , kk . r , kk . r ) + hM . xyz ) * 6.0 - hM . www ) ; return kk . b * mix ( hM . xxx , clamp ( p - hM . xxx , _0_0 , _1_0 ) , kk . g ) ; } vec3 kp ( vec3 km , vec3 kn , float ko ) { return mix ( km , kn , ko ) ; } vec3 kq ( vec3 km , vec3 kn , float ko ) { return ko * km + kn ; } vec3 kr ( vec3 km , vec3 kn , float ko ) { return kn - ko * km ; } vec3 kt ( vec3 km , vec3 kn , float ko ) { float ks = _1_0 - ko ; return ( vec3 ( ks ) + ko * km ) * kn ; } vec3 ku ( vec3 km , vec3 kn , float ko ) { vec3 ks = vec3 ( _1_0 - ko ) ; return vec3 ( _1_0 ) - ( ks + ko * ( vec3 ( _1_0 ) - km ) ) * ( vec3 ( _1_0 ) - kn ) ; } vec3 kv ( vec3 km , vec3 kn , float ko ) { vec3 ks = vec3 ( _1_0 - ko ) ; return mix ( kn * ( ks + 2.0 * ko * km ) , vec3 ( _1_0 ) - ( ks + 2.0 * ko * ( vec3 ( _1_0 ) - km ) ) * ( vec3 ( _1_0 ) - kn ) , step ( 0.5 , kn ) ) ; } vec3 kw ( vec3 km , vec3 kn , float ko ) { return mix ( kn , abs ( km - kn ) , ko ) ; } vec3 kx ( vec3 km , vec3 kn , float ko ) { return mix ( kn , kn / ( km + step ( km , vec3 ( _0_0 ) ) ) , ko ) ; } vec3 ky ( vec3 km , vec3 kn , float ko ) { return mix ( kn , min ( km , kn ) , ko ) ; } vec3 kz ( vec3 km , vec3 kn , float ko ) { return max ( ko * km , kn ) ; } vec3 kD ( vec3 km , vec3 kn , float ko ) { vec3 kA = kj ( kn ) ; if ( kA . y != _0_0 ) { vec3 kB = kj ( km ) ; vec3 kC = kl ( vec3 ( kA . x , kB . yz ) ) ; return mix ( km , kC , ko ) ; } return km ; } vec3 kE ( vec3 km , vec3 kn , float ko ) { vec3 kA = kj ( km ) ; if ( kA . y != _0_0 ) { vec3 kB = kj ( kn ) ; return kl ( vec3 ( kA . x , mix ( kA . y , kB . y , ko ) , kA . z ) ) ; } return km ; } vec3 kF ( vec3 km , vec3 kn , float ko ) { vec3 kA = kj ( km ) ; vec3 kB = kj ( kn ) ; return kl ( vec3 ( kA . xy , mix ( kA . z , kB . z , ko ) ) ) ; } vec3 kG ( vec3 km , vec3 kn , float ko ) { vec3 kA = kj ( kn ) ; if ( kA . y != _0_0 ) { vec3 kB = kj ( km ) ; vec3 kC = kl ( vec3 ( kA . xy , kB . z ) ) ; return mix ( km , kC , ko ) ; } return km ; } vec3 kI ( vec3 km , vec3 kn , float ko ) { vec3 kH = vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - kn ) * ( vec3 ( _1_0 ) - km ) ; return mix ( km , ( ( vec3 ( _1_0 ) - km ) * kn * km ) + km * kH , ko ) ; } vec3 kJ ( vec3 km , vec3 kn , float ko ) { return km + ko * ( 2.0 * kn - _1_0 ) ; } float kN ( float kK , float kL , float ko , float kM ) { float ks = _1_0 - kM ; return ( ks + ko * kK ) * kL ; } float kO ( float kK , float kL , float ko , float kM ) { float ks = _1_0 - kM ; return _1_0 - ( ks + ko * ( _1_0 - kK ) ) * ( _1_0 - kL ) ; } float kP ( float kK , float kL , float ko , float kM ) { float ks = _1_0 - kM ; return mix ( kL * ( ks + 2.0 * ko * kK ) , _1_0 - ( ks + 2.0 * ko * ( _1_0 - kK ) ) * ( _1_0 - kL ) , step ( 0.5 , kL ) ) ; }".split(" ")}]}}]}]};
e["include/caustics.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"CAUSTICS_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"CAUSTICS_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"SUN_NUM",TOKENS:["0"]},{TYPE:"var",NAME:"CAUST_SCALE",TOKENS:["0.25"]},{TYPE:"var",NAME:"CAUST_SPEED",TOKENS:["vec2","(","0.0",")"]},{TYPE:"var",NAME:"CAUST_BRIGHT",TOKENS:["0.5"]},{TYPE:"include",FILE:"procedural.glslf"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"define",NAME:"CAUSTICS_VIEW_DISTANCE",TOKENS:["100.0"]},
{TYPE:"txt",TOKENS:"void bV ( inout vec3 aQ , float kQ , float fy , vec4 bU , vec3 U , vec3 kR , vec3 kS , vec4 kT , vec3 bt , float bS ) { if ( bS > CAUSTICS_VIEW_DISTANCE ) return ; vec3 kU = bt + U ; kU . xz = 10.0 * sin ( 0.1 * kU . xz ) ; vec3 kW = T ( kV ( kT ) , kU ) ; vec2 ce = kW . xz ; vec3 kX = kR ; float kY = max ( dot ( U , kX ) , 0.0 ) ; float kZ = 0.025 ; vec2 k_ = CAUST_SPEED * fy ; ce . s += 0.25 * sin ( dot ( bt + fy , vec3 ( 1.0 ) ) ) ; ce . t += 0.35 * ( - sin ( dot ( bt - fy , vec3 ( - 0.7 ) ) ) ) ; ce . st += 0.15 * cos ( 4.0 * kQ - k_ . x ) + 1.5 * sin ( kQ - 0.3 * k_ . y ) ; float hK = CAUST_SCALE * ( 1.0 + max ( 0.1 * kQ , 0.0 ) ) ; vec3 lb = la ( ( ce / hK ) , kZ ) ; lb *= CAUST_BRIGHT ; lb *= lb ; float lc = min ( 0.25 * kQ , - kQ ) + 1.0 ; lc = max ( lc , 0.0 ) ; float ld = bU [ SUN_NUM ] * kY ; float le = max ( sign ( kQ ) , 0.0 ) ; ld = ld + max ( 0.5 * sign ( - U . y ) * le , 0.0 ) ; ld = min ( ld , 1.0 ) ; aQ += kS * lb * lc * ld ; }".split(" ")}]}}]}]};
e["include/color_util.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"COLOR_UTIL_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"COLOR_UTIL_GLSLF",TOKENS:[""]},{TYPE:"define",NAME:"PREMULTIPLY_ALPHA",TOKENS:["1"]},{TYPE:"var",NAME:"SRGB",TOKENS:["SRGB_NONE"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:"void bG ( inout float aQ ) {".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SRGB","SRGB_SIMPLE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:"aQ = pow ( aQ , 2.2 ) ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["SRGB","SRGB_PROPER",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"if ( aQ < 0.04045 ) aQ = aQ / 12.92 ; else aQ = pow ( aQ * ( 1.0 / 1.055 ) + 0.0521327 , 2.4 ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"} void aW ( inout float aQ ) {".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SRGB","SRGB_SIMPLE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"aQ = pow ( aQ , 1.0 / 2.2 ) ;".split(" ")}]}},
{TYPE:"elif",EXPRESSION:["SRGB","SRGB_PROPER",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"if ( aQ < 0.0031308 ) aQ = aQ * 12.92 ; else aQ = 1.055 * pow ( aQ , 1.0 / 2.4 ) - 0.055 ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"} void bG ( inout vec3 aQ ) {".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SRGB","SRGB_SIMPLE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"aQ = pow ( aQ , vec3 ( 2.2 ) ) ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["SRGB",
"SRGB_PROPER",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"bG ( aQ . r ) ; bG ( aQ . g ) ; bG ( aQ . b ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"} void aW ( inout vec3 aQ ) {".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SRGB","SRGB_SIMPLE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"aQ = pow ( aQ , vec3 ( 1.0 / 2.2 ) ) ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["SRGB","SRGB_PROPER",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:"aW ( aQ . r ) ; aW ( aQ . g ) ; aW ( aQ . b ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"} void aX ( inout vec3 aQ , in float L ) {".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PREMULTIPLY_ALPHA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"aQ = aQ * L ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"} float gj ( vec4 aQ ) { vec3 lf = vec3 ( 0.299 , 0.587 , 0.114 ) ; float lg = dot ( aQ . rgb , lf ) ; return lg ; }".split(" ")}]}}]}]};e["include/coverage.glslf"]={TYPE:"grp",
PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"COVERAGE_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"COVERAGE_GLSLF",TOKENS:[""]},{TYPE:"include",FILE:"procedural.glslf"},{TYPE:"txt",TOKENS:"const float lh = 1000.0 ; bool C ( float L , float li ) { if ( li < 0.0 ) L = 1.0 - L ; float lj = floor ( L * lh ) ; float ll = floor ( lk ( gl_FragCoord . xy ) * lh ) ; if ( li > 0.0 ) return ll < lj ; else return ll >= lj ; }".split(" ")}]}}]}]};e["include/depth_fetch.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",
PARTS:[{TYPE:"ifndef",NAME:"DEPTH_FETCH_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"DEPTH_FETCH_GLSLF",TOKENS:[""]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},{TYPE:"var",NAME:"CAMERA_TYPE",TOKENS:["CAM_TYPE_PERSP"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_CASTING",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float es ( in float lm , in vec2 ln ) { float dG = ln . x ; float lo = ln . y ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CAMERA_TYPE","CAM_TYPE_PERSP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"return lo * ( 1.0 - dG / lm ) / ( lo - dG ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"return ( lm - dG ) / ( lo - dG ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["}"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float gC ( in sampler2D lp , in vec2 f_ , in vec2 ln ) { float et = GLSL_TEXTURE ( lp , f_ ) . r ; float dG = ln . x ; float lo = ln . y ; float lm = 2.0 * dG / ( dG + lo - ( 2.0 * et - 1.0 ) * ( lo - dG ) ) ; return lm ; }".split(" ")}]}}]}]}}]}]};
e["include/dynamic_grass.glslv"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"DYNAMIC_GRASS_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"DYNAMIC_GRASS_GLSLV",TOKENS:[""]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"DYNAMIC_GRASS",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD",TOKENS:["0"]},{TYPE:"var",NAME:"GRASS_TEXTURE_SIZE",TOKENS:["1024.0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"math.glslv"},
{TYPE:"include",FILE:"to_world.glslv"},{TYPE:"txt",TOKENS:"vec2 lt ( vec3 O , float lq , vec2 lr ) { vec2 ls = vec2 ( ( O . x - lr . x ) / lq , ( O . y - lr . y ) / lq ) ; return fract ( ls ) ; } vec2 lu ( vec2 gX , float lq , vec2 lr ) { return vec2 ( gX . x * lq , gX . y * lq ) + lr ; } au lv ( ) { return au ( vec3 ( - 10000.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) ) ; }".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL3"],GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:"vec4 lF ( sampler2D lw , vec2 lx ) { float ly = 1.0 / GRASS_TEXTURE_SIZE ; vec4 lz = GLSL_TEXTURE ( lw , lx ) ; vec4 lA = GLSL_TEXTURE ( lw , lx + vec2 ( ly , 0.0 ) ) ; vec4 lB = GLSL_TEXTURE ( lw , lx + vec2 ( 0.0 , ly ) ) ; vec4 lC = GLSL_TEXTURE ( lw , lx + vec2 ( ly , ly ) ) ; float a = fract ( lx . x * GRASS_TEXTURE_SIZE ) ; vec4 lD = mix ( lz , lA , a ) ; vec4 lE = mix ( lB , lC , a ) ; float b = fract ( lx . y * GRASS_TEXTURE_SIZE ) ; return mix ( lD , lE , b ) ; }".split(" ")}]}}]},
{TYPE:"txt",TOKENS:"au be ( vec3 O , vec3 V , vec3 lG , vec3 W , vec3 U , vec3 ao , PRECISION sampler2D lH , sampler2D lI , vec3 lJ , float lK , vec3 lL , vec4 lM , mat3 N , mat3 Z ) { vec3 lN = T ( lM , vec3 ( 0.0 , 0.0 , - 1.0 ) ) ; float lO = - lN . x ; float lP = lN . y ; vec2 lr = vec2 ( lL . x - lK * ( 1.0 + lO ) / 2.0 , lL . y - lK * ( 1.0 - lP ) / 2.0 ) ; vec2 lQ = lt ( ao , lK , lr ) ; float lR = lK / 2.0 ; vec2 lS = abs ( lu ( lQ - vec2 ( 0.5 ) , lK , vec2 ( 0.0 ) ) ) ; float lT = lR * ( 1.0 + sqrt ( 2.0 ) ) / 2.0 ; if ( length ( lS ) > lT ) return lv ( ) ; float lU = lK / lJ . z ; vec2 lV = ( lQ - vec2 ( 0.5 ) ) * lU + vec2 ( 0.5 ) ; vec3 lW = lN * ( lK / lJ . z - 1.0 ) / 2.0 ; lV . x += lW . x ; lV . y += lW . y ; vec4 lX = GLSL_TEXTURE ( lI , lV ) ; float hK = lX . r ; if ( hK < u_scale_threshold ) return lv ( ) ; float lY = lJ . y - lJ . x ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL3"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float cn = lJ . y - ( lF ( lH , lV ) ) . r * lY ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float cn = lJ . y - ( GLSL_TEXTURE ( lH , lV ) ) . r * lY ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"vec2 lZ = O . xy - ao . xy ; ao . xy = lu ( lQ , lK , lr ) ; ao . z = cn ; O . xy = ao . xy + lZ ; O . z *= hK ; O . z += cn ; vec3 aQ = lX . gba ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",
EXPRESSION:["BILLBOARD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"O -= ao ; mat3 l_ = as ( lL , ao , N , Z ) ; au aw = av ( O , ao , V , lG , W , U , l_ ) ; aw . ao = ao ; aw . aQ = aQ ; return ma ( aw ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"return ma ( au ( O , ao , V , lG , W , U , aQ ) ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]}]}}]}]};e["include/environment.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"ENVIRONMENT_GLSLF",
GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"ENVIRONMENT_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"USE_ENVIRONMENT_LIGHT",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_TEXTURE",TOKENS:["0"]},{TYPE:"txt",TOKENS:"vec3 cE ( vec3 U ) {".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_ENVIRONMENT_LIGHT"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKY_TEXTURE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"return GLSL_TEXTURE_CUBE ( u_sky_texture , U ) . rgb ;".split(" ")}]}},
{TYPE:"elif",EXPRESSION:["SKY_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float mb = 0.5 * U . z + 0.5 ; return mix ( u_horizon_color , u_zenith_color , mb ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"return vec3 ( 1.0 ) ;".split(" ")}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"return vec3 ( 0.0 ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]}]};e["include/fog.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FOG_GLSLF",
GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FOG_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"USE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"FOG_TYPE",TOKENS:["QUADRATIC"]},{TYPE:"var",NAME:"PROCEDURAL_FOG",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"void mg ( inout vec3 aQ , in float mc , in float cn , in vec4 md ) { float me = clamp ( ( mc - u_fog_params . z ) / u_fog_params . y , 0.0 , 1.0 ) ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FOG_TYPE","QUADRATIC",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["me","*=","me",";"]}]}},{TYPE:"elif",EXPRESSION:["FOG_TYPE","LINEAR",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[]}},{TYPE:"elif",EXPRESSION:["FOG_TYPE","INVERSE_QUADRATIC",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"me = sqrt ( me ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"if ( u_fog_params . w > 0.0 ) { if ( cn > u_fog_params . w ) me = 0.0 ; else { float mf = ( u_fog_params . w - max ( cn , 0.0 ) ) / u_fog_params . w ; me *= mf * mf ; } } md . a = 1.0 - ( 1.0 - me ) * ( 1.0 - u_fog_params . x ) ; aQ = mix ( aQ , md . rgb , md . a ) ; }".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 ml ( in mat4 mh , in vec3 D ) { vec3 mi = mix ( mh [ 0 ] . rgb , mh [ 1 ] . rgb , ( D . x + 1.0 ) / 2.0 ) ; vec3 mj = mix ( mh [ 2 ] . rgb , mh [ 3 ] . rgb , ( D . y + 1.0 ) / 2.0 ) ; vec3 mk = vec3 ( mh [ 0 ] . a , mh [ 1 ] . a , mh [ 2 ] . a ) ; vec3 aQ = mix ( mi , mj , abs ( D . y ) ) ; aQ = mix ( aQ , mk , abs ( D . z ) ) ; bG ( aQ ) ; return aQ ; }".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",
EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"void mn ( inout float mm ) { mm -= 0.5 ; mm = 4.0 * ( mm * mm * mm ) + 0.5 ; } void mt ( inout vec3 aQ , in float mc , in vec3 D , in float eG , in vec4 mo , in float fp ) { float mp = max ( D . z , 0.0 ) ; float mq = max ( mc - max ( eG / mp , 0.0 ) , 0.0 ) ; float mr = mo . w * mq ; vec3 eH = vec3 ( 0.0 , 0.02 , 0.05 ) ; vec3 ms = mo . rgb ; mr = min ( mr , 1.0 ) ; mn ( mr ) ; mr *= clamp ( 2.0 - fp , 0.0 , 1.0 ) ; vec3 eI = mix ( ms , eH , min ( mp , 1.0 ) ) ; eG = clamp ( - eG * 0.03 , 0.0 , 0.8 ) ; eI *= 1.0 - eG ; aQ = mix ( aQ , eI , mr ) ; }".split(" ")}]}}]},
{TYPE:"txt",TOKENS:"void bW ( inout vec3 aQ , float mc , vec3 D , float bT ) {".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 mh = ml ( u_cube_fog , D ) ; vec4 eI = vec4 ( mh , u_fog_color_density . a ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","eI","=","u_fog_color_density",";"]}]}}]},{TYPE:"txt",TOKENS:"mg ( aQ , mc , h . z , eI ) ;".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"mt ( aQ , mc , D , u_cam_water_depth , u_underwater_fog_color_density , bT ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]}]};e["include/fxaa.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"FXAA_BLEND4WEB",TOKENS:["1"]},{TYPE:"var",NAME:"FXAA_QUALITY_P12",TOKENS:["0.0"]},
{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_PS3",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_PS3",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_360",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_360",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_360_OPT",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_360_OPT",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_PC",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_PC",TOKENS:["0"]}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_PC_CONSOLE",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_PC_CONSOLE",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_GLSL_120",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_GLSL_120",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_GLSL_130",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_GLSL_130",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_HLSL_3",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",
NAME:"FXAA_HLSL_3",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_HLSL_4",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_HLSL_4",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_HLSL_5",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_HLSL_5",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_GREEN_AS_LUMA",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_GREEN_AS_LUMA",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_EARLY_EXIT",
GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_EARLY_EXIT",TOKENS:["1"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_DISCARD",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_DISCARD",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_FAST_PIXEL_OFFSET",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifdef",NAME:"GL_EXT_gpu_shader4",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_FAST_PIXEL_OFFSET",TOKENS:["1"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifdef",NAME:"GL_NV_gpu_shader5",
GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_FAST_PIXEL_OFFSET",TOKENS:["1"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifdef",NAME:"GL_ARB_gpu_shader5",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_FAST_PIXEL_OFFSET",TOKENS:["1"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_FAST_PIXEL_OFFSET",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_FAST_PIXEL_OFFSET",TOKENS:["0"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_GATHER4_ALPHA",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",
EXPRESSION:["FXAA_HLSL_5",1,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_GATHER4_ALPHA",TOKENS:["1"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifdef",NAME:"GL_ARB_gpu_shader5",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_GATHER4_ALPHA",TOKENS:["1"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifdef",NAME:"GL_NV_gpu_shader5",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_GATHER4_ALPHA",TOKENS:["1"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_GATHER4_ALPHA",GROUP:{TYPE:"grp",
PARTS:[{TYPE:"define",NAME:"FXAA_GATHER4_ALPHA",TOKENS:["0"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:[1],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:[0],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",TOKENS:["4.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:[0],
GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",TOKENS:["2.0"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:[1],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",TOKENS:["0.125"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",TOKENS:["0.25"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",
NAME:"FXAA_QUALITY_PRESET",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PRESET",TOKENS:["12"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",10,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["3"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["3.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["12.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",
11,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["4"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["3.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["12.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",12,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["5"]},
{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["4.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["12.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",13,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["6"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},
{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["4.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["12.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",14,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["7"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},
{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["4.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P6",TOKENS:["12.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",15,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["8"]},
{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P6",TOKENS:["4.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P7",TOKENS:["12.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",
20,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["3"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",21,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["4"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},
{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",22,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},
{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",23,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["6"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},
{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",24,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["7"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},
{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["3.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P6",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",25,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["8"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},
{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P6",TOKENS:["4.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P7",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",26,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["9"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},
{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P6",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P7",TOKENS:["4.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P8",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",
27,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["10"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P6",TOKENS:["2.0"]},{TYPE:"define",
NAME:"FXAA_QUALITY_P7",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P8",TOKENS:["4.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P9",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",28,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["11"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",
NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P6",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P7",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P8",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P9",TOKENS:["4.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P10",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",29,{TYPE:"equal_expr",
PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["12"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P6",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P7",
TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P8",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P9",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P10",TOKENS:["4.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P11",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",39,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["12"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",
TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P6",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P7",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P8",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P9",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P10",TOKENS:["4.0"]},
{TYPE:"define",NAME:"FXAA_QUALITY_P11",TOKENS:["8.0"]}]}}]},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:"float mu ( float x ) { return clamp ( x , 0.0 , 1.0 ) ; }".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_BLEND4WEB",1,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 mv ( sampler2D t , vec2 p ) { return GLSL_TEXTURE ( t , p ) ; } vec4 mx ( sampler2D t , vec2 p , vec2 mw , vec2 r ) { return GLSL_TEXTURE ( t , p + ( mw * r ) ) ; }".split(" ")}]}}]},
{TYPE:"txt",TOKENS:"vec4 gz ( vec2 fr , sampler2D ie , vec2 my , float mz , float mA , float mB ) { vec2 mC ; mC . x = fr . x ; mC . y = fr . y ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_GATHER4_ALPHA",1,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 mD = mv ( ie , mC ) ; float gk = gj ( mD ) ; float mE = gj ( mx ( ie , mC , vec2 ( 0 , 1 ) , my . xy ) ) ; float mF = gj ( mx ( ie , mC , vec2 ( 1 , 0 ) , my . xy ) ) ; float mG = gj ( mx ( ie , mC , vec2 ( 0 , - 1 ) , my . xy ) ) ; float mH = gj ( mx ( ie , mC , vec2 ( - 1 , 0 ) , my . xy ) ) ;".split(" ")}]}}]},
{TYPE:"txt",TOKENS:"float mI = max ( mE , gk ) ; float mJ = min ( mE , gk ) ; float mK = max ( mF , mI ) ; float mL = min ( mF , mJ ) ; float mM = max ( mG , mH ) ; float mN = min ( mG , mH ) ; float mO = max ( mM , mK ) ; float mP = min ( mN , mL ) ; float mQ = mO * mA ; float mR = mO - mP ; float mS = max ( mB , mQ ) ; bool mT = mR < mS ; if ( mT ) return mD ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_GATHER4_ALPHA",0,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:"float gl = gj ( mx ( ie , mC , vec2 ( - 1 , - 1 ) , my . xy ) ) ; float go = gj ( mx ( ie , mC , vec2 ( 1 , 1 ) , my . xy ) ) ; float gm = gj ( mx ( ie , mC , vec2 ( 1 , - 1 ) , my . xy ) ) ; float gn = gj ( mx ( ie , mC , vec2 ( - 1 , 1 ) , my . xy ) ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[]}}]},{TYPE:"txt",TOKENS:"float mU = mG + mE ; float mV = mH + mF ; float mW = 1.0 / mR ; float mX = mU + mV ; float mY = ( - 2.0 * gk ) + mU ; float mZ = ( - 2.0 * gk ) + mV ; float m_ = gm + go ; float na = gl + gm ; float nb = ( - 2.0 * mF ) + m_ ; float nc = ( - 2.0 * mG ) + na ; float nd = gl + gn ; float ne = gn + go ; float nf = ( abs ( mY ) * 2.0 ) + abs ( nb ) ; float ng = ( abs ( mZ ) * 2.0 ) + abs ( nc ) ; float nh = ( - 2.0 * mH ) + nd ; float ni = ( - 2.0 * mE ) + ne ; float nj = abs ( nh ) + nf ; float nk = abs ( ni ) + ng ; float nl = nd + m_ ; float nm = my . x ; bool nn = nj >= nk ; float no = mX * 2.0 + nl ; if ( ! nn ) mG = mH ; if ( ! nn ) mE = mF ; if ( nn ) nm = my . y ; float np = ( no * ( 1.0 / 12.0 ) ) - gk ; float nq = mG - gk ; float nr = mE - gk ; float ns = mG + gk ; float nt = mE + gk ; bool nu = abs ( nq ) >= abs ( nr ) ; float nv = max ( abs ( nq ) , abs ( nr ) ) ; if ( nu ) nm = - nm ; float nw = mu ( abs ( np ) * mW ) ; vec2 nx ; nx . x = mC . x ; nx . y = mC . y ; vec2 ny ; ny . x = ( ! nn ) ? 0.0 : my . x ; ny . y = ( nn ) ? 0.0 : my . y ; if ( ! nn ) nx . x += nm * 0.5 ; if ( nn ) nx . y += nm * 0.5 ; vec2 nz ; nz . x = nx . x - ny . x * FXAA_QUALITY_P0 ; nz . y = nx . y - ny . y * FXAA_QUALITY_P0 ; vec2 nA ; nA . x = nx . x + ny . x * FXAA_QUALITY_P0 ; nA . y = nx . y + ny . y * FXAA_QUALITY_P0 ; float nB = ( ( - 2.0 ) * nw ) + 3.0 ; float nC = gj ( mv ( ie , nz ) ) ; float nD = nw * nw ; float nE = gj ( mv ( ie , nA ) ) ; if ( ! nu ) ns = nt ; float nF = nv * 1.0 / 4.0 ; float nG = gk - ns * 0.5 ; float nH = nB * nD ; bool nI = nG < 0.0 ; nC -= ns * 0.5 ; nE -= ns * 0.5 ; bool nJ = abs ( nC ) >= nF ; bool nK = abs ( nE ) >= nF ; if ( ! nJ ) nz . x -= ny . x * FXAA_QUALITY_P1 ; if ( ! nJ ) nz . y -= ny . y * FXAA_QUALITY_P1 ; bool nL = ( ! nJ ) || ( ! nK ) ; if ( ! nK ) nA . x += ny . x * FXAA_QUALITY_P1 ; if ( ! nK ) nA . y += ny . y * FXAA_QUALITY_P1 ; if ( nL ) { if ( ! nJ ) nC = gj ( mv ( ie , nz . xy ) ) ; if ( ! nK ) nE = gj ( mv ( ie , nA . xy ) ) ; if ( ! nJ ) nC = nC - ns * 0.5 ; if ( ! nK ) nE = nE - ns * 0.5 ; nJ = abs ( nC ) >= nF ; nK = abs ( nE ) >= nF ; if ( ! nJ ) nz . x -= ny . x * FXAA_QUALITY_P2 ; if ( ! nJ ) nz . y -= ny . y * FXAA_QUALITY_P2 ; nL = ( ! nJ ) || ( ! nK ) ; if ( ! nK ) nA . x += ny . x * FXAA_QUALITY_P2 ; if ( ! nK ) nA . y += ny . y * FXAA_QUALITY_P2 ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",3,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"if ( nL ) { if ( ! nJ ) nC = gj ( mv ( ie , nz . xy ) ) ; if ( ! nK ) nE = gj ( mv ( ie , nA . xy ) ) ; if ( ! nJ ) nC = nC - ns * 0.5 ; if ( ! nK ) nE = nE - ns * 0.5 ; nJ = abs ( nC ) >= nF ; nK = abs ( nE ) >= nF ; if ( ! nJ ) nz . x -= ny . x * FXAA_QUALITY_P3 ; if ( ! nJ ) nz . y -= ny . y * FXAA_QUALITY_P3 ; nL = ( ! nJ ) || ( ! nK ) ; if ( ! nK ) nA . x += ny . x * FXAA_QUALITY_P3 ; if ( ! nK ) nA . y += ny . y * FXAA_QUALITY_P3 ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",4,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"if ( nL ) { if ( ! nJ ) nC = gj ( mv ( ie , nz . xy ) ) ; if ( ! nK ) nE = gj ( mv ( ie , nA . xy ) ) ; if ( ! nJ ) nC = nC - ns * 0.5 ; if ( ! nK ) nE = nE - ns * 0.5 ; nJ = abs ( nC ) >= nF ; nK = abs ( nE ) >= nF ; if ( ! nJ ) nz . x -= ny . x * FXAA_QUALITY_P4 ; if ( ! nJ ) nz . y -= ny . y * FXAA_QUALITY_P4 ; nL = ( ! nJ ) || ( ! nK ) ; if ( ! nK ) nA . x += ny . x * FXAA_QUALITY_P4 ; if ( ! nK ) nA . y += ny . y * FXAA_QUALITY_P4 ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",5,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"if ( nL ) { if ( ! nJ ) nC = gj ( mv ( ie , nz . xy ) ) ; if ( ! nK ) nE = gj ( mv ( ie , nA . xy ) ) ; if ( ! nJ ) nC = nC - ns * 0.5 ; if ( ! nK ) nE = nE - ns * 0.5 ; nJ = abs ( nC ) >= nF ; nK = abs ( nE ) >= nF ; if ( ! nJ ) nz . x -= ny . x * FXAA_QUALITY_P5 ; if ( ! nJ ) nz . y -= ny . y * FXAA_QUALITY_P5 ; nL = ( ! nJ ) || ( ! nK ) ; if ( ! nK ) nA . x += ny . x * FXAA_QUALITY_P5 ; if ( ! nK ) nA . y += ny . y * FXAA_QUALITY_P5 ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",6,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"if ( nL ) { if ( ! nJ ) nC = gj ( mv ( ie , nz . xy ) ) ; if ( ! nK ) nE = gj ( mv ( ie , nA . xy ) ) ; if ( ! nJ ) nC = nC - ns * 0.5 ; if ( ! nK ) nE = nE - ns * 0.5 ; nJ = abs ( nC ) >= nF ; nK = abs ( nE ) >= nF ; if ( ! nJ ) nz . x -= ny . x * FXAA_QUALITY_P6 ; if ( ! nJ ) nz . y -= ny . y * FXAA_QUALITY_P6 ; nL = ( ! nJ ) || ( ! nK ) ; if ( ! nK ) nA . x += ny . x * FXAA_QUALITY_P6 ; if ( ! nK ) nA . y += ny . y * FXAA_QUALITY_P6 ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",7,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"if ( nL ) { if ( ! nJ ) nC = gj ( mv ( ie , nz . xy ) ) ; if ( ! nK ) nE = gj ( mv ( ie , nA . xy ) ) ; if ( ! nJ ) nC = nC - ns * 0.5 ; if ( ! nK ) nE = nE - ns * 0.5 ; nJ = abs ( nC ) >= nF ; nK = abs ( nE ) >= nF ; if ( ! nJ ) nz . x -= ny . x * FXAA_QUALITY_P7 ; if ( ! nJ ) nz . y -= ny . y * FXAA_QUALITY_P7 ; nL = ( ! nJ ) || ( ! nK ) ; if ( ! nK ) nA . x += ny . x * FXAA_QUALITY_P7 ; if ( ! nK ) nA . y += ny . y * FXAA_QUALITY_P7 ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",8,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"if ( nL ) { if ( ! nJ ) nC = gj ( mv ( ie , nz . xy ) ) ; if ( ! nK ) nE = gj ( mv ( ie , nA . xy ) ) ; if ( ! nJ ) nC = nC - ns * 0.5 ; if ( ! nK ) nE = nE - ns * 0.5 ; nJ = abs ( nC ) >= nF ; nK = abs ( nE ) >= nF ; if ( ! nJ ) nz . x -= ny . x * FXAA_QUALITY_P8 ; if ( ! nJ ) nz . y -= ny . y * FXAA_QUALITY_P8 ; nL = ( ! nJ ) || ( ! nK ) ; if ( ! nK ) nA . x += ny . x * FXAA_QUALITY_P8 ; if ( ! nK ) nA . y += ny . y * FXAA_QUALITY_P8 ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",9,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"if ( nL ) { if ( ! nJ ) nC = gj ( mv ( ie , nz . xy ) ) ; if ( ! nK ) nE = gj ( mv ( ie , nA . xy ) ) ; if ( ! nJ ) nC = nC - ns * 0.5 ; if ( ! nK ) nE = nE - ns * 0.5 ; nJ = abs ( nC ) >= nF ; nK = abs ( nE ) >= nF ; if ( ! nJ ) nz . x -= ny . x * FXAA_QUALITY_P9 ; if ( ! nJ ) nz . y -= ny . y * FXAA_QUALITY_P9 ; nL = ( ! nJ ) || ( ! nK ) ; if ( ! nK ) nA . x += ny . x * FXAA_QUALITY_P9 ; if ( ! nK ) nA . y += ny . y * FXAA_QUALITY_P9 ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",10,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"if ( nL ) { if ( ! nJ ) nC = gj ( mv ( ie , nz . xy ) ) ; if ( ! nK ) nE = gj ( mv ( ie , nA . xy ) ) ; if ( ! nJ ) nC = nC - ns * 0.5 ; if ( ! nK ) nE = nE - ns * 0.5 ; nJ = abs ( nC ) >= nF ; nK = abs ( nE ) >= nF ; if ( ! nJ ) nz . x -= ny . x * FXAA_QUALITY_P10 ; if ( ! nJ ) nz . y -= ny . y * FXAA_QUALITY_P10 ; nL = ( ! nJ ) || ( ! nK ) ; if ( ! nK ) nA . x += ny . x * FXAA_QUALITY_P10 ; if ( ! nK ) nA . y += ny . y * FXAA_QUALITY_P10 ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",11,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"if ( nL ) { if ( ! nJ ) nC = gj ( mv ( ie , nz . xy ) ) ; if ( ! nK ) nE = gj ( mv ( ie , nA . xy ) ) ; if ( ! nJ ) nC = nC - ns * 0.5 ; if ( ! nK ) nE = nE - ns * 0.5 ; nJ = abs ( nC ) >= nF ; nK = abs ( nE ) >= nF ; if ( ! nJ ) nz . x -= ny . x * FXAA_QUALITY_P11 ; if ( ! nJ ) nz . y -= ny . y * FXAA_QUALITY_P11 ; nL = ( ! nJ ) || ( ! nK ) ; if ( ! nK ) nA . x += ny . x * FXAA_QUALITY_P11 ; if ( ! nK ) nA . y += ny . y * FXAA_QUALITY_P11 ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",12,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"if ( nL ) { if ( ! nJ ) nC = gj ( mv ( ie , nz . xy ) ) ; if ( ! nK ) nE = gj ( mv ( ie , nA . xy ) ) ; if ( ! nJ ) nC = nC - ns * 0.5 ; if ( ! nK ) nE = nE - ns * 0.5 ; nJ = abs ( nC ) >= nF ; nK = abs ( nE ) >= nF ; if ( ! nJ ) nz . x -= ny . x * FXAA_QUALITY_P12 ; if ( ! nJ ) nz . y -= ny . y * FXAA_QUALITY_P12 ; nL = ( ! nJ ) || ( ! nK ) ; if ( ! nK ) nA . x += ny . x * FXAA_QUALITY_P12 ; if ( ! nK ) nA . y += ny . y * FXAA_QUALITY_P12 ; }".split(" ")}]}}]},
{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:"} float nM = mC . x - nz . x ; float nN = nA . x - mC . x ; if ( ! nn ) nM = mC . y - nz . y ; if ( ! nn ) nN = nA . y - mC . y ; bool nO = ( nC < 0.0 ) != nI ; float nP = ( nN + nM ) ; bool nQ = ( nE < 0.0 ) != nI ; float nR = 1.0 / nP ; bool nS = nM < nN ; float nT = min ( nM , nN ) ; bool nU = nS ? nO : nQ ; float nV = nH * nH ; float nW = ( nT * ( - nR ) ) + 0.5 ; float nX = nV * mz ; float nY = nU ? nW : 0.0 ; float nZ = max ( nY , nX ) ; if ( ! nn ) mC . x += nZ * nm ; if ( nn ) mC . y += nZ * nm ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_DISCARD",1,{TYPE:"equal_expr",PLACES:2},"FXAA_BLEND4WEB",1,{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"return mv ( ie , mC ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"return vec4 ( mv ( ie , mC ) . xyz , gk ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]}]};e["include/halo_color.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"HALO_COLOR_GLSLF",
GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"HALO_COLOR_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"NUM_RINGS",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LINES",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_STARS",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_STARS",TOKENS:["0"]},{TYPE:"var",NAME:"WAVES_HEIGHT",TOKENS:["1.0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_RINGS","NUM_LINES",{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:"const int n_ = NUM_RINGS ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"const int n_ = NUM_LINES ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"float oa ( float x ) { return x - floor ( x * ( 1.0 / 0.01 ) ) * 0.01 ; }".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_RINGS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"void oh ( inout float ob , in float oc [ n_ ] , in float od ) { for ( int a = 0 ; a < NUM_RINGS ; a ++ ) { float oe = 40.0 * oc [ a ] ; float of = 300.0 * ( oa ( oe ) - 0.005 ) ; float og = oe ; float me = abs ( og * ( u_halo_size * of - od ) ) ; ob += 1.0 - min ( me , 1.0 ) ; } }".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LINES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"void om ( inout float oi , in float oc [ n_ ] , in float aM ) { for ( int a = 0 ; a < NUM_LINES ; a ++ ) { float oj = oc [ a ] ; float ok = oj ; float ol = 1000.0 * ( oa ( oj ) - 0.005 ) ; float me = 20.0 * abs ( ok * A . x + ol * A . y ) ; oi += 1.0 - min ( me , 1.0 ) ; } oi *= aM ; }".split(" ")}]}}]},{TYPE:"txt",TOKENS:"void oq ( inout float aM , in vec2 ce ) { float on , bP ; bP = atan ( ce . y , ce . x ) ; bP *= ( 1.0 + 0.25 * float ( NUM_STARS ) ) ; float oo = cos ( bP ) ; float op = sin ( bP ) ; bP = ( oo * ce . x + op * ce . y ) * ( oo * ce . y - op * ce . x ) ; on = abs ( bP ) ; if ( on < 1.0 ) { on = ( 0.01 * u_halo_size ) / ( on ) ; aM *= sqrt ( min ( on , 1.0 ) ) ; } } vec4 bl ( ) { float aM = ( A . x * A . x + A . y * A . y ) ; float od = sqrt ( aM ) ; aM = max ( 1.0 - aM , 0.0 ) ; aM = pow ( aM , u_halo_hardness ) ; float L = u_diffuse_color . a ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_RINGS","NUM_LINES",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float oc [ n_ ] ; for ( int cq = 0 ; cq < n_ ; cq ++ ) { oc [ cq ] = fract ( bk / float ( cq + 1 ) ) - 1.0 ; }".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_RINGS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float ob = 0.0 ; oh ( ob , oc , od ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LINES"],GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:"float oi = 0.0 ; om ( oi , oc , aM ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_STARS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"oq ( aM , A ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"aM *= L ; vec3 aQ = u_diffuse_color . rgb ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_RINGS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"ob *= aM ; aQ += u_halo_rings_color * ob ; aM += ob ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LINES"],
GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"oi *= L ; aQ += u_halo_lines_color * oi ; aM += oi ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKY_STARS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"aM *= max ( 1.0 - 2.0 * u_sun_intensity . x , 0.0 ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float lc = u_halo_stars_blend * ( bj . y - u_halo_stars_height ) ; aM *= clamp ( lc , 0.0 , 1.0 ) ; aM *= min ( u_cam_water_depth + 2.0 * WAVES_HEIGHT , 1.0 ) ;".split(" ")}]}}]}]}}]},
{TYPE:"txt",TOKENS:"vec4 or = vec4 ( aQ , aM ) ; return or ; }".split(" ")}]}}]}]};e["include/lighting_nodes.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"LIGHTING_NODES_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"LIGHTING_NODES_GLSLF",TOKENS:[""]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"node",NAME:"LIGHTING_BEGIN",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"oF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",
NAME:"oH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oI",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"oJ",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"oK",QUALIFIER:["vec2"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"oL",QUALIFIER:["vec2"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"oM",QUALIFIER:["vec4"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"oN",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"oO",QUALIFIER:["vec4"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",
TOKENS:"oF = os ; oG = ot ; oH = ou ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_oI"],STATEMENTS:[{TYPE:"txt",TOKENS:["oI","=","ov",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_oJ"],STATEMENTS:[{TYPE:"txt",TOKENS:["oJ","=","ox",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_oL"],STATEMENTS:[{TYPE:"txt",TOKENS:["oL","=","oz",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_oK"],STATEMENTS:[{TYPE:"txt",
TOKENS:["oK","=","oA",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_oM"],STATEMENTS:[{TYPE:"txt",TOKENS:["oM","=","oB",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_oN"],STATEMENTS:[{TYPE:"txt",TOKENS:["oN","=","oC",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_oO"],STATEMENTS:[{TYPE:"txt",TOKENS:["oO","=","oD",";"]}]}]}]},{TYPE:"node",NAME:"LIGHTING_AMBIENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"oP",QUALIFIER:["vec3"],
IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"oQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"oR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oS",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oT",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"oS = vec4 ( oP + oR * oQ , _0_0 ) ; oT = vec3 ( _0_0 ) ;".split(" ")}]},{TYPE:"node",NAME:"LIGHTING_LAMP",NODE_VARS:[{TYPE:"node_var",NAME:"LAMP_TYPE",TOKENS:["HEMI"]},{TYPE:"node_var",NAME:"LAMP_IND",TOKENS:["0"]},
{TYPE:"node_var",NAME:"LAMP_SPOT_SIZE",TOKENS:["0.8"]},{TYPE:"node_var",NAME:"LAMP_SPOT_BLEND",TOKENS:["0.03"]},{TYPE:"node_var",NAME:"LAMP_LIGHT_DIST",TOKENS:["30.0"]},{TYPE:"node_var",NAME:"LAMP_SHADOW_MAP_IND",TOKENS:["-","1"]},{TYPE:"node_var",NAME:"LAMP_USE_SPHERE",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"oU",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oW",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",
NAME:"oX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oY",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"oW = vec2 ( u_light_positions [ LAMP_IND ] . w , u_light_color_intensities [ LAMP_IND ] . w ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","HEMI",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["oY","=","_0_5",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["oY","=","_0_0",";"]}]}]},{TYPE:"txt",TOKENS:"oX = u_light_color_intensities [ LAMP_IND ] . xyz ;".split(" ")},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_SHADOW_MAP_IND",1,{TYPE:"negative_expr",PLACES:1},{TYPE:"non_equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"oX *= oU [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2},"LAMP_TYPE","POINT",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"vec3 oZ = u_light_positions [ LAMP_IND ] . xyz ; oV = oZ - ow ; float aM = length ( oV ) ; float o_ = LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + aM * aM ) ; oV = normalize ( oV ) ;".split(" ")},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"vec3 pa = u_light_directions [ LAMP_IND ] ; float pb = dot ( oV , pa ) ; pb *= smoothstep ( _0_0 , _1_0 , ( pb - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; o_ *= pb ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_USE_SPHERE"],STATEMENTS:[{TYPE:"txt",TOKENS:"o_ *= max ( LAMP_LIGHT_DIST - aM , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]},{TYPE:"txt",
TOKENS:["oX","*=","o_",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"oV = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{TYPE:"node",NAME:"DIFFUSE_FRESNEL",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pd",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pe",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pf",QUALIFIER:["float"],IS_OPTIONAL:!1},
{TYPE:"node_in",NAME:"pg",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ph",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:"vec3 pi = cross ( pc , B . xyz ) ; pe = cross ( pi , B . xyz ) ; pe = - normalize ( pe ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"ph = _0_0 ; if ( pd . r != _0_0 ) { float pj = ( _1_0 - pf ) * dot ( pe , pc ) + pf ; if ( pg [ 0 ] == _0_0 ) { ph = _1_0 ; } else { float t = _1_0 + abs ( pj ) ; t = pg [ 1 ] + ( _1_0 - pg [ 1 ] ) * pow ( t , pg [ 0 ] ) ; ph = clamp ( t , _0_0 , _1_0 ) ; } ph = max ( ph , _0_0 ) ; }".split(" ")}]},
{TYPE:"node",NAME:"DIFFUSE_LAMBERT",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pk",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pl",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pm",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"po",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],
STATEMENTS:[{TYPE:"txt",TOKENS:"vec3 pi = cross ( pk , B . xyz ) ; pm = cross ( pi , B . xyz ) ; pm = - normalize ( pm ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"po = _0_0 ; if ( pl . r != _0_0 ) { float pj = ( _1_0 - pn ) * dot ( pm , pk ) + pn ; po = max ( pj , _0_0 ) ; }".split(" ")}]},{TYPE:"node",NAME:"DIFFUSE_OREN_NAYAR",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pr",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pu",QUALIFIER:["vec2"],
IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pv",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"px",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"py",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:"vec3 pi = cross ( pr , B . xyz ) ; pv = cross ( pi , B . xyz ) ; pv = - normalize ( pv ) ;".split(" ")}]}]},{TYPE:"txt",
TOKENS:"py = _0_0 ; if ( pu . r != _0_0 ) { float pj = ( _1_0 - pw ) * dot ( pv , pr ) + pw ; if ( px [ 0 ] > _0_0 ) { float pz = max ( dot ( pv , oy ) , _0_0 ) ; float pA = px [ 0 ] * px [ 0 ] ; float cG = _1_0 - _0_5 * ( pA / ( pA + 0.33 ) ) ; vec3 pB = pr - pj * pv ; vec3 pC = oy - pz * pv ; if ( length ( pB ) == _0_0 || length ( pC ) == _0_0 || abs ( pj ) > _1_0 || abs ( pz ) > _1_0 ) py = pj * cG ; else { float pD = acos ( pj ) ; float pE = acos ( pz ) ; vec3 pF = normalize ( pB ) ; vec3 pG = normalize ( pC ) ; float a , b ; a = max ( pD , pE ) ; b = min ( pD , pE ) ; b *= 0.95 ; float t = max ( dot ( pF , pG ) , _0_0 ) ; float hS = 0.45 * ( pA / ( pA + 0.09 ) ) ; py = pj * ( cG + ( hS * t * sin ( a ) * tan ( b ) ) ) ; } } else py = pj ; py = max ( py , _0_0 ) ; }".split(" ")}]},
{TYPE:"node",NAME:"DIFFUSE_MINNAERT",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pI",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pL",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pM",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",
PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:"vec3 pi = cross ( pH , B . xyz ) ; pJ = cross ( pi , B . xyz ) ; pJ = - normalize ( pJ ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"pM = _0_0 ; if ( pI . r != _0_0 ) { float pj = ( _1_0 - pK ) * dot ( pJ , pH ) + pK ; float pz = max ( dot ( pJ , oy ) , _0_0 ) ; if ( pL [ 0 ] <= _1_0 ) pM = pj * pow ( max ( pz * pj , 0.1 ) , pL [ 0 ] - _1_0 ) ; else pM = pj * pow ( 1.0001 - pz , pL [ 0 ] - _1_0 ) ; pM = max ( pM , _0_0 ) ; }".split(" ")}]},
{TYPE:"node",NAME:"DIFFUSE_TOON",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pO",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pP",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pQ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pR",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pS",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",
PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:"vec3 pi = cross ( pN , B . xyz ) ; pP = cross ( pi , B . xyz ) ; pP = - normalize ( pP ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"pS = _0_0 ; if ( pO . r != _0_0 ) { float pj = ( _1_0 - pQ ) * dot ( pP , pN ) + pQ ; float pT = acos ( pj ) ; if ( pT < pR [ 0 ] ) pS = _1_0 ; else if ( pT > ( pR [ 0 ] + pR [ 1 ] ) || pR [ 1 ] == _0_0 ) pS = _0_0 ; else pS = _1_0 - ( ( pT - pR [ 0 ] ) / pR [ 1 ] ) ; pS = max ( pS , _0_0 ) ; }".split(" ")}]},
{TYPE:"node",NAME:"SPECULAR_PHONG",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pV",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pW",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pY",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pZ",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",
TOKENS:"pZ = _0_0 ; if ( pV . g != _0_0 ) { vec3 p_ = normalize ( pU + oy ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:"if ( pX == _0_0 ) { pZ = dot ( B . xyz , p_ ) ; pZ = sqrt ( _1_0 - pZ * pZ ) ; }".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"pZ = ( _1_0 - pX ) * max ( dot ( pW , p_ ) , _0_0 ) + pX ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"pZ = pow ( pZ , pY [ 0 ] ) ; }".split(" ")}]},{TYPE:"node",NAME:"SPECULAR_COOKTORR",
NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qa",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qb",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qd",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qe",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qf",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"qf = _0_0 ; if ( qb . g != _0_0 ) { vec3 p_ = normalize ( qa + oy ) ;".split(" ")},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:"if ( qd == _0_0 ) { qf = dot ( B . xyz , p_ ) ; qf = sqrt ( _1_0 - qf * qf ) ; }".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"qf = max ( dot ( qc , p_ ) , _0_0 ) ; qf = ( _1_0 - qd ) * qf + qd ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:"float pz = max ( dot ( B . xyz , oy ) , _0_0 ) ; pz = sqrt ( _1_0 - pz * pz ) ;".split(" ")}]},
{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"float pz = max ( dot ( qc , oy ) , _0_0 ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"qf = pow ( qf , qe [ 0 ] ) ; qf = qf / ( 0.1 + pz ) ; }".split(" ")}]},{TYPE:"node",NAME:"SPECULAR_WARDISO",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qh",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qi",QUALIFIER:["vec3"],IS_OPTIONAL:!1},
{TYPE:"node_in",NAME:"qj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qk",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ql",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"ql = _0_0 ; if ( qh . g != _0_0 ) { vec3 p_ = normalize ( qg + oy ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:"float qm = _0_0 ; float pz = _0_0 ; float qn = _0_0 ; if ( qj == _0_0 ) { qm = dot ( B . xyz , p_ ) ; pz = dot ( B . xyz , oy ) ; qn = dot ( B . xyz , qg ) ; qm = sqrt ( _1_0 - qm * qm ) ; pz = sqrt ( _1_0 - pz * pz ) ; qn = sqrt ( _1_0 - qn * qn ) ; }".split(" ")}]},
{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"float qm = max ( dot ( qi , p_ ) , 0.01 ) ; float pz = max ( dot ( qi , oy ) , 0.01 ) ; float qn = max ( dot ( qi , qg ) , 0.01 ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"float bP = tan ( acos ( qm ) ) ; float L = max ( qk [ 0 ] , 0.01 ) ; ql = qn * ( _1_0 / ( 4.0 * M_PI * L * L ) ) * ( exp ( - ( bP * bP ) / ( L * L ) ) / ( sqrt ( pz * qn ) ) ) ; }".split(" ")}]},{TYPE:"node",NAME:"SPECULAR_TOON",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",
TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qo",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qr",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qu",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qw",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qx",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"qx = _0_0 ; if ( qr . g != _0_0 ) { vec3 co = normalize ( qo + oy ) ;".split(" ")},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:"float qy = dot ( co , B . xyz ) ; float bP = qw [ 0 ] + qw [ 1 ] ; if ( qv == _0_0 ) bP = acos ( sqrt ( _1_0 - qy * qy ) ) ;".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"float bP = acos ( dot ( co , qu ) ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"if ( bP < qw [ 0 ] ) qx = _1_0 ; else if ( bP >= qw [ 0 ] + qw [ 1 ] || qw [ 1 ] == _0_0 ) qx = _0_0 ; else qx = _1_0 - ( bP - qw [ 0 ] ) / qw [ 1 ] ; }".split(" ")}]},
{TYPE:"node",NAME:"SPECULAR_BLINN",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qz",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qA",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qC",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qD",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qE",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",
TOKENS:"float qF = qD [ 0 ] ; float qG = qD [ 1 ] ; qE = _0_0 ; if ( qA . g != _0_0 ) { if ( qF < 1.0 || qG == _0_0 ) qE = _0_0 ; else { if ( qG < 100.0 ) qG = sqrt ( 1.0 / qG ) ; else qG = 10.0 / qG ; vec3 p_ = normalize ( oy + qz ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:"float qm = 0.0 ; if ( qC == _0_0 ) { float qH = dot ( B . xyz , p_ ) ; qm = sqrt ( _1_0 - qH * qH ) ; }".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",
TOKENS:"float qm = ( _1_0 - qC ) * max ( dot ( qB , p_ ) , _0_0 ) + qC ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"if ( qm < _0_0 ) qE = _0_0 ; else { float pz = max ( dot ( qB , oy ) , 0.01 ) ; float qn = dot ( qB , qz ) ; if ( qn <= 0.01 ) qE = _0_0 ; else { float qI = max ( dot ( oy , p_ ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * qm * pz ) / qI ; float dx = ( 2.0 * qm * qn ) / qI ; float g = min ( min ( a , b ) , dx ) ; float p = sqrt ( pow ( qF , 2.0 ) + pow ( qI , 2.0 ) - _1_0 ) ; float mm = pow ( p - qI , 2.0 ) / pow ( p + qI , 2.0 ) * ( _1_0 + pow ( qI * ( p + qI ) - _1_0 , 2.0 ) / pow ( qI * ( p - qI ) + _1_0 , 2.0 ) ) ; float pT = acos ( qm ) ; qE = max ( mm * g * exp ( - pow ( pT , 2.0 ) / ( 2.0 * pow ( qG , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},
{TYPE:"node",NAME:"LIGHTING_APPLY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"qJ",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qP",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",
NAME:"qQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qS",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qT",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qU",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qV",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"qV = qK + qS * qR * qM ; qU = qJ + vec4 ( qS * qQ * qL , qM ) ;".split(" ")}]},{TYPE:"node",NAME:"LIGHTING_END",NODE_VARS:[],
DECLARATIONS:[{TYPE:"node_in",NAME:"qW",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qX",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"E = qW . rgb ; oE = qX ;".split(" ")}]},{TYPE:"nodes_global"},{TYPE:"txt",TOKENS:"void cP ( vec3 os , vec3 ot , vec3 ou , vec3 ov , vec3 ow , vec3 ox , vec3 oy , vec2 oz , vec2 oA , vec4 oB , float oC , vec4 oD , out vec3 E , out vec3 oE ) {".split(" ")},{TYPE:"nodes_main"},{TYPE:"txt",TOKENS:["}"]}]}}]}]};e["include/math.glslv"]=
{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"MATH_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"MATH_GLSLV",TOKENS:[""]},{TYPE:"var",NAME:"EPSILON",TOKENS:["0.000001"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"REFRACTIVE",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},{TYPE:"var",NAME:"USE_POSITION_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"SOFT_PARTICLES",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:"struct au { vec3 O ; vec3 ao ; vec3 V ; vec3 aB ; vec3 W ; vec3 U ; vec3 aQ ; } ; bool qY ( vec3 a , vec3 b ) { return any ( lessThan ( abs ( a - b ) , vec3 ( EPSILON ) ) ) ; } vec3 T ( in vec4 q , in vec3 kU ) { return kU + 2.0 * cross ( q . xyz , cross ( q . xyz , kU ) + q . w * kU ) ; } vec4 kV ( in vec4 qZ ) { return vec4 ( - qZ . xyz , qZ . w ) ; } vec4 rc ( in vec4 a , in vec4 b ) { vec4 q_ ; q_ . x = a . x * b . w + a . w * b . x + a . y * b . z - a . z * b . y ; q_ . y = a . y * b . w + a . w * b . y + a . z * b . x - a . x * b . z ; q_ . z = a . z * b . w + a . w * b . z + a . x * b . y - a . y * b . x ; q_ . w = a . w * b . w - a . x * b . x - a . y * b . y - a . z * b . z ; return q_ ; } vec4 X ( in vec3 rd , in float re ) { vec4 q_ ; re = re * 0.5 ; float s = sin ( re ) ; q_ . x = s * rd [ 0 ] ; q_ . y = s * rd [ 1 ] ; q_ . z = s * rd [ 2 ] ; q_ . w = cos ( re ) ; return q_ ; } vec4 ri ( in vec3 bH , in vec3 rf ) { vec4 q_ ; float dC = dot ( rf , bH ) ; vec3 rh = cross ( rf , bH ) ; q_ . xyz = rh . xyz ; q_ . w = 1.0 + dC ; return normalize ( q_ ) ; } vec3 rl ( vec3 rj , vec3 hK , vec4 qZ , vec3 rk ) { vec3 q_ = rk * hK ; q_ = T ( qZ , q_ ) ; q_ += rj ; return q_ ; } vec3 rm ( vec3 rj , vec3 hK , vec4 qZ , vec3 bH ) { vec3 q_ = bH * hK ; q_ = T ( qZ , q_ ) ; return q_ ; } vec3 rn ( vec3 rj , vec3 hK , vec4 qZ , vec3 rk ) { vec3 q_ = rk - rj ; q_ = T ( kV ( qZ ) , q_ ) ; q_ /= hK ; return q_ ; } vec3 ro ( vec3 rj , vec3 hK , vec4 qZ , vec3 bH ) { return T ( kV ( qZ ) , bH ) / hK ; } mat4 rp ( ) { return mat4 ( _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 rq ( float bP ) { return mat4 ( _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , cos ( bP ) , sin ( bP ) , _0_0 , _0_0 , - sin ( bP ) , cos ( bP ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 rs ( float bP ) { return mat4 ( cos ( bP ) , _0_0 , - sin ( bP ) , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , sin ( bP ) , _0_0 , cos ( bP ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 rt ( float bP ) { return mat4 ( cos ( bP ) , sin ( bP ) , _0_0 , _0_0 , - sin ( bP ) , cos ( bP ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } au ma ( in au kU ) { return au ( kU . O , kU . ao , normalize ( kU . V ) , normalize ( kU . aB ) , normalize ( kU . W ) , normalize ( kU . U ) , kU . aQ ) ; }".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE","USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:5}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 aC ( vec4 f ) { float fX = f . x ; float fY = f . y ; float fZ = f . w ; vec3 ru ; ru . x = ( fX + fZ ) / 2.0 ; ru . y = ( fY + fZ ) / 2.0 ; ru . z = fZ ; return ru ; }".split(" ")}]}}]},{TYPE:"txt",
TOKENS:"mat3 aY ( ) { return mat3 ( _0_0 , _0_0 , _0_0 , _1_0 , _1_0 , _1_0 , _0_0 , _0_0 , _0_0 ) ; } mat4 bh ( mat3 t ) { mat4 rv ; float rw = sqrt ( abs ( 1. - t [ 2 ] [ 0 ] * t [ 2 ] [ 0 ] - t [ 2 ] [ 1 ] * t [ 2 ] [ 1 ] - t [ 2 ] [ 2 ] * t [ 2 ] [ 2 ] ) ) ; rv [ 0 ] [ 0 ] = ( _1_0 - ( t [ 2 ] [ 1 ] * ( t [ 2 ] [ 1 ] + t [ 2 ] [ 1 ] ) + t [ 2 ] [ 2 ] * ( t [ 2 ] [ 2 ] + t [ 2 ] [ 2 ] ) ) ) * t [ 1 ] [ 0 ] ; rv [ 0 ] [ 1 ] = ( t [ 2 ] [ 0 ] * ( t [ 2 ] [ 1 ] + t [ 2 ] [ 1 ] ) + rw * ( t [ 2 ] [ 2 ] + t [ 2 ] [ 2 ] ) ) * t [ 1 ] [ 0 ] ; rv [ 0 ] [ 2 ] = ( t [ 2 ] [ 0 ] * ( t [ 2 ] [ 2 ] + t [ 2 ] [ 2 ] ) - rw * ( t [ 2 ] [ 1 ] + t [ 2 ] [ 1 ] ) ) * t [ 1 ] [ 0 ] ; rv [ 0 ] [ 3 ] = _0_0 ; rv [ 1 ] [ 0 ] = ( t [ 2 ] [ 0 ] * ( t [ 2 ] [ 1 ] + t [ 2 ] [ 1 ] ) - rw * ( t [ 2 ] [ 2 ] + t [ 2 ] [ 2 ] ) ) * t [ 1 ] [ 0 ] ; rv [ 1 ] [ 1 ] = ( _1_0 - ( t [ 2 ] [ 0 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) + t [ 2 ] [ 2 ] * ( t [ 2 ] [ 2 ] + t [ 2 ] [ 2 ] ) ) ) * t [ 1 ] [ 0 ] ; rv [ 1 ] [ 2 ] = ( t [ 2 ] [ 1 ] * ( t [ 2 ] [ 2 ] + t [ 2 ] [ 2 ] ) + rw * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) * t [ 1 ] [ 0 ] ; rv [ 1 ] [ 3 ] = _0_0 ; rv [ 2 ] [ 0 ] = ( t [ 2 ] [ 0 ] * ( t [ 2 ] [ 2 ] + t [ 2 ] [ 2 ] ) + rw * ( t [ 2 ] [ 1 ] + t [ 2 ] [ 1 ] ) ) * t [ 1 ] [ 0 ] ; rv [ 2 ] [ 1 ] = ( t [ 2 ] [ 1 ] * ( t [ 2 ] [ 2 ] + t [ 2 ] [ 2 ] ) - rw * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) * t [ 1 ] [ 0 ] ; rv [ 2 ] [ 2 ] = ( _1_0 - ( t [ 2 ] [ 0 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) + t [ 2 ] [ 1 ] * ( t [ 2 ] [ 1 ] + t [ 2 ] [ 1 ] ) ) ) * t [ 1 ] [ 0 ] ; rv [ 2 ] [ 3 ] = _0_0 ; rv [ 3 ] [ 0 ] = t [ 0 ] [ 0 ] ; rv [ 3 ] [ 1 ] = t [ 0 ] [ 1 ] ; rv [ 3 ] [ 2 ] = t [ 0 ] [ 2 ] ; rv [ 3 ] [ 3 ] = 1.0 ; return rv ; } mat3 bc ( in vec4 qZ , in mat3 rx ) { if ( qZ . w < 0. ) qZ . xyz *= - 1. ; rx [ 2 ] = qZ . xyz ; return rx ; } vec4 ry ( in mat3 rx ) { return vec4 ( rx [ 2 ] , sqrt ( abs ( 1. - rx [ 2 ] [ 0 ] * rx [ 2 ] [ 0 ] - rx [ 2 ] [ 1 ] * rx [ 2 ] [ 1 ] - rx [ 2 ] [ 2 ] * rx [ 2 ] [ 2 ] ) ) ) ; } vec3 ap ( mat3 rx , vec3 rk ) { vec3 q_ = rk * rx [ 1 ] ; vec4 qZ = ry ( rx ) ; q_ = T ( qZ , q_ ) ; q_ += rx [ 0 ] ; return q_ ; } vec3 _ ( mat3 rx , vec3 bH ) { vec3 q_ = bH * rx [ 1 ] ; vec4 qZ = ry ( rx ) ; q_ = T ( qZ , q_ ) ; return q_ ; } vec3 bI ( mat3 rx , vec3 rz ) { vec3 q_ = rz / rx [ 1 ] ; vec4 qZ = ry ( rx ) ; q_ = T ( qZ , q_ ) ; return q_ ; } mat3 aZ ( in vec3 rj , in mat3 rx ) { rx [ 0 ] = rj ; return rx ; } vec3 ex ( in mat3 rx ) { return rx [ 0 ] ; } mat3 a_ ( in vec3 hK , in mat3 rx ) { rx [ 1 ] = hK ; return rx ; } vec3 rA ( in mat3 rx ) { return rx [ 1 ] ; } mat3 bd ( in mat3 rx , in mat3 rB ) { mat3 rC ; vec3 rj = ex ( rx ) ; vec3 rD = ex ( rB ) ; vec3 hK = rA ( rx ) ; vec3 rE = rA ( rB ) ; vec4 qZ = ry ( rx ) ; vec4 rF = ry ( rB ) ; vec3 rG = rl ( rj , hK , qZ , rD ) ; rC = aZ ( rG , rC ) ; vec3 rH = hK * rE ; rC = a_ ( rH , rC ) ; vec4 rI = rc ( qZ , rF ) ; rC = bc ( rI , rC ) ; return rC ; } mat3 bd ( in mat3 rx , in mat3 rB , out mat3 q_ ) { q_ = bd ( rx , rB ) ; return q_ ; } vec4 R ( in vec4 rJ ) { return normalize ( rJ ) ; } vec4 R ( in vec4 rJ , out float P , out float Q ) { vec4 qZ = R ( rJ ) ; P = length ( rJ ) * M_PI ; Q = sign ( rJ [ 3 ] ) ; return R ( rJ ) ; }".split(" ")}]}}]}]};
e["include/mirror.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"MIRROR_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"MIRROR_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"REFLECTION_PASS",TOKENS:["REFL_PASS_NONE"]},{TYPE:"var",NAME:"USE_BSDF_SKY_DIM",TOKENS:[""]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFLECTION_TYPE","REFL_CUBE",
{TYPE:"equal_expr",PLACES:2},"REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"define",NAME:"REFL_BUMP",TOKENS:["0.1"]},{TYPE:"txt",TOKENS:"float rK ( in vec3 D , vec3 eN , float ec , float fk ) { vec3 fi = normalize ( eN + D ) ; float fj = 1.0 - dot ( D , fi ) ; float r = fk + ( 1.0 - fk ) * pow ( fj , ec ) ; return r ; } void cQ ( inout vec3 rL , vec3 D , vec3 U , float rM , mat3 N ) { vec3 eN = reflect ( - D , U ) ; float ec = u_fresnel_params [ 0 ] ; float fk = u_fresnel_params [ 1 ] ; float r = 1.0 ; if ( ec != 0.0 ) r = rK ( D , eN , ec , fk ) ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_CUBE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 eS = GLSL_TEXTURE_CUBE ( u_cube_reflection , eN ) . xyz ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_NONE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 rN = u_refl_plane . xyz * dot ( U , u_refl_plane . xyz ) ; vec3 rO = U - rN ; vec2 rP = bI ( N , rO ) . xy ; vec2 rQ = l . xy / l . z ; rQ += rP * REFL_BUMP ; vec3 eS = GLSL_TEXTURE ( u_plane_reflection , rQ ) . rgb ;".split(" ")}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 eS = vec3 ( 1.0 ) ; rM = 0.0 ;".split(" ")}]}}]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 eS = GLSL_TEXTURE_CUBE ( u_mirrormap , eN ) . xyz ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"bG ( eS . rgb ) ; rL = mix ( rL , eS , rM * r ) ; }".split(" ")}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_PBR_STANDARD",{TYPE:"equal_expr",PLACES:2}],
GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 rU ( float eg , vec3 rR , float ef ) { float rS = 1.0 - eg ; float rT = rS * rS ; rT = rT * rS * rT ; return rR + ( max ( vec3 ( 1.0 - ef ) , rR ) - rR ) * rT ; } vec3 sf ( vec3 rL , vec3 rV , vec3 D , vec3 U , float rW , float rX , mat3 N ) { float rY = max ( dot ( normalize ( U ) , D ) , _0_0 ) ; vec3 eN = reflect ( - D , U ) ; float ef = sqrt ( rX ) ; vec3 rR = vec3 ( 0.04 ) ; rR = mix ( rR , rV , rW ) ; vec3 rZ = rU ( rY , rR , ef ) ; vec3 r_ = rZ ; vec3 sa = vec3 ( _1_0 ) - r_ ; sa *= vec3 ( 1.0 - rW ) ; vec3 bx = GLSL_TEXTURE_CUBE ( u_cube_irradiance , U ) . xyz ; vec3 sb = bx * rL ; const float sc = 5.0 ; vec3 el = GLSL_TEXTURE_CUBE_LOD ( u_cube_r_convolution , eN , ef * sc ) . rgb ; vec2 sd = GLSL_TEXTURE ( u_brdf , vec2 ( rY , ef ) ) . rg ; vec3 cO = el * ( rZ * sd . x + sd . y ) ; vec3 se = ( sa * sb + cO ) ; return se ; }".split(" ")}]}},
{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_PBR_SIMPLE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 rU ( float eg , vec3 rR , float ef ) { float rS = 1.0 - eg ; float rT = rS * rS ; rT = rT * rS * rT ; return rR + ( max ( vec3 ( 1.0 - ef ) , rR ) - rR ) * rT ; } vec3 sf ( vec3 rL , vec3 rV , vec3 D , vec3 U , float rW , float rX , mat3 N ) {".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_BSDF_SKY_DIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 ec = normalize ( U ) ; float rY = max ( dot ( ec , D ) , _0_0 ) ; vec3 eN = reflect ( - D , U ) ; float sg = max ( 2.0 / ( rX * rX ) - 2.0 , _0_0 ) ; vec3 rR = vec3 ( 0.04 ) ; rR = mix ( rR , rV , rW ) ; vec3 rZ = rU ( rY , rR , sqrt ( rX ) ) ; vec3 r_ = rZ ; vec3 sa = vec3 ( _1_0 ) - r_ ; sa *= 1.0 - rW ; vec3 sb = GLSL_TEXTURE_CUBE_LOD ( u_sky_reflection , ec , 100.0 ) . xyz ; bG ( sb ) ; sb *= rL ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","sh","=","u_bsdf_cube_sky_dim",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float sh = float ( textureSize ( u_sky_reflection , 0 ) . x ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"float si = log2 ( ( sh * sqrt ( 3.0 ) ) / sqrt ( sg + _1_0 ) ) ; vec3 cO = GLSL_TEXTURE_CUBE_LOD ( u_sky_reflection , eN , si ) . xyz ; bG ( cO ) ; vec3 se = sa * sb + r_ * cO ; return se ;".split(" ")}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","rL",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]}]}}]}]};e["include/nodes.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"NODES_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"NODES_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"CAUSTICS",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"DOUBLE_SIDED_LIGHTING",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_PASS",TOKENS:["REFL_PASS_NONE"]},{TYPE:"var",
NAME:"USE_REFRACTION",TOKENS:["0"]},{TYPE:"var",NAME:"HAS_REFRACT_TEXTURE",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"USE_DERIVATIVES_EXT",TOKENS:["0"]},{TYPE:"var",NAME:"CAMERA_TYPE",TOKENS:["CAM_TYPE_PERSP"]},{TYPE:"var",NAME:"IS_WORLD",TOKENS:["0"]},{TYPE:"var",NAME:"USE_BSDF_PRINCIPLED_REFRACT",TOKENS:["0"]},{TYPE:"var",NAME:"USE_BSDF_TRANSPARENT_REFRACT",TOKENS:["0"]},{TYPE:"var",NAME:"USE_BSDF_TRANSPARENT_ALPHA",
TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_BSDF_BEGIN",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"mirror.glslf"},{TYPE:"include",FILE:"shadow.glslf"},{TYPE:"include",FILE:"environment.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"refraction.glslf"}]}}]},{TYPE:"include",FILE:"color_util.glslf"},
{TYPE:"include",FILE:"math.glslv"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","sj",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 sm ( in vec3 sk , in float sl ) { vec3 fa = vec3 ( _0_0 ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_REFRACTION"],GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:"fa = cS ( l , sk . xy * sl ) ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["HAS_REFRACT_TEXTURE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"fa = GLSL_TEXTURE ( u_refractmap , l . xy / l . z ) . rgb ; bG ( fa ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["return","fa",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{TYPE:"logical_or_expr",
PLACES:6}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 kj ( vec3 rgb ) { vec4 hM = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , hM . wz ) , vec4 ( rgb . gb , hM . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float dC = q . x - min ( q . w , q . y ) ; float iF = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * dC + iF ) ) , dC / ( q . x + iF ) , q . x ) ; }".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{TYPE:"logical_or_expr",PLACES:6}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 kl ( vec3 kk ) { vec4 hM = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( kk . r , kk . r , kk . r ) + hM . xyz ) * 6.0 - hM . www ) ; return kk . b * mix ( hM . xxx , clamp ( p - hM . xxx , _0_0 , _1_0 ) , kk . g ) ; }".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED","USE_NODE_TEX_COORD_UV","USE_NODE_UVMAP",{TYPE:"logical_or_expr",PLACES:5}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 sn ( vec2 gX ) { return vec3 ( gX * 2.0 - vec2 ( _1_0 , _1_0 ) , _0_0 ) ; }".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:"vec2 so ( vec3 rk ) { return vec2 ( rk . xy * _0_5 + vec2 ( _0_5 , _0_5 ) ) ; }".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float sv ( vec3 sr , vec3 rz , float su ) { float dx = abs ( dot ( sr , rz ) ) ; float g = su * su - _1_0 + dx * dx ; float ea ; if ( g > _0_0 ) { g = sqrt ( g ) ; float cG = ( g - dx ) / ( g + dx ) ; float hS = ( dx * ( g + dx ) - _1_0 ) / ( dx * ( g - dx ) + _1_0 ) ; ea = _0_5 * cG * cG * ( _1_0 + hS * hS ) ; } else { ea = _1_0 ; } return ea ; }".split(" ")}]}}]},
{TYPE:"node",NAME:"CAMERA",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"sU",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"sV",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"sW",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_sU"],STATEMENTS:[{TYPE:"txt",TOKENS:"sU = normalize ( sR . xyz ) ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_sV"],STATEMENTS:[{TYPE:"txt",TOKENS:"sV = abs ( sR . z ) ;".split(" ")}]}]},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_sW"],STATEMENTS:[{TYPE:"txt",TOKENS:"sW = length ( sR . xyz ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"COMBRGB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"sX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"sY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"sZ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"s_",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"s_ = vec3 ( sX , sY , sZ ) ;".split(" ")}]},
{TYPE:"node",NAME:"COMBHSV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"ta",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tc",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"td",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"td = kl ( vec3 ( ta , tb , tc ) ) ;".split(" ")}]},{TYPE:"node",NAME:"EMPTY_UV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"te",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],
STATEMENTS:[{TYPE:"txt",TOKENS:"te = vec3 ( - _1_0 , - _1_0 , _0_0 ) ;".split(" ")}]},{TYPE:"node",NAME:"EMPTY_VC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tf",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"tf = vec3 ( _0_0 ) ;".split(" ")}]},{TYPE:"node",NAME:"GEOMETRY_UV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sw",QUALIFIER:["GLSL_IN","vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"tg = sn ( sw ) ;".split(" ")}]},
{TYPE:"node",NAME:"GEOMETRY_OR",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"th",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"th = 2.0 * sj - vec3 ( _1_0 ) ;".split(" ")}]},{TYPE:"node",NAME:"GEOMETRY_VC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"ti",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sx",QUALIFIER:["GLSL_IN","vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"ti = max ( vec3 ( _0_0 ) , sx ) ; bG ( ti ) ;".split(" ")}]},{TYPE:"node",
NAME:"GEOMETRY_VC1",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sy",QUALIFIER:["GLSL_IN","float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"tj = max ( _0_0 , sy ) ; bG ( tj ) ;".split(" ")}]},{TYPE:"node",NAME:"GEOMETRY_VC2",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tk",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tl",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sz",QUALIFIER:["GLSL_IN",
"vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"tk = max ( _0_0 , sz [ 0 ] ) ; tl = max ( _0_0 , sz [ 1 ] ) ; bG ( tk ) ; bG ( tl ) ;".split(" ")}]},{TYPE:"node",NAME:"GEOMETRY_VC3",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tm",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"to",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sA",QUALIFIER:["GLSL_IN","vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",
TOKENS:"tm = max ( _0_0 , sA [ 0 ] ) ; tn = max ( _0_0 , sA [ 1 ] ) ; to = max ( _0_0 , sA [ 2 ] ) ; bG ( tm ) ; bG ( tn ) ; bG ( to ) ;".split(" ")}]},{TYPE:"node",NAME:"GEOMETRY_NO",NODE_VARS:[{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"tr",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tu",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["tu",
"=","tr",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"tu = sK . xyz ;".split(" ")}]}]}]},{TYPE:"node",NAME:"GEOMETRY_FB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tv",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"tv = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"tv = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]}]}]},
{TYPE:"node",NAME:"GEOMETRY_BF",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tw",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"tw = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"tw = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]}]}]},{TYPE:"node",NAME:"GEOMETRY_VW",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",
NAME:"tx",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"tx = - _ ( u_view_tsr_frag , oy ) ;".split(" ")}]},{TYPE:"node",NAME:"GEOMETRY_LO",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"ty",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"ty = sR . xyz ;".split(" ")}]},{TYPE:"node",NAME:"GEOMETRY_GL",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tz",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tz","=","ow",";"]}]},{TYPE:"node",
NAME:"GEOMETRY_IN",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tA",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tA","=","oy",";"]}]},{TYPE:"node",NAME:"NEW_GEOMETRY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tD",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tF",QUALIFIER:["vec3"],
IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tI",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"tB = vec3 ( _0_0 ) ; tC = vec3 ( _0_0 ) ; tD = vec3 ( _0_0 ) ; tE = vec3 ( _0_0 ) ; tF = vec3 ( _0_0 ) ; tG = vec3 ( _0_0 ) ; tH = _0_0 ; tI = _0_0 ;".split(" ")}]},{TYPE:"node",NAME:"HUE_SAT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"tJ",QUALIFIER:["float"],
IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tO",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"vec3 kk = kj ( tN ) ; kk [ 0 ] += ( tJ - _0_5 ) ; if ( kk [ 0 ] > _1_0 ) kk [ 0 ] -= _1_0 ; else if ( kk [ 0 ] < _0_0 ) kk [ 0 ] += _1_0 ; kk *= vec3 ( _1_0 , tK , tL ) ; kk = mix ( vec3 ( _1_0 ) , mix ( vec3 ( _0_0 ) , kk , step ( vec3 ( _0_0 ) , kk ) ) , step ( kk , vec3 ( _1_0 ) ) ) ; tO = mix ( tN , kl ( kk ) , tM ) ;".split(" ")}]},
{TYPE:"node",NAME:"INVERT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"tP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tR",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"tR = mix ( tQ , vec3 ( _1_0 ) - tQ , tP ) ;".split(" ")}]},{TYPE:"node",NAME:"LAMP",NODE_VARS:[{TYPE:"node_var",NAME:"LAMP_TYPE",TOKENS:["HEMI"]},{TYPE:"node_var",NAME:"LAMP_INDEX",TOKENS:["0"]},{TYPE:"node_var",NAME:"LAMP_USE_SPHERE",
TOKENS:["0"]},{TYPE:"node_var",NAME:"LAMP_SPOT_SIZE",TOKENS:["0.8"]},{TYPE:"node_var",NAME:"LAMP_SPOT_BLEND",TOKENS:["0.03"]},{TYPE:"node_var",NAME:"LAMP_LIGHT_DIST",TOKENS:["30.0"]}],DECLARATIONS:[{TYPE:"node_out",NAME:"tS",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"tT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tV",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",
EXPRESSION:["LAMP_INDEX",1,{TYPE:"negative_expr",PLACES:1},{TYPE:"non_equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tS"],STATEMENTS:[{TYPE:"txt",TOKENS:"tS = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"vec3 tW = u_lamp_light_directions [ LAMP_INDEX ] ; vec3 tX = u_lamp_light_positions [ LAMP_INDEX ] ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2},
"LAMP_TYPE","POINT",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"tT = h - tX ; tU = length ( tT ) ; tT = normalize ( tT ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tV"],STATEMENTS:[{TYPE:"txt",TOKENS:"tV = LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + tU * tU ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"float pb = dot ( - tT , tW ) ; pb *= smoothstep ( _0_0 , _1_0 , ( pb - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; tV *= pb ;".split(" ")}]}]},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_USE_SPHERE"],STATEMENTS:[{TYPE:"txt",TOKENS:"tV *= max ( LAMP_LIGHT_DIST - tU , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]}]}]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tT"],STATEMENTS:[{TYPE:"txt",TOKENS:["tT","=","tW",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tU"],STATEMENTS:[{TYPE:"txt",TOKENS:"tU = length ( tX - h ) ;".split(" ")}]}]},{TYPE:"node_cond",
PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tV"],STATEMENTS:[{TYPE:"txt",TOKENS:["tV","=","_1_0",";"]}]}]}]}]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tS"],STATEMENTS:[{TYPE:"txt",TOKENS:"tS = vec3 ( _0_0 ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"tT = vec3 ( _0_0 ) ; tU = 0.0 ;".split(" ")}]}]}]},{TYPE:"node",NAME:"NORMAL",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"tY",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tZ",QUALIFIER:["vec3"],
IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"t_",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"sB",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tZ"],STATEMENTS:[{TYPE:"txt",TOKENS:["tZ","=","sB",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_t_"],STATEMENTS:[{TYPE:"txt",TOKENS:"t_ = - dot ( tY , sB ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"B4W_VECTOR_VIEW",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",
NAME:"ua",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ub",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"ub = - _ ( u_view_tsr_frag , ua ) ;".split(" ")}]},{TYPE:"node",NAME:"BSDF_BEGIN",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"uc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ud",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ue",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uf",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",
NAME:"ug",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uh",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ui",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uk",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ul",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"um",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"un",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uo",
QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"up",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ur",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"us",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ut",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uu",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uv",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uw",QUALIFIER:["vec4"],
IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ux",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uy",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uz",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uC",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"ur = ud ; us = uf ; ut = ui ; ux = ud ; uy = uf ; uz = ul ; uA = um ; uB = un ; uC = uo ; up = sS * ur ; uq = sT * u_environment_energy * cE ( ut ) ; uw = cH ( ur ) ; H = uw ; uu [ 0 ] = ue ; uu [ 1 ] = ug ; uu [ 2 ] = uh ; uv [ 0 ] = uj ; uv [ 1 ] = uk ;".split(" ")}]},
{TYPE:"node",NAME:"BSDF_END",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"uD",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uG",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uH",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uI",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uK",
QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uM",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uN",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uP",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float uQ = clamp ( uG [ 1 ] , _0_0 , _1_0 ) ; float rW = uG [ 2 ] ; uO = uD . rgb ; uP = _1_0 ;".split(" ")},{TYPE:"node_cond",
PARTS:[{TYPE:"node_if",EXPRESSION:["REFLECTION_TYPE","REFL_PBR_STANDARD",{TYPE:"equal_expr",PLACES:2},"REFLECTION_TYPE","REFL_PBR_SIMPLE",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"uO += sf ( uI , uJ , oy , uF , rW , uQ , mat3 ( _0_0 ) ) ;".split(" ")}]},{TYPE:"node_elif",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"uO += sf ( uI , uJ , oy , uF , rW , u_view_tsr_frag ) ;".split(" ")}]}]},
{TYPE:"txt",TOKENS:"uO += uE ; uO = mix ( uO , uK , uL ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NODE_BSDF_TRANSPARENT"],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_BSDF_TRANSPARENT_REFRACT"],STATEMENTS:[{TYPE:"txt",TOKENS:"vec3 uR = GLSL_TEXTURE ( u_refractmap , l . xy / l . z ) . rgb ; bG ( uR ) ; uM = uM * uR ; uO += uM ; uP = _1_0 ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_BSDF_TRANSPARENT_ALPHA"],STATEMENTS:[{TYPE:"txt",
TOKENS:"uO = mix ( uM , uO , uN ) ; uP = uN ;".split(" ")}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_BSDF_PRINCIPLED_REFRACT"],STATEMENTS:[{TYPE:"txt",TOKENS:"float uS = uH [ 0 ] ; float uT = uH [ 1 ] ; float uU = clamp ( uG [ 0 ] , _0_0 , _1_0 ) ; vec3 en = oy ; vec3 ei = normalize ( uF ) ; vec3 uV = refract ( - en , ei , _1_0 / uS ) ; uV *= length ( u_camera_eye_frag - h ) ; vec3 uW = aC ( u_proj_matrix_frag * vec4 ( ap ( u_view_tsr_frag , ow + uV ) , _1_0 ) ) ; vec2 uX = uW . xy / uW . z ; const float sc = 10.0 ; vec3 fa = GLSL_TEXTURE_LOD ( u_refractmap , uX . xy , uU * sc ) . rgb ; bG ( fa ) ; float e_ = ( _1_0 - rW ) * uT ; uO = mix ( uO , fa , e_ ) ;".split(" ")}]}]},
{TYPE:"txt",TOKENS:["uF",";"]}]},{TYPE:"node",NAME:"BSDF_COMPUTE",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"uY",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uZ",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"u_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"va",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vb",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vc",QUALIFIER:["float"],
IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vd",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"vec3 rz = u_ ; float uU = clamp ( vb [ 0 ] , _0_0 , _1_0 ) ; float uQ = clamp ( vb [ 1 ] , _0_0 , _1_0 ) ; float rW = vb [ 2 ] ; vec3 p_ = normalize ( oy + uY ) ; vec3 ve = ( _1_0 - va ) * vec3 ( dot ( rz , uY ) , max ( dot ( uY , p_ ) , _0_0 ) , max ( dot ( u_ , p_ ) , _0_0 ) ) + va ; float pj = ve . x ; float vf = ve . y ; float vg = ve . z ; vc = _0_0 ; if ( uZ . r != _0_0 ) { vc = pj ; if ( uU > _0_0 ) { float pz = max ( dot ( rz , oy ) , _0_0 ) ; float pA = uU * uU ; float cG = _1_0 - _0_5 * ( pA / ( pA + 0.33 ) ) ; vec3 pB = uY - pj * rz ; vec3 pC = oy - pz * rz ; if ( length ( pB ) == _0_0 || length ( pC ) == _0_0 || abs ( pj ) > _1_0 || abs ( pz ) > _1_0 ) vc = pj * cG ; else { float pD = acos ( pj ) ; float pE = acos ( pz ) ; vec3 pF = normalize ( pB ) ; vec3 pG = normalize ( pC ) ; float a , b ; a = max ( pD , pE ) ; b = min ( pD , pE ) ; b *= 0.95 ; float t = max ( dot ( pF , pG ) , _0_0 ) ; float hS = 0.45 * ( pA / ( pA + 0.09 ) ) ; vc = pj * ( cG + ( hS * t * sin ( a ) * tan ( b ) ) ) ; } } vc = max ( vc , _0_0 ) / M_PI ; } float L = uQ ; float vh = L * L ; float d_ = ( vg * vh - vg ) * vg + _1_0 ; float cD = vh / ( M_PI * d_ * d_ ) ; float vi ; float vj ; float vk = _1_0 - vf ; float vl = vk * vk ; vl = vl * vk * vl ; vi = _1_0 ; vj = vl ; float hM = L / 2.0 ; float vm = hM * hM ; float vn = _1_0 - vm ; float vo = _1_0 / ( vf * vf * vn + vm ) ; vi *= vo ; vj *= vo ; float rR = mix ( 0.04 , _1_0 , rW ) ; float vp = mix ( vj , vi , rR ) ; vd = max ( pj * cD * vp , _0_0 ) ;".split(" ")}]},
{TYPE:"node",NAME:"BSDF_PRINCIPLED",NODE_VARS:[{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"vq",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vs",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vt",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vu",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vv",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",
NAME:"vw",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vx",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vy",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vz",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vB",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vD",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vE",
QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vG",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vI",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"vz = vq . rgb ; vA = vs * vs ; vx = vq . rgb ; vy = vs ; vB = vr ; vD = vt ; vE = vu ; vG = _0_0 ; vI = _1_0 ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],
STATEMENTS:[{TYPE:"txt",TOKENS:["vC","=","vv",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vC","=","ox",";"]}]}]},{TYPE:"txt",TOKENS:"vw ; vF = vec3 ( _0_0 ) ; vH = vec3 ( _0_0 ) ;".split(" ")}]},{TYPE:"node",NAME:"BSDF_ANISOTROPIC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"vJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vM",QUALIFIER:["float"],
IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vP",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"vP = vJ ; vK ; vL ; vM ; vN ; vO ;".split(" ")}]},{TYPE:"node",NAME:"BSDF_DIFFUSE",NODE_VARS:[{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"vQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vR",QUALIFIER:["float"],
IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vS",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vV",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vW",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},
{TYPE:"node_out",NAME:"v_",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wa",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wb",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wc",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wd",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"we",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"vU = vQ ; vV = vR ; vX = _1_0 ; vY = _0_0 ; v_ = 1.45 ; wa = _0_0 ; wc = _0_0 ; we = _1_0 ;".split(" ")},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["vZ","=","vS",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vZ","=","ox",";"]}]}]},{TYPE:"txt",TOKENS:"vT ; vW = vec3 ( _0_0 ) ; wb = vec3 ( _0_0 ) ; wd = vec3 ( _0_0 ) ;".split(" ")}]},{TYPE:"node",NAME:"BSDF_GLASS",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"wf",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wg",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wh",
QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wi",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wj",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"wj = wf ; wg ; wh ; wi ;".split(" ")}]},{TYPE:"node",NAME:"BSDF_GLOSSY",NODE_VARS:[{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"wk",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wl",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wm",QUALIFIER:["vec3"],
IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wn",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wo",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wp",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ws",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wt",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wu",QUALIFIER:["float"],IS_OPTIONAL:!1},
{TYPE:"node_out",NAME:"wv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wA",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wB",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wD",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"wq = wk ; wr = wl ; ws = _1_0 ; wu = 1.45 ; wv = _0_0 ; wB = _0_0 ; wD = _1_0 ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],
STATEMENTS:[{TYPE:"txt",TOKENS:["wt","=","wm",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["wt","=","ox",";"]}]}]},{TYPE:"txt",TOKENS:"wn ; wo = vec3 ( _0_0 ) ; wp = _0_0 ; wA = vec3 ( _0_0 ) ; wC = vec3 ( _0_0 ) ;".split(" ")}]},{TYPE:"node",NAME:"BSDF_HAIR",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"wE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wF",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wG",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",
NAME:"wH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wI",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"wI = wE ; wF ; wG ; wH ;".split(" ")}]},{TYPE:"node",NAME:"BSDF_TRANSPARENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"wJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",
NAME:"wN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wO",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wR",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wS",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",
NAME:"wV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wW",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"wV = wJ ; wP = _0_0 ; wU = _0_0 ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_BSDF_TRANSPARENT_ALPHA"],STATEMENTS:[{TYPE:"txt",TOKENS:["wW","=","_0_0",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["wW","=","_1_0",";"]}]}]},{TYPE:"txt",TOKENS:"wQ = ox ; wK ; wL = vec3 ( _0_0 ) ; wM = _0_0 ; wN = vec3 ( _0_0 ) ; wO = _0_0 ; wT = vec3 ( _0_0 ) ;".split(" ")}]},
{TYPE:"node",NAME:"BSDF_TRANSLUCENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"wX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wY",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"wZ = wX ; wY ;".split(" ")}]},{TYPE:"node",NAME:"BSDF_REFRACTION",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"w_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xa",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",
NAME:"xb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xd",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"xd [ 0 ] = xd [ 1 ] = xd [ 2 ] = _0_0 ; w_ ; xa ; xb ; xc ;".split(" ")}]},{TYPE:"node",NAME:"BSDF_TOON",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xe",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xf",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xg",QUALIFIER:["float"],
IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xh",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xi",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"xi = xe ; xf ; xg ; xh ;".split(" ")}]},{TYPE:"node",NAME:"BSDF_VELVET",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xj",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xk",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xl",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xm",QUALIFIER:["vec3"],
IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"xm = xj ; xk ; xl ;".split(" ")}]},{TYPE:"node",NAME:"SUBSURFACE_SCATTERING",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xn",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xo",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xp",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xq",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xs",QUALIFIER:["vec3"],
IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xt",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"xt [ 0 ] = xt [ 1 ] = xt [ 2 ] = _0_0 ; xn ; xp ; xq ; xr ; xs ; xo ;".split(" ")}]},{TYPE:"node",NAME:"EMISSION",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xu",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xA",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",
NAME:"xC",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xD",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xF",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xI",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",
NAME:"xK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xM",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"xJ = xv * xu ; xF = _0_0 ; xK = _1_0 ; xM = _1_0 ; xG = ox ; xH = 1.45 ; xI = _0_0 ; xA ; xB = vec3 ( _0_0 ) ; xC = _0_0 ; xD = vec3 ( _0_0 ) ; xE = _0_0 ;".split(" ")}]},{TYPE:"node",NAME:"AMBIENT_OCCLUSION",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},
{TYPE:"node_out",NAME:"xO",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"xO [ 0 ] = xO [ 1 ] = xO [ 2 ] = _0_0 ; xN ;".split(" ")}]},{TYPE:"node",NAME:"HOLDOUT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"xP",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"xP [ 0 ] = xP [ 1 ] = xP [ 2 ] = _0_0 ;".split(" ")}]},{TYPE:"node",NAME:"VOLUME_ABSORPTION",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",
NAME:"xR",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xS",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"xS [ 0 ] = xS [ 1 ] = xS [ 2 ] = _0_0 ; xQ ; xR ;".split(" ")}]},{TYPE:"node",NAME:"VOLUME_SCATTER",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xV",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xW",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],
STATEMENTS:[{TYPE:"txt",TOKENS:"xW [ 0 ] = xW [ 1 ] = xW [ 2 ] = _0_0 ; xT ; xU ; xV ;".split(" ")}]},{TYPE:"node",NAME:"BUMP",NODE_VARS:[{TYPE:"node_var",NAME:"INVERT",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"xX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xZ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"x_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",
NAME:"ya",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float aM = xY ; float gL = xX ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["INVERT"],STATEMENTS:[{TYPE:"txt",TOKENS:["aM","=","-","_1_0",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","U","=","x_",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","U","=","ox",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_DERIVATIVES_EXT"],
STATEMENTS:[{TYPE:"txt",TOKENS:"vec3 yb = dFdx ( ow ) ; vec3 yc = dFdy ( ow ) ; vec3 yd = cross ( yc , U ) ; vec3 ye = cross ( U , yb ) ; float dy = dot ( yb , yd ) ; float yf = abs ( dy ) ; vec3 yg = dFdx ( xZ ) * yd + dFdy ( xZ ) * ye ; gL = max ( gL , _0_0 ) ; ya = normalize ( yf * U - aM * sign ( dy ) * yg ) ; ya = normalize ( gL * ya + ( _1_0 - gL ) * U ) ;".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["ya","=","U",";"]}]}]}]},{TYPE:"node",NAME:"DISPLACEMENT_BUMP",NODE_VARS:[],
DECLARATIONS:[{TYPE:"node_in",NAME:"yh",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yi",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float aM = 0.1 ; vec3 U = ox ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_DERIVATIVES_EXT"],STATEMENTS:[{TYPE:"txt",TOKENS:"vec3 yb = dFdx ( ow ) ; vec3 yc = dFdy ( ow ) ; vec3 yd = cross ( yc , U ) ; vec3 ye = cross ( U , yb ) ; float dy = dot ( yb , yd ) ; float yf = abs ( dy ) ; vec3 yg = dFdx ( yh ) * yd + dFdy ( yh ) * ye ; yi = normalize ( yf * U - aM * sign ( dy ) * yg ) ;".split(" ")}]},
{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["yi","=","U",";"]}]}]}]},{TYPE:"node",NAME:"NORMAL_MAP",NODE_VARS:[{TYPE:"node_var",NAME:"SPACE",TOKENS:["NM_TANGENT"]},{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"yj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yk",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yl",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ym",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",
PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","yn","=","yl",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","yn","=","sM",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["SPACE","NM_TANGENT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"ym = 2.0 * yk . xyz - _1_0 ; ym = sQ * ym ;".split(" ")}]},{TYPE:"node_elif",EXPRESSION:["SPACE","NM_OBJECT",{TYPE:"equal_expr",PLACES:2},"SPACE","NM_BLENDER_OBJECT",{TYPE:"equal_expr",
PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"ym = 2.0 * yk . xyz - _1_0 ; ym . yz *= - _1_0 ; ym = bI ( u_model_tsr , ym ) ;".split(" ")}]},{TYPE:"node_elif",EXPRESSION:["SPACE","NM_WORLD",{TYPE:"equal_expr",PLACES:2},"SPACE","NM_BLENDER_WORLD",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"ym = 2.0 * yk . xyz - _1_0 ; ym . yz *= - _1_0 ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"float me = max ( yj , _0_0 ) ; ym = normalize ( mix ( yn , ym , me ) ) ;".split(" ")}]},
{TYPE:"node",NAME:"VECT_TRANSFORM",NODE_VARS:[{TYPE:"node_var",NAME:"CONVERT_TYPE",TOKENS:["VT_WORLD_TO_OBJECT"]},{TYPE:"node_var",NAME:"VECTOR_TYPE",TOKENS:["VT_VECTOR"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"yo",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yp",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{TYPE:"equal_expr",PLACES:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",{TYPE:"equal_expr",PLACES:2},
"CONVERT_TYPE","VT_CAMERA_TO_CAMERA",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:3}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","yo",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["VECTOR_TYPE","VT_POINT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"yp = ap ( u_view_tsr_frag , yo ) ;".split(" ")}]},
{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"yp = ap ( u_model_tsr_inverse , yo ) ;".split(" ")}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"yp = ap ( u_model_tsr , yo ) ;".split(" ")}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"yp = ap ( u_model_tsr , yo ) ; yp = ap ( u_view_tsr_frag , yp ) ;".split(" ")}]},
{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"yp = ap ( u_view_tsr_inverse , yo ) ;".split(" ")}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"yp = ap ( u_view_tsr_inverse , yo ) ; yp = ap ( u_model_tsr_inverse , yp ) ;".split(" ")}]}]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_TYPE",
"VT_WORLD_TO_CAMERA",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"yp = _ ( u_view_tsr_frag , yo ) ;".split(" ")}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"yp = _ ( u_model_tsr_inverse , yo ) ;".split(" ")}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"yp = _ ( u_model_tsr , yo ) ;".split(" ")}]},{TYPE:"node_elif",
EXPRESSION:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"yp = _ ( u_model_tsr , yo ) ; yp = _ ( u_view_tsr_frag , yp ) ;".split(" ")}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"yp = _ ( u_view_tsr_inverse , yo ) ;".split(" ")}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"yp = _ ( u_view_tsr_inverse , yo ) ; yp = _ ( u_model_tsr_inverse , yp ) ;".split(" ")}]}]}]}]},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["VECTOR_TYPE","VT_NORMAL",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"yp = normalize ( yp ) ;".split(" ")}]}]}]}]}]},{TYPE:"node",NAME:"BLACKBODY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yq",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yr",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"yr [ 0 ] = yr [ 1 ] = yr [ 2 ] = _0_0 ; yq ;".split(" ")}]},{TYPE:"node",NAME:"WAVELENGTH",NODE_VARS:[],
DECLARATIONS:[{TYPE:"node_in",NAME:"ys",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yt",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"yt [ 0 ] = yt [ 1 ] = yt [ 2 ] = _0_0 ; ys ;".split(" ")}]},{TYPE:"node",NAME:"SEPXYZ",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yu",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yB",QUALIFIER:["float"],
IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"yv = yu [ 0 ] ; yA = yu [ 1 ] ; yB = yu [ 2 ] ;".split(" ")}]},{TYPE:"node",NAME:"COMBXYZ",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yC",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yD",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yF",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"yF [ 0 ] = yC ; yF [ 1 ] = yD ; yF [ 2 ] = yE ;".split(" ")}]},
{TYPE:"node",NAME:"BRIGHTCONTRAST",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yI",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float b = yH - yI * _0_5 ; yJ = max ( ( _1_0 + yI ) * yG + b , vec3 ( _0_0 ) ) ;".split(" ")}]},{TYPE:"node",NAME:"LIGHT_FALLOFF",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",
NAME:"yK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yN",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yO",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"yM = yN = yO = _0_0 ; yK ; yL ;".split(" ")}]},{TYPE:"node",NAME:"TEX_SKY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yP",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",
NAME:"yQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"yQ [ 0 ] = yQ [ 1 ] = yQ [ 2 ] = _0_0 ; yP ;".split(" ")}]},{TYPE:"node",NAME:"TEX_NOISE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yS",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yT",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},
{TYPE:"node_out",NAME:"yW",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"yV [ 0 ] = yV [ 1 ] = yV [ 2 ] = _0_0 ; yW = _1_0 ; yR ; yS ; yT ; yU ;".split(" ")}]},{TYPE:"node",NAME:"TEX_WAVE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yZ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"y_",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",
NAME:"za",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zb",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zc",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"zb [ 0 ] = zb [ 1 ] = zb [ 2 ] = _0_0 ; zc = _1_0 ; yX ; yY ; yZ ; y_ ; za ;".split(" ")}]},{TYPE:"node",NAME:"TEX_VORONOI",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zd",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ze",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zf",
QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zg",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"zf [ 0 ] = zf [ 1 ] = zf [ 2 ] = _0_0 ; zg = _1_0 ; zd ; ze ;".split(" ")}]},{TYPE:"node",NAME:"TEX_MUSGRAVE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zh",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zi",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zk",QUALIFIER:["float"],IS_OPTIONAL:!1},
{TYPE:"node_in",NAME:"zl",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zm",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zo",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zp",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"zo [ 0 ] = zo [ 1 ] = zo [ 2 ] = _0_0 ; zp = _1_0 ; zh ; zi ; zj ; zk ; zl ; zm ; zn ;".split(" ")}]},{TYPE:"node",NAME:"TEX_GRADIENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",
NAME:"zq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zr",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zs",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"zr [ 0 ] = zr [ 1 ] = zr [ 2 ] = _0_0 ; zs = _1_0 ; zq ;".split(" ")}]},{TYPE:"node",NAME:"TEX_MAGIC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zt",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zu",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zv",QUALIFIER:["float"],
IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zA",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zB",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"zA [ 0 ] = zA [ 1 ] = zA [ 2 ] = _0_0 ; zB = _1_0 ; zt ; zu ; zv ;".split(" ")}]},{TYPE:"node",NAME:"TEX_CHECKER",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zD",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",
NAME:"zF",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zH",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"zG [ 0 ] = zG [ 1 ] = zG [ 2 ] = _0_0 ; zH = _1_0 ; zC ; zD ; zE ; zF ;".split(" ")}]},{TYPE:"node",NAME:"TEX_BRICK",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zI",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zK",QUALIFIER:["vec3"],
IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zN",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zO",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zQ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zS",QUALIFIER:["float"],IS_OPTIONAL:!1}],
STATEMENTS:[{TYPE:"txt",TOKENS:"zR [ 0 ] = zR [ 1 ] = zR [ 2 ] = _0_0 ; zS = _1_0 ; zI ; zJ ; zK ; zL ; zM ; zN ; zO ; zP ; zQ ;".split(" ")}]},{TYPE:"node",NAME:"ADD_SHADER",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zV",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"zV = clamp ( zT + zU , vec3 ( _0_0 ) , vec3 ( _1_0 ) ) ;".split(" ")}]},{TYPE:"node",
NAME:"MIX_SHADER",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zW",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zY",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"z_",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Aa",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ab",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ac",
QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ad",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ae",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Af",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ag",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ah",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ai",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Aj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ak",QUALIFIER:["vec3"],
IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Al",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Am",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"An",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ao",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ap",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Aq",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ar",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"As",QUALIFIER:["vec3"],IS_OPTIONAL:!1},
{TYPE:"node_in",NAME:"At",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Au",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Av",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Aw",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ax",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ay",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Az",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",
NAME:"AB",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AD",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AG",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AI",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",
TOKENS:"float AJ = sqrt ( clamp ( zW , _0_0 , _1_0 ) ) ; Ax = mix ( zZ , Ak , AJ ) ; Ay = mix ( z_ , Al , AJ ) ; if ( Ac > _0_0 ) { if ( Ao > _0_0 ) { Az = mix ( Aa , Am , AJ ) ; AA = mix ( Ab , An , AJ ) ; } else { Az = Aa ; AA = Ab ; } } else { Az = Am ; AA = An ; } if ( Ah > _0_0 ) { if ( At > _0_0 ) { AF = mix ( Ag , As , AJ ) ; } else { AF = Ag ; } } else { AF = As ; } AB = mix ( Ac , Ao , AJ ) ; AC = mix ( Ad , Ap , AJ ) ; AG = mix ( Ah , At , AJ ) ; AH = mix ( Ai , Au , AJ ) ; AI = mix ( Aj , Av , AJ ) ;".split(" ")}]},
{TYPE:"node",NAME:"UV_MERGED",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sC",QUALIFIER:["GLSL_IN","vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_AK"],STATEMENTS:[{TYPE:"txt",TOKENS:"AK = sn ( sC ) ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_AL"],STATEMENTS:[{TYPE:"txt",TOKENS:"AL = vec3 ( sC , _0_0 ) ;".split(" ")}]}]}]},
{TYPE:"node",NAME:"TEX_COORD_UV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AM",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sD",QUALIFIER:["GLSL_IN","vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"AM = vec3 ( sD , _0_0 ) ;".split(" ")}]},{TYPE:"node",NAME:"TEX_COORD_NO",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AN",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AN","=","ox",";"]}]},{TYPE:"node",NAME:"TEX_COORD_GE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",
NAME:"AO",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["IS_WORLD",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AO","=","sj",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["AO","=","sJ",";"]}]}]}]},{TYPE:"node",NAME:"TEX_COORD_OB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AP",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["IS_WORLD",{TYPE:"logic_negative_expr",
PLACES:1}],STATEMENTS:[{TYPE:"txt",TOKENS:"AP = ap ( u_model_tsr_inverse , ow ) ;".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["AP","=","sJ",";"]}]}]}]},{TYPE:"node",NAME:"TEX_COORD_CA",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"AQ . xy = sR . xy ; AQ . z = _1_0 ;".split(" ")}]},{TYPE:"node",NAME:"TEX_COORD_WI",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AR",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],
STATEMENTS:[{TYPE:"txt",TOKENS:"AR . xy = l . xy / l . z ; AR . z = _0_0 ;".split(" ")}]},{TYPE:"node",NAME:"TEX_COORD_RE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AS",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"AS = reflect ( - oy , ox ) ;".split(" ")}]},{TYPE:"node",NAME:"UVMAP",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sE",QUALIFIER:["GLSL_IN","vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",
TOKENS:"AT = vec3 ( sE , _0_0 ) ;".split(" ")}]},{TYPE:"node",NAME:"PARTICLE_INFO",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AV",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AW",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",
NAME:"A_",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"AU = _0_0 ; AV = _0_0 ; AW = _0_0 ; AX = vec3 ( _0_0 ) ; AY = _0_0 ; AZ = AX ; A_ = AX ;".split(" ")}]},{TYPE:"node",NAME:"HAIR_INFO",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"Ba",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bc",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bd",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",
TOKENS:"Ba = _0_0 ; Bb = _0_0 ; Bc = _0_0 ; Bd = vec3 ( _0_0 ) ;".split(" ")}]},{TYPE:"node",NAME:"OBJECT_INFO",NODE_VARS:[{TYPE:"node_var",NAME:"USE_LOCATION_OUT",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_OBJ_IND_OUT",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_MAT_IND_OUT",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_RANDOM_OUT",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_out",NAME:"Be",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bf",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bg",
QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bh",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_LOCATION_OUT"],STATEMENTS:[{TYPE:"txt",TOKENS:"Be = ex ( u_model_tsr ) ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OBJ_IND_OUT"],STATEMENTS:[{TYPE:"txt",TOKENS:"Bf = u_obj_info . r ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MAT_IND_OUT"],STATEMENTS:[{TYPE:"txt",TOKENS:"Bg = u_obj_info . g ;".split(" ")}]}]},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_RANDOM_OUT"],STATEMENTS:[{TYPE:"txt",TOKENS:"Bh = u_obj_info . b ;".split(" ")}]}]}]},{TYPE:"node",NAME:"WIREFRAME",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Bi",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bj",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Bj","=","Bi",";"]}]},{TYPE:"node",NAME:"TANGENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"Bk",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",
TOKENS:"Bk = vec3 ( _0_0 ) ;".split(" ")}]},{TYPE:"node",NAME:"LAYER_WEIGHT",NODE_VARS:[{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Bl",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Bm",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bo",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",
TOKENS:"vec3 cw = normalize ( Bm ) ;".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","cw","=","ox",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CAMERA_TYPE","CAM_TYPE_PERSP",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"vec3 Bp = normalize ( oy ) ;".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","Bp","=","u_camera_direction",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Bn"],STATEMENTS:[{TYPE:"txt",
TOKENS:"float su = max ( _1_0 - Bl , 0.00001 ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"non_equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"su = gl_FrontFacing == false ? su : _1_0 / su ;".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"su = gl_FrontFacing ? su : _1_0 / su ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"Bn = sv ( Bp , cw , su ) ;".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["Bn",
"=","_0_0",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Bo"],STATEMENTS:[{TYPE:"txt",TOKENS:"Bo = abs ( dot ( Bp , cw ) ) ; float eA = Bl ; if ( eA != _0_5 ) { eA = clamp ( eA , _0_0 , 0.99999 ) ; eA = ( eA < _0_5 ) ? 2.0 * eA : _0_5 / ( _1_0 - eA ) ; Bo = pow ( Bo , eA ) ; } Bo = _1_0 - Bo ;".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["Bo","=","_0_0",";"]}]}]}]},{TYPE:"node",NAME:"LIGHT_PATH",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"Bq",QUALIFIER:["float"],
IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Br",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bs",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bt",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bu",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bx",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"By",QUALIFIER:["float"],
IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bz",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BA",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"Bq = Br = Bs = _0_0 ; Bt = Bu = Bv = _0_0 ; Bw = BA = By = Bz = _0_0 ; Bx = _0_0 ;".split(" ")}]},{TYPE:"node",NAME:"ATTRIBUTE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"BB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BD",QUALIFIER:["float"],
IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"BB = BC = vec3 ( _0_0 ) ; BD = _0_0 ;".split(" ")}]},{TYPE:"node",NAME:"SCRIPT",NODE_VARS:[],DECLARATIONS:[],STATEMENTS:[]},{TYPE:"node",NAME:"CURVE_VEC",NODE_VARS:[{TYPE:"node_var",NAME:"READ_R",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_G",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_B",TOKENS:["0"]},{TYPE:"node_var",NAME:"NODE_TEX_ROW",TOKENS:["_0_0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BF",
QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BG",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BG","=","BF",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_R"],STATEMENTS:[{TYPE:"txt",TOKENS:"BG . r = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( _0_5 * BF . r + _0_5 , NODE_TEX_ROW ) ) . r - _0_5 ) * 2.0 ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_G"],STATEMENTS:[{TYPE:"txt",TOKENS:"BG . g = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( _0_5 * BF . g + _0_5 , NODE_TEX_ROW ) ) . g - _0_5 ) * 2.0 ;".split(" ")}]}]},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_B"],STATEMENTS:[{TYPE:"txt",TOKENS:"BG . b = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( _0_5 * BF . b + _0_5 , NODE_TEX_ROW ) ) . b - _0_5 ) * 2.0 ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"BG = mix ( BF , BG , BE ) ;".split(" ")}]},{TYPE:"node",NAME:"CURVE_RGB",NODE_VARS:[{TYPE:"node_var",NAME:"READ_A",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_R",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_G",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_B",TOKENS:["0"]},
{TYPE:"node_var",NAME:"NODE_TEX_ROW",TOKENS:["_0_0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BI",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_A"],STATEMENTS:[{TYPE:"txt",TOKENS:"float r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( BI . r , NODE_TEX_ROW ) ) . a ; float g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( BI . g , NODE_TEX_ROW ) ) . a ; float b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( BI . b , NODE_TEX_ROW ) ) . a ;".split(" ")}]},
{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"float r = BI . r ; float g = BI . g ; float b = BI . b ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_R"],STATEMENTS:[{TYPE:"txt",TOKENS:"BJ . r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( r , NODE_TEX_ROW ) ) . r ;".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"BJ . r = r ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_G"],STATEMENTS:[{TYPE:"txt",TOKENS:"BJ . g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( g , NODE_TEX_ROW ) ) . g ;".split(" ")}]},
{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"BJ . g = g ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_B"],STATEMENTS:[{TYPE:"txt",TOKENS:"BJ . b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( b , NODE_TEX_ROW ) ) . b ;".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"BJ . b = b ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"BJ = mix ( BI , BJ , BH ) ;".split(" ")}]},{TYPE:"node",NAME:"VALTORGB",NODE_VARS:[{TYPE:"node_var",NAME:"NODE_TEX_ROW",TOKENS:["_0_0"]}],
DECLARATIONS:[{TYPE:"node_in",NAME:"BK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BM",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"vec4 BN = GLSL_TEXTURE ( u_nodes_texture , vec2 ( BK , NODE_TEX_ROW ) ) ; BL = BN . rgb ; BM = BN . a ;".split(" ")}]},{TYPE:"node",NAME:"MAPPING",NODE_VARS:[{TYPE:"node_var",NAME:"MAPPING_SCALE_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_SCALE",TOKENS:["vec3",
"(","_1_0",")"]},{TYPE:"node_var",NAME:"MAPPING_TRANS_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_TRANS",TOKENS:["vec3","(","_0_0",")"]},{TYPE:"node_var",NAME:"MAPPING_TRS_MATRIX_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_TRS_MATRIX",TOKENS:["mat4","(","_1_0",")"]},{TYPE:"node_var",NAME:"MAPPING_MIN_CLIP_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_MIN_CLIP",TOKENS:["vec3","(","_0_0",")"]},{TYPE:"node_var",NAME:"MAPPING_MAX_CLIP_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_MAX_CLIP",
TOKENS:["vec3","(","_1_0",")"]},{TYPE:"node_var",NAME:"MAPPING_IS_NORMAL",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BP",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BP","=","BO",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_SCALE_DEF"],STATEMENTS:[{TYPE:"txt",TOKENS:"BP = BP * MAPPING_SCALE ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_TRANS_DEF"],
STATEMENTS:[{TYPE:"txt",TOKENS:"BP = BP + MAPPING_TRANS ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_TRS_MATRIX_DEF"],STATEMENTS:[{TYPE:"txt",TOKENS:"BP = ( MAPPING_TRS_MATRIX * vec4 ( BP , _1_0 ) ) . xyz ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_MIN_CLIP_DEF"],STATEMENTS:[{TYPE:"txt",TOKENS:"BP = max ( BP , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_MAX_CLIP_DEF"],STATEMENTS:[{TYPE:"txt",
TOKENS:"BP = min ( BP , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_IS_NORMAL"],STATEMENTS:[{TYPE:"txt",TOKENS:"BP = normalize ( BP ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MATH_ADD",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BQ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BR",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BS",QUALIFIER:["float"],IS_OPTIONAL:!1}],
STATEMENTS:[{TYPE:"txt",TOKENS:"BS = BQ + BR ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"BS = clamp ( BS , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MATH_SUBTRACT",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BT",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BV",QUALIFIER:["float"],IS_OPTIONAL:!1}],
STATEMENTS:[{TYPE:"txt",TOKENS:"BV = BT - BU ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"BV = clamp ( BV , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MATH_MULTIPLY",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BW",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BY",QUALIFIER:["float"],IS_OPTIONAL:!1}],
STATEMENTS:[{TYPE:"txt",TOKENS:"BY = BW * BX ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"BY = clamp ( BY , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MATH_DIVIDE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BZ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"B_",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ca",QUALIFIER:["float"],IS_OPTIONAL:!1}],
STATEMENTS:[{TYPE:"txt",TOKENS:"Ca = ( B_ != _0_0 ) ? BZ / B_ : _0_0 ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"Ca = clamp ( Ca , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MATH_SINE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cc",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cd",QUALIFIER:["float"],
IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"Cd = sin ( Cb ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"Cd = clamp ( Cd , _0_0 , _1_0 ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:["Cc",";"]}]},{TYPE:"node",NAME:"MATH_COSINE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ce",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cf",QUALIFIER:["float"],IS_OPTIONAL:!1},
{TYPE:"node_out",NAME:"Cg",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"Cg = cos ( Ce ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"Cg = clamp ( Cg , _0_0 , _1_0 ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:["Cf",";"]}]},{TYPE:"node",NAME:"MATH_TANGENT",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ch",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",
NAME:"Ci",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cj",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"Cj = tan ( Ch ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"Cj = clamp ( Cj , _0_0 , _1_0 ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:["Ci",";"]}]},{TYPE:"node",NAME:"MATH_ARCSINE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ck",QUALIFIER:["float"],
IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cl",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cm",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"Cm = ( Ck <= _1_0 && Ck >= - _1_0 ) ? asin ( Ck ) : _0_0 ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"Cm = clamp ( Cm , _0_0 , _1_0 ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:["Cl",";"]}]},{TYPE:"node",NAME:"MATH_ARCCOSINE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",
TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Co",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cp",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"Cp = ( Cn <= _1_0 && Cn >= - _1_0 ) ? acos ( Cn ) : _0_0 ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"Cp = clamp ( Cp , _0_0 , _1_0 ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:["Co",";"]}]},
{TYPE:"node",NAME:"MATH_ARCTANGENT",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cq",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cs",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"Cs = atan ( Cq ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"Cs = clamp ( Cs , _0_0 , _1_0 ) ;".split(" ")}]}]},
{TYPE:"txt",TOKENS:["Cr",";"]}]},{TYPE:"node",NAME:"MATH_POWER",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ct",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cu",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cv",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"if ( Ct < _0_0 && Cu != floor ( Cu ) ) Cv = _0_0 ; else if ( Cu == _0_0 ) Cv = _1_0 ; else if ( Ct < _0_0 ) Cv = mix ( _1_0 , - _1_0 , sign ( mod ( - Cu , 2.0 ) ) ) * pow ( - Ct , Cu ) ; else if ( Ct == _0_0 ) Cv = _0_0 ; else Cv = pow ( Ct , Cu ) ;".split(" ")},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"Cv = clamp ( Cv , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MATH_LOGARITHM",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cx",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cy",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"Cy = ( Cw > _0_0 && Cx > _0_0 ) ? log2 ( Cw ) / log2 ( Cx ) : _0_0 ;".split(" ")},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"Cy = clamp ( Cy , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MATH_MINIMUM",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cz",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CB",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"CB = min ( Cz , CA ) ;".split(" ")},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"CB = clamp ( CB , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MATH_MAXIMUM",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CC",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CD",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CE",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"CE = max ( CC , CD ) ;".split(" ")},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"CE = clamp ( CE , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MATH_ROUND",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CF",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CG",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CH",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"CH = floor ( CF + _0_5 ) ;".split(" ")},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"CH = clamp ( CH , _0_0 , _1_0 ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:["CG",";"]}]},{TYPE:"node",NAME:"MATH_LESS_THAN",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CI",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CJ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CK",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",
TOKENS:"CK = ( CI < CJ ) ? _1_0 : _0_0 ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"CK = clamp ( CK , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MATH_GREATER_THAN",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CN",QUALIFIER:["float"],IS_OPTIONAL:!1}],
STATEMENTS:[{TYPE:"txt",TOKENS:"CN = ( CL > CM ) ? _1_0 : _0_0 ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"CN = clamp ( CN , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MATH_MODULO",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CO",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CQ",QUALIFIER:["float"],
IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"CQ = abs ( CP ) > 0.000001 ? mod ( CO , CP ) : _0_0 ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"CQ = clamp ( CQ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MATH_ABSOLUTE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CR",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CS",QUALIFIER:["float"],IS_OPTIONAL:!1},
{TYPE:"node_out",NAME:"CT",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"CT = abs ( CR ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"CT = clamp ( CT , _0_0 , _1_0 ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:["CS",";"]}]},{TYPE:"node",NAME:"MIX_RGB_MIX",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",
NAME:"CV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CW",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CX",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float AJ = clamp ( CU , _0_0 , _1_0 ) ; CX = mix ( CV , CW , AJ ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"CX = clamp ( CX , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MIX_RGB_ADD",NODE_VARS:[{TYPE:"node_var",
NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"C_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Da",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float AJ = clamp ( CY , _0_0 , _1_0 ) ; Da = mix ( CZ , CZ + C_ , AJ ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",
TOKENS:"Da = clamp ( Da , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MIX_RGB_MULTIPLY",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Db",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dd",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"De",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float AJ = clamp ( Db , _0_0 , _1_0 ) ; De = mix ( Dc , Dc * Dd , AJ ) ;".split(" ")},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"De = clamp ( De , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MIX_RGB_SUBTRACT",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Df",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dh",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Di",QUALIFIER:["vec3"],
IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float AJ = clamp ( Df , _0_0 , _1_0 ) ; Di = mix ( Dg , Dg - Dh , AJ ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"Di = clamp ( Di , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MIX_RGB_SCREEN",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Dj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dk",QUALIFIER:["vec3"],
IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dl",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Dm",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float AJ = clamp ( Dj , _0_0 , _1_0 ) ; float Dn = _1_0 - AJ ; Dm = vec3 ( _1_0 ) - ( vec3 ( Dn ) + AJ * ( vec3 ( _1_0 ) - Dl ) ) * ( vec3 ( _1_0 ) - Dk ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"Dm = clamp ( Dm , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{TYPE:"node",NAME:"MIX_RGB_DIVIDE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Do",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dp",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Dr",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float AJ = clamp ( Do , _0_0 , _1_0 ) ; float Dn = _1_0 - AJ ; Dq += step ( Dq , vec3 ( _0_0 ) ) ; Dr = Dn * Dp + AJ * Dp / Dq ;".split(" ")},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"Dr = clamp ( Dr , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MIX_RGB_DIFFERENCE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ds",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dt",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Du",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Dv",QUALIFIER:["vec3"],
IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float AJ = clamp ( Ds , _0_0 , _1_0 ) ; Dv = mix ( Dt , abs ( Dt - Du ) , AJ ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"Dv = clamp ( Dv , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MIX_RGB_DARKEN",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Dw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dx",
QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dy",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Dz",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float AJ = clamp ( Dw , _0_0 , _1_0 ) ; Dz = min ( Dx . rgb , Dy . rgb * AJ ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"Dz = clamp ( Dz , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MIX_RGB_LIGHTEN",NODE_VARS:[{TYPE:"node_var",
NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"DA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DD",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float AJ = clamp ( DA , _0_0 , _1_0 ) ; DD = max ( DB . rgb , DC . rgb * AJ ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",
TOKENS:"DD = clamp ( DD , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MIX_RGB_OVERLAY",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"DE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DH",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float AJ = clamp ( DE , _0_0 , _1_0 ) ; vec3 DI = vec3 ( _1_0 - AJ ) ; DH = mix ( DF * ( DI + 2.0 * AJ * DG ) , vec3 ( _1_0 ) - ( DI + 2.0 * AJ * ( vec3 ( _1_0 ) - DG ) ) * ( vec3 ( _1_0 ) - DF ) , step ( _0_5 , DF ) ) ;".split(" ")},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"DH = clamp ( DH , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MIX_RGB_DODGE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"DJ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DM",QUALIFIER:["vec3"],
IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float AJ = clamp ( DJ , _0_0 , _1_0 ) ; vec3 DN = vec3 ( _1_0 ) - AJ * DL ; vec3 DO = clamp ( DK / DN , _0_0 , _1_0 ) ; DM = mix ( mix ( DO , vec3 ( _1_0 ) , step ( DN , vec3 ( _0_0 ) ) ) , DK , step ( DK , vec3 ( _0_0 ) ) ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"DM = clamp ( DM , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MIX_RGB_BURN",NODE_VARS:[{TYPE:"node_var",
NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"DP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DS",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float AJ = clamp ( DP , _0_0 , _1_0 ) ; vec3 ks = vec3 ( _1_0 - AJ ) ; vec3 DN = ks + AJ * DR ; vec3 DO = clamp ( vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - DQ ) / DN , _0_0 , _1_0 ) ; DS = mix ( DO , vec3 ( _0_0 ) , step ( DN , vec3 ( _0_0 ) ) ) ;".split(" ")},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"DS = clamp ( DS , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MIX_RGB_HUE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"DT",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DW",QUALIFIER:["vec3"],
IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float AJ = clamp ( DT , _0_0 , _1_0 ) ; vec3 kk , DX , DN ; DW = DU ; DX = kj ( DV ) ; if ( DX . y != _0_0 ) { kk = kj ( DW ) ; kk . x = DX . x ; DN = kl ( kk ) ; DW = mix ( DW , DN , AJ ) ; }".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"DW = clamp ( DW , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MIX_RGB_SATURATION",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",
TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"DY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"D_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ea",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float AJ = clamp ( DY , _0_0 , _1_0 ) ; float Dn = _1_0 - AJ ; Ea = DZ ; vec3 kk , DX ; kk = kj ( Ea ) ; if ( kk . y != _0_0 ) { DX = kj ( D_ ) ; kk . y = Dn * kk . y + AJ * DX . y ; Ea = kl ( kk ) ; }".split(" ")},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"Ea = clamp ( Ea , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MIX_RGB_VALUE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Eb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ec",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ed",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ee",QUALIFIER:["vec3"],
IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float AJ = clamp ( Eb , _0_0 , _1_0 ) ; float Dn = _1_0 - AJ ; vec3 kk , DX ; kk = kj ( Ec ) ; DX = kj ( Ed ) ; kk . z = Dn * kk . z + AJ * DX . z ; Ee = kl ( kk ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"Ee = clamp ( Ee , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MIX_RGB_COLOR",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",
NAME:"Ef",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Eg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Eh",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ei",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float AJ = clamp ( Ef , _0_0 , _1_0 ) ; vec3 kk , DX , DN ; Ei = Eg ; DX = kj ( Eh ) ; if ( DX . y != _0_0 ) { kk = kj ( Ei ) ; kk . x = DX . x ; kk . y = DX . y ; DN = kl ( kk ) ; Ei = mix ( Ei , DN , AJ ) ; }".split(" ")},{TYPE:"node_cond",
PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"Ei = clamp ( Ei , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MIX_RGB_SOFT_LIGHT",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ej",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ek",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"El",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Em",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],
STATEMENTS:[{TYPE:"txt",TOKENS:"float AJ = clamp ( Ej , _0_0 , _1_0 ) ; float Dn = _1_0 - AJ ; vec3 En = El + Ek - El * Ek ; Em = Ek * ( vec3 ( Dn ) + vec3 ( AJ ) * ( ( vec3 ( _1_0 ) - Ek ) * El + En ) ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"Em = clamp ( Em , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MIX_RGB_LINEAR_LIGHT",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",
NAME:"Eo",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ep",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Eq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Er",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float AJ = clamp ( Eo , _0_0 , _1_0 ) ; Er = Ep + AJ * ( 2.0 * Eq - vec3 ( _1_0 ) ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"Er = clamp ( Er , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{TYPE:"node",NAME:"MIX_WORLD_RGB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Es",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Et",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Eu",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ev",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float AJ = clamp ( Es , _0_0 , _1_0 ) ; Ev = mix ( Et , Eu , AJ ) ;".split(" ")}]},{TYPE:"node",NAME:"ADD_WORLD_RGB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Ew",
QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ex",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ey",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ez",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float AJ = clamp ( Ew , _0_0 , _1_0 ) ; Ez = mix ( Ex , Ex + Ey , AJ ) ;".split(" ")}]},{TYPE:"node",NAME:"OUTPUT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"EA",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EB",QUALIFIER:["float"],
IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"E = EA ; I = EB ;".split(" ")}]},{TYPE:"node",NAME:"OUTPUT_SURFACE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"EC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ED",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"E = EC ; I = ED ;".split(" ")}]},{TYPE:"node",NAME:"OUTPUT_WORLD_SURFACE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"EE",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"E = EE ; I = _1_0 ;".split(" ")}]},
{TYPE:"node",NAME:"MATERIAL_BEGIN",NODE_VARS:[{TYPE:"node_var",NAME:"MATERIAL_EXT",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_MATERIAL_NORMAL",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_MATERIAL_DIFFUSE",TOKENS:["0"]},{TYPE:"node_var",NAME:"SHADELESS_MAT",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"EF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EI",QUALIFIER:["vec3"],
IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"EJ",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"EK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EM",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EP",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EQ",QUALIFIER:["vec2"],IS_OPTIONAL:!1},
{TYPE:"node_out",NAME:"ER",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sF",QUALIFIER:["const","vec2"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sG",QUALIFIER:["const","vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"EM = EF ; EN = sG [ 0 ] * EG ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_NORMAL"],STATEMENTS:[{TYPE:"txt",TOKENS:"EO = normalize ( EI ) ;".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["EO","=","ox",";"]}]}]},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["SHADELESS_MAT",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATERIAL_EXT"],STATEMENTS:[{TYPE:"txt",TOKENS:"EK = EJ * EM ;".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"EK = sS * EM ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_DIFFUSE"],STATEMENTS:[{TYPE:"txt",TOKENS:["EM","*=","EH",";"]}]}]},{TYPE:"txt",TOKENS:"EL = sT * u_environment_energy * cE ( EO ) ; ER = cH ( EM ) ;".split(" ")},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NUM_LIGHTS",0,{TYPE:"g_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"EP = vec2 ( sF [ 0 ] , sF [ 1 ] ) ; EQ = vec2 ( sG [ 1 ] , sG [ 2 ] ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:["H","=","ER",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"EK = vec3 ( _0_0 ) ; EL = vec3 ( _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MATERIAL_END",NODE_VARS:[{TYPE:"node_var",NAME:"MATERIAL_EXT",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_MATERIAL_DIFFUSE",
TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_MATERIAL_SPECULAR",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"ES",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ET",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EV",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"EW",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"EX",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"EY",QUALIFIER:["vec3"],
IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"EZ",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"E_",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fa",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fb",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"sH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sI",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_EY"],STATEMENTS:[{TYPE:"node_cond",
PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_DIFFUSE"],STATEMENTS:[{TYPE:"txt",TOKENS:"EY = ES . rgb ;".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"EY = vec3 ( _0_0 ) ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATERIAL_EXT","REFLECTION_TYPE","REFL_NONE",{TYPE:"non_equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],
STATEMENTS:[{TYPE:"txt",TOKENS:"cQ ( EY , oy , EU , EV , u_view_tsr_frag ) ;".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"cQ ( EY , oy , EU , EV , mat3 ( _0_0 ) ) ;".split(" ")}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_SPECULAR"],STATEMENTS:[{TYPE:"txt",TOKENS:["EY","+=","ET",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_E_"],STATEMENTS:[{TYPE:"txt",TOKENS:["E_","=","EU",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",
EXPRESSION:["MATERIAL_EXT"],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fa"],STATEMENTS:[{TYPE:"txt",TOKENS:"Fa = ES . rgb ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fb"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fb","=","ET",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_EZ"],STATEMENTS:[{TYPE:"txt",TOKENS:"EZ = clamp ( EX , _0_0 , _1_0 ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_SPECULAR"],
STATEMENTS:[{TYPE:"txt",TOKENS:"float t = max ( max ( ET . r , ET . g ) , ET . b ) * EW ; EZ = clamp ( EX * ( _1_0 - t ) + t , _0_0 , _1_0 ) ;".split(" ")}]}]}]}]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_EZ"],STATEMENTS:[{TYPE:"txt",TOKENS:"EZ = clamp ( sH , _0_0 , _1_0 ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_SPECULAR"],STATEMENTS:[{TYPE:"txt",TOKENS:"float t = max ( max ( ET . r , ET . g ) , ET . b ) * sI ; EZ = sH * ( _1_0 - t ) + t ;".split(" ")}]}]}]}]}]}]},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_SPECULAR"],STATEMENTS:[{TYPE:"txt",TOKENS:["F","=","ET",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"F = vec3 ( _0_0 ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:["G","=","EU",";"]}]},{TYPE:"node",NAME:"LIGHTING_AMBIENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"oP",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"oQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"oR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},
{TYPE:"node_out",NAME:"oS",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oT",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"oS = vec4 ( oP + oR * oQ , _0_0 ) ; oT = vec3 ( _0_0 ) ;".split(" ")}]},{TYPE:"node",NAME:"LIGHTING_LAMP",NODE_VARS:[{TYPE:"node_var",NAME:"LAMP_TYPE",TOKENS:["HEMI"]},{TYPE:"node_var",NAME:"LAMP_IND",TOKENS:["0"]},{TYPE:"node_var",NAME:"LAMP_SPOT_SIZE",TOKENS:["0.8"]},{TYPE:"node_var",NAME:"LAMP_SPOT_BLEND",TOKENS:["0.03"]},{TYPE:"node_var",
NAME:"LAMP_LIGHT_DIST",TOKENS:["30.0"]},{TYPE:"node_var",NAME:"LAMP_SHADOW_MAP_IND",TOKENS:["-","1"]},{TYPE:"node_var",NAME:"LAMP_USE_SPHERE",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"oU",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oW",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oY",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",
TOKENS:"oW = vec2 ( u_light_positions [ LAMP_IND ] . w , u_light_color_intensities [ LAMP_IND ] . w ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","HEMI",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["oY","=","_0_5",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["oY","=","_0_0",";"]}]}]},{TYPE:"txt",TOKENS:"oX = u_light_color_intensities [ LAMP_IND ] . xyz ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_SHADOW_MAP_IND",
1,{TYPE:"negative_expr",PLACES:1},{TYPE:"non_equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"oX *= oU [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2},"LAMP_TYPE","POINT",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"vec3 oZ = u_light_positions [ LAMP_IND ] . xyz ; oV = oZ - ow ; float aM = length ( oV ) ; oX *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + aM * aM ) ; oV = normalize ( oV ) ;".split(" ")},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"vec3 pa = u_light_directions [ LAMP_IND ] ; float pb = dot ( oV , pa ) ; pb *= smoothstep ( _0_0 , _1_0 , ( pb - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; oX *= pb ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_USE_SPHERE"],STATEMENTS:[{TYPE:"txt",TOKENS:"oX *= max ( LAMP_LIGHT_DIST - aM , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]}]},{TYPE:"node_else",
STATEMENTS:[{TYPE:"txt",TOKENS:"oV = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{TYPE:"node",NAME:"DIFFUSE_FRESNEL",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pd",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pe",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pf",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pg",QUALIFIER:["vec2"],IS_OPTIONAL:!1},
{TYPE:"node_out",NAME:"ph",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","rz","=","pe",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:"vec3 pi = cross ( pc , B . xyz ) ; rz = cross ( pi , B . xyz ) ; rz = - normalize ( rz ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"ph = _0_0 ; if ( pd . r != _0_0 ) { float pj = ( _1_0 - pf ) * dot ( rz , pc ) + pf ; if ( pg [ 0 ] == _0_0 ) { ph = _1_0 ; } else { float t = _1_0 + abs ( pj ) ; t = pg [ 1 ] + ( _1_0 - pg [ 1 ] ) * pow ( t , pg [ 0 ] ) ; ph = clamp ( t , _0_0 , _1_0 ) ; } ph = max ( ph , _0_0 ) ; }".split(" ")}]},
{TYPE:"node",NAME:"DIFFUSE_LAMBERT",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pk",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pl",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pm",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"po",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","rz","=","pm",";"]},{TYPE:"node_cond",
PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:"vec3 pi = cross ( pk , B . xyz ) ; rz = cross ( pi , B . xyz ) ; rz = - normalize ( rz ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"po = _0_0 ; if ( pl . r != _0_0 ) { float pj = ( _1_0 - pn ) * dot ( rz , pk ) + pn ; po = max ( pj , _0_0 ) ; }".split(" ")}]},{TYPE:"node",NAME:"DIFFUSE_OREN_NAYAR",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pr",QUALIFIER:["vec3"],
IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pu",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pv",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"px",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"py",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","rz","=","pv",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:"vec3 pi = cross ( pr , B . xyz ) ; rz = cross ( pi , B . xyz ) ; rz = - normalize ( rz ) ;".split(" ")}]}]},
{TYPE:"txt",TOKENS:"py = _0_0 ; if ( pu . r != _0_0 ) { float pj = ( _1_0 - pw ) * dot ( rz , pr ) + pw ; if ( px [ 0 ] > _0_0 ) { float pz = max ( dot ( rz , oy ) , _0_0 ) ; float pA = px [ 0 ] * px [ 0 ] ; float cG = _1_0 - _0_5 * ( pA / ( pA + 0.33 ) ) ; vec3 pB = pr - pj * rz ; vec3 pC = oy - pz * rz ; if ( length ( pB ) == _0_0 || length ( pC ) == _0_0 || abs ( pj ) > _1_0 || abs ( pz ) > _1_0 ) py = pj * cG ; else { float pD = acos ( pj ) ; float pE = acos ( pz ) ; vec3 pF = normalize ( pB ) ; vec3 pG = normalize ( pC ) ; float a , b ; a = max ( pD , pE ) ; b = min ( pD , pE ) ; b *= 0.95 ; float t = max ( dot ( pF , pG ) , _0_0 ) ; float hS = 0.45 * ( pA / ( pA + 0.09 ) ) ; py = pj * ( cG + ( hS * t * sin ( a ) * tan ( b ) ) ) ; } } else py = pj ; py = max ( py , _0_0 ) ; }".split(" ")}]},
{TYPE:"node",NAME:"DIFFUSE_MINNAERT",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pI",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pL",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pM",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",
TOKENS:["vec3","rz","=","pJ",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:"vec3 pi = cross ( pH , B . xyz ) ; rz = cross ( pi , B . xyz ) ; rz = - normalize ( rz ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"pM = _0_0 ; if ( pI . r != _0_0 ) { float pj = ( _1_0 - pK ) * dot ( rz , pH ) + pK ; float pz = max ( dot ( rz , oy ) , _0_0 ) ; if ( pL [ 0 ] <= _1_0 ) pM = pj * pow ( max ( pz * pj , 0.1 ) , pL [ 0 ] - _1_0 ) ; else pM = pj * pow ( 1.0001 - pz , pL [ 0 ] - _1_0 ) ; pM = max ( pM , _0_0 ) ; }".split(" ")}]},
{TYPE:"node",NAME:"DIFFUSE_TOON",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pO",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pP",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pQ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pR",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pS",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",
TOKENS:["vec3","rz","=","pP",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:"vec3 pi = cross ( pN , B . xyz ) ; rz = cross ( pi , B . xyz ) ; rz = - normalize ( rz ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"pS = _0_0 ; if ( pO . r != _0_0 ) { float pj = ( _1_0 - pQ ) * dot ( rz , pN ) + pQ ; float pT = acos ( pj ) ; if ( pT < pR [ 0 ] ) pS = _1_0 ; else if ( pT > ( pR [ 0 ] + pR [ 1 ] ) || pR [ 1 ] == _0_0 ) pS = _0_0 ; else pS = _1_0 - ( ( pT - pR [ 0 ] ) / pR [ 1 ] ) ; pS = max ( pS , _0_0 ) ; }".split(" ")}]},
{TYPE:"node",NAME:"SPECULAR_PHONG",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pV",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pW",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pY",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pZ",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",
TOKENS:"pZ = _0_0 ; if ( pV . g == _1_0 ) { vec3 p_ = normalize ( pU + oy ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:"if ( pX == _0_0 ) { pZ = dot ( B . xyz , p_ ) ; pZ = sqrt ( _1_0 - pZ * pZ ) ; }".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"pZ = ( _1_0 - pX ) * max ( dot ( pW , p_ ) , _0_0 ) + pX ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"pZ = pow ( pZ , pY [ 0 ] ) ; }".split(" ")}]},{TYPE:"node",NAME:"SPECULAR_COOKTORR",
NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qa",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qb",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qd",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qe",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qf",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"qf = _0_0 ; if ( qb . g != _0_0 ) { vec3 p_ = normalize ( qa + oy ) ;".split(" ")},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:"if ( qd == _0_0 ) { qf = dot ( B . xyz , p_ ) ; qf = sqrt ( _1_0 - qf * qf ) ; }".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"qf = max ( dot ( qc , p_ ) , _0_0 ) ; qf = ( _1_0 - qd ) * qf + qd ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:"float pz = max ( dot ( B . xyz , oy ) , _0_0 ) ; pz = sqrt ( _1_0 - pz * pz ) ;".split(" ")}]},
{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"float pz = max ( dot ( qc , oy ) , _0_0 ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"qf = pow ( qf , qe [ 0 ] ) ; qf = qf / ( 0.1 + pz ) ; }".split(" ")}]},{TYPE:"node",NAME:"SPECULAR_WARDISO",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qh",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qi",QUALIFIER:["vec3"],IS_OPTIONAL:!1},
{TYPE:"node_in",NAME:"qj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qk",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ql",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"ql = _0_0 ; if ( qh . g == _1_0 ) { vec3 p_ = normalize ( qg + oy ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:"float qm = _0_0 ; float pz = _0_0 ; float qn = _0_0 ; if ( qj == _0_0 ) { qm = dot ( B . xyz , p_ ) ; pz = dot ( B . xyz , oy ) ; qn = dot ( B . xyz , qg ) ; qm = sqrt ( _1_0 - qm * qm ) ; pz = sqrt ( _1_0 - pz * pz ) ; qn = sqrt ( _1_0 - qn * qn ) ; }".split(" ")}]},
{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"float qm = max ( dot ( qi , p_ ) , 0.01 ) ; float pz = max ( dot ( qi , oy ) , 0.01 ) ; float qn = max ( dot ( qi , qg ) , 0.01 ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"float bP = tan ( acos ( qm ) ) ; float L = max ( qk [ 0 ] , 0.01 ) ; ql = qn * ( _1_0 / ( 4.0 * M_PI * L * L ) ) * ( exp ( - ( bP * bP ) / ( L * L ) ) / ( sqrt ( pz * qn ) ) ) ; }".split(" ")}]},{TYPE:"node",NAME:"SPECULAR_TOON",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",
TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qo",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qr",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qu",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qw",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qx",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"qx = _0_0 ; if ( qr . g == _1_0 ) { vec3 co = normalize ( qo + oy ) ;".split(" ")},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:"float qy = dot ( co , B . xyz ) ; float bP = qw [ 0 ] + qw [ 1 ] ; if ( qv == _0_0 ) bP = acos ( sqrt ( _1_0 - qy * qy ) ) ;".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"float bP = acos ( dot ( co , qu ) ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"if ( bP < qw [ 0 ] ) qx = _1_0 ; else if ( bP >= qw [ 0 ] + qw [ 1 ] || qw [ 1 ] == _0_0 ) qx = _0_0 ; else qx = _1_0 - ( bP - qw [ 0 ] ) / qw [ 1 ] ; }".split(" ")}]},
{TYPE:"node",NAME:"SPECULAR_BLINN",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qz",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qA",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qC",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qD",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qE",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",
TOKENS:"float qF = qD [ 0 ] ; float qG = qD [ 1 ] ; qE = _0_0 ; if ( qA . g == _1_0 ) { if ( qF < _1_0 || qG == _0_0 ) qE = _0_0 ; else { if ( qG < 100.0 ) qG = sqrt ( _1_0 / qG ) ; else qG = 10.0 / qG ; vec3 p_ = normalize ( oy + qz ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:"float qm = _0_0 ; if ( qC == _0_0 ) { float qH = dot ( B . xyz , p_ ) ; qm = sqrt ( _1_0 - qH * qH ) ; }".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",
TOKENS:"float qm = ( _1_0 - qC ) * max ( dot ( qB , p_ ) , _0_0 ) + qC ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"if ( qm < _0_0 ) qE = _0_0 ; else { float pz = max ( dot ( qB , oy ) , 0.01 ) ; float qn = dot ( qB , qz ) ; if ( qn <= 0.01 ) qE = _0_0 ; else { float qI = max ( dot ( oy , p_ ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * qm * pz ) / qI ; float dx = ( 2.0 * qm * qn ) / qI ; float g = min ( min ( a , b ) , dx ) ; float p = sqrt ( pow ( qF , 2.0 ) + pow ( qI , 2.0 ) - _1_0 ) ; float mm = pow ( p - qI , 2.0 ) / pow ( p + qI , 2.0 ) * ( _1_0 + pow ( qI * ( p + qI ) - _1_0 , 2.0 ) / pow ( qI * ( p - qI ) + _1_0 , 2.0 ) ) ; float pT = acos ( qm ) ; qE = max ( mm * g * exp ( - pow ( pT , 2.0 ) / ( 2.0 * pow ( qG , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},
{TYPE:"node",NAME:"LIGHTING_APPLY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"qJ",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qP",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",
NAME:"qQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qS",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qT",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qU",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qV",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NODE_B4W_TRANSLUCENCY"],STATEMENTS:[{TYPE:"txt",TOKENS:"if ( dot ( qN , qO ) * dot ( oy , qO ) < _0_0 ) { float Fc = qP . x ; float Fd = qP . y ; float Fe = qP . z ; float Ff = qP . w ; float Fg = clamp ( abs ( dot ( qN , qO ) ) , _0_0 , _1_0 ) ; float Fh = clamp ( dot ( oy , - qN ) , _0_0 , _1_0 ) ; float Fi = pow ( Fh , Fd ) ; qU = qJ + qT * vec4 ( qS * Fg * pow ( qQ , vec3 ( Fc ) ) , _1_0 ) ; qU += Fe * mix ( vec4 ( qQ , _1_0 ) , vec4 ( _1_0 ) , Ff ) * qT * vec4 ( qS * Fg * vec3 ( Fi ) , _1_0 ) ; } else { qU = qJ + vec4 ( qS * qQ * qL , qM ) ; }".split(" ")}]},
{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"qU = qJ + vec4 ( qS * qQ * qL , qM ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"qV = qK + qS * qR * qM ;".split(" ")}]},{TYPE:"node",NAME:"RGB",NODE_VARS:[{TYPE:"node_var",NAME:"RGB_IND",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_out",NAME:"Fj",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"Fj = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{TYPE:"node",NAME:"RGBTOBW",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Fk",QUALIFIER:["vec3"],
IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Fl",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"Fl = dot ( Fk , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{TYPE:"node",NAME:"SEPRGB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Fm",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Fn",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fo",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fp",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",
PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fn"],STATEMENTS:[{TYPE:"txt",TOKENS:"Fn = Fm . r ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fo"],STATEMENTS:[{TYPE:"txt",TOKENS:"Fo = Fm . g ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fp"],STATEMENTS:[{TYPE:"txt",TOKENS:"Fp = Fm . b ;".split(" ")}]}]}]},{TYPE:"node",NAME:"SEPHSV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Fq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",
NAME:"Fr",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fs",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Ft",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:"vec3 Fu = kj ( Fq ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fr"],STATEMENTS:[{TYPE:"txt",TOKENS:"Fr = Fu . r ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fs"],STATEMENTS:[{TYPE:"txt",TOKENS:"Fs = Fu . g ;".split(" ")}]}]},{TYPE:"node_cond",
PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ft"],STATEMENTS:[{TYPE:"txt",TOKENS:"Ft = Fu . b ;".split(" ")}]}]}]},{TYPE:"node",NAME:"SQUEEZE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Fv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Fw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Fx",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Fy",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"Fy = _1_0 / ( _1_0 + pow ( 2.71828183 , - ( Fv - Fx ) * Fw ) ) ;".split(" ")}]},
{TYPE:"node",NAME:"GAMMA",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Fz",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"FA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FB",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"FB = Fz ; if ( FB . x > _0_0 ) FB . x = pow ( Fz . x , FA ) ; if ( FB . y > _0_0 ) FB . y = pow ( Fz . y , FA ) ; if ( FB . z > _0_0 ) FB . z = pow ( Fz . z , FA ) ;".split(" ")}]},{TYPE:"node",NAME:"B4W_SRGB_TO_LINEAR",NODE_VARS:[],
DECLARATIONS:[{TYPE:"node_in",NAME:"FC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FD",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"FD = max ( vec3 ( _0_0 ) , FC ) ; FD = pow ( FD , vec3 ( 2.2 ) ) ;".split(" ")}]},{TYPE:"node",NAME:"B4W_LINEAR_TO_SRGB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"FE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FF",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"FF = max ( vec3 ( _0_0 ) , FE ) ; FF = pow ( FF , vec3 ( _1_0 / 2.2 ) ) ;".split(" ")}]},
{TYPE:"node",NAME:"TEXTURE_EMPTY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"FG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FI",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FG"],STATEMENTS:[{TYPE:"txt",TOKENS:"FG = vec3 ( _0_0 ) ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FH"],STATEMENTS:[{TYPE:"txt",TOKENS:"FH = vec3 ( _0_0 ) ;".split(" ")}]}]},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FI"],STATEMENTS:[{TYPE:"txt",TOKENS:["FI","=","_0_0",";"]}]}]}]},{TYPE:"node",NAME:"TEXTURE_ENVIRONMENT_CUBE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"FJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FK",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"FL",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"node_TEXTURE_ENVIRONMENT_CUBE_var_texture",QUALIFIER:["uniform","samplerCube"],IS_OPTIONAL:!1}],
STATEMENTS:[{TYPE:"txt",TOKENS:"vec3 FM = vec3 ( FJ . x , FJ . y , FJ . z ) ; vec4 BN = GLSL_TEXTURE_CUBE ( node_TEXTURE_ENVIRONMENT_CUBE_var_texture , FM ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FK"],STATEMENTS:[{TYPE:"txt",TOKENS:"FK = BN . xyz ; bG ( FK ) ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FL"],STATEMENTS:[{TYPE:"txt",TOKENS:"FL = BN . w ;".split(" ")}]}]}]},{TYPE:"node",NAME:"TEXTURE_ENVIRONMENT_EQUIRECTANGULAR",
NODE_VARS:[{TYPE:"node_var",NAME:"USE_VECTOR_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"FN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"node_TEXTURE_ENVIRONMENT_EQUIRECTANGULAR_var_texture",QUALIFIER:["uniform","sampler2D"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_VECTOR_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:"vec3 FP = normalize ( FN ) ;".split(" ")}]},{TYPE:"node_elif",
EXPRESSION:["IS_WORLD"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","FP","=","sJ",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","FP","=","ox",";"]}]}]},{TYPE:"txt",TOKENS:"float dF = - atan ( FP . y , FP . x ) / ( 2.0 * M_PI ) + _0_5 ; float kU = atan ( FP . z , sqrt ( FP . x * FP . x + FP . y * FP . y ) ) / M_PI + _0_5 ; vec4 BN = GLSL_TEXTURE ( node_TEXTURE_ENVIRONMENT_EQUIRECTANGULAR_var_texture , vec2 ( dF , kU ) ) ; FO = BN . xyz ; bG ( FO ) ;".split(" ")}]},{TYPE:"node",NAME:"TEXTURE_ENVIRONMENT_MIRROR_BALL",
NODE_VARS:[{TYPE:"node_var",NAME:"USE_VECTOR_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"FQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"node_TEXTURE_ENVIRONMENT_MIRROR_BALL_var_texture",QUALIFIER:["uniform","sampler2D"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_VECTOR_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:"vec3 FP = normalize ( FQ ) ;".split(" ")}]},{TYPE:"node_elif",
EXPRESSION:["IS_WORLD"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","FP","=","sJ",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","FP","=","ox",";"]}]}]},{TYPE:"txt",TOKENS:"FP . y -= _1_0 ; float FS = 2.0 * sqrt ( max ( - _0_5 * FP . y , _0_0 ) ) ; if ( FS > _0_0 ) FP /= FS ; float dF = _0_5 * ( FP . x + _1_0 ) ; float kU = _0_5 * ( FP . z + _1_0 ) ; vec4 BN = GLSL_TEXTURE ( node_TEXTURE_ENVIRONMENT_MIRROR_BALL_var_texture , vec2 ( dF , kU ) ) ; FR = BN . xyz ; bG ( FR ) ;".split(" ")}]},
{TYPE:"node",NAME:"TEXTURE_COLOR",NODE_VARS:[{TYPE:"node_var",NAME:"NON_COLOR",TOKENS:["0"]},{TYPE:"node_var",NAME:"CONVERT_UV",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv2",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv3",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv4",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"FT",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"FU",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"FV",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"FW",
QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"FX",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"FY",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"FZ",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"F_",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Ga",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gb",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gc",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gd",QUALIFIER:["float"],
IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"node_TEXTURE_COLOR_var_texture",QUALIFIER:["uniform","sampler2D"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_UV"],STATEMENTS:[{TYPE:"txt",TOKENS:"vec4 BN = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , so ( FT ) ) ;".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"vec4 BN = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , FT . xy ) ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FX"],
STATEMENTS:[{TYPE:"txt",TOKENS:"FX = BN . xyz ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NON_COLOR",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"txt",TOKENS:["bG","(","FX",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FY"],STATEMENTS:[{TYPE:"txt",TOKENS:"FY = BN . w ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv2"],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_UV"],
STATEMENTS:[{TYPE:"txt",TOKENS:"BN = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , so ( FU ) ) ;".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"BN = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , FU . xy ) ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FZ"],STATEMENTS:[{TYPE:"txt",TOKENS:"FZ = BN . xyz ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NON_COLOR",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"txt",
TOKENS:["bG","(","FZ",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_F_"],STATEMENTS:[{TYPE:"txt",TOKENS:"F_ = BN . w ;".split(" ")}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv3"],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_UV"],STATEMENTS:[{TYPE:"txt",TOKENS:"BN = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , so ( FV ) ) ;".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"BN = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , FV . xy ) ;".split(" ")}]}]},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ga"],STATEMENTS:[{TYPE:"txt",TOKENS:"Ga = BN . xyz ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NON_COLOR",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"txt",TOKENS:["bG","(","Ga",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gb"],STATEMENTS:[{TYPE:"txt",TOKENS:"Gb = BN . w ;".split(" ")}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv4"],STATEMENTS:[{TYPE:"node_cond",
PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_UV"],STATEMENTS:[{TYPE:"txt",TOKENS:"BN = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , so ( FW ) ) ;".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"BN = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , FW . xy ) ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gc"],STATEMENTS:[{TYPE:"txt",TOKENS:"Gc = BN . xyz ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NON_COLOR",{TYPE:"logic_negative_expr",
PLACES:1}],STATEMENTS:[{TYPE:"txt",TOKENS:["bG","(","Gc",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gd"],STATEMENTS:[{TYPE:"txt",TOKENS:"Gd = BN . w ;".split(" ")}]}]}]}]}]},{TYPE:"node",NAME:"TEXTURE_NORMAL",NODE_VARS:[{TYPE:"node_var",NAME:"USE_uv2",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv3",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv4",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ge",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"Gf",QUALIFIER:["vec3"],
IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"Gg",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"Gh",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gi",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gj",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gk",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gl",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gm",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gn",QUALIFIER:["float"],IS_OPTIONAL:!0},
{TYPE:"node_out",NAME:"Go",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gp",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"node_TEXTURE_NORMAL_var_texture",QUALIFIER:["uniform","sampler2D"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"vec4 BN = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , so ( Ge ) ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gi"],STATEMENTS:[{TYPE:"txt",TOKENS:"Gi = normalize ( sO * ( BN . xyz - _0_5 ) ) ;".split(" ")}]}]},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gj"],STATEMENTS:[{TYPE:"txt",TOKENS:"Gj = BN . w ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv2"],STATEMENTS:[{TYPE:"txt",TOKENS:"BN = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , so ( Gf ) ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gk"],STATEMENTS:[{TYPE:"txt",TOKENS:"Gk = normalize ( sO * ( BN . xyz - _0_5 ) ) ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",
EXPRESSION:["USE_OUT_Gl"],STATEMENTS:[{TYPE:"txt",TOKENS:"Gl = BN . w ;".split(" ")}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv3"],STATEMENTS:[{TYPE:"txt",TOKENS:"BN = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , so ( Gg ) ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gm"],STATEMENTS:[{TYPE:"txt",TOKENS:"Gm = normalize ( sO * ( BN . xyz - _0_5 ) ) ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gn"],STATEMENTS:[{TYPE:"txt",
TOKENS:"Gn = BN . w ;".split(" ")}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv4"],STATEMENTS:[{TYPE:"txt",TOKENS:"BN = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , so ( Gh ) ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Go"],STATEMENTS:[{TYPE:"txt",TOKENS:"Go = normalize ( sO * ( BN . xyz - _0_5 ) ) ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gp"],STATEMENTS:[{TYPE:"txt",TOKENS:"Gp = BN . w ;".split(" ")}]}]}]}]}]},
{TYPE:"node",NAME:"VALUE",NODE_VARS:[{TYPE:"node_var",NAME:"VALUE_ROW_IND",TOKENS:["0"]},{TYPE:"node_var",NAME:"VALUE_COL_IND",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_out",NAME:"Gq",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"Gq = u_node_values [ VALUE_ROW_IND ] [ VALUE_COL_IND ] ;".split(" ")}]},{TYPE:"node",NAME:"VECT_MATH_ADD",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Gr",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Gs",QUALIFIER:["vec3"],IS_OPTIONAL:!1},
{TYPE:"node_out",NAME:"Gt",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Gu",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:"Gt = Gr + Gs ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gu"],STATEMENTS:[{TYPE:"txt",TOKENS:"Gu = ( abs ( Gt [ 0 ] ) + abs ( Gt [ 1 ] ) + abs ( Gt [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{TYPE:"node",NAME:"VECT_MATH_SUBTRACT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Gv",QUALIFIER:["vec3"],IS_OPTIONAL:!1},
{TYPE:"node_in",NAME:"Gw",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Gx",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Gy",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:"Gx = Gv - Gw ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gy"],STATEMENTS:[{TYPE:"txt",TOKENS:"Gy = ( abs ( Gx [ 0 ] ) + abs ( Gx [ 1 ] ) + abs ( Gx [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{TYPE:"node",NAME:"VECT_MATH_AVERAGE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",
NAME:"Gz",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GA",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GC",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:"GB = Gz + GA ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_GC"],STATEMENTS:[{TYPE:"txt",TOKENS:"GC = length ( GB ) ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_GB"],STATEMENTS:[{TYPE:"txt",
TOKENS:"GB = normalize ( GB ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"VECT_MATH_DOT_PRODUCT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"GD",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GG",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:"GF = vec3 ( _0_0 ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_GG"],
STATEMENTS:[{TYPE:"txt",TOKENS:"GG = dot ( GD , GE ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"VECT_MATH_CROSS_PRODUCT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"GH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GI",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GK",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:"GJ = cross ( GH , GI ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",
EXPRESSION:["USE_OUT_GK"],STATEMENTS:[{TYPE:"txt",TOKENS:"GK = length ( GJ ) ; GJ /= GK ;".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"GJ = normalize ( GJ ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"VECT_MATH_NORMALIZE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"GL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GM",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GO",QUALIFIER:["float"],IS_OPTIONAL:!0}],
STATEMENTS:[{TYPE:"txt",TOKENS:"GN = normalize ( GL ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_GO"],STATEMENTS:[{TYPE:"txt",TOKENS:"GO = length ( GL ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:["GM",";"]}]},{TYPE:"node",NAME:"FRESNEL",NODE_VARS:[{TYPE:"node_var",NAME:"USE_FRESNEL_NORMAL",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"GP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GR",QUALIFIER:["float"],
IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_FRESNEL_NORMAL"],STATEMENTS:[{TYPE:"txt",TOKENS:"vec3 cw = normalize ( GQ ) ;".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","cw","=","ox",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CAMERA_TYPE","CAM_TYPE_PERSP",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"vec3 Bp = normalize ( oy ) ;".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vec3",
"Bp","=","u_camera_direction",";"]}]}]},{TYPE:"txt",TOKENS:"float su = max ( GP , 0.00001 ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"su = gl_FrontFacing == false ? su : _1_0 / su ;".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"su = gl_FrontFacing ? su : _1_0 / su ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"GR = sv ( Bp , cw , su ) ;".split(" ")}]},{TYPE:"node",
NAME:"BACKGROUND",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"GS",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GT",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GU",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"GU = GS * GT ;".split(" ")}]},{TYPE:"node",NAME:"B4W_REFLECT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"GV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GW",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GX",
QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"GX = reflect ( _ ( u_view_tsr_inverse , GV ) , GW ) ;".split(" ")}]},{TYPE:"node",NAME:"B4W_REFLECT_WORLD",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"GY",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"GZ = reflect ( - oy . xyz , GY ) ;".split(" ")}]},{TYPE:"node",NAME:"B4W_PARALLAX",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"G_",QUALIFIER:["vec3"],
IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ha",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hb",QUALIFIER:["const","float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hc",QUALIFIER:["const","float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Hd",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"node_B4W_PARALLAX_var_texture",QUALIFIER:["uniform","sampler2D"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float bS = length ( sR ) ; if ( bS < Hc ) { vec2 ce = so ( G_ ) ; float ci = clamp ( _0_5 * ( Hc - bS ) , _0_0 , _1_0 ) ; float hK = Ha * ci ; vec3 ck = normalize ( oy * sO ) ; float cl = _1_0 / Hb ; vec2 cm = ck . xy * hK / ( Hb * ck . z ) ; float cn = _1_0 ; float co = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , ce ) . a ; for ( float cq = 1.0 ; cq <= Hb ; cq ++ ) { if ( co < cn ) { cn -= cl ; ce -= cm ; co = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , ce ) . a ; } } vec2 cr = ce + cm ; float cs = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , cr ) . a - ( cn + cl ) ; float ct = co - cn ; float cu = ct / ( ct - cs ) ; ce = cu * cr + ( _1_0 - cu ) * ce ; Hd = sn ( ce ) ; } else Hd = G_ ;".split(" ")}]},
{TYPE:"node",NAME:"B4W_CLAMP",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"He",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Hf",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"Hf = clamp ( He , _0_0 , _1_0 ) ;".split(" ")}]},{TYPE:"node",NAME:"B4W_REFRACTION",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Hg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hh",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Hi",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],
STATEMENTS:[{TYPE:"txt",TOKENS:"Hi = sm ( Hg , Hh ) ;".split(" ")}]},{TYPE:"node",NAME:"B4W_TRANSLUCENCY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Hj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hk",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hl",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hm",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ho",QUALIFIER:["float"],IS_OPTIONAL:!0},
{TYPE:"node_out",NAME:"Hp",QUALIFIER:["vec4"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ho"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ho","=","Hj",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Hp"],STATEMENTS:[{TYPE:"txt",TOKENS:"Hp = vec4 ( Hk , Hl , Hm , Hn ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"B4W_TIME",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"Hq",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Hq",
"=","u_time",";"]}]},{TYPE:"node",NAME:"B4W_SMOOTHSTEP",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Hr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hs",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ht",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Hu",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"Hu = smoothstep ( Hs , Ht , Hr ) ;".split(" ")}]},{TYPE:"node",NAME:"B4W_GLOW_OUTPUT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Hv",
QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hw",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"E = Hv ; I = Hw ;".split(" ")}]},{TYPE:"node",NAME:"B4W_VECTOSCAL",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Hx",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Hy",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"Hy = ( Hx . r + Hx . g + Hx . b ) / 3.0 ;".split(" ")}]},{TYPE:"node",NAME:"B4W_SCALTOVEC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",
NAME:"Hz",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"HA",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"HA [ 0 ] = Hz ; HA [ 1 ] = Hz ; HA [ 2 ] = Hz ;".split(" ")}]},{TYPE:"nodes_global"},{TYPE:"txt",TOKENS:"void J ( in vec3 oy , out vec3 E , out vec3 F , out vec3 G , out vec4 H , out float I ) { E = vec3 ( _0_0 ) ; F = vec3 ( _0_0 ) ; G = vec3 ( _0_0 ) ; H = vec4 ( _0_0 ) ; I = _0_0 ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["IS_WORLD"],GROUP:{TYPE:"grp",
PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_TEXTURE_ENVIRONMENT_EQUIRECTANGULAR","USE_NODE_TEXTURE_ENVIRONMENT_MIRROR_BALL","USE_NODE_TEX_COORD_GE","USE_NODE_TEX_COORD_OB",{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 sJ = - oy ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_GL"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 ow = - oy ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_TEX_COORD_NO"],
GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ox","=","oy",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_NO"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sK","=","oy",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_NORMAL_MAP","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT",
"USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:11}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sL","=","j",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"if ( gl_FrontFacing == false )".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:["if","(","gl_FrontFacing",")"]}]}}]},{TYPE:"txt",TOKENS:"sL = sL ; else sL = - sL ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_NORMAL_MAP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sM","=","sL",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 sN = normalize ( sL ) ;".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DOUBLE_SIDED_LIGHTING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ox","=","sN",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 ox = normalize ( j ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_NO"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sK","=","sN",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",
EXPRESSION:["USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 W = cross ( sN , k . xyz ) * k . w ; mat3 sO = mat3 ( k . xyz , W , sN ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_NORMAL_MAP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 sP = cross ( sL , k . xyz ) * k . w ; mat3 sQ = mat3 ( k . xyz , sP , sL ) ;".split(" ")}]}}]}]}}]},{TYPE:"txt",TOKENS:"vec3 ow = h ; vec4 sR = i ; float sS = u_emit ; float sT = u_ambient ;".split(" ")}]}}]},
{TYPE:"nodes_main"},{TYPE:"txt",TOKENS:["}"]}]}}]}]};e["include/nodes.glslv"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"NODES_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"NODES_GLSLV",TOKENS:[""]},{TYPE:"var",NAME:"PARTICLE_BATCH",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{TYPE:"logical_or_expr",PLACES:2},"PARTICLE_BATCH",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:"GLSL_IN vec3 a_orco_tex_coord ; GLSL_OUT vec3 sj ;".split(" ")}]}}]},{TYPE:"node",NAME:"TEX_COORD_UV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_param",NAME:"node_TEX_COORD_UV_var_a_uv",QUALIFIER:["GLSL_IN","vec2"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sD",QUALIFIER:["GLSL_OUT","vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["sD","=","node_TEX_COORD_UV_var_a_uv",";"]}]},{TYPE:"node",NAME:"UV_MERGED",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_param",NAME:"node_UV_MERGED_var_a_uv",
QUALIFIER:["GLSL_IN","vec2"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sC",QUALIFIER:["GLSL_OUT","vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["sC","=","node_UV_MERGED_var_a_uv",";"]}]},{TYPE:"node",NAME:"UVMAP",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_param",NAME:"node_UVMAP_var_a_uv",QUALIFIER:["GLSL_IN","vec2"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sE",QUALIFIER:["GLSL_OUT","vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["sE","=","node_UVMAP_var_a_uv",";"]}]},{TYPE:"node",NAME:"GEOMETRY_UV",
NODE_VARS:[],DECLARATIONS:[{TYPE:"node_param",NAME:"node_GEOMETRY_UV_var_a_uv",QUALIFIER:["GLSL_IN","vec2"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sw",QUALIFIER:["GLSL_OUT","vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["sw","=","node_GEOMETRY_UV_var_a_uv",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_param",NAME:"node_GEOMETRY_VC_var_a_vertex_color",QUALIFIER:["GLSL_IN","vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"HB",QUALIFIER:["GLSL_OUT","vec3"],
IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["HB","=","node_GEOMETRY_VC_var_a_vertex_color",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC1",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_param",NAME:"node_GEOMETRY_VC1_var_a_vertex_color",QUALIFIER:["GLSL_IN","float"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"HC",QUALIFIER:["GLSL_OUT","float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["HC","=","node_GEOMETRY_VC1_var_a_vertex_color",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC2",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_param",
NAME:"node_GEOMETRY_VC2_var_a_vertex_color",QUALIFIER:["GLSL_IN","vec2"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"HD",QUALIFIER:["GLSL_OUT","vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["HD","=","node_GEOMETRY_VC2_var_a_vertex_color",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC3",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_param",NAME:"node_GEOMETRY_VC3_var_a_vertex_color",QUALIFIER:["GLSL_IN","vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"HE",QUALIFIER:["GLSL_OUT","vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",
TOKENS:["HE","=","node_GEOMETRY_VC3_var_a_vertex_color",";"]}]},{TYPE:"nodes_global"},{TYPE:"txt",TOKENS:["void","J","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["sj","=","a_orco_tex_coord",";"]}]}}]},{TYPE:"nodes_main"},{TYPE:"txt",TOKENS:["}"]}]}}]}]};e["include/pack.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"PACK_GLSLF",GROUP:{TYPE:"grp",
PARTS:[{TYPE:"define",NAME:"PACK_GLSLF",TOKENS:[""]},{TYPE:"txt",TOKENS:"vec4 eu ( const in float iq ) { vec4 fu = vec4 ( _255_0 * _255_0 * _255_0 , _255_0 * _255_0 , _255_0 , _1_0 ) ; vec4 HF = vec4 ( _0_0 , _1_0 / _255_0 , _1_0 / _255_0 , _1_0 / _255_0 ) ; vec4 jF = fract ( iq * fu ) ; jF -= jF . xxyz * HF ; return jF ; } float cV ( const in vec4 HG ) { float et ; vec4 fu = vec4 ( _1_0 / ( _255_0 * _255_0 * _255_0 ) , _1_0 / ( _255_0 * _255_0 ) , _1_0 / _255_0 , _1_0 ) ; et = dot ( HG , fu ) ; return et ; } vec4 eu ( const in vec2 rk ) { vec2 fu = vec2 ( _255_0 , _1_0 ) ; vec2 HF = vec2 ( _0_0 , _1_0 / _255_0 ) ; vec4 jF = fract ( rk . xxyy * fu . xyxy ) ; jF -= jF . xxzz * HF . xyxy ; if ( rk . r == _1_0 ) jF . rg = vec2 ( _0_0 , _1_0 ) ; if ( rk . g == _1_0 ) jF . ba = vec2 ( _0_0 , _1_0 ) ; return jF ; } vec2 jk ( const in vec4 HH ) { vec2 rk ; vec2 fu = vec2 ( _1_0 / _255_0 , _1_0 ) ; rk . r = dot ( HH . rg , fu ) ; rk . g = dot ( HH . ba , fu ) ; return rk ; }".split(" ")}]}}]}]};
e["include/particles.glslv"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"PARTICLES_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"PARTICLES_GLSLV",TOKENS:[""]},{TYPE:"var",NAME:"EPSILON",TOKENS:["0.000001"]},{TYPE:"var",NAME:"COLOR_RAMP_LENGTH",TOKENS:["0"]},{TYPE:"var",NAME:"WORLD_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_COLOR_RAMP",TOKENS:["0"]},{TYPE:"include",FILE:"math.glslv"},{TYPE:"txt",TOKENS:"struct dc { float di ; vec3 O ; float L ; vec3 aQ ; float bP ; vec3 dp ; vec3 dq ; float dr ; } ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COLOR_RAMP_LENGTH",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"void HL ( inout vec3 aQ , float HI , vec4 kf , vec4 bz ) { float HJ = bz . x - kf . x ; float HK = ( HI - kf . x ) / HJ ; aQ = mix ( aQ , bz . yzw , clamp ( HK , 0.0 , 1.0 ) ) ; }".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COLOR_RAMP_LENGTH",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 HO ( float t , float HM , vec4 HN [ COLOR_RAMP_LENGTH ] ) { float HI = t / HM ; vec3 aQ = HN [ 0 ] . yzw ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COLOR_RAMP_LENGTH",1,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"HL ( aQ , HI , HN [ 0 ] , HN [ 1 ] ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COLOR_RAMP_LENGTH",2,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"HL ( aQ , HI , HN [ 1 ] , HN [ 2 ] ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COLOR_RAMP_LENGTH",3,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:"HL ( aQ , HI , HN [ 2 ] , HN [ 3 ] ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["return","aQ",";","}"]}]}}]},{TYPE:"txt",TOKENS:"float HU ( float t , float HM , float HP , float HQ ) { float HR = max ( 0.01 , min ( HM , HP ) ) ; float HS = max ( 0.01 , min ( HM , HQ ) ) ; float HT = HM - HS ; float L = clamp ( t / HR , 0.0 , 1.0 ) - step ( HT , t ) * ( t - HT ) / HS ; return L ; } dc dd ( ) { dc sp ; float t ; float HM = a_p_data [ 0 ] ; float HV = a_p_data [ 1 ] ; if ( u_p_cyclic == 1 ) { t = mod ( u_p_time , u_p_length ) - HV ; if ( t < 0.0 ) t += u_p_length ; } if ( u_p_cyclic != 1 ) { t = u_p_time - HV ; } if ( t < 0.0 || t >= HM ) { sp . di = 0.0001 ; sp . O = vec3 ( 99999.0 , 0.0 , 0.0 ) ; } if ( ! ( t < 0.0 || t >= HM ) ) { vec4 S = R ( a_tbn ) ; vec3 ca = T ( S , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WORLD_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 fr = a_position ; vec3 rz = ca ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 fr = ap ( u_model_tsr , a_position ) ; vec3 rz = bI ( u_model_tsr , ca ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"vec3 HW = u_p_nfactor * rz ; HW += a_p_vels . xyz ; HW . z -= u_p_gravity * t / 2.0 ; float HX = max ( u_p_mass , EPSILON ) ; HW += ( u_p_wind_fac * u_wind / HX ) * t / 2.0 ; sp . dr = t ; sp . dp = HW ; sp . dq = ca * a_p_vels . w ; sp . O = fr + HW * t ; sp . bP = a_p_vels . w * t ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_COLOR_RAMP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"sp . di = GLSL_TEXTURE ( u_color_ramp_tex , vec2 ( t / u_p_max_lifetime , 0.5 ) ) . g ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"sp . di = 1.0 ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COLOR_RAMP_LENGTH",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"sp . aQ = HO ( t , u_p_max_lifetime , u_p_color_ramp ) ;".split(" ")}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"sp . aQ = vec3 ( 1.0 ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"sp . L = HU ( t , a_p_data [ 0 ] , u_p_fade_in , u_p_fade_out ) ; } return sp ; }".split(" ")}]}}]}]};e["include/particles_nodes.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"PARTICLES_NODES_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"PARTICLES_NODES_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"CAUSTICS",TOKENS:["0"]},{TYPE:"var",NAME:"DOUBLE_SIDED_LIGHTING",
TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_PASS",TOKENS:["REFL_PASS_NONE"]},{TYPE:"var",NAME:"PARTICLE_BATCH",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_BSDF_BEGIN",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"environment.glslf"}]}}]},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"cond",
PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{TYPE:"logical_or_expr",PLACES:6}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 kj ( vec3 rgb ) { vec4 hM = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , hM . wz ) , vec4 ( rgb . gb , hM . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float dC = q . x - min ( q . w , q . y ) ; float iF = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * dC + iF ) ) , dC / ( q . x + iF ) , q . x ) ; }".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{TYPE:"logical_or_expr",PLACES:6}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 kl ( vec3 kk ) { vec4 hM = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( kk . r , kk . r , kk . r ) + hM . xyz ) * 6.0 - hM . www ) ; return kk . b * mix ( hM . xxx , clamp ( p - hM . xxx , _0_0 , _1_0 ) , kk . g ) ; }".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 sn ( vec2 gX ) { return vec3 ( gX * 2.0 - vec2 ( _1_0 , _1_0 ) , _0_0 ) ; }".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec2 so ( vec3 rk ) { return vec2 ( rk . xy * _0_5 + vec2 ( _0_5 , _0_5 ) ) ; }".split(" ")}]}}]},
{TYPE:"node",NAME:"CAMERA",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"sU",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"sV",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"sW",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_sU"],STATEMENTS:[{TYPE:"txt",TOKENS:"sU = normalize ( sR . xyz ) ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_sV"],STATEMENTS:[{TYPE:"txt",TOKENS:"sV = abs ( sR . z ) ;".split(" ")}]}]},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_sW"],STATEMENTS:[{TYPE:"txt",TOKENS:"sW = length ( sR . xyz ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"COMBRGB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"sX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"sY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"sZ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"s_",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"s_ = vec3 ( sX , sY , sZ ) ;".split(" ")}]},
{TYPE:"node",NAME:"COMBHSV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"ta",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tc",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"td",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"td = kl ( vec3 ( ta , tb , tc ) ) ;".split(" ")}]},{TYPE:"node",NAME:"EMPTY_UV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"te",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],
STATEMENTS:[{TYPE:"txt",TOKENS:"te = vec3 ( - _1_0 , - _1_0 , _0_0 ) ;".split(" ")}]},{TYPE:"node",NAME:"EMPTY_VC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tf",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"tf = vec3 ( _0_0 ) ;".split(" ")}]},{TYPE:"node",NAME:"GEOMETRY_UV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tg",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"tg = sn ( A ) ;".split(" ")}]},{TYPE:"node",NAME:"GEOMETRY_OR",NODE_VARS:[],
DECLARATIONS:[{TYPE:"node_out",NAME:"th",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"th = 2.0 * vec3 ( A , _0_0 ) - vec3 ( _1_0 ) ;".split(" ")}]},{TYPE:"node",NAME:"GEOMETRY_VC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"ti",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"ti = vec3 ( _1_0 ) ;".split(" ")}]},{TYPE:"node",NAME:"GEOMETRY_VC1",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tj",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",
TOKENS:["tj","=","_1_0",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC2",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tk",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tl",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"tk = _1_0 ; tl = _1_0 ;".split(" ")}]},{TYPE:"node",NAME:"GEOMETRY_VC3",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tm",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"to",
QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"tm = _1_0 ; tn = _1_0 ; to = _1_0 ;".split(" ")}]},{TYPE:"node",NAME:"GEOMETRY_NO",NODE_VARS:[{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"tr",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tu",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["tu","=","tr",";"]}]},{TYPE:"node_else",
STATEMENTS:[{TYPE:"txt",TOKENS:"tu = sK . xyz ;".split(" ")}]}]}]},{TYPE:"node",NAME:"GEOMETRY_FB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tv",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"tv = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"tv = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]}]}]},
{TYPE:"node",NAME:"GEOMETRY_VW",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tx",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"tx = - _ ( u_view_tsr_frag , oy ) ;".split(" ")}]},{TYPE:"node",NAME:"GEOMETRY_LO",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"ty",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"ty [ 0 ] = sR [ 0 ] ; ty [ 1 ] = sR [ 1 ] ; ty [ 2 ] = sR [ 2 ] ;".split(" ")}]},{TYPE:"node",NAME:"GEOMETRY_GL",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",
NAME:"tz",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"tz = vec3 ( ow . r , ow . g , ow . b ) ;".split(" ")}]},{TYPE:"node",NAME:"NEW_GEOMETRY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tD",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},
{TYPE:"node_out",NAME:"tG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tI",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"tB = vec3 ( _0_0 ) ; tC = vec3 ( _0_0 ) ; tD = vec3 ( _0_0 ) ; tE = vec3 ( _0_0 ) ; tF = vec3 ( _0_0 ) ; tG = vec3 ( _0_0 ) ; tH = _0_0 ; tI = _0_0 ;".split(" ")}]},{TYPE:"node",NAME:"HUE_SAT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"tJ",QUALIFIER:["float"],IS_OPTIONAL:!1},
{TYPE:"node_in",NAME:"tK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tO",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"vec3 kk = kj ( tN ) ; kk [ 0 ] += ( tJ - _0_5 ) ; if ( kk [ 0 ] > _1_0 ) kk [ 0 ] -= _1_0 ; else if ( kk [ 0 ] < _0_0 ) kk [ 0 ] += _1_0 ; kk *= vec3 ( _1_0 , tK , tL ) ; kk = mix ( vec3 ( _1_0 ) , mix ( vec3 ( _0_0 ) , kk , step ( vec3 ( _0_0 ) , kk ) ) , step ( kk , vec3 ( _1_0 ) ) ) ; tO = mix ( tN , kl ( kk ) , tM ) ;".split(" ")}]},
{TYPE:"node",NAME:"INVERT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"tP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tR",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"tR = mix ( tQ , vec3 ( _1_0 ) - tQ , tP ) ;".split(" ")}]},{TYPE:"node",NAME:"LAMP",NODE_VARS:[{TYPE:"node_var",NAME:"LAMP_TYPE",TOKENS:["HEMI"]},{TYPE:"node_var",NAME:"LAMP_INDEX",TOKENS:["0"]},{TYPE:"node_var",NAME:"LAMP_USE_SPHERE",
TOKENS:["0"]},{TYPE:"node_var",NAME:"LAMP_SPOT_SIZE",TOKENS:["0.8"]},{TYPE:"node_var",NAME:"LAMP_SPOT_BLEND",TOKENS:["0.03"]},{TYPE:"node_var",NAME:"LAMP_LIGHT_DIST",TOKENS:["30.0"]}],DECLARATIONS:[{TYPE:"node_out",NAME:"tS",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"tT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tV",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",
EXPRESSION:["USE_OUT_tS"],STATEMENTS:[{TYPE:"txt",TOKENS:"tS = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"vec3 tW = u_lamp_light_directions [ LAMP_INDEX ] ; vec3 tX = u_lamp_light_positions [ LAMP_INDEX ] ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2},"LAMP_TYPE","POINT",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"tT = - h + tX ; tU = length ( tT ) ; tT = normalize ( tT ) ;".split(" ")},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tV"],STATEMENTS:[{TYPE:"txt",TOKENS:"tV = LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + tU * tU ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"float pb = dot ( tT , tW ) ; pb *= smoothstep ( _0_0 , _1_0 , ( pb - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; tV *= pb ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_USE_SPHERE"],
STATEMENTS:[{TYPE:"txt",TOKENS:"tV *= max ( LAMP_LIGHT_DIST - tU , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]}]}]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tT"],STATEMENTS:[{TYPE:"txt",TOKENS:["tT","=","tW",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tU"],STATEMENTS:[{TYPE:"txt",TOKENS:"tU = length ( tX - h ) ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tV"],STATEMENTS:[{TYPE:"txt",
TOKENS:["tV","=","_1_0",";"]}]}]}]}]}]},{TYPE:"node",NAME:"NORMAL",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"tY",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tZ",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"t_",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"sB",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tZ"],STATEMENTS:[{TYPE:"txt",TOKENS:["tZ","=","sB",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",
EXPRESSION:["USE_OUT_t_"],STATEMENTS:[{TYPE:"txt",TOKENS:"t_ = - dot ( tY , sB ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"B4W_VECTOR_VIEW",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"ua",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ub",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"ub = - _ ( u_view_tsr_frag , ua ) ;".split(" ")}]},{TYPE:"node",NAME:"BSDF_BEGIN",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"uc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",
NAME:"ud",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ue",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uf",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ug",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uh",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ui",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ul",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"um",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"un",
QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uo",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"up",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ur",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"us",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ut",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uu",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uw",QUALIFIER:["vec4"],
IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ux",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uy",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uz",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uC",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"ur = ud ; us = uf ; ut = ui ; ux = ud ; uy = uf ; metalness_out = uh ; uz = ul ; uA = um ; uB = un ; uC = uo ; up = sS * ur ; uq = sT * u_environment_energy * cE ( ut ) ; uw = cH ( ur ) ; H = uw ; uu [ 0 ] = ue ; uu [ 1 ] = ug ; uu [ 2 ] = uh ;".split(" ")}]},
{TYPE:"node",NAME:"BSDF_END",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"uD",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uG",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uI",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uL",
QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uM",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uN",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uO",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"uO = uD . rgb + uE ; uO = mix ( uO , uK , uL ) ; I = _1_0 ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NODE_BSDF_TRANSPARENT"],STATEMENTS:[{TYPE:"txt",TOKENS:"vec3 uR = GLSL_TEXTURE ( u_refractmap , l . xy / l . z ) . rgb ; bG ( uR ) ; uM = uM * uR ; uO += uM ;".split(" ")}]}]},
{TYPE:"txt",TOKENS:["uF",";"]}]},{TYPE:"node",NAME:"BSDF_COMPUTE",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"uY",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uZ",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"u_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"va",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vb",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vc",QUALIFIER:["float"],
IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vd",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"vec3 rz = u_ ; float uU = clamp ( vb [ 0 ] , _0_0 , _1_0 ) ; float uQ = clamp ( vb [ 1 ] , _0_0 , _1_0 ) ; float rW = vb [ 2 ] ; vec3 p_ = normalize ( oy + uY ) ; float pj = ( _1_0 - va ) * dot ( rz , uY ) + va ; float vf = ( _1_0 - va ) * max ( dot ( uY , p_ ) , _0_0 ) + va ; float vg = ( _1_0 - va ) * max ( dot ( u_ , p_ ) , _0_0 ) + va ; vc = _0_0 ; if ( uZ . r != _0_0 ) { if ( uU > _0_0 ) { float pz = max ( dot ( rz , oy ) , _0_0 ) ; float pA = uU * uU ; float cG = _1_0 - _0_5 * ( pA / ( pA + 0.33 ) ) ; vec3 pB = uY - pj * rz ; vec3 pC = oy - pz * rz ; if ( length ( pB ) == _0_0 || length ( pC ) == _0_0 || abs ( pj ) > _1_0 || abs ( pz ) > _1_0 ) vc = pj * cG ; else { float pD = acos ( pj ) ; float pE = acos ( pz ) ; vec3 pF = normalize ( pB ) ; vec3 pG = normalize ( pC ) ; float a , b ; a = max ( pD , pE ) ; b = min ( pD , pE ) ; b *= 0.95 ; float t = max ( dot ( pF , pG ) , _0_0 ) ; float hS = 0.45 * ( pA / ( pA + 0.09 ) ) ; vc = pj * ( cG + ( hS * t * sin ( a ) * tan ( b ) ) ) ; } } else vc = pj ; vc = max ( vc , _0_0 ) ; } float L = uQ ; float vh = L * L ; float d_ = ( vg * vh - vg ) * vg + _1_0 ; float cD = vh / ( M_PI * d_ * d_ ) ; float vi ; float vj ; float vl = pow ( _1_0 - vf , 5.0 ) ; vi = _1_0 ; vj = vl ; float hM = L / 2.0 ; float vm = hM * hM ; float vn = _1_0 - vm ; float vo = _1_0 / ( vf * vf * vn + vm ) ; vi *= vo ; vj *= vo ; float rR = mix ( 0.04 , _1_0 , rW ) ; float vp = mix ( vj , vi , rR ) ; vd = max ( pj * cD * vp , _0_0 ) ;".split(" ")}]},
{TYPE:"node",NAME:"BSDF_ANISOTROPIC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"vJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vP",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",
TOKENS:"vP = vJ ; vK ; vL ; vM ; vN ; vO ;".split(" ")}]},{TYPE:"node",NAME:"BSDF_DIFFUSE",NODE_VARS:[{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"vQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vR",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vS",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vV",
QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vW",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wb",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wc",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wd",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"we",QUALIFIER:["float"],
IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"vU = vQ ; vV = vR ; vY = _0_0 ; wc = _0_0 ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["vZ","=","vS",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vZ","=","ox",";"]}]}]},{TYPE:"txt",TOKENS:"vT ; vW ; vX ; wb ; wd ; we ;".split(" ")}]},{TYPE:"node",NAME:"BSDF_GLASS",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"wf",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",
NAME:"wg",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wh",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wi",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wj",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"wj = wf ; wg ; wh ; wi ;".split(" ")}]},{TYPE:"node",NAME:"BSDF_GLOSSY",NODE_VARS:[{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"wk",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wl",
QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wm",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wn",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wo",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wp",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ws",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wt",QUALIFIER:["vec3"],
IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wA",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wB",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wD",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"wq = wk ; wr = wl ; ws = _1_0 ; wB = _0_0 ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["wt","=","wm",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",
TOKENS:["wt","=","ox",";"]}]}]},{TYPE:"txt",TOKENS:"wn ; wo ; wp ; wA ; wC ; wD ;".split(" ")}]},{TYPE:"node",NAME:"BSDF_HAIR",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"wE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wF",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wG",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wI",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"wI = wE ; wF ; wG ; wH ;".split(" ")}]},
{TYPE:"node",NAME:"BSDF_TRANSPARENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"wJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wO",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",
NAME:"wQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wW",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"wV = wJ ; wP = _0_0 ; wU = _0_0 ; wW = _0_0 ; wQ = ox ; wK ; wL ; wM ; wN ; wO ; wT ;".split(" ")}]},{TYPE:"node",NAME:"BSDF_TRANSLUCENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",
NAME:"wX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wY",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"wZ = wX ; wY ;".split(" ")}]},{TYPE:"node",NAME:"BSDF_REFRACTION",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"w_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xa",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xc",
QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xd",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"xd [ 0 ] = xd [ 1 ] = xd [ 2 ] = _0_0 ; w_ ; xa ; xb ; xc ;".split(" ")}]},{TYPE:"node",NAME:"BSDF_TOON",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xe",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xf",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xg",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xh",QUALIFIER:["vec3"],IS_OPTIONAL:!1},
{TYPE:"node_out",NAME:"xi",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"xi = xe ; xf ; xg ; xh ;".split(" ")}]},{TYPE:"node",NAME:"BSDF_VELVET",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xj",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xk",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xl",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xm",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"xm = xj ; xk ; xl ;".split(" ")}]},
{TYPE:"node",NAME:"SUBSURFACE_SCATTERING",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xn",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xo",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xp",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xq",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xs",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xt",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],
STATEMENTS:[{TYPE:"txt",TOKENS:"xt [ 0 ] = xt [ 1 ] = xt [ 2 ] = _0_0 ; xn ; xp ; xq ; xr ; xs ; xo ;".split(" ")}]},{TYPE:"node",NAME:"EMISSION",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xu",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xA",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xC",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xD",
QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xF",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xM",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"xJ = xv * xu ; xF = _0_0 ; xK = _1_0 ; xG = ox ; xA ; xB ; xC ; xD ; xE ; xL ; xM ;".split(" ")}]},
{TYPE:"node",NAME:"AMBIENT_OCCLUSION",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xO",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"xO [ 0 ] = xO [ 1 ] = xO [ 2 ] = _0_0 ; xN ;".split(" ")}]},{TYPE:"node",NAME:"HOLDOUT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"xP",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"xP [ 0 ] = xP [ 1 ] = xP [ 2 ] = _0_0 ;".split(" ")}]},{TYPE:"node",NAME:"VOLUME_ABSORPTION",
NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xR",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xS",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"xS [ 0 ] = xS [ 1 ] = xS [ 2 ] = _0_0 ; xQ ; xR ;".split(" ")}]},{TYPE:"node",NAME:"VOLUME_SCATTER",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",
NAME:"xV",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xW",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"xW [ 0 ] = xW [ 1 ] = xW [ 2 ] = _0_0 ; xT ; xU ; xV ;".split(" ")}]},{TYPE:"node",NAME:"BUMP",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Ib",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ic",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xZ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Id",QUALIFIER:["vec3"],IS_OPTIONAL:!1},
{TYPE:"node_out",NAME:"ya",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"ya = Id ; Ib ; Ic ; xZ ;".split(" ")}]},{TYPE:"node",NAME:"DISPLACEMENT_BUMP",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yh",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yi",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"yi = ox ; yh ;".split(" ")}]},{TYPE:"node",NAME:"NORMAL_MAP",NODE_VARS:[{TYPE:"node_var",NAME:"SPACE",TOKENS:["NM_TANGENT"]},{TYPE:"node_var",NAME:"USE_NORMAL_IN",
TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"yj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yk",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yl",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ym",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","yn","=","yl",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","yn","=","sM",";"]}]}]},{TYPE:"node_cond",
PARTS:[{TYPE:"node_if",EXPRESSION:["SPACE","NM_TANGENT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"ym = 2.0 * yk . xyz - _1_0 ; ym = sQ * ym ;".split(" ")}]},{TYPE:"node_elif",EXPRESSION:["SPACE","NM_OBJECT",{TYPE:"equal_expr",PLACES:2},"SPACE","NM_BLENDER_OBJECT",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"ym = 2.0 * yk . xyz - _1_0 ; ym . yz *= - _1_0 ; ym = bI ( u_model_tsr , ym ) ;".split(" ")}]},{TYPE:"node_elif",EXPRESSION:["SPACE",
"NM_WORLD",{TYPE:"equal_expr",PLACES:2},"SPACE","NM_BLENDER_WORLD",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"ym = 2.0 * yk . xyz - _1_0 ; ym . yz *= - _1_0 ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"float me = max ( yj , _0_0 ) ; ym = normalize ( mix ( yn , ym , me ) ) ;".split(" ")}]},{TYPE:"node",NAME:"VECT_TRANSFORM",NODE_VARS:[{TYPE:"node_var",NAME:"CONVERT_TYPE",TOKENS:["VT_WORLD_TO_OBJECT"]},{TYPE:"node_var",NAME:"VECTOR_TYPE",TOKENS:["VT_VECTOR"]}],
DECLARATIONS:[{TYPE:"node_in",NAME:"yo",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yp",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{TYPE:"equal_expr",PLACES:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",{TYPE:"equal_expr",PLACES:2},"CONVERT_TYPE","VT_CAMERA_TO_CAMERA",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:3}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","yo",";"]}]},{TYPE:"node_else",
STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["VECTOR_TYPE","VT_POINT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"yp = ap ( u_view_tsr_frag , yo ) ;".split(" ")}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"yp = ap ( u_model_tsr_inverse , yo ) ;".split(" ")}]},
{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"yp = ap ( u_model_tsr , yo ) ;".split(" ")}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"yp = ap ( u_model_tsr , yo ) ; yp = ap ( u_view_tsr_frag , yp ) ;".split(" ")}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",
TOKENS:"yp = ap ( u_view_tsr_inverse , yo ) ;".split(" ")}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"yp = ap ( u_view_tsr_inverse , yo ) ; yp = ap ( u_model_tsr_inverse , yp ) ;".split(" ")}]}]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"yp = _ ( u_view_tsr_frag , yo ) ;".split(" ")}]},
{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"yp = _ ( u_model_tsr_inverse , yo ) ;".split(" ")}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"yp = _ ( u_model_tsr , yo ) ;".split(" ")}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"yp = _ ( u_model_tsr , yo ) ; yp = _ ( u_view_tsr_frag , yp ) ;".split(" ")}]},
{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"yp = _ ( u_view_tsr_inverse , yo ) ;".split(" ")}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"yp = _ ( u_view_tsr_inverse , yo ) ; yp = _ ( u_model_tsr_inverse , yp ) ;".split(" ")}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["VECTOR_TYPE","VT_NORMAL",{TYPE:"equal_expr",
PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"yp = normalize ( yp ) ;".split(" ")}]}]}]}]}]},{TYPE:"node",NAME:"BLACKBODY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yq",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yr",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"yr [ 0 ] = yr [ 1 ] = yr [ 2 ] = _0_0 ; yq ;".split(" ")}]},{TYPE:"node",NAME:"WAVELENGTH",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"ys",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",
NAME:"yt",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"yt [ 0 ] = yt [ 1 ] = yt [ 2 ] = _0_0 ; ys ;".split(" ")}]},{TYPE:"node",NAME:"SEPXYZ",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yu",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yB",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"yv = yu [ 0 ] ; yA = yu [ 1 ] ; yB = yu [ 2 ] ;".split(" ")}]},
{TYPE:"node",NAME:"COMBXYZ",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yC",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yD",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yF",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"yF [ 0 ] = yC ; yF [ 1 ] = yD ; yF [ 2 ] = yE ;".split(" ")}]},{TYPE:"node",NAME:"BRIGHTCONTRAST",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yG",QUALIFIER:["vec3"],
IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yI",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float b = yH - yI * _0_5 ; yJ = max ( ( _1_0 + yI ) * yG + b , vec3 ( _0_0 ) ) ;".split(" ")}]},{TYPE:"node",NAME:"LIGHT_FALLOFF",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yL",QUALIFIER:["float"],IS_OPTIONAL:!1},
{TYPE:"node_out",NAME:"yM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yN",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yO",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"yM = yN = yO = _0_0 ; yK ; yL ;".split(" ")}]},{TYPE:"node",NAME:"TEX_IMAGE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Ie",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"If",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ig",QUALIFIER:["float"],IS_OPTIONAL:!1}],
STATEMENTS:[{TYPE:"txt",TOKENS:"If [ 0 ] = If [ 1 ] = If [ 2 ] = _0_0 ; Ig = _1_0 ; Ie ;".split(" ")}]},{TYPE:"node",NAME:"TEX_ENVIRONMENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Ih",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ii",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"Ii [ 0 ] = Ii [ 1 ] = Ii [ 2 ] = _0_0 ; Ih ;".split(" ")}]},{TYPE:"node",NAME:"TEX_SKY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yP",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",
NAME:"yQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"yQ [ 0 ] = yQ [ 1 ] = yQ [ 2 ] = _0_0 ; yP ;".split(" ")}]},{TYPE:"node",NAME:"TEX_NOISE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yS",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yT",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},
{TYPE:"node_out",NAME:"yW",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"yV [ 0 ] = yV [ 1 ] = yV [ 2 ] = _0_0 ; yW = _1_0 ; yR ; yS ; yT ; yU ;".split(" ")}]},{TYPE:"node",NAME:"TEX_WAVE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yZ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"y_",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",
NAME:"za",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zb",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zc",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"zb [ 0 ] = zb [ 1 ] = zb [ 2 ] = _0_0 ; zc = _1_0 ; yX ; yY ; yZ ; y_ ; za ;".split(" ")}]},{TYPE:"node",NAME:"TEX_VORONOI",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zd",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ze",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zf",
QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zg",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"zf [ 0 ] = zf [ 1 ] = zf [ 2 ] = _0_0 ; zg = _1_0 ; zd ; ze ;".split(" ")}]},{TYPE:"node",NAME:"TEX_MUSGRAVE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zh",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zi",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zk",QUALIFIER:["float"],IS_OPTIONAL:!1},
{TYPE:"node_in",NAME:"zl",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zm",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zo",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zp",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"zo [ 0 ] = zo [ 1 ] = zo [ 2 ] = _0_0 ; zp = _1_0 ; zh ; zi ; zj ; zk ; zl ; zm ; zn ;".split(" ")}]},{TYPE:"node",NAME:"TEX_GRADIENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",
NAME:"zq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zr",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zs",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"zr [ 0 ] = zr [ 1 ] = zr [ 2 ] = _0_0 ; zs = _1_0 ; zq ;".split(" ")}]},{TYPE:"node",NAME:"TEX_MAGIC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zt",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zu",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zv",QUALIFIER:["float"],
IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zA",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zB",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"zA [ 0 ] = zA [ 1 ] = zA [ 2 ] = _0_0 ; zB = _1_0 ; zt ; zu ; zv ;".split(" ")}]},{TYPE:"node",NAME:"TEX_CHECKER",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zD",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",
NAME:"zF",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zH",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"zG [ 0 ] = zG [ 1 ] = zG [ 2 ] = _0_0 ; zH = _1_0 ; zC ; zD ; zE ; zF ;".split(" ")}]},{TYPE:"node",NAME:"TEX_BRICK",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zI",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zK",QUALIFIER:["vec3"],
IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zN",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zO",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zQ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zS",QUALIFIER:["float"],IS_OPTIONAL:!1}],
STATEMENTS:[{TYPE:"txt",TOKENS:"zR [ 0 ] = zR [ 1 ] = zR [ 2 ] = _0_0 ; zS = _1_0 ; zI ; zJ ; zK ; zL ; zM ; zN ; zO ; zP ; zQ ;".split(" ")}]},{TYPE:"node",NAME:"ADD_SHADER",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zV",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"zV = clamp ( zT + zU , vec3 ( _0_0 ) , vec3 ( _1_0 ) ) ;".split(" ")}]},{TYPE:"node",
NAME:"MIX_SHADER",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zW",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zY",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"z_",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Aa",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ab",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ac",
QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ad",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ag",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ah",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ai",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Aj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ak",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Al",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Am",QUALIFIER:["vec3"],
IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"An",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ao",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ap",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"As",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"At",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Au",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Av",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Aw",QUALIFIER:["vec3"],IS_OPTIONAL:!1},
{TYPE:"node_out",NAME:"Ax",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ay",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Az",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AB",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AG",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",
NAME:"AH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AI",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float AJ = clamp ( zW , _0_0 , _1_0 ) ; Ax = mix ( zZ , Ak , AJ ) ; Ay = mix ( z_ , Al , AJ ) ; if ( Ac > _0_0 ) { if ( Ao > _0_0 ) { Az = mix ( Aa , Am , AJ ) ; AA = mix ( Ab , An , AJ ) ; } else { Az = Aa ; AA = Ab ; } } else { Az = Am ; AA = An ; } if ( Ah > _0_0 ) { if ( At > _0_0 ) { AF = mix ( Ag , As , AJ ) ; } else { AF = Ag ; } } else { AF = As ; } AB = mix ( Ac , Ao , AJ ) ; AC = mix ( Ad , Ap , AJ ) ; AG = mix ( Ah , At , AJ ) ; AH = mix ( Ai , Au , AJ ) ; AI = mix ( Aj , Av , AJ ) ;".split(" ")}]},
{TYPE:"node",NAME:"UV_MERGED",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AL",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_AK"],STATEMENTS:[{TYPE:"txt",TOKENS:"AK = sn ( A ) ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_AL"],STATEMENTS:[{TYPE:"txt",TOKENS:"AL = vec3 ( A , _0_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"TEX_COORD_UV",
NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AM",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"AM = vec3 ( A , _0_0 ) ;".split(" ")}]},{TYPE:"node",NAME:"TEX_COORD_NO",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AN",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AN","=","ox",";"]}]},{TYPE:"node",NAME:"TEX_COORD_GE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AO",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"AO = vec3 ( A , _0_0 ) ;".split(" ")}]},
{TYPE:"node",NAME:"TEX_COORD_OB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AP",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"AP [ 0 ] = AP [ 1 ] = AP [ 2 ] = _1_0 ;".split(" ")}]},{TYPE:"node",NAME:"TEX_COORD_CA",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"AQ [ 0 ] = sR [ 0 ] ; AQ [ 1 ] = sR [ 1 ] ; AQ [ 2 ] = _1_0 ;".split(" ")}]},{TYPE:"node",NAME:"TEX_COORD_WI",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",
NAME:"AR",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"AR [ 0 ] = AR [ 1 ] = AR [ 2 ] = _1_0 ;".split(" ")}]},{TYPE:"node",NAME:"TEX_COORD_RE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AS",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"AS [ 0 ] = AS [ 1 ] = AS [ 2 ] = _1_0 ;".split(" ")}]},{TYPE:"node",NAME:"UVMAP",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AT",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"AT = vec3 ( A , _0_0 ) ;".split(" ")}]},
{TYPE:"node",NAME:"PARTICLE_INFO",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AV",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AW",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"A_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",
NAME:"HY",QUALIFIER:["GLSL_IN","vec4"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"HZ",QUALIFIER:["GLSL_IN","vec3"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"H_",QUALIFIER:["GLSL_IN","vec3"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"Ia",QUALIFIER:["GLSL_IN","vec3"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["PARTICLE_BATCH"],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_AU"],STATEMENTS:[{TYPE:"txt",TOKENS:"AU = HY [ 0 ] ;".split(" ")}]}]},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_AV"],STATEMENTS:[{TYPE:"txt",TOKENS:"AV = HY [ 1 ] ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_AW"],STATEMENTS:[{TYPE:"txt",TOKENS:"AW = HY [ 2 ] ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_AX"],STATEMENTS:[{TYPE:"txt",TOKENS:["AX","=","HZ",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_AY"],STATEMENTS:[{TYPE:"txt",TOKENS:"AY = HY [ 3 ] ;".split(" ")}]}]},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_AZ"],STATEMENTS:[{TYPE:"txt",TOKENS:["AZ","=","H_",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_A_"],STATEMENTS:[{TYPE:"txt",TOKENS:["A_","=","Ia",";"]}]}]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"AU = _0_0 ; AV = _0_0 ; AW = _0_0 ; AX = vec3 ( _0_0 ) ; AY = _0_0 ; AZ = AX ; A_ = AX ;".split(" ")}]}]}]},{TYPE:"node",NAME:"HAIR_INFO",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"Ba",QUALIFIER:["float"],
IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bc",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bd",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"Ba = _0_0 ; Bb = _0_0 ; Bc = _0_0 ; Bd = vec3 ( _0_0 ) ;".split(" ")}]},{TYPE:"node",NAME:"OBJECT_INFO",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"Be",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bf",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",
NAME:"Bg",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bh",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"Bf = _0_0 ; Bg = _0_0 ; Bh = _0_0 ; Be = vec3 ( _0_0 ) ;".split(" ")}]},{TYPE:"node",NAME:"WIREFRAME",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Bi",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bj",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Bj","=","Bi",";"]}]},{TYPE:"node",NAME:"TANGENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",
NAME:"Bk",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"Bk = vec3 ( _0_0 ) ;".split(" ")}]},{TYPE:"node",NAME:"LAYER_WEIGHT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Ij",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ik",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bo",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"Bn = Bo = _0_0 ; Ik ; Ij ;".split(" ")}]},{TYPE:"node",
NAME:"LIGHT_PATH",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"Bq",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Br",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bs",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bt",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bu",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",
NAME:"Bx",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"By",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bz",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"Bq = Br = Bs = _0_0 ; Bt = Bu = Bv = _0_0 ; Bw = Bw = By = Bz = _0_0 ; Bx = _0_0 ;".split(" ")}]},{TYPE:"node",NAME:"ATTRIBUTE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"BB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",
NAME:"BD",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"BB = BC = vec3 ( _0_0 ) ; BD = _0_0 ;".split(" ")}]},{TYPE:"node",NAME:"SCRIPT",NODE_VARS:[],DECLARATIONS:[],STATEMENTS:[]},{TYPE:"node",NAME:"CURVE_VEC",NODE_VARS:[{TYPE:"node_var",NAME:"READ_R",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_G",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_B",TOKENS:["0"]},{TYPE:"node_var",NAME:"NODE_TEX_ROW",TOKENS:["0.0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BE",QUALIFIER:["float"],IS_OPTIONAL:!1},
{TYPE:"node_in",NAME:"BF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BG",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BG","=","BF",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_R"],STATEMENTS:[{TYPE:"txt",TOKENS:"BG . r = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( _0_5 * BF . r + _0_5 , NODE_TEX_ROW ) ) . r - _0_5 ) * 2.0 ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_G"],STATEMENTS:[{TYPE:"txt",TOKENS:"BG . g = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( _0_5 * BF . g + _0_5 , NODE_TEX_ROW ) ) . g - _0_5 ) * 2.0 ;".split(" ")}]}]},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_B"],STATEMENTS:[{TYPE:"txt",TOKENS:"BG . b = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( _0_5 * BF . b + _0_5 , NODE_TEX_ROW ) ) . b - _0_5 ) * 2.0 ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"BG = mix ( BF , BG , BE ) ;".split(" ")}]},{TYPE:"node",NAME:"CURVE_RGB",NODE_VARS:[{TYPE:"node_var",NAME:"READ_A",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_R",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_G",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_B",TOKENS:["0"]},
{TYPE:"node_var",NAME:"NODE_TEX_ROW",TOKENS:["_0_0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BI",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_A"],STATEMENTS:[{TYPE:"txt",TOKENS:"float r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( BI . r , NODE_TEX_ROW ) ) . a ; float g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( BI . g , NODE_TEX_ROW ) ) . a ; float b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( BI . b , NODE_TEX_ROW ) ) . a ;".split(" ")}]},
{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"float r = BI . r ; float g = BI . g ; float b = BI . b ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_R"],STATEMENTS:[{TYPE:"txt",TOKENS:"BJ . r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( r , NODE_TEX_ROW ) ) . r ;".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"BJ . r = r ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_G"],STATEMENTS:[{TYPE:"txt",TOKENS:"BJ . g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( g , NODE_TEX_ROW ) ) . g ;".split(" ")}]},
{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"BJ . g = g ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_B"],STATEMENTS:[{TYPE:"txt",TOKENS:"BJ . b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( b , NODE_TEX_ROW ) ) . b ;".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"BJ . b = b ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"BJ = mix ( BI , BJ , BH ) ;".split(" ")}]},{TYPE:"node",NAME:"VALTORGB",NODE_VARS:[{TYPE:"node_var",NAME:"NODE_TEX_ROW",TOKENS:["_0_0"]}],
DECLARATIONS:[{TYPE:"node_in",NAME:"BK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BM",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"vec4 BN = GLSL_TEXTURE ( u_nodes_texture , vec2 ( BK , NODE_TEX_ROW ) ) ; BL = BN . rgb ; BM = BN . a ;".split(" ")}]},{TYPE:"node",NAME:"MAPPING",NODE_VARS:[{TYPE:"node_var",NAME:"MAPPING_SCALE_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_SCALE",TOKENS:["vec3",
"(","_1_0",")"]},{TYPE:"node_var",NAME:"MAPPING_TRANS_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_TRANS",TOKENS:["vec3","(","_0_0",")"]},{TYPE:"node_var",NAME:"MAPPING_TRS_MATRIX_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_TRS_MATRIX",TOKENS:["mat4","(","_1_0",")"]},{TYPE:"node_var",NAME:"MAPPING_MIN_CLIP_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_MIN_CLIP",TOKENS:["vec3","(","_0_0",")"]},{TYPE:"node_var",NAME:"MAPPING_MAX_CLIP_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_MAX_CLIP",
TOKENS:["vec3","(","_1_0",")"]},{TYPE:"node_var",NAME:"MAPPING_IS_NORMAL",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BP",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BP","=","BO",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_SCALE_DEF"],STATEMENTS:[{TYPE:"txt",TOKENS:"BP = BP * MAPPING_SCALE ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_TRANS_DEF"],
STATEMENTS:[{TYPE:"txt",TOKENS:"BP = BP + MAPPING_TRANS ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_TRS_MATRIX_DEF"],STATEMENTS:[{TYPE:"txt",TOKENS:"BP = ( MAPPING_TRS_MATRIX * vec4 ( BP , _1_0 ) ) . xyz ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_MIN_CLIP_DEF"],STATEMENTS:[{TYPE:"txt",TOKENS:"BP = max ( BP , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_MAX_CLIP_DEF"],STATEMENTS:[{TYPE:"txt",
TOKENS:"BP = min ( BP , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_IS_NORMAL"],STATEMENTS:[{TYPE:"txt",TOKENS:"BP = normalize ( BP ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MATH_ADD",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BQ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BR",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BS",QUALIFIER:["float"],IS_OPTIONAL:!1}],
STATEMENTS:[{TYPE:"txt",TOKENS:"BS = BQ + BR ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"BS = clamp ( BS , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MATH_SUBTRACT",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BT",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BV",QUALIFIER:["float"],IS_OPTIONAL:!1}],
STATEMENTS:[{TYPE:"txt",TOKENS:"BV = BT - BU ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"BV = clamp ( BV , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MATH_MULTIPLY",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BW",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BY",QUALIFIER:["float"],IS_OPTIONAL:!1}],
STATEMENTS:[{TYPE:"txt",TOKENS:"BY = BW * BX ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"BY = clamp ( BY , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MATH_DIVIDE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BZ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"B_",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ca",QUALIFIER:["float"],IS_OPTIONAL:!1}],
STATEMENTS:[{TYPE:"txt",TOKENS:"Ca = ( B_ != _0_0 ) ? BZ / B_ : _0_0 ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"Ca = clamp ( Ca , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MATH_SINE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cc",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cd",QUALIFIER:["float"],
IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"Cd = sin ( Cb ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"Cd = clamp ( Cd , _0_0 , _1_0 ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:["Cc",";"]}]},{TYPE:"node",NAME:"MATH_COSINE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ce",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cf",QUALIFIER:["float"],IS_OPTIONAL:!1},
{TYPE:"node_out",NAME:"Cg",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"Cg = cos ( Ce ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"Cg = clamp ( Cg , _0_0 , _1_0 ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:["Cf",";"]}]},{TYPE:"node",NAME:"MATH_TANGENT",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ch",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",
NAME:"Ci",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cj",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"Cj = tan ( Ch ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"Cj = clamp ( Cj , _0_0 , _1_0 ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:["Ci",";"]}]},{TYPE:"node",NAME:"MATH_ARCSINE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ck",QUALIFIER:["float"],
IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cl",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cm",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"Cm = ( Ck <= _1_0 && Ck >= - _1_0 ) ? asin ( Ck ) : _0_0 ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"Cm = clamp ( Cm , _0_0 , _1_0 ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:["Cl",";"]}]},{TYPE:"node",NAME:"MATH_ARCCOSINE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",
TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Co",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cp",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"Cp = ( Cn <= _1_0 && Cn >= - _1_0 ) ? acos ( Cn ) : _0_0 ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"Cp = clamp ( Cp , _0_0 , _1_0 ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:["Co",";"]}]},
{TYPE:"node",NAME:"MATH_ARCTANGENT",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cq",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cs",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"Cs = atan ( Cq ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"Cs = clamp ( Cs , _0_0 , _1_0 ) ;".split(" ")}]}]},
{TYPE:"txt",TOKENS:["Cr",";"]}]},{TYPE:"node",NAME:"MATH_POWER",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ct",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cu",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cv",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"if ( Ct < _0_0 && Cu != floor ( Cu ) ) Cv = _0_0 ; else if ( Cu == _0_0 ) Cv = _1_0 ; else if ( Ct < _0_0 ) Cv = mix ( _1_0 , - _1_0 , sign ( mod ( - Cu , 2.0 ) ) ) * pow ( - Ct , Cu ) ; else if ( Ct == _0_0 ) Cv = _0_0 ; else Cv = pow ( Ct , Cu ) ;".split(" ")},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"Cv = clamp ( Cv , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MATH_LOGARITHM",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cx",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cy",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"Cy = ( Cw > _0_0 && Cx > _0_0 ) ? log2 ( Cw ) / log2 ( Cx ) : _0_0 ;".split(" ")},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"Cy = clamp ( Cy , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MATH_MINIMUM",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cz",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CB",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"CB = min ( Cz , CA ) ;".split(" ")},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"CB = clamp ( CB , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MATH_MAXIMUM",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CC",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CD",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CE",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"CE = max ( CC , CD ) ;".split(" ")},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"CE = clamp ( CE , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MATH_ROUND",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CF",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CG",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CH",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"CH = floor ( CF + _0_5 ) ;".split(" ")},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"CH = clamp ( CH , _0_0 , _1_0 ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:["CG",";"]}]},{TYPE:"node",NAME:"MATH_LESS_THAN",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CI",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CJ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CK",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",
TOKENS:"CK = ( CI < CJ ) ? _1_0 : _0_0 ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"CK = clamp ( CK , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MATH_GREATER_THAN",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CN",QUALIFIER:["float"],IS_OPTIONAL:!1}],
STATEMENTS:[{TYPE:"txt",TOKENS:"CN = ( CL > CM ) ? _1_0 : _0_0 ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"CN = clamp ( CN , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MATH_MODULO",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CO",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CQ",QUALIFIER:["float"],
IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"CQ = abs ( CP ) > 0.000001 ? mod ( CO , CP ) : _0_0 ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"CQ = clamp ( CQ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MATH_ABSOLUTE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CR",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CS",QUALIFIER:["float"],IS_OPTIONAL:!1},
{TYPE:"node_out",NAME:"CT",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"CT = abs ( CR ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"CT = clamp ( CT , _0_0 , _1_0 ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:["CS",";"]}]},{TYPE:"node",NAME:"MIX_RGB_MIX",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",
NAME:"CV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CW",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CX",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float AJ = clamp ( CU , _0_0 , _1_0 ) ; CX = mix ( CV , CW , AJ ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"CX = clamp ( CX , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MIX_RGB_ADD",NODE_VARS:[{TYPE:"node_var",
NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"C_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Da",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float AJ = clamp ( CY , _0_0 , _1_0 ) ; Da = mix ( CZ , CZ + C_ , AJ ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",
TOKENS:"Da = clamp ( Da , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MIX_RGB_MULTIPLY",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Db",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dd",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"De",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float AJ = clamp ( Db , _0_0 , _1_0 ) ; De = mix ( Dc , Dc * Dd , AJ ) ;".split(" ")},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"De = clamp ( De , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MIX_RGB_SUBTRACT",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Df",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dh",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Di",QUALIFIER:["vec3"],
IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float AJ = clamp ( Df , _0_0 , _1_0 ) ; Di = mix ( Dg , Dg - Dh , AJ ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"Di = clamp ( Di , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MIX_RGB_SCREEN",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Dj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dk",QUALIFIER:["vec3"],
IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dl",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Dm",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float AJ = clamp ( Dj , _0_0 , _1_0 ) ; float Dn = _1_0 - AJ ; Dm = vec3 ( _1_0 ) - ( vec3 ( Dn ) + AJ * ( vec3 ( _1_0 ) - Dl ) ) * ( vec3 ( _1_0 ) - Dk ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"Dm = clamp ( Dm , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{TYPE:"node",NAME:"MIX_RGB_DIVIDE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Do",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dp",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Dr",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float AJ = clamp ( Do , _0_0 , _1_0 ) ; float Dn = _1_0 - AJ ; Dq += step ( Dq , vec3 ( _0_0 ) ) ; Dr = Dn * Dp + AJ * Dp / Dq ;".split(" ")},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"Dr = clamp ( Dr , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MIX_RGB_DIFFERENCE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ds",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dt",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Du",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Dv",QUALIFIER:["vec3"],
IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float AJ = clamp ( Ds , _0_0 , _1_0 ) ; Dv = mix ( Dt , abs ( Dt - Du ) , AJ ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"Dv = clamp ( Dv , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MIX_RGB_DARKEN",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Dw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dx",
QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dy",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Dz",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float AJ = clamp ( Dw , _0_0 , _1_0 ) ; Dz = min ( Dx . rgb , Dy . rgb * AJ ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"Dz = clamp ( Dz , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MIX_RGB_LIGHTEN",NODE_VARS:[{TYPE:"node_var",
NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"DA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DD",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float AJ = clamp ( DA , _0_0 , _1_0 ) ; DD = max ( DB . rgb , DC . rgb * AJ ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",
TOKENS:"DD = clamp ( DD , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MIX_RGB_OVERLAY",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"DE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DH",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float AJ = clamp ( DE , _0_0 , _1_0 ) ; vec3 DI = vec3 ( _1_0 - AJ ) ; DH = mix ( DF * ( DI + 2.0 * AJ * DG ) , vec3 ( _1_0 ) - ( DI + 2.0 * AJ * ( vec3 ( _1_0 ) - DG ) ) * ( vec3 ( _1_0 ) - DF ) , step ( _0_5 , DF ) ) ;".split(" ")},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"DH = clamp ( DH , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MIX_RGB_DODGE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"DJ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DM",QUALIFIER:["vec3"],
IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float AJ = clamp ( DJ , _0_0 , _1_0 ) ; vec3 DN = vec3 ( _1_0 ) - AJ * DL ; vec3 DO = clamp ( DK / DN , _0_0 , _1_0 ) ; DM = mix ( mix ( DO , vec3 ( _1_0 ) , step ( DN , vec3 ( _0_0 ) ) ) , DK , step ( DK , vec3 ( _0_0 ) ) ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"DM = clamp ( DM , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MIX_RGB_BURN",NODE_VARS:[{TYPE:"node_var",
NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"DP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DS",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float AJ = clamp ( DP , _0_0 , _1_0 ) ; vec3 ks = vec3 ( _1_0 - AJ ) ; vec3 DN = ks + AJ * DR ; vec3 DO = clamp ( vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - DQ ) / DN , _0_0 , _1_0 ) ; DS = mix ( DO , vec3 ( _0_0 ) , step ( DN , vec3 ( _0_0 ) ) ) ;".split(" ")},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"DS = clamp ( DS , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MIX_RGB_HUE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"DT",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DW",QUALIFIER:["vec3"],
IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float AJ = clamp ( DT , _0_0 , _1_0 ) ; vec3 kk , DX , DN ; DW = DU ; DX = kj ( DV ) ; if ( DX . y != _0_0 ) { kk = kj ( DW ) ; kk . x = DX . x ; DN = kl ( kk ) ; DW = mix ( DW , DN , AJ ) ; }".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"DW = clamp ( DW , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MIX_RGB_SATURATION",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",
TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"DY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"D_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ea",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float AJ = clamp ( DY , _0_0 , _1_0 ) ; float Dn = _1_0 - AJ ; Ea = DZ ; vec3 kk , DX ; kk = kj ( Ea ) ; if ( kk . y != _0_0 ) { DX = kj ( D_ ) ; kk . y = Dn * kk . y + AJ * DX . y ; Ea = kl ( kk ) ; }".split(" ")},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"Ea = clamp ( Ea , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MIX_RGB_VALUE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Eb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ec",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ed",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ee",QUALIFIER:["vec3"],
IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float AJ = clamp ( Eb , _0_0 , _1_0 ) ; float Dn = _1_0 - AJ ; vec3 kk , DX ; kk = kj ( Ec ) ; DX = kj ( Ed ) ; kk . z = Dn * kk . z + AJ * DX . z ; Ee = kl ( kk ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"Ee = clamp ( Ee , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MIX_RGB_COLOR",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",
NAME:"Ef",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Eg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Eh",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ei",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float AJ = clamp ( Ef , _0_0 , _1_0 ) ; vec3 kk , DX , DN ; Ei = Eg ; DX = kj ( Eh ) ; if ( DX . y != _0_0 ) { kk = kj ( Ei ) ; kk . x = DX . x ; kk . y = DX . y ; DN = kl ( kk ) ; Ei = mix ( Ei , DN , AJ ) ; }".split(" ")},{TYPE:"node_cond",
PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"Ei = clamp ( Ei , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MIX_RGB_SOFT_LIGHT",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ej",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ek",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"El",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Em",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],
STATEMENTS:[{TYPE:"txt",TOKENS:"float AJ = clamp ( Ej , _0_0 , _1_0 ) ; float Dn = _1_0 - AJ ; vec3 En = El + Ek - El * Ek ; Em = Ek * ( vec3 ( Dn ) + vec3 ( AJ ) * ( ( vec3 ( _1_0 ) - Ek ) * El + En ) ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"Em = clamp ( Em , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MIX_RGB_LINEAR_LIGHT",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",
NAME:"Eo",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ep",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Eq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Er",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float AJ = clamp ( Eo , _0_0 , _1_0 ) ; Er = Ep + AJ * ( 2.0 * Eq - vec3 ( _1_0 ) ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:"Er = clamp ( Er , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{TYPE:"node",NAME:"OUTPUT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"EA",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EB",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"E = EA ; I = EB ;".split(" ")}]},{TYPE:"node",NAME:"OUTPUT_SURFACE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"EC",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"E = EC ; I = _1_0 ;".split(" ")}]},{TYPE:"node",NAME:"MATERIAL_BEGIN",NODE_VARS:[{TYPE:"node_var",NAME:"MATERIAL_EXT",
TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_MATERIAL_NORMAL",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_MATERIAL_DIFFUSE",TOKENS:["0"]},{TYPE:"node_var",NAME:"SHADELESS_MAT",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"EF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EI",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"EJ",QUALIFIER:["float"],IS_OPTIONAL:!0},
{TYPE:"node_out",NAME:"EK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EM",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EP",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EQ",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ER",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_param",
NAME:"sF",QUALIFIER:["const","vec2"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"sG",QUALIFIER:["const","vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"EM = clamp ( EF , _0_0 , _1_0 ) ; EN = sG [ 0 ] * clamp ( EG , _0_0 , _1_0 ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_NORMAL"],STATEMENTS:[{TYPE:"txt",TOKENS:"EO = normalize ( EI ) ;".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["EO","=","ox",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",
EXPRESSION:["SHADELESS_MAT",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATERIAL_EXT"],STATEMENTS:[{TYPE:"txt",TOKENS:"EK = EJ * EM ;".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"EK = sS * EM ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_DIFFUSE"],STATEMENTS:[{TYPE:"txt",TOKENS:["EM","*=","EH",";"]}]}]},{TYPE:"txt",TOKENS:"EL = sT * u_environment_energy * cE ( EO ) ; ER = vec4 ( _1_0 ) ;".split(" ")},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NUM_LIGHTS",0,{TYPE:"g_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"EP = vec2 ( sF [ 0 ] , sF [ 1 ] ) ; EQ = vec2 ( sG [ 1 ] , sG [ 2 ] ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:["H","=","ER",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"EK = vec3 ( _0_0 ) ; EL = vec3 ( _1_0 ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"MATERIAL_END",NODE_VARS:[{TYPE:"node_var",NAME:"MATERIAL_EXT",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_MATERIAL_DIFFUSE",
TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_MATERIAL_SPECULAR",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"ES",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ET",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EV",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"EW",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"EX",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"EY",QUALIFIER:["vec3"],
IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"EZ",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"E_",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fa",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fb",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"sH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sI",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["EV",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_EY"],
STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_DIFFUSE"],STATEMENTS:[{TYPE:"txt",TOKENS:"EY = ES . rgb ;".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"EY = vec3 ( _0_0 ) ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_SPECULAR"],STATEMENTS:[{TYPE:"txt",TOKENS:["EY","+=","ET",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_E_"],STATEMENTS:[{TYPE:"txt",TOKENS:["E_","=","EU",";"]}]}]},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATERIAL_EXT"],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fa"],STATEMENTS:[{TYPE:"txt",TOKENS:"Fa = ES . rgb ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fb"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fb","=","ET",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_EZ"],STATEMENTS:[{TYPE:"txt",TOKENS:"EZ = clamp ( EX , _0_0 , _1_0 ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",
EXPRESSION:["USE_MATERIAL_SPECULAR"],STATEMENTS:[{TYPE:"txt",TOKENS:"float t = max ( max ( ET . r , ET . g ) , ET . b ) * EW ; EZ = clamp ( EX * ( _1_0 - t ) + t , _0_0 , _1_0 ) ;".split(" ")}]}]}]}]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_EZ"],STATEMENTS:[{TYPE:"txt",TOKENS:"EZ = clamp ( sH , _0_0 , _1_0 ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_SPECULAR"],STATEMENTS:[{TYPE:"txt",TOKENS:"float t = max ( max ( ET . r , ET . g ) , ET . b ) * sI ; EZ = sH * ( _1_0 - t ) + t ;".split(" ")}]}]}]}]}]}]},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_SPECULAR"],STATEMENTS:[{TYPE:"txt",TOKENS:["F","=","ET",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"F = vec3 ( _0_0 ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:["G","=","EU",";"]}]},{TYPE:"node",NAME:"LIGHTING_AMBIENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"oP",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"oQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"oR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},
{TYPE:"node_out",NAME:"oS",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oT",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"oS = vec4 ( oP + oR * oQ , _0_0 ) ; oT = vec3 ( _0_0 ) ;".split(" ")}]},{TYPE:"node",NAME:"LIGHTING_LAMP",NODE_VARS:[{TYPE:"node_var",NAME:"LAMP_TYPE",TOKENS:["HEMI"]},{TYPE:"node_var",NAME:"LAMP_IND",TOKENS:["0"]},{TYPE:"node_var",NAME:"LAMP_SPOT_SIZE",TOKENS:["0.8"]},{TYPE:"node_var",NAME:"LAMP_SPOT_BLEND",TOKENS:["0.03"]},{TYPE:"node_var",
NAME:"LAMP_LIGHT_DIST",TOKENS:["30.0"]},{TYPE:"node_var",NAME:"LAMP_SHADOW_MAP_IND",TOKENS:["-","1"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"oU",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oW",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oY",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"oW = vec2 ( u_light_positions [ LAMP_IND ] . w , u_light_color_intensities [ LAMP_IND ] . w ) ;".split(" ")},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","HEMI",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["oY","=","_0_5",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["oY","=","_0_0",";"]}]}]},{TYPE:"txt",TOKENS:"oX = u_light_color_intensities [ LAMP_IND ] . xyz ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_SHADOW_MAP_IND",1,{TYPE:"negative_expr",PLACES:1},{TYPE:"non_equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"oX *= oU [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2},"LAMP_TYPE","POINT",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:"vec3 oZ = u_light_positions [ LAMP_IND ] . xyz ; oV = oZ - ow ; float aM = length ( oV ) ; oX *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + aM * aM ) ; oV = normalize ( oV ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2}],
STATEMENTS:[{TYPE:"txt",TOKENS:"vec3 pa = u_light_directions [ LAMP_IND ] ; float pb = dot ( oV , pa ) ; pb *= smoothstep ( _0_0 , _1_0 , ( pb - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; oX *= pb ;".split(" ")}]}]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"oV = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{TYPE:"node",NAME:"DIFFUSE_FRESNEL",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},
{TYPE:"node_in",NAME:"pd",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pe",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pf",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pg",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ph",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:"vec3 pi = cross ( pc , k . xyz ) ; pe = cross ( pi , k . xyz ) ; pe = - normalize ( pe ) ;".split(" ")}]}]},
{TYPE:"txt",TOKENS:"ph = _0_0 ; if ( pd . r != _0_0 ) { float pj = ( _1_0 - pf ) * dot ( pe , pc ) + pf ; if ( pg [ 0 ] == _0_0 ) { ph = _1_0 ; } else { float t = _1_0 + abs ( pj ) ; t = pg [ 1 ] + ( _1_0 - pg [ 1 ] ) * pow ( t , pg [ 0 ] ) ; ph = clamp ( t , _0_0 , _1_0 ) ; } ph = max ( ph , _0_0 ) ; }".split(" ")}]},{TYPE:"node",NAME:"DIFFUSE_LAMBERT",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pk",QUALIFIER:["vec3"],IS_OPTIONAL:!1},
{TYPE:"node_in",NAME:"pl",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pm",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"po",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:"vec3 pi = cross ( pk , k . xyz ) ; pm = cross ( pi , k . xyz ) ; pm = - normalize ( pm ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"po = _0_0 ; if ( pl . r != _0_0 ) { float pj = ( _1_0 - pn ) * dot ( pm , pk ) + pn ; po = max ( pj , _0_0 ) ; }".split(" ")}]},
{TYPE:"node",NAME:"DIFFUSE_OREN_NAYAR",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pr",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pu",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pv",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"px",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"py",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",
PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:"vec3 pi = cross ( pr , k . xyz ) ; pv = cross ( pi , k . xyz ) ; pv = - normalize ( pv ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"py = _0_0 ; if ( pu . r != _0_0 ) { float pj = ( _1_0 - pw ) * dot ( pv , pr ) + pw ; if ( px [ 0 ] > _0_0 ) { float pz = max ( dot ( pv , oy ) , _0_0 ) ; float pA = px [ 0 ] * px [ 0 ] ; float cG = _1_0 - _0_5 * ( pA / ( pA + 0.33 ) ) ; vec3 pB = pr - pj * pv ; vec3 pC = oy - pz * pv ; if ( length ( pB ) == _0_0 || length ( pC ) == _0_0 || abs ( pj ) > _1_0 || abs ( pz ) > _1_0 ) py = pj * cG ; else { float pD = acos ( pj ) ; float pE = acos ( pz ) ; vec3 pF = normalize ( pB ) ; vec3 pG = normalize ( pC ) ; float a , b ; a = max ( pD , pE ) ; b = min ( pD , pE ) ; b *= 0.95 ; float t = max ( dot ( pF , pG ) , _0_0 ) ; float hS = 0.45 * ( pA / ( pA + 0.09 ) ) ; py = pj * ( cG + ( hS * t * sin ( a ) * tan ( b ) ) ) ; } } else py = pj ; py = max ( py , _0_0 ) ; }".split(" ")}]},
{TYPE:"node",NAME:"DIFFUSE_MINNAERT",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pI",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pL",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pM",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",
PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:"vec3 pi = cross ( pH , k . xyz ) ; pJ = cross ( pi , k . xyz ) ; pJ = - normalize ( pJ ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"pM = _0_0 ; if ( pI . r != _0_0 ) { float pj = ( _1_0 - pK ) * dot ( pJ , pH ) + pK ; float pz = max ( dot ( pJ , oy ) , _0_0 ) ; if ( pL [ 0 ] <= _1_0 ) pM = pj * pow ( max ( pz * pj , 0.1 ) , pL [ 0 ] - _1_0 ) ; else pM = pj * pow ( 1.0001 - pz , pL [ 0 ] - _1_0 ) ; pM = max ( pM , _0_0 ) ; }".split(" ")}]},
{TYPE:"node",NAME:"DIFFUSE_TOON",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pO",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pP",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pQ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pR",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pS",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",
PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:"vec3 pi = cross ( pN , k . xyz ) ; pP = cross ( pi , k . xyz ) ; pP = - normalize ( pP ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"pS = _0_0 ; if ( pO . r != _0_0 ) { float pj = ( _1_0 - pQ ) * dot ( pP , pN ) + pQ ; float pT = acos ( pj ) ; if ( pT < pR [ 0 ] ) pS = _1_0 ; else if ( pT > ( pR [ 0 ] + pR [ 1 ] ) || pR [ 1 ] == _0_0 ) pS = _0_0 ; else pS = _1_0 - ( ( pT - pR [ 0 ] ) / pR [ 1 ] ) ; pS = max ( pS , _0_0 ) ; }".split(" ")}]},
{TYPE:"node",NAME:"SPECULAR_PHONG",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pV",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pW",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pY",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pZ",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",
TOKENS:"pZ = _0_0 ; if ( pV . g == _1_0 ) { vec3 p_ = normalize ( pU + oy ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:"if ( pX == _0_0 ) { pZ = dot ( k . xyz , p_ ) ; pZ = sqrt ( _1_0 - pZ * pZ ) ; }".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"pZ = ( _1_0 - pX ) * max ( dot ( pW , p_ ) , _0_0 ) + pX ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"pZ = pow ( pZ , pY [ 0 ] ) ; }".split(" ")}]},{TYPE:"node",NAME:"SPECULAR_COOKTORR",
NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qa",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qb",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qd",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qe",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qf",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"qf = _0_0 ; if ( qb . g != _0_0 ) { vec3 p_ = normalize ( qa + oy ) ;".split(" ")},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:"if ( qd == _0_0 ) { qf = dot ( B . xyz , p_ ) ; qf = sqrt ( _1_0 - qf * qf ) ; }".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"qf = max ( dot ( qc , p_ ) , _0_0 ) ; qf = ( _1_0 - qd ) * qf + qd ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:"float pz = max ( dot ( B . xyz , oy ) , _0_0 ) ; pz = sqrt ( _1_0 - pz * pz ) ;".split(" ")}]},
{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"float pz = max ( dot ( qc , oy ) , _0_0 ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"qf = pow ( qf , qe [ 0 ] ) ; qf = qf / ( 0.1 + pz ) ; }".split(" ")}]},{TYPE:"node",NAME:"SPECULAR_WARDISO",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qh",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qi",QUALIFIER:["vec3"],IS_OPTIONAL:!1},
{TYPE:"node_in",NAME:"qj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qk",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ql",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"ql = _0_0 ; if ( qh . g == _1_0 ) { vec3 p_ = normalize ( qg + oy ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:"float qm = _0_0 ; float pz = _0_0 ; float qn = _0_0 ; if ( qj == _0_0 ) { qm = dot ( k . xyz , p_ ) ; pz = dot ( k . xyz , oy ) ; qn = dot ( k . xyz , qg ) ; qm = sqrt ( _1_0 - qm * qm ) ; pz = sqrt ( _1_0 - pz * pz ) ; qn = sqrt ( _1_0 - qn * qn ) ; }".split(" ")}]},
{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"float qm = max ( dot ( qi , p_ ) , 0.01 ) ; float pz = max ( dot ( qi , oy ) , 0.01 ) ; float qn = max ( dot ( qi , qg ) , 0.01 ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"float bP = tan ( acos ( qm ) ) ; float L = max ( qk [ 0 ] , 0.01 ) ; ql = qn * ( _1_0 / ( 4.0 * M_PI * L * L ) ) * ( exp ( - ( bP * bP ) / ( L * L ) ) / ( sqrt ( pz * qn ) ) ) ; }".split(" ")}]},{TYPE:"node",NAME:"SPECULAR_TOON",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",
TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qo",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qr",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qu",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qw",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qx",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"qx = _0_0 ; if ( qr . g == _1_0 ) { vec3 co = normalize ( qo + oy ) ;".split(" ")},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:"float qy = dot ( co , k . xyz ) ; float bP = qw [ 0 ] + qw [ 1 ] ; if ( qv == _0_0 ) bP = acos ( sqrt ( _1_0 - qy * qy ) ) ;".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"float bP = acos ( dot ( co , qu ) ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"if ( bP < qw [ 0 ] ) qx = _1_0 ; else if ( bP >= qw [ 0 ] + qw [ 1 ] || qw [ 1 ] == _0_0 ) qx = _0_0 ; else qx = _1_0 - ( bP - qw [ 0 ] ) / qw [ 1 ] ; }".split(" ")}]},
{TYPE:"node",NAME:"SPECULAR_BLINN",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qz",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qA",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qC",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qD",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qE",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",
TOKENS:"qE = _0_0 ; if ( qA . g == _1_0 ) { if ( qD [ 0 ] < _1_0 || qD [ 1 ] == _0_0 ) qE = _0_0 ; else { if ( qD [ 1 ] < 100.0 ) qD [ 1 ] = sqrt ( _1_0 / qD [ 1 ] ) ; else qD [ 1 ] = 10.0 / qD [ 1 ] ; vec3 p_ = normalize ( oy + qz ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:"float qm = _0_0 ; if ( qC == _0_0 ) { float qH = dot ( k . xyz , p_ ) ; qm = sqrt ( _1_0 - qH * qH ) ; }".split(" ")}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",
TOKENS:"float qm = ( _1_0 - qC ) * max ( dot ( qB , p_ ) , _0_0 ) + qC ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"if ( qm < _0_0 ) qE = _0_0 ; else { float pz = max ( dot ( qB , oy ) , 0.01 ) ; float qn = dot ( qB , qz ) ; if ( qn <= 0.01 ) qE = _0_0 ; else { float qI = max ( dot ( oy , p_ ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * qm * pz ) / qI ; float dx = ( 2.0 * qm * qn ) / qI ; float g = min ( min ( a , b ) , dx ) ; float p = sqrt ( pow ( qD [ 0 ] , 2.0 ) + pow ( qI , 2.0 ) - _1_0 ) ; float mm = pow ( p - qI , 2.0 ) / pow ( p + qI , 2.0 ) * ( _1_0 + pow ( qI * ( p + qI ) - _1_0 , 2.0 ) / pow ( qI * ( p - qI ) + _1_0 , 2.0 ) ) ; float pT = acos ( qm ) ; qE = max ( mm * g * exp ( - pow ( pT , 2.0 ) / ( 2.0 * pow ( qD [ 1 ] , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},
{TYPE:"node",NAME:"LIGHTING_APPLY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"qJ",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qP",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",
NAME:"qQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qS",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qT",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qU",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qV",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NODE_B4W_TRANSLUCENCY"],STATEMENTS:[{TYPE:"txt",TOKENS:"if ( dot ( qN , qO ) * dot ( oy , qO ) < _0_0 ) { float Fc = qP . x ; float Fd = qP . y ; float Fe = qP . z ; float Ff = qP . w ; float Fg = clamp ( abs ( dot ( qN , qO ) ) , _0_0 , _1_0 ) ; float Fh = clamp ( dot ( oy , - qN ) , _0_0 , _1_0 ) ; float Fi = pow ( Fh , Fd ) ; qU = qJ + qT * vec4 ( qS * Fg * pow ( qQ , vec3 ( Fc ) ) , _1_0 ) ; qU += Fe * mix ( vec4 ( qQ , _1_0 ) , vec4 ( _1_0 ) , Ff ) * qT * vec4 ( qS * Fg * vec3 ( Fi ) , _1_0 ) ; } else { qU = qJ + vec4 ( qS * qQ * qL , qM ) ; }".split(" ")}]},
{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:"qU = qJ + vec4 ( qS * qQ * qL , qM ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:"qV = qK + qS * qR * qM ;".split(" ")}]},{TYPE:"node",NAME:"RGB",NODE_VARS:[{TYPE:"node_var",NAME:"RGB_IND",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_out",NAME:"Fj",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"Fj = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{TYPE:"node",NAME:"RGBTOBW",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Fk",QUALIFIER:["vec3"],
IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Fl",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"Fl = dot ( Fk , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{TYPE:"node",NAME:"SEPRGB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Fm",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Fn",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fo",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fp",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",
PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fn"],STATEMENTS:[{TYPE:"txt",TOKENS:"Fn = Fm . r ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fo"],STATEMENTS:[{TYPE:"txt",TOKENS:"Fo = Fm . g ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fp"],STATEMENTS:[{TYPE:"txt",TOKENS:"Fp = Fm . b ;".split(" ")}]}]}]},{TYPE:"node",NAME:"SEPHSV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Fq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",
NAME:"Fr",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fs",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Ft",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:"vec3 Fu = kj ( Fq ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fr"],STATEMENTS:[{TYPE:"txt",TOKENS:"Fr = Fu . r ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fs"],STATEMENTS:[{TYPE:"txt",TOKENS:"Fs = Fu . g ;".split(" ")}]}]},{TYPE:"node_cond",
PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ft"],STATEMENTS:[{TYPE:"txt",TOKENS:"Ft = Fu . b ;".split(" ")}]}]}]},{TYPE:"node",NAME:"SQUEEZE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Fv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Fw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Fx",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Fy",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"Fy = _1_0 / ( _1_0 + pow ( 2.71828183 , - ( Fv - Fx ) * Fw ) ) ;".split(" ")}]},
{TYPE:"node",NAME:"GAMMA",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Fz",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"FA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FB",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"FB = Fz ; if ( FB . x > _0_0 ) FB . x = pow ( Fz . x , FA ) ; if ( FB . y > _0_0 ) FB . y = pow ( Fz . y , FA ) ; if ( FB . z > _0_0 ) FB . z = pow ( Fz . z , FA ) ;".split(" ")}]},{TYPE:"node",NAME:"B4W_SRGB_TO_LINEAR",NODE_VARS:[],
DECLARATIONS:[{TYPE:"node_in",NAME:"FC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FD",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"FD = max ( vec3 ( _0_0 ) , FC ) ; FD = pow ( FD , vec3 ( 2.2 ) ) ;".split(" ")}]},{TYPE:"node",NAME:"B4W_LINEAR_TO_SRGB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"FE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FF",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"FF = max ( vec3 ( _0_0 ) , FE ) ; FF = pow ( FF , vec3 ( _1_0 / 2.2 ) ) ;".split(" ")}]},
{TYPE:"node",NAME:"TEXTURE_EMPTY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"FG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FI",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FG"],STATEMENTS:[{TYPE:"txt",TOKENS:"FG [ 2 ] = FG [ 1 ] = FG [ 0 ] = _0_0 ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FH"],STATEMENTS:[{TYPE:"txt",
TOKENS:"FH [ 2 ] = FH [ 1 ] = FH [ 0 ] = _0_0 ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FI"],STATEMENTS:[{TYPE:"txt",TOKENS:["FI","=","_0_0",";"]}]}]}]},{TYPE:"node",NAME:"TEXTURE_ENVIRONMENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Il",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Im",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"In",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"node_TEXTURE_ENVIRONMENT_var_texture",
QUALIFIER:["uniform","samplerCube"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"vec4 BN = GLSL_TEXTURE_CUBE ( node_TEXTURE_ENVIRONMENT_var_texture , Il ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Im"],STATEMENTS:[{TYPE:"txt",TOKENS:"Im = BN . xyz ; bG ( Im ) ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_In"],STATEMENTS:[{TYPE:"txt",TOKENS:"In = BN . w ;".split(" ")}]}]}]},{TYPE:"node",NAME:"TEXTURE_COLOR",NODE_VARS:[{TYPE:"node_var",
NAME:"NON_COLOR",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv2",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv3",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv4",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"FT",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"FU",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"FV",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"FW",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"FX",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",
NAME:"FY",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"FZ",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"F_",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Ga",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gb",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gc",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gd",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"node_TEXTURE_COLOR_var_texture",QUALIFIER:["uniform","sampler2D"],
IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"vec4 BN = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , so ( FT ) ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FX"],STATEMENTS:[{TYPE:"txt",TOKENS:"FX = BN . xyz ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NON_COLOR",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"txt",TOKENS:["bG","(","FX",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FY"],STATEMENTS:[{TYPE:"txt",
TOKENS:"FY = BN . w ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv2"],STATEMENTS:[{TYPE:"txt",TOKENS:"BN = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , so ( FU ) ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FZ"],STATEMENTS:[{TYPE:"txt",TOKENS:"FZ = BN . xyz ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NON_COLOR",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"txt",TOKENS:["bG","(","FZ",")",";"]}]}]}]}]},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_F_"],STATEMENTS:[{TYPE:"txt",TOKENS:"F_ = BN . w ;".split(" ")}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv3"],STATEMENTS:[{TYPE:"txt",TOKENS:"BN = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , so ( FV ) ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ga"],STATEMENTS:[{TYPE:"txt",TOKENS:"Ga = BN . xyz ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NON_COLOR",
{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"txt",TOKENS:["bG","(","Ga",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gb"],STATEMENTS:[{TYPE:"txt",TOKENS:"Gb = BN . w ;".split(" ")}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv4"],STATEMENTS:[{TYPE:"txt",TOKENS:"BN = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , so ( FW ) ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gc"],STATEMENTS:[{TYPE:"txt",
TOKENS:"Gc = BN . xyz ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NON_COLOR",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"txt",TOKENS:["bG","(","Gc",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gd"],STATEMENTS:[{TYPE:"txt",TOKENS:"Gd = BN . w ;".split(" ")}]}]}]}]}]},{TYPE:"node",NAME:"TEXTURE_NORMAL",NODE_VARS:[{TYPE:"node_var",NAME:"USE_uv2",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv3",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv4",
TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ge",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"Gf",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"Gg",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"Gh",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gi",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gj",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gk",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gl",QUALIFIER:["float"],
IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gm",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gn",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Go",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gp",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"node_TEXTURE_NORMAL_var_texture",QUALIFIER:["uniform","sampler2D"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"vec4 BN = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , so ( Ge ) ) ;".split(" ")},{TYPE:"node_cond",
PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gi"],STATEMENTS:[{TYPE:"txt",TOKENS:"Gi = normalize ( sO * ( BN . xyz - _0_5 ) ) ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gj"],STATEMENTS:[{TYPE:"txt",TOKENS:"Gj = BN . w ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv2"],STATEMENTS:[{TYPE:"txt",TOKENS:"BN = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , so ( Gf ) ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gk"],
STATEMENTS:[{TYPE:"txt",TOKENS:"Gk = normalize ( sO * ( BN . xyz - _0_5 ) ) ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gl"],STATEMENTS:[{TYPE:"txt",TOKENS:"Gl = BN . w ;".split(" ")}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv3"],STATEMENTS:[{TYPE:"txt",TOKENS:"BN = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , so ( Gg ) ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gm"],STATEMENTS:[{TYPE:"txt",TOKENS:"Gm = normalize ( sO * ( BN . xyz - _0_5 ) ) ;".split(" ")}]}]},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gn"],STATEMENTS:[{TYPE:"txt",TOKENS:"Gn = BN . w ;".split(" ")}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv4"],STATEMENTS:[{TYPE:"txt",TOKENS:"BN = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , so ( Gh ) ) ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Go"],STATEMENTS:[{TYPE:"txt",TOKENS:"Go = normalize ( sO * ( BN . xyz - _0_5 ) ) ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",
EXPRESSION:["USE_OUT_Gp"],STATEMENTS:[{TYPE:"txt",TOKENS:"Gp = BN . w ;".split(" ")}]}]}]}]}]},{TYPE:"node",NAME:"VALUE",NODE_VARS:[{TYPE:"node_var",NAME:"VALUE_ROW_IND",TOKENS:["0"]},{TYPE:"node_var",NAME:"VALUE_COL_IND",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_out",NAME:"Gq",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"Gq = u_node_values [ VALUE_ROW_IND ] [ VALUE_COL_IND ] ;".split(" ")}]},{TYPE:"node",NAME:"VECT_MATH_ADD",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Gr",
QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Gs",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Gt",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Gu",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:"Gt = Gr + Gs ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gu"],STATEMENTS:[{TYPE:"txt",TOKENS:"Gu = ( abs ( Gt [ 0 ] ) + abs ( Gt [ 1 ] ) + abs ( Gt [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{TYPE:"node",NAME:"VECT_MATH_SUBTRACT",
NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Gv",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Gw",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Gx",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Gy",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:"Gx = Gv - Gw ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gy"],STATEMENTS:[{TYPE:"txt",TOKENS:"Gy = ( abs ( Gx [ 0 ] ) + abs ( Gx [ 1 ] ) + abs ( Gx [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},
{TYPE:"node",NAME:"VECT_MATH_AVERAGE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Gz",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GA",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GC",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:"GB = Gz + GA ;".split(" ")},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_GC"],STATEMENTS:[{TYPE:"txt",TOKENS:"GC = length ( GB ) ;".split(" ")}]}]},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_GB"],STATEMENTS:[{TYPE:"txt",TOKENS:"GB = normalize ( GB ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"VECT_MATH_DOT_PRODUCT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"GD",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GG",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:"GF = vec3 ( _0_0 ) ;".split(" ")},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_GG"],STATEMENTS:[{TYPE:"txt",TOKENS:"GG = dot ( GD , GE ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"VECT_MATH_CROSS_PRODUCT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"GH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GI",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GK",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:"GJ = cross ( GH , GI ) ;".split(" ")},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_GK"],STATEMENTS:[{TYPE:"txt",TOKENS:"GK = length ( GJ ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"VECT_MATH_NORMALIZE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"GL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GM",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GO",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:"GN = normalize ( GL ) ;".split(" ")},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_GO"],STATEMENTS:[{TYPE:"txt",TOKENS:"GO = length ( GL ) ;".split(" ")}]}]},{TYPE:"txt",TOKENS:["GM",";"]}]},{TYPE:"node",NAME:"B4W_REFLECT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"GV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GW",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GX",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"GX = reflect ( _ ( u_view_tsr_inverse , GV ) , GW ) ;".split(" ")}]},
{TYPE:"node",NAME:"B4W_REFLECT_WORLD",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"GY",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"vec3 Io = - oy . xyz ; GZ = reflect ( Io , GY ) ;".split(" ")}]},{TYPE:"node",NAME:"B4W_PARALLAX",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"G_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ha",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hb",QUALIFIER:["const",
"float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hc",QUALIFIER:["const","float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Hd",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"node_B4W_PARALLAX_var_texture",QUALIFIER:["uniform","sampler2D"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"float bS = length ( sR ) ; if ( bS < Hc ) { vec2 ce = so ( G_ ) ; float ci = clamp ( _0_5 * ( Hc - bS ) , _0_0 , _1_0 ) ; float hK = Ha * ci ; vec3 ck = normalize ( oy * sO ) ; float cl = _1_0 / Hb ; vec2 cm = ck . xy * hK / ( Hb * ck . z ) ; float cn = _1_0 ; float co = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , ce ) . a ; for ( float cq = 1.0 ; cq <= Hb ; cq ++ ) { if ( co < cn ) { cn -= cl ; ce -= cm ; co = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , ce ) . a ; } } vec2 cr = ce + cm ; float cs = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , cr ) . a - ( cn + cl ) ; float ct = co - cn ; float cu = ct / ( ct - cs ) ; ce = cu * cr + ( _1_0 - cu ) * ce ; Hd = sn ( ce ) ; } else Hd = G_ ;".split(" ")}]},
{TYPE:"node",NAME:"B4W_CLAMP",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"He",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Hf",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"Hf = clamp ( He , _0_0 , _1_0 ) ;".split(" ")}]},{TYPE:"node",NAME:"B4W_REFRACTION",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Hg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hh",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Hi",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],
STATEMENTS:[{TYPE:"txt",TOKENS:["Hi","=","Hg",";"]}]},{TYPE:"node",NAME:"B4W_TRANSLUCENCY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Hj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hk",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hl",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hm",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ho",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",
NAME:"Hp",QUALIFIER:["vec4"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ho"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ho","=","Hj",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Hp"],STATEMENTS:[{TYPE:"txt",TOKENS:"Hp = vec4 ( Hk , Hl , Hm , Hn ) ;".split(" ")}]}]}]},{TYPE:"node",NAME:"B4W_TIME",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"Hq",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Hq","=","u_time",
";"]}]},{TYPE:"node",NAME:"B4W_SMOOTHSTEP",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Hr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hs",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ht",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Hu",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"Hu = smoothstep ( Hs , Ht , Hr ) ;".split(" ")}]},{TYPE:"node",NAME:"B4W_GLOW_OUTPUT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Hv",QUALIFIER:["vec3"],
IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hw",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"E = Hv ; I = Hw ;".split(" ")}]},{TYPE:"node",NAME:"B4W_VECTOSCAL",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Hx",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Hy",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"Hy = ( Hx . r + Hx . g + Hx . b ) / 3.0 ;".split(" ")}]},{TYPE:"node",NAME:"B4W_SCALTOVEC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Hz",
QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"HA",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:"HA [ 0 ] = Hz ; HA [ 1 ] = Hz ; HA [ 2 ] = Hz ;".split(" ")}]},{TYPE:"nodes_global"},{TYPE:"txt",TOKENS:"void J ( in vec3 oy , out vec3 E , out vec3 F , out vec3 G , out vec4 H , out float I ) { E = vec3 ( _0_0 ) ; F = vec3 ( _0_0 ) ; G = vec3 ( _0_0 ) ; H = vec4 ( _0_0 ) ; I = _0_0 ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO",
"CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_NORMAL_MAP","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:11}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sL","=","j",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",
{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"if ( gl_FrontFacing == false )".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","gl_FrontFacing",")"]}]}}]},{TYPE:"txt",TOKENS:"sL = sL ; else sL = - sL ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_NORMAL_MAP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sM","=","sL",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",
"USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 sN = normalize ( sL ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DOUBLE_SIDED_LIGHTING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ox","=","sN",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 ox = normalize ( j ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_NO"],GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:["vec3","sK","=","sN",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 W = cross ( sN , k . xyz ) * k . w ; mat3 sO = mat3 ( k . xyz , W , sN ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_NORMAL_MAP"],GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:"vec3 W = cross ( sL , k . xyz ) * k . w ; mat3 sQ = mat3 ( k . xyz , W , sL ) ;".split(" ")}]}}]}]}}]},{TYPE:"txt",TOKENS:"vec3 ow = h ; vec4 sR = i ; float sS = u_emit ; float sT = u_ambient ;".split(" ")},{TYPE:"nodes_main"},{TYPE:"txt",TOKENS:["}"]}]}}]}]};e["include/particles_nodes.glslv"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"PARTICLES_NODES_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"PARTICLES_NODES_GLSLV",TOKENS:[""]},{TYPE:"node",NAME:"TEX_COORD_UV",
NODE_VARS:[],DECLARATIONS:[],STATEMENTS:[{TYPE:"txt",TOKENS:["A","=","Iu",";"]}]},{TYPE:"node",NAME:"UV_MERGED",NODE_VARS:[],DECLARATIONS:[],STATEMENTS:[{TYPE:"txt",TOKENS:["A","=","Iu",";"]}]},{TYPE:"node",NAME:"UVMAP",NODE_VARS:[],DECLARATIONS:[],STATEMENTS:[{TYPE:"txt",TOKENS:["A","=","Iu",";"]}]},{TYPE:"node",NAME:"GEOMETRY_UV",NODE_VARS:[],DECLARATIONS:[],STATEMENTS:[{TYPE:"txt",TOKENS:["A","=","Iu",";"]}]},{TYPE:"node",NAME:"PARTICLE_INFO",NODE_VARS:[{TYPE:"node_var",NAME:"PART_INFO_SIZE",TOKENS:["0"]},
{TYPE:"node_var",NAME:"PART_INFO_AGE",TOKENS:["0"]},{TYPE:"node_var",NAME:"PART_INFO_LT",TOKENS:["0"]},{TYPE:"node_var",NAME:"PART_INFO_LOC",TOKENS:["0"]},{TYPE:"node_var",NAME:"PART_INFO_IND",TOKENS:["0"]},{TYPE:"node_var",NAME:"PART_INFO_VEL",TOKENS:["0"]},{TYPE:"node_var",NAME:"PART_INFO_A_VEL",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_param",NAME:"HY",QUALIFIER:["GLSL_OUT","vec4"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"HZ",QUALIFIER:["GLSL_OUT","vec3"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"H_",
QUALIFIER:["GLSL_OUT","vec3"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"Ia",QUALIFIER:["GLSL_OUT","vec3"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"node_PARTICLE_INFO_var_a_p_indices",QUALIFIER:["GLSL_IN","float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["PART_INFO_SIZE"],STATEMENTS:[{TYPE:"txt",TOKENS:"HY [ 3 ] = It ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["PART_INFO_AGE"],STATEMENTS:[{TYPE:"txt",TOKENS:"HY [ 1 ] = Is ;".split(" ")}]}]},
{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["PART_INFO_LT"],STATEMENTS:[{TYPE:"txt",TOKENS:"HY [ 2 ] = Iv ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["PART_INFO_LOC"],STATEMENTS:[{TYPE:"txt",TOKENS:["HZ","=","Ip",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["PART_INFO_IND"],STATEMENTS:[{TYPE:"txt",TOKENS:"HY [ 0 ] = node_PARTICLE_INFO_var_a_p_indices ;".split(" ")}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["PART_INFO_VEL"],STATEMENTS:[{TYPE:"txt",
TOKENS:["H_","=","Iq",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["PART_INFO_A_VEL"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ia","=","Ir",";"]}]}]}]},{TYPE:"nodes_global"},{TYPE:"txt",TOKENS:"void J ( in vec3 Ip , in vec3 Iq , in vec3 Ir , in float Is , in float It , in vec2 Iu , in float Iv ) {".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["A","=","Iu",
";"]}]}}]},{TYPE:"nodes_main"},{TYPE:"txt",TOKENS:["}"]}]}}]}]};e["include/precision_statement.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"PRECISION_STATEMENT_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"PRECISION_STATEMENT_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"txt",TOKENS:["precision","PRECISION","float",";"]}]}}]}]};e["include/procedural.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"PROCEDURAL_GLSLF",GROUP:{TYPE:"grp",
PARTS:[{TYPE:"define",NAME:"PROCEDURAL_GLSLF",TOKENS:[""]},{TYPE:"txt",TOKENS:"vec4 Iw ( vec4 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec3 Iw ( vec3 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec2 Iw ( vec2 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec4 Ix ( vec4 x ) { return x - floor ( x * ( _1_0 / 7.0 ) ) * 7.0 ; } vec4 Iy ( vec4 x ) { return Iw ( ( 34.0 * x + 5.0 ) * x ) ; }".split(" ")},{TYPE:"define",NAME:"K",TOKENS:["0.142857142857"]},
{TYPE:"define",NAME:"K2",TOKENS:["0.0714285714285"]},{TYPE:"define",NAME:"JITTER",TOKENS:["0.7"]},{TYPE:"txt",TOKENS:"vec2 fK ( vec2 Iz ) { vec2 IA = Iw ( floor ( Iz ) ) ; vec2 IB = fract ( Iz ) ; vec4 IC = IB . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; vec4 ID = IB . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; vec4 p = Iy ( IA . x + vec4 ( _0_0 , _1_0 , _0_0 , _1_0 ) ) ; p = Iy ( p + IA . y + vec4 ( _0_0 , _0_0 , _1_0 , _1_0 ) ) ; vec4 IE = Ix ( p ) * K + K2 ; vec4 IF = Ix ( floor ( p * K ) ) * K + K2 ; vec4 IG = IC + JITTER * IE ; vec4 IH = ID + JITTER * IF ; vec4 dC = IG * IG + IH * IH ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:[1],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"dC . xy = min ( dC . xy , dC . zw ) ; dC . x = min ( dC . x , dC . y ) ; return dC . xx ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"dC . xy = ( dC . x < dC . y ) ? dC . xy : dC . yx ; dC . xz = ( dC . x < dC . z ) ? dC . xz : dC . zx ; dC . xw = ( dC . x < dC . w ) ? dC . xw : dC . wx ; dC . y = min ( dC . y , dC . z ) ; dC . y = min ( dC . y , dC . w ) ; return sqrt ( dC . xy ) ;".split(" ")}]}}]},
{TYPE:"txt",TOKENS:"} vec3 la ( vec2 Iz , float II ) { vec2 IA = Iw ( floor ( Iz ) ) ; vec2 IB = fract ( Iz ) ; vec4 IC = IB . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; vec4 ID = IB . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; vec4 p = Iy ( IA . x + vec4 ( _0_0 , _1_0 , _0_0 , _1_0 ) ) ; p = Iy ( p + IA . y + vec4 ( _0_0 , _0_0 , _1_0 , _1_0 ) ) ; vec4 IE = Ix ( p ) * K + K2 ; vec4 IF = Ix ( floor ( p * K ) ) * K + K2 ; vec4 IG = IC + JITTER * IE ; vec4 IH = ID + JITTER * IF ; vec4 IJ = IG * IG + IH * IH ; IG += II ; IH += II ; vec4 IK = IG * IG + IH * IH ; IG += II ; IH += II ; vec4 IL = IG * IG + IH * IH ; IJ . xy = min ( IJ . xy , IJ . zw ) ; IJ . x = min ( IJ . x , IJ . y ) ; IK . xy = min ( IK . xy , IK . zw ) ; IK . x = min ( IK . x , IK . y ) ; IL . xy = min ( IL . xy , IL . zw ) ; IL . x = min ( IL . x , IL . y ) ; return vec3 ( IJ . x , IK . x , IL . x ) ; } vec3 IM ( vec3 x ) { return Iw ( ( ( x * 34.0 ) + _1_0 ) * x ) ; } float fz ( vec2 kU ) { const vec4 IN = vec4 ( 0.211324865405187 , 0.366025403784439 , - 0.577350269189626 , 0.024390243902439 ) ; vec2 cq = floor ( kU + dot ( kU , IN . yy ) ) ; vec2 IO = kU - cq + dot ( cq , IN . xx ) ; vec2 IP ; IP = ( IO . x > IO . y ) ? vec2 ( _1_0 , _0_0 ) : vec2 ( _0_0 , _1_0 ) ; vec4 IQ = IO . xyxy + IN . xxzz ; IQ . xy -= IP ; cq = Iw ( cq ) ; vec3 p = IM ( IM ( cq . y + vec3 ( _0_0 , IP . y , _1_0 ) ) + cq . x + vec3 ( _0_0 , IP . x , _1_0 ) ) ; vec3 aA = max ( 0.5 - vec3 ( dot ( IO , IO ) , dot ( IQ . xy , IQ . xy ) , dot ( IQ . zw , IQ . zw ) ) , _0_0 ) ; aA = aA * aA ; aA = aA * aA ; vec3 x = 2.0 * fract ( p * IN . www ) - _1_0 ; vec3 co = abs ( x ) - 0.5 ; vec3 IE = floor ( x + 0.5 ) ; vec3 IR = x - IE ; aA *= 1.79284291400159 - 0.85373472095314 * ( IR * IR + co * co ) ; vec3 g ; g . x = IR . x * IO . x + co . x * IO . y ; g . yz = IR . yz * IQ . xz + co . yz * IQ . yw ; return 130.0 * dot ( aA , g ) ; } vec2 IU ( vec2 f_ ) { float IJ = dot ( f_ , vec2 ( 12.9898 , 78.233 ) ) ; float IK = dot ( f_ , vec2 ( 12.9898 , 78.233 ) * 2.0 ) ; float IS = fract ( sin ( IJ ) * 43758.5453 ) * 2.0 - _1_0 ; float IT = fract ( sin ( IK ) * 43758.5453 ) * 2.0 - _1_0 ; return vec2 ( IS , IT ) ; } float lk ( vec2 IV ) { return fract ( sin ( dot ( IV , vec2 ( 12.9898 , 78.233 ) ) ) * 43758.5453 ) ; }".split(" ")}]}}]}]};
e["include/refraction.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"REFRACTION_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"REFRACTION_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"REFRACTIVE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_REFRACTION_CORRECTION",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_REFRACTION_CORRECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"pack.glslf"}]}}]},
{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_REFRACTION_CORRECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float eW ( in float cW , inout vec2 eV , in vec2 eM ) { vec4 IW = GLSL_TEXTURE ( u_scene_depth , eV ) ; float eX = cV ( IW ) ; if ( eX < m ) { eV = eM ; return cW ; } else { return eX ; } return cW ; }".split(" ")}]}}]},{TYPE:"txt",TOKENS:"vec3 cS ( in vec3 ru , in vec2 IX ) { vec2 eM = ru . xy / ru . z ; vec2 eV = eM + IX ;".split(" ")},{TYPE:"cond",
PARTS:[{TYPE:"if",EXPRESSION:["USE_REFRACTION_CORRECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 cU = GLSL_TEXTURE_PROJ ( u_scene_depth , ru ) ; float cW = cV ( cU ) ; eW ( cW , eV , eM ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"vec3 fa = GLSL_TEXTURE ( u_refractmap , eV ) . rgb ; bG ( fa ) ; return fa ; }".split(" ")}]}}]}]}}]}]};e["include/scale_texcoord.glslv"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SCALE_TEXCOORD_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SCALE_TEXCOORD_GLSLV",
TOKENS:[""]},{TYPE:"txt",TOKENS:"vec2 az ( vec2 ce , vec3 IY ) { return ( ce + 0.5 ) * IY . xy - 0.5 ; }".split(" ")}]}}]}]};e["include/shadow.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SHADOW_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SHADOW_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"SHADOW_TEX_RES",TOKENS:["2048.0"]},{TYPE:"var",NAME:"CSM_FADE_LAST_CASCADE",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_BLEND_BETWEEN_CASCADES",TOKENS:["0"]},
{TYPE:"var",NAME:"RGBA_SHADOWS",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},{TYPE:"var",NAME:"NUM_CAST_LAMPS",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION1",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION2",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION3",TOKENS:["0"]},{TYPE:"var",NAME:"COMPARED_MODE",TOKENS:["0"]},{TYPE:"var",NAME:"POISSON_DISK_NUM",TOKENS:["NO_SOFT_SHADOWS"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",
{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"procedural.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"const float IZ = 0.1 ; const float I_ = 0.1 ; const float Ja = - 0.01 ; const float Jb = 0.05 ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POISSON_DISK_NUM","POISSON_X_16",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 Jc = vec4 ( 0.14383161 , 0.34495938 , - 0.38277543 , - 0.26496911 ) ; vec4 Jd = vec4 ( 0.53742981 , 0.19984126 , 0.79197514 , - 0.094184101 ) ; vec4 Je = vec4 ( - 0.94201624 , - 0.91588581 , - 0.2418884 , 0.44323325 ) ; vec4 Jf = vec4 ( - 0.81544232 , 0.94558609 , - 0.81409955 , 0.97484398 ) ; vec4 Jg = vec4 ( - 0.1410079 , 0.2938776 , 0.27676845 , - 0.41893023 ) ; vec4 Jh = vec4 ( - 0.4737342 , 0.78641367 , 0.19090188 , - 0.9293887 ) ; vec4 Ji = vec4 ( - 0.39906216 , 0.45771432 , 0.99706507 , - 0.97511554 ) ; vec4 Jj = vec4 ( - 0.87912464 , - 0.76890725 , 0.9143759 , 0.7564837 ) ;".split(" ")}]}},
{TYPE:"elif",EXPRESSION:["POISSON_DISK_NUM","POISSON_X_8",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec2 Jc = vec2 ( - 0.37192261 , 0.47109537 ) ; vec2 Jd = vec2 ( - 0.6807477 , 0.69048062 ) ; vec2 Je = vec2 ( 0.11615683 , - 0.91318524 ) ; vec2 Jf = vec2 ( 0.93688596 , - 0.16948928 ) ; vec2 Jg = vec2 ( - 0.89699117 , 0.74092316 ) ; vec2 Jh = vec2 ( 0.38263656 , - 0.66119884 ) ; vec2 Ji = vec2 ( - 0.08193062 , - 0.21275223 ) ; vec2 Jj = vec2 ( 0.05578877 , 0.84225623 ) ;".split(" ")}]}},
{TYPE:"elif",EXPRESSION:["POISSON_DISK_NUM","POISSON_X_4",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec2 Jc = vec2 ( - 0.51808083 , 0.0 ) ; vec2 Jd = vec2 ( 0.5741194 , 0.0 ) ; vec2 Je = vec2 ( - 0.68048857 , 0.0 ) ; vec2 Jf = vec2 ( 0.82934988 , 0.0 ) ; vec2 Jg = vec2 ( 0.70009436 , 0.0 ) ; vec2 Jh = vec2 ( - 0.78790467 , 0.0 ) ; vec2 Ji = vec2 ( - 0.58619489 , 0.0 ) ; vec2 Jj = vec2 ( 0.41902178 , 0.0 ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"bool Jl ( vec2 iO , float Jk ) { return all ( lessThanEqual ( iO , vec2 ( 1.0 + Jk ) ) ) && all ( greaterThanEqual ( iO , vec2 ( 0.0 - Jk ) ) ) ; } float Js ( float Jm , float Jn , mat2 Jo , vec3 Jp , float Jq , PRECISION GLSL_SMPLR2D_SHDW Jr ) {".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec2 iO , fM ; fM . x = Jm ; fM . y = Jn ; fM = Jo * fM ; iO = Jp . xy + fM * Jq / SHADOW_TEX_RES ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec2 iO = Jp . xy ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:"if ( ! Jl ( iO , Ja ) ) return 1.0 ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["RGBA_SHADOWS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float et = cV ( GLSL_TEXTURE ( Jr , iO ) ) ; return step ( Jp . z , et ) ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["COMPARED_MODE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"return GLSL_TEXTURE ( Jr , vec3 ( iO , Jp . z ) ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"return step ( Jp . z , GLSL_TEXTURE ( Jr , iO ) . r ) ;".split(" ")}]}}]},
{TYPE:"txt",TOKENS:"} float Jx ( vec3 Jp , PRECISION GLSL_SMPLR2D_SHDW Jr , float Jq ) { float Jt = 0.0 ; Jp . z = clamp ( Jp . z , 0.0 , 1.0 ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float Ju = IU ( Jp . xy ) . x * M_PI ; float Jv = cos ( Ju ) ; float Jw = sin ( Ju ) ; mat2 Jo = mat2 ( Jv , Jw , - Jw , Jv ) ; for ( int cq = 0 ; cq < POISSON_DISK_NUM ; cq ++ ) { Jt += Js ( Jc [ cq ] , Jg [ cq ] , Jo , Jp , Jq , Jr ) ; Jt += Js ( Jd [ cq ] , Jh [ cq ] , Jo , Jp , Jq , Jr ) ; Jt += Js ( Je [ cq ] , Ji [ cq ] , Jo , Jp , Jq , Jr ) ; Jt += Js ( Jf [ cq ] , Jj [ cq ] , Jo , Jp , Jq , Jr ) ; } return clamp ( Jt / ( float ( POISSON_DISK_NUM ) * 4.0 ) , 0.0 , 1.0 ) ;".split(" ")}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"return Js ( 0.0 , 0.0 , mat2 ( 0.0 ) , Jp , Jq , Jr ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"} float JG ( vec3 Jy , PRECISION GLSL_SMPLR2D_SHDW Jz , vec3 JA , PRECISION GLSL_SMPLR2D_SHDW JB , float JC , float JD , float aL ) { float JE , JF ; Jy . z = clamp ( Jy . z , 0.0 , 1.0 ) ; JA . z = clamp ( JA . z , 0.0 , 1.0 ) ; JE = 0.0 ; JF = 0.0 ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{TYPE:"non_equal_expr",
PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float Ju = IU ( Jy . xy ) . x * M_PI ; float Jv = cos ( Ju ) ; float Jw = sin ( Ju ) ; mat2 Jo = mat2 ( Jv , Jw , - Jw , Jv ) ; for ( int cq = 0 ; cq < POISSON_DISK_NUM ; cq ++ ) { JE += Js ( Jc [ cq ] , Jg [ cq ] , Jo , Jy , JC , Jz ) ; JE += Js ( Jd [ cq ] , Jh [ cq ] , Jo , Jy , JC , Jz ) ; JE += Js ( Je [ cq ] , Ji [ cq ] , Jo , Jy , JC , Jz ) ; JE += Js ( Jf [ cq ] , Jj [ cq ] , Jo , Jy , JC , Jz ) ; } for ( int cq = 0 ; cq < POISSON_DISK_NUM ; cq ++ ) { JF += Js ( Jc [ cq ] , Jg [ cq ] , Jo , JA , JD , JB ) ; JF += Js ( Jd [ cq ] , Jh [ cq ] , Jo , JA , JD , JB ) ; JF += Js ( Je [ cq ] , Ji [ cq ] , Jo , JA , JD , JB ) ; JF += Js ( Jf [ cq ] , Jj [ cq ] , Jo , JA , JD , JB ) ; } JE = mix ( JE , JF , aL ) ; JE /= ( float ( POISSON_DISK_NUM ) * 4.0 ) ;".split(" ")}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"JE += Js ( 0.0 , 0.0 , mat2 ( 0.0 ) , Jy , JC , Jz ) ; JF += Js ( 0.0 , 0.0 , mat2 ( 0.0 ) , JA , JD , JB ) ; JE = mix ( JE , JF , aL ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"return clamp ( JE , 0.0 , 1.0 ) ; } float JH ( vec2 iO ) { float a = min ( iO . x , iO . y ) ; float b = min ( 1.0 - iO . x , 1.0 - iO . y ) ; return min ( a , b ) ; } float JJ ( float vo , float JI ) { if ( JI >= 0.0 && JI <= I_ ) vo = ( vo - 1.0 ) / I_ * JI + 1.0 ; return vo ; } float JO ( vec3 JK , vec3 JL , PRECISION GLSL_SMPLR2D_SHDW Jz , PRECISION GLSL_SMPLR2D_SHDW JB , float JC , float JD , float JM , float et ) { float vo ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_BLEND_BETWEEN_CASCADES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float JI = JH ( JK . xy ) ; if ( - et > JM && JI >= 0.0 && JI <= IZ && Jl ( JL . xy , 0.0 ) ) { float JN = 1.0 - JI / IZ ; vo = JG ( JK , Jz , JL , JB , JC , JD , JN ) ; } else".split(" ")}]}}]},{TYPE:"txt",TOKENS:"vo = Jx ( JK , Jz , JC ) ; return vo ; } float JQ ( vec3 JP , PRECISION GLSL_SMPLR2D_SHDW Jr , float Jq , float JM , float et ) { float vo = Jx ( JP , Jr , Jq ) ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_FADE_LAST_CASCADE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"if ( - et > JM ) { float JI = JH ( JP . xy ) ; vo = JJ ( vo , JI ) ; }".split(" ")}]}}]},{TYPE:"txt",TOKENS:"return vo ; } vec4 ev ( float et ) { float vo = 1.0 ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","JR","=","u_pcf_blur_radii",";"]}]}},{TYPE:"else",
GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 JR = vec4 ( 0.0 ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"vec3 Jy = n . xyz / n . w ; if ( n . w < 0.0 ) Jy . z = 0.0 ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 JA = o . xyz / o . w ; if ( o . w < 0.0 ) JA . z = 0.0 ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2",
"NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 JS = u . xyz / u . w ; if ( u . w < 0.0 ) JS . z = 0.0 ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 JT = v . xyz / v . w ; if ( v . w < 0.0 ) JT . z = 0.0 ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1"],
GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"if ( Jl ( Jy . xy , 0.0 ) ) { vo = JO ( Jy , JA , u_shadow_map0 , u_shadow_map1 , JR [ 0 ] , JR [ 1 ] , u_csm_center_dists [ 0 ] , et ) ; }".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"if ( Jl ( Jy . xy , Jb ) ) { vo = JQ ( Jy , u_shadow_map0 , JR [ 0 ] , u_csm_center_dists [ 0 ] , et ) ; }".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"else { if ( Jl ( JA . xy , 0.0 ) ) {".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vo = JO ( JA , JS , u_shadow_map1 , u_shadow_map2 , JR [ 1 ] , JR [ 2 ] , u_csm_center_dists [ 1 ] , et ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vo = JQ ( JA , u_shadow_map1 , JR [ 1 ] , u_csm_center_dists [ 1 ] , et ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:"else { if ( Jl ( JS . xy , 0.0 ) ) {".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vo = JO ( JS , JT , u_shadow_map2 , u_shadow_map3 , JR [ 2 ] , JR [ 3 ] , u_csm_center_dists [ 2 ] , et ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vo = JQ ( JS , u_shadow_map2 , JR [ 2 ] , u_csm_center_dists [ 2 ] , et ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3"],
GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"else { if ( Jl ( JT . xy , 0.0 ) ) vo = JQ ( JT , u_shadow_map3 , JR [ 3 ] , u_csm_center_dists [ 3 ] , et ) ; }".split(" ")}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float JU = Jx ( JA , u_shadow_map1 , JR [ 0 ] ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float",
"JU","=","0.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float JV = Jx ( JS , u_shadow_map2 , JR [ 0 ] ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","JV","=","0.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float JW = Jx ( JT , u_shadow_map3 , JR [ 0 ] ) ;".split(" ")}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","JW","=","1.0",";"]}]}}]},{TYPE:"txt",TOKENS:"return vec4 ( vo , JU , JV , JW ) ; }".split(" ")}]}}]},{TYPE:"txt",TOKENS:"vec4 cH ( inout vec3 cD ) {".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 Jt = GLSL_TEXTURE ( u_shadow_mask , l . xy / l . z ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_CAST_LAMPS",
3,{TYPE:"l_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"cD *= Jt . a ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["return","Jt",";"]}]}},{TYPE:"elif",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 Jt = ev ( i . z ) ; return Jt ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"return vec4 ( 1.0 ) ;".split(" ")}]}}]},
{TYPE:"txt",TOKENS:["}"]}]}}]}]};e["include/shadow.glslv"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SHADOW_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SHADOW_GLSLV",TOKENS:[""]},{TYPE:"var",NAME:"MAC_OS_SHADOW_HACK",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_TEX_RES",TOKENS:["2048.0"]},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},{TYPE:"var",NAME:"NUM_CAST_LAMPS",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION1",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION2",TOKENS:["0"]},
{TYPE:"var",NAME:"CSM_SECTION3",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"math.glslv"},{TYPE:"txt",TOKENS:"vec4 J_ ( mat4 JX , vec4 JY , mat4 JZ ) { vec2 ey = ( JX * JZ [ 3 ] ) . xy ; float ez = SHADOW_TEX_RES / 2.0 ; ey = floor ( ey * ez + 0.5 ) / ez - ey ; vec4 Jp = JX * JY ; Jp . xy += ey ; Jp . xyz = 0.5 * ( Jp . xyz + Jp . w ) ; return Jp ; } void cd ( vec3 fr , vec3 Ka ) {".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAC_OS_SHADOW_HACK"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"mat4 JZ = bh ( u_v_light_tsr [ 0 ] ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"mat4 JZ = bh ( mat3 ( u_v_light_ts [ 0 ] . xyz , vec3 ( u_v_light_ts [ 0 ] . w ) , u_v_light_r [ 0 ] . xyz * ( 2. * float ( u_v_light_r [ 0 ] . w >= 0. ) - 1. ) ) ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"vec4 Kb = JZ * vec4 ( fr + u_normal_offset * Ka , 1.0 ) ; n = J_ ( u_p_light_matrix0 , Kb , JZ ) ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAC_OS_SHADOW_HACK"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"JZ = bh ( u_v_light_tsr [ 1 ] ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"JZ = bh ( mat3 ( u_v_light_ts [ 1 ] . xyz , vec3 ( u_v_light_ts [ 1 ] . w ) , u_v_light_r [ 1 ] . xyz * ( 2. * float ( u_v_light_r [ 1 ] . w >= 0. ) - 1. ) ) ) ;".split(" ")}]}}]},
{TYPE:"txt",TOKENS:"Kb = JZ * vec4 ( fr + u_normal_offset * Ka , 1.0 ) ; o = J_ ( u_p_light_matrix1 , Kb , JZ ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAC_OS_SHADOW_HACK"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"JZ = bh ( u_v_light_tsr [ 2 ] ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"JZ = bh ( mat3 ( u_v_light_ts [ 2 ] . xyz , vec3 ( u_v_light_ts [ 2 ] . w ) , u_v_light_r [ 2 ] . xyz * ( 2. * float ( u_v_light_r [ 2 ] . w >= 0. ) - 1. ) ) ) ;".split(" ")}]}}]},
{TYPE:"txt",TOKENS:"Kb = JZ * vec4 ( fr + u_normal_offset * Ka , 1.0 ) ; u = J_ ( u_p_light_matrix2 , Kb , JZ ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAC_OS_SHADOW_HACK"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"JZ = bh ( u_v_light_tsr [ 3 ] ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"JZ = bh ( mat3 ( u_v_light_ts [ 3 ] . xyz , vec3 ( u_v_light_ts [ 3 ] . w ) , u_v_light_r [ 3 ] . xyz * ( 2. * float ( u_v_light_r [ 3 ] . w >= 0. ) - 1. ) ) ) ;".split(" ")}]}}]},
{TYPE:"txt",TOKENS:"Kb = JZ * vec4 ( fr + u_normal_offset * Ka , 1.0 ) ; v = J_ ( u_p_light_matrix3 , Kb , JZ ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"o = J_ ( u_p_light_matrix1 , Kb , JZ ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"u = J_ ( u_p_light_matrix2 , Kb , JZ ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3"],
GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"v = J_ ( u_p_light_matrix3 , Kb , JZ ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]}]}}]}]};e["include/skin.glslv"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SKIN_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SKIN_GLSLV",TOKENS:[""]},{TYPE:"var",NAME:"DISABLE_TANGENT_SKINNING",TOKENS:["0"]},{TYPE:"var",NAME:"SKINNED",TOKENS:["0"]},{TYPE:"var",NAME:"FRAMES_BLENDING",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],
GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"math.glslv"},{TYPE:"define",NAME:"SKIN_SLERP",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKIN_SLERP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 Ki ( in vec4 qZ , in vec4 rF , in float Kc ) { float Kd = qZ [ 0 ] * rF [ 0 ] + qZ [ 1 ] * rF [ 1 ] + qZ [ 2 ] * rF [ 2 ] + qZ [ 3 ] * rF [ 3 ] ; if ( Kd < 0.0 ) { rF *= - 1.0 ; Kd = - Kd ; } if ( abs ( Kd ) >= 1.0 ) return qZ ; float Ke = acos ( Kd ) ; float Kf = sqrt ( 1.0 - Kd * Kd ) ; if ( abs ( Kf ) < 0.001 ) return vec4 ( qZ * 0.5 + rF * 0.5 ) ; float Kg = sin ( ( 1.0 - Kc ) * Ke ) / Kf ; float Kh = sin ( Kc * Ke ) / Kf ; return qZ * Kg + rF * Kh ; }".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FRAMES_BLENDING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 Kw ( in vec3 O , in vec4 Kj , in vec4 Kk , in vec4 Kl , in vec4 Km , in float Kn ) { vec3 Ko = rl ( u_arm_rel_trans . xyz , vec3 ( u_arm_rel_trans . w ) , u_arm_rel_quat , O ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKIN_SLERP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 qZ = Ki ( Kj , Kk , Kn ) ; vec4 Kp = mix ( Kl , Km , Kn ) ; vec3 Kq = T ( qZ , Ko ) ; vec3 Kr = Kq * Kp . w + Kp . xyz ;".split(" ")}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 Ks = T ( Kj , Ko ) ; vec3 Kt = T ( Kk , Ko ) ; vec3 Ku = Ks * Kl . w + Kl . xyz ; vec3 Kv = Kt * Km . w + Km . xyz ; vec3 Kr = mix ( Ku , Kv , Kn ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"return rn ( u_arm_rel_trans . xyz , vec3 ( u_arm_rel_trans . w ) , u_arm_rel_quat , Kr ) ; } vec3 KC ( in vec3 Kx , in vec4 Kj , in vec4 Kk , in float Kn ) { vec3 Ky = rm ( u_arm_rel_trans . xyz , vec3 ( u_arm_rel_trans . w ) , u_arm_rel_quat , Kx ) ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKIN_SLERP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 qZ = Ki ( Kj , Kk , Kn ) ; vec3 Kz = T ( qZ , Ky ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 KA = T ( Kj , Ky ) ; vec3 KB = T ( Kk , Ky ) ; vec3 Kz = mix ( KA , KB , Kn ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"return ro ( u_arm_rel_trans . xyz , vec3 ( u_arm_rel_trans . w ) , u_arm_rel_quat , Kz ) ; }".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:"vec3 Kw ( in vec3 O , in vec4 Kj , in vec4 Kl ) { vec3 Ko = rl ( u_arm_rel_trans . xyz , vec3 ( u_arm_rel_trans . w ) , u_arm_rel_quat , O ) ; vec3 Kq = T ( Kj , Ko ) ; vec3 Kr = Kq * Kl . w + Kl . xyz ; return rn ( u_arm_rel_trans . xyz , vec3 ( u_arm_rel_trans . w ) , u_arm_rel_quat , Kr ) ; } vec3 KC ( in vec3 Kx , in vec4 Kj ) { vec3 Ky = rm ( u_arm_rel_trans . xyz , vec3 ( u_arm_rel_trans . w ) , u_arm_rel_quat , Kx ) ; vec3 Kz = T ( Kj , Ky ) ; return ro ( u_arm_rel_trans . xyz , vec3 ( u_arm_rel_trans . w ) , u_arm_rel_quat , Kz ) ; }".split(" ")}]}}]},
{TYPE:"txt",TOKENS:"void an ( inout vec3 O , inout vec3 V , inout vec3 W , inout vec3 U ) {".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FRAMES_BLENDING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","KD","=","u_frame_factor",";"]}]}}]},{TYPE:"txt",TOKENS:"if ( a_influence . y > 0.0 ) { vec3 jH = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 KE = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 KF = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 KG = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec4 KH = a_influence ; for ( int cq = 0 ; cq < 4 ; cq ++ ) { int KI = int ( KH [ cq ] ) ; float KJ = fract ( KH [ cq ] ) ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FRAMES_BLENDING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"KE += KJ * KC ( V , u_quatsb [ KI ] , u_quatsa [ KI ] , KD ) ; KF += KJ * KC ( W , u_quatsb [ KI ] , u_quatsa [ KI ] , KD ) ; KG += KJ * KC ( U , u_quatsb [ KI ] , u_quatsa [ KI ] , KD ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"jH += KJ * Kw ( O , u_quatsb [ KI ] , u_transb [ KI ] ) ; KG += KJ * KC ( U , u_quatsb [ KI ] ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",
EXPRESSION:["DISABLE_TANGENT_SKINNING",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"KE += KJ * KC ( V , u_quatsb [ KI ] ) ; KF += KJ * KC ( W , u_quatsb [ KI ] ) ;".split(" ")}]}}]}]}}]},{TYPE:"txt",TOKENS:["}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FRAMES_BLENDING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"int KI = int ( KH [ 0 ] ) ; float KJ = fract ( KH [ 0 ] ) ; jH += KJ * Kw ( O , u_quatsb [ KI ] , u_quatsa [ KI ] , u_transb [ KI ] , u_transa [ KI ] , KD ) ; KI = int ( KH [ 1 ] ) ; KJ = fract ( KH [ 1 ] ) ; jH += KJ * Kw ( O , u_quatsb [ KI ] , u_quatsa [ KI ] , u_transb [ KI ] , u_transa [ KI ] , KD ) ; KI = int ( KH [ 2 ] ) ; KJ = fract ( KH [ 2 ] ) ; jH += KJ * Kw ( O , u_quatsb [ KI ] , u_quatsa [ KI ] , u_transb [ KI ] , u_transa [ KI ] , KD ) ; KI = int ( KH [ 3 ] ) ; KJ = fract ( KH [ 3 ] ) ; jH += KJ * Kw ( O , u_quatsb [ KI ] , u_quatsa [ KI ] , u_transb [ KI ] , u_transa [ KI ] , KD ) ;".split(" ")}]}}]},
{TYPE:"txt",TOKENS:"O = jH ; U = KG ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_TANGENT_SKINNING",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"V = KE ; W = KF ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"} if ( ! ( a_influence . y > 0.0 ) ) { int KK = int ( a_influence [ 0 ] - 1.0 ) ; if ( KK > - 1 ) {".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FRAMES_BLENDING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"O = Kw ( O , u_quatsb [ KK ] , u_quatsa [ KK ] , u_transb [ KK ] , u_transa [ KK ] , KD ) ; V = KC ( V , u_quatsb [ KK ] , u_quatsa [ KK ] , KD ) ; W = KC ( W , u_quatsb [ KK ] , u_quatsa [ KK ] , KD ) ; U = KC ( U , u_quatsb [ KK ] , u_quatsa [ KK ] , KD ) ;".split(" ")}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"O = Kw ( O , u_quatsb [ KK ] , u_transb [ KK ] ) ; U = KC ( U , u_quatsb [ KK ] ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_TANGENT_SKINNING",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"V = KC ( V , u_quatsb [ KK ] ) ; W = KC ( W , u_quatsb [ KK ] ) ;".split(" ")}]}}]}]}}]},{TYPE:"txt",TOKENS:["}","}","}"]}]}}]}]}}]}]};e["include/sky_blending.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",
PARTS:[{TYPE:"ifndef",NAME:"SKY_BLENDING_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SKY_BLENDING_GLSLF",TOKENS:[""]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"blending.glslf"},{TYPE:"var",NAME:"WO_SKYREAL",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYBLEND",TOKENS:["0"]},{TYPE:"var",NAME:"BLENDTYPE",TOKENS:["MIX"]},{TYPE:"var",NAME:"MTEX_RGBTOINT",TOKENS:["0"]},{TYPE:"var",NAME:"WOMAP_HORIZ",TOKENS:["0"]},{TYPE:"var",NAME:"WOMAP_ZENUP",TOKENS:["0"]},{TYPE:"var",NAME:"WOMAP_ZENDOWN",
TOKENS:["0"]},{TYPE:"var",NAME:"WOMAP_BLEND",TOKENS:["0"]},{TYPE:"var",NAME:"MTEX_NEGATIVE",TOKENS:["0"]},{TYPE:"txt",TOKENS:"vec3 KL ( vec3 km , vec3 kn , float aL , float kM ) { float ko = aL * kM ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLENDTYPE","MIX",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"return kp ( kn , km , ko ) ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","ADD",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:"return kq ( km , kn , ko ) ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","SUBTRACT",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"return kr ( km , kn , ko ) ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","MULTIPLY",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"return kt ( km , kn , ko ) ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","SCREEN",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:"return ku ( km , kn , ko ) ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","OVERLAY",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"return kv ( km , kn , ko ) ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","DIFFERENCE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"return kw ( km , kn , ko ) ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","DIVIDE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:"return kx ( km , kn , ko ) ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","DARKEN",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"return ky ( km , kn , ko ) ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","LIGHTEN",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"return kz ( km , kn , ko ) ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","HUE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"return kD ( kn , km , ko ) ;".split(" ")}]}},
{TYPE:"elif",EXPRESSION:["BLENDTYPE","SATURATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"return kE ( kn , km , ko ) ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","VALUE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"return kF ( kn , km , ko ) ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","COLOR",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"return kG ( kn , km , ko ) ;".split(" ")}]}},{TYPE:"elif",
EXPRESSION:["BLENDTYPE","SOFT_LIGHT",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"return kI ( kn , km , ko ) ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","LINEAR_LIGHT",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"return kJ ( kn , km , ko ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"return vec3 ( 1.0 , 0.0 , 1.0 ) ; } float KM ( float kK , float kL , float aL , float kM ) { vec3 km = vec3 ( kK ) , kn = vec3 ( kL ) ; float ko = aL * kM ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLENDTYPE","MIX",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"return kp ( kn , km , ko ) . x ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","ADD",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"return kq ( km , kn , ko ) . x ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","SUBTRACT",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"return kr ( km , kn , ko ) . x ;".split(" ")}]}},
{TYPE:"elif",EXPRESSION:["BLENDTYPE","MULTIPLY",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"return kN ( kK , kL , ko , kM ) ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","SCREEN",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"return kO ( kK , kL , ko , kM ) ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","OVERLAY",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"return kP ( kK , kL , ko , kM ) ;".split(" ")}]}},
{TYPE:"elif",EXPRESSION:["BLENDTYPE","DIFFERENCE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"return kw ( km , kn , ko ) . x ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","DIVIDE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"return kx ( km , kn , ko ) . x ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","DARKEN",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"return ky ( km , kn , ko ) . x ;".split(" ")}]}},
{TYPE:"elif",EXPRESSION:["BLENDTYPE","LIGHTEN",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"return kz ( km , kn , ko ) . x ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","SOFT_LIGHT",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"return kI ( kn , km , ko ) . x ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","LINEAR_LIGHT",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"return kJ ( kn , km , ko ) . x ;".split(" ")}]}}]},
{TYPE:"txt",TOKENS:"return 0.0 ; } vec3 eF ( vec3 eB , vec3 eC , vec4 eE , float eA , vec3 eD ) { float KN = 1.0 ; KN = eE . a ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MTEX_RGBTOINT"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"KN = gj ( eE ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MTEX_NEGATIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MTEX_RGBTOINT",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:"eE = vec4 ( vec3 ( 1.0 ) - eE . rgb , eE . a ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"KN = 1.0 - KN ;".split(" ")}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WOMAP_HORIZ","WOMAP_ZENUP","WOMAP_ZENDOWN",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MTEX_RGBTOINT"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"eE = vec4 ( u_sky_tex_color , 1.0 ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:"KN = eE . a ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WOMAP_HORIZ"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"eB = KL ( eE . rgb , eB , KN , u_sky_tex_fac [ 1 ] ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WOMAP_ZENUP","WOMAP_ZENDOWN",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","KO","=","0.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYREAL"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",
TOKENS:"if ( dot ( eD , vec3 ( 0.0 , 0.0 , 1.0 ) ) >= 0.0 ) {".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WOMAP_ZENUP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"KO = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:[";"]}]}}]},{TYPE:"txt",TOKENS:["}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WOMAP_ZENDOWN"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"else KO = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",
PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WOMAP_ZENUP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"KO = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["WOMAP_ZENDOWN"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"KO = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}}]},{TYPE:"txt",TOKENS:"if ( KO != 0.0 ) eC = KL ( eE . rgb , eC , KN , KO ) ;".split(" ")}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WOMAP_BLEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",
EXPRESSION:["MTEX_RGBTOINT",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"KN = dot ( eE . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"eA = KM ( u_sky_tex_dvar , eA , KN , u_sky_tex_fac [ 0 ] ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYBLEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 bw = mix ( eB , eC , eA ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3",
"bw","=","eB",";"]}]}}]},{TYPE:"txt",TOKENS:["return","bw",";","}"]}]}}]}]};e["include/std.glsl"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"STD_ENUMS_GLSL",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"STD_ENUMS_GLSL",TOKENS:[""]},{TYPE:"var",NAME:"CONSTANTS_HACK",TOKENS:["0"]},{TYPE:"define",NAME:"TEXTURE_COORDS_NONE",TOKENS:["0"]},{TYPE:"define",NAME:"TEXTURE_COORDS_UV_ORCO",TOKENS:["1"]},{TYPE:"define",NAME:"TEXTURE_COORDS_NORMAL",TOKENS:["2"]},{TYPE:"define",NAME:"TEXTURE_BLEND_TYPE_MIX",
TOKENS:["1"]},{TYPE:"define",NAME:"TEXTURE_BLEND_TYPE_MULTIPLY",TOKENS:["2"]},{TYPE:"define",NAME:"SHADOW_SRC_NONE",TOKENS:["1"]},{TYPE:"define",NAME:"SHADOW_SRC_DEPTH",TOKENS:["2"]},{TYPE:"define",NAME:"SHADOW_SRC_MASK",TOKENS:["3"]},{TYPE:"define",NAME:"SHADOW_DST_NONE",TOKENS:["1"]},{TYPE:"define",NAME:"SHADOW_DST_DEPTH",TOKENS:["2"]},{TYPE:"define",NAME:"SHADOW_DST_MASK",TOKENS:["3"]},{TYPE:"define",NAME:"NO_SHADOWS",TOKENS:["1"]},{TYPE:"define",NAME:"SHADOW_CASTING",TOKENS:["2"]},{TYPE:"define",
NAME:"SHADOW_MASK_GENERATION",TOKENS:["3"]},{TYPE:"define",NAME:"SHADOW_MAPPING_OPAQUE",TOKENS:["4"]},{TYPE:"define",NAME:"SHADOW_MAPPING_BLEND",TOKENS:["5"]},{TYPE:"define",NAME:"POISSON_X_16",TOKENS:["4"]},{TYPE:"define",NAME:"POISSON_X_8",TOKENS:["2"]},{TYPE:"define",NAME:"POISSON_X_4",TOKENS:["1"]},{TYPE:"define",NAME:"NO_SOFT_SHADOWS",TOKENS:["0"]},{TYPE:"define",NAME:"SPECULAR_PHONG",TOKENS:["1"]},{TYPE:"define",NAME:"SPECULAR_COOKTORR",TOKENS:["2"]},{TYPE:"define",NAME:"SPECULAR_WARDISO",TOKENS:["3"]},
{TYPE:"define",NAME:"SPECULAR_BLINN",TOKENS:["4"]},{TYPE:"define",NAME:"SPECULAR_TOON",TOKENS:["5"]},{TYPE:"define",NAME:"DIFFUSE_LAMBERT",TOKENS:["1"]},{TYPE:"define",NAME:"DIFFUSE_OREN_NAYAR",TOKENS:["2"]},{TYPE:"define",NAME:"DIFFUSE_FRESNEL",TOKENS:["3"]},{TYPE:"define",NAME:"DIFFUSE_MINNAERT",TOKENS:["4"]},{TYPE:"define",NAME:"DIFFUSE_TOON",TOKENS:["5"]},{TYPE:"define",NAME:"MIX",TOKENS:["0"]},{TYPE:"define",NAME:"ADD",TOKENS:["1"]},{TYPE:"define",NAME:"SUBTRACT",TOKENS:["2"]},{TYPE:"define",
NAME:"MULTIPLY",TOKENS:["3"]},{TYPE:"define",NAME:"SCREEN",TOKENS:["4"]},{TYPE:"define",NAME:"OVERLAY",TOKENS:["5"]},{TYPE:"define",NAME:"DIFFERENCE",TOKENS:["6"]},{TYPE:"define",NAME:"DIVIDE",TOKENS:["7"]},{TYPE:"define",NAME:"DARKEN",TOKENS:["8"]},{TYPE:"define",NAME:"LIGHTEN",TOKENS:["9"]},{TYPE:"define",NAME:"HUE",TOKENS:["10"]},{TYPE:"define",NAME:"SATURATION",TOKENS:["11"]},{TYPE:"define",NAME:"VALUE",TOKENS:["12"]},{TYPE:"define",NAME:"COLOR",TOKENS:["13"]},{TYPE:"define",NAME:"SOFT_LIGHT",
TOKENS:["14"]},{TYPE:"define",NAME:"LINEAR_LIGHT",TOKENS:["15"]},{TYPE:"define",NAME:"REFL_NONE",TOKENS:["0"]},{TYPE:"define",NAME:"REFL_MIRRORMAP",TOKENS:["1"]},{TYPE:"define",NAME:"REFL_PLANE",TOKENS:["2"]},{TYPE:"define",NAME:"REFL_CUBE",TOKENS:["3"]},{TYPE:"define",NAME:"REFL_PBR_SIMPLE",TOKENS:["4"]},{TYPE:"define",NAME:"REFL_PBR_STANDARD",TOKENS:["5"]},{TYPE:"define",NAME:"INVERSE_QUADRATIC",TOKENS:["0"]},{TYPE:"define",NAME:"LINEAR",TOKENS:["1"]},{TYPE:"define",NAME:"QUADRATIC",TOKENS:["2"]},
{TYPE:"define",NAME:"HEMI",TOKENS:["1"]},{TYPE:"define",NAME:"SPOT",TOKENS:["2"]},{TYPE:"define",NAME:"POINT",TOKENS:["3"]},{TYPE:"define",NAME:"SUN",TOKENS:["4"]},{TYPE:"define",NAME:"DOF_SIMPLE",TOKENS:["0"]},{TYPE:"define",NAME:"DOF_BOKEH",TOKENS:["1"]},{TYPE:"define",NAME:"COC_ALL",TOKENS:["0"]},{TYPE:"define",NAME:"COC_FOREGROUND",TOKENS:["1"]},{TYPE:"define",NAME:"COC_COMBINE",TOKENS:["2"]},{TYPE:"define",NAME:"VT_WORLD_TO_WORLD",TOKENS:["0"]},{TYPE:"define",NAME:"VT_WORLD_TO_OBJECT",TOKENS:["1"]},
{TYPE:"define",NAME:"VT_WORLD_TO_CAMERA",TOKENS:["2"]},{TYPE:"define",NAME:"VT_OBJECT_TO_WORLD",TOKENS:["3"]},{TYPE:"define",NAME:"VT_OBJECT_TO_OBJECT",TOKENS:["4"]},{TYPE:"define",NAME:"VT_OBJECT_TO_CAMERA",TOKENS:["5"]},{TYPE:"define",NAME:"VT_CAMERA_TO_WORLD",TOKENS:["6"]},{TYPE:"define",NAME:"VT_CAMERA_TO_OBJECT",TOKENS:["7"]},{TYPE:"define",NAME:"VT_CAMERA_TO_CAMERA",TOKENS:["8"]},{TYPE:"define",NAME:"VT_POINT",TOKENS:["0"]},{TYPE:"define",NAME:"VT_VECTOR",TOKENS:["1"]},{TYPE:"define",NAME:"VT_NORMAL",
TOKENS:["2"]},{TYPE:"define",NAME:"NM_TANGENT",TOKENS:["0"]},{TYPE:"define",NAME:"NM_OBJECT",TOKENS:["1"]},{TYPE:"define",NAME:"NM_WORLD",TOKENS:["2"]},{TYPE:"define",NAME:"NM_BLENDER_OBJECT",TOKENS:["3"]},{TYPE:"define",NAME:"NM_BLENDER_WORLD",TOKENS:["4"]},{TYPE:"define",NAME:"BILLBOARD_ALIGN_VIEW",TOKENS:["1"]},{TYPE:"define",NAME:"BILLBOARD_ALIGN_XY",TOKENS:["2"]},{TYPE:"define",NAME:"BILLBOARD_ALIGN_YZ",TOKENS:["3"]},{TYPE:"define",NAME:"BILLBOARD_ALIGN_ZX",TOKENS:["4"]},{TYPE:"define",NAME:"POST_EFFECT_NONE",
TOKENS:["1"]},{TYPE:"define",NAME:"POST_EFFECT_GRAYSCALE",TOKENS:["2"]},{TYPE:"define",NAME:"POST_EFFECT_BLUR",TOKENS:["3"]},{TYPE:"define",NAME:"POST_EFFECT_GLOW_BLUR",TOKENS:["4"]},{TYPE:"define",NAME:"POST_EFFECT_DOF_BLUR",TOKENS:["5"]},{TYPE:"define",NAME:"POST_EFFECT_ALPHA_BLUR",TOKENS:["6"]},{TYPE:"define",NAME:"POST_EFFECT_EXTEND",TOKENS:["7"]},{TYPE:"define",NAME:"FLIP_CUBEMAP_COORDS",TOKENS:["8"]},{TYPE:"define",NAME:"BLUR_PASS_1",TOKENS:["1"]},{TYPE:"define",NAME:"BLUR_PASS_2",TOKENS:["2"]},
{TYPE:"define",NAME:"BLUR_PASS_3",TOKENS:["3"]},{TYPE:"define",NAME:"BLUR_PASS_4",TOKENS:["4"]},{TYPE:"define",NAME:"BLUR_PASS_5",TOKENS:["5"]},{TYPE:"define",NAME:"DV_NONE",TOKENS:["0"]},{TYPE:"define",NAME:"DV_OPAQUE_WIREFRAME",TOKENS:["1"]},{TYPE:"define",NAME:"DV_TRANSPARENT_WIREFRAME",TOKENS:["2"]},{TYPE:"define",NAME:"DV_FRONT_BACK_VIEW",TOKENS:["3"]},{TYPE:"define",NAME:"DV_BOUNDINGS",TOKENS:["4"]},{TYPE:"define",NAME:"DV_CLUSTERS_VIEW",TOKENS:["5"]},{TYPE:"define",NAME:"DV_BATCHES_VIEW",TOKENS:["6"]},
{TYPE:"define",NAME:"DV_RENDER_TIME",TOKENS:["7"]},{TYPE:"define",NAME:"SSAO_QUALITY_8",TOKENS:["1"]},{TYPE:"define",NAME:"SSAO_QUALITY_16",TOKENS:["2"]},{TYPE:"define",NAME:"SSAO_QUALITY_24",TOKENS:["3"]},{TYPE:"define",NAME:"SSAO_QUALITY_32",TOKENS:["4"]},{TYPE:"define",NAME:"AA_METHOD_FXAA_LIGHT",TOKENS:["1"]},{TYPE:"define",NAME:"AA_METHOD_FXAA_QUALITY",TOKENS:["2"]},{TYPE:"define",NAME:"AA_QUALITY_LOW",TOKENS:["0"]},{TYPE:"define",NAME:"AA_QUALITY_MEDIUM",TOKENS:["1"]},{TYPE:"define",NAME:"AA_QUALITY_HIGH",
TOKENS:["2"]},{TYPE:"define",NAME:"SMAA_RESOLVE",TOKENS:["25"]},{TYPE:"define",NAME:"SMAA_EDGE_DETECTION",TOKENS:["24"]},{TYPE:"define",NAME:"SMAA_BLENDING_WEIGHT_CALCULATION",TOKENS:["23"]},{TYPE:"define",NAME:"SMAA_NEIGHBORHOOD_BLENDING",TOKENS:["26"]},{TYPE:"define",NAME:"AA_METHOD_SMAA_LOW",TOKENS:["1"]},{TYPE:"define",NAME:"AA_METHOD_SMAA_MEDIUM",TOKENS:["2"]},{TYPE:"define",NAME:"AA_METHOD_SMAA_HIGH",TOKENS:["3"]},{TYPE:"define",NAME:"AA_METHOD_SMAA_ULTRA",TOKENS:["4"]},{TYPE:"define",NAME:"REFL_PASS_NONE",
TOKENS:["0"]},{TYPE:"define",NAME:"REFL_PASS_PLANE",TOKENS:["1"]},{TYPE:"define",NAME:"REFL_PASS_CUBE",TOKENS:["2"]},{TYPE:"define",NAME:"SRGB_NONE",TOKENS:["0"]},{TYPE:"define",NAME:"SRGB_SIMPLE",TOKENS:["1"]},{TYPE:"define",NAME:"SRGB_PROPER",TOKENS:["2"]},{TYPE:"define",NAME:"CAM_TYPE_ORTHO",TOKENS:["0"]},{TYPE:"define",NAME:"CAM_TYPE_PERSP",TOKENS:["1"]},{TYPE:"define",NAME:"M_PI",TOKENS:["3.14159265359"]},{TYPE:"define",NAME:"M_PI_4",TOKENS:["0.785398163"]},{TYPE:"define",NAME:"INV_PI",TOKENS:["0.318309886"]},
{TYPE:"define",NAME:"UP_VECTOR",TOKENS:"vec3 ( 0.0 , 0.0 , 1.0 )".split(" ")},{TYPE:"define",NAME:"RIGHT_VECTOR",TOKENS:"vec3 ( 1.0 , 0.0 , 0.0 )".split(" ")},{TYPE:"define",NAME:"TOWARD_VECTOR",TOKENS:"vec3 ( 0.0 , - 1.0 , 0.0 )".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CONSTANTS_HACK"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float _0_0 = 0.0 ; float _0_5 = 0.5 ; float _1_0 = 1.0 ; float _255_0 = 255.0 ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"_0_0",
TOKENS:["0.0"]},{TYPE:"define",NAME:"_0_5",TOKENS:["0.5"]},{TYPE:"define",NAME:"_1_0",TOKENS:["1.0"]},{TYPE:"define",NAME:"_255_0",TOKENS:["255.0"]}]}}]}]}}]}]};e["include/to_world.glslv"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"TO_WORLD_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"TO_WORLD_GLSLV",TOKENS:[""]},{TYPE:"include",FILE:"math.glslv"},{TYPE:"var",NAME:"BILLBOARD_ALIGN",TOKENS:["BILLBOARD_ALIGN_VIEW"]},{TYPE:"var",NAME:"BILLBOARD_SPHERICAL",TOKENS:["0"]},{TYPE:"var",
NAME:"BILLBOARD_RANDOM",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD_JITTERED",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD_PRES_GLOB_ORIENTATION",TOKENS:["0"]},{TYPE:"var",NAME:"STATIC_BATCH",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_PASS",TOKENS:["REFL_PASS_NONE"]},{TYPE:"define",NAME:"MAX_BILLBOARD_ANGLE",TOKENS:["M_PI_4"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD_SPHERICAL","BILLBOARD",{TYPE:"logic_negative_expr",PLACES:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",
{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"mat3 bn ( vec3 KP , mat3 N ) { vec4 KQ = ry ( N ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 KR = X ( RIGHT_VECTOR , - M_PI / 2.0 ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 KR = X ( RIGHT_VECTOR , M_PI / 2.0 ) ;".split(" ")}]}}]},
{TYPE:"txt",TOKENS:"KQ = rc ( KR , KQ ) ; KQ = kV ( KQ ) ; mat3 bo = aY ( ) ; bo = aZ ( KP , bo ) ; bo = bc ( KQ , bo ) ; return bo ; }".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"mat3 KT ( vec3 lL , vec3 KP ) { vec3 KS = lL - KP ; KS . z = 0.0 ; KS = normalize ( KS ) ; vec4 KQ = ri ( KS , TOWARD_VECTOR ) ; mat3 bo = aY ( ) ; bo = aZ ( KP , bo ) ; bo = bc ( KQ , bo ) ; return bo ; }".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD_JITTERED"],GROUP:{TYPE:"grp",
PARTS:[{TYPE:"txt",TOKENS:"mat3 at ( in vec3 KU , float KV , float KW , float KX , vec3 bf , mat3 Z ) { float IV = fract ( length ( bf ) / 0.17 ) ; float KY = KX + IV / 10.0 ; float KZ = IV ; if ( KX != 0.0 ) KZ /= KX ; KU *= 1.0 + 0.5 * sin ( KV ) ; float K_ = length ( KU ) * KW * sin ( 2.0 * 3.14 * KV * KY + KZ ) ; vec4 La = X ( TOWARD_VECTOR , K_ ) ; vec4 Lb = ry ( Z ) ; Lb = rc ( Lb , La ) ; Z = bc ( Lb , Z ) ; return Z ; }".split(" ")}]}}]},{TYPE:"txt",TOKENS:"mat3 as ( in vec3 lL , in vec3 aq , in mat3 N , in mat3 Z ) {".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD_SPHERICAL","BILLBOARD",{TYPE:"logic_negative_expr",PLACES:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"mat3 l_ = bn ( aq , N ) ;".split(" ")}]}},{TYPE:"elif",EXPRESSION:["BILLBOARD_RANDOM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"float IV = fract ( ( aq . x * 1.43 - aq . z * 0.123 + aq . y * 6.1 ) ) ; float Lc = 2.0 * M_PI * IV ; vec4 Ld = ry ( N ) ; float Le = asin ( 2.0 * ( Ld . x * Ld . y - Ld . z * Ld . w ) ) ; float hy = Le - Lc ; if ( hy < 0.0 ) hy = 2.0 * M_PI + hy ; float Lf = Lc ; if ( hy <= MAX_BILLBOARD_ANGLE ) Lf += hy ; else if ( hy <= M_PI - MAX_BILLBOARD_ANGLE ) Lf += MAX_BILLBOARD_ANGLE * ( 2.0 * hy - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) ; else if ( hy <= M_PI + MAX_BILLBOARD_ANGLE ) Lf += hy - M_PI ; else if ( hy <= 2.0 * M_PI - MAX_BILLBOARD_ANGLE ) Lf += MAX_BILLBOARD_ANGLE * ( 2.0 * hy - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) + M_PI ; else Lf += hy - 2.0 * M_PI ; vec4 Lg = X ( UP_VECTOR , Lf ) ; mat3 l_ = aY ( ) ; l_ = aZ ( aq , l_ ) ; l_ = bc ( Lg , l_ ) ;".split(" ")}]}},
{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"mat3 l_ = KT ( lL , aq ) ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"Z = aZ ( vec3 ( 0.0 ) , Z ) ; l_ = bd ( l_ , Z ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 Lh = rA ( l_ ) ; vec3 Li = rA ( Z ) ; l_ = a_ ( Lh * Li , l_ ) ;".split(" ")}]}}]},
{TYPE:"txt",TOKENS:"return l_ ; } au av ( in vec3 fr , in vec3 Lj , in vec3 Lk , in vec3 Ll , in vec3 Lm , in vec3 Ln , in mat3 Z ) { fr = ap ( Z , fr ) ; Lj = ap ( Z , Lj ) ; Lk = _ ( Z , Lk ) ; Ll = _ ( Z , Ll ) ; Lm = _ ( Z , Lm ) ; Ln = bI ( Z , Ln ) ; return ma ( au ( fr , Lj , Lk , Ll , Lm , Ln , vec3 ( 0.0 ) ) ) ; }".split(" ")}]}}]}]};e["include/wind_bending.glslv"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"WIND_BENDING_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"WIND_BENDING_GLSLV",
TOKENS:[""]},{TYPE:"var",NAME:"WIND_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"MAIN_BEND_COL",TOKENS:["0"]},{TYPE:"var",NAME:"DETAIL_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"BEND_CENTER_ONLY",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_PASS",TOKENS:["REFL_PASS_NONE"]},{TYPE:"var",NAME:"BILLBOARD",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"void LA ( inout vec3 bt , in vec3 Lo , in float Lp , in float Lq , in float fy , in vec3 KU , in float Lr , in mat4 b_ ) {".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2},"BILLBOARD",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 Ls = ( b_ * vec4 ( bt , 1.0 ) ) . xyz ; vec3 Lt = ( b_ * vec4 ( Lo , 1.0 ) ) . xyz ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 Ls = bt ; vec3 Lt = Lo ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"float dD = length ( Lt ) ; float Lu = Lq * ( 1.0 + 0.1 * fract ( dD ) ) ; float Lv = Lp * Lr * ( 1.0 + sin ( 2.0 * 3.14 * fy * Lu + dD ) ) ; float Lw = ( Ls . z - Lt . z ) * abs ( Lv ) ; Lw += 1.0 ; Lw *= Lw ; Lw = Lw * Lw - Lw ; vec3 Lx = Ls ; Lx . xy += KU . xy * Lw * sign ( Lv ) ; vec3 Ly = Lx - Lt ; if ( all ( equal ( Ly , vec3 ( 0.0 ) ) ) ) bt = Lo ; else {".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2},"BILLBOARD",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"Ly = ( b_ * vec4 ( Ly , 0.0 ) ) . xyz ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"float Lz = length ( Ls - Lt ) ; bt = Lo + normalize ( Ly ) * Lz ; } }".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DETAIL_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec4 LB ( vec4 x ) { return x * x * ( 3.0 - 2.0 * x ) ; } vec4 LC ( vec4 x ) { return abs ( fract ( x + 0.5 ) * 2.0 - 1.0 ) ; } vec4 LD ( vec4 x ) { return LB ( LC ( x ) ) ; } void LP ( inout vec3 bt , in float fy , in vec3 U , in vec3 KU , in vec3 Lo , in float LE , in float LF , in float LG , in vec3 LH , in mat4 b_ ) { float LI ; float LJ ; float LK ; vec2 LL ; vec4 LM ; vec2 LN ; vec3 LO ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2},"BILLBOARD",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 Ls = ( b_ * vec4 ( bt , 1.0 ) ) . xyz ; vec3 Lt = ( b_ * vec4 ( Lo , 1.0 ) ) . xyz ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 Ls = bt ; vec3 Lt = Lo ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"LI = dot ( Lt , vec3 ( 1.0 ) ) ; LJ = LI + LH . g ; LK = dot ( Ls , vec3 ( LH . g ) ) ; LL = ( fy + vec2 ( LK , LJ ) ) ; LM = ( ( fract ( ( LL . xxyy * vec4 ( 1.975 , 0.793 , 0.375 , 0.193 ) ) ) * 2.0 ) - 1.0 ) * length ( KU ) * LE ; LM = LD ( LM ) ; LN = LM . xz + LM . yw ; LN . y = 0.5 - LN . y ; LO = LN . xxy * LH . rrb * vec3 ( LF * U . x , LF * U . y , LG ) ;".split(" ")},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2},"BILLBOARD",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"LO = ( b_ * vec4 ( LO , 0.0 ) ) . xyz ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["bt","+=","LO",";","}"]}]}}]},{TYPE:"txt",TOKENS:"void ax ( inout vec3 O , inout vec3 ao , in vec3 U , in mat4 b_ ) { vec3 LQ = u_wind * 1.0 + 0.7 * sin ( u_time ) ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BEND_CENTER_ONLY"],
GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 LR = ao ; vec3 LS = a_emitter_center ;".split(" ")},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2},"BILLBOARD",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"LS = ( b_ * vec4 ( LS , 1.0 ) ) . xyz ;".split(" ")}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"vec3 LR = O ; vec3 LS = ao ;".split(" ")}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAIN_BEND_COL"],
GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DETAIL_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"LP ( LR , u_time , U , LQ , LS , au_detail_bending_freq , au_detail_bending_amp , au_branch_bending_amp , a_bending_col_detail , b_ ) ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:"LA ( LR , LS , au_wind_bending_amp , au_wind_bending_freq , u_time , LQ , a_bending_col_main , b_ ) ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"LA ( LR , LS , au_wind_bending_amp , au_wind_bending_freq , u_time , LQ , 1.0 , b_ ) ;".split(" ")}]}}]},
{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BEND_CENTER_ONLY"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"O += LR - ao ; ao = LR ;".split(" ")}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:"O = LR ; ao = LS ;".split(" ")}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]}]}}]}]}}},function(C,t,e){Object.defineProperty(t,"__esModule",{value:!0});e.d(t,"parser",function(){return R});var R=function(){function e(e,t,d,k,I,A){this.message=e;this.expected=t;this.found=d;this.offset=k;this.line=I;this.column=
A;this.name="SyntaxError"}(function(e,t){function d(){this.constructor=e}d.prototype=t.prototype;e.prototype=new d})(e,Error);return{SyntaxError:e,parse:function(n){function t(a){if(Ud!==a){Ud>a&&(Ud=0,Jc={line:1,column:1,seenCR:!1});var b=Jc,c,d;for(c=Ud;c<a;c++)d=n.charAt(c),"\n"===d?(b.seenCR||b.line++,b.column=1,b.seenCR=!1):"\r"===d||"\u2028"===d||"\u2029"===d?(b.line++,b.column=1,b.seenCR=!0):(b.column++,b.seenCR=!1);Ud=a}return Jc}function d(a){x<Vd||(x>Vd&&(Vd=x,Ee=[]),Ee.push(a))}function k(){var a,
b,c;a=x;b=Ma();b!==g?(b=I(),b!==g?(c=Ma(),c!==g?a=b:(x=a,a=g)):(x=a,a=g)):(x=a,a=g);return a}function I(){var a,b,c,d,e,f;a=x;b=A();if(b!==g){c=[];d=x;e=Ma();e!==g?(f=A(),f!==g?d=e=[e,f]:(x=d,d=g)):(x=d,d=g);for(;d!==g;)c.push(d),d=x,e=Ma(),e!==g?(f=A(),f!==g?d=e=[e,f]:(x=d,d=g)):(x=d,d=g);c!==g?a=b=Ta(b,c):(x=a,a=g)}else x=a,a=g;a===g&&(a=null);a!==g&&(a={TYPE:"grp",PARTS:null!==a?a:[]});return a}function A(){var b,e,f,h,k,q,w,t,z;e=x;var v,D,A,y,E,B,H,G,J,L;v=x;35===n.charCodeAt(x)?(D=ma,x++):(D=
g,0===ca&&d(Ka));D!==g?(A=ka(),A!==g?(n.substr(x,2)===fb?(y=fb,x+=2):(y=g,0===ca&&d(La)),y!==g?(E=Ca(),E!==g?(B=m(),B!==g?(H=ka(),H!==g?(G=ga(),G!==g?(J=Ma(),J!==g?(L=I(),L!==g?v=D={TYPE:"if",EXPRESSION:B,GROUP:L}:(x=v,v=g)):(x=v,v=g)):(x=v,v=g)):(x=v,v=g)):(x=v,v=g)):(x=v,v=g)):(x=v,v=g)):(x=v,v=g)):(x=v,v=g);v===g&&(v=x,35===n.charCodeAt(x)?(D=ma,x++):(D=g,0===ca&&d(Ka)),D!==g?(A=ka(),A!==g?(n.substr(x,5)===Xa?(y=Xa,x+=5):(y=g,0===ca&&d(Wa)),y!==g?(E=Ca(),E!==g?(B=yc(),B!==g?(H=ka(),H!==g?(G=ga(),
G!==g?(J=Ma(),J!==g?(L=I(),L!==g?v=D={TYPE:"ifdef",NAME:B,GROUP:L}:(x=v,v=g)):(x=v,v=g)):(x=v,v=g)):(x=v,v=g)):(x=v,v=g)):(x=v,v=g)):(x=v,v=g)):(x=v,v=g)):(x=v,v=g),v===g&&(v=x,35===n.charCodeAt(x)?(D=ma,x++):(D=g,0===ca&&d(Ka)),D!==g?(A=ka(),A!==g?(n.substr(x,6)===W?(y=W,x+=6):(y=g,0===ca&&d(Ia)),y!==g?(E=Ca(),E!==g?(B=yc(),B!==g?(H=ka(),H!==g?(G=ga(),G!==g?(J=Ma(),J!==g?(L=I(),L!==g?v=D={TYPE:"ifndef",NAME:B,GROUP:L}:(x=v,v=g)):(x=v,v=g)):(x=v,v=g)):(x=v,v=g)):(x=v,v=g)):(x=v,v=g)):(x=v,v=g)):(x=
v,v=g)):(x=v,v=g)));f=v;if(f!==g)if(h=Ma(),h!==g){k=[];for(q=r();q!==g;)k.push(q),q=r();if(k!==g)if(q=Ma(),q!==g){var F,K,C,P,T,ra,M,ea;F=x;35===n.charCodeAt(x)?(K=ma,x++):(K=g,0===ca&&d(Ka));K!==g?(C=ka(),C!==g?(n.substr(x,4)===Va?(P=Va,x+=4):(P=g,0===ca&&d(Z)),P!==g?(T=ka(),T!==g?(ra=ga(),ra!==g?(M=Ma(),M!==g?(ea=I(),ea!==g?F=K={TYPE:"else",GROUP:ea}:(x=F,F=g)):(x=F,F=g)):(x=F,F=g)):(x=F,F=g)):(x=F,F=g)):(x=F,F=g)):(x=F,F=g);w=F;w===g&&(w=null);if(w!==g)if(t=Ma(),t!==g){var U,O,S,R,Y,V;U=x;35===
n.charCodeAt(x)?(O=ma,x++):(O=g,0===ca&&d(Ka));O!==g?(S=ka(),S!==g?(n.substr(x,5)===Oa?(R=Oa,x+=5):(R=g,0===ca&&d(Qa)),R!==g?(Y=ka(),Y!==g?(V=ya(),V!==g?U=O=[O,S,R,Y,V]:(x=U,U=g)):(x=U,U=g)):(x=U,U=g)):(x=U,U=g)):(x=U,U=g);z=U;if(z!==g){for(var fa=w,da=[f],X=0;X<k.length;X++)da.push(k[X]);null!==fa&&da.push(fa);e=f={TYPE:"cond",PARTS:da}}else x=e,e=g}else x=e,e=g;else x=e,e=g}else x=e,e=g;else x=e,e=g}else x=e,e=g;else x=e,e=g;b=e;if(b===g){var Q,ba,za,aa,ja,qa,oa,ha,va,pa;Q=x;35===n.charCodeAt(x)?
(ba=ma,x++):(ba=g,0===ca&&d(Ka));if(ba!==g)if(za=ka(),za!==g)if(n.substr(x,7)===$a?(aa=$a,x+=7):(aa=g,0===ca&&d(rb)),aa!==g)if(ja=ka(),ja!==g){var ta,sa,Ja,Da,Ga,Ba;ta=x;60===n.charCodeAt(x)?(sa=Fd,x++):(sa=g,0===ca&&d(Jd));if(sa!==g)if(Ja=ka(),Ja!==g){var wa,Ea,xa,Aa;wa=[];xa=Ea=x;ca++;Aa=ya();Aa===g&&(62===n.charCodeAt(x)?(Aa=Yc,x++):(Aa=g,0===ca&&d(td)));ca--;Aa===g?xa=void 0:(x=xa,xa=g);xa!==g?(Aa=na(),Aa!==g?Ea=xa=[xa,Aa]:(x=Ea,Ea=g)):(x=Ea,Ea=g);for(;Ea!==g;)wa.push(Ea),xa=Ea=x,ca++,Aa=ya(),
Aa===g&&(62===n.charCodeAt(x)?(Aa=Yc,x++):(Aa=g,0===ca&&d(td))),ca--,Aa===g?xa=void 0:(x=xa,xa=g),xa!==g?(Aa=na(),Aa!==g?Ea=xa=[xa,Aa]:(x=Ea,Ea=g)):(x=Ea,Ea=g);wa!==g&&(wa=Rc(wa));Da=wa;Da!==g?(Ga=ka(),Ga!==g?(62===n.charCodeAt(x)?(Ba=Yc,x++):(Ba=g,0===ca&&d(td)),Ba!==g?ta=sa=Da:(x=ta,ta=g)):(x=ta,ta=g)):(x=ta,ta=g)}else x=ta,ta=g;else x=ta,ta=g;if(ta===g)if(ta=x,34===n.charCodeAt(x)?(sa=bc,x++):(sa=g,0===ca&&d(Pb)),sa!==g)if(Ja=ka(),Ja!==g){var Ha,Fa,Ta,Na;Ha=[];Ta=Fa=x;ca++;Na=ya();Na===g&&(34===
n.charCodeAt(x)?(Na=bc,x++):(Na=g,0===ca&&d(Pb)));ca--;Na===g?Ta=void 0:(x=Ta,Ta=g);Ta!==g?(Na=na(),Na!==g?Fa=Ta=[Ta,Na]:(x=Fa,Fa=g)):(x=Fa,Fa=g);for(;Fa!==g;)Ha.push(Fa),Ta=Fa=x,ca++,Na=ya(),Na===g&&(34===n.charCodeAt(x)?(Na=bc,x++):(Na=g,0===ca&&d(Pb))),ca--,Na===g?Ta=void 0:(x=Ta,Ta=g),Ta!==g?(Na=na(),Na!==g?Fa=Ta=[Ta,Na]:(x=Fa,Fa=g)):(x=Fa,Fa=g);Ha!==g&&(Ha=Rc(Ha));Da=Ha;Da!==g?(Ga=ka(),Ga!==g?(34===n.charCodeAt(x)?(Ba=bc,x++):(Ba=g,0===ca&&d(Pb)),Ba!==g?ta=sa=Da:(x=ta,ta=g)):(x=ta,ta=g)):(x=
ta,ta=g)}else x=ta,ta=g;else x=ta,ta=g;qa=ta;qa!==g?(oa=ka(),oa!==g?(ha=ya(),ha!==g?Q=ba={TYPE:"include",FILE:qa}:(x=Q,Q=g)):(x=Q,Q=g)):(x=Q,Q=g)}else x=Q,Q=g;else x=Q,Q=g;else x=Q,Q=g;else x=Q,Q=g;if(Q===g){Q=x;35===n.charCodeAt(x)?(ba=ma,x++):(ba=g,0===ca&&d(Ka));if(ba!==g)if(za=ka(),za!==g)if(n.substr(x,6)===ob?(aa=ob,x+=6):(aa=g,0===ca&&d(gb)),aa===g&&(n.substr(x,3)===Ya?(aa=Ya,x+=3):(aa=g,0===ca&&d(sb))),aa!==g)if(ja=Ca(),ja!==g)if(qa=yc(),qa!==g)if(oa=x,ha=Ca(),ha!==g?(va=c(),va!==g?oa=ha=[ha,
va]:(x=oa,oa=g)):(x=oa,oa=g),oa===g&&(oa=null),oa!==g)if(ha=ka(),ha!==g)if(va=ya(),va!==g){var Ua=aa,Za=qa,ab=oa,bb=[];if(null===ab)bb.push("");else for(var cb=0;cb<ab[1].length;cb++)bb.push(ab[1][cb]);Q=ba={TYPE:Ua,NAME:Za,TOKENS:bb}}else x=Q,Q=g;else x=Q,Q=g;else x=Q,Q=g;else x=Q,Q=g;else x=Q,Q=g;else x=Q,Q=g;else x=Q,Q=g;else x=Q,Q=g;if(Q===g){Q=x;35===n.charCodeAt(x)?(ba=ma,x++):(ba=g,0===ca&&d(Ka));if(ba!==g)if(za=ka(),za!==g)if(n.substr(x,5)===Mb?(aa=Mb,x+=5):(aa=g,0===ca&&d(Fb)),aa!==g)if(ja=
x,qa=Ca(),qa!==g?(oa=c(),oa!==g?ja=qa=[qa,oa]:(x=ja,ja=g)):(x=ja,ja=g),ja===g&&(ja=null),ja!==g)if(qa=ka(),qa!==g)if(oa=ya(),oa!==g){var db=ja,hb=[];if(null!==db)for(var jb=0;jb<db[1].length;jb++)hb.push(db[1][jb]);Q=ba={TYPE:"error",TOKENS:hb}}else x=Q,Q=g;else x=Q,Q=g;else x=Q,Q=g;else x=Q,Q=g;else x=Q,Q=g;else x=Q,Q=g;if(Q===g&&(Q=x,35===n.charCodeAt(x)?(ba=ma,x++):(ba=g,0===ca&&d(Ka)),ba!==g?(za=ka(),za!==g?(n.substr(x,4)===mb?(aa=mb,x+=4):(aa=g,0===ca&&d(Sa)),aa!==g?(ja=Ca(),ja!==g?(qa=c(),qa!==
g?(oa=ka(),oa!==g?(ha=ya(),ha!==g?Q=ba={TYPE:"line",TOKENS:qa}:(x=Q,Q=g)):(x=Q,Q=g)):(x=Q,Q=g)):(x=Q,Q=g)):(x=Q,Q=g)):(x=Q,Q=g)):(x=Q,Q=g),Q===g&&(Q=x,35===n.charCodeAt(x)?(ba=ma,x++):(ba=g,0===ca&&d(Ka)),ba!==g?(za=ka(),za!==g?(n.substr(x,6)===ib?(aa=ib,x+=6):(aa=g,0===ca&&d(yb)),aa!==g?(ja=Ca(),ja!==g?(qa=yc(),qa!==g?(oa=Ca(),oa!==g?(ha=c(),ha!==g?(va=ka(),va!==g?(pa=ya(),pa!==g?Q=ba={TYPE:"pragma",NAME:qa,TOKENS:ha}:(x=Q,Q=g)):(x=Q,Q=g)):(x=Q,Q=g)):(x=Q,Q=g)):(x=Q,Q=g)):(x=Q,Q=g)):(x=Q,Q=g)):(x=
Q,Q=g)):(x=Q,Q=g),Q===g&&(Q=x,35===n.charCodeAt(x)?(ba=ma,x++):(ba=g,0===ca&&d(Ka)),ba!==g?(za=ka(),za!==g?(n.substr(x,5)===ua?(aa=ua,x+=5):(aa=g,0===ca&&d(Ra)),aa!==g?(ja=Ca(),ja!==g?(qa=yc(),qa!==g?(oa=ka(),oa!==g?(ha=ya(),ha!==g?Q=ba={TYPE:"undef",NAME:qa}:(x=Q,Q=g)):(x=Q,Q=g)):(x=Q,Q=g)):(x=Q,Q=g)):(x=Q,Q=g)):(x=Q,Q=g)):(x=Q,Q=g),Q===g)))){Q=x;35===n.charCodeAt(x)?(ba=ma,x++):(ba=g,0===ca&&d(Ka));if(ba!==g)if(za=ka(),za!==g)if(n.substr(x,7)===N?(aa=N,x+=7):(aa=g,0===ca&&d(la)),aa!==g)if(ja=x,
qa=Ca(),qa!==g?(oa=c(),oa!==g?ja=qa=[qa,oa]:(x=ja,ja=g)):(x=ja,ja=g),ja===g&&(ja=null),ja!==g)if(qa=ka(),qa!==g)if(oa=ya(),oa!==g){var lb=ja,pb=[];if(null!==lb)for(var tb=0;tb<lb[1].length;tb++)pb.push(lb[1][tb]);Q=ba={TYPE:"warning",TOKENS:pb}}else x=Q,Q=g;else x=Q,Q=g;else x=Q,Q=g;else x=Q,Q=g;else x=Q,Q=g;else x=Q,Q=g;if(Q===g){Q=x;35===n.charCodeAt(x)?(ba=ma,x++):(ba=g,0===ca&&d(Ka));if(ba!==g)if(za=ka(),za!==g)if(n.substr(x,9)===Db?(aa=Db,x+=9):(aa=g,0===ca&&d(Pa)),aa!==g)if(ja=x,qa=Ca(),qa!==
g?(oa=c(),oa!==g?ja=qa=[qa,oa]:(x=ja,ja=g)):(x=ja,ja=g),ja===g&&(ja=null),ja!==g)if(qa=ka(),qa!==g)if(oa=ya(),oa!==g){var vb=ja,Bb=[];if(null!==vb)for(var zb=0;zb<vb[1].length;zb++)Bb.push(vb[1][zb]);Q=ba={TYPE:"extension",TOKENS:Bb}}else x=Q,Q=g;else x=Q,Q=g;else x=Q,Q=g;else x=Q,Q=g;else x=Q,Q=g;else x=Q,Q=g;if(Q===g){Q=x;35===n.charCodeAt(x)?(ba=ma,x++):(ba=g,0===ca&&d(Ka));if(ba!==g)if(za=ka(),za!==g)if(n.substr(x,7)===zc?(aa=zc,x+=7):(aa=g,0===ca&&d(gc)),aa!==g)if(ja=Ca(),ja!==g)if(qa=ia(),qa!==
g)if(oa=ka(),oa!==g)if(ha=ya(),ha!==g){var Eb=[];null!==qa&&Eb.push(qa);Q=ba={TYPE:"version",TOKENS:Eb}}else x=Q,Q=g;else x=Q,Q=g;else x=Q,Q=g;else x=Q,Q=g;else x=Q,Q=g;else x=Q,Q=g;else x=Q,Q=g;Q===g&&(Q=x,35===n.charCodeAt(x)?(ba=ma,x++):(ba=g,0===ca&&d(Ka)),ba!==g?(za=ka(),za!==g?(aa=ya(),aa!==g?Q=ba={TYPE:"#"}:(x=Q,Q=g)):(x=Q,Q=g)):(x=Q,Q=g))}}}}}b=Q;if(b===g){var nb,Cb,Hb,Jb;nb=x;var eb,Lb,Rb,Nb,Ub,Tb,Wb,Xb,Yb,Sb,ub,kb,cc,Ab,Qb;eb=x;35===n.charCodeAt(x)?(Lb=ma,x++):(Lb=g,0===ca&&d(Ka));if(Lb!==
g)if(Rb=ka(),Rb!==g)if(n.substr(x,4)===Ac?(Nb=Ac,x+=4):(Nb=g,0===ca&&d(Vb)),Nb!==g)if(Ub=Ca(),Ub!==g)if(Tb=yc(),Tb!==g)if(Wb=ka(),Wb!==g)if(Xb=ga(),Xb!==g)if(Yb=Ma(),Yb!==g){Sb=[];ub=x;kb=p();kb!==g?(cc=Ma(),cc!==g?ub=kb=[kb,cc]:(x=ub,ub=g)):(x=ub,ub=g);for(;ub!==g;)Sb.push(ub),ub=x,kb=p(),kb!==g?(cc=Ma(),cc!==g?ub=kb=[kb,cc]:(x=ub,ub=g)):(x=ub,ub=g);if(Sb!==g){ub=[];kb=x;cc=u();cc!==g?(Ab=Ma(),Ab!==g?kb=cc=[cc,Ab]:(x=kb,kb=g)):(x=kb,kb=g);for(;kb!==g;)ub.push(kb),kb=x,cc=u(),cc!==g?(Ab=Ma(),Ab!==
g?kb=cc=[cc,Ab]:(x=kb,kb=g)):(x=kb,kb=g);if(ub!==g){kb=[];cc=x;Ab=a();Ab!==g?(Qb=Ma(),Qb!==g?cc=Ab=[Ab,Qb]:(x=cc,cc=g)):(x=cc,cc=g);for(;cc!==g;)kb.push(cc),cc=x,Ab=a(),Ab!==g?(Qb=Ma(),Qb!==g?cc=Ab=[Ab,Qb]:(x=cc,cc=g)):(x=cc,cc=g);if(kb!==g){for(var Zb=ub,$b=kb,fc=[],Kb=0;Kb<Sb.length;Kb++)fc.push(Sb[Kb][0]);for(var jc=[],Kb=0;Kb<Zb.length;Kb++)jc.push(Zb[Kb][0]);for(var nc=[],Kb=0;Kb<$b.length;Kb++)nc.push($b[Kb][0]);eb=Lb={TYPE:"node",NAME:Tb,NODE_VARS:fc,DECLARATIONS:jc,STATEMENTS:nc}}else x=eb,
eb=g}else x=eb,eb=g}else x=eb,eb=g}else x=eb,eb=g;else x=eb,eb=g;else x=eb,eb=g;else x=eb,eb=g;else x=eb,eb=g;else x=eb,eb=g;else x=eb,eb=g;else x=eb,eb=g;Cb=eb;if(Cb!==g)if(Hb=Ma(),Hb!==g){var Gb,ac,ic,ec,lc,dc;Gb=x;35===n.charCodeAt(x)?(ac=ma,x++):(ac=g,0===ca&&d(Ka));ac!==g?(ic=ka(),ic!==g?(n.substr(x,7)===wb?(ec=wb,x+=7):(ec=g,0===ca&&d(qb)),ec!==g?(lc=ka(),lc!==g?(dc=ya(),dc===g&&(dc=null),dc!==g?Gb=ac=[ac,ic,ec,lc,dc]:(x=Gb,Gb=g)):(x=Gb,Gb=g)):(x=Gb,Gb=g)):(x=Gb,Gb=g)):(x=Gb,Gb=g);Jb=Gb;Jb!==
g?nb=Cb:(x=nb,nb=g)}else x=nb,nb=g;else x=nb,nb=g;if(nb===g){var Ib,hc,qc,oc,rc,sc;Ib=x;35===n.charCodeAt(x)?(hc=ma,x++):(hc=g,0===ca&&d(Ka));hc!==g?(qc=ka(),qc!==g?(n.substr(x,12)===xb?(oc=xb,x+=12):(oc=g,0===ca&&d(vc)),oc!==g?(rc=ka(),rc!==g?(sc=ya(),sc!==g?Ib=hc={TYPE:"nodes_global"}:(x=Ib,Ib=g)):(x=Ib,Ib=g)):(x=Ib,Ib=g)):(x=Ib,Ib=g)):(x=Ib,Ib=g);nb=Ib;if(nb===g){var Ob,pc,uc,tc,wc,xc;Ob=x;35===n.charCodeAt(x)?(pc=ma,x++):(pc=g,0===ca&&d(Ka));pc!==g?(uc=ka(),uc!==g?(n.substr(x,10)===mc?(tc=mc,
x+=10):(tc=g,0===ca&&d(kc)),tc!==g?(wc=ka(),wc!==g?(xc=ya(),xc!==g?Ob=pc={TYPE:"nodes_main"}:(x=Ob,Ob=g)):(x=Ob,Ob=g)):(x=Ob,Ob=g)):(x=Ob,Ob=g)):(x=Ob,Ob=g);nb=Ob}}b=nb;b===g&&(b=l())}}return b}function r(){var a,b,c,e;a=x;35===n.charCodeAt(x)?(b=ma,x++):(b=g,0===ca&&d(Ka));b!==g?(b=ka(),b!==g?(n.substr(x,4)===Ua?(b=Ua,x+=4):(b=g,0===ca&&d(Na)),b!==g?(b=Ca(),b!==g?(b=m(),b!==g?(c=ka(),c!==g?(c=ga(),c!==g?(c=Ma(),c!==g?(c=I(),c!==g?(e=Ma(),e!==g?a=b={TYPE:"elif",EXPRESSION:b,GROUP:c}:(x=a,a=g)):(x=
a,a=g)):(x=a,a=g)):(x=a,a=g)):(x=a,a=g)):(x=a,a=g)):(x=a,a=g)):(x=a,a=g)):(x=a,a=g)):(x=a,a=g);return a}function p(){var a,b,e,f,h;a=x;35===n.charCodeAt(x)?(b=ma,x++):(b=g,0===ca&&d(Ka));if(b!==g)if(b=ka(),b!==g)if(n.substr(x,8)===Za?(b=Za,x+=8):(b=g,0===ca&&d(Eb)),b!==g)if(b=Ca(),b!==g)if(b=yc(),b!==g)if(e=x,f=Ca(),f!==g?(h=c(),h!==g?e=f=[f,h]:(x=e,e=g)):(x=e,e=g),e===g&&(e=null),e!==g)if(f=ka(),f!==g)if(h=ga(),h!==g){a=e;e=[];if(null===a)e.push("");else for(f=0;f<a[1].length;f++)e.push(a[1][f]);
a=b={TYPE:"node_var",NAME:b,TOKENS:e}}else x=a,a=g;else x=a,a=g;else x=a,a=g;else x=a,a=g;else x=a,a=g;else x=a,a=g;else x=a,a=g;else x=a,a=g;return a}function u(){var a,b,e,f,h;a=x;35===n.charCodeAt(x)?(b=ma,x++):(b=g,0===ca&&d(Ka));if(b!==g)if(b=ka(),b!==g)if(n.substr(x,7)===nc?(b=nc,x+=7):(b=g,0===ca&&d(eb)),b!==g)if(e=x,b=Ca(),b!==g?(n.substr(x,8)===fc?(f=fc,x+=8):(f=g,0===ca&&d(Bc)),f!==g?e=b=[b,f]:(x=e,e=g)):(x=e,e=g),e===g&&(e=null),e!==g)if(b=x,f=Ca(),f!==g?(h=c(),h!==g?b=f=[f,h]:(x=b,b=g)):
(x=b,b=g),b===g&&(b=null),b!==g)if(f=ka(),f!==g)if(h=ga(),h!==g){a=e;e=[];if(null!==b)for(f=0;f<b[1].length;f++)e.push(b[1][f]);a=b={TYPE:"node_in",NAME:e.pop(),QUALIFIER:e,IS_OPTIONAL:!!a}}else x=a,a=g;else x=a,a=g;else x=a,a=g;else x=a,a=g;else x=a,a=g;else x=a,a=g;else x=a,a=g;if(a===g){a=x;35===n.charCodeAt(x)?(b=ma,x++):(b=g,0===ca&&d(Ka));if(b!==g)if(b=ka(),b!==g)if(n.substr(x,8)===Xc?(b=Xc,x+=8):(b=g,0===ca&&d(cb)),b!==g)if(e=x,b=Ca(),b!==g?(n.substr(x,8)===fc?(f=fc,x+=8):(f=g,0===ca&&d(Bc)),
f!==g?e=b=[b,f]:(x=e,e=g)):(x=e,e=g),e===g&&(e=null),e!==g)if(b=x,f=Ca(),f!==g?(h=c(),h!==g?b=f=[f,h]:(x=b,b=g)):(x=b,b=g),b===g&&(b=null),b!==g)if(f=ka(),f!==g)if(h=ga(),h!==g){a=e;e=[];if(null!==b)for(f=0;f<b[1].length;f++)e.push(b[1][f]);a=b={TYPE:"node_out",NAME:e.pop(),QUALIFIER:e,IS_OPTIONAL:!!a}}else x=a,a=g;else x=a,a=g;else x=a,a=g;else x=a,a=g;else x=a,a=g;else x=a,a=g;else x=a,a=g;if(a===g)if(a=x,35===n.charCodeAt(x)?(b=ma,x++):(b=g,0===ca&&d(Ka)),b!==g)if(b=ka(),b!==g)if(n.substr(x,10)===
tb?(b=tb,x+=10):(b=g,0===ca&&d(nb)),b!==g)if(e=x,b=Ca(),b!==g?(n.substr(x,8)===fc?(f=fc,x+=8):(f=g,0===ca&&d(Bc)),f!==g?e=b=[b,f]:(x=e,e=g)):(x=e,e=g),e===g&&(e=null),e!==g)if(b=x,f=Ca(),f!==g?(h=c(),h!==g?b=f=[f,h]:(x=b,b=g)):(x=b,b=g),b===g&&(b=null),b!==g)if(f=ka(),f!==g)if(h=ga(),h!==g){a=e;e=[];if(null!==b)for(f=0;f<b[1].length;f++)e.push(b[1][f]);a=b={TYPE:"node_param",NAME:e.pop(),QUALIFIER:e,IS_OPTIONAL:!!a}}else x=a,a=g;else x=a,a=g;else x=a,a=g;else x=a,a=g;else x=a,a=g;else x=a,a=g;else x=
a,a=g}return a}function a(){var b,c,e,f,h;b=x;var k,q;e=x;35===n.charCodeAt(x)?(c=ma,x++):(c=g,0===ca&&d(Ka));if(c!==g)if(c=ka(),c!==g)if(n.substr(x,7)===Bb?(c=Bb,x+=7):(c=g,0===ca&&d(Wb)),c!==g)if(c=Ca(),c!==g)if(c=m(),c!==g)if(f=ka(),f!==g)if(f=ga(),f!==g)if(f=Ma(),f!==g){f=[];h=x;k=a();k!==g?(q=Ma(),q!==g?h=k=[k,q]:(x=h,h=g)):(x=h,h=g);for(;h!==g;)f.push(h),h=x,k=a(),k!==g?(q=Ma(),q!==g?h=k=[k,q]:(x=h,h=g)):(x=h,h=g);if(f!==g){e=c;c=f;f=[];for(h=0;h<c.length;h++)f.push(c[h][0]);e=c={TYPE:"node_if",
EXPRESSION:e,STATEMENTS:f}}else x=e,e=g}else x=e,e=g;else x=e,e=g;else x=e,e=g;else x=e,e=g;else x=e,e=g;else x=e,e=g;else x=e,e=g;else x=e,e=g;if(e===g){e=x;35===n.charCodeAt(x)?(c=ma,x++):(c=g,0===ca&&d(Ka));if(c!==g)if(c=ka(),c!==g)if(n.substr(x,10)===Ha?(c=Ha,x+=10):(c=g,0===ca&&d(pb)),c!==g)if(c=Ca(),c!==g)if(c=yc(),c!==g)if(f=ka(),f!==g)if(f=ga(),f!==g)if(f=Ma(),f!==g){f=[];h=x;k=a();k!==g?(q=Ma(),q!==g?h=k=[k,q]:(x=h,h=g)):(x=h,h=g);for(;h!==g;)f.push(h),h=x,k=a(),k!==g?(q=Ma(),q!==g?h=k=[k,
q]:(x=h,h=g)):(x=h,h=g);if(f!==g){e=c;c=f;f=[];for(h=0;h<c.length;h++)f.push(c[h][0]);e=c={TYPE:"node_ifdef",NAME:e,STATEMENTS:f}}else x=e,e=g}else x=e,e=g;else x=e,e=g;else x=e,e=g;else x=e,e=g;else x=e,e=g;else x=e,e=g;else x=e,e=g;else x=e,e=g;if(e===g)if(e=x,35===n.charCodeAt(x)?(c=ma,x++):(c=g,0===ca&&d(Ka)),c!==g)if(c=ka(),c!==g)if(n.substr(x,11)===Fa?(c=Fa,x+=11):(c=g,0===ca&&d(aa)),c!==g)if(c=Ca(),c!==g)if(c=yc(),c!==g)if(f=ka(),f!==g)if(f=ga(),f!==g)if(f=Ma(),f!==g){f=[];h=x;k=a();k!==g?
(q=Ma(),q!==g?h=k=[k,q]:(x=h,h=g)):(x=h,h=g);for(;h!==g;)f.push(h),h=x,k=a(),k!==g?(q=Ma(),q!==g?h=k=[k,q]:(x=h,h=g)):(x=h,h=g);if(f!==g){e=c;c=f;f=[];for(h=0;h<c.length;h++)f.push(c[h][0]);e=c={TYPE:"node_ifndef",NAME:e,STATEMENTS:f}}else x=e,e=g}else x=e,e=g;else x=e,e=g;else x=e,e=g;else x=e,e=g;else x=e,e=g;else x=e,e=g;else x=e,e=g;else x=e,e=g}c=e;if(c!==g)if(e=Ma(),e!==g){e=[];for(f=B();f!==g;)e.push(f),f=B();if(e!==g)if(f=Ma(),f!==g){var p;f=x;35===n.charCodeAt(x)?(h=ma,x++):(h=g,0===ca&&
d(Ka));if(h!==g)if(h=ka(),h!==g)if(n.substr(x,9)===db?(h=db,x+=9):(h=g,0===ca&&d(jb)),h!==g)if(h=ka(),h!==g)if(h=ga(),h!==g)if(h=Ma(),h!==g){h=[];k=x;q=a();q!==g?(p=Ma(),p!==g?k=q=[q,p]:(x=k,k=g)):(x=k,k=g);for(;k!==g;)h.push(k),k=x,q=a(),q!==g?(p=Ma(),p!==g?k=q=[q,p]:(x=k,k=g)):(x=k,k=g);if(h!==g){f=[];for(k=0;k<h.length;k++)f.push(h[k][0]);f=h={TYPE:"node_else",STATEMENTS:f}}else x=f,f=g}else x=f,f=g;else x=f,f=g;else x=f,f=g;else x=f,f=g;else x=f,f=g;else x=f,f=g;f===g&&(f=null);if(f!==g)if(h=
Ma(),h!==g){var r,w;h=x;35===n.charCodeAt(x)?(k=ma,x++):(k=g,0===ca&&d(Ka));k!==g?(q=ka(),q!==g?(n.substr(x,10)===Ub?(p=Ub,x+=10):(p=g,0===ca&&d(dc)),p!==g?(r=ka(),r!==g?(w=ya(),w!==g?h=k=[k,q,p,r,w]:(x=h,h=g)):(x=h,h=g)):(x=h,h=g)):(x=h,h=g)):(x=h,h=g);if(h!==g){b=f;c=[c];for(f=0;f<e.length;f++)c.push(e[f]);null!==b&&c.push(b);b=c={TYPE:"node_cond",PARTS:c}}else x=b,b=g}else x=b,b=g;else x=b,b=g}else x=b,b=g;else x=b,b=g}else x=b,b=g;else x=b,b=g;b===g&&(b=l());return b}function B(){var b,c,e,f,
h,k;b=x;35===n.charCodeAt(x)?(c=ma,x++):(c=g,0===ca&&d(Ka));if(c!==g)if(c=ka(),c!==g)if(n.substr(x,9)===bb?(c=bb,x+=9):(c=g,0===ca&&d(Wc)),c!==g)if(c=Ca(),c!==g)if(c=m(),c!==g)if(e=ka(),e!==g)if(e=ga(),e!==g)if(e=Ma(),e!==g){e=[];f=x;h=a();h!==g?(k=Ma(),k!==g?f=h=[h,k]:(x=f,f=g)):(x=f,f=g);for(;f!==g;)e.push(f),f=x,h=a(),h!==g?(k=Ma(),k!==g?f=h=[h,k]:(x=f,f=g)):(x=f,f=g);if(e!==g)if(f=Ma(),f!==g){b=[];for(f=0;f<e.length;f++)b.push(e[f][0]);b=c={TYPE:"node_elif",EXPRESSION:c,STATEMENTS:b}}else x=b,
b=g;else x=b,b=g}else x=b,b=g;else x=b,b=g;else x=b,b=g;else x=b,b=g;else x=b,b=g;else x=b,b=g;else x=b,b=g;else x=b,b=g;return b}function l(){var a;a=c();a!==g&&(a={TYPE:"txt",TOKENS:a});return a}function c(){var a,b,c,d,e,f;a=x;b=ia();if(b!==g){c=[];d=x;e=ka();e!==g?(f=ia(),f!==g?d=e=[e,f]:(x=d,d=g)):(x=d,d=g);for(;d!==g;)c.push(d),d=x,e=ka(),e!==g?(f=ia(),f!==g?d=e=[e,f]:(x=d,d=g)):(x=d,d=g);c!==g?a=b=Ta(b,c):(x=a,a=g)}else x=a,a=g;return a}function m(){var a,c,e,f,h,k,l,m;a=x;c=b();if(c!==g){e=
[];f=x;h=ka();h!==g?(44===n.charCodeAt(x)?(k=zb,x++):(k=g,0===ca&&d(Sb)),k!==g?(l=ka(),l!==g?(m=b(),m!==g?f=h=[h,k,l,m]:(x=f,f=g)):(x=f,f=g)):(x=f,f=g)):(x=f,f=g);for(;f!==g;)e.push(f),f=x,h=ka(),h!==g?(44===n.charCodeAt(x)?(k=zb,x++):(k=g,0===ca&&d(Sb)),k!==g?(l=ka(),l!==g?(m=b(),m!==g?f=h=[h,k,l,m]:(x=f,f=g)):(x=f,f=g)):(x=f,f=g)):(x=f,f=g);e!==g?(0!=e.length&&(c=e[e.length-1]),a=c):(x=a,a=g)}else x=a,a=g;return a}function b(){var a,b,c,e;a=x;b=f();b!==g?(c=ka(),c!==g?(63===n.charCodeAt(x)?(c=Vc,
x++):(c=g,0===ca&&d(gd)),c!==g?(c=ka(),c!==g?(c=m(),c!==g?(e=ka(),e!==g?(58===n.charCodeAt(x)?(e=lc,x++):(e=g,0===ca&&d(Kc)),e!==g?(e=ka(),e!==g?(e=m(),e!==g?(a=b,a.push.apply(a,c),a.push.apply(a,e),a.push({TYPE:"conditional_expr",PLACES:3})):(x=a,a=g)):(x=a,a=g)):(x=a,a=g)):(x=a,a=g)):(x=a,a=g)):(x=a,a=g)):(x=a,a=g)):(x=a,a=g)):(x=a,a=g);a===g&&(a=f());return a}function f(){var a,b,c,d,e,f,k,l;a=x;b=C();if(b!==g){c=[];d=x;e=ka();e!==g?(f=h(),f!==g?(k=ka(),k!==g?(l=C(),l!==g?d=e=[e,f,k,l]:(x=d,d=
g)):(x=d,d=g)):(x=d,d=g)):(x=d,d=g);for(;d!==g;)c.push(d),d=x,e=ka(),e!==g?(f=h(),f!==g?(k=ka(),k!==g?(l=C(),l!==g?d=e=[e,f,k,l]:(x=d,d=g)):(x=d,d=g)):(x=d,d=g)):(x=d,d=g);if(c!==g){if(a=b,c.length){b={TYPE:"logical_or_expr",PLACES:c.length+1};for(d=0;d<c.length;d++)a.push.apply(a,c[d][3]);a.push(b)}}else x=a,a=g}else x=a,a=g;return a}function C(){var a,b,c,d,e,f,h,k;a=x;b=R();if(b!==g){c=[];d=x;e=ka();e!==g?(f=D(),f!==g?(h=ka(),h!==g?(k=R(),k!==g?d=e=[e,f,h,k]:(x=d,d=g)):(x=d,d=g)):(x=d,d=g)):(x=
d,d=g);for(;d!==g;)c.push(d),d=x,e=ka(),e!==g?(f=D(),f!==g?(h=ka(),h!==g?(k=R(),k!==g?d=e=[e,f,h,k]:(x=d,d=g)):(x=d,d=g)):(x=d,d=g)):(x=d,d=g);if(c!==g){if(a=b,c.length){b={TYPE:"logical_and_expr",PLACES:c.length+1};for(d=0;d<c.length;d++)a.push.apply(a,c[d][3]);a.push(b)}}else x=a,a=g}else x=a,a=g;return a}function R(){var a,b,c,d,e,f,h,k;a=x;b=z();if(b!==g){c=[];d=x;e=ka();e!==g?(f=H(),f!==g?(h=ka(),h!==g?(k=z(),k!==g?d=e=[e,f,h,k]:(x=d,d=g)):(x=d,d=g)):(x=d,d=g)):(x=d,d=g);for(;d!==g;)c.push(d),
d=x,e=ka(),e!==g?(f=H(),f!==g?(h=ka(),h!==g?(k=z(),k!==g?d=e=[e,f,h,k]:(x=d,d=g)):(x=d,d=g)):(x=d,d=g)):(x=d,d=g);if(c!==g){if(a=b,c.length){b={TYPE:"logical_bitor_expr",PLACES:c.length+1};for(d=0;d<c.length;d++)a.push.apply(a,c[d][3]);a.push(b)}}else x=a,a=g}else x=a,a=g;return a}function z(){var a,b,c,d,e,f,h,k;a=x;b=G();if(b!==g){c=[];d=x;e=ka();e!==g?(f=ea(),f!==g?(h=ka(),h!==g?(k=G(),k!==g?d=e=[e,f,h,k]:(x=d,d=g)):(x=d,d=g)):(x=d,d=g)):(x=d,d=g);for(;d!==g;)c.push(d),d=x,e=ka(),e!==g?(f=ea(),
f!==g?(h=ka(),h!==g?(k=G(),k!==g?d=e=[e,f,h,k]:(x=d,d=g)):(x=d,d=g)):(x=d,d=g)):(x=d,d=g);if(c!==g){if(a=b,c.length){b={TYPE:"logical_bitxor_expr",PLACES:c.length+1};for(d=0;d<c.length;d++)a.push.apply(a,c[d][3]);a.push(b)}}else x=a,a=g}else x=a,a=g;return a}function G(){var a,b,c,d,e,f,h,k;a=x;b=E();if(b!==g){c=[];d=x;e=ka();e!==g?(f=w(),f!==g?(h=ka(),h!==g?(k=E(),k!==g?d=e=[e,f,h,k]:(x=d,d=g)):(x=d,d=g)):(x=d,d=g)):(x=d,d=g);for(;d!==g;)c.push(d),d=x,e=ka(),e!==g?(f=w(),f!==g?(h=ka(),h!==g?(k=E(),
k!==g?d=e=[e,f,h,k]:(x=d,d=g)):(x=d,d=g)):(x=d,d=g)):(x=d,d=g);if(c!==g){if(a=b,c.length){b={TYPE:"logical_bitand_expr",PLACES:c.length+1};for(d=0;d<c.length;d++)a.push.apply(a,c[d][3]);a.push(b)}}else x=a,a=g}else x=a,a=g;return a}function E(){var a,b,c,d,e,f,h,k;a=x;b=J();if(b!==g){c=[];d=x;e=ka();e!==g?(f=q(),f!==g?(h=ka(),h!==g?(k=J(),k!==g?d=e=[e,f,h,k]:(x=d,d=g)):(x=d,d=g)):(x=d,d=g)):(x=d,d=g);for(;d!==g;)c.push(d),d=x,e=ka(),e!==g?(f=q(),f!==g?(h=ka(),h!==g?(k=J(),k!==g?d=e=[e,f,h,k]:(x=d,
d=g)):(x=d,d=g)):(x=d,d=g)):(x=d,d=g);if(c!==g)for(a=b,b=0;b<c.length;b++)switch(c[b][1]){case "==":d={TYPE:"equal_expr",PLACES:2};a.push.apply(a,c[b][3]);a.push(d);break;case "!=":d={TYPE:"non_equal_expr",PLACES:2},a.push.apply(a,c[b][3]),a.push(d)}else x=a,a=g}else x=a,a=g;return a}function J(){var a,b,c,d,e,f,h,k;a=x;b=M();if(b!==g){c=[];d=x;e=ka();e!==g?(f=L(),f!==g?(h=ka(),h!==g?(k=M(),k!==g?d=e=[e,f,h,k]:(x=d,d=g)):(x=d,d=g)):(x=d,d=g)):(x=d,d=g);for(;d!==g;)c.push(d),d=x,e=ka(),e!==g?(f=L(),
f!==g?(h=ka(),h!==g?(k=M(),k!==g?d=e=[e,f,h,k]:(x=d,d=g)):(x=d,d=g)):(x=d,d=g)):(x=d,d=g);if(c!==g)for(a=b,b=0;b<c.length;b++)switch(c[b][1]){case "<=":d={TYPE:"le_expr",PLACES:2};a.push.apply(a,c[b][3]);a.push(d);break;case ">=":d={TYPE:"ge_expr",PLACES:2};a.push.apply(a,c[b][3]);a.push(d);break;case "<":d={TYPE:"l_expr",PLACES:2};a.push.apply(a,c[b][3]);a.push(d);break;case ">":d={TYPE:"g_expr",PLACES:2},a.push.apply(a,c[b][3]),a.push(d)}else x=a,a=g}else x=a,a=g;return a}function M(){var a,b,c,
d,e,f,h,k;a=x;b=F();if(b!==g){c=[];d=x;e=ka();e!==g?(f=S(),f!==g?(h=ka(),h!==g?(k=F(),k!==g?d=e=[e,f,h,k]:(x=d,d=g)):(x=d,d=g)):(x=d,d=g)):(x=d,d=g);for(;d!==g;)c.push(d),d=x,e=ka(),e!==g?(f=S(),f!==g?(h=ka(),h!==g?(k=F(),k!==g?d=e=[e,f,h,k]:(x=d,d=g)):(x=d,d=g)):(x=d,d=g)):(x=d,d=g);if(c!==g)for(a=b,b=0;b<c.length;b++)switch(c[b][1]){case "<<":d={TYPE:"left_shift_expr",PLACES:2};a.push.apply(a,c[b][3]);a.push(d);break;case ">>":d={TYPE:"right_shift_expr",PLACES:2},a.push.apply(a,c[b][3]),a.push(d)}else x=
a,a=g}else x=a,a=g;return a}function F(){var a,b,c,d,e,f,h,k;a=x;b=U();if(b!==g){c=[];d=x;e=ka();e!==g?(f=ha(),f!==g?(h=ka(),h!==g?(k=U(),k!==g?d=e=[e,f,h,k]:(x=d,d=g)):(x=d,d=g)):(x=d,d=g)):(x=d,d=g);for(;d!==g;)c.push(d),d=x,e=ka(),e!==g?(f=ha(),f!==g?(h=ka(),h!==g?(k=U(),k!==g?d=e=[e,f,h,k]:(x=d,d=g)):(x=d,d=g)):(x=d,d=g)):(x=d,d=g);if(c!==g)for(a=b,b=0;b<c.length;b++)switch(c[b][1]){case "+":d={TYPE:"add_expr",PLACES:2};a.push.apply(a,c[b][3]);a.push(d);break;case "-":d={TYPE:"sub_expr",PLACES:2},
a.push.apply(a,c[b][3]),a.push(d)}else x=a,a=g}else x=a,a=g;return a}function U(){var a,b,c,d,e,f,h,k;a=x;b=K();if(b!==g){c=[];d=x;e=ka();e!==g?(f=Y(),f!==g?(h=ka(),h!==g?(k=K(),k!==g?d=e=[e,f,h,k]:(x=d,d=g)):(x=d,d=g)):(x=d,d=g)):(x=d,d=g);for(;d!==g;)c.push(d),d=x,e=ka(),e!==g?(f=Y(),f!==g?(h=ka(),h!==g?(k=K(),k!==g?d=e=[e,f,h,k]:(x=d,d=g)):(x=d,d=g)):(x=d,d=g)):(x=d,d=g);if(c!==g)for(a=b,b=0;b<c.length;b++)switch(c[b][1]){case "*":d={TYPE:"mul_expr",PLACES:2};a.push.apply(a,c[b][3]);a.push(d);
break;case "/":d={TYPE:"div_expr",PLACES:2};a.push.apply(a,c[b][3]);a.push(d);break;case "%":d={TYPE:"mod_expr",PLACES:2},a.push.apply(a,c[b][3]),a.push(d)}else x=a,a=g}else x=a,a=g;return a}function K(){var a,b,c;a=x;n.substr(x,7)===Cb?(b=Cb,x+=7):(b=g,0===ca&&d(Tb));b!==g?(c=ka(),c!==g?(c=v(),c!==g?a=c:(x=a,a=g)):(x=a,a=g)):(x=a,a=g);if(a===g){a=x;b=V();if(b!==g)if(c=ka(),c!==g)if(n.substr(x,2)===vb?(c=vb,x+=2):(c=g,0===ca&&d(Rb)),c===g&&(n.substr(x,2)===rc?(c=rc,x+=2):(c=g,0===ca&&d(jc))),c!==
g)switch(a=b,c){case "++":b={TYPE:"post_inc_expr",PLACES:1};a.push(b);break;case "--":b={TYPE:"post_dec_expr",PLACES:1},a.push(b)}else x=a,a=g;else x=a,a=g;else x=a,a=g;a===g&&(a=V());if(a===g)if(a=x,n.substr(x,2)===vb?(b=vb,x+=2):(b=g,0===ca&&d(Rb)),b===g&&(n.substr(x,2)===rc?(b=rc,x+=2):(b=g,0===ca&&d(jc)),b===g&&(43===n.charCodeAt(x)?(b=sc,x++):(b=g,0===ca&&d(cd)),b===g&&(45===n.charCodeAt(x)?(b=fd,x++):(b=g,0===ca&&d(Dc)),b===g&&(126===n.charCodeAt(x)?(b=ge,x++):(b=g,0===ca&&d(te)),b===g&&(33===
n.charCodeAt(x)?(b=qd,x++):(b=g,0===ca&&d(Hd))))))),b!==g)if(c=ka(),c!==g)if(c=K(),c!==g)switch(a=c,b){case "++":b={TYPE:"pre_inc_expr",PLACES:1};a.push(b);break;case "--":b={TYPE:"pre_dec_expr",PLACES:1};a.push(b);break;case "+":b={TYPE:"positive_expr",PLACES:1};a.push(b);break;case "-":b={TYPE:"negative_expr",PLACES:1};a.push(b);break;case "~":b={TYPE:"one_compl_expr",PLACES:1};a.push(b);break;case "!":b={TYPE:"logic_negative_expr",PLACES:1},a.push(b)}else x=a,a=g;else x=a,a=g;else x=a,a=g}return a}
function V(){var a,b,c;ca++;a=oa();a===g&&(a=x,b=Q(),a=b!==g?n.substring(a,x):b,a!==g&&(a=parseInt(a)));ca--;a===g&&0===ca&&d(Nb);b=a;b!==g&&(b=[b]);a=b;a===g&&(b=yc(),b!==g&&(b=[b]),a=b,a===g&&(a=x,40===n.charCodeAt(x)?(b=Zb,x++):(b=g,0===ca&&d(qc)),b!==g?(b=ka(),b!==g?(b=m(),b!==g?(c=ka(),c!==g?(41===n.charCodeAt(x)?(c=Ib,x++):(c=g,0===ca&&d(Ec)),c!==g?a=b:(x=a,a=g)):(x=a,a=g)):(x=a,a=g)):(x=a,a=g)):(x=a,a=g)));return a}function v(){var a,b,c,e,f;b=yc();b!==g&&(b=[b]);a=b;if(a===g){b=[];e=c=x;ca++;
40===n.charCodeAt(x)?(f=Zb,x++):(f=g,0===ca&&d(qc));f===g&&(41===n.charCodeAt(x)?(f=Ib,x++):(f=g,0===ca&&d(Ec)));ca--;f===g?e=void 0:(x=e,e=g);e!==g?(f=na(),f!==g?c=e=[e,f]:(x=c,c=g)):(x=c,c=g);if(c!==g)for(;c!==g;)b.push(c),e=c=x,ca++,40===n.charCodeAt(x)?(f=Zb,x++):(f=g,0===ca&&d(qc)),f===g&&(41===n.charCodeAt(x)?(f=Ib,x++):(f=g,0===ca&&d(Ec))),ca--,f===g?e=void 0:(x=e,e=g),e!==g?(f=na(),f!==g?c=e=[e,f]:(x=c,c=g)):(x=c,c=g);else b=g;b!==g&&(b=1);a=b;a===g&&(a=x,40===n.charCodeAt(x)?(b=Zb,x++):(b=
g,0===ca&&d(qc)),b!==g?(c=ka(),c!==g?(e=v(),e!==g?(f=ka(),f!==g?(41===n.charCodeAt(x)?(b=Ib,x++):(b=g,0===ca&&d(Ec)),b!==g?a=e:(x=a,a=g)):(x=a,a=g)):(x=a,a=g)):(x=a,a=g)):(x=a,a=g))}return a}function Y(){var a,b,c,e;a=x;42===n.charCodeAt(x)?(b=Wd,x++):(b=g,0===ca&&d(rd));b===g&&(47===n.charCodeAt(x)?(b=he,x++):(b=g,0===ca&&d(sd)),b===g&&(37===n.charCodeAt(x)?(b=Xd,x++):(b=g,0===ca&&d(ue))));b!==g?(c=x,ca++,61===n.charCodeAt(x)?(e=ab,x++):(e=g,0===ca&&d(Lc)),ca--,e===g?c=void 0:(x=c,c=g),c!==g?a=b:
(x=a,a=g)):(x=a,a=g);return a}function ha(){var a,b,c;a=x;43===n.charCodeAt(x)?(b=sc,x++):(b=g,0===ca&&d(cd));b!==g?(b=x,ca++,43===n.charCodeAt(x)?(c=sc,x++):(c=g,0===ca&&d(cd)),c===g&&(61===n.charCodeAt(x)?(c=ab,x++):(c=g,0===ca&&d(Lc))),ca--,c===g?b=void 0:(x=b,b=g),b!==g?a="+":(x=a,a=g)):(x=a,a=g);a===g&&(a=x,45===n.charCodeAt(x)?(b=fd,x++):(b=g,0===ca&&d(Dc)),b!==g?(b=x,ca++,45===n.charCodeAt(x)?(c=fd,x++):(c=g,0===ca&&d(Dc)),c===g&&(61===n.charCodeAt(x)?(c=ab,x++):(c=g,0===ca&&d(Lc))),ca--,c===
g?b=void 0:(x=b,b=g),b!==g?a="-":(x=a,a=g)):(x=a,a=g));return a}function S(){var a;n.substr(x,2)===Dd?(a=Dd,x+=2):(a=g,0===ca&&d(tc));a===g&&(n.substr(x,2)===Jb?(a=Jb,x+=2):(a=g,0===ca&&d(Gb)));return a}function L(){var a;n.substr(x,2)===Id?(a=Id,x+=2):(a=g,0===ca&&d(Ed));a===g&&(n.substr(x,2)===dd?(a=dd,x+=2):(a=g,0===ca&&d(Yd)),a===g&&(60===n.charCodeAt(x)?(a=Fd,x++):(a=g,0===ca&&d(Jd)),a===g&&(62===n.charCodeAt(x)?(a=Yc,x++):(a=g,0===ca&&d(td)))));return a}function q(){var a;n.substr(x,2)===Pc?
(a=Pc,x+=2):(a=g,0===ca&&d(ub));a===g&&(n.substr(x,2)===Ob?(a=Ob,x+=2):(a=g,0===ca&&d(Zc)));return a}function w(){var a,b,c;a=x;38===n.charCodeAt(x)?(b=kb,x++):(b=g,0===ca&&d(Xb));b!==g?(b=x,ca++,38===n.charCodeAt(x)?(c=kb,x++):(c=g,0===ca&&d(Xb)),ca--,c===g?b=void 0:(x=b,b=g),b!==g?a="&":(x=a,a=g)):(x=a,a=g);return a}function ea(){var a,b,c;a=x;94===n.charCodeAt(x)?(b=hc,x++):(b=g,0===ca&&d(Fc));b!==g?(b=x,ca++,94===n.charCodeAt(x)?(c=hc,x++):(c=g,0===ca&&d(Fc)),ca--,c===g?b=void 0:(x=b,b=g),b!==
g?a="^":(x=a,a=g)):(x=a,a=g);return a}function H(){var a,b,c;a=x;124===n.charCodeAt(x)?(b=Kb,x++):(b=g,0===ca&&d($b));b!==g?(b=x,ca++,124===n.charCodeAt(x)?(c=Kb,x++):(c=g,0===ca&&d($b)),ca--,c===g?b=void 0:(x=b,b=g),b!==g?a="|":(x=a,a=g)):(x=a,a=g);return a}function D(){var a;n.substr(x,2)===wc?(a=wc,x+=2):(a=g,0===ca&&d(Qc));a!==g&&(a="&&");return a}function h(){var a;n.substr(x,2)===ac?(a=ac,x+=2):(a=g,0===ca&&d(Yb));a!==g&&(a="||");return a}function ia(){var a;a=yc();if(a===g){var b,c,e;ca++;
a=x;b=oa();if(b===g){var f,h,k;c=b=x;e=Q();e!==g?(46===n.charCodeAt(x)?(f=ec,x++):(f=g,0===ca&&d(ed)),f!==g?(h=da(),h===g&&(h=null),h!==g?(k=va(),k===g&&(k=null),k!==g?c=e=[e,f,h,k]:(x=c,c=g)):(x=c,c=g)):(x=c,c=g)):(x=c,c=g);b=c!==g?n.substring(b,x):c;b===g&&(c=b=x,46===n.charCodeAt(x)?(e=ec,x++):(e=g,0===ca&&d(ed)),e!==g?(f=da(),f!==g?(h=va(),h===g&&(h=null),h!==g?c=e=[e,f,h]:(x=c,c=g)):(x=c,c=g)):(x=c,c=g),b=c!==g?n.substring(b,x):c,b===g&&(c=b=x,e=Q(),e!==g?(f=va(),f===g&&(f=null),f!==g?c=e=[e,
f]:(x=c,c=g)):(x=c,c=g),b=c!==g?n.substring(b,x):c))}b!==g?(c=x,ca++,e=za(),ca--,e===g?c=void 0:(x=c,c=g),c!==g?a=b:(x=a,a=g)):(x=a,a=g);ca--;a===g&&0===ca&&d(Nb);if(a===g){ca++;a=x;34===n.charCodeAt(x)?(b=bc,x++):(b=g,0===ca&&d(Pb));if(b!==g){c=[];e=ba();if(e!==g)for(;e!==g;)c.push(e),e=ba();else c=g;c!==g&&(c=c.join(""));c===g&&(c=null);c!==g?(34===n.charCodeAt(x)?(e=bc,x++):(e=g,0===ca&&d(Pb)),e!==g?a=b=[b,c,e]:(x=a,a=g)):(x=a,a=g)}else x=a,a=g;if(a===g)if(a=x,39===n.charCodeAt(x)?(b=kd,x++):(b=
g,0===ca&&d(Ad)),b!==g){c=[];e=Ea();if(e!==g)for(;e!==g;)c.push(e),e=Ea();else c=g;c!==g&&(c=c.join(""));c===g&&(c=null);c!==g?(39===n.charCodeAt(x)?(e=kd,x++):(e=g,0===ca&&d(Ad)),e!==g?a=b=[b,c,e]:(x=a,a=g)):(x=a,a=g)}else x=a,a=g;a!==g&&(a='"'+a[1]+'"');ca--;a===g&&0===ca&&d(Od);a===g&&(ca++,n.substr(x,2)===le?(a=le,x+=2):(a=g,0===ca&&d(Zd)),a===g&&(n.substr(x,2)===me?(a=me,x+=2):(a=g,0===ca&&d($d)),a===g&&(n.substr(x,2)===ne?(a=ne,x+=2):(a=g,0===ca&&d(xe)),a===g&&(n.substr(x,2)===ae?(a=ae,x+=2):
(a=g,0===ca&&d(ye)),a===g&&(n.substr(x,2)===oe?(a=oe,x+=2):(a=g,0===ca&&d(pe)),a===g&&(n.substr(x,2)===He?(a=He,x+=2):(a=g,0===ca&&d(Ie)),a===g&&(n.substr(x,2)===ze?(a=ze,x+=2):(a=g,0===ca&&d(Uc)),a===g&&(n.substr(x,2)===nd?(a=nd,x+=2):(a=g,0===ca&&d(Oc)),a===g&&(n.substr(x,2)===Dd?(a=Dd,x+=2):(a=g,0===ca&&d(tc)),a===g&&(n.substr(x,2)===Jb?(a=Jb,x+=2):(a=g,0===ca&&d(Gb)),a===g&&(n.substr(x,3)===Bd?(a=Bd,x+=3):(a=g,0===ca&&d(Qd)),a===g&&(n.substr(x,3)===Cd?(a=Cd,x+=3):(a=g,0===ca&&d(be)),a===g&&(n.substr(x,
2)===Pc?(a=Pc,x+=2):(a=g,0===ca&&d(ub)),a===g&&(n.substr(x,2)===Ob?(a=Ob,x+=2):(a=g,0===ca&&d(Zc)),a===g&&(n.substr(x,2)===Id?(a=Id,x+=2):(a=g,0===ca&&d(Ed)),a===g&&(n.substr(x,2)===dd?(a=dd,x+=2):(a=g,0===ca&&d(Yd)),a===g&&(n.substr(x,2)===wc?(a=wc,x+=2):(a=g,0===ca&&d(Qc)),a===g&&(n.substr(x,2)===ac?(a=ac,x+=2):(a=g,0===ca&&d(Yb)),a===g&&(n.substr(x,2)===vb?(a=vb,x+=2):(a=g,0===ca&&d(Rb)),a===g&&(n.substr(x,2)===rc?(a=rc,x+=2):(a=g,0===ca&&d(jc)),a===g&&(123===n.charCodeAt(x)?(a=Rd,x++):(a=g,0===
ca&&d(od)),a===g&&(125===n.charCodeAt(x)?(a=Sd,x++):(a=g,0===ca&&d(Oe)),a===g&&(91===n.charCodeAt(x)?(a=qe,x++):(a=g,0===ca&&d(Pe)),a===g&&(93===n.charCodeAt(x)?(a=Je,x++):(a=g,0===ca&&d(ce)),a===g&&(40===n.charCodeAt(x)?(a=Zb,x++):(a=g,0===ca&&d(qc)),a===g&&(41===n.charCodeAt(x)?(a=Ib,x++):(a=g,0===ca&&d(Ec)),a===g&&(59===n.charCodeAt(x)?(a=Ke,x++):(a=g,0===ca&&d(Ae)),a===g&&(58===n.charCodeAt(x)?(a=lc,x++):(a=g,0===ca&&d(Kc)),a===g&&(63===n.charCodeAt(x)?(a=Vc,x++):(a=g,0===ca&&d(gd)),a===g&&(46===
n.charCodeAt(x)?(a=ec,x++):(a=g,0===ca&&d(ed)),a===g&&(43===n.charCodeAt(x)?(a=sc,x++):(a=g,0===ca&&d(cd)),a===g&&(45===n.charCodeAt(x)?(a=fd,x++):(a=g,0===ca&&d(Dc)),a===g&&(42===n.charCodeAt(x)?(a=Wd,x++):(a=g,0===ca&&d(rd)),a===g&&(47===n.charCodeAt(x)?(a=he,x++):(a=g,0===ca&&d(sd)),a===g&&(37===n.charCodeAt(x)?(a=Xd,x++):(a=g,0===ca&&d(ue)),a===g&&(94===n.charCodeAt(x)?(a=hc,x++):(a=g,0===ca&&d(Fc)),a===g&&(38===n.charCodeAt(x)?(a=kb,x++):(a=g,0===ca&&d(Xb)),a===g&&(124===n.charCodeAt(x)?(a=Kb,
x++):(a=g,0===ca&&d($b)),a===g&&(126===n.charCodeAt(x)?(a=ge,x++):(a=g,0===ca&&d(te)),a===g&&(33===n.charCodeAt(x)?(a=qd,x++):(a=g,0===ca&&d(Hd)),a===g&&(61===n.charCodeAt(x)?(a=ab,x++):(a=g,0===ca&&d(Lc)),a===g&&(60===n.charCodeAt(x)?(a=Fd,x++):(a=g,0===ca&&d(Jd)),a===g&&(62===n.charCodeAt(x)?(a=Yc,x++):(a=g,0===ca&&d(td)),a===g&&(44===n.charCodeAt(x)?(a=zb,x++):(a=g,0===ca&&d(Sb))))))))))))))))))))))))))))))))))))))))))))),ca--,a===g&&0===ca&&d(we))}}return a}function ra(){var a,b,c,e;ca++;a=x;
b=za();if(b!==g){c=[];for(e=P();e!==g;)c.push(e),e=P();c!==g?a=b+=c.join(""):(x=a,a=g)}else x=a,a=g;ca--;a===g&&0===ca&&d(bd);return a}function za(){var a;lb.test(n.charAt(x))?(a=n.charAt(x),x++):(a=g,0===ca&&d(Cc));a===g&&(36===n.charCodeAt(x)?(a=ic,x++):(a=g,0===ca&&d(Lb)),a===g&&(95===n.charCodeAt(x)?(a=hb,x++):(a=g,0===ca&&d(hd))));return a}function P(){var a;a=za();a===g&&(a=ja());return a}function oa(){var a,b,c,e;a=x;48===n.charCodeAt(x)?(b=yd,x++):(b=g,0===ca&&d(Qb));if(b!==g)if(zd.test(n.charAt(x))?
(b=n.charAt(x),x++):(b=g,0===ca&&d(id)),b!==g){b=x;c=[];e=Ga();if(e!==g)for(;e!==g;)c.push(e),e=Ga();else c=g;b=c!==g?n.substring(b,x):c;b!==g?a=b=String(parseInt("0x"+b)):(x=a,a=g)}else x=a,a=g;else x=a,a=g;return a}function Q(){var a,b,c;48===n.charCodeAt(x)?(a=yd,x++):(a=g,0===ca&&d(Qb));a===g&&(a=x,xc.test(n.charAt(x))?(b=n.charAt(x),x++):(b=g,0===ca&&d(Md)),b!==g?(c=da(),c===g&&(c=null),c!==g?a=b=[b,c]:(x=a,a=g)):(x=a,a=g));return a}function da(){var a,b;a=[];b=ja();if(b!==g)for(;b!==g;)a.push(b),
b=ja();else a=g;return a}function ja(){var a;ad.test(n.charAt(x))?(a=n.charAt(x),x++):(a=g,0===ca&&d(Nc));return a}function va(){var a,b,c;a=x;Sc.test(n.charAt(x))?(b=n.charAt(x),x++):(b=g,0===ca&&d(Gc));if(b!==g){var e,f;c=x;ie.test(n.charAt(x))?(e=n.charAt(x),x++):(e=g,0===ca&&d(je));e===g&&(e=null);e!==g?(f=da(),f!==g?c=e=[e,f]:(x=c,c=g)):(x=c,c=g);c!==g?a=b=[b,c]:(x=a,a=g)}else x=a,a=g;return a}function Ga(){var a;Nd.test(n.charAt(x))?(a=n.charAt(x),x++):(a=g,0===ca&&d(jd));return a}function ba(){var a,
b,c;b=a=x;ca++;34===n.charCodeAt(x)?(c=bc,x++):(c=g,0===ca&&d(Pb));c===g&&(92===n.charCodeAt(x)?(c=Tc,x++):(c=g,0===ca&&d(md)),c===g&&(c=xa()));ca--;c===g?b=void 0:(x=b,b=g);b!==g?(c=na(),c!==g?a=c:(x=a,a=g)):(x=a,a=g);a===g&&(a=x,92===n.charCodeAt(x)?(b=Tc,x++):(b=g,0===ca&&d(md)),b!==g?(c=X(),c!==g?a=c:(x=a,a=g)):(x=a,a=g),a===g&&(a=ta()));return a}function Ea(){var a,b,c;b=a=x;ca++;39===n.charCodeAt(x)?(c=kd,x++):(c=g,0===ca&&d(Ad));c===g&&(92===n.charCodeAt(x)?(c=Tc,x++):(c=g,0===ca&&d(md)),c===
g&&(c=xa()));ca--;c===g?b=void 0:(x=b,b=g);b!==g?(c=na(),c!==g?a=c:(x=a,a=g)):(x=a,a=g);a===g&&(a=x,92===n.charCodeAt(x)?(b=Tc,x++):(b=g,0===ca&&d(md)),b!==g?(c=X(),c!==g?a=c:(x=a,a=g)):(x=a,a=g),a===g&&(a=ta()));return a}function ta(){var a,b;a=x;92===n.charCodeAt(x)?(b=Tc,x++):(b=g,0===ca&&d(md));b!==g?(b=ya(),b!==g?a=b:(x=a,a=g)):(x=a,a=g);return a}function X(){var a,b,c;a=pa();a===g&&(b=a=x,ca++,c=pa(),c===g&&(c=ja(),c===g&&(120===n.charCodeAt(x)?(c=Pd,x++):(c=g,0===ca&&d(Ge)),c===g&&(117===n.charCodeAt(x)?
(c=ve,x++):(c=g,0===ca&&d(ke))))),ca--,c===g?b=void 0:(x=b,b=g),b===g&&(b=xa()),b!==g?(b=na(),b!==g?a=b:(x=a,a=g)):(x=a,a=g));if(a===g&&(a=x,48===n.charCodeAt(x)?(b=yd,x++):(b=g,0===ca&&d(Qb)),b!==g?(b=x,ca++,c=ja(),ca--,c===g?b=void 0:(x=b,b=g),b!==g?a="\x00":(x=a,a=g)):(x=a,a=g),a===g)){var e,f;a=x;120===n.charCodeAt(x)?(b=Pd,x++):(b=g,0===ca&&d(Ge));b!==g?(c=b=x,e=Ga(),e!==g?(f=Ga(),f!==g?c=e=[e,f]:(x=c,c=g)):(x=c,c=g),b=c!==g?n.substring(b,x):c,b!==g?a=b=String.fromCharCode(parseInt("0x"+b)):
(x=a,a=g)):(x=a,a=g)}return a}function pa(){var a;Hc.test(n.charAt(x))?(a=n.charAt(x),x++):(a=g,0===ca&&d(ld));a!==g&&(a=a.replace("b","\b").replace("f","\f").replace("n","\n").replace("r","\r").replace("t","\t").replace("v","\x0B"));return a}function ka(){var a,b;a=[];b=Aa();b===g&&(b=ta(),b===g&&(b=wa(),b===g&&(b=qa())));for(;b!==g;)a.push(b),b=Aa(),b===g&&(b=ta(),b===g&&(b=wa(),b===g&&(b=qa())));return a}function Ca(){var a,b;a=[];b=Aa();b===g&&(b=ta(),b===g&&(b=wa(),b===g&&(b=qa())));if(b!==g)for(;b!==
g;)a.push(b),b=Aa(),b===g&&(b=ta(),b===g&&(b=wa(),b===g&&(b=qa())));else a=g;return a}function Ma(){var a,b;a=[];b=Aa();b===g&&(b=ta(),b===g&&(b=ga(),b===g&&(b=O())));for(;b!==g;)a.push(b),b=Aa(),b===g&&(b=ta(),b===g&&(b=ga(),b===g&&(b=O())));return a}function Aa(){var a;ca++;Le.test(n.charAt(x))?(a=n.charAt(x),x++):(a=g,0===ca&&d(Me));ca--;a===g&&0===ca&&d(Qe);return a}function xa(){var a;Be.test(n.charAt(x))?(a=n.charAt(x),x++):(a=g,0===ca&&d(Ne));return a}function ga(){var a;ca++;10===n.charCodeAt(x)?
(a=uc,x++):(a=g,0===ca&&d(Ve));a===g&&(n.substr(x,2)===Te?(a=Te,x+=2):(a=g,0===ca&&d(We)),a===g&&(13===n.charCodeAt(x)?(a=Xe,x++):(a=g,0===ca&&d(Ye))));ca--;a===g&&0===ca&&d(Ue);return a}function ya(){var a;a=ga();if(a===g){var b;a=x;ca++;n.length>x?(b=n.charAt(x),x++):(b=g,0===ca&&d(ee));ca--;b===g?a=void 0:(x=a,a=g)}return a}function O(){var a;ca++;var b,c,e,f,h;a=x;n.substr(x,2)===de?(b=de,x+=2):(b=g,0===ca&&d(Ce));if(b!==g){c=[];f=e=x;ca++;n.substr(x,2)===Ic?(h=Ic,x+=2):(h=g,0===ca&&d(pd));ca--;
h===g?f=void 0:(x=f,f=g);f!==g?(h=na(),h!==g?e=f=[f,h]:(x=e,e=g)):(x=e,e=g);for(;e!==g;)c.push(e),f=e=x,ca++,n.substr(x,2)===Ic?(h=Ic,x+=2):(h=g,0===ca&&d(pd)),ca--,h===g?f=void 0:(x=f,f=g),f!==g?(h=na(),h!==g?e=f=[f,h]:(x=e,e=g)):(x=e,e=g);c!==g?(n.substr(x,2)===Ic?(e=Ic,x+=2):(e=g,0===ca&&d(pd)),e!==g?a=b=[b,c,e]:(x=a,a=g)):(x=a,a=g)}else x=a,a=g;a===g&&(a=qa());ca--;a===g&&0===ca&&d(Td);return a}function wa(){var a,b,c,e,f,h;a=x;n.substr(x,2)===de?(b=de,x+=2):(b=g,0===ca&&d(Ce));if(b!==g){c=[];
f=e=x;ca++;n.substr(x,2)===Ic?(h=Ic,x+=2):(h=g,0===ca&&d(pd));h===g&&(h=xa());ca--;h===g?f=void 0:(x=f,f=g);f!==g?(h=na(),h!==g?e=f=[f,h]:(x=e,e=g)):(x=e,e=g);for(;e!==g;)c.push(e),f=e=x,ca++,n.substr(x,2)===Ic?(h=Ic,x+=2):(h=g,0===ca&&d(pd)),h===g&&(h=xa()),ca--,h===g?f=void 0:(x=f,f=g),f!==g?(h=na(),h!==g?e=f=[f,h]:(x=e,e=g)):(x=e,e=g);c!==g?(n.substr(x,2)===Ic?(e=Ic,x+=2):(e=g,0===ca&&d(pd)),e!==g?a=b=[b,c,e]:(x=a,a=g)):(x=a,a=g)}else x=a,a=g;return a}function qa(){var a,b,c,e,f,h;a=x;n.substr(x,
2)===re?(b=re,x+=2):(b=g,0===ca&&d(De));if(b!==g){c=[];f=e=x;ca++;h=xa();ca--;h===g?f=void 0:(x=f,f=g);f!==g?(h=na(),h!==g?e=f=[f,h]:(x=e,e=g)):(x=e,e=g);for(;e!==g;)c.push(e),f=e=x,ca++,h=xa(),ca--,h===g?f=void 0:(x=f,f=g),f!==g?(h=na(),h!==g?e=f=[f,h]:(x=e,e=g)):(x=e,e=g);c!==g?a=b=[b,c]:(x=a,a=g)}else x=a,a=g;return a}function na(){var a;n.length>x?(a=n.charAt(x),x++):(a=g,0===ca&&d(ee));return a}var Ja=1<arguments.length?arguments[1]:{},g={},Da={start:k},Ba=k,Ta=function(a,b){for(var c=[a],d=
0;d<b.length;d++)c.push(b[d][1]);return c},ma="#",Ka={type:"literal",value:"#",description:'"#"'},fb="if",La={type:"literal",value:"if",description:'"if"'},Xa="ifdef",Wa={type:"literal",value:"ifdef",description:'"ifdef"'},W="ifndef",Ia={type:"literal",value:"ifndef",description:'"ifndef"'},Ua="elif",Na={type:"literal",value:"elif",description:'"elif"'},Va="else",Z={type:"literal",value:"else",description:'"else"'},Oa="endif",Qa={type:"literal",value:"endif",description:'"endif"'},$a="include",rb=
{type:"literal",value:"include",description:'"include"'},ob="define",gb={type:"literal",value:"define",description:'"define"'},Ya="var",sb={type:"literal",value:"var",description:'"var"'},Mb="error",Fb={type:"literal",value:"error",description:'"error"'},mb="line",Sa={type:"literal",value:"line",description:'"line"'},ib="pragma",yb={type:"literal",value:"pragma",description:'"pragma"'},ua="undef",Ra={type:"literal",value:"undef",description:'"undef"'},N="warning",la={type:"literal",value:"warning",
description:'"warning"'},Db="extension",Pa={type:"literal",value:"extension",description:'"extension"'},zc="version",gc={type:"literal",value:"version",description:'"version"'},Ac="node",Vb={type:"literal",value:"node",description:'"node"'},wb="endnode",qb={type:"literal",value:"endnode",description:'"endnode"'},Za="node_var",Eb={type:"literal",value:"node_var",description:'"node_var"'},Bb="node_if",Wb={type:"literal",value:"node_if",description:'"node_if"'},Ha="node_ifdef",pb={type:"literal",value:"node_ifdef",
description:'"node_ifdef"'},Fa="node_ifndef",aa={type:"literal",value:"node_ifndef",description:'"node_ifndef"'},bb="node_elif",Wc={type:"literal",value:"node_elif",description:'"node_elif"'},db="node_else",jb={type:"literal",value:"node_else",description:'"node_else"'},Ub="node_endif",dc={type:"literal",value:"node_endif",description:'"node_endif"'},nc="node_in",eb={type:"literal",value:"node_in",description:'"node_in"'},fc="optional",Bc={type:"literal",value:"optional",description:'"optional"'},
Xc="node_out",cb={type:"literal",value:"node_out",description:'"node_out"'},tb="node_param",nb={type:"literal",value:"node_param",description:'"node_param"'},xb="nodes_global",vc={type:"literal",value:"nodes_global",description:'"nodes_global"'},mc="nodes_main",kc={type:"literal",value:"nodes_main",description:'"nodes_main"'},zb=",",Sb={type:"literal",value:",",description:'","'},Vc="?",gd={type:"literal",value:"?",description:'"?"'},lc=":",Kc={type:"literal",value:":",description:'":"'},Cb="defined",
Tb={type:"literal",value:"defined",description:'"defined"'},Zb="(",qc={type:"literal",value:"(",description:'"("'},Ib=")",Ec={type:"literal",value:")",description:'")"'},Nb={type:"other",description:"number"},bd={type:"other",description:"identifier"},vb="++",Rb={type:"literal",value:"++",description:'"++"'},rc="--",jc={type:"literal",value:"--",description:'"--"'},sc="+",cd={type:"literal",value:"+",description:'"+"'},fd="-",Dc={type:"literal",value:"-",description:'"-"'},ge="~",te={type:"literal",
value:"~",description:'"~"'},qd="!",Hd={type:"literal",value:"!",description:'"!"'},Wd="*",rd={type:"literal",value:"*",description:'"*"'},he="/",sd={type:"literal",value:"/",description:'"/"'},Xd="%",ue={type:"literal",value:"%",description:'"%"'},ab="=",Lc={type:"literal",value:"=",description:'"="'},Dd="<<",tc={type:"literal",value:"<<",description:'"<<"'},Jb=">>",Gb={type:"literal",value:">>",description:'">>"'},Id="<=",Ed={type:"literal",value:"<=",description:'"<="'},dd=">=",Yd={type:"literal",
value:">=",description:'">="'},Fd="<",Jd={type:"literal",value:"<",description:'"<"'},Yc=">",td={type:"literal",value:">",description:'">"'},Pc="==",ub={type:"literal",value:"==",description:'"=="'},Ob="!=",Zc={type:"literal",value:"!=",description:'"!="'},kb="&",Xb={type:"literal",value:"&",description:'"&"'},hc="^",Fc={type:"literal",value:"^",description:'"^"'},Kb="|",$b={type:"literal",value:"|",description:'"|"'},wc="&&",Qc={type:"literal",value:"&&",description:'"&&"'},ac="||",Yb={type:"literal",
value:"||",description:'"||"'},bc='"',Pb={type:"literal",value:'"',description:'"\\""'},Rc=function(a){for(var b="",c=0;c<a.length;c++)b+=a[c][1];return b},ic="$",Lb={type:"literal",value:"$",description:'"$"'},hb="_",hd={type:"literal",value:"_",description:'"_"'},lb=/^[a-zA-Z]/,Cc={type:"class",value:"[a-zA-Z]",description:"[a-zA-Z]"},oc={type:"literal",value:"#define",description:'"#define"'},Kd={type:"literal",value:"#elif",description:'"#elif"'},Ab={type:"literal",value:"#else",description:'"#else"'},
ud={type:"literal",value:"#endif",description:'"#endif"'},Ld={type:"literal",value:"#error",description:'"#error"'},vd={type:"literal",value:"#if",description:'"#if"'},Gd={type:"literal",value:"#ifdef",description:'"#ifdef"'},pc={type:"literal",value:"#ifndef",description:'"#ifndef"'},$c={type:"literal",value:"#include",description:'"#include"'},wd={type:"literal",value:"#line",description:'"#line"'},xd={type:"literal",value:"#pragma",description:'"#pragma"'},Hb={type:"literal",value:"#warning",description:'"#warning"'},
Mc={type:"literal",value:"#version",description:'"#version"'},ec=".",ed={type:"literal",value:".",description:'"."'},yd="0",Qb={type:"literal",value:"0",description:'"0"'},zd=/^[xX]/,id={type:"class",value:"[xX]",description:"[xX]"},ad=/^[0-9]/,Nc={type:"class",value:"[0-9]",description:"[0-9]"},xc=/^[1-9]/,Md={type:"class",value:"[1-9]",description:"[1-9]"},Sc=/^[eE]/,Gc={type:"class",value:"[eE]",description:"[eE]"},ie=/^[\-+]/,je={type:"class",value:"[-+]",description:"[-+]"},Nd=/^[0-9a-fA-F]/,
jd={type:"class",value:"[0-9a-fA-F]",description:"[0-9a-fA-F]"},Od={type:"other",description:"string"},kd="'",Ad={type:"literal",value:"'",description:'"\'"'},Tc="\\",md={type:"literal",value:"\\",description:'"\\\\"'},Hc=/^['"\\bfnrtv]/,ld={type:"class",value:"['\"\\\\bfnrtv]",description:"['\"\\\\bfnrtv]"},Pd="x",Ge={type:"literal",value:"x",description:'"x"'},ve="u",ke={type:"literal",value:"u",description:'"u"'},we={type:"other",description:"punctuation"},le="+=",Zd={type:"literal",value:"+=",
description:'"+="'},me="-=",$d={type:"literal",value:"-=",description:'"-="'},ne="*=",xe={type:"literal",value:"*=",description:'"*="'},ae="/=",ye={type:"literal",value:"/=",description:'"/="'},oe="%=",pe={type:"literal",value:"%=",description:'"%="'},He="^=",Ie={type:"literal",value:"^=",description:'"^="'},ze="&=",Uc={type:"literal",value:"&=",description:'"&="'},nd="|=",Oc={type:"literal",value:"|=",description:'"|="'},Bd="<<=",Qd={type:"literal",value:"<<=",description:'"<<="'},Cd=">>=",be={type:"literal",
value:">>=",description:'">>="'},Rd="{",od={type:"literal",value:"{",description:'"{"'},Sd="}",Oe={type:"literal",value:"}",description:'"}"'},qe="[",Pe={type:"literal",value:"[",description:'"["'},Je="]",ce={type:"literal",value:"]",description:'"]"'},Ke=";",Ae={type:"literal",value:";",description:'";"'},Qe={type:"other",description:"whitespace"},Le=/^[\t\x0B\f ]/,Me={type:"class",value:"[\\t\\v\\f ]",description:"[\\t\\v\\f ]"},Be=/^[\n\r]/,Ne={type:"class",value:"[\\n\\r]",description:"[\\n\\r]"},
Ue={type:"other",description:"end of line"},uc="\n",Ve={type:"literal",value:"\n",description:'"\\n"'},Te="\r\n",We={type:"literal",value:"\r\n",description:'"\\r\\n"'},Xe="\r",Ye={type:"literal",value:"\r",description:'"\\r"'},Td={type:"other",description:"comment"},de="/*",Ce={type:"literal",value:"/*",description:'"/*"'},Ic="*/",pd={type:"literal",value:"*/",description:'"*/"'},re="//",De={type:"literal",value:"//",description:'"//"'},ee={type:"any",description:"any character"},x=0,Ud=0,Jc={line:1,
column:1,seenCR:!1},Vd=0,Ee=[],ca=0,fe;if("startRule"in Ja){if(!(Ja.startRule in Da))throw Error("Can't start parsing from rule \""+Ja.startRule+'".');Ba=Da[Ja.startRule]}var yc=function(){var a,b;ca++;b=a=x;ca++;var c,e,f,h;c=x;n.substr(x,7)===Cb?(e=Cb,x+=7):(e=g,0===ca&&d(Tb));e!==g?(f=x,ca++,h=P(),ca--,h===g?f=void 0:(x=f,f=g),f!==g?c=e=[e,f]:(x=c,c=g)):(x=c,c=g);ca--;c===g?b=void 0:(x=b,b=g);b!==g?(b=ra(),b!==g?a=b:(x=a,a=g)):(x=a,a=g);ca--;a===g&&0===ca&&d(bd);return a},yc=function(){var a,b;
ca++;b=a=x;ca++;var c,e,f,h;c=x;"#define"===n.substr(x,7)?(e="#define",x+=7):(e=g,0===ca&&d(oc));e===g&&("#elif"===n.substr(x,5)?(e="#elif",x+=5):(e=g,0===ca&&d(Kd)),e===g&&("#else"===n.substr(x,5)?(e="#else",x+=5):(e=g,0===ca&&d(Ab)),e===g&&("#endif"===n.substr(x,6)?(e="#endif",x+=6):(e=g,0===ca&&d(ud)),e===g&&("#error"===n.substr(x,6)?(e="#error",x+=6):(e=g,0===ca&&d(Ld)),e===g&&("#if"===n.substr(x,3)?(e="#if",x+=3):(e=g,0===ca&&d(vd)),e===g&&("#ifdef"===n.substr(x,6)?(e="#ifdef",x+=6):(e=g,0===
ca&&d(Gd)),e===g&&("#ifndef"===n.substr(x,7)?(e="#ifndef",x+=7):(e=g,0===ca&&d(pc)),e===g&&("#include"===n.substr(x,8)?(e="#include",x+=8):(e=g,0===ca&&d($c)),e===g&&("#line"===n.substr(x,5)?(e="#line",x+=5):(e=g,0===ca&&d(wd)),e===g&&("#pragma"===n.substr(x,7)?(e="#pragma",x+=7):(e=g,0===ca&&d(xd)),e===g&&("#warning"===n.substr(x,8)?(e="#warning",x+=8):(e=g,0===ca&&d(Hb)),e===g&&("#version"===n.substr(x,8)?(e="#version",x+=8):(e=g,0===ca&&d(Mc)),e===g&&(n.substr(x,3)===Ya?(e=Ya,x+=3):(e=g,0===ca&&
d(sb)))))))))))))));e!==g?(f=x,ca++,h=P(),ca--,h===g?f=void 0:(x=f,f=g),f!==g?c=e=[e,f]:(x=c,c=g)):(x=c,c=g);ca--;c===g?b=void 0:(x=b,b=g);b!==g?(b=ra(),b!==g?a=b:(x=a,a=g)):(x=a,a=g);ca--;a===g&&0===ca&&d(bd);return a};fe=Ba();if(fe!==g&&x===n.length)return fe;fe!==g&&x<n.length&&d({type:"end",description:"end of input"});throw function(a,b,c){function d(a){var b=1;for(a.sort(function(a,b){return a.description<b.description?-1:a.description>b.description?1:0});b<a.length;)a[b-1]===a[b]?a.splice(b,
1):b++}function f(a,b){function c(a){function b(a){return a.charCodeAt(0).toString(16).toUpperCase()}return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(a){return"\\x0"+b(a)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(a){return"\\x"+b(a)}).replace(/[\u0100-\u0FFF]/g,function(a){return"\\u0"+b(a)}).replace(/[\u1000-\uFFFF]/g,function(a){return"\\u"+b(a)})}
var d=Array(a.length),e;for(e=0;e<a.length;e++)d[e]=a[e].description;d=1<a.length?d.slice(0,-1).join(", ")+" or "+d[a.length-1]:d[0];e=b?'"'+c(b)+'"':"end of input";return"Expected "+d+" but "+e+" found."}var h=t(c),g=c<n.length?n.charAt(c):null;null!==b&&d(b);return new e(null!==a?a:f(b,g),b,g,c,h.line,h.column)}(null,Ee,Vd);}}}()},function(C,t,e){function R(e,k){var r=e[0],p=e[1],u=e[2],a=e[3],r=n(r,p,u,a,k[0],7,-680876936),a=n(a,r,p,u,k[1],12,-389564586),u=n(u,a,r,p,k[2],17,606105819),p=n(p,u,
a,r,k[3],22,-1044525330),r=n(r,p,u,a,k[4],7,-176418897),a=n(a,r,p,u,k[5],12,1200080426),u=n(u,a,r,p,k[6],17,-1473231341),p=n(p,u,a,r,k[7],22,-45705983),r=n(r,p,u,a,k[8],7,1770035416),a=n(a,r,p,u,k[9],12,-1958414417),u=n(u,a,r,p,k[10],17,-42063),p=n(p,u,a,r,k[11],22,-1990404162),r=n(r,p,u,a,k[12],7,1804603682),a=n(a,r,p,u,k[13],12,-40341101),u=n(u,a,r,p,k[14],17,-1502002290),p=n(p,u,a,r,k[15],22,1236535329),r=y(r,p,u,a,k[1],5,-165796510),a=y(a,r,p,u,k[6],9,-1069501632),u=y(u,a,r,p,k[11],14,643717713),
p=y(p,u,a,r,k[0],20,-373897302),r=y(r,p,u,a,k[5],5,-701558691),a=y(a,r,p,u,k[10],9,38016083),u=y(u,a,r,p,k[15],14,-660478335),p=y(p,u,a,r,k[4],20,-405537848),r=y(r,p,u,a,k[9],5,568446438),a=y(a,r,p,u,k[14],9,-1019803690),u=y(u,a,r,p,k[3],14,-187363961),p=y(p,u,a,r,k[8],20,1163531501),r=y(r,p,u,a,k[13],5,-1444681467),a=y(a,r,p,u,k[2],9,-51403784),u=y(u,a,r,p,k[7],14,1735328473),p=y(p,u,a,r,k[12],20,-1926607734),r=V(p^u^a,r,p,k[5],4,-378558),a=V(r^p^u,a,r,k[8],11,-2022574463),u=V(a^r^p,u,a,k[11],16,
1839030562),p=V(u^a^r,p,u,k[14],23,-35309556),r=V(p^u^a,r,p,k[1],4,-1530992060),a=V(r^p^u,a,r,k[4],11,1272893353),u=V(a^r^p,u,a,k[7],16,-155497632),p=V(u^a^r,p,u,k[10],23,-1094730640),r=V(p^u^a,r,p,k[13],4,681279174),a=V(r^p^u,a,r,k[0],11,-358537222),u=V(a^r^p,u,a,k[3],16,-722521979),p=V(u^a^r,p,u,k[6],23,76029189),r=V(p^u^a,r,p,k[9],4,-640364487),a=V(r^p^u,a,r,k[12],11,-421815835),u=V(a^r^p,u,a,k[15],16,530742520),p=V(u^a^r,p,u,k[2],23,-995338651),r=d(r,p,u,a,k[0],6,-198630844),a=d(a,r,p,u,k[7],
10,1126891415),u=d(u,a,r,p,k[14],15,-1416354905),p=d(p,u,a,r,k[5],21,-57434055),r=d(r,p,u,a,k[12],6,1700485571),a=d(a,r,p,u,k[3],10,-1894986606),u=d(u,a,r,p,k[10],15,-1051523),p=d(p,u,a,r,k[1],21,-2054922799),r=d(r,p,u,a,k[8],6,1873313359),a=d(a,r,p,u,k[15],10,-30611744),u=d(u,a,r,p,k[6],15,-1560198380),p=d(p,u,a,r,k[13],21,1309151649),r=d(r,p,u,a,k[4],6,-145523070),a=d(a,r,p,u,k[11],10,-1120210379),u=d(u,a,r,p,k[2],15,718787259),p=d(p,u,a,r,k[9],21,-343485551);e[0]=r+e[0]&4294967295;e[1]=p+e[1]&
4294967295;e[2]=u+e[2]&4294967295;e[3]=a+e[3]&4294967295}function V(d,e,k,n,u,a){e=(e+d&4294967295)+(n+a&4294967295)&4294967295;return(e<<u|e>>>32-u)+k&4294967295}function n(d,e,k,n,u,a,t){return V(e&k|~e&n,d,e,u,a,t)}function y(d,e,k,n,u,a,t){return V(e&n|k&~n,d,e,u,a,t)}function d(d,e,k,n,u,a,t){return V(k^(e|~n),d,e,u,a,t)}t.a=function(d){var e=d,n=e.length;d=[1732584193,-271733879,-1732584194,271733878];var p;for(p=64;p<=e.length;p+=64){var u,a=e.substring(p-64,p),t=[];for(u=0;64>u;u+=4)t[u>>
2]=a.charCodeAt(u)+(a.charCodeAt(u+1)<<8)+(a.charCodeAt(u+2)<<16)+(a.charCodeAt(u+3)<<24);R(d,t)}e=e.substring(p-64);u=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(p=0;p<e.length;p++)u[p>>2]|=e.charCodeAt(p)<<(p%4<<3);u[p>>2]|=128<<(p%4<<3);if(55<p)for(R(d,u),p=0;16>p;p++)u[p]=0;u[14]=8*n;R(d,u);for(e=0;e<d.length;e++){n=d;p=e;u=d[e];a="";for(t=0;4>t;t++)a+=k[u>>8*t+4&15]+k[u>>8*t&15];n[p]=a}return d.join("")};var k="0123456789abcdef".split("")},function(C,t,e){C=e(0);var R=e(5),V=e(25),n=e(4),y=e(75),d=
e(21),k=e(1),I=e(8),A=e(36),r=e(2),p=e(3),u=e(27),a=e(59),B=e(38);e=Object(C.a)("__reformer",function(e,c){function l(a){switch(a.type){case "VALTORGB":a.color_ramp||(a.color_ramp={elements:[{position:.5,color:[1,1,1,1]}]},f("node Color Ramp",a,"color_ramp"));break;case "CURVE_RGB":a.curve_mapping||(a.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO",
"AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},f("node RGB Curves",a,"curve_mapping"));break;case "CURVE_VEC":a.curve_mapping||(a.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},f("node Vector Curves",a,"curve_mapping"));break;case "MAPPING":a.vector_type||(a.vector_type="POINT",f("node Mapping",a,"vector_type"));break;case "MATERIAL":case "MATERIAL_EXT":"alpha"in
a||(a.alpha=1,f("node material",a,"alpha"));"darkness"in a||(a.darkness=1,f("node material",a,"darkness"));"diffuse_toon_size"in a||(a.diffuse_toon_size=.5,f("node material",a,"diffuse_toon_size"));"diffuse_toon_smooth"in a||(a.diffuse_toon_smooth=.1,f("node material",a,"diffuse_toon_smooth"));"diffuse_intensity"in a||(a.diffuse_intensity=1,f("node material",a,"diffuse_intensity"));"use_tangent_shading"in a||(a.use_tangent_shading=!1,f("node material",a,"use_tangent_shading"));"specular_shader"in
a||(a.specular_shader="COOKTORR",f("node material",a,"specular_shader"));"specular_ior"in a||(a.specular_ior=4,f("node material",a,"specular_ior"));"specular_hardness"in a||(a.specular_hardness=50,f("node material",a,"specular_hardness"));"specular_slope"in a||(a.specular_slope=.1,f("node material",a,"specular_slope"));"specular_toon_size"in a||(a.specular_toon_size=.5,f("node material",a,"specular_toon_size"));"specular_toon_smooth"in a||(a.specular_toon_smooth=.1,f("node material",a,"specular_toon_smooth"));
"specular_intensity"in a||(a.specular_intensity=.5,f("node material",a,"specular_intensity"));"diffuse_shader"in a||(a.diffuse_shader="LAMBERT",f("node material",a,"diffuse_shader"));"roughness"in a||(a.roughness=.5,f("node material",a,"roughness"));"diffuse_fresnel"in a||(a.diffuse_fresnel=.1,f("node material",a,"diffuse_fresnel"));"diffuse_fresnel_factor"in a||(a.diffuse_fresnel_factor=.5,f("node material",a,"diffuse_fresnel_factor"));break;case "MATH":case "MIX_RGB":"use_clamp"in a||(a.use_clamp=
!1,f("node "+a.type,a,"use_clamp"));break;case "GROUP":a.node_tree_name=a.node_tree_name.replace(/\.[0-9]{3,}$/g,"");switch(a.node_tree_name){case "CLAMP":case "LEVELS_OF_QUALITY":case "LINEAR_TO_SRGB":case "NORMAL_VIEW":case "PARALLAX":case "REFLECT":case "REFRACTION":case "REPLACE":case "SMOOTHSTEP":case "SRGB_TO_LINEAR":case "TIME":case "TRANSLUCENCY":case "VECTOR_VIEW":a.node_tree_name="B4W_"+a.node_tree_name}break;case "VECT_TRANSFORM":"convert_from"in a||(a.convert_from="WORLD",f("node "+a.type,
a,"convert_from"));"convert_to"in a||(a.convert_to="WORLD",f("node "+a.type,a,"convert_to"));"vector_type"in a||(a.vector_type="POINT",f("node "+a.type,a,"vector_type"));break;case "ATTRIBUTE":a.color_layer="";break;case "BSDF_TRANSPARENT":"b4w_use_alpha"in a||(a.b4w_use_alpha=!1,f("node "+a.type,a,"b4w_use_alpha"))}}function b(a){if(a=a.nla_tracks)for(var b=0;b<a.length;b++)for(var c=a[b],d=0;d<c.strips.length;d++){var e=c.strips[d];"action"in e||(e.action=null,f("strip",e,"action"));"action_frame_start"in
e||(e.action_frame_start=0,f("strip",e,"action_frame_start"));"action_frame_end"in e||(e.action_frame_end=e.frame_end-e.frame_start,f("strip",e,"action_frame_end"));"repeat"in e||(e.repeat=1,f("strip",e,"repeat"));"use_reverse"in e||(e.use_reverse=!1,f("strip",e,"use_reverse"));"scale"in e||(e.scale=1,f("strip",e,"scale"))}}function f(a,b,c){c=c+">>"+a;c in v||(v[c]={storage:[],report_type:"undefined",type:a});v[c].storage.push(b.name)}function t(a,b,c){c=c+">>"+a;c in v||(v[c]={storage:[],report_type:"deprecated",
type:a});v[c].storage.push(b.name)}function C(a){F.warn(a)}function z(a,b){b||(b=a.name+"_COPY");var c=a.materials,d=a.submeshes;a.materials=null;a.submeshes=null;var e=r.O(a);a.materials=c;a.submeshes=d;e.name=b;e.materials=a.materials.slice(0);e.submeshes=[];for(c=0;c<d.length;c++){var f=r.N(d[c]);e.submeshes.push(f)}return e}function G(a,b,c){if(1<c){for(var d=a.length/c,e=b.length/c,f=new Float32Array(a.length+b.length),h=0,k=0;k<c;k++)f.set(a.subarray(d*k,d*(k+1)),h),h+=d,f.set(b.subarray(e*
k,e*(k+1)),h),h+=e;return f}return r._2(a,b)}var E=Object(R.a)(e),J=Object(n.a)(e),M=Object(y.a)(e),F=Object(k.a)(e),U=Object(a.a)(e),K=Object(B.a)(e),sa=J.defaults,v={},Y=u.create(),ha=A.c(),S=I.create();c.check_bpy_data=function(a){v={};var c=a.worlds;if(0==c.length){F.warn('WARNING Datablock world is missing, reexport "'+a.b4w_filepath_blend+'" scene');var d={name:"DEFAULT",horizon_color:new Float32Array([0,0,0]),zenith_color:new Float32Array([0,0,0]),light_settings:{use_environment_light:!1,environment_energy:1,
environment_color:"PLAIN"},fog_settings:{use_fog:!1,intensity:0,depth:25,start:5,height:0,falloff:"INVERSE_QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},use_sky_paper:!1,use_sky_blend:!1,use_sky_real:!1,use_nodes:!1,node_tree:null,texture_slots:[]};c.push(d)}for(var e=0;e<c.length;e++){d=c[e];"use_sky_blend"in d||(f("world",d,"use_sky_blend"),d.use_sky_blend=!1);"use_sky_paper"in d||(f("world",d,"use_sky_paper"),d.use_sky_paper=!1);"use_sky_real"in d||(f("world",d,"use_sky_real"),d.use_sky_real=
!1);"b4w_sky_settings"in d&&"rayleigh_brightness"in d.b4w_sky_settings||(f("world",d,"rayleigh_brightness"),d.b4w_sky_settings={render_sky:!1,procedural_skydome:!1,use_as_enviroment_map:!1,color:[.24,.43,.75],rayleigh_brightness:3.3,mie_brightness:.1,spot_brightness:10,scatter_strength:.2,rayleigh_strength:.2,mie_strength:.006,rayleigh_collection_power:.5,mie_collection_power:.5,mie_distribution:.4});"fog_settings"in d||(f("world",d,"fog_settings"),d.fog_settings={use_fog:!1,intensity:0,depth:25,
start:0,height:0,falloff:"QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},"b4w_fog_color"in d&&(d.fog_settings.use_custom_color=!0,d.fog_settings.color=d.b4w_fog_color),"b4w_fog_density"in d&&0<d.b4w_fog_density&&(d.fog_settings.depth=1/d.b4w_fog_density));"render_sky"in d.b4w_sky_settings||(f("world",d,"render_sky"),d.b4w_sky_settings.render_sky=!1);for(var k=d.texture_slots,m=0;m<k.length;m++){var h=k[m];"blend_type"in h||(h.blend_type="MIX",f("world_texture_slot",h,"blend_type"));"use_map_blend"in
h||(h.use_map_blend=!1,f("world_texture_slot",h,"use_map_blend"));"use_map_horizon"in h||(h.use_map_horizon=!0,f("world_texture_slot",h,"use_map_horizon"));"use_map_zenith_up"in h||(h.use_map_zenith_up=!1,f("world_texture_slot",h,"use_map_zenith_up"));"use_rgb_to_intensity"in h||(h.use_rgb_to_intensity=!1,f("world_texture_slot",h,"use_rgb_to_intensity"));"invert"in h||(h.invert=!1,f("world_texture_slot",h,"invert"));"color"in h||(h.color=[1,0,1],f("world_texture_slot",h,"color"));"blend_factor"in
h||(h.blend_factor=0,f("world_texture_slot",h,"blend_factor"));"horizon_factor"in h||(h.horizon_factor=1,f("world_texture_slot",h,"horizon_factor"));"zenith_up_factor"in h||(h.zenith_up_factor=0,f("world_texture_slot",h,"zenith_up_factor"));"zenith_down_factor"in h||(h.zenith_down_factor=0,f("world_texture_slot",h,"zenith_down_factor"));"default_value"in h||(h.default_value=1,f("world_texture_slot",h,"default_value"))}"b4w_use_default_animation"in d||(f("world",d,"b4w_use_default_animation"),d.b4w_use_default_animation=
!1);"b4w_anim_behavior"in d||(f("world",d,"b4w_anim_behavior"),d.b4w_anim_behavior="CYCLIC")}k=a.scenes;for(e=0;e<k.length;e++)h=k[e],m=h.world,"timeline_markers"in h||(h.timeline_markers=null,f("scene",h,"timeline_markers")),"boolean"==typeof h.b4w_enable_physics&&(h.b4w_enable_physics="AUTO"),"b4w_reflection_quality"in h||(h.b4w_reflection_quality="MEDIUM",f("scene",h,"b4w_reflection_quality")),"b4w_use_nla"in h||(h.b4w_use_nla=!1,f("scene",h,"b4w_use_nla")),"fps"in h||(h.fps=24,f("scene",h,"fps")),
"b4w_nla_cyclic"in h||(h.b4w_nla_cyclic=!1,f("scene",h,"b4w_nla_cyclic")),"b4w_logic_nodes"in h||(h.b4w_logic_nodes=[],f("scene",h,"b4w_logic_nodes")),"b4w_detect_collisions"in h&&(t("scene",h,"b4w_detect_collisions"),delete h.b4w_detect_collisions),"audio_doppler_speed"in h||(h.audio_doppler_speed=343.3),"audio_doppler_factor"in h||(h.audio_doppler_factor=1),"b4w_dynamic_compressor_settings"in h||(h.b4w_dynamic_compressor_settings={threshold:-24,knee:30,ratio:12,attack:.003,release:.25},f("scene",
h,"b4w_dynamic_compressor_settings")),"b4w_enable_convolution_engine"in h||(h.b4w_enable_convolution_engine=!1),"b4w_enable_bloom"in h||(h.b4w_enable_bloom=!1,f("scene",h,"b4w_enable_bloom")),"b4w_enable_motion_blur"in h||(h.b4w_enable_motion_blur=!1,f("scene",h,"b4w_enable_motion_blur")),"b4w_enable_color_correction"in h||(h.b4w_enable_color_correction=!1,f("scene",h,"b4w_enable_color_correction")),"b4w_antialiasing_quality"in h||(h.b4w_antialiasing_quality="MEDIUM",f("scene",h,"b4w_antialiasing_quality")),
"b4w_tags"in h||(h.b4w_tags={title:"",description:""},f("scene",h,"b4w_tags")),"b4w_lod_smooth_type"in h||(h.b4w_lod_smooth_type="OFF",f("scene",h,"b4w_lod_smooth_type")),"b4w_lod_hyst_interval"in h||(h.b4w_lod_hyst_interval=0,f("scene",h,"b4w_lod_hyst_interval")),"b4w_enable_object_selection"in h||(h.b4w_enable_object_selection="AUTO",f("scene",h,"b4w_enable_object_selection")),"b4w_enable_outlining"in h||(h.b4w_enable_outlining="AUTO",f("scene",h,"b4w_enable_outlining")),"b4w_enable_glow_materials"in
h||(h.b4w_enable_glow_materials="AUTO",f("scene",h,"b4w_enable_glow_materials")),"b4w_enable_anchors_visibility"in h||(h.b4w_enable_anchors_visibility="AUTO",f("scene",h,"b4w_enable_anchors_visibility")),"b4w_outline_color"in h||(h.b4w_outline_color=[1,1,1],f("scene",h,"b4w_outline_color")),"b4w_outline_factor"in h||(h.b4w_outline_factor="b4w_glow_factor"in h?h.b4w_glow_factor:1,f("scene",h,"b4w_outline_factor")),"b4w_shadow_settings"in h||(f("scene",h,"b4w_shadow_settings"),c=m.b4w_shadow_settings,
h.b4w_shadow_settings=c?c:{csm_resolution:2048,blur_samples:"16x",self_shadow_polygon_offset:1,b4w_enable_csm:!1,csm_num:1,csm_first_cascade_border:10,first_cascade_blur_radius:3,csm_last_cascade_border:100,last_cascade_blur_radius:1.5,fade_last_cascade:!0,blend_between_cascades:!0}),c=h.b4w_shadow_settings,"csm_resolution"in c||(f("scene",h,"b4w_shadow_settings.csm_resolution"),c.csm_resolution=2048),"blur_samples"in c||(f("scene",h,"b4w_shadow_settings.blur_samples"),c.blur_samples="16x"),"soft_shadows"in
c||(f("scene",h,"b4w_shadow_settings.soft_shadows"),c.soft_shadows=!0),"self_shadow_polygon_offset"in c||(f("scene",h,"b4w_shadow_settings.self_shadow_polygon_offset"),c.self_shadow_polygon_offset=1),"self_shadow_normal_offset"in c||(f("scene",h,"b4w_shadow_settings.self_shadow_normal_offset"),c.self_shadow_normal_offset=.01),"b4w_enable_csm"in c||(f("scene",h,"b4w_shadow_settings.b4w_enable_csm"),c.b4w_enable_csm=!1),"csm_num"in c||(f("scene",h,"b4w_shadow_settings.csm_num"),c.csm_num=1),"csm_first_cascade_border"in
c||(f("scene",h,"b4w_shadow_settings.csm_first_cascade_border"),c.csm_first_cascade_border=10),"first_cascade_blur_radius"in c||(f("scene",h,"b4w_shadow_settings.first_cascade_blur_radius"),c.first_cascade_blur_radius=3),"csm_last_cascade_border"in c||(f("scene",h,"b4w_shadow_settings.csm_last_cascade_border"),c.csm_last_cascade_border=100),"last_cascade_blur_radius"in c||(f("scene",h,"b4w_shadow_settings.last_cascade_blur_radius"),c.last_cascade_blur_radius=1.5),"fade_last_cascade"in c||(f("scene",
h,"b4w_shadow_settings.fade_last_cascade"),c.fade_last_cascade=!0),"blend_between_cascades"in c||(f("scene",h,"b4w_shadow_settings.blend_between_cascades"),c.blend_between_cascades=!0),"b4w_ssao_settings"in h||(f("scene",h,"b4w_ssao_settings"),c=m.b4w_ssao_settings,h.b4w_ssao_settings=c?c:{dist_factor:0,samples:16,hemisphere:!1,blur_depth:!1,blur_discard_value:1}),c=h.b4w_ssao_settings,"dist_factor"in c||(f("scene",h,"b4w_ssao_settings.dist_factor"),c.dist_factor=0),"samples"in c||(f("scene",h,"b4w_ssao_settings.samples"),
c.samples=16),"hemisphere"in c||(f("scene",h,"b4w_ssao_settings.hemisphere"),c.hemisphere=!1),"blur_depth"in c||(f("scene",h,"b4w_ssao_settings.blur_depth"),c.blur_depth=!1),"blur_discard_value"in c||(f("scene",h,"b4w_ssao_settings.blur_discard_value"),c.blur_discard_value=1),"b4w_bloom_settings"in h||(f("scene",h,"b4w_bloom_settings"),c=m.b4w_bloom_settings,h.b4w_bloom_settings=c?c:{key:.2,blur:4,edge_lum:1}),"key"in h.b4w_bloom_settings||(f("scene",h,"b4w_bloom_settings.key"),h.b4w_bloom_settings.key=
.2),"blur"in h.b4w_bloom_settings||(f("scene",h,"b4w_bloom_settings.blur"),h.b4w_bloom_settings.blur=4),"edge_lum"in h.b4w_bloom_settings||(f("scene",h,"b4w_bloom_settings.edge_lum"),h.b4w_bloom_settings.edge_lum=1),"adaptive"in h.b4w_bloom_settings||(f("scene",h,"b4w_bloom_settings.adaptive"),h.b4w_bloom_settings.adaptive=!0),"average_luminance"in h.b4w_bloom_settings||(f("scene",h,"b4w_bloom_settings.average_luminance"),h.b4w_bloom_settings.average_luminance=.5),"b4w_motion_blur_settings"in h||
(f("scene",h,"b4w_motion_blur_settings"),c=m.b4w_motion_blur_settings,h.b4w_motion_blur_settings=c?c:{motion_blur_factor:.01,motion_blur_decay_threshold:.01}),"motion_blur_factor"in h.b4w_motion_blur_settings||(f("scene",h,"b4w_motion_blur_settings.motion_blur_factor"),h.b4w_motion_blur_settings.motion_blur_factor=.01),"motion_blur_decay_threshold"in h.b4w_motion_blur_settings||(f("scene",h,"b4w_motion_blur_settings.motion_blur_decay_threshold"),h.b4w_motion_blur_settings.motion_blur_decay_threshold=
.01),"b4w_color_correction_settings"in h||(f("scene",h,"b4w_color_correction_settings"),c=m.b4w_color_correction_settings,h.b4w_color_correction_settings=c?c:{brightness:0,contrast:0,exposure:1,saturation:1}),"b4w_god_rays_settings"in h||(f("scene",h,"b4w_god_rays_settings"),c=m.b4w_god_rays_settings,h.b4w_god_rays_settings=c?c:{intensity:.7,max_ray_length:1,steps_per_pass:10}),"steps_per_pass"in h.b4w_god_rays_settings||(f("scene",h,"b4w_god_rays_settings.steps_per_pass"),h.b4w_god_rays_settings.steps_per_pass=
10),"b4w_glow_settings"in h||(f("scene",h,"b4w_glow_settings"),h.b4w_glow_settings={render_glow_over_blend:!1,small_glow_mask_coeff:2,large_glow_mask_coeff:2,small_glow_mask_width:2,large_glow_mask_width:6},c=h.b4w_glow_settings,"b4w_render_glow_over_blend"in m&&(c.render_glow_over_blend=m.b4w_render_glow_over_blend),"b4w_small_glow_mask_coeff"in m&&(c.small_glow_mask_coeff=m.b4w_small_glow_mask_coeff),"b4w_large_glow_mask_coeff"in m&&(c.large_glow_mask_coeff=m.b4w_large_glow_mask_coeff),"b4w_small_glow_mask_width"in
m&&(c.small_glow_mask_width=m.b4w_small_glow_mask_width),"b4w_large_glow_mask_width"in m&&(c.large_glow_mask_width=m.b4w_large_glow_mask_width)),m=h.b4w_render_shadows,"AUTO"!=m&&"OFF"!=m&&"ON"!=m&&(h.b4w_render_shadows=m?"ON":"OFF"),m=h.b4w_render_reflections,"OFF"!=m&&"ON"!=m&&(h.b4w_render_reflections=m?"ON":"OFF"),m=h.b4w_render_refractions,"AUTO"!=m&&"OFF"!=m&&"ON"!=m&&(h.b4w_render_refractions=m?"ON":"OFF"),"b4w_render_dynamic_grass"in h||(f("scene",h,"b4w_render_dynamic_grass"),h.b4w_render_dynamic_grass=
"AUTO"),h.b4w_nla_script&&t("scene",h,"b4w_nla_script"),"audio_distance_model"in h||(f("scene",h,"audio_distance_model"),h.audio_distance_model="INVERSE_CLAMPED"),"b4w_custom_prop"in h||(f("scene",h,"b4w_custom_prop"),h.b4w_custom_prop=null);k=a.meshes;for(e=0;e<k.length;e++){h=k[e];h.b4w_boundings||(f("mesh",h,"b4w_boundings"),h.b4w_boundings={},c=h.b4w_boundings,c.bb=h.b4w_bounding_box?h.b4w_bounding_box:{max_x:0,max_y:0,max_z:0,min_x:0,min_y:0,min_z:0},c.bb_src=h.b4w_bounding_box_source?h.b4w_bounding_box_source:
h.b4w_bounding_box,c.bs_cen=h.b4w_bounding_sphere_center?h.b4w_bounding_sphere_center:[0,0,0],c.bc_cen=h.b4w_bounding_cylinder_center?h.b4w_bounding_cylinder_center:[0,0,0],c.be_cen=h.b4w_bounding_ellipsoid_center?h.b4w_bounding_ellipsoid_center:[0,0,0],h.b4w_bounding_ellipsoid_axes?c.be_ax=h.b4w_bounding_ellipsoid_axes:(m=c.bb,c.be_ax=[(m.max_x-m.min_x)/2,(m.max_y-m.min_y)/2,(m.max_z-m.min_z)/2]),h.b4w_rotated_bounding_box?c.rbb=h.b4w_rotated_bounding_box:(m=c.bb,c.rbb={rbb_c:[(m.max_x+m.min_x)/
2,(m.max_y+m.min_y)/2,(m.max_z+m.min_z)/2],rbb_s:[1,1,1]}),c.caxis_x=h.b4w_cov_axis_x?h.b4w_cov_axis_x:[1,0,0],c.caxis_y=h.b4w_cov_axis_y?h.b4w_cov_axis_y:[0,1,0],c.caxis_z=h.b4w_cov_axis_z?h.b4w_cov_axis_z:[0,0,1]);"is_boundings_overridden"in h||(f("mesh",h,"is_boundings_overridden"),h.is_boundings_overridden=!1);"b4w_shape_keys"in h||(h.b4w_shape_keys=[],f("mesh",h,"b4w_shape_keys"));c=!0;for(d=0;d<h.submeshes.length;d++){var n=h.submeshes[d];"boundings"in n||(c=!1,n.boundings={be_ax:h.b4w_bounding_ellipsoid_axes,
be_cen:h.b4w_bounding_ellipsoid_center,bb:{max_x:h.b4w_bounding_box.max_x,max_y:h.b4w_bounding_box.max_y,max_z:h.b4w_bounding_box.max_z,min_x:h.b4w_bounding_box.min_x,min_y:h.b4w_bounding_box.min_y,min_z:h.b4w_bounding_box.min_z}});"uv_layers"in n||(f("submesh",h,"uv_layers"),n.uv_layers=h.uv_textures);"be_ax"in n.boundings||(n.boundings.be_ax=h.b4w_bounding_ellipsoid_axes);"be_cen"in n.boundings||(n.boundings.be_cen=h.b4w_bounding_ellipsoid_center);"bb"in n.boundings||(n.boundings.bb=h.b4w_bounding_box);
"rbb"in n.boundings||(m=h.b4w_bounding_box,n.boundings.rbb={rbb_c:[(m.max_x+m.min_x)/2,(m.max_y+m.min_y)/2,(m.max_z+m.min_z)/2],rbb_s:[1,1,1]});"caxis_x"in n.boundings||(n.boundings.caxis_x=[1,0,0]);"caxis_y"in n.boundings||(n.boundings.caxis_y=[0,1,0]);"caxis_z"in n.boundings||(n.boundings.caxis_z=[0,0,1])}c||f("mesh",h,"submesh_bd");m=h;c=["b4w_apply_scale","b4w_apply_modifiers","b4w_export_edited_normals","b4w_loc_export_vertex_anim","b4w_shape_keys"];d=null;for(n=0;n<c.length;n++)m[c[n]]&&(d?
(m[c[n]]=!1,F.warn('WARNING property "'+c[n]+'" of object "'+m.name+'" has been set to "false". Foreground property "'+d+'" already exists.')):d=c[n]);for(m=0;m<h.b4w_vertex_anim.length;m++)c=h.b4w_vertex_anim[m],"allow_nla"in c||(f('mesh["b4w_vertex_anim"]',h,"allow_nla"),c.allow_nla=!0);"active_uv_name"in h||(f("mesh",h,"active_uv_name"),h.active_uv_name="")}k=a.cameras;for(e=0;e<k.length;e++)h=k[e],h.type||(h.type="PERSP",f("camera",h,"type")),"b4w_eye_target_dist"in h&&(delete h.b4w_eye_target_dist,
t("camera",h,"b4w_eye_target_dist")),"b4w_hover_zero_level"in h||(h.b4w_hover_zero_level=0,f("camera",h,"b4w_hover_zero_level")),"b4w_trans_velocity"in h||(h.b4w_trans_velocity=1,f("camera",h,"b4w_trans_velocity")),"b4w_rot_velocity"in h||(h.b4w_rot_velocity=1,f("camera",h,"b4w_rot_velocity")),"b4w_zoom_velocity"in h||(h.b4w_zoom_velocity=.1,f("camera",h,"b4w_zoom_velocity")),"b4w_use_target_distance_limits"in h||(h.b4w_use_target_distance_limits=h.b4w_use_distance_limits||!1,f("camera",h,"b4w_use_target_distance_limits")),
"b4w_use_zooming"in h||(h.b4w_use_zooming=h.b4w_use_distance_limits||!1,f("camera",h,"b4w_use_zooming")),"b4w_distance_min"in h||(h.b4w_distance_min=1,f("camera",h,"b4w_distance_min")),"b4w_distance_max"in h||(h.b4w_distance_max=100,f("camera",h,"b4w_distance_max")),"b4w_horizontal_translation_min"in h||(h.b4w_horizontal_translation_min=-100,f("camera",h,"b4w_horizontal_translation_min")),"b4w_horizontal_translation_max"in h||(h.b4w_horizontal_translation_max=100,f("camera",h,"b4w_horizontal_translation_max")),
"b4w_vertical_translation_min"in h||(h.b4w_vertical_translation_min=-100,f("camera",h,"b4w_vertical_translation_min")),"b4w_vertical_translation_max"in h||(h.b4w_vertical_translation_max=100,f("camera",h,"b4w_vertical_translation_max")),"b4w_use_horizontal_clamping"in h||(h.b4w_use_horizontal_clamping=!1,f("camera",h,"b4w_use_horizontal_clamping")),"b4w_rotation_left_limit"in h||(h.b4w_rotation_left_limit=-Math.PI,f("camera",h,"b4w_rotation_left_limit")),"b4w_rotation_right_limit"in h||(h.b4w_rotation_right_limit=
Math.PI,f("camera",h,"b4w_rotation_right_limit")),"b4w_horizontal_clamping_type"in h||(h.b4w_horizontal_clamping_type="LOCAL",f("camera",h,"b4w_horizontal_clamping_type")),"b4w_use_vertical_clamping"in h||(h.b4w_use_vertical_clamping=!1,f("camera",h,"b4w_use_vertical_clamping")),"b4w_rotation_down_limit"in h||(h.b4w_rotation_down_limit=-Math.PI/2,f("camera",h,"b4w_rotation_down_limit")),"b4w_rotation_up_limit"in h||(h.b4w_rotation_up_limit=Math.PI/2,f("camera",h,"b4w_rotation_up_limit")),"b4w_vertical_clamping_type"in
h||(h.b4w_vertical_clamping_type="LOCAL",f("camera",h,"b4w_vertical_clamping_type")),"b4w_hover_angle_min"in h||(h.b4w_hover_angle_min=Math.PI/6,f("camera",h,"b4w_hover_angle_min")),"b4w_hover_angle_max"in h||(h.b4w_hover_angle_max=Math.PI/6,f("camera",h,"b4w_hover_angle_max")),"b4w_enable_hover_hor_rotation"in h||(h.b4w_enable_hover_hor_rotation=!0,f("camera",h,"b4w_enable_hover_hor_rotation")),"b4w_use_panning"in h||(h.b4w_use_panning=!0,f("camera",h,"b4w_use_panning")),"b4w_use_pivot_limits"in
h||(h.b4w_use_pivot_limits=!1,h.b4w_pivot_z_min=0,h.b4w_pivot_z_max=10,f("camera",h,"b4w_use_pivot_limits")),"b4w_dof_bokeh"in h||(h.b4w_dof_bokeh=!1,f("camera",h,"b4w_dof_bokeh")),"b4w_dof_bokeh_intensity"in h||(h.b4w_dof_bokeh_intensity=.3,f("camera",h,"b4w_dof_bokeh_intensity")),"b4w_dof_foreground_blur"in h||(h.b4w_dof_foreground_blur=!1,f("camera",h,"b4w_dof_foreground_blur")),"b4w_dof_front_start"in h||(h.b4w_dof_front_start=0,f("camera",h,"b4w_dof_front_start")),"b4w_dof_front_end"in h||(h.b4w_dof_front_end=
h.b4w_dof_front,f("camera",h,"b4w_dof_front_end")),"b4w_dof_rear_start"in h||(h.b4w_dof_rear_start=0,f("camera",h,"b4w_dof_rear_start")),"b4w_dof_rear_end"in h||(h.b4w_dof_rear_end=h.b4w_dof_rear,f("camera",h,"b4w_dof_rear_end")),"sensor_fit"in h||(h.sensor_fit="VERTICAL",f("camera",h,"sensor_fit"));k=a.lamps;for(e=0;e<k.length;e++)if(h=k[e],"b4w_generate_shadows"in h||(h.b4w_generate_shadows=!1,f("lamp",h,"b4w_generate_shadows")),"b4w_dynamic_intensity"in h||(h.b4w_dynamic_intensity=!1,f("lamp",
h,"b4w_dynamic_intensity")),"use_diffuse"in h||(h.use_diffuse=!0,f("lamp",h,"use_diffuse")),"use_specular"in h||(h.use_specular=!0,f("lamp",h,"use_specular")),"clip_start"in h||(h.clip_start=.1,f("lamp",h,"clip_start")),"clip_end"in h||(h.clip_end=30,f("lamp",h,"clip_end")),"POINT"==h.type||"SPOT"==h.type)"use_sphere"in h||(h.use_sphere=!1,f("lamp",h,"use_sphere")),sa.mali4_lamps_hack&&(h.type="SUN");k=a.speakers;for(e=0;e<k.length;e++)h=k[e],"b4w_behavior"in h||(h.b4w_behavior=h.b4w_background_music?
"BACKGROUND_SOUND":"POSITIONAL"),"b4w_auto_play"in h||(h.b4w_auto_play=!1,f("speaker",h,"b4w_auto_play")),"b4w_enable_doppler"in h||(h.b4w_enable_doppler=!1,f("speaker",h,"b4w_enable_doppler")),"b4w_delay"in h||(h.b4w_delay=0),"b4w_delay_random"in h||(h.b4w_delay_random=0),"b4w_volume_random"in h||(h.b4w_volume_random=0),"b4w_pitch_random"in h||(h.b4w_pitch_random=0),"b4w_fade_in"in h||(h.b4w_fade_in=0),"b4w_fade_out"in h||(h.b4w_fade_out=0),"b4w_loop"in h||(h.b4w_loop=!1),"b4w_loop_start"in h||(h.b4w_loop_start=
0,f("speaker",h,"b4w_loop_start")),"b4w_loop_end"in h||(h.b4w_loop_end=0,f("speaker",h,"b4w_loop_end")),h.animation_data&&b(h.animation_data);k=a.textures;for(e=0;e<k.length;e++)h=k[e],"b4w_anisotropic_filtering"in h||(h.b4w_anisotropic_filtering="OFF",f("texture",h,"b4w_anisotropic_filtering")),"b4w_water_foam"in h||(h.b4w_water_foam=!1,f("texture",h,"b4w_water_foam")),"b4w_foam_uv_freq"in h||(h.b4w_foam_uv_freq=[1,1],f("texture",h,"b4w_foam_uv_freq")),"b4w_foam_uv_magnitude"in h||(h.b4w_foam_uv_magnitude=
[1,1],f("texture",h,"b4w_foam_uv_magnitude")),"b4w_parallax_steps"in h||(h.b4w_parallax_steps=5,f("material",h,"b4w_parallax_steps")),"b4w_parallax_lod_dist"in h||(h.b4w_parallax_lod_dist=10,f("material",h,"b4w_parallax_lod_dist")),"b4w_shore_dist_map"in h||(h.b4w_shore_dist_map=!1,f("texture",h,"b4w_shore_dist_map")),"b4w_shore_boundings"in h||(h.b4w_shore_boundings=[1E3,-1E3,1E3,-1E3],f("texture",h,"b4w_shore_boundings")),"b4w_max_shore_dist"in h||(h.b4w_max_shore_dist=100,f("texture",h,"b4w_max_shore_dist")),
"b4w_disable_compression"in h||(h.b4w_disable_compression=!1,f("texture",h,"b4w_disable_compression")),"b4w_source_type"in h||(h.b4w_source_type="",f("texture",h,"b4w_source_type")),"b4w_source_id"in h||(h.b4w_source_id="",f("texture",h,"b4w_source_id")),"b4w_source_size"in h||(h.b4w_source_size=1024,f("texture",h,"b4w_source_size")),"b4w_enable_canvas_mipmapping"in h||(h.b4w_enable_canvas_mipmapping=!0,f("texture",h,"b4w_enable_canvas_mipmapping")),"b4w_nla_video"in h||(h.b4w_nla_video=!1,f("texture",
h,"b4w_nla_video"));k=a.images;for(e=0;e<k.length;e++)h=k[e],"colorspace_settings_name"in h||(h.colorspace_settings_name="sRGB",f("image",h,"colorspace_settings_name"));c=a.materials;for(e=0;e<c.length;e++){d=c[e];"ALPHA_ANTIALIASING"==d.game_settings.alpha_blend&&(sa.mali_alpha_antialias_hack?d.game_settings.alpha_blend="CLIP":2>sa.msaa_samples&&(F.warn('Material "'+d.name+'" has the "Alpha Anti-Aliasing" transparency type, but multisampling is disabled. Changed to "Alpha Clip".'),d.game_settings.alpha_blend=
"CLIP"));"use_tangent_shading"in d||(d.use_tangent_shading=!1,f("material",d,"use_tangent_shading"));"b4w_node_mat_type"in d&&t("material",d,"b4w_node_mat_type");"b4w_skydome"in d&&t("material",d,"b4w_skydome");"b4w_procedural_skydome"in d&&t("material",d,"b4w_procedural_skydome");"b4w_lens_flares"in d||(d.b4w_lens_flares=!1,f("material",d,"b4w_lens_flares"));"LENS_FLARES"===d.name&&(d.b4w_lens_flares||F.warn('"LENS_FLARES" material name has been found. Enable the "Lens Flare" property for this material.'),
d.b4w_lens_flares=!0);d.b4w_water&&("b4w_water_shore_smoothing"in d||(d.b4w_water_shore_smoothing=!1,f("material",d,"b4w_water_shore_smoothing")),"b4w_water_dynamic"in d||(d.b4w_water_dynamic=!1,f("material",d,"b4w_water_dynamic")),"b4w_waves_height"in d||(d.b4w_waves_height=1,f("material",d,"b4w_waves_height")),"b4w_waves_length"in d||(d.b4w_waves_length=1,f("material",d,"b4w_waves_length")),"b4w_water_dst_noise_scale0"in d||(d.b4w_water_dst_noise_scale0=.05,f("material",d,"b4w_water_dst_noise_scale0")),
"b4w_water_dst_noise_scale1"in d||(d.b4w_water_dst_noise_scale1=.03,f("material",d,"b4w_water_dst_noise_scale1")),"b4w_water_dst_noise_freq0"in d||(d.b4w_water_dst_noise_freq0=1.3,f("material",d,"b4w_water_dst_noise_freq0")),"b4w_water_dst_noise_freq1"in d||(d.b4w_water_dst_noise_freq1=1,f("material",d,"b4w_water_dst_noise_freq1")),"b4w_water_dir_min_shore_fac"in d||(d.b4w_water_dir_min_shore_fac=.4,f("material",d,"b4w_water_dir_min_shore_fac")),"b4w_water_dir_freq"in d||(d.b4w_water_dir_freq=.5,
f("material",d,"b4w_water_dir_freq")),"b4w_water_dir_noise_scale"in d||(d.b4w_water_dir_noise_scale=.05,f("material",d,"b4w_water_dir_noise_scale")),"b4w_water_dir_noise_freq"in d||(d.b4w_water_dir_noise_freq=.07,f("material",d,"b4w_water_dir_noise_freq")),"b4w_water_dir_min_noise_fac"in d||(d.b4w_water_dir_min_noise_fac=.5,f("material",d,"b4w_water_dir_min_noise_fac")),"b4w_water_dst_min_fac"in d||(d.b4w_water_dst_min_fac=.2,f("material",d,"b4w_water_dst_min_fac")),"b4w_water_waves_hor_fac"in d||
(d.b4w_water_waves_hor_fac=5,f("material",d,"b4w_water_waves_hor_fac")),"b4w_water_absorb_factor"in d||(d.b4w_water_absorb_factor=6,f("material",d,"b4w_water_absorb_factor")),"b4w_water_fog_color"in d||(d.b4w_water_fog_color=[.5,.7,.7],f("material",d,"b4w_water_fog_color")),"b4w_foam_factor"in d||(d.b4w_foam_factor=5,f("material",d,"b4w_foam_factor")),"b4w_generated_mesh"in d||(d.b4w_generated_mesh=!1,f("material",d,"b4w_generated_mesh")),"b4w_water_num_cascads"in d||(d.b4w_water_num_cascads=5,f("material",
d,"b4w_water_num_cascads")),"b4w_water_subdivs"in d||(d.b4w_water_subdivs=64,f("material",d,"b4w_water_subdivs")),"b4w_water_detailed_dist"in d||(d.b4w_water_detailed_dist=1E3,f("material",d,"b4w_water_detailed_dist")),"b4w_water_enable_caust"in d||(d.b4w_water_enable_caust=!1,f("material",d,"b4w_water_enable_caust")),"b4w_water_caust_scale"in d||(d.b4w_water_caust_scale=.25,f("material",d,"b4w_water_caust_scale")),"b4w_water_caust_brightness"in d||(d.b4w_water_caust_brightness=.5,f("material",d,
"b4w_water_caust_brightness")));"b4w_dynamic_grass_size"in d||(d.b4w_dynamic_grass_size="");"b4w_dynamic_grass_color"in d||(d.b4w_dynamic_grass_color="");"diffuse_intensity"in d||(d.diffuse_intensity=1,f("material",d,"diffuse_intensity"));"b4w_use_ghost"in d||(d.b4w_use_ghost=!1);"b4w_collision_margin"in d||(d.b4w_collision_margin=.04,f("material",d,"b4w_collision_margin"));"b4w_collision_group"in d||(d.b4w_collision_group=128,f("material",d,"b4w_collision_group"));"b4w_collision_mask"in d||(d.b4w_collision_mask=
127,f("material",d,"b4w_collision_mask"));"b4w_do_not_render"in d||(d.b4w_do_not_render=!1,f("material",d,"b4w_do_not_render"));"HALO"!=d.type||"b4w_halo_sky_stars"in d||(d.b4w_halo_sky_stars=!1,f("material",d,"b4w_halo_sky_stars"));"HALO"!=d.type||"b4w_halo_stars_blend_height"in d||(d.b4w_halo_stars_blend_height=10,f("material",d,"b4w_halo_stars_blend_height"));"HALO"!=d.type||"b4w_halo_stars_min_height"in d||(d.b4w_halo_stars_min_height=0,f("material",d,"b4w_halo_stars_min_height"));"specular_shader"in
d||(d.specular_shader="COOKTORR",f("material",d,"specular_shader"));"diffuse_shader"in d||(d.diffuse_shader="LAMBERT",f("material",d,"diffuse_shader"));"roughness"in d||(d.roughness=.5,f("material",d,"roughness"));"diffuse_fresnel"in d||(d.diffuse_fresnel=.1,f("material",d,"diffuse_fresnel"));"diffuse_fresnel_factor"in d||(d.diffuse_fresnel_factor=.5,f("material",d,"diffuse_fresnel_factor"));"specular_slope"in d||(d.specular_slope=.2,f("material",d,"specular_slope"));"specular_toon_size"in d||(d.specular_toon_size=
.5,f("material",d,"specular_toon_size"));"specular_toon_smooth"in d||(d.specular_toon_smooth=.1,f("material",d,"specular_toon_smooth"));"specular_alpha"in d||(d.specular_alpha=1,f("material",d,"specular_alpha"));"b4w_wettable"in d||(d.b4w_wettable=!1,f("material",d,"b4w_wettable"));"b4w_refractive"in d||(d.b4w_refractive=!1,f("material",d,"b4w_refractive"));"b4w_refr_bump"in d||(d.b4w_refr_bump=0,f("material",d,"b4w_refr_bump"));"b4w_shallow_water_col"in d||(d.b4w_shallow_water_col=[0,.8,.3],f("material",
d,"b4w_shallow_water_col"));"b4w_shore_water_col"in d||(d.b4w_shore_water_col=[0,.9,.2],f("material",d,"b4w_shore_water_col"));"b4w_shallow_water_col_fac"in d||(d.b4w_shallow_water_col_fac=1,f("material",d,"b4w_shallow_water_col_fac"));"b4w_shore_water_col_fac"in d||(d.b4w_shore_water_col_fac=.5,f("material",d,"b4w_shore_water_col_fac"));"b4w_water_sss_strength"in d||(d.b4w_water_sss_strength=5.9,f("material",d,"b4w_water_sss_strength"));"b4w_water_sss_width"in d||(d.b4w_water_sss_width=.45,f("material",
d,"b4w_water_sss_width"));"b4w_render_above_all"in d||(d.b4w_render_above_all=!1,f("material",d,"b4w_render_above_all"));"b4w_water_norm_uv_velocity"in d||(d.b4w_water_norm_uv_velocity=.05,f("material",d,"b4w_water_norm_uv_velocity"));"specular_ior"in d||(d.specular_ior=1,f("material",d,"specular_ior"));"darkness"in d||(d.darkness=0,f("material",d,"darkness"));"diffuse_toon_size"in d||(d.diffuse_toon_size=0,f("material",d,"diffuse_toon_size"));"diffuse_toon_smooth"in d||(d.diffuse_toon_smooth=0,f("material",
d,"diffuse_toon_smooth"));"pass_index"in d||(d.pass_index=0,f("material",d,"pass_index"));k=d.texture_slots;for(m=0;m<k.length;m++)h=k[m],"blend_type"in h||(h.blend_type="MIX",f("texture_slot",h,"blend_type"));if(d.node_tree){k=d.node_tree.nodes;for(m=0;m<k.length;m++)l(k[m]);d.node_tree.animation_data&&b(d.node_tree.animation_data)}}h=a.node_groups;for(e=0;e<h.length;e++)for(k=h[e].node_tree.nodes,m=0;m<k.length;m++)l(k[m]);k=a.objects;for(e=0;e<k.length;e++){h=k[e];switch(h.type){case "MESH":"b4w_dynamic_geometry"in
h||(h.b4w_dynamic_geometry=!1);"b4w_reflexible"in h||(h.b4w_reflexible=!1);"b4w_reflexible_only"in h||(h.b4w_reflexible_only=!1);"b4w_reflective"in h||(h.b4w_reflective=!1);"b4w_reflection_type"in h||(h.b4w_reflection_type="PLANE",f("object",h,"b4w_reflection_type"));"b4w_wind_bending"in h||(h.b4w_wind_bending=!1,f("object",h,"b4w_wind_bending"));"b4w_wind_bending_angle"in h||(h.b4w_wind_bending_angle=10,h.b4w_wind_bending_freq=.25,f("object",h,"wind bending params"));"b4w_detail_bending_amp"in h||
(h.b4w_detail_bending_amp=.1,h.b4w_branch_bending_amp=.3,f("object",h,"detail bending params"));"b4w_detail_bending_freq"in h||(h.b4w_detail_bending_freq=1,f("object",h,"b4w_detail_bending_freq"));"b4w_main_bend_stiffness_col"in h||(h.b4w_main_bend_stiffness_col="",f("object",h,"b4w_main_bend_stiffness_col"));"b4w_detail_bend_colors"in h||(h.b4w_detail_bend_colors={leaves_stiffness_col:"",leaves_phase_col:"",overall_stiffness_col:""},f("object",h,"b4w_detail_bend_colors"));"b4w_caustics"in h||(h.b4w_caustics=
!1);"vertex_groups"in h&&h.vertex_groups.length&&h.data&&0==h.data.vertex_groups.length&&(h.data.vertex_groups=h.vertex_groups,delete h.vertex_groups,f("object",h,"vertex_groups"));"b4w_vertex_anim"in h&&h.b4w_vertex_anim.length&&h.data&&0==h.data.b4w_vertex_anim.length&&(h.data.b4w_vertex_anim=h.b4w_vertex_anim,delete h.b4w_vertex_anim,f("object",h,"b4w_vertex_anim"));"b4w_do_not_render"in h||(h.b4w_do_not_render=!1);"b4w_hidden_on_load"in h||(h.b4w_hidden_on_load=!1);"b4w_hide_chldr_on_load"in h||
(h.b4w_hide_chldr_on_load=!1);"use_ghost"in h.game||(h.game.use_ghost=!1);"use_sleep"in h.game||(h.game.use_sleep=!1);"velocity_min"in h.game||(h.game.velocity_min=0);"velocity_max"in h.game||(h.game.velocity_max=0);"collision_group"in h.game||(h.game.collision_group=1);"collision_mask"in h.game||(h.game.collision_mask=255);m=h;c=m.game;d=c.collision_bounds_type;c.use_collision_bounds&&"BOX"!=d&&"CYLINDER"!=d&&"CONE"!=d&&"SPHERE"!=d&&"CAPSULE"!=d&&"EMPTY"!=d&&(F.error("Wrong collision bounds type "+
d+". Disable physics for object "+m.name),m.b4w_collision=!1,m.b4w_floating=!1,m.b4w_vehicle=!1,m.b4w_character=!1);"b4w_vehicle_settings"in h?h.b4w_vehicle_settings&&("steering_ratio"in h.b4w_vehicle_settings||(h.b4w_vehicle_settings.steering_ratio=10),"steering_max"in h.b4w_vehicle_settings||(h.b4w_vehicle_settings.steering_max=1),"inverse_control"in h.b4w_vehicle_settings||(h.b4w_vehicle_settings.inverse_control=!1),"force_max"in h.b4w_vehicle_settings||(h.b4w_vehicle_settings.force_max=1500),
"brake_max"in h.b4w_vehicle_settings||(h.b4w_vehicle_settings.brake_max=100),"speed_ratio"in h.b4w_vehicle_settings||(h.b4w_vehicle_settings.speed_ratio=.027),"max_speed_angle"in h.b4w_vehicle_settings||(h.b4w_vehicle_settings.max_speed_angle=Math.PI),"delta_tach_angle"in h.b4w_vehicle_settings||(h.b4w_vehicle_settings.delta_tach_angle=4.43),"suspension_compression"in h.b4w_vehicle_settings||(h.b4w_vehicle_settings.suspension_compression=4.4),"suspension_stiffness"in h.b4w_vehicle_settings||(h.b4w_vehicle_settings.suspension_stiffness=
20),"suspension_damping"in h.b4w_vehicle_settings||(h.b4w_vehicle_settings.suspension_damping=2.3),"wheel_friction"in h.b4w_vehicle_settings||(h.b4w_vehicle_settings.wheel_friction=1E3),"roll_influence"in h.b4w_vehicle_settings||(h.b4w_vehicle_settings.roll_influence=.1),"max_suspension_travel_cm"in h.b4w_vehicle_settings||(h.b4w_vehicle_settings.max_suspension_travel_cm=30),"floating_factor"in h.b4w_vehicle_settings||(h.b4w_vehicle_settings.floating_factor=3),"floating_factor"in h.b4w_vehicle_settings||
(h.b4w_vehicle_settings.floating_factor=3),"water_lin_damp"in h.b4w_vehicle_settings||(h.b4w_vehicle_settings.water_lin_damp=.9),"water_rot_damp"in h.b4w_vehicle_settings||(h.b4w_vehicle_settings.water_rot_damp=.9)):(h.b4w_vehicle_settings=null,f("object",h,"b4w_vehicle_settings"));"b4w_floating_settings"in h?h.b4w_floating_settings&&("floating_factor"in h.b4w_floating_settings||(h.b4w_floating_settings.floating_factor=3),"water_lin_damp"in h.b4w_floating_settings||(h.b4w_floating_settings.water_lin_damp=
.8),"water_rot_damp"in h.b4w_floating_settings||(h.b4w_floating_settings.water_rot_damp=.8)):(h.b4w_floating_settings=null,f("object",h,"b4w_floating_settings"));"b4w_character_settings"in h?h.b4w_character_settings&&("walk_speed"in h.b4w_character_settings||(h.b4w_character_settings.walk_speed=4),"run_speed"in h.b4w_character_settings||(h.b4w_character_settings.run_speed=8),"step_height"in h.b4w_character_settings||(h.b4w_character_settings.step_height=.25),"jump_strength"in h.b4w_character_settings||
(h.b4w_character_settings.jump_strength=5),"waterline"in h.b4w_character_settings||(h.b4w_character_settings.waterline=0)):(h.b4w_character_settings=null,f("object",h,"b4w_character_settings"));"b4w_selectable"in h||(h.b4w_selectable=!1,f("object",h,"b4w_selectable"));"b4w_outlining"in h||(h.b4w_outlining=!1,f("object",h,"b4w_outlining"));"b4w_outline_on_select"in h||(h.b4w_outline_on_select=!1,f("object",h,"b4w_outline_on_select"));"b4w_billboard"in h||(h.b4w_billboard=!1,f("object",h,"b4w_billboard"));
"b4w_billboard_geometry"in h||(h.b4w_billboard_geometry="SPHERICAL",f("object",h,"b4w_billboard_geometry"));"b4w_pres_glob_orientation"in h||(h.b4w_pres_glob_orientation=!1,f("object",h,"b4w_pres_glob_orientation"));"b4w_outline_settings"in h||("b4w_glow_settings"in h?h.b4w_outline_settings=h.b4w_glow_settings:(h.b4w_outline_settings={},h.b4w_outline_settings.outline_duration=1,h.b4w_outline_settings.outline_period=1,h.b4w_outline_settings.outline_relapses=0),f("object",h,"b4w_outline_settings"));
"lod_levels"in h||(h.lod_levels=[],f("object",h,"lod_levels"));"b4w_animation_mixing"in h||(h.b4w_animation_mixing=!1,f("object",h,"b4w_animation_mixing"));break;case "EMPTY":"b4w_anchor"in h||(h.b4w_anchor=null,f("object",h,"b4w_anchor")),!h.b4w_anchor||"max_width"in h.b4w_anchor||(h.b4w_anchor.max_width=250)}"collision_margin"in h.game||(h.game.collision_margin=.04,f("object",h,"collision_margin"));"b4w_anim_behavior"in h||(h.b4w_anim_behavior=h.b4w_cyclic_animation?"CYCLIC":"FINISH_STOP",f("object",
h,"b4w_anim_behavior"));if(!("rotation_quaternion"in h)){m=[0,0,0,1];r.Y(h.rotation_euler,m);var c=m,d=m[0],n=m[1],p=m[2];c[0]=m[3];c[1]=d;c[2]=n;c[3]=p;h.rotation_quaternion=m;f("object",h,"rotation_quaternion")}"webgl_do_not_batch"in h&&(h.b4w_do_not_batch=h.webgl_do_not_batch)&&t("object",h,"webgl_do_not_batch");"b4w_shadow_cast_only"in h||(h.b4w_shadow_cast_only=!1,f("object",h,"b4w_shadow_cast_only"));"b4w_correct_bounding_offset"in h||(h.b4w_correct_bounding_offset="AUTO",f("object",h,"b4w_correct_bounding_offset"));
c=h.particle_systems;for(m=0;m<c.length;m++)d=c[m],n=d.settings,"use_rotation_dupli"in n||(n.use_rotation_dupli=!1,f("particle_settings",n,"use_rotation_dupli")),"use_whole_group"in n||(n.use_whole_group=!1,f("particle_settings",n,"use_whole_group")),d.transforms||(d.transforms=new Float32Array,f("particle_system",d,"transforms")),"b4w_billboard_align"in n||(n.b4w_billboard_align="VIEW",f("particle_settings",n,"b4w_billboard_align")),"b4w_dynamic_grass"in n||(n.b4w_dynamic_grass=!1,f("object",n,"b4w_dynamic_grass")),
"b4w_dynamic_grass_scale_threshold"in n||(n.b4w_dynamic_grass_scale_threshold=.01,f("object",n,"b4w_dynamic_grass_scale_threshold")),"b4w_initial_rand_rotation"in n||(n.b4w_initial_rand_rotation=!1,f("particle_settings",n,"b4w_initial_rand_rotation")),"b4w_rotation_type"in n||(n.b4w_rotation_type="Z",f("particle_settings",n,"b4w_rotation_type")),"b4w_rand_rotation_strength"in n||(n.b4w_rand_rotation_strength=1,f("particle_settings",n,"b4w_rand_rotation_strength")),"b4w_hair_billboard"in n||(n.b4w_hair_billboard=
!1,f("particle_settings",n,"b4w_hair_billboard")),"b4w_hair_billboard_type"in n||(n.b4w_hair_billboard_type="BASIC",f("particle_settings",n,"b4w_hair_billboard_type")),"b4w_hair_billboard_jitter_amp"in n||(n.b4w_hair_billboard_jitter_amp=0,f("particle_settings",n,"b4w_hair_billboard_jitter_amp")),"b4w_hair_billboard_jitter_freq"in n||(n.b4w_hair_billboard_jitter_freq=0,f("particle_settings",n,"b4w_hair_billboard_jitter_freq")),"b4w_hair_billboard_geometry"in n||(n.b4w_hair_billboard_geometry="SPHERICAL",
f("particle_settings",n,"b4w_hair_billboard_geometry")),"b4w_wind_bend_inheritance"in n||(n.b4w_wind_bend_inheritance="PARENT",f("particle_settings",n,"b4w_wind_bend_inheritance")),"b4w_shadow_inheritance"in n||(n.b4w_shadow_inheritance="PARENT",f("particle_settings",n,"b4w_shadow_inheritance")),"b4w_reflection_inheritance"in n||(n.b4w_reflection_inheritance="PARENT",f("particle_settings",n,"b4w_reflection_inheritance")),"b4w_vcol_from_name"in n||(n.b4w_vcol_from_name="",f("particle_settings",n,"b4w_vcol_from_name")),
"b4w_vcol_to_name"in n||(n.b4w_vcol_to_name="",f("particle_settings",n,"b4w_vcol_to_name")),"b4w_coordinate_system"in n||(n.b4w_coordinate_system="LOCAL",f("particle_settings",n,"b4w_coordinate_system")),"b4w_allow_nla"in n||(n.b4w_allow_nla=!0,f("particle_settings",n,"b4w_allow_nla")),"b4w_enable_soft_particles"in n||(n.b4w_enable_soft_particles=!1,f("particle_settings",n,"b4w_enable_soft_particles")),"b4w_particles_softness"in n||(n.b4w_particles_softness=1,f("particle_settings",n,"b4w_particles_softness")),
"billboard_tilt"in n||(n.billboard_tilt=0,f("particle_settings",n,"billboard_tilt")),"billboard_tilt_random"in n||(n.billboard_tilt_random=0,f("particle_settings",n,"billboard_tilt_random")),"use_rotations"in n||(n.use_rotations=!1,f("particle_settings",n,"use_rotations"));"constraints"in h||(h.constraints=[],f("object",h,"constraints"));c=h.constraints;for(m=0;m<c.length;m++)d=c[m],"influence"in d||(d.influence=1),"axes"in d||(d.axes=[1,1,1]);c=h.modifiers;for(m=0;m<c.length;m++){a:{d=c[m];switch(d.type){case "ARRAY":if(!("fit_type"in
d)){F.error("WARNING Incomplete modifier "+String(d.type)+' for "'+h.name+'", reexport "'+a.b4w_filepath_blend+'" scene');d=!1;break a}}d=!0}d||(c.splice(m,1),m--)}"animation_data"in h||(h.animation_data={action:null,nla_tracks:[]},f("object",h,"animation_data"));if(h.animation_data){if(!("action"in h.animation_data))h.animation_data.action=null,C("no action in animation data "+h.name);else if(h.animation_data.action){var m=h.animation_data.action.fcurves,u;for(u in m){var c=m[u],z;for(z in c)d=c[z],
"num_channels"in d||(d.num_channels=1,C('B4W Warning: no channels number in animation fcurve for "'+h.animation_data.action.name+'" action, reexport scene'))}}"nla_tracks"in h.animation_data||(h.animation_data.nla_tracks=[],C("no NLA in animation data "+h.name));b(h.animation_data)}"b4w_collision_id"in h||(h.b4w_collision_id="",f("object",h,"b4w_collision_id"));"b4w_viewport_alignment"in h||(h.b4w_viewport_alignment=null,f("object",h,"b4w_viewport_alignment"));"pinverse_tsr"in h||(h.pinverse_tsr=
null,f("object",h,"pinverse_tsr"));"b4w_cluster_data"in h||(h.b4w_cluster_data={cluster_id:-1,cluster_center:null},f("object",h,"b4w_cluster_data"));"pass_index"in h||(h.pass_index=0,f("object",h,"pass_index"));"b4w_custom_prop"in h||(f("object",h,"b4w_custom_prop"),h.b4w_custom_prop=null);(0>h.scale[0]||0>h.scale[1]||0>h.scale[2])&&C('negative scale for object "'+h.name+'", can lead to some errors');m=h.scale;0==m[0]&&0==m[1]&&0==m[2]?m=!0:(c=Math.abs((m[1]-m[2])/m[1]),m=.005>Math.abs((m[0]-m[1])/
m[0])&&.005>c);m||C("non-uniform scale for object "+h.name)}for(var y in v)e=v[y],u=y.match(/.*?(?=>>|$)/i)[0],F.warn('Property "'+String(u)+'" is '+e.report_type+' for "'+e.type+'". To fix this, reexport '+a.b4w_filepath_blend)};c.apply_mesh_modifiers=function(a){var b;a:{b=a.modifiers;for(var c=0;c<b.length;c++){var e=b[c].type;if("ARRAY"==e||"CURVE"==e){b=!0;break a}}b=!1}if(!b)return null;b=z(a.data,a.data.name+"_MOD");a=a.modifiers;for(c=0;c<a.length;c++){var f=a[c];switch(f.type){case "ARRAY":for(var e=
b,k=f,h=0,l=0,m=0,n=new Float32Array(16),f=[],t=1;t<k.count;t++){k.use_constant_offset&&(h+=k.constant_offset_displace[0],l+=k.constant_offset_displace[1],m+=k.constant_offset_displace[2]);if(k.use_relative_offset)var v=e.b4w_boundings.bb,h=h+(v.max_x-v.min_x)*k.relative_offset_displace[0],l=l+(v.max_y-v.min_y)*k.relative_offset_displace[1],m=m+(v.max_z-v.min_z)*k.relative_offset_displace[2];r._60(h,l,m,n);for(var y=v=z(e),B=n,J=u.fromMat4(B,Y),J=I.fromMat3(J,S),K=0;K<y.submeshes.length;K++){var C=
y.submeshes[K];r._28(C.position,B,C.position,0);A.j(C.tbn,J,C.tbn)}f.push(v)}for(t=0;t<f.length;t++)for(k=e,h=f[t],l=0;l<k.submeshes.length;l++)if(m=k.submeshes[l],n=h.submeshes[l],v=m.base_length,y=m.indices.length,v)for(var T in m)switch(T){case "base_length":m[T]+=n[T];break;case "boundings":break;case "indices":m[T]=r._67(m[T],n[T]);for(B=y;B<m[T].length;B++)m[T][B]+=v;break;case "position":m[T]=G(m[T],n[T],m[T].length/v/3);break;case "tbn":m[T]=G(m[T],n[T],m[T].length/v/4);break;case "shade_tangs":m[T]=
G(m[T],n[T],m[T].length/v/3);break;case "group":m[T]=G(m[T],n[T],m[T].length/v);break;case "texcoord":m[T]=G(m[T],n[T],m.uv_layers.length);break;case "color":m[T]=G(m[T],n[T],m.vertex_colors.length);break;case "uv_layers":case "vertex_colors":break;default:F.warn('array_mesh_join(): unknown submesh property "'+T+'"'),m[T]=r._2(m[T],n[T])}break;case "CURVE":for(e=b,t=M.create_spline(f.object),k=new Float32Array(16),l=t.is_3d?4:3,h=new Float32Array(l),l=new Float32Array(l),m=new Float32Array(3),n=new Float32Array(4),
v=new Float32Array(4),y=new Float32Array(3),B=new Float32Array(3),J=new Float32Array(3),K=0;K<e.submeshes.length;K++){var L=e.submeshes[K],C=L.position,L=L.tbn,U;a:{U=f.deform_axis;switch(U){case "POS_X":case "NEG_X":U=0;break a;case "POS_Y":case "NEG_Y":U=1;break a;case "POS_Z":case "NEG_Z":U=2;break a;default:E.panic("Wrong deform axis value "+U)}U=void 0}y[0]=0;y[1]=0;y[2]=0;y[U]=1;for(var R=M.spline_length(t),fa=0;fa<C.length/3;fa++){J[0]=C[3*fa];J[1]=C[3*fa+1];J[2]=C[3*fa+2];var ka=J[U],sa=M.spline_len_to_t(t,
ka);M.spline_point(t,sa,h);m[0]=h[0];m[1]=h[1];m[2]=h[2];M.spline_derivative(t,sa,l);B[0]=l[0];B[1]=0;B[2]=l[2];p.normalize(B,B);I.rotationTo(y,B,n);0>ka?(h[0]=B[0],h[1]=B[1],h[2]=B[2],p.scale(h,ka,h),p.add(m,h,m)):ka>R&&(h[0]=B[0],h[1]=B[1],h[2]=B[2],p.scale(h,ka-R,h),p.add(m,h,m));d.fromRotationTranslation(n,m,k);t.is_3d&&(I.setAxisAngle(y,h[3],v),p.transformQuat(J,v,J));J[U]=0;p.transformMat4(J,k,J);C[3*fa]=J[0];C[3*fa+1]=J[1];C[3*fa+2]=J[2];ka=A.e(L,fa,ha);A.j(ka,n,ka);A.n(L,ka,fa)}}}V.N(b)}return b};
c.assign_logic_nodes_object_params=function(a,b,c){function d(b,c){var d=b[0];if(1<b.length)for(var e=1;e<b.length;e++)d+="*"+b[e];for(e=0;e<a.length;e++){var f=a[e];if(f.name==d)for(var h in c)f[h]=c[h]}}function e(a,b){for(var c in a)d(a[c],b)}b=c.b4w_logic_nodes;for(var f=0;f<b.length;f++)for(var h=b[f],k=0;k<h.length;k++){var l=h[k],m={register1:"variable1",register2:"variable2",registerd:"variabled"},n;for(n in m)n in l&&(l[m[n]]=l[n]);for(var q in l.variables)"boolean"!=typeof l.variables[q][0]&&
(l.variables[q]=[!1,l.variables[q]]);0<=["MATH","CONDJUMP","PAGEPARAM","REGSTORE"].indexOf(l.type)&&("variable1"in l&&(l.variables.id0=[!1,l.variable1]),"variable2"in l&&(l.variables.id1=[!1,l.variable2]),"variabled"in l&&(l.variables.vd=[!1,l.variabled]));for(var p in l.links)p.startsWith("id")||delete l.links[p];var m=l.common_usage_names,r=l.variables;switch(l.type){case "SELECT":for(var u=0;u<a.length;u++)m=a[u],m.name==l.object&&(m.b4w_selectable=!0);l.bools||(l.bools={});l.bools.not_wait||(l.bools.not_wait=
!1);C('Logic nodes type "SELECT" is deprecated');break;case "SWITCH_SELECT":e(l.objects_paths,{b4w_selectable:!0});if(l.links instanceof Array){C('Format of a "SWITCH_SELECT" node is outdated. It is recommended to reexport the scene "'+c.name+'"');m={};r=0;for(u in l.objects_paths)m[u]=l.links[r],r++;l.links=m}break;case "SELECT_PLAY":C('Logic nodes type "SELECT_PLAY" is deprecated, node will be muted. To fix this, reexport the scene "'+c.name+'"');l.mute=!0;break;case "SELECT_PLAY_ANIM":C('Logic nodes type "SELECT_PLAY_ANIM" is deprecated');
break;case "SHOW":case "HIDE":l.bools||(l.bools={});void 0===l.bools.ch&&(l.bools.ch=!1);l.bools.id0||e(l.objects_paths,{b4w_do_not_batch:!0});break;case "SET_SHADER_NODE_PARAM":case "INHERIT_MAT":e(l.objects_paths,{b4w_do_not_batch:!0});break;case "PLAY":c.b4w_use_nla=!0;break;case "MOVE_TO":e(l.objects_paths,{b4w_do_not_batch:!0});break;case "TRANSFORM_OBJECT":e(l.objects_paths,{b4w_do_not_batch:!0});switch(m.space_type){case "WORLD":m.space_type=U.NST_WORLD;break;case "PARENT":m.space_type=U.NST_PARENT;
break;case "LOCAL":m.space_type=U.NST_LOCAL}break;case "OUTLINE":e(l.objects_paths,{b4w_outlining:!0});break;case "CONDJUMP":l.condition&&(m.condition=l.condition);if("cnd"in l.floats)m.condition=l.floats.cnd;else switch(m.condition){case "GEQUAL":m.condition=U.NC_GEQUAL;break;case "LEQUAL":m.condition=U.NC_LEQUAL;break;case "GREATER":m.condition=U.NC_GREATER;break;case "LESS":m.condition=U.NC_LESS;break;case "NOTEQUAL":m.condition=U.NC_NOTEQUAL;break;case "EQUAL":m.condition=U.NC_EQUAL}void 0!=l.number1&&
(l.input1=l.number1);void 0!=l.number2&&(l.input2=l.number2);l.bools||(l.bools={});l.bools.str&&(m.variable_type="STRING");switch(m.variable_type){case "NUMBER":m.variable_type=U.NT_NUMBER;break;case "STRING":m.variable_type=U.NT_STRING;break;case "OBJECT":m.variable_type=U.NT_OBJECT}void 0===m.variable_type&&(m.variable_type=U.NT_NUMBER,l.floats.inp1=l.input1,l.floats.inp2=l.input2);void 0===r.id0&&(r.id0=r.v1,r.id1=r.v2);break;case "SEND_REQ":l.bools||(l.bools={});l.strings||(l.strings={});void 0===
l.bools.ct&&(l.bools.ct=!1);void 0!=l.url&&(l.bools.url=!1,l.strings.url=l.url);break;case "MATH":void 0!=l.number1&&(l.input1=l.number1);void 0!=l.number2&&(l.input2=l.number2);void 0!=l.input1&&(l.floats.inp1=l.input1);void 0!=l.input2&&(l.floats.inp2=l.input2);switch(l.operation){case "DIV":l.operation=U.NMO_DIV;break;case "SUB":l.operation=U.NMO_SUB;break;case "MUL":l.operation=U.NMO_MUL;break;case "ADD":l.operation=U.NMO_ADD;break;case "RAND":l.operation=U.NMO_RAND;break;case "SIN":l.operation=
U.NMO_SIN;break;case "COS":l.operation=U.NMO_COS;break;case "TAN":l.operation=U.NMO_TAN;break;case "ARCSIN":l.operation=U.NMO_ARCSIN;break;case "ARCCOS":l.operation=U.NMO_ARCCOS;break;case "ARCTAN":l.operation=U.NMO_ARCTAN;break;case "LOG":l.operation=U.NMO_LOG;break;case "MIN":l.operation=U.NMO_MIN;break;case "MAX":l.operation=U.NMO_MAX;break;case "ROUND":l.operation=U.NMO_ROUND;break;case "MOD":l.operation=U.NMO_MOD;break;case "ABS":l.operation=U.NMO_ABS}void 0===r.id0&&(r.id0=r.v1,r.id1=r.v2);
break;case "REGSTORE":l.floats||(l.floats={});l.strings||(l.strings={});void 0!=l.number1&&(l.input1=l.number1);if(void 0!=l.input1)switch(typeof l.input1){case "number":l.floats.inp1=l.input1;m.variable_type="NUMBER";break;default:l.strings.inp1=l.input1,m.variable_type="STRING"}switch(m.variable_type){case "NUMBER":m.variable_type=U.NT_NUMBER;break;case "STRING":m.variable_type=U.NT_STRING;break;case "OBJECT":m.variable_type=U.NT_OBJECT,e(l.objects_paths,{b4w_do_not_batch:!0})}break;case "PAGEPARAM":l.bools||
(l.bools={});void 0===l.bools.hsh&&(l.bools.hsh=!1);l.floats||(l.floats={});void 0===l.floats.ptp&&(l.floats.ptp=0);break;case "STOP_ANIM":case "PLAY_ANIM":l.bools||(l.bools={});void 0===l.bools.env&&(l.bools.env=!1);void 0===l.bools.id0&&(l.bools.id0=!1);l.bools.id0||d(l.objects_paths.id0,{b4w_do_not_batch:!0});"PLAY_ANIM"==l.type&&((l=m.param_anim_behavior)||(l="FINISH_STOP"),m.param_anim_behavior=K.anim_behavior_bpy_b4w(l));break;case "STRING":switch(m.string_operation){case "JOIN":m.string_operation=
U.NSO_JOIN;break;case "FIND":m.string_operation=U.NSO_FIND;break;case "REPLACE":m.string_operation=U.NSO_REPLACE;break;case "SPLIT":m.string_operation=U.NSO_SPLIT;break;case "COMPARE":m.string_operation=U.NSO_COMPARE}if("cnd"in l.floats)m.condition=l.floats.cnd;else switch(m.condition){case "GEQUAL":m.condition=U.NC_GEQUAL;break;case "LEQUAL":m.condition=U.NC_LEQUAL;break;case "GREATER":m.condition=U.NC_GREATER;break;case "LESS":m.condition=U.NC_LESS;break;case "NOTEQUAL":m.condition=U.NC_NOTEQUAL;
break;case "EQUAL":m.condition=U.NC_EQUAL}break;case "REDIRECT":void 0!=l.url&&(l.bools.url=!1,l.strings.url=l.url);break;case "SET_CAMERA_MOVE_STYLE":switch(m.camera_move_style){case "STATIC":m.camera_move_style=U.NCMS_STATIC;break;case "TARGET":m.camera_move_style=U.NCMS_TARGET;break;case "EYE":m.camera_move_style=U.NCMS_EYE;break;case "HOVER":m.camera_move_style=U.NCMS_HOVER}break;case "ENTRYPOINT":l.bools||(l.bools={});void 0===l.bools.js&&(l.bools.js=!1);l.bools.js&&(l.mute=!0);break;case "JS_CALLBACK":for(n in l=
m.js_cb_params,l)switch(l[n]){case "OBJECT":l[n]=U.NCPT_OBJECT;break;case "VARIABLE":l[n]=U.NCPT_VARIABLE}}}}});t.a=e},function(C,t,e){C=e(0);var R=e(16),V=e(1),n=e(12),y=e(10),d=e(2);e=Object(C.a)("__debug_batch",function(e,t){function k(a,c,e){var b=[],f;for(f in a)1<d._8(a[f])&&b.push([f,a[f]]);b.sort(function(a,b){var c=d._8(a[1]),e=d._8(b[1]);return e!=c?e-c:a<b?-1:b<a?1:0});if(b.length){u.groupCollapsed(c+" "+e);u.log_raw("Property different variants (>1) | Property name");for(a=0;a<b.length;a++)u.groupCollapsed(d._8(b[a][1]),
b[a][0]),r(b[a][1]);u.groupEnd()}}function r(a){u.log_raw("Batches count for this property value | Property value");var c=[],d;for(d in a)c.push([d,a[d]]);c.sort(function(a,c){return c[1]!=a[1]?c[1]-a[1]:a[0]<c[0]?-1:c[0]<a[0]?1:0});for(a=0;a<c.length;a++)u.log_raw(c[a][1],c[a][0]);u.groupEnd()}var p=Object(R.a)(e),u=Object(V.a)(e),a=Object(n.a)(e),B=Object(y.a)(e);t.print_batches_stat=function(){for(var d={},c="bounds_local bufs_data id attribute_setters num_vertices num_triangles material_names shader bpy_tex_names".split(" "),
e=0,b=0,f=a.get_scene_objs(B.get_main(),"MESH",a.DATA_ID_ALL),n=0;n<f.length;n++)for(var r=0;r<f[n].scenes_data.length;r++)for(var t=0;t<f[n].scenes_data[r].batches.length;t++){var y=p.clone_batch(f[n].scenes_data[r].batches[t]),A=y.shaders_info.vert+"/"+y.shaders_info.frag;y["shaders_info.directives"]=y.shaders_info.directives;y["shaders_info.node_elements"]=y.shaders_info.node_elements;delete y.shaders_info;for(var J=0;J<c.length;J++)delete y[c[J]];if(f[n].is_dynamic)b++;else{e++;y.type in d||(d[y.type]=
{});A in d[y.type]||(d[y.type][A]={});for(var I in y)I in d[y.type][A]||(d[y.type][A][I]={}),J=JSON.stringify(y[I]),J in d[y.type][A][I]||(d[y.type][A][I][J]=0),d[y.type][A][I][J]++}}u.group("Batches statistics:");u.log_raw("STATIC/DYNAMIC count:",e+"/"+b);u.group("STATIC batches diversity:");for(var F in d)for(A in d[F])k(d[F][A],F,A);u.groupEnd();u.groupEnd()}});t.a=e},function(C,t,e){C=e(0);var R=e(33),V=e(24),n=e(1),y=e(8),d=e(29),k=e(68),I=e(41),A=e(80),r=e(26),p=e(3);e=Object(C.a)("camera_anim",
function(e,a){function u(a,b,c,d,e){c=z.angle_wrap_0_2pi(b-c);c=Math.min(c,2*Math.PI-c);b=z.angle_wrap_0_2pi(d-b);b=Math.min(b,2*Math.PI-b);if(1E-6>Math.abs(c)||1E-6>2*Math.PI-Math.abs(c))c=0;if(1E-6>Math.abs(b)||1E-6>2*Math.PI-Math.abs(b))b=0;l.is_eye_camera(a)?(e[0]=b,e[1]=c):(e[0]=c,e[1]=b);return e}var l=Object(R.a)(e),c=Object(V.a)(e),m=Object(n.a)(e),b=Object(d.a)(e),f=Object(k.a)(e),t=Object(I.a)(e),C=Object(A.a)(e),z=Object(r.a)(e),G=new Float32Array(2),E=new Float32Array(2),J=new Float32Array(3),
M=new Float32Array(3),F=new Float32Array(3),U=C.create(),K=C.create(),sa=C.create(),v=y.create(),Y={},ha=!1,S=!1,L=!1,q=!1;a.track_to_target=function(a,b,d,e,h,k,n,q){if(l.is_eye_camera(a)){if(z.is_vector(b))var r=b;else r=J,t.get_object_center(b,!1,r);d=d||1;e=e||2;h=h||1;k=k||1;var u=t.get_translation(a,M);b=p.subtract(r,u,F);var r=l.get_camera_angles(a,G),v=l.get_camera_angles_dir(b,E),w=v[0]-r[0],y=v[1]-r[1],A=Math.abs(Math.acos(Math.cos(w)*Math.cos(y))/d),D=p.length(b)*(1-1/e),B=function(a){return 6*
a*(1-a)},H=f.get_timeline(),K=0,I=function(){c.remove_sensor_manifold(a,"TRACK_TO_TARGET");n&&n()};d=c.create_timeline_sensor();e=c.create_elapsed_sensor();c.create_sensor_manifold(a,"TRACK_TO_TARGET",c.CT_CONTINUOUS,[d,e],null,function(b,d,e){l.is_eye_camera(b)?1==e&&(e=c.get_sensor_value(b,d,0)-H,d=c.get_sensor_value(b,d,1),e<A?(e=B(e/A),l.rotate_camera(a,e*w*d/A,e*y*d/A)):e<A+h?(0==K&&(l.rotate_camera(a,v[0],v[1],!0),K++),e=B(e-A/h),d=e*D*d/h,t.move_local(b,0,0,-d)):e<A+h+k?1>=K&&(l.rotate_camera(a,
v[0],v[1],!0),l.eye_set_look_at(a,u),t.move_local(b,0,0,-D),q&&q(),K++):e<A+h+k+h?(2>=K&&(l.rotate_camera(a,v[0],v[1],!0),l.eye_set_look_at(a,u),t.move_local(b,0,0,-D),K++),e=B(e-A-h-k/h),d=e*D*d/h,t.move_local(b,0,0,d)):(l.rotate_camera(a,v[0],v[1],!0),l.eye_set_look_at(a,u),I())):I()})}else m.error("track_to_target(): Wrong camera object or camera move style")};a.auto_rotate=function(a,d,e){function f(b,d,e){if(1==e)if(e=l.get_move_style(b),e==l.MS_STATIC)h();else if(e!=l.MS_TARGET_CONTROLS&&e!=
l.MS_EYE_CONTROLS||!l.has_horizontal_rot_limits(b))n=null,d=c.get_sensor_value(b,d,0),l.rotate_camera(b,d*a,0);else{e=e==l.MS_EYE_CONTROLS?l.eye_get_horizontal_limits(b,Y):l.target_get_horizontal_limits(b,Y);if(null===n||e.left!=n.left||e.right!=n.right){n=n||{};n.left=e.left;n.right=e.right;q=Math.min(.2,z.angle_wrap_0_2pi(n.right-n.left)/2);e=k;var f=n,m=l.get_camera_angles(e,G)[0];e=u(e,m,f.left,f.right,E);p=a*Math.min(1,e[0]/.2,e[1]/.2)}d=c.get_sensor_value(b,d,0);e=l.get_camera_angles(b,G)[0];
e=u(b,e,n.left,n.right,E);e[1]>q&&e[0]>q?p=z.sign(p)*a:e[1]<q?p-=Math.pow(a,2)/.4*d:e[0]<q&&(p+=Math.pow(a,2)/.4*d);l.rotate_camera(b,d*p,0)}}function h(){c.remove_sensor_manifold(k,"AUTO_ROTATE");c.remove_sensor_manifold(k,"DISABLE_AUTO_ROTATE");d()}d=d||function(){};var k=b.get_active_camera();if(l.is_static_camera(k))m.error("auto_rotate(): Wrong camera move style");else{var n={},q=0,p=0;if(c.check_sensor_manifold(k,"AUTO_ROTATE"))h();else{var r=c.create_mouse_move_sensor("X"),t=c.create_mouse_move_sensor("Y"),
v=c.create_mouse_click_sensor(),w=c.create_touch_move_sensor(),y=c.create_touch_zoom_sensor(),A=c.create_elapsed_sensor();e=e?c.create_mouse_wheel_sensor():c.create_custom_sensor(0);c.create_sensor_manifold(k,"DISABLE_AUTO_ROTATE",c.CT_LEVEL,[r,t,v,w,y,e],function(a){return a[0]&&a[2]||a[1]&&a[2]||a[3]||a[4]||a[5]},h);c.create_sensor_manifold(k,"AUTO_ROTATE",c.CT_CONTINUOUS,[A],function(a){return a[0]},f)}}};a.is_auto_rotate=function(){var a=b.get_active_camera();return c.check_sensor_manifold(a,
"AUTO_ROTATE")};a.check_auto_rotate=function(){var a=b.get_active_camera();return l.get_move_style(a)==l.MS_STATIC?!1:!0};a.move_camera_to_point=function(a,b,c,d,e){if(l.get_move_style(a)!=l.MS_STATIC)m.error("move_camera_to_point(): wrong camera type");else if(!ha)if(a)if(b){c=c||1;d=d||.01;var h=z.is_vector(a)?a:t.get_tsr(a,U),k=z.is_vector(b)?b:t.get_tsr(b,K);b=p.distance(C.get_trans(h,J),C.get_trans(k,M))/c;c=z.quat_to_dir(C.get_quat(h,v),z.AXIS_MZ,J);var n=z.quat_to_dir(C.get_quat(k,v),z.AXIS_MZ,
M);c=Math.min(Math.abs(p.dot(c,n)),1);d=1E3*Math.max(b,Math.acos(c)/d);ha=!0;var q=f.animate(0,1,d,function(b){var c=C.interpolate(h,k,z.smooth_step(b),sa);L?(f.clear_animation(q),ha=L=!1):(t.set_tsr(a,c),1==b&&(ha=!1,e&&e()))})}else m.error("move_camera_to_point(): you must specify the point object");else m.error("move_camera_to_point(): you must specify the camera object")};a.rotate_camera=function(a,b,c,d,e){if(l.get_move_style(a)==l.MS_STATIC)m.error("rotate_camera(): not supported for STATIC cameras");
else if(!S)if(a)if(b||c){d=d||1E3;S=!0;var h=0,k=f.animate(0,b,d,function(c){q||Math.abs(c)>=Math.abs(b)?(q=!1,f.clear_animation(k),S&&(S=!1,e&&e())):(l.rotate_camera(a,h-c,0),h=c)}),n=0,p=f.animate(0,c,d,function(b){q||Math.abs(b)>=Math.abs(c)?(q=!1,f.clear_animation(p),S&&(S=!1,e&&e())):(l.rotate_camera(a,0,n-b),n=b)})}else m.error("rotate_camera(): you must specify the rotation angle");else m.error("rotate_camera(): you must specify the camera object")};a.stop_cam_moving=function(){L=!0};a.stop_cam_rotating=
function(){q=!0};a.is_moving=function(){return ha};a.is_rotating=function(){return S}});t.a=e},function(C,t,e){C=e(0);var R=e(33),V=e(24),n=e(54),y=e(29),d=e(26),k=e(60),I=e(40),A=e(49),r=e(50),p=e(41),u=e(67),a=e(3),B=e(81),l=e(1);e=Object(C.a)("fps",function(c,e){function b(a,b,c){var d=ea.get_active_camera();L.rotate_camera(d,b,c);b=L.get_camera_angles_char(d,xa);w.set_character_rotation_h(a,b[0]);w.set_character_vert_move_dir_angle(a,b[1])}function f(a,b,c,d){if(.01<Math.abs(va[0])||.01<Math.abs(va[1]))c=
q.get_sensor_value(a,b,0),b=H.smooth(va[0],0,c,.2*Ga),c=H.smooth(va[1],0,c,.2*Ga),va[0]-=b,va[1]-=c,d(a,-b*ba,-c*ba)}function m(a,b){var c=document.createElement("div");c.style.cssText="position: absolute;left: 10px;bottom: 70px;width: 53px;height: 53px;background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyBpZD0ic3ZnMzQwMCIgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTQuMTExbW0iIHdpZHRoPSIxNC4xMTFtbSIgdmVyc2lvbj0iMS4xIiB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHZpZXdCb3g9IjAgMCA0OS45OTk5OTggNDkuOTk5OTk5Ij4gPG1ldGFkYXRhIGlkPSJtZXRhZGF0YTM0MDUiPjxyZGY6UkRGPjxjYzpXb3JrIHJkZjphYm91dD0iIj48ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD48ZGM6dHlwZSByZGY6cmVzb3VyY2U9Imh0dHA6Ly9wdXJsLm9yZy9kYy9kY21pdHlwZS9TdGlsbEltYWdlIi8+PGRjOnRpdGxlLz48L2NjOldvcms+PC9yZGY6UkRGPiA8L21ldGFkYXRhPiA8ZyBpZD0ibGF5ZXIxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIC0xMDAyLjQpIj48cmVjdCBpZD0icmVjdDI0MTI2IiBvcGFjaXR5PSIwLjU0MyIgZmlsbC1vcGFjaXR5PSIuODM2MTEiIGhlaWdodD0iNTAiIHdpZHRoPSI1MCIgeT0iMTAwMi40IiB4PSIwIiBmaWxsPSIjZmZmIi8+PHBhdGggaWQ9InBhdGgyNDEyOCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZD0ibTM5LjE0MiAxMDMzLjUtMTQuMTQyLTE0LjE0Mi0xNC4xNDIgMTQuMTQyIiBzdHJva2U9IiM2ZTZlNmUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBmaWxsPSJub25lIi8+IDwvZz48L3N2Zz4=);";
c.setAttribute("id","B4W_DEFAULT_BTN_1");var d=document.createElement("div");d.style.cssText="position: absolute;left: 10px;bottom: 10px;width: 53px;height: 53px;background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyBpZD0ic3ZnMzQwMCIgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTQuMTExbW0iIHdpZHRoPSIxNC4xMTFtbSIgdmVyc2lvbj0iMS4xIiB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHZpZXdCb3g9IjAgMCA0OS45OTk5OTggNDkuOTk5OTk5Ij4gPG1ldGFkYXRhIGlkPSJtZXRhZGF0YTM0MDUiPjxyZGY6UkRGPjxjYzpXb3JrIHJkZjphYm91dD0iIj48ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD48ZGM6dHlwZSByZGY6cmVzb3VyY2U9Imh0dHA6Ly9wdXJsLm9yZy9kYy9kY21pdHlwZS9TdGlsbEltYWdlIi8+PGRjOnRpdGxlLz48L2NjOldvcms+PC9yZGY6UkRGPiA8L21ldGFkYXRhPiA8ZyBpZD0ibGF5ZXIxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIC0xMDAyLjQpIj48cmVjdCBpZD0icmVjdDI0MTI2IiBvcGFjaXR5PSIwLjU0MyIgZmlsbC1vcGFjaXR5PSIuODM2MTEiIGhlaWdodD0iNTAiIHdpZHRoPSI1MCIgeT0iMTAwMi40IiB4PSIwIiBmaWxsPSIjZmZmIi8+PHBhdGggaWQ9InBhdGgyNDEyOCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZD0ibTM5LjE0MiAxMDMzLjUtMTQuMTQyLTE0LjE0Mi0xNC4xNDIgMTQuMTQyIiBzdHJva2U9IiM2ZTZlNmUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBmaWxsPSJub25lIi8+IDwvZz48L3N2Zz4=);transform: rotate(180deg);transform-origin: center;";
d.setAttribute("id","B4W_DEFAULT_BTN_2");b.appendChild(c);b.appendChild(d)}function t(a){return"function"===typeof(a.requestPointerLock||a.webkitRequestPointerLock||a.mozRequestPointerLock)}function z(a,b){if(t(a)&&!D.detect_mobile()){var c=q.create_plock_mouse_sensor(a),d=X?X:q.create_plock_sensor(a);X=d;q.create_sensor_manifold(b,"FPS_PLOCK",q.CT_CONTINUOUS,[c,d],function(a){return a[0]&&a[1]},function(a,b,c){0<c&&(b=q.get_sensor_payload(a,b,0),ka(a,-b.coords[0]*ba,-b.coords[1]*ba))});q.create_sensor_manifold(null,
"FPS_ACTIVATE_PLOCK",q.CT_TRIGGER,[d],function(a){return a[0]},function(b,c,d){0<d?pa.enable_cb&&pa.enable_cb(a):pa.disable_cb&&pa.disable_cb(a)})}else{if(D.detect_mobile())var c=q.create_touch_move_sensor("XY",a),d=q.create_touch_click_sensor(a),e=4;else{var c=q.create_mouse_move_sensor("XY",a),d=q.create_mouse_click_sensor(a),e=2,h=ea.get_active_camera(),k=q.create_elapsed_sensor(),l=q.create_gamepad_axis_sensor(ia.GMPD_AXIS_2),m=q.create_gamepad_axis_sensor(ia.GMPD_AXIS_3);q.create_sensor_manifold(b,
"FPS_CAM_ROT",q.CT_CONTINUOUS,[k,l,m],function(a){return.05<Math.abs(a[1])||.05<Math.abs(a[2])},function(a,b,c){if(0<c){var d=q.get_sensor_value(a,b,0);c=q.get_sensor_value(a,b,1);b=q.get_sensor_value(a,b,2);d*=2.5;c=-(.05>Math.abs(c)?0:c)*d;b=H.clamp(-(.05>Math.abs(b)?0:b)*d,da,ja);L.rotate_camera(h,c,b);c=L.get_camera_angles(h,xa);w.set_character_rotation_h(a,c[0]+Math.PI)}})}var n=0,p=0;q.create_sensor_manifold(null,"FPS_DRAG_PRESS",q.CT_SHOT,[d],function(a){return a[0]},function(a,b,c){1==c&&
(a=q.get_sensor_payload(a,b,0).coords,n=a[0],p=a[1])});q.create_sensor_manifold(null,"FPS_DRAG_MOVE",q.CT_CONTINUOUS,[c,d],function(a){return a[0]&&a[1]},function(a,b,c){1==c&&(a=q.get_sensor_payload(a,b,0).coords,va[0]+=(a[0]-n)*e,va[1]+=(a[1]-p)*e,n=a[0],p=a[1])});c=q.create_elapsed_sensor();q.create_sensor_manifold(b,"FPS_SMOOTH_DRAG",q.CT_CONTINUOUS,[c],null,f,ka)}}function G(a,b){ia.add_click_listener(a,function(){ra.request_fullscreen_hmd(a,function(){q.check_sensor_manifolds(b,"FPS_PLOCK")&&
q.remove_sensor_manifold(b,"FPS_PLOCK");q.check_sensor_manifolds(null,"FPS_ACTIVATE_PLOCK")&&q.remove_sensor_manifold(null,"FPS_ACTIVATE_PLOCK");q.check_sensor_manifolds(b,"FPS_CAM_ROT")&&q.remove_sensor_manifold(b,"FPS_CAM_ROT");q.check_sensor_manifolds(null,"FPS_DRAG_PRESS")&&q.remove_sensor_manifold(null,"FPS_DRAG_PRESS");q.check_sensor_manifolds(null,"FPS_DRAG_MOVE")&&q.remove_sensor_manifold(null,"FPS_DRAG_MOVE");q.check_sensor_manifolds(b,"FPS_SMOOTH_DRAG")&&q.remove_sensor_manifold(b,"FPS_SMOOTH_DRAG");
oa.enable_hmd(oa.HMD_ALL_AXES_MOUSE_NONE);E(b);O&&O()},function(){q.remove_sensor_manifold(b,"FPS_CHARECTER_VR_ROT");oa.disable_hmd();z(a,b);wa&&wa()})})}function E(a){var b=q.create_elapsed_sensor(),c=ea.get_active_camera();q.create_sensor_manifold(a,"FPS_CHARECTER_VR_ROT",q.CT_CONTINUOUS,[b],null,function(a,b,d){b=L.get_camera_angles_char(c,xa)[0];w.set_character_rotation_h(a,b)})}function J(){var a=oa.check_browser_support()&&!D.detect_mobile(),b=ia.get_device_by_type_element(ia.DEVICE_HMD);b&&
(a=a&&ia.get_value_param(b,ia.HMD_WEBVR_TYPE)&ia.HMD_WEBVR1);return a}function C(a,b,c,d){D.detect_mobile()&&m(b,a.parentElement?a.parentElement:a);var e=ha(b),f=0,h=0,g=0,k=0,l=-1,n=d.move_dir_cd,q=function(){return Aa?(k=g=h=f=0,!1):!0},p=function(a,b){var c=e.current_node.id;a||b||4==c?0==c&&(0<l?Y(e,2):Y(e,1)):Y(e,0)};a=function(a){if(q()){a=0<a?1:a;var d=g+k;k=-(0>a?-1:a);a=g+k;var e=f+h;w.set_character_move_dir(b,a,e);c&&c(a,e);p(a,e);n&&d!=a&&n(a,e,0)}};var r=function(a){if(q()){4==e.current_node.id&&
(a=0);a=0<a?1:a;var d=f+h;h=-(0>a?-1:a);a=g+k;var l=f+h;w.set_character_move_dir(b,a,l);c&&c(a,l);p(a,l);n&&d!=l&&n(a,l,0)}},u=d.backward_sens_arr,t=d.right_sens_arr,v=d.left_sens_arr,z=d.jump_sens_arr,y=d.run_sens_arr,A=d.fly_sens_arr;S(1,d.forward_sens_arr,function(a){if(q()){var d=g+k;g=a;a=g+k;var e=f+h;w.set_character_move_dir(b,a,e);c&&c(a,e);p(a,e);n&&d!=a&&n(a,e,0)}});S(1,u,a);S(1,t,r);S(1,v,function(a){if(q()){4==e.current_node.id&&(a=0);var d=f+h;f=a;a=g+k;var l=f+h;w.set_character_move_dir(b,
a,l);c&&c(a,l);p(a,l);n&&d!=l&&n(a,l,0)}});S(1,z,function(a){q()&&0<a&&(w.character_jump(b),n&&n(g+k,f+h,1))});S(3,[ia.GMPD_AXIS_0],r);S(3,[ia.GMPD_AXIS_1],a);S(1,y,function(a){l=a;Math.abs(g+k)+Math.abs(f+h)?(0<a?Y(e,2):Y(e,1),n&&n(g+k,f+h,0)):Y(e,0)});S(1,A,function(a){0<a&&(a=ta.current_node.id,1==a||0==a?Y(e,3):Y(e,1))})}function F(){ta||(ta={nodes:[],current_node:null,lock:!1,last_state:null});return ta}function U(a,b,c,d,e,f){a.nodes.push({id:b,allowed_ids:c,call_switch:d,call_before_switch:e,
call_after_switch:f})}function K(a){for(var b=[],c=0;c<a.nodes;c++){var d=a.nodes[c].id;if(0<=b.indexOf(d))return!1;b.push(d)}for(c=0;c<a.nodes;c++)for(var d=a.nodes[c],e=0;e<d.allowed_ids.length;e++)if(0>b.indexOf(d.allowed_ids[e]))return!1;return!0}function sa(a,b){for(var c=null,d=0;d<a.nodes.length;d++)if(a.nodes[d].id==b){c=a.nodes[d];break}return c}function v(a,b){var c=sa(a,b);return a.current_node=c}function Y(a,b){a.last_state=b;if(a.lock)return!1;var c=a.current_node,d=c.id;if(0<=c.allowed_ids.indexOf(b)){var e=
!0;c.call_before_switch&&(e=c.call_before_switch(d,b));if(e)return v(a,b),c.call_switch&&c.call_switch(d,b),c.call_after_switch&&c.call_after_switch(d,b),!0}return!1}function ha(a){var b=F(),c=function(b,c){switch(c){case 0:case 1:w.set_character_move_type(a,w.CM_WALK);break;case 2:w.set_character_move_type(a,w.CM_RUN);break;case 3:w.set_character_move_type(a,w.CM_FLY);break;case 4:w.set_character_move_type(a,w.CM_CLIMB)}};U(b,0,[1,3,2,4],c,null,null);U(b,1,[2,3,4,0],c,null,null);U(b,2,[1,3,4,0],
c,null,null);U(b,3,[1],c,null,null);U(b,4,[1,2,0],c,null,null);K(b);v(b,0);return ta}function S(a,b,c){if(b.length){for(var d=[],e=0;e<b.length;e++)if("number"==typeof b[e])300>b[e]?d.push(q.create_keyboard_sensor(b[e])):326>b[e]?d.push(q.create_gamepad_btn_sensor(b[e],Ca)):d.push(q.create_gamepad_axis_sensor(b[e]));else if("string"==typeof b[e]){var f=document.getElementById(b[e]);f?d.push(q.create_touch_click_sensor(f)):Q.error("Couldn't find element with "+b[e]+" ID.")}b=function(a){return!1};
e=q.CT_SHOT;f=function(a,b,c,d){};switch(a){case 1:e=q.CT_TRIGGER;b=function(a){for(var b=0;b<a.length;b++)if(a[b])return!0;return!1};f=function(a,b,d,e){0<d?c(1):c(0)};break;case 2:e=q.CT_TRIGGER;b=function(a){for(var b=0;b<a.length;b++)if(a[b])return!0;return!1};f=function(a,b,d,e){0>d?c(1):c(0)};break;case 3:e=q.CT_CONTINUOUS,b=function(a){for(var b=0;b<a.length;b++)if(.05<Math.abs(a[b]))return!0;return!1},f=function(a,b,d,e){if(0<d)for(d=0;d<e;d++){var f=q.get_sensor_value(a,b,d);if(.05<Math.abs(f)){c(f);
break}}else c(0)}}q.create_sensor_manifold(null,"FPS_USER_CONTROL_ACTION_"+Ea.toString(),e,d,b,f,d.length);Ea++}}var L=Object(R.a)(c),q=Object(V.a)(c),w=Object(n.a)(c),ea=Object(y.a)(c),H=Object(d.a)(c),D=Object(k.a)(c),h=Object(I.a)(c),ia=Object(A.a)(c),ra=Object(r.a)(c),za=Object(p.a)(c),P=Object(u.a)(c),oa=Object(B.a)(c),Q=Object(l.a)(c),da=(-Math.PI+.1)/2,ja=(Math.PI-.1)/2,va=new Float32Array(2),Ga=1,ba=4E-4,Ea=0,ta=null,X=null,pa={enable_cb:null,disable_cb:null},ka=function(){},Ca=0,Ma=4,Aa=
!1,xa=new Float32Array(2),ga=new Float32Array(3),ya=new Float32Array(3),O=null,wa=null;e.append_switch_vr_cbs=function(a,b){O=a};e.CS_STAY=0;e.CS_WALK=1;e.CS_RUN=2;e.CS_FLY=3;e.CS_CLIMB=4;e.AT_PRESSED=1;e.AT_RELEASED=2;e.AT_CONTINUOUS=3;e.bind_action=S;e.enable_fps_controls=function(c){c=c||{lock_camera:!0};var d=c.character||ea.get_first_character();if(d){var e=c.element||h.get_canvas(),f=c.motion_cb||null;Ca=c.gamepad_id||0;var k=c.forward_sens||[q.KEY_W,ia.GMPD_BUTTON_12],l=c.backward_sens||[q.KEY_S,
ia.GMPD_BUTTON_13],m=c.right_sens||[q.KEY_D,ia.GMPD_BUTTON_15],n=c.left_sens||[q.KEY_A,ia.GMPD_BUTTON_14],p=c.jump_sens||[q.KEY_SPACE,ia.GMPD_BUTTON_1],r=c.run_sens||[q.KEY_SHIFT,ia.GMPD_BUTTON_7],u=c.fly_sens||[];D.detect_mobile()&&(k.push("B4W_DEFAULT_BTN_1"),l.push("B4W_DEFAULT_BTN_2"));k={forward_sens_arr:k,backward_sens_arr:l,right_sens_arr:m,left_sens_arr:n,jump_sens_arr:p,run_sens_arr:r,fly_sens_arr:u,move_dir_cd:c.move_dir_cd||null};ka=c.rotation_cb||b;l="undefined"!=typeof c.lock_camera?
c.lock_camera:!0;c=ea.get_active_camera();l&&(l=za.get_translation(c,ga),m=za.get_translation(d,ya),a.subtract(l,m,l),P.append_stiff_trans(c,d,l));c=L.get_camera_angles_char(c,xa);w.set_character_rotation_h(d,c[0]);w.set_character_vert_move_dir_angle(d,c[1]);J()&&G(e,d);z(e,d);C(e,d,f,k)}};e.disable_fps_controls=function(a,b){a=a||ea.get_first_character();b=b||h.get_container();if(a){for(var c=0;c<Ea;c++)q.remove_sensor_manifold(null,"FPS_USER_CONTROL_ACTION_"+c.toString());var c=a,d=b;t(d)&&!D.detect_mobile()&&
(pa.disable_cb&&pa.disable_cb(d),q.remove_sensor_manifold(c,"FPS_PLOCK"),q.remove_sensor_manifold(null,"FPS_ACTIVATE_PLOCK"));c=a;if(!t(b)||D.detect_mobile())q.remove_sensor_manifold(c,"FPS_CAM_ROT"),q.remove_sensor_manifold(c,"FPS_DRAG_PRESS"),q.remove_sensor_manifold(c,"FPS_DRAG_MOVE"),q.remove_sensor_manifold(c,"FPS_SMOOTH_DRAG");c=a;J()&&q.remove_sensor_manifold(c,"FPS_CHARECTER_VR_ROT");c=b;if(D.detect_mobile()){var d=document.getElementById("B4W_DEFAULT_BTN_1"),e=document.getElementById("B4W_DEFAULT_BTN_2");
d&&c.removeChild(d);e&&c.removeChild(e)}}};e.set_state_change_cb=function(a,b){sa(ta,a).call_after_switch=b};e.set_cam_smooth_factor=function(a){q.set_plock_smooth_factor(a);Ga=a};e.get_cam_smooth_factor=function(){return Ga};e.set_cam_sensitivity=function(a){ba=a/2E5};e.get_cam_sensitivity=function(){return 2E5*ba};e.set_plock_enable_cb=function(a){pa.enable_cb=a};e.set_plock_disable_cb=function(a){pa.disable_cb=a};e.get_character_state=function(){return ta.current_node.id};e.add_new_state=function(){return Ma++};
e.add_state=function(a,b,c){var d=F();U(d,a,b,c,null,null);K(d)||Q.error("Incorrect state machine.")};e.switch_state=function(a){var b=F();Y(b,a)};e.lock_character=function(){F().lock=!0};e.unlock_character=function(){F().lock=!1};e.is_character_locked=function(){return F().lock};e.set_rotation_cb=function(a){ka=a?a:b};e.freeze_movements=function(){Aa=!0};e.unfreeze_movements=function(){Aa=!1}});t.a=e},function(C,t,e){C=e(0);var R=e(40),V=e(24),n=e(49),y=e(69);e=Object(C.a)("gp_conf",function(d,e){function k(){S.length=
0;for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],b=0;b<a.length;b++)a[b]&&S.push(a[b]);return S}function t(a){var b=fa.get(a+"_gmpd_stngs","b4w");if(b){var b=JSON.parse(b),c;for(c in b)C.set_gamepad_key(a,c,b[c])}else c=JSON.stringify(G),fa.set(a+"_gmpd_stngs",c,"b4w")}function r(a){ea=!0;var b=document.createElement("div"),c=document.createElement("div"),d=document.createElement("div"),e=document.createElement("div"),f=document.createElement("div"),
k=document.createElement("div"),m=document.createElement("div"),n=document.createElement("div"),p=document.createElement("div"),r=document.createElement("div"),u=document.createElement("div"),t=document.createElement("div"),v=document.createElement("div"),y=document.createElement("div"),A=document.createElement("div"),D=document.createElement("div"),B=document.createElement("div"),G=document.createElement("div"),J=document.createElement("div"),H=document.createElement("div"),F=document.createElement("div"),
I=document.createElement("div");K=b;b.style.cssText="position: absolute;height: auto;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg26627" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="128.51mm" viewBox="0 0 636.63517 455.33329" width="179.67mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:dc="http://purl.org/dc/elements/1.1/"><defs id="defs26629"><linearGradient id="linearGradient4691"><stop id="stop4693" offset="0"/><stop id="stop4695" stop-opacity="0" offset="1"/></linearGradient><linearGradient id="linearGradient4358"><stop id="stop4360" stop-color="#2e2e2e" offset="0"/><stop id="stop4362" stop-color="#2e2e2e" stop-opacity="0" offset="1"/></linearGradient><linearGradient id="linearGradient4364" x1="1141.5" xlink:href="#linearGradient4358" gradientUnits="userSpaceOnUse" y1="255.95" gradientTransform="matrix(-1 0 0 1 1531.4 560.1)" x2="1165.2" y2="309.88"/><linearGradient id="linearGradient4368" x1="1141.5" xlink:href="#linearGradient4358" gradientUnits="userSpaceOnUse" y1="255.95" gradientTransform="translate(-896.37 560.1)" x2="1165.2" y2="309.88"/><linearGradient id="linearGradient4430" x1="959.32" gradientUnits="userSpaceOnUse" y1="653.07" gradientTransform="matrix(-1 0 0 1 1531.4 70.097)" x2="1467.6" y2="653.07"><stop id="stop4426" stop-color="#4f4f4f" offset="0"/><stop id="stop4428" stop-color="#4f4f4f" stop-opacity="0" offset="1"/></linearGradient><linearGradient id="linearGradient4701" x1="529.91" xlink:href="#linearGradient4691" gradientUnits="userSpaceOnUse" y1="111.1" gradientTransform="translate(-52.276 546.89)" x2="481.49" y2="85.746"/><linearGradient id="linearGradient4713" x1="529.91" xlink:href="#linearGradient4691" gradientUnits="userSpaceOnUse" y1="111.1" gradientTransform="matrix(-1 0 0 1 689.01 546.89)" x2="481.49" y2="85.746"/><linearGradient id="linearGradient4725" x1="367.39" xlink:href="#linearGradient4691" gradientUnits="userSpaceOnUse" y1="125.6" gradientTransform="matrix(-1.3272 0 0 .68317 806.95 579.14)" x2="367.39" y2="116.11"/></defs><metadata id="metadata26632"><rdf:RDF><cc:Work rdf:about="">    <dc:format>image/svg+xml</dc:format>    <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/>    <dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -597.03)"><g id="g20" fill-rule="evenodd"><path id="path4209" fill="#434343" d="m576.71 1052.4c42.015-1.9097 64.296-46.468 59.204-122.86-5.0928-76.387-27.374-175.69-44.562-224.7-17.188-49.015-25.501-62.531-26.737-65.565-3.7697-9.2504-11.278-19.949-62.379-27.691-28.97-4.3891-16.697-7.9577-27.084-9.4696-17.96-2.6141-43.609-1.229-52.203 1.6354-8.594 2.8645-12.709 29.16-24.486 35.207-11.777 6.0473-19.416 10.185-80.149 10.185s-68.372-4.1376-80.149-10.185c-11.777-6.0473-18.113-32.099-25.736-36.993-11.183-7.1796-26.985-5.6722-54.891-0.57481-5.64 1.0302-1.1304 7.6212-18.165 12.509-32.913 9.4438-52.094 3.7056-65.087 20.831-1.9807 2.6106-11.822 21.096-29.01 70.111-17.179 48.95-39.46 148.25-44.553 224.64-5.0929 76.39 17.188 120.99 59.204 122.89 73.339-1.7 55.219-116.53 258.4-116.53s185.05 114.82 258.4 116.49z"/><path id="path4366" fill="url(#linearGradient4368)" d="m249.77 838.51c-107.76 0-171.55 96.288-176.84 121.23-5.2294 24.634-17.658 55.705 3.8195 53.789 9.6996-0.8655 18.053-15.713 37.559-38.193 18.78-21.643 41.379-54.425 96.763-54.425s73.209-44.877 75.119-53.152c1.9098-8.2752 2.4146-27.976-36.418-29.25z"/><path id="path4217" fill="url(#linearGradient4364)" d="m385.23 838.51c107.76 0 171.55 96.288 176.84 121.23 5.2293 24.634 17.658 55.705-3.8195 53.789-9.6996-0.8655-18.053-15.713-37.559-38.193-18.78-21.643-41.379-54.425-96.763-54.425s-73.209-44.877-75.119-53.152c-1.9098-8.2752-2.4146-27.976 36.418-29.25z"/><path id="path4370" fill="url(#linearGradient4430)" d="m572.06 654.81c-60.48-19.09-76.79-18.6-89.84-17.96-13.05 0.63657-22.638 16.617-45.237 49.4s-67.48 125.27-116.23 125.27c-48.746 0-93.626-92.491-116.23-125.27-22.599-32.783-32.008-48.942-45.059-49.579-13.05-0.63648-35.251 1.8354-95.728 20.932l1.1161-2.3404c60.494-19.1 81.754-20.83 94.804-20.19 13.05 0.63657 22.281 13.049 44.88 45.832s67.48 123.49 116.23 123.49c48.746 0 93.626-90.709 116.23-123.49 22.599-32.783 31.83-45.195 44.88-45.832 13.05-0.63648 28.783-1.6248 89.26 17.472"/><path id="path4315" fill="#343434" d="m570.99 652.48c-60.477-19.097-76.074-18.269-89.124-17.633-13.05 0.63658-22.281 14.832-44.88 47.614-22.599 32.783-67.48 125.27-116.23 125.27-48.746 0-93.626-92.491-116.23-125.27-22.599-32.783-31.83-46.978-44.88-47.614-13.05-0.63648-34.715 1.2996-95.192 20.396l1.1161-2.3404c60.474-19.1 81.024-22.26 94.074-21.62 13.05 0.63658 22.281 13.049 44.88 45.832s67.48 123.49 116.23 123.49c48.746 0 93.626-90.709 116.23-123.49 22.599-32.783 31.83-45.195 44.88-45.832 13.05-0.63647 27.71-0.17274 88.186 18.924"/></g><g id="g15645" transform="matrix(.75439 0 0 1 1558.5 -6638.3)" fill-rule="evenodd"><rect id="rect15584" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="2" ry="1.8461" height="44.307" width="570" y="6558.3" x="100.71" fill="#4164bb"/><rect id="rect15331" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="2" ry="1.8461" height="44.307" width="570" y="6554.6" x="100.71" fill="#5276cf"/></g><text id="text15623-9" style="word-spacing:0px;letter-spacing:0px" font-weight="300" xml:space="preserve" font-size="22px" line-height="430.99999428%" y="-53.755863" x="1792.7805" font-family="&apos;Noto Sans CJK TC&apos;" fill="#ffffff"><tspan id="tspan15625-5" y="-53.755863" x="1792.7805"/></text><text id="text15657" style="word-spacing:0px;letter-spacing:0px" font-weight="300" xml:space="preserve" font-size="13px" line-height="430.99999428%" y="-3.7607465" x="1670.2437" font-family="&apos;Noto Sans CJK TC&apos;" fill="#828282"><tspan id="tspan15659" y="-3.7607465" x="1670.2437"/></text><g id="g34" fill-rule="evenodd"><path id="path4675" fill="#303030" d="m551.75 628.4c9.3003 4.1796 8.2375 11.558 2.1302 9.9581-6.1073-1.6003-33.792-9.1405-46.239-11.577-12.446-2.4363-34.904-3.0623-36.951-4.0165-2.0474-0.95416 0.93313-7.7247 5.491-7.3449 23.258 0.91012 59.905 6.0339 75.569 12.98z"/><path id="path4677" fill="#303030" d="m474.88 602.61c3.6488 0.63684 4.1169 1.3708 2.4115 5.2499-0.80967 1.8416-1.261 3.904-3.4715 3.7336-4.456-0.34344-16.578-1.2846-25.692-1.3764-9.1139-0.0918-23.83 1.217-25.307 0.79399-1.4771-0.42301-1.8834-4.9141 1.7769-6.7458 4.6221-1.3593 38.698-3.2021 50.281-1.6553z"/><path id="path4699" opacity=".384" fill="url(#linearGradient4701)" d="m475.53 611.7c-11.693-0.63604-8.4597-0.73151-44.068 54.448-6.5182 8.6489-22.874 37.231-36.865 35.326-6.7491-1.4177 15.436-67.299 22.724-75.767 11.112-12.911 19.255-16.122 58.209-14.007z"/><path id="path4703" fill="#303030" d="m84.068 628.4c-9.3003 4.1796-8.2375 11.558-2.1302 9.9581 6.1073-1.6003 33.792-9.1405 46.239-11.577 12.446-2.4363 34.904-3.0623 36.951-4.0165 2.0474-0.95416-0.93313-7.7247-5.491-7.3449-23.258 0.91012-59.905 6.0339-75.569 12.98z"/><path id="path4705" fill="#303030" d="m161.86 602.61c-3.6488 0.63684-4.1169 1.3708-2.4115 5.2499 0.80967 1.8416 1.261 3.904 3.4715 3.7336 4.456-0.34344 16.578-1.2846 25.692-1.3764 9.1139-0.0918 23.83 1.217 25.307 0.79399 1.4771-0.42301 1.8834-4.9141-1.7769-6.7458-4.6221-1.3593-38.698-3.2021-50.281-1.6553z"/><path id="path4711" opacity=".384" fill="url(#linearGradient4713)" d="m161.2 611.7c11.693-0.63604 8.4597-0.73151 44.068 54.448 6.5182 8.6489 22.874 37.231 36.865 35.326 6.7491-1.4177-15.436-67.299-22.724-75.767-11.112-12.911-19.255-16.122-58.209-14.007z"/><path id="path4717" opacity=".115" fill="url(#linearGradient4725)" d="m413.37 645.84c-9.0496 10.007-29.401 19.937-36.775 19.937h-52.205c-31.171 0-37.359 0.34506-47.75 0.51758-10.39 0.17253-18.682 0.65628-23.653-3.278-5.0513-3.9977-24-15.425-24-15.425 53.346 4.1464 144.49 4.3368 184.38-1.7523z"/></g></g><g id="layer1-0" fill-rule="evenodd" transform="translate(159.08 -720.76)"><g id="g4527-3" transform="translate(-961.22,330.69)"><ellipse id="circle4233-8" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="circle4235-8" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="circle4237-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g><g id="g4523-1" transform="translate(-961.22,330.69)"><ellipse id="circle4239-4" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="circle4243-3" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g><g id="g3506" transform="translate(-961.22,330.69)"><ellipse id="ellipse3508" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="ellipse3510" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="ellipse3512" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g></g><g id="layer1-7" fill-rule="evenodd" transform="translate(352.57 -719.72)"><g id="g4527-3-4" transform="translate(-961.22,330.69)"><ellipse id="circle4233-8-8" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="circle4235-8-9" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="circle4237-7-3" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g><g id="g4523-1-1" transform="translate(-961.22,330.69)"><ellipse id="circle4239-4-4" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="circle4243-3-5" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g><g id="g3506-2" transform="translate(-961.22,330.69)"><ellipse id="ellipse3508-1" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="ellipse3510-1" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="ellipse3512-4" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g></g></svg>')+
"');width: 637px;height: 455px;background-size: 100% 100%;left: 50%;margin-bottom: 40px;-moz-transform: translateX(-50%);-ms-transform: translateX(-50%);-webkit-transform: translateX(-50%);bottom: 0px;";c.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3904" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="35.924mm" width="35.926mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 127.29808 127.28933"><metadata id="metadata3909"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -925.07)"><ellipse id="circle4330" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="63.649" ry="63.645" cy="988.72" cx="63.649" fill="#303030"/><ellipse id="circle4223" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="59.705" ry="59.701" cy="988.72" cx="63.649" fill="#4c4c4c"/></g></svg>')+
"');position: absolute;top: 47px;left: 65px;width: 135px;height: 135px;";d.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3754" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.711mm" width="9.9653mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 35.3101 37.950677"><metadata id="metadata3759"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1014.4)"><path id="path4326" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m34.81 1017.1c-15.254-3.8172-24.634-1.7612-34.31 0v16.247h0.015c-0.013 0.097-0.013 0.1951-0.015 0.2928 0.0006 9.4753 7.6813 18.256 17.156 18.256 9.4739-0.0005 17.154-8.7813 17.154-18.256 0-0.097-0.014-0.1952-0.014-0.2928h0.014z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>')+
"');width: 36px;height: 38px;left: 49px;top: 8px;position: absolute;";e.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3790" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.9646mm" width="10.711mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 37.953175 35.3077"><metadata id="metadata3795"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1017.1)"><path id="path4324" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m35.298 1017.6c3.8175 15.253 1.7611 24.633 0 34.308h-16.248v-0.015c-0.098 0.01-0.1952 0.01-0.2928 0.015-9.476-0.0006-18.258-7.6807-18.257-17.154 0.0005-9.4733 8.7818-17.153 18.257-17.153 0.098 0 0.1952 0.01 0.2928 0.011v-0.011z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>')+
"');width: 38px;height: 36px;top: 47px;left: 84px;position: absolute;";f.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3754" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.711mm" width="9.9653mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 35.3101 37.950677"><metadata id="metadata3759"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1014.4)"><path id="path4328" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m34.81 1049.7c-15.254 3.8172-24.634 1.7612-34.31 0v-16.247h0.015c-0.013-0.097-0.013-0.1951-0.015-0.2928 0.0006-9.4753 7.6813-18.256 17.156-18.256 9.4739 0.0005 17.154 8.7813 17.154 18.256 0 0.097-0.014 0.1952-0.014 0.2928h0.014z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>')+
"');width: 36px;height: 38px;bottom: 11px;left: 51px;position: absolute;";k.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3790" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.9646mm" width="10.711mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 37.953175 35.3077"><metadata id="metadata3795"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1017.1)"><path id="path4324" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m2.6552 1051.9c-3.8175-15.253-1.7611-24.633 0-34.308h16.248v0.015c0.098-0.01 0.1952-0.01 0.2928-0.015 9.476 0.0006 18.258 7.6807 18.257 17.154-0.0005 9.4733-8.7818 17.153-18.257 17.153-0.098 0-0.1952-0.01-0.2928-0.011v0.011z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>')+
"');width: 38px;height: 36px;top: 47px;left: 13px;position: absolute;";m.style.cssText="position: absolute;top: 55px;left: 434px;width: 150px;height: 150px;";n.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>')+
"');width: 50px;height: 50px;left: 53px;top: 0px;position: absolute;";p.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>')+
"');width: 50px;height: 50px;left: 107px;top: 51px;position: absolute;";r.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>')+
"');width: 50px;height: 50px;left: 53px;bottom: 0px;position: absolute;";u.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>')+
"');width: 50px;height: 50px;top: 51px;position: absolute;";t.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3461" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="22.608mm" width="22.61mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 80.114398 80.108405"><metadata id="metadata3466"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(.0000019915 -972.25)"><g id="g3514-7" fill-rule="evenodd" transform="translate(-987.45 356.91)"><ellipse id="ellipse3516-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="ellipse3518-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g></g></svg>')+
"');position: absolute;top: 222px;left: 183px;width: 85px;height: 85px;";v.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3461" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="22.608mm" width="22.61mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 80.114398 80.108405"><metadata id="metadata3466"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(.0000019915 -972.25)"><g id="g3514-7" fill-rule="evenodd" transform="translate(-987.45 356.91)"><ellipse id="ellipse3516-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="ellipse3518-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g></g></svg>')+
"');position: absolute;top: 223px;left: 376px;width: 85px;height: 85px;";y.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3699" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2811mm" width="9.2817mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.8879 32.88565"><metadata id="metadata3704"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -1019.5)"><ellipse id="ellipse4575" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="16.444" ry="16.443" cy="1035.9" cx="16.444" fill="#2e2e2e"/><ellipse id="ellipse4577" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="15.112" ry="15.11" stroke="#4364b2" cy="1035.9" cx="16.444" fill="#5276cf"/><ellipse id="ellipse4579" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="11.867" ry="11.866" cy="1035.9" cx="16.444" fill="#434343"/></g></svg>')+
"');position: absolute;top: 76px;left: 227px;width: 34px;height: 34px;";A.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3699" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2811mm" width="9.2817mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.8879 32.88565"><metadata id="metadata3704"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -1019.5)"><ellipse id="ellipse4575" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="16.444" ry="16.443" cy="1035.9" cx="16.444" fill="#2e2e2e"/><ellipse id="ellipse4577" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="15.112" ry="15.11" stroke="#4364b2" cy="1035.9" cx="16.444" fill="#5276cf"/><ellipse id="ellipse4579" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="11.867" ry="11.866" cy="1035.9" cx="16.444" fill="#434343"/></g></svg>')+
"');position: absolute;top: 76px;left: 376px;width: 34px;height: 34px;";D.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="21.241671mm" height="8.8544388mm" viewBox="0 0 75.265762 31.373996" id="svg3447" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="l1.svg"><defs id="defs3449" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.4" inkscape:cx="-254.57869" inkscape:cy="228.81952" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3452"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(1.5000945e-8,-1020.9882)"><path style="fill:#5276cf;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" d="m 11.026383,1051.1651 c -7.4440599,1.9144 -7.5133499,2.2466 -9.7963799,-4.4934 -1.81058997,-5.3452 -2.44278,-8.8152 4.01547,-12.116 2.74038,-1.4007 13.7365799,-5.877 38.4768299,-10.72 24.26031,-4.749 25.16653,-2.7967 26.79132,0.3418 1.15503,2.2311 1.8961,4.1561 2.94279,6.651 3.08552,8.5188 2.92609,8.5778 -6.08214,9.5501 -19.09891,2.1414 -37.95723,5.8307 -56.34789,10.7865 z" id="path4289" inkscape:connector-curvature="0" sodipodi:nodetypes="cssssccc" /></g></svg>')+
"');position: absolute;top: 4px;left: 78px;width: 79px;height: 33px;";B.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3447" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="8.8544mm" width="21.242mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 75.265762 31.373996"><metadata id="metadata3452"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(1.5001e-8 -1021)"><path id="path4715" d="m64.239 1051.2c7.4441 1.9144 7.5134 2.2466 9.7964-4.4934 1.8106-5.3452 2.4428-8.8152-4.0155-12.116-2.7404-1.4007-13.737-5.877-38.477-10.72-24.26-4.749-25.167-2.7967-26.791 0.3418-1.155 2.2311-1.8961 4.1561-2.9428 6.651-3.0855 8.5188-2.9261 8.5778 6.0822 9.5501 19.099 2.1414 37.957 5.8307 56.348 10.786z" fill-rule="evenodd" fill="#5276cf"/></g></svg>')+
"');position: absolute;top: 4px;left: 477px;width: 79px;height: 33px;";G.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3560" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="4.7796mm" width="13.57mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 48.082162 16.935645"><metadata id="metadata3565"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1035.4)"><path id="path4727" d="m42.857 1052.2c4.7071 0.4081 4.7981 0.6563 5.1414-4.9139 0.16344-2.6517 0.16699-6.1108-0.72615-8.0342-0.59471-1.2808-1.7793-2.049-3.7642-2.4662-2.5264-0.531-16.253-1.4345-26.685-1.3241-15.118 0.16-15.362 1.4769-15.855 4.1522-0.35071 1.9018-0.5016 3.5056-0.74837 5.5967-0.55261 7.0693-0.44908 7.0921 5.0452 6.5411 11.661-1.1062 25.929-0.7359 37.592 0.4484z" fill-rule="evenodd" fill="#5276cf"/></g></svg>')+
"');position: absolute;top: -7px;left: 425px;width: 50px;height: 17px;";J.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3560" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="4.7796mm" width="13.57mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 48.082162 16.935645"><metadata id="metadata3565"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1035.4)"><path id="path4727" d="m42.857 1052.2c4.7071 0.4081 4.7981 0.6563 5.1414-4.9139 0.16344-2.6517 0.16699-6.1108-0.72615-8.0342-0.59471-1.2808-1.7793-2.049-3.7642-2.4662-2.5264-0.531-16.253-1.4345-26.685-1.3241-15.118 0.16-15.362 1.4769-15.855 4.1522-0.35071 1.9018-0.5016 3.5056-0.74837 5.5967-0.55261 7.0693-0.44908 7.0921 5.0452 6.5411 11.661-1.1062 25.929-0.7359 37.592 0.4484z" fill-rule="evenodd" fill="#5276cf"/></g></svg>')+
"');position: absolute;top: -7px;left: 164px;width: 50px;height: 17px;";H.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="24.603382mm" height="24.601696mm" viewBox="0 0 87.177338 87.171363" id="svg3640" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="main.svg"><defs id="defs3642" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.979899" inkscape:cx="61.113463" inkscape:cy="69.71796" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3645"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(0,-965.19093)"><ellipse ry="43.585682" rx="43.588669" style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#2e2e2e;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="ellipse4372" cx="43.588669" cy="1008.7766" /><ellipse cy="1008.7766" cx="43.588669" id="circle4239-1" style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#5276cf;fill-opacity:1;fill-rule:evenodd;stroke:#4364b2;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" rx="40.056705" ry="40.053959" /><ellipse style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#434343;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="circle4243-0" cx="43.588669" cy="1008.7766" rx="31.455994" ry="31.453836" /></g></svg>')+
"');position: absolute;top: 68px;left: 274px;width: 92px;height: 92px;";F.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3407" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="41.787mm" width="41.786mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 148.0624 148.06251"><metadata id="metadata3412"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -904.3)" fill="#e6e6e6"><path id="rect4545" d="m74.031 904.3-14.469 22.156h8.0313v8.2187h12.875v-8.2187h8.0625l-14.5-22.156z"/><path id="rect4603" d="m125.94 963.86v8.0313h-8.25v12.906h8.25v8.0313l22.125-14.5-22.125-14.469z"/><path id="rect4609" d="m67.594 1022v8.25h-8.0313l14.469 22.125 14.5-22.125h-8.0625v-8.25h-12.875z"/><path id="rect4615" d="m22.156 963.86-22.156 14.47l22.156 14.5v-8.2188h8.2188v-12.906h-8.2188v-7.8438z"/><path id="path4619" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m54.393 924.58c-15.821 5.7885-28.404 18.385-34.188 34.219h11.156c4.6667-10.175 12.865-18.361 23.031-23.031v-11.188zm39.219 0.031v11.156c10.167 4.6713 18.361 12.86 23.031 23.031h11.156c-5.7846-15.821-18.379-28.393-34.188-34.188zm-73.375 73.438c5.7899 15.816 18.348 28.403 34.156 34.188v-11.156c-10.163-4.6691-18.364-12.861-23.031-23.031h-11.125zm96.406 0c-4.6712 10.167-12.868 18.361-23.031 23.031v11.125c15.796-5.7901 28.366-18.352 34.156-34.156h-11.125z"/></g></svg>')+
"');position: absolute;top: 186px;left: 148px;width: 157px;height: 157px;";I.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3407" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="41.787mm" width="41.786mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 148.0624 148.06251"><metadata id="metadata3412"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -904.3)" fill="#e6e6e6"><path id="rect4545" d="m74.031 904.3-14.469 22.156h8.0313v8.2187h12.875v-8.2187h8.0625l-14.5-22.156z"/><path id="rect4603" d="m125.94 963.86v8.0313h-8.25v12.906h8.25v8.0313l22.125-14.5-22.125-14.469z"/><path id="rect4609" d="m67.594 1022v8.25h-8.0313l14.469 22.125 14.5-22.125h-8.0625v-8.25h-12.875z"/><path id="rect4615" d="m22.156 963.86-22.156 14.47l22.156 14.5v-8.2188h8.2188v-12.906h-8.2188v-7.8438z"/><path id="path4619" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m54.393 924.58c-15.821 5.7885-28.404 18.385-34.188 34.219h11.156c4.6667-10.175 12.865-18.361 23.031-23.031v-11.188zm39.219 0.031v11.156c10.167 4.6713 18.361 12.86 23.031 23.031h11.156c-5.7846-15.821-18.379-28.393-34.188-34.188zm-73.375 73.438c5.7899 15.816 18.348 28.403 34.156 34.188v-11.156c-10.163-4.6691-18.364-12.861-23.031-23.031h-11.125zm96.406 0c-4.6712 10.167-12.868 18.361-23.031 23.031v11.125c15.796-5.7901 28.366-18.352 34.156-34.156h-11.125z"/></g></svg>')+
"');position: absolute;top: 187px;left: 339px;width: 157px;height: 157px;";b.appendChild(F);b.appendChild(I);c.appendChild(d);c.appendChild(e);c.appendChild(f);c.appendChild(k);b.appendChild(c);m.appendChild(n);m.appendChild(p);m.appendChild(r);m.appendChild(u);b.appendChild(m);b.appendChild(t);b.appendChild(v);b.appendChild(y);b.appendChild(A);b.appendChild(D);b.appendChild(B);b.appendChild(G);a.appendChild(b);b.appendChild(J);b.appendChild(H);L.length=0;E.length=0;q.length=0;w.length=0;L.push(r,
p,u,n,D,B,J,G,y,A,t,v,d,f,k,e,H);E.push('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>',
'<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>',
'<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>',
'<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="21.241671mm" height="8.8544388mm" viewBox="0 0 75.265762 31.373996" id="svg3447" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="l1.svg"><defs id="defs3449" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.4" inkscape:cx="-254.57869" inkscape:cy="228.81952" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3452"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(1.5000945e-8,-1020.9882)"><path style="fill:#5276cf;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" d="m 11.026383,1051.1651 c -7.4440599,1.9144 -7.5133499,2.2466 -9.7963799,-4.4934 -1.81058997,-5.3452 -2.44278,-8.8152 4.01547,-12.116 2.74038,-1.4007 13.7365799,-5.877 38.4768299,-10.72 24.26031,-4.749 25.16653,-2.7967 26.79132,0.3418 1.15503,2.2311 1.8961,4.1561 2.94279,6.651 3.08552,8.5188 2.92609,8.5778 -6.08214,9.5501 -19.09891,2.1414 -37.95723,5.8307 -56.34789,10.7865 z" id="path4289" inkscape:connector-curvature="0" sodipodi:nodetypes="cssssccc" /></g></svg>',
'<svg id="svg3447" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="8.8544mm" width="21.242mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 75.265762 31.373996"><metadata id="metadata3452"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(1.5001e-8 -1021)"><path id="path4715" d="m64.239 1051.2c7.4441 1.9144 7.5134 2.2466 9.7964-4.4934 1.8106-5.3452 2.4428-8.8152-4.0155-12.116-2.7404-1.4007-13.737-5.877-38.477-10.72-24.26-4.749-25.167-2.7967-26.791 0.3418-1.155 2.2311-1.8961 4.1561-2.9428 6.651-3.0855 8.5188-2.9261 8.5778 6.0822 9.5501 19.099 2.1414 37.957 5.8307 56.348 10.786z" fill-rule="evenodd" fill="#5276cf"/></g></svg>',
'<svg id="svg3560" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="4.7796mm" width="13.57mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 48.082162 16.935645"><metadata id="metadata3565"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1035.4)"><path id="path4727" d="m42.857 1052.2c4.7071 0.4081 4.7981 0.6563 5.1414-4.9139 0.16344-2.6517 0.16699-6.1108-0.72615-8.0342-0.59471-1.2808-1.7793-2.049-3.7642-2.4662-2.5264-0.531-16.253-1.4345-26.685-1.3241-15.118 0.16-15.362 1.4769-15.855 4.1522-0.35071 1.9018-0.5016 3.5056-0.74837 5.5967-0.55261 7.0693-0.44908 7.0921 5.0452 6.5411 11.661-1.1062 25.929-0.7359 37.592 0.4484z" fill-rule="evenodd" fill="#5276cf"/></g></svg>',
'<svg id="svg3560" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="4.7796mm" width="13.57mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 48.082162 16.935645"><metadata id="metadata3565"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1035.4)"><path id="path4727" d="m42.857 1052.2c4.7071 0.4081 4.7981 0.6563 5.1414-4.9139 0.16344-2.6517 0.16699-6.1108-0.72615-8.0342-0.59471-1.2808-1.7793-2.049-3.7642-2.4662-2.5264-0.531-16.253-1.4345-26.685-1.3241-15.118 0.16-15.362 1.4769-15.855 4.1522-0.35071 1.9018-0.5016 3.5056-0.74837 5.5967-0.55261 7.0693-0.44908 7.0921 5.0452 6.5411 11.661-1.1062 25.929-0.7359 37.592 0.4484z" fill-rule="evenodd" fill="#5276cf"/></g></svg>',
'<svg id="svg3699" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2811mm" width="9.2817mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.8879 32.88565"><metadata id="metadata3704"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -1019.5)"><ellipse id="ellipse4575" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="16.444" ry="16.443" cy="1035.9" cx="16.444" fill="#2e2e2e"/><ellipse id="ellipse4577" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="15.112" ry="15.11" stroke="#4364b2" cy="1035.9" cx="16.444" fill="#5276cf"/><ellipse id="ellipse4579" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="11.867" ry="11.866" cy="1035.9" cx="16.444" fill="#434343"/></g></svg>',
'<svg id="svg3699" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2811mm" width="9.2817mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.8879 32.88565"><metadata id="metadata3704"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -1019.5)"><ellipse id="ellipse4575" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="16.444" ry="16.443" cy="1035.9" cx="16.444" fill="#2e2e2e"/><ellipse id="ellipse4577" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="15.112" ry="15.11" stroke="#4364b2" cy="1035.9" cx="16.444" fill="#5276cf"/><ellipse id="ellipse4579" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="11.867" ry="11.866" cy="1035.9" cx="16.444" fill="#434343"/></g></svg>',
'<svg id="svg3461" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="22.608mm" width="22.61mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 80.114398 80.108405"><metadata id="metadata3466"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(.0000019915 -972.25)"><g id="g3514-7" fill-rule="evenodd" transform="translate(-987.45 356.91)"><ellipse id="ellipse3516-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="ellipse3518-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g></g></svg>',
'<svg id="svg3461" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="22.608mm" width="22.61mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 80.114398 80.108405"><metadata id="metadata3466"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(.0000019915 -972.25)"><g id="g3514-7" fill-rule="evenodd" transform="translate(-987.45 356.91)"><ellipse id="ellipse3516-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="ellipse3518-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g></g></svg>',
'<svg id="svg3754" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.711mm" width="9.9653mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 35.3101 37.950677"><metadata id="metadata3759"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1014.4)"><path id="path4326" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m34.81 1017.1c-15.254-3.8172-24.634-1.7612-34.31 0v16.247h0.015c-0.013 0.097-0.013 0.1951-0.015 0.2928 0.0006 9.4753 7.6813 18.256 17.156 18.256 9.4739-0.0005 17.154-8.7813 17.154-18.256 0-0.097-0.014-0.1952-0.014-0.2928h0.014z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',
'<svg id="svg3754" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.711mm" width="9.9653mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 35.3101 37.950677"><metadata id="metadata3759"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1014.4)"><path id="path4328" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m34.81 1049.7c-15.254 3.8172-24.634 1.7612-34.31 0v-16.247h0.015c-0.013-0.097-0.013-0.1951-0.015-0.2928 0.0006-9.4753 7.6813-18.256 17.156-18.256 9.4739 0.0005 17.154 8.7813 17.154 18.256 0 0.097-0.014 0.1952-0.014 0.2928h0.014z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',
'<svg id="svg3790" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.9646mm" width="10.711mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 37.953175 35.3077"><metadata id="metadata3795"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1017.1)"><path id="path4324" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m2.6552 1051.9c-3.8175-15.253-1.7611-24.633 0-34.308h16.248v0.015c0.098-0.01 0.1952-0.01 0.2928-0.015 9.476 0.0006 18.258 7.6807 18.257 17.154-0.0005 9.4733-8.7818 17.153-18.257 17.153-0.098 0-0.1952-0.01-0.2928-0.011v0.011z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',
'<svg id="svg3790" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.9646mm" width="10.711mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 37.953175 35.3077"><metadata id="metadata3795"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1017.1)"><path id="path4324" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m35.298 1017.6c3.8175 15.253 1.7611 24.633 0 34.308h-16.248v-0.015c-0.098 0.01-0.1952 0.01-0.2928 0.015-9.476-0.0006-18.258-7.6807-18.257-17.154 0.0005-9.4733 8.7818-17.153 18.257-17.153 0.098 0 0.1952 0.01 0.2928 0.011v-0.011z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="24.603382mm" height="24.601696mm" viewBox="0 0 87.177338 87.171363" id="svg3640" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="main.svg"><defs id="defs3642" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.979899" inkscape:cx="61.113463" inkscape:cy="69.71796" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3645"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(0,-965.19093)"><ellipse ry="43.585682" rx="43.588669" style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#2e2e2e;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="ellipse4372" cx="43.588669" cy="1008.7766" /><ellipse cy="1008.7766" cx="43.588669" id="circle4239-1" style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#5276cf;fill-opacity:1;fill-rule:evenodd;stroke:#4364b2;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" rx="40.056705" ry="40.053959" /><ellipse style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#434343;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="circle4243-0" cx="43.588669" cy="1008.7766" rx="31.455994" ry="31.453836" /></g></svg>');
q.push(t,t,v,v);w.push(F,I);for(a=0;a<L.length;a++)L[a].setAttribute("id","pad_btn_"+a),L[a].setAttribute("data-colorstate","B"),L[a].setAttribute("data-key",a),L[a].setAttribute("data-svgid",a);F.setAttribute("id","pad_left_axis");F.setAttribute("data-colorstate","GR");F.setAttribute("data-key",C.GMPD_AXIS_0);F.setAttribute("data-svgid",E.length);I.setAttribute("id","pad_right_axis");I.setAttribute("data-colorstate","GR");I.setAttribute("data-key",C.GMPD_AXIS_2);I.setAttribute("data-svgid",E.length+
1);E.push('<svg id="svg3407" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="41.787mm" width="41.786mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 148.0624 148.06251"><metadata id="metadata3412"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -904.3)" fill="#e6e6e6"><path id="rect4545" d="m74.031 904.3-14.469 22.156h8.0313v8.2187h12.875v-8.2187h8.0625l-14.5-22.156z"/><path id="rect4603" d="m125.94 963.86v8.0313h-8.25v12.906h8.25v8.0313l22.125-14.5-22.125-14.469z"/><path id="rect4609" d="m67.594 1022v8.25h-8.0313l14.469 22.125 14.5-22.125h-8.0625v-8.25h-12.875z"/><path id="rect4615" d="m22.156 963.86-22.156 14.47l22.156 14.5v-8.2188h8.2188v-12.906h-8.2188v-7.8438z"/><path id="path4619" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m54.393 924.58c-15.821 5.7885-28.404 18.385-34.188 34.219h11.156c4.6667-10.175 12.865-18.361 23.031-23.031v-11.188zm39.219 0.031v11.156c10.167 4.6713 18.361 12.86 23.031 23.031h11.156c-5.7846-15.821-18.379-28.393-34.188-34.188zm-73.375 73.438c5.7899 15.816 18.348 28.403 34.156 34.188v-11.156c-10.163-4.6691-18.364-12.861-23.031-23.031h-11.125zm96.406 0c-4.6712 10.167-12.868 18.361-23.031 23.031v11.125c15.796-5.7901 28.366-18.352 34.156-34.156h-11.125z"/></g></svg>',
'<svg id="svg3407" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="41.787mm" width="41.786mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 148.0624 148.06251"><metadata id="metadata3412"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -904.3)" fill="#e6e6e6"><path id="rect4545" d="m74.031 904.3-14.469 22.156h8.0313v8.2187h12.875v-8.2187h8.0625l-14.5-22.156z"/><path id="rect4603" d="m125.94 963.86v8.0313h-8.25v12.906h8.25v8.0313l22.125-14.5-22.125-14.469z"/><path id="rect4609" d="m67.594 1022v8.25h-8.0313l14.469 22.125 14.5-22.125h-8.0625v-8.25h-12.875z"/><path id="rect4615" d="m22.156 963.86-22.156 14.47l22.156 14.5v-8.2188h8.2188v-12.906h-8.2188v-7.8438z"/><path id="path4619" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m54.393 924.58c-15.821 5.7885-28.404 18.385-34.188 34.219h11.156c4.6667-10.175 12.865-18.361 23.031-23.031v-11.188zm39.219 0.031v11.156c10.167 4.6713 18.361 12.86 23.031 23.031h11.156c-5.7846-15.821-18.379-28.393-34.188-34.188zm-73.375 73.438c5.7899 15.816 18.348 28.403 34.156 34.188v-11.156c-10.163-4.6691-18.364-12.861-23.031-23.031h-11.125zm96.406 0c-4.6712 10.167-12.868 18.361-23.031 23.031v11.125c15.796-5.7901 28.366-18.352 34.156-34.156h-11.125z"/></g></svg>');
l(L,z);l(w,"#e6e6e6")}function p(a){return[f.create_gamepad_btn_sensor(C.GMPD_BUTTON_0,a),f.create_gamepad_btn_sensor(C.GMPD_BUTTON_1,a),f.create_gamepad_btn_sensor(C.GMPD_BUTTON_2,a),f.create_gamepad_btn_sensor(C.GMPD_BUTTON_3,a),f.create_gamepad_btn_sensor(C.GMPD_BUTTON_4,a),f.create_gamepad_btn_sensor(C.GMPD_BUTTON_5,a),f.create_gamepad_btn_sensor(C.GMPD_BUTTON_6,a),f.create_gamepad_btn_sensor(C.GMPD_BUTTON_7,a),f.create_gamepad_btn_sensor(C.GMPD_BUTTON_8,a),f.create_gamepad_btn_sensor(C.GMPD_BUTTON_9,
a),f.create_gamepad_btn_sensor(C.GMPD_BUTTON_10,a),f.create_gamepad_btn_sensor(C.GMPD_BUTTON_11,a),f.create_gamepad_btn_sensor(C.GMPD_BUTTON_12,a),f.create_gamepad_btn_sensor(C.GMPD_BUTTON_13,a),f.create_gamepad_btn_sensor(C.GMPD_BUTTON_14,a),f.create_gamepad_btn_sensor(C.GMPD_BUTTON_15,a),f.create_gamepad_btn_sensor(C.GMPD_BUTTON_16,a),f.create_gamepad_btn_sensor(C.GMPD_BUTTON_17,a),f.create_gamepad_btn_sensor(C.GMPD_BUTTON_18,a),f.create_gamepad_btn_sensor(C.GMPD_BUTTON_19,a),f.create_gamepad_btn_sensor(C.GMPD_BUTTON_20,
a),f.create_gamepad_btn_sensor(C.GMPD_BUTTON_21,a),f.create_gamepad_btn_sensor(C.GMPD_BUTTON_22,a),f.create_gamepad_btn_sensor(C.GMPD_BUTTON_23,a),f.create_gamepad_btn_sensor(C.GMPD_BUTTON_24,a),f.create_gamepad_btn_sensor(C.GMPD_BUTTON_25,a)]}function u(a){return[f.create_gamepad_axis_sensor(C.GMPD_AXIS_0,a),f.create_gamepad_axis_sensor(C.GMPD_AXIS_1,a),f.create_gamepad_axis_sensor(C.GMPD_AXIS_2,a),f.create_gamepad_axis_sensor(C.GMPD_AXIS_3,a),f.create_gamepad_axis_sensor(C.GMPD_AXIS_4,a),f.create_gamepad_axis_sensor(C.GMPD_AXIS_5,
a),f.create_gamepad_axis_sensor(C.GMPD_AXIS_6,a),f.create_gamepad_axis_sensor(C.GMPD_AXIS_7,a),f.create_gamepad_axis_sensor(C.GMPD_AXIS_8,a),f.create_gamepad_axis_sensor(C.GMPD_AXIS_9,a),f.create_gamepad_axis_sensor(C.GMPD_AXIS_10,a),f.create_gamepad_axis_sensor(C.GMPD_AXIS_11,a)]}function a(a,b){var c=document.createElement("input");c.style.cssText="display: inline-block;position = relative;";c.setAttribute("type","radio");c.setAttribute("name","choice");var d=document.createElement("label");d.textContent=
b;d.style.cssText="position = relative;display: inline-block;color: white;";a.appendChild(c);a.appendChild(d);return c}function B(a){U.removeChild(K);K=null;switch(a){case "PAD":Y.checked=!0;r(U);break;case "WHEEL":v.checked=!0;var b=U;ea=!1;var c=document.createElement("div"),d=document.createElement("div"),e=document.createElement("div"),f=document.createElement("div"),k=document.createElement("div"),m=document.createElement("div"),n=document.createElement("div"),p=document.createElement("div"),
u=document.createElement("div"),t=document.createElement("div"),y=document.createElement("div"),A=document.createElement("div"),D=document.createElement("div"),B=document.createElement("div"),G=document.createElement("div"),J=document.createElement("div"),H=document.createElement("div"),F=document.createElement("div"),I=document.createElement("div"),M=document.createElement("div"),T=document.createElement("div"),S=document.createElement("div"),O=document.createElement("div"),R=document.createElement("div");
a=document.createElement("div");var V=document.createElement("div"),fa=document.createElement("div"),ha=document.createElement("div"),g=document.createElement("div"),sa=document.createElement("div");K=c;var Ba="position: absolute;height: auto;background-image: url('data:image/svg+xml;base64,"+btoa('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>')+
"');width: 19px;height: 19px;background-size: 100% 100%;";c.style.cssText="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="112.08413mm" height="128.46834mm" viewBox="0 0 397.14849 455.20277" id="svg3440" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel.svg"><defs id="defs3442" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="0.98994949" inkscape:cx="421.01508" inkscape:cy="52.510802" inkscape:document-units="px" inkscape:current-layer="g87" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3445"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title /></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(-2.3645008e-8,-597.15942)"><path inkscape:connector-curvature="0" style="fill:#4d4d4d;stroke:#6e6e6e;stroke-width:2.99125171;stroke-miterlimit:4;stroke-dasharray:none" id="path4140" d="m 307.84153,715.52552 c -4.35995,43.11849 -2.78952,86.66385 -15.90234,128.54337 -10.85452,25.86023 -13.33477,47.2976 6.91492,61.09536 7.23778,50.7442 78.38013,47.39232 82.20535,0 23.06079,-14.19054 13.49405,-42.79138 6.91492,-61.09536 -17.40045,-40.83001 -4.82581,-86.43019 -15.90235,-128.54337 -8.3177,-20.33228 -56.75348,-20.7661 -64.22927,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#cccccc;stroke:#1a1a1a;stroke-width:2.09465766;stroke-miterlimit:4;stroke-dasharray:none" id="path4266" d="m 313.11812,724.1957 -3.84514,68.80568 c 4.64168,13.40814 62.19981,10.8172 61.83082,0 l -3.84515,-68.80568 c -4.46942,-24.00369 -52.58756,-18.95946 -54.13979,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#353535;stroke:#2c2c2c;stroke-width:2.11880326;stroke-miterlimit:4;stroke-dasharray:none" id="path4156" d="m 304.91419,870.673 c -12.36924,67.40381 80.42804,69.69607 70.55134,0 -6.57605,-36.5947 -65.0964,-34.8253 -70.55134,0 z m 60.53812,3.9862 c 8.65841,48.24354 -57.58987,49.86644 -50.52489,0 4.7009,-26.27069 46.6394,-24.84292 50.52489,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#e6e6e6;stroke:#969696;stroke-width:2.99125171;stroke-miterlimit:4;stroke-dasharray:none" id="path4011" d="m 106.04576,696.97906 c -11.197076,4.25792 -17.123706,8.24834 -17.123706,8.24834 l -66.18493,16.33946 1.40291,30.64619 46.54715,-7.67623 c 17.00932,-1.6438 32.551896,8.94676 38.302026,23.34506 l 2.78663,65.4778 27.6363,0 2.78663,-65.4778 c 8.0428,-15.3291 20.46247,-27.10803 38.30202,-23.34506 l 46.54716,7.67623 1.40291,-30.64619 -66.18493,-16.33946 c 0,0 -5.92627,-3.99074 -17.12371,-8.24834 -13.45408,-4.31874 -26.62772,-4.20804 -39.08982,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#252525;stroke:#6e6e6e;stroke-width:2.99125171;stroke-miterlimit:4;stroke-dasharray:none" id="path2996" d="m 38.311064,931.09899 c -8.01574,5.05649 -22.76006,21.74743 -26.34852,58.0567 -4.1290804,35.18581 -4.8394604,60.59901 28.55878,61.68771 l 162.934726,0 c 39.19437,1.1693 30.46155,-41.5992 28.55878,-61.68771 -3.58839,-36.30927 -18.33277,-52.99983 -26.34851,-58.0567 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#373737;stroke:#6e6e6e;stroke-width:2.83429575;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none" id="path3019" d="m 26.230254,979.1291 c -11.50334,14.44882 -11.98241,47.3999 -0.33519,57.1202 l 191.802226,0 c 12.10111,-12.3068 9.93082,-46.99573 -0.33518,-57.1202 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#808080;stroke:#1a1a1a;stroke-width:2.14882827;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0" id="path4133" d="m 360.82498,854.6914 a 20.634815,21.265151 0 1 1 -41.269,0 20.634815,21.265151 0 1 1 41.269,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#333333;stroke:#000000;stroke-width:2.11880326;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0" id="path4280" d="m 351.64051,761.132 a 11.444622,11.75148 0 1 1 -22.88896,0 11.444622,11.75148 0 1 1 22.88896,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#313131;stroke:#565656;stroke-width:2.93434715;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0" id="path3993" d="m 125.52855,598.62659 c -68.528026,0 -124.0613764,57.81925 -124.0613764,129.13695 0,71.31265 55.5370404,129.13696 124.0613764,129.13696 68.52804,0 124.07984,-57.81926 124.07984,-129.13696 0,-71.31264 -55.55611,-129.13695 -124.07984,-129.13695 z m -1.00095,23.63932 c 10.01261,0.0734 20.238,1.32074 28.95237,3.51006 11.62203,3.80301 21.53624,8.52304 31.01135,16.15381 26.21752,19.0207 43.36275,50.36277 43.36275,85.83029 0,58.01564 -45.80548,105.05244 -102.30928,105.05244 -56.500726,0 -102.309276,-47.03364 -102.309276,-105.05244 0,-32.14848 14.06783,-60.91918 36.22336,-80.19121 11.45168,-11.11714 23.14136,-17.13322 37.3943,-21.79731 7.855846,-2.48302 17.655666,-3.5835 27.668276,-3.51006 z" stroke-miterlimit="4" /><g style="stroke-miterlimit:4;stroke-dasharray:none" id="g4127" stroke-miterlimit="4" transform="matrix(0.61498728,0,0,0.63147657,-18.171616,453.28593)"><g id="g4111"><path style="fill:#808080;stroke:#373737;stroke-width:3.56837296" inkscape:connector-curvature="0" id="rect3040" d="m 110.97,771.16 31.694,4.8776 1.3007,44.257 -32.995,0 z" /><path style="fill:#b3b3b3;stroke:#565656;stroke-width:3.4000001;stroke-linecap:butt;stroke-linejoin:miter" inkscape:connector-curvature="0" id="path3024" d="m 96.83,686.82 58.353,-5.0761 c 15.608,27.569 6.8304,64.333 -5.0761,90.545 l -53.841,-2.538 z" /></g><g id="g4115" transform="translate(97.984785,0)"><path style="fill:#808080;stroke:#373737;stroke-width:3.56837296" inkscape:connector-curvature="0" id="path4117" d="m 110.97,771.16 31.694,4.8776 1.3007,44.257 -32.995,0 z" /><path style="fill:#b3b3b3;stroke:#565656;stroke-width:3.4000001;stroke-linecap:butt;stroke-linejoin:miter" inkscape:connector-curvature="0" id="path4119" d="m 96.83,686.82 58.353,-5.0761 c 15.608,27.569 6.8304,64.333 -5.0761,90.545 l -53.841,-2.538 z" /></g><g id="g4121" transform="translate(195.96959,0)"><path style="fill:#808080;stroke:#373737;stroke-width:3.56837296" inkscape:connector-curvature="0" id="path4123" d="m 110.97,771.16 31.694,4.8776 1.3007,44.257 -32.995,0 z" /><path style="fill:#b3b3b3;stroke:#565656;stroke-width:3.4000001;stroke-linecap:butt;stroke-linejoin:miter" inkscape:connector-curvature="0" id="path4125" d="m 96.83,686.82 58.353,-5.0761 c 15.608,27.569 6.8304,64.333 -5.0761,90.545 l -53.841,-2.538 z" /></g></g><g style="fill:#666666;stroke:#969696;stroke-width:3.99777174;stroke-miterlimit:4;stroke-dasharray:none" id="g4051" transform="translate(-42.878584,98.083591)" stroke-miterlimit="4"><g id="g4437" transform="matrix(0.74686368,0,0,0.74686368,-73.374214,285.30447)"><path inkscape:connector-curvature="0" id="rect4348" style="color:#000000;text-indent:0;text-transform:none;block-progression:tb;fill:#ffffff" d="m 567.31,584.22 0,42.25 0,3.4062 0,42.25 3.375,0 0,-42.25 27.062,0 0,42.25 3.375,0 0,-42.25 27.062,0 0,42.25 3.375,0 0,-42.25 27.062,0 0,42.25 3.4062,0 0,-43.969 0,-1.6875 -1.7188,0 -28.75,0 0,-42.25 -3.375,0 0,42.25 -27.062,0 0,-42.25 -3.375,0 0,42.25 -27.062,0 0,-42.25 -3.375,0 z" /><g style="fill:#a02c2c;stroke:#ffffff;stroke-width:3.4000001;stroke-linecap:square" id="g87" /></g></g></g></svg>')+
"');width: 397px;height: 455px;-moz-transform: translateX(-50%);-ms-transform: translateX(-50%);-webkit-transform: translateX(-50%);transform: translateX(-50%);background-size: 100% 100%;left: 50%;margin-left: 25px;margin-bottom: 40px;bottom: 0px;";d.style.cssText=Ba+"top: 132px;left: 331px;";e.style.cssText=Ba+"top: 122px;left: 315px;";f.style.cssText=Ba+"top: 122px;left: 347px;";k.style.cssText=Ba+"top: 113px;left: 331px;";m.style.cssText="position: absolute;height: auto;background-image: url('data:image/svg+xml;base64,"+
btoa('<svg id="svg3400" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.507mm" width="15.1mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 53.504016 37.228838"><metadata id="metadata3405"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(-2.847e-7 -1015.1)"><path id="path4049" d="m26.584 1016.1c-12.631 0-23.15 9.858-25.478 22.922l50.705 12.18c0.47921-2.1565 0.73023-4.4099 0.73023-6.7204 0-15.677-11.621-28.382-25.957-28.382z" stroke="#5276cf" stroke-linecap="square" stroke-width="1.9247" fill="#666"/></g></svg>')+
"');width: 54px;height: 37px;background-size: 100% 100%;top: 84px;left: 166px;";n.style.cssText="position: absolute;height: auto;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3400" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.507mm" width="15.1mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 53.504016 37.228838"><metadata id="metadata3405"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(-2.847e-7 -1015.1)"><path id="path4033" d="m26.92 1016.1c-14.337 0-25.957 12.707-25.957 28.382 0 2.3225 0.26742 4.5784 0.74876 6.7386l50.681-12.18c-2.321-13.072-12.841-22.944-25.476-22.944z" stroke="#5276cf" stroke-linecap="square" stroke-width="1.9247" fill="#666"/></g></svg>')+
"');width: 54px;height: 37px;background-size: 100% 100%;top: 84px;left: 36px;";p.style.cssText=Ba+"top: 107px;left: 141px;";u.style.cssText=Ba+"top: 107px;left: 90px;";t.style.cssText=Ba+"top: 185px;left: 321px;";y.style.cssText=Ba+"top: 185px;left: 340px;";A.style.cssText=Ba+"top: 179px;left: 358px;";D.style.cssText=Ba+"top: 178px;left: 303px;";B.style.cssText=Ba+"top: 210px;left: 299px;";G.style.cssText=Ba+"top: 279px;left: 299px;";J.style.cssText=Ba+"top: 210px;left: 321px;";H.style.cssText=Ba+
"top: 279px;left: 321px;";F.style.cssText=Ba+"top: 210px;left: 344px;";I.style.cssText=Ba+"top: 278px;left: 344px;";M.style.cssText=Ba+"top: 124px;left: 147px;";T.style.cssText=Ba+"top: 138px;left: 133px;";S.style.cssText=Ba+"top: 124px;left: 82px;";O.style.cssText=Ba+"top: 138px;left: 96px;";R.style.cssText=Ba+"top: 278px;left: 367px;";Ba="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3386" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="12.859mm" width="5.2917mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 18.749999 45.562501"><metadata id="metadata3391"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1006.8)"><path id="rect4575" d="m9.3125 1006.8-9.3125 14.25h5.3125v17.094h-5.1875l9.3125 14.219 9.3125-14.219h-5.1562v-17.094h5.0312l-9.3125-14.25z" fill="#e6e6e6"/></g></svg>')+
"');width: 19px;height: 46px;background-size: 100% 100%;";a.style.cssText=Ba+"top: 291px;left: 50px;";V.style.cssText=Ba+"top: 291px;left: 111px;";fa.style.cssText=Ba+"top: 291px;left: 171px;";ha.style.cssText="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3458" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="50.447mm" width="83.899mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 297.28131 178.75"><metadata id="metadata3463"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -873.61)" fill="#e6e6e6"><path id="path4535" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m33.875 873.61-18.5 8.8125 5.0626 3.0625c-12.899 22.78-20.438 49.17-20.438 77.44 0 28.284 7.5315 54.691 20.438 77.469l-5.0626 3.0625 18.5 8.8125 0.6563-20.469-5.531 3.3c-12.002-21.2-18.937-45.8-18.937-72.18 0-26.362 6.9415-50.99 18.937-72.188l5.5313 3.3438-0.6563-20.469z"/><path id="path4551" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m263.38 873.71-0.6562 20.469 5.5312-3.3438c11.996 21.198 18.969 45.825 18.969 72.188 0 26.371-6.9672 51.011-18.969 72.219l-5.5312-3.3437 0.6562 20.469 18.5-8.8125-5.0312-3.0625c12.906-22.778 20.438-49.184 20.438-77.469 0-28.275-7.5391-54.665-20.438-77.438l5.0312-3.0625-18.5-8.8125z"/></g></svg>')+
"');width: 297px;height: 179px;background-size: 100% 100%;top: 43px;left: -25px;";g.style.cssText="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3378" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="2.9016mm" width="9.2516mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.781198 10.281199"><metadata id="metadata3383"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1042.1)"><path id="rect4585" d="m32.781 1047.2-7.875-5.125v2.8437h-17.031v-2.8437l-7.875 5.1 7.875 5.1562v-2.8437h17.031v2.8437z" fill="#e6e6e6"/></g></svg>')+
"');width: 33px;height: 10px;background-size: 100% 100%;top: 159px;left: 324px;";sa.style.cssText="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3378" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2516mm" width="2.9016mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 10.281248 32.7812"><metadata id="metadata3383"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1019.6)"><path id="rect4585" d="m5.125 1019.6-5.125 7.9h2.8437v17.031h-2.8437l5.125 7.875 5.1562-7.875h-2.8438v-17.031h2.8438z" fill="#e6e6e6"/></g></svg>')+
"');width: 10px;height: 33px;background-size: 100% 100%;top: 148px;left: 335px;";b.appendChild(c);c.appendChild(a);c.appendChild(V);c.appendChild(fa);c.appendChild(ha);c.appendChild(g);c.appendChild(sa);c.appendChild(d);c.appendChild(e);c.appendChild(f);c.appendChild(k);c.appendChild(m);c.appendChild(n);c.appendChild(p);c.appendChild(u);c.appendChild(t);c.appendChild(y);c.appendChild(A);c.appendChild(D);c.appendChild(B);c.appendChild(G);c.appendChild(J);c.appendChild(H);c.appendChild(F);c.appendChild(I);
c.appendChild(M);c.appendChild(T);c.appendChild(S);c.appendChild(O);c.appendChild(R);L.length=0;E.length=0;q.length=0;w.length=0;L.push(d,e,f,k,m,n,p,u,t,y,A,D,B,G,J,H,F,I,M,T,S,O,R);E.push('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg id="svg3400" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.507mm" width="15.1mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 53.504016 37.228838"><metadata id="metadata3405"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(-2.847e-7 -1015.1)"><path id="path4049" d="m26.584 1016.1c-12.631 0-23.15 9.858-25.478 22.922l50.705 12.18c0.47921-2.1565 0.73023-4.4099 0.73023-6.7204 0-15.677-11.621-28.382-25.957-28.382z" stroke="#5276cf" stroke-linecap="square" stroke-width="1.9247" fill="#666"/></g></svg>',
'<svg id="svg3400" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.507mm" width="15.1mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 53.504016 37.228838"><metadata id="metadata3405"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(-2.847e-7 -1015.1)"><path id="path4033" d="m26.92 1016.1c-14.337 0-25.957 12.707-25.957 28.382 0 2.3225 0.26742 4.5784 0.74876 6.7386l50.681-12.18c-2.321-13.072-12.841-22.944-25.476-22.944z" stroke="#5276cf" stroke-linecap="square" stroke-width="1.9247" fill="#666"/></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>');
w.push(ha,a,fa,V,g,sa);for(b=0;b<L.length;b++)L[b].setAttribute("id","wheel_btn_"+b),L[b].setAttribute("data-colorstate","B"),L[b].setAttribute("data-key",b),L[b].setAttribute("data-svgid",b);for(b=0;b<w.length;b++)L[b].setAttribute("id","wheel_axis_"+b),L[b].setAttribute("data-colorstate","GR");ha.setAttribute("data-key",C.GMPD_AXIS_0);ha.setAttribute("data-svgid",E.length);a.setAttribute("data-key",C.GMPD_AXIS_1);a.setAttribute("data-svgid",E.length+1);fa.setAttribute("data-key",C.GMPD_AXIS_2);
fa.setAttribute("data-svgid",E.length+2);V.setAttribute("data-key",C.GMPD_AXIS_3);V.setAttribute("data-svgid",E.length+3);g.setAttribute("data-key",C.GMPD_AXIS_4);g.setAttribute("data-svgid",E.length+4);sa.setAttribute("data-key",C.GMPD_AXIS_5);sa.setAttribute("data-svgid",E.length+5);E.push('<svg id="svg3458" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="50.447mm" width="83.899mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 297.28131 178.75"><metadata id="metadata3463"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -873.61)" fill="#e6e6e6"><path id="path4535" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m33.875 873.61-18.5 8.8125 5.0626 3.0625c-12.899 22.78-20.438 49.17-20.438 77.44 0 28.284 7.5315 54.691 20.438 77.469l-5.0626 3.0625 18.5 8.8125 0.6563-20.469-5.531 3.3c-12.002-21.2-18.937-45.8-18.937-72.18 0-26.362 6.9415-50.99 18.937-72.188l5.5313 3.3438-0.6563-20.469z"/><path id="path4551" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m263.38 873.71-0.6562 20.469 5.5312-3.3438c11.996 21.198 18.969 45.825 18.969 72.188 0 26.371-6.9672 51.011-18.969 72.219l-5.5312-3.3437 0.6562 20.469 18.5-8.8125-5.0312-3.0625c12.906-22.778 20.438-49.184 20.438-77.469 0-28.275-7.5391-54.665-20.438-77.438l5.0312-3.0625-18.5-8.8125z"/></g></svg>',
'<svg id="svg3386" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="12.859mm" width="5.2917mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 18.749999 45.562501"><metadata id="metadata3391"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1006.8)"><path id="rect4575" d="m9.3125 1006.8-9.3125 14.25h5.3125v17.094h-5.1875l9.3125 14.219 9.3125-14.219h-5.1562v-17.094h5.0312l-9.3125-14.25z" fill="#e6e6e6"/></g></svg>',
'<svg id="svg3386" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="12.859mm" width="5.2917mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 18.749999 45.562501"><metadata id="metadata3391"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1006.8)"><path id="rect4575" d="m9.3125 1006.8-9.3125 14.25h5.3125v17.094h-5.1875l9.3125 14.219 9.3125-14.219h-5.1562v-17.094h5.0312l-9.3125-14.25z" fill="#e6e6e6"/></g></svg>',
'<svg id="svg3386" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="12.859mm" width="5.2917mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 18.749999 45.562501"><metadata id="metadata3391"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1006.8)"><path id="rect4575" d="m9.3125 1006.8-9.3125 14.25h5.3125v17.094h-5.1875l9.3125 14.219 9.3125-14.219h-5.1562v-17.094h5.0312l-9.3125-14.25z" fill="#e6e6e6"/></g></svg>',
'<svg id="svg3378" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="2.9016mm" width="9.2516mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.781198 10.281199"><metadata id="metadata3383"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1042.1)"><path id="rect4585" d="m32.781 1047.2-7.875-5.125v2.8437h-17.031v-2.8437l-7.875 5.1 7.875 5.1562v-2.8437h17.031v2.8437z" fill="#e6e6e6"/></g></svg>',
'<svg id="svg3378" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2516mm" width="2.9016mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 10.281248 32.7812"><metadata id="metadata3383"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1019.6)"><path id="rect4585" d="m5.125 1019.6-5.125 7.9h2.8437v17.031h-2.8437l5.125 7.875 5.1562-7.875h-2.8438v-17.031h2.8438z" fill="#e6e6e6"/></g></svg>');
l(L,z);l(w,"#e6e6e6")}}function l(a,b){for(var c=function(a){a=a.target;if(!(0>J||"G"==a.getAttribute("data-colorstate")))if(0!=F){if("R"==a.getAttribute("data-colorstate")&&(M=null,document.getElementById("action_label").textContent="Click on the buttons & arrows to setup your controller",F=0),"B"==a.getAttribute("data-colorstate")||"GR"==a.getAttribute("data-colorstate")){var c=parseFloat(M.getAttribute("data-svgid"));M.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(E[c])+"')";M.setAttribute("data-colorstate",
a.getAttribute("data-colorstate"));M=a;c=parseFloat(a.getAttribute("data-svgid"));a.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(E[c].replace(b,"#ff0000"))+"')";a.setAttribute("data-colorstate","R")}}else{var c=parseFloat(a.getAttribute("data-svgid")),d="B"==a.getAttribute("data-colorstate")?1:2;F=d;a.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(E[c].replace(b,"#ff0000"))+"')";a.setAttribute("data-colorstate","R");1==d?document.getElementById("action_label").textContent=
"Now press the button on the device":document.getElementById("action_label").textContent="Now move the axis on the device";M=a}},d=0;d<a.length;d++)C.add_click_listener(a[d],c)}function c(a){var b=document.createElement("label");b.style.cssText="position: relative;display: inline-block;width: 50px;color: white;margin: 0 10px;font-size: 36px;line-height: 50px;background-color: black;border: 3px solid white;border-radius: 5px;height: 50px;";b.textContent=a;return b}function m(){var a=window.innerWidth,
b=window.innerHeight;U.style.zoom=750>=b&&400<b||750>=a&&400<a?"0.5":400>=a||400>=b?"0.3":"1"}var b=Object(R.a)(d),f=Object(V.a)(d),C=Object(n.a)(d),fa=Object(y.a)(d),z=RegExp("#5276cf","g"),G={};G[C.GMPD_BUTTON_12]=C.GMPD_BUTTON_12;G[C.GMPD_BUTTON_13]=C.GMPD_BUTTON_13;G[C.GMPD_BUTTON_15]=C.GMPD_BUTTON_15;G[C.GMPD_BUTTON_14]=C.GMPD_BUTTON_14;G[C.GMPD_BUTTON_3]=C.GMPD_BUTTON_3;G[C.GMPD_BUTTON_0]=C.GMPD_BUTTON_0;G[C.GMPD_BUTTON_1]=C.GMPD_BUTTON_1;G[C.GMPD_BUTTON_2]=C.GMPD_BUTTON_2;G[C.GMPD_BUTTON_5]=
C.GMPD_BUTTON_5;G[C.GMPD_BUTTON_7]=C.GMPD_BUTTON_7;G[C.GMPD_BUTTON_4]=C.GMPD_BUTTON_4;G[C.GMPD_BUTTON_6]=C.GMPD_BUTTON_6;G[C.GMPD_BUTTON_8]=C.GMPD_BUTTON_8;G[C.GMPD_BUTTON_9]=C.GMPD_BUTTON_9;G[C.GMPD_BUTTON_10]=C.GMPD_BUTTON_10;G[C.GMPD_BUTTON_11]=C.GMPD_BUTTON_11;G[C.GMPD_BUTTON_16]=C.GMPD_BUTTON_16;var E=[],J=-1,M=null,F=0,U=null,K=null,sa=null,v=null,Y=null,ha=null,S=[],L=[],q=[],w=[],ea=!0,H={};H[C.GMPD_AXIS_0]=-2;H[C.GMPD_AXIS_1]=-2;H[C.GMPD_AXIS_2]=-2;H[C.GMPD_AXIS_3]=-2;H[C.GMPD_AXIS_4]=-2;
H[C.GMPD_AXIS_5]=-2;H[C.GMPD_AXIS_6]=-2;H[C.GMPD_AXIS_7]=-2;H[C.GMPD_AXIS_8]=-2;H[C.GMPD_AXIS_9]=-2;H[C.GMPD_AXIS_10]=-2;H[C.GMPD_AXIS_11]=-2;e.show=function(){var d=document.createElement("div");U=d;d.style.cssText="position: absolute;width: 720px;height: 750px;top: 50%;left: 50%;-moz-transform: translateY(-50%) translateX(-50%);-ms-transform: translateY(-50%) translateX(-50%);-webkit-transform: translateY(-50%) translateX(-50%);transform: translateY(-50%) translateX(-50%);background-color: black;border: 4px solid white;border-radius: 35px;box-shadow: 0px 0px 20px 0px rgba(50, 50, 50, 1);";
b.insert_to_container(d,"LAST");r(d);var e=document.createElement("div");e.style.cssText="position: absolute;width: 637px;top: 0px;font-family: sans-serif;text-align: center;margin-top: 40px;-moz-transform: translateX(-50%);-ms-transform: translateX(-50%);-webkit-transform: translateX(-50%);transform: translateX(-50%);left: 50%;";var l=document.createElement("div");l.innerHTML="Select a device";l.style.cssText="color: #fff;display: inline-block;";e.appendChild(l);for(l=0;4>l;l++){var n=p(l),y=function(){return!0},
A=function(a,b,c){if(b==J)for(c=0;c<L.length;c++){var d=L[c],e=f.get_sensor_value(a,b,c),h=c;if(0==F){if(e&&"B"==d.getAttribute("data-colorstate")){var k=E[h];d.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(k.replace(z,"#00ff00"))+"')";d.setAttribute("data-colorstate","G")}e||"B"==d.getAttribute("data-colorstate")||(k=E[h],d.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(k)+"')",d.setAttribute("data-colorstate","B"))}else e=C.get_pressed_gmpd_btn(J),0<=e&&M&&1==F&&(d=
M.getAttribute("data-key"),C.set_gamepad_key(J,d,e),h=fa.get(J+"_gmpd_stngs","b4w")||"{}",h=JSON.parse(h),h[d]=e,fa.set(J+"_gmpd_stngs",JSON.stringify(h),"b4w"),M=null,document.getElementById("action_label").textContent="Click on the buttons & arrows to setup your controller",F=0)}};f.create_sensor_manifold(null,l,f.CT_CONTINUOUS,n,y,A)}0<k().length&&(J=0);var G=[],l=document.createElement("div");l.style.cssText="margin-top: 20px;";for(n=0;4>n;n++)A=c(n),n==J&&(A.style.backgroundColor="green",sa=
A),t(n),l.appendChild(A),A.setAttribute("data-device_type","PAD"),G.push(A),C.add_click_listener(A,function(a){var b=k();a=a.target;for(var c=0;c<b.length;c++)G[c]==a&&(J=c,sa=a,t(J),B(a.getAttribute("data-device_type")))});e.appendChild(l);ha=document.createElement("label");ha.style.cssText="position: relative;display: block;color: white;";e.appendChild(ha);l=document.createElement("div");l.style.cssText="margin-top: 20px;";n=a(l,"Pad");A=a(l,"Wheel");n.setAttribute("checked","true");n.onchange=
function(){B("PAD");sa&&sa.setAttribute("data-device_type","PAD")};A.onchange=function(){B("WHEEL");sa&&sa.setAttribute("data-device_type","WHEEL")};n.setAttribute("id","test");Y=n;v=A;n=document.createElement("label");n.style.cssText+="color: #fff;display: block;";l.appendChild(n);n.textContent="Click on the buttons & arrows to setup your controller";n.setAttribute("id","action_label");e.appendChild(l);d.appendChild(e);d=f.create_elapsed_sensor();f.create_sensor_manifold(null,"UPDATE_GAMEPAD_DATA",
f.CT_CONTINUOUS,[d],y,function(a,b,c){a=k();b=a.length;-1==J&&a.length&&(J=a[0].index,sa=G[J]);for(c=0;c<G.length;c++)c<b?(G[c].textContent=a[c].index,G[c]==sa?(G[c].style.backgroundColor="green",ha.textContent="Selected device: "+a[c].index+". Data: "+a[c].id):G[c].style.backgroundColor="blue"):G[c].style.backgroundColor="black";b||(J=-1,ha.textContent="")});for(l=0;4>l;l++)n=u(l),A=function(a,b,c){if(b=="AXES"+J){for(c=0;c<q.length;c+=2){var d=q[c],e=a,h=b,k=c,l=20*f.get_sensor_value(e,h,k),e=20*
f.get_sensor_value(e,h,k+1);d.style.transform="translate3d("+l+"px, "+e+"px, 0px) rotate(0rad)"}if(ea)for(c=0;12>c;c+=2){if(e=a,h=b,d=c,!(d+1>2*w.length)){l=f.get_sensor_value(e,h,d);e=f.get_sensor_value(e,h,d+1);if(-2<H[d]){var m=l-H[d],n=e-H[d+1],h=w[Math.floor(d/2)],k=h.getAttribute("data-svgid");0==F?h.style.backgroundImage=m||n?"url('data:image/svg+xml;base64,"+btoa(E[k].replace("#e6e6e6","#00ff00"))+"')":"url('data:image/svg+xml;base64,"+btoa(E[k])+"')":2==F&&(m=C.get_moved_gmpd_axis(J),0<=
m&&(0!=m%2&&m--,F=0,h.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(E[k])+"')",h=parseFloat(M.getAttribute("data-key")),C.set_gamepad_key(J,h,m),C.set_gamepad_key(J,h+1,m+1),M=null,document.getElementById("action_label").textContent="Click on the buttons & arrows to setup your controller"))}H[d]=l;H[d+1]=e}}else for(c=0;12>c;c++)d=c,d>=w.length||(l=f.get_sensor_value(a,b,d),-2<H[d]&&(k=l-H[d],e=w[d],h=e.getAttribute("data-svgid"),0==F?e.style.backgroundImage=k?"url('data:image/svg+xml;base64,"+
btoa(E[h].replace("#e6e6e6","#00ff00"))+"')":"url('data:image/svg+xml;base64,"+btoa(E[h])+"')":2==F&&(k=C.get_moved_gmpd_axis(J),0<=k&&(F=0,e.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(E[h])+"')",e=parseFloat(M.getAttribute("data-key")),C.set_gamepad_key(J,e,k),M=null,document.getElementById("action_label").textContent="Click on the buttons & arrows to setup your controller"))),H[d]=l)}},f.create_sensor_manifold(null,"AXES"+l,f.CT_CONTINUOUS,n,function(){return!0},A);m();window.addEventListener("resize",
m)};e.hide=function(){F=0;J=-1;Y=v=M=sa=null;q.length=0;L.length=0;w.length=0;b.get_container().removeChild(U);U=null;f.remove_sensor_manifold(null,"UPDATE_GAMEPAD_DATA");for(var a=0;4>a;a++)f.remove_sensor_manifold(null,a),f.remove_sensor_manifold(null,"AXES"+a);window.removeEventListener("resize",m)};e.update=function(){for(var a=0;4>a;a++)t(a)}});t.a=e},function(C,t,e){C=e(0);var R=e(33),V=e(24),n=e(29),y=e(41),d=e(26),k=e(3);e=Object(C.a)("gyroscope",function(e,t){function r(a){var d=u.create_gyro_angles_sensor(),
e=u.create_gyro_quat_sensor(),n=!0;u.create_sensor_manifold(a,"CAMERA_ROTATE_GYRO",u.CT_CONTINUOUS,[d,e],null,function(a,d,e){if(0<e)if(p.is_eye_camera(a))d=u.get_sensor_payload(a,d,1),e=k.transformQuat(l.AXIS_MY,d,b),p.set_vertical_axis(a,e),A.set_rotation_v(a,d);else{m=u.get_sensor_payload(a,d,0);n&&(c[0]=m[0],c[1]=m[1],c[2]=m[2],n=!1);e=d=0;0==window.orientation&&(d=m[1]-c[1],e=m[0]-c[0],m[1]>C&&m[1]<f&&(e=0));if(180==window.orientation){d=m[1]-c[1];0>m[1]&&(d=-d);e=c[0]-m[0];if(d>Math.PI/2||d<
-Math.PI/2)d=0;m[1]>-f&&m[1]<-C&&(e=0)}if(-90==window.orientation){d=m[0]-c[0];if(d>Math.PI/2||d<-Math.PI/2)d=0;e=c[1]-m[1];if(m[0]>I||m[0]<z)e=0}if(90==window.orientation){d=c[0]-m[0];if(d>Math.PI/2||d<-Math.PI/2)d=0;e=m[1]-c[1];if(m[0]>I||m[0]<z)e=0}p.rotate_camera(a,e,d);c[0]=m[0];c[1]=m[1];c[2]=m[2]}})}var p=Object(R.a)(e),u=Object(V.a)(e),a=Object(n.a)(e),A=Object(y.a)(e),l=Object(d.a)(e),c=new Float32Array(3),m=new Float32Array(3),b=k.create(),f=l.deg_to_rad(110),C=l.deg_to_rad(70),I=l.deg_to_rad(70),
z=-l.deg_to_rad(70);t.enable_camera_rotation=function(){var b=a.get_active_camera();r(b)};t.disable_camera_rotation=function(){var b=a.get_active_camera();u.remove_sensor_manifold(b,"CAMERA_ROTATE_GYRO")}});t.a=e},function(C,t,e){C=e(0);var R=e(40),V=e(24),n=e(49),y=e(1),d=e(69),k=e(26);e=Object(C.a)("hmd_conf",function(e,t){function r(){if(!I.can_use_device(I.DEVICE_HMD))return!1;var a=I.get_device_by_type_element(I.DEVICE_HMD),a=I.get_value_param(a,I.HMD_WEBVR_TYPE);return a&(I.HMD_NON_WEBVR|I.HMD_WEBVR_MOBILE|
I.HMD_WEBVR_DESKTOP)&&!(a&I.HMD_WEBVR1)}function p(a){a=a.target.value;var b=Y[a],c;for(c in sa)if(c in b){var d=document.getElementById(c+"_slider");d&&(d.disabled="custom"!==a,d.value=b[c]);if(d=document.getElementById(c+"_number"))d.disabled="custom"!==a,d.value=b[c];sa[c]=b[c]}}function u(){C.remove_sensor_manifold(null,"UPDATE_HMD_RENDERING");A();c();J&&(J=!1,f.get_container().removeChild(M),document.head.removeChild(F),F=U=M=null)}function a(){A(!0);c();for(var a in sa){var b=document.getElementById(a+
"_slider");b&&(b.value=sa[a]);if(b=document.getElementById(a+"_number"))b.value=sa[a]}}function A(a){var b=Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio,c=Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio,d=0,e=0,f=0,h;a:{h=S;var k=navigator.userAgent||navigator.vendor||window.opera;if(1==h.format&&h.devices&&h.devices.length)for(var l=0;l<h.devices.length;l++){var m=h.devices[l];if(m.rules&&("ios"==m.type&&v||"android"==m.type)){for(var n=!1,
p=0;p<m.rules.length;p++){var r=m.rules[p],u=b,t=c;if(r.ua&&0<=k.indexOf(r.ua)||!r.ua&&r.res&&r.res[0]&&r.res[1]&&Math.min(u,t)==Math.min(r.res[0],r.res[1])&&Math.max(u,t)==Math.max(r.res[0],r.res[1])){n=!0;break}}if(n){h=l;break a}}}else z.error("DPDB isn't correct.");h=-1}-1!=h&&(f=S.devices[h],e=f.dpi[1]||f.dpi,d=Math.round(25.4*b/(f.dpi[0]||f.dpi)),e=Math.round(25.4*c/e),f=Math.round(f.bw));b=G.get("hmd_conf","b4w");b=JSON.parse(b?b:"{}");a?(sa.first_distortion=.34,sa.second_distortion=.55,sa.bevel_size=
f||4,sa.screen_width=d||110,sa.screen_height=e||65,sa.screen_lense=50,sa.ipd=64,sa.baseline=32):(sa.first_distortion="first_distortion"in b?parseFloat(b.first_distortion):.34,sa.second_distortion="second_distortion"in b?parseFloat(b.second_distortion):.55,sa.bevel_size="bevel_size"in b?parseFloat(b.bevel_size):f||4,sa.screen_width="screen_width"in b?parseFloat(b.screen_width):d||110,sa.screen_height="screen_height"in b?parseFloat(b.screen_height):e||65,sa.screen_lense="screen_lense"in b?parseFloat(b.screen_lense):
50,sa.ipd="ipd"in b?parseFloat(b.ipd):64,sa.baseline="baseline"in b?parseFloat(b.baseline):32);K=!0}function l(){G.set("hmd_conf",JSON.stringify(sa),"b4w");u()}function c(){if(K){var a=I.get_device_by_type_element(I.DEVICE_HMD);a&&(I.set_config(a,I.HMD_DISTORTION,[sa.first_distortion,sa.second_distortion]),I.get_value_param(a,I.HMD_WEBVR_TYPE)&(I.HMD_NON_WEBVR|I.HMD_WEBVR_MOBILE)&&(I.set_config(a,I.HMD_BEVEL_SIZE,.001*sa.bevel_size),I.set_config(a,I.HMD_SCREEN_WIDTH,.001*sa.screen_width),I.set_config(a,
I.HMD_SCREEN_HEIGHT,.001*sa.screen_height),I.set_config(a,I.HMD_SCREEN_LENS_DIST,.001*sa.screen_lense),I.set_config(a,I.HMD_EYE_DISTANCE,.001*sa.ipd),I.set_config(a,I.HMD_BASELINE_DIST,.001*sa.baseline)));K=!1}}function m(a){var b=a.target.id.split("_"),b=b.splice(0,b.length-1).join("_");b in sa&&sa[b]!=a.target.value&&(K=!0,sa[b]=a.target.value,document.getElementById(b+"_slider").value=a.target.value,document.getElementById(b+"_number").value=a.target.value)}function b(a,b,c){var d=document.createElement("button");
d.onclick=a;d.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;width: 160px;height: 30px;display: block;float: left;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: center;padding-left: 8px;line-height: 28px;margin-right:"+c+";box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);";d.innerHTML=b;return d}var f=Object(R.a)(e),C=Object(V.a)(e),I=Object(n.a)(e),z=Object(y.a)(e),G=Object(d.a)(e),E=Object(k.a)(e),
J=!1,M=null,F=null,U=null,K=!0,sa={profile:"custom",first_distortion:0,second_distortion:0,bevel_size:0,screen_width:0,screen_height:0,screen_lense:0,ipd:0,baseline:0},v=/iPad|iPhone|iPod/.test(navigator.platform),Y={oculus_dk2:{name:"Oculus Rift DK2",type:2,first_distortion:.22,second_distortion:.28},cardboard_1:{name:"Cardboard (2014)",type:1,ipd:60,baseline:35,screen_lense:42,first_distortion:.441,second_distortion:.156},cardboard_2:{name:"Cardboard (2015)",type:1,ipd:64,baseline:35,screen_lense:39,
first_distortion:.34,second_distortion:.55},custom:{name:"Custom",type:0,ipd:64,baseline:35,screen_lense:39,first_distortion:0,second_distortion:0}},ha=[{label:"Tray to lens-center distance.",is_mobile:!0,inputs:[{id:"baseline",max:"50",step:"0.5"}]},{label:"Interpupillary distance.",is_mobile:!0,inputs:[{id:"ipd",max:"100",step:"1"}]},{label:"Screen to lense distance.",is_mobile:!0,inputs:[{id:"screen_lense",max:"100",step:"1"}]},{label:"Screen height.",is_mobile:!0,inputs:[{id:"screen_height",max:"150",
step:"1"}]},{label:"Screen width.",is_mobile:!0,inputs:[{id:"screen_width",max:"200",step:"1"}]},{label:"Bevel width.",is_mobile:!0,inputs:[{id:"bevel_size",max:"20",step:"1"}]},{label:"Distortion coefficients.",inputs:[{id:"first_distortion",max:"1.0",step:"0.01"},{id:"second_distortion",max:"1.0",step:"0.01"}]}];t.check=r;t.show=function(d){if(r()){var e=f.get_container();F=document.createElement("style");F.innerHTML="."+d+" input[type=range]::-webkit-slider-runnable-track {width: 100%; height: 8px;cursor: pointer;background-color: #fff;border: 2px solid rgba(98, 98, 98, .2);box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);}."+
d+" input[type=range]::-webkit-slider-thumb {box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);height: 30px;width: 16px;border-radius: 2px;background-color: #323232;cursor: pointer;margin-top: -13px;-webkit-appearance: none;}";document.head.appendChild(F);if(!J){J=!0;A();var k=I.get_device_by_type_element(I.DEVICE_MOUSE,e);I.switch_prevent_default(k,!1);k=I.get_device_by_type_element(I.DEVICE_TOUCH,e);I.switch_prevent_default(k,!1);M=document.createElement("div");M.className=d;e.appendChild(M);U=document.createElement("div");
M.appendChild(U);U.style.cssText="background-color: #484848;border: 2px solid rgba(150, 150, 150, 0.7);box-shadow: 0px 0px 10px 0px rgba(150, 150, 150, 0.7);position: relative;width: 524px;padding: 16px;overflow: hidden;";d=G.get("hmd_conf","b4w");d=JSON.parse(d?d:"{}").profile||"custom";e=document.createElement("div");k=document.createElement("label");k.innerHTML="Profile: ";k.className="text_label";k.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;width: 120px;height: 30px;display: block;float: left;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: left;padding-left: 8px;line-height: 28px;margin-bottom: 4px;box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);";
e.appendChild(k);k=document.createElement("select");e.appendChild(k);k.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;height: 30px;display: block;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: left;padding-left: 8px;line-height: 28px;margin-bottom: 4px;box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);";var n=I.get_device_by_type_element(I.DEVICE_HMD);if(n)for(var t in Y)if(0==Y[t].type||I.get_value_param(n,
I.HMD_WEBVR_TYPE)&(I.HMD_NON_WEBVR|I.HMD_WEBVR_MOBILE)&&1==Y[t].type){var v=document.createElement("option");v.value=t;v.text=Y[t].name;k.appendChild(v)}k.value=d;E.is_ie11()?k.onchange=p:k.oninput=p;U.appendChild(e);t=I.get_device_by_type_element(I.DEVICE_HMD);for(d=0;d<ha.length;d++)if(I.get_value_param(t,I.HMD_WEBVR_TYPE)&(I.HMD_NON_WEBVR|I.HMD_WEBVR_MOBILE)||!ha[d].is_mobile){e=ha[d];n=d;k=document.createElement("div");v=document.createElement("label");v.className="text_label";var h="8px";n%2&&
(h="0");v.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;width: 100%;height: 30px;display: block;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: left;padding-left: 8px;line-height: 28px;margin-bottom: 4px;box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);";v.textContent=e.label;k.appendChild(v);k.style.cssText="margin-top: 16px;float: left;width: 240px;margin-right: "+h+";border-top: 2px solid rgba(98, 98, 98, .4);box-sizing: border-box;-webkit-box-sizing: border-box;padding-top: 8px;";
for(n=0;n<e.inputs.length;n++){v=e.inputs[n];h=document.createElement("div");h.className="row";var z=document.createElement("input");z.className="input_slider";z.style.cssText="-webkit-appearance: none;width: 192px;display: block;float: left;height: 8px;margin-bottom: 16px;margin-top: 16px;box-sizing: border-box;margin-right: 8px;margin-left: 0;";z.setAttribute("id",v.id+"_slider");z.setAttribute("type","range");z.setAttribute("min","0.00");z.setAttribute("step",v.step);z.setAttribute("value",sa[v.id]);
z.setAttribute("max",v.max);h.appendChild(z);var y=document.createElement("input");y.className="input_text";y.setAttribute("id",v.id+"_number");y.setAttribute("type","number");y.setAttribute("min","0.00");y.setAttribute("step",v.step);y.setAttribute("value",sa[v.id]);y.setAttribute("max",v.max);h.appendChild(y);y.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;width: 40px;height: 30px;display: block;float: left;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: center;box-sizing: border-box;line-height: 28px;margin-top: 4px;margin-right: 0;margin-left: 0;box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);";
E.is_ie11()?(z.onchange=m,y.onchange=m):(z.oninput=m,y.oninput=m);k.appendChild(h)}U.appendChild(k)}t=document.createElement("div");d=b(l,"SAVE","4px");e=b(u,"CANCEL","4px");k=b(a,"RESET","0px");t.className="row";t.style.cssText="padding-top: 32px;clear: both;box-sizing: border-box;-webkit-box-sizing: border-box;";t.appendChild(d);t.appendChild(e);t.appendChild(k);U.appendChild(t);t=C.create_timeline_sensor();C.create_sensor_manifold(null,"UPDATE_HMD_RENDERING",C.CT_CONTINUOUS,[t],null,c)}}};t.hide=
u;t.reset=a;t.update=function(){A();c()};var S={_comment:"AUTOMATICALLY GENERATED BY generate_dpdb.py. DO NOT EDIT.",format:1,last_updated:"2016-01-26T23:11:18Z",devices:[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,443.3],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},
{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,
518],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1E3},{type:"android",
rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 B"}],dpi:[442.4,444.8],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,247.5],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,401.5],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},
{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,255.9],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},
{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],
dpi:[403.4,402.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 B"}],dpi:[494.3,489.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT1064/*"},{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],
bw:3,ac:1E3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,405.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,444.1],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1E3},
{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],dpi:[234.5,229.8],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],dpi:[217.7,231.4],bw:3,ac:1E3},{type:"android",
rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],dpi:[415.6,431.6],bw:5,ac:1E3},{type:"android",
rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,431.6],bw:5,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},
{ua:"SM-N920C"}],dpi:[515.1,518.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],dpi:285.8,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},
{ua:"SPH-D710"}],dpi:[217.7,204.2],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],
dpi:[515.2,520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,
bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},
{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],dpi:[480,443.3],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,328.4],bw:4,ac:1E3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1E3},{type:"ios",
rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1E3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1E3},{type:"ios",rules:[{res:[1125,2001]}],dpi:[410.9,415.4],bw:4,ac:1E3}]}});t.a=e},function(C,t,e){C=e(0);var R=e(24),V=e(1),n=e(29),y=e(50),d=e(82),k=e(26);e=Object(C.a)("mixer",function(e,t){function r(){F=M.length=0;U=p(100);K=new Float32Array(U.length);sa=new Float32Array(U.length);var a=G.get_speaker_objects();if(a.length){M.push(u());for(var b=0;b<a.length;b++)M.push(A(a[b]));M.sort(function(a,
b){return"MASTER"==a.id?-1:"MASTER"==b.id?1:"COMPRESSOR"==a.id?-1:"COMPRESSOR"==b.id?1:a.id.toUpperCase()<b.id.toUpperCase()?-1:a.id.toUpperCase()>b.id.toUpperCase()?1:0})}}function p(a){for(var b=new Float32Array(a),c=0,d=0;d<a;d++)b[d]=20*Math.pow(1E3,c),c+=1/(a-1);return b}function u(){var b=a("MASTER"),c=G.get_compressor_params();c&&(b.params.push(["THRESHOLD",c.threshold,-100,0,100,!1]),b.params.push(["KNEE",c.knee,0,40,40,!1]),b.params.push(["RATIO",c.ratio,1,20,20,!1]),b.params.push(["ATTACK",
c.attack,0,1,1E3,!1]),b.params.push(["RELEASE",c.release,0,1,1E3,!1]));b.params.push(["VOLUME",G.get_volume(null),0,1,50,!1]);b.mute=G.is_muted(null)?1:0;b.solo=-1;return b}function a(a){return{id:a,params:[],active_param:0,mute:-1,solo:-1,speaker:null}}function A(b){var c=a(I.get_object_name(b));c.mute=G.is_muted(b)?1:0;c.solo=0;c.speaker=b;return c}function l(a){if(a.speaker){a.params.length=0;var b=G.get_positional_params(a.speaker);b&&(a.params.push(["DIST_REF",b.dist_ref,0,1E3,1E4,!1]),a.params.push(["ATTENUATION",
b.attenuation,0,50,1E3,!1]),a.params.push(["DIST_MAX",b.dist_max,0,1E4,1E4,!1]));if(b=G.get_filter_params(a.speaker))a.params.push(["EQ_FREQ",b.freq,20,2E4,100,!0]),a.params.push(["EQ_Q",b.Q,0,10,100,!1]),a.params.push(["EQ_GAIN",b.gain,-70,30,100,!1]);a.params.push(["VOLUME",G.get_volume(a.speaker),0,1,50,!1]);E.clamp(a.active_param,0,a.params.length-1)}}function c(a){for(var b=0;b<M.length;b++){var c=M[b];if(c!=a&&1==c.solo)return!0}return!1}function m(a){for(var b=0;b<M.length;b++){var c=M[b];
c!=a&&0==c.mute&&0==c.solo&&G.mute(c.speaker,!1)}}function b(){if(0==M.length)return[0,-1];var a=8*Math.floor(F/8),b=a+7,a=E.clamp(a,0,M.length-1),b=E.clamp(b,0,M.length-1);return[a,b]}var f=Object(R.a)(e),C=Object(V.a)(e),I=Object(n.a)(e),z=Object(y.a)(e),G=Object(d.a)(e),E=Object(k.a)(e),J="SWITCH_STRIP SWITCH_STRIP_HOLD SWITCH_PARAM INC_DEC INC_DEC_HOLD MUTE_SOLO".split(" "),M=[],F=0,U=null,K=null,sa=null;t.enable_mixer_controls=function(){r();var a=f.create_keyboard_sensor(f.KEY_NUM4),d=f.create_keyboard_sensor(f.KEY_NUM6),
e=f.create_keyboard_sensor(f.KEY_NUM8),k=f.create_keyboard_sensor(f.KEY_NUM2),n=f.create_keyboard_sensor(f.KEY_ADD),p=f.create_keyboard_sensor(f.KEY_SUB),u=f.create_keyboard_sensor(f.KEY_NUM7),t=f.create_keyboard_sensor(f.KEY_NUM9),y=f.create_timer_sensor(.15,!0),A=f.create_timer_sensor(.05,!0),a=[a,d,y],d=function(a,c,d){if(1==d){d=f.get_sensor_value(a,c,0)?-1:1;if(M.length){1==d&&F<M.length-1?F++:-1==d&&0<F&&F--;d=b();for(var e=d[0];e<=d[1];e++)l(M[e])}"SWITCH_STRIP"==c?f.reset_timer_sensor(a,c,
2,.15+.3):f.reset_timer_sensor(a,c,2,.15)}else f.reset_timer_sensor(a,c,2,10)};f.create_sensor_manifold(null,"SWITCH_STRIP",f.CT_TRIGGER,a,function(a){return a[0]||a[1]},d);f.create_sensor_manifold(null,"SWITCH_STRIP_HOLD",f.CT_SHOT,a,function(a){return(a[0]||a[1])&&a[2]},d);f.create_sensor_manifold(null,"SWITCH_PARAM",f.CT_SHOT,[e,k],function(a){return a[0]||a[1]},function(a,b,c){a=f.get_sensor_value(a,b,0)?-1:1;(b=M[F])&&(1==a&&b.active_param<b.params.length-1?b.active_param++:-1==a&&0<b.active_param&&
b.active_param--)});e=[p,n,A];k=function(a,b,c){if(1==c){var d=f.get_sensor_value(a,b,0)?-1:1,e=M[F];if(e)switch(c=e.params[e.active_param],c[1]=c[5]?c[1]*Math.pow(c[3]/c[2],d/c[4]):c[1]+(c[3]-c[2])/c[4]*d,c[1]=E.clamp(c[1],c[2],c[3]),c[0]){case "VOLUME":"MASTER"!=e.id?G.set_volume(e.speaker,c[1]):G.set_volume(null,c[1]);break;case "DIST_REF":d=G.get_positional_params(e.speaker);d.dist_ref=c[1];G.set_positional_params(e.speaker,d);break;case "ATTENUATION":d=G.get_positional_params(e.speaker);d.attenuation=
c[1];G.set_positional_params(e.speaker,d);break;case "DIST_MAX":d=G.get_positional_params(e.speaker);d.dist_max=c[1];G.set_positional_params(e.speaker,d);break;case "EQ_FREQ":d=G.get_filter_params(e.speaker);d.freq=c[1];G.set_filter_params(e.speaker,d);break;case "EQ_Q":d=G.get_filter_params(e.speaker);d.Q=c[1];G.set_filter_params(e.speaker,d);break;case "EQ_GAIN":d=G.get_filter_params(e.speaker);d.gain=c[1];G.set_filter_params(e.speaker,d);break;case "THRESHOLD":e=G.get_compressor_params();e.threshold=
c[1];G.set_compressor_params(e);break;case "KNEE":e=G.get_compressor_params();e.knee=c[1];G.set_compressor_params(e);break;case "RATIO":e=G.get_compressor_params();e.ratio=c[1];G.set_compressor_params(e);break;case "ATTACK":e=G.get_compressor_params();e.attack=c[1];G.set_compressor_params(e);break;case "RELEASE":e=G.get_compressor_params();e.release=c[1];G.set_compressor_params(e);break;default:C.error("Unknown strip param")}"INC_DEC"==b?f.reset_timer_sensor(a,b,2,.35):f.reset_timer_sensor(a,b,2,
.05)}else f.reset_timer_sensor(a,b,2,10)};f.create_sensor_manifold(null,"INC_DEC",f.CT_TRIGGER,e,function(a){return a[0]||a[1]},k);f.create_sensor_manifold(null,"INC_DEC_HOLD",f.CT_SHOT,e,function(a){return(a[0]||a[1])&&a[2]},k);f.create_sensor_manifold(null,"MUTE_SOLO",f.CT_SHOT,[u,t],function(a){return a[0]||a[1]},function(a,b,d){if(f.get_sensor_value(a,b,0))(a=M[F])&&0<=a.mute&&("MASTER"!=a.id?0==a.mute?(a.mute=1,G.mute(a.speaker,!0),1==a.solo&&(a.solo=0,c(a)||m(a))):(a.mute=0,c(a)||G.mute(a.speaker,
!1)):0==a.mute?(a.mute=1,G.mute(null,!0)):(a.mute=0,G.mute(null,!1)));else if((a=M[F])&&0<=a.solo)if(0==a.solo)for(a.solo=1,G.mute(a.speaker,!1),1==a.mute&&(a.mute=0),b=0;b<M.length;b++)d=M[b],d!=a&&0==d.mute&&0==d.solo&&G.mute(d.speaker,!0);else a.solo=0,c(a)?G.mute(a.speaker,!0):m(a)});u=f.create_elapsed_sensor();f.create_sensor_manifold(null,"MIXER_DRAW",f.CT_CONTINUOUS,[u],null,function(){if(M[F])for(var a=b(),c=a[0];c<=a[1];c++){var d=M[c];z.draw_mixer_strip(d.id,c==F,c%8,d.params,d.active_param,
d.mute,d.solo);if(d.speaker&&G.get_filter_params(d.speaker)){G.get_filter_freq_response(d.speaker,U,K,sa);for(d=0;d<K.length;d++)K[d]=20*Math.log(K[d])/Math.LN10;z.plot_array("EQ",c%8,K,20,2E4,-10,10)}}});u=f.create_timer_sensor(1,!0);f.create_sensor_manifold(null,"MIXER_UPDATE",f.CT_TRIGGER,[u],null,function(){for(var a=b(),c=a[0];c<=a[1];c++)l(M[c])})};t.disable_mixer_controls=function(){for(var a=0;J.length;a++)f.remove_sensor_manifold(null,J[a])}});t.a=e},function(C,t,e){C=e(0);var R=e(33),V=
e(40),n=e(24),y=e(54),d=e(1),k=e(29),I=e(26),A=e(60);e=Object(C.a)("mouse",function(e,p){function r(){1==L&&(L=0);var a=document.exitPointerLock||document.webkitExitPointerLock||document.mozExitPointerLock;"function"===typeof a&&a.apply(document);z.remove_sensor_manifold(J.get_active_camera(),"SMOOTH_PL")}function a(a){2==L&&(L=0);a.removeEventListener("mousedown",l,!1);a.removeEventListener("mouseup",c,!1);a.removeEventListener("mousemove",t,!1);z.remove_sensor_manifold(J.get_active_camera(),"SMOOTH_DRAG")}
function t(a){if(ha()){if(w)var b=fa.get_coords_target_space(a,Y);else b=Y,b[0]=a.clientX,b[1]=a.clientY;v[0]+=2*(b[0]-K);v[1]+=2*(b[1]-sa);K=b[0];sa=b[1]}a.preventDefault()}function l(a){if(w)var b=fa.get_coords_target_space(a,Y);else b=Y,b[0]=a.clientX,b[1]=a.clientY;K=b[0];sa=b[1];a.currentTarget.addEventListener("mousemove",t,!1);a.preventDefault()}function c(a){a.currentTarget.removeEventListener("mousemove",t,!1);a.preventDefault()}function m(a,b,c,d){if(.01<Math.abs(v[0])||.01<Math.abs(v[1]))b=
z.get_sensor_value(a,b,0),a=M.smooth(v[0],0,b,.1*U),b=M.smooth(v[1],0,b,.1*U),v[0]-=a,v[1]-=b,d(4E-4*-a,4E-4*-b)}function b(a,b){var c=J.get_first_character(),d=J.get_active_camera();C.rotate_camera(d,a,b);c&&(d=C.get_camera_angles_char(d,Y),G.set_character_rotation_h(c,d[0]),G.set_character_vert_move_dir_angle(c,d[1]))}function f(a){q?(a=fa.get_coords_target_space(a,!1,Y),a=J.pick_object(a[0],a[1])):a=J.pick_object(a.clientX,a.clientY);a?(J.outlining_is_enabled(a)&&J.set_outline_intensity(a,1),J.outlining_is_enabled(S)&&
a!=S&&J.set_outline_intensity(S,0)):J.outlining_is_enabled(S)&&J.set_outline_intensity(S,0);S=a}var C=Object(R.a)(e),fa=Object(V.a)(e),z=Object(n.a)(e),G=Object(y.a)(e),E=Object(d.a)(e),J=Object(k.a)(e),M=Object(I.a)(e),F=Object(A.a)(e),U=1,K=0,sa=0,v=new Float32Array(2),Y=new Float32Array(2),ha=null,S=null,L=0,q=!1,w=!1;p.request_pointerlock=function(c,d,e,f,k,l){function h(){if(document.pointerLockElement===c||document.webkitPointerLockElement===c||document.mozPointerLockElement===c){a(c);c.addEventListener("mousemove",
f,!1);var b=J.get_active_camera();if(!z.check_sensor_manifold(b,"SMOOTH_PL")){var k=z.create_elapsed_sensor();z.create_sensor_manifold(b,"SMOOTH_PL",z.CT_CONTINUOUS,[k],null,m,l)}d()}else c.removeEventListener("mousemove",f,!1),L=0,document.removeEventListener("pointerlockchange",h,!1),document.removeEventListener("webkitpointerlockchange",h,!1),document.removeEventListener("mozpointerlockchange",h,!1),e()}if(1!=L){L=1;d=d||function(){};e=e||function(){};l=l||b;k=k||function(){return!0};f=f||function(a){if(k()){if("number"==
typeof a.movementX){var b=a.movementX;a=a.movementY}else"number"==typeof a.webkitMovementX?(b=a.webkitMovementX,a=a.webkitMovementY):"number"==typeof a.mozMovementX?(b=a.mozMovementX,a=a.mozMovementY):a=b=0;v[0]+=b;v[1]+=a}};document.addEventListener("pointerlockchange",h,!1);document.addEventListener("webkitpointerlockchange",h,!1);document.addEventListener("mozpointerlockchange",h,!1);var n=c.requestPointerLock||c.webkitRequestPointerLock||c.mozRequestPointerLock;"function"===typeof n?n.apply(c):
E.error("Pointer lock is not available")}};p.exit_pointerlock=r;p.check_pointerlock=function(a){return"function"===typeof(a.requestPointerLock||a.webkitRequestPointerLock||a.mozRequestPointerLock)?!0:!1};p.request_mouse_drag=function(a,d,e,f){2!=L&&(L=2,r(),ha=d||function(){return!0},e=e||b,w=!!f,a.addEventListener("mousedown",l,!1),a.addEventListener("mouseup",c,!1),a=J.get_active_camera(),z.check_sensor_manifold(a,"SMOOTH_DRAG")||(d=z.create_elapsed_sensor(),z.create_sensor_manifold(a,"SMOOTH_DRAG",
z.CT_CONTINUOUS,[d],null,m,e)))};p.exit_mouse_drag=a;p.enable_mouse_hover_outline=function(a){q=!!a;F.detect_mobile()||fa.get_canvas().addEventListener("mousemove",f)};p.disable_mouse_hover_outline=function(){F.detect_mobile()||(fa.get_canvas().removeEventListener("mousemove",f),S&&J.set_outline_intensity(S,0))};p.get_coords_x=function(a,b,c){return c?fa.get_coords_target_space(a,b,Y)[0]:"clientX"in a?a.clientX:(a="touchend"==a.type?a.changedTouches:b?a.targetTouches:a.touches)&&a[0]&&"clientX"in
a[0]?a[0].clientX:-1};p.get_coords_y=function(a,b,c){return c?fa.get_coords_target_space(a,b,Y)[1]:"clientY"in a?a.clientY:(a="touchend"==a.type?a.changedTouches:b?a.targetTouches:a.touches)&&a[0]&&"clientY"in a[0]?a[0].clientY:-1};p.set_plock_smooth_factor=function(a){U=a};p.get_plock_smooth_factor=function(){return U}});t.a=e},function(C,t,e){C=e(0);var R=e(83),V=e(24),n=e(8),y=e(29),d=e(68),k=e(41),I=e(3),A=e(54),r=e(1),p=e(26);e=Object(C.a)("npc_ai",function(e,a){function u(a,b){var c=b.destination,
d=b.base_pos,e=sa;E.get_translation(b.collider,e);var k=0,l=e[2];c[2]=l;switch(b.type){case q:if(b.random&&b.reached){c[0]=(12*Math.random()-6)*b.speed+d[0];c[1]=-(12*Math.random()-6)*b.speed+d[1];var m=S,d=v,p=b.speed,r=b.rot_speed;E.get_rotation(b.collider,m);I.transformQuat(F.AXIS_MY,m,d);d[2]=0;I.normalize(d,d);m=.5*p/Math.sin(r/2);e=I.dist(c,e);e<2*m&&I.scaleAndAdd(c,d,2*m-e,c);b.reached=!1}b.ground_level&&(k=b.ground_level-l,e=b.speed*a,k>e?k=e:k<-e&&(k=-e));b.vert_correction=k;break;case w:case ea:b.vert_cor_water?
k=b.vert_cor_water:b.vert_correction&&(k=b.vert_correction,b.type==ea&&(k*=a)),b.random&&b.reached&&(b.type==ea?(b.speed=Math.random()+.1,e=b.max_depth-b.min_depth):e=b.max_height-b.min_height,c[0]=10*Math.random()-5+d[0],c[1]=10*Math.random()-5+d[1],c[2]=l-(Math.random()*e-.5*e),b.reached=!1)}k&&(c[2]=l+k);var c=K,e=sa,m=v,k=L,r=b.rig,d=b.collider,l=b.destination,u=b.speed,z=b.actions,y=t.get_current_anim_name(r);if(!t.is_play(r)||!z.idle||-1==z.idle.indexOf(y)){E.get_translation(d,c);var p=l[0]-
c[0],A=l[1]-c[1],p=Math.sqrt(p*p+A*A);if(p>2*u*a)b.state=20,F.horizontal_direction(l,c,m),z=b.rig,t.is_animated(z)&&(r=b.speed,u=t.get_frame(z),z=t.get_anim_length(z),r*=z/24*(1-u/z),.9>p/r&&I.scaleAndAdd(l,m,r-p,l)),p=S,r=Y,E.get_rotation(b.collider,p),I.transformQuat(F.AXIS_MY,p,e),r[0]=e[0],r[1]=e[1],r[2]=0,I.normalize(r,r),u=I.dot(r,m),z=a/(Math.abs(Math.acos(u))/Math.PI)*b.rot_speed*b.rotation_mult,n.rotationTo(r,m,k),n.rotationTo(F.AXIS_MY,r,p),1<=Math.abs(u)?n.copy(p,k):(n.multiply(k,p,k),
n.slerp(p,k,Math.min(z,1),k)),m=a,b.type!=w&&(m=Math.max(m,1/60),p=ha,r=S,n.setAxisAngle(F.AXIS_X,-Math.asin(-e[2]),r),n.setAxisAngle(F.AXIS_X,-Math.atan(b.vert_correction/(b.speed*m)),p),n.slerp(r,p,m,p),n.multiply(k,p,k)),E.set_rotation_v(d,k),e=v,d=Y,F.quat_to_dir(k,F.AXIS_MY,e),I.scale(e,b.speed*a,d),I.add(d,c,d),d[2]=b.type!=q?(l[2]-c[2])*a*.1+c[2]:l[2],E.set_translation_v(b.collider,d);else if(b.type==q)z.move?y&&-1!=z.move.indexOf(y)&&t.is_play(r)?b.state=20:(b.state=10,b.reached=!0):(b.state=
10,b.reached=!0);else if(b.type==ea||b.type==w)b.reached=!0;if(f(b)&&(c=b.rig,!t.is_play(c))){k=null;switch(b.state){case 10:k=b.actions;k=k.idle?F.random_from_array(k.idle):null;break;case 20:k=t.get_current_anim_name(b.rig),e=l=b.actions,e.move_blends&&-1==e.move_blends.indexOf(k)&&e.move&&-1!=e.move.indexOf(k)&&.33<Math.random()?(l=b.actions,k=l.move.indexOf(k),k=l.move_blends[k]):(e=b.actions,e.move&&(-1!=e.move.indexOf(k)||!e.move_blends&&!e.move_start||!e.move_start&&!k||e.move_blends&&-1!=
e.move_blends.indexOf(k)||e.move_start&&-1!=e.move_start.indexOf(k))?(l=b.actions,l.move_blends?(e=l.move_blends.indexOf(k),-1!=e?(k=e+1,k=k<l.move.length?k:0,k=l.move[k]):k=-1!=l.move.indexOf(k)?k:F.random_from_array(l.move)):k=F.random_from_array(l.move)):(e=b.actions,k=e.move_start&&-1==e.move_start.indexOf(k)&&e.move&&-1==e.move.indexOf(k)?F.random_from_array(l.move_start):null))}k&&(t.apply(c,k),t.set_behavior(c,t.AB_FINISH_RESET),t.set_frame(c,0),t.play(c))}}}function l(a,b,c,d){if(d)if(1==
c)switch(d.type){case w:a:{for(c=0;3>c;c++){var e=C.get_sensor_payload(a,b,c).hit_fract;if(e){b=e;break a}}b=void 0}b*=100;d.vert_correction=b<d.min_height?10:b>d.max_height?-10:0;break;case q:a=C.get_sensor_payload(a,b,0);d.ground_level=a.hit_pos[2];break;case ea:a=C.get_sensor_payload(a,b,0),"CLOSE_GROUND"==b?(d.vert_correction=100*a.hit_fract-1,d.vert_correction=.1>d.vert_correction?.05:0):"CLOSE_WATER"==b&&(d.vert_cor_water=100*a.hit_fract,d.vert_cor_water=d.vert_cor_water<d.min_depth?-.02:d.vert_cor_water>
d.max_depth?.02:0)}else d.vert_correction=0}function c(){for(var a=0;a<U.length;a++){var c=U[a];m(c);b(c);t.get_current_anim_name(c.rig)&&t.play(c.rig)}}function m(a){var b=I.create(),c=a.collider;switch(a.type){case w:var d=C.create_ray_sensor(c,b,[0,0,-100],"TERRAIN",!0,!0),e=C.create_ray_sensor(c,b,[0,0,-100],"STONE",!0,!0),b=C.create_ray_sensor(c,b,[0,0,-100],"WATER",!0,!0),d=[d,e,b];C.create_sensor_manifold(c,"CLOSE_GROUND",C.CT_CONTINUOUS,d,function(a){return a[0]||a[1]||a[2]},l,a);break;case q:d=
C.create_ray_sensor(c,[0,0,1],[0,0,-99],"TERRAIN",!0,!0);d=[d];C.create_sensor_manifold(c,"CLOSE_GROUND",C.CT_CONTINUOUS,d,null,l,a);break;case ea:d=C.create_ray_sensor(c,[0,0,1],[0,0,-99],"TERRAIN",!0,!0),b=C.create_ray_sensor(c,b,[0,0,100],"WATER",!0,!0),d=[d],C.create_sensor_manifold(c,"CLOSE_WATER",C.CT_CONTINUOUS,[b],null,l,a),C.create_sensor_manifold(c,"CLOSE_GROUND",C.CT_CONTINUOUS,d,null,l,a)}}function b(a){var b=a.collider;if(a.type==q){var c=C.create_collision_sensor(b,"CONSTRUCTION",!1);
C.create_sensor_manifold(b,"CONSTRUCTION_COLL",C.CT_CONTINUOUS,[c],null,function(b,c,d){1==d?(I.copy(a.base_pos,a.destination),a.rotation_mult=4):a.rotation_mult=1})}}function f(a){var b=a.rig;if(!t.is_play(b))return!0;b=t.get_current_anim_name(b);if(!b)return!0;var c=a.actions;switch(a.state){case 10:if(!c.idle)return!1;c.idle.indexOf(b);break;case 20:if(!c.move||-1!=c.move.indexOf(b)||c.move_start&&-1!=c.move_start.indexOf(b)||c.move_blends&&-1!=c.move_blends.indexOf(b))return!1;break;default:return!1}return!0}
var t=Object(R.a)(e),C=Object(V.a)(e),z=Object(y.a)(e),G=Object(d.a)(e),E=Object(k.a)(e),J=Object(A.a)(e),M=Object(r.a)(e),F=Object(p.a)(e),U=[],K=new Float32Array(3),sa=new Float32Array(3),v=new Float32Array(3),Y=new Float32Array(3),ha=new Float32Array(4),S=new Float32Array(4),L=new Float32Array(4),q=a.NT_WALKING=10,w=a.NT_FLYING=20,ea=a.NT_SWIMMING=30;a.new_event_track=function(a){var b={obj:null,rig:null,collider:null,empty:null,type:q,state:10,actions:{},base_pos:new Float32Array(3),destination:new Float32Array(3),
path:[],start:[],ended:[],fired:[],delay:[],random:!0,reached:!0,ground_level:0,vert_correction:0,vert_cor_water:0,rotation_mult:1,speed:1,rot_speed:.1,max_height:0,min_height:0,max_depth:0,min_depth:0};if("object"!=typeof a.obj)M.error("Can't create event track. Wrong object.");else if("object"!=typeof a.rig)M.error("Can't create event track. Wrong rig object.");else if("object"==typeof a.collider&&J.has_physics(a.collider)){b.obj=a.obj;b.collider=a.collider;b.rig=a.rig;E.get_translation(a.collider,
b.base_pos);"object"==typeof a.actions&&(b.actions=a.actions);"boolean"==typeof a.random&&(b.random=a.random);"number"==typeof a.type&&(b.type=a.type);"number"==typeof a.speed&&(b.speed=a.speed);"number"==typeof a.rot_speed&&(b.rot_speed=a.rot_speed);"number"==typeof a.max_height&&(b.max_height=a.max_height);"number"==typeof a.min_height&&(b.min_height=a.min_height);if(!b.random){for(var c=0;c<a.path.length;c++)b.start[c]=-1,b.ended[c]=!1,b.fired[c]=!1;b.path=a.path;b.delay=a.delay}a=a.actions;var c=
t.get_current_anim_name(b.rig),d;for(d in a)for(var e=a[d],f=0;f<e.length;f++)t.apply(b.rig,e[f]);c&&t.apply(b.rig,c);U.push(b)}else M.error("Can't create event track. Wrong collider object.")};a.enable_animation=function(){if(U.length){c();var a=C.create_elapsed_sensor();C.create_sensor_manifold(U[0].collider,"ELAPSED",C.CT_CONTINUOUS,[a],function(a){return a[0]},function(a,b,c){if(1==c)for(a=C.get_sensor_value(a,b,0),b=0;b<U.length;b++){var d;c=U[b];d=a;if(z.is_visible(c.obj))if(c.random)u(d,c);
else{for(var e=G.get_timeline(),f=0;f<c.path.length;f++)if(!c.ended[f]){c.fired[f]||(c.fired[f]=!0,c.destination[0]=c.path[f][0],c.destination[1]=c.path[f][1],c.destination[2]=c.path[f][2],c.start[f]=e+c.delay[f]);if(e<c.start[f])break;u(d,c);c.ended[f]=c.reached;break}a:{for(d=0;d<c.path.length;d++)if(0==c.ended[d]){d=!1;break a}d=!0}if(d)for(d=0;d<c.path.length;d++)c.fired[d]=!1,c.ended[d]=!1}}})}};a.disable_animation=function(){if(!(0>=U.length))for(var a=0;a<U.length;a++){var b=U[a];C.check_sensor_manifolds(b.collider)&&
C.remove_sensor_manifold(b.collider);t.is_play(b.rig)&&t.stop(b.rig)}}});t.a=e},function(C,t,e){C=e(0);var R=e(40);e=Object(C.a)("preloader",function(e,n){var t=Object(R.a)(e),d,k,C,A,r,p,u,a,B=null;n.create_preloader=function(a){var c="#484848",e="#5276cf",b="rgba(150, 150, 150, 0.7)",f="#fff",l;for(l in a)switch(l){case "container_color":c=a.container_color;break;case "bar_color":e=a.bar_color;break;case "frame_color":b=a.frame_color;break;case "font_color":f=a.font_color}a=document.createElement("div");
l=a.cloneNode(!1);var n=a.cloneNode(!1),p=a.cloneNode(!1),r=t.get_container();n.appendChild(l);n.appendChild(p);a.appendChild(n);r.appendChild(a);a.style.cssText="background-color: "+c+";width: 100%;height: 100%;position: absolute;top: 0;left: 0;";n.style.cssText="position: absolute;left: 50%;top: 50%;margin-left: -150px;margin-top: -30px;width: 300px;height: 28px;box-shadow: 0px 0px 10px 0px "+b+";border: 2px solid "+b+";";l.style.cssText="position: absolute;width: 0%;top: 0;left: 0;background-color: "+
e+";height: 100%;";p.style.cssText="font-family: Arial, sans-serif;line-height: 28px;height: 100%;width: 100%;top: 0;left: 0;text-align: center;position: absolute;font-size: 16px;font-weight: bold;text-shadow: 0px 0px 6px "+b+";color: "+f+";";d=l;k=p;C=a;A="DEFAULT"};n.create_simple_preloader=function(a){var c=null,e=null,b="#bf9221",f="#000",l;for(l in a)switch(l){case "canvas_container_id":c=a.canvas_container_id;break;case "background_container_id":e=a.background_container_id;break;case "bg_color":f=
a.bg_color;break;case "bar_color":b=a.bar_color}a=document.createElement("div");l=document.createElement("div");a.id="simple_preloader_container";var n=document.createElement("div"),p=document.createElement("div"),e=document.getElementById(e);B=document.getElementById(c);a.style.cssText="z-index: 4;background-color: "+f+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;";l.style.cssText="position: absolute;left: 50%;top: 82%;width: 300px;height: 20px;margin-left: -150px;margin-top: -10px;border-style:solid;border-width:4px;border-color: #000;border-radius: 0px;";
n.style.cssText="position: absolute;left: 0px;top: 1px;width: 0px;height: 18px;background-color: "+b+";border-radius: 0px;";p.style.cssText="position: absolute;left: 50%;top: 50%;width: 100%;height: 100%;margin-left: -150px;margin-top: -10px;text-align: center;font-size: 17px;font-weight: bold;color: #000;font-family: Verdana;"+l.appendChild(n);l.appendChild(p);a.appendChild(l);document.body.appendChild(a);A="SIMPLE";C=a;d=n;k=p;r=e};n.create_rotation_preloader=function(a){var c=null,d=null,b="rgba(0,0,0,0)",
e="",l="",n="rgba(0,0,0,0)",u;for(u in a)switch(u){case "canvas_container_id":c=a.canvas_container_id;break;case "background_container_id":d=a.background_container_id;break;case "frame_bg_color":b=a.frame_bg_color;break;case "bg_color":n=a.bg_color;break;case "frame_class":e=a.frame_class;break;case "anim_elem_class":l=a.anim_elem_class}a=document.createElement("div");u=document.createElement("div");var t=document.createElement("div"),y=document.createElement("div"),d=document.getElementById(d);B=
document.getElementById(c);a.style.cssText="z-index: 4;background-color: "+n+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;";u.style.cssText="position: absolute;left: 50%;top: 50%;width: 117px;height: 117px;margin-left: -58px;margin-top: -58px;background-color: "+b+";";t.style.cssText="position: absolute;left: 0px;top: 0px;width: 100%;height: 100%;background-position: center;background-repeat: no-repeat;";y.style.cssText="position: absolute;width: 100%;height: 100%;text-align: center;margin-top: 38px;font-size: 36px;color: #ffffff;font-family: Arial;font-weight: bold;";
t.className=l;u.appendChild(t);u.className=e;u.appendChild(y);a.appendChild(u);B.appendChild(a);A="ROTATION";C=a;p=t;k=y;r=d};n.create_advanced_preloader=function(e){var c=e.preloader_width,l=e.canvas_container_id,c=c/(c-e.img_width),b=document.getElementById(e.preloader_bar_id),f=document.getElementById(e.fill_band_id),n=document.getElementById(e.preloader_caption_id),p=document.getElementById(e.preloader_container_id);e=document.getElementById(e.background_container_id);B=document.getElementById(l);
A="ADVANCED";d=b;u=f;a=c;k=n;C=p;r=e};n.update_preloader=function(e){k.innerHTML=e+"%";"SIMPLE"==A?d.style.width=e+"%":"ADVANCED"==A?(d.style.width=e/a+"%",u.style.width=100-e+"%"):"ROTATION"==A?p.style.transform="rotate("+e+"deg)":"DEFAULT"==A&&(d.style.width=e+"%");100==e&&(C.parentNode.removeChild(C),r&&r.parentNode.removeChild(r))}});t.a=e},function(C,t,e){C=e(0);var R=e(50),V=e(1);e=Object(C.a)("screenshooter",function(e,t){var d=Object(R.a)(e),k=Object(V.a)(e);t.shot=function(e,n){k.error_deprecated("shot",
"screen.shot");d.shot(e,n)}});t.a=e},function(C,t,e){C=e(0);var R=e(55);e=Object(C.a)("anchors",function(e,n){var t=Object(R.a)(e);n.attach_move_cb=t.attach_move_cb;n.detach_move_cb=t.detach_move_cb;n.is_anchor=t.is_anchor;n.get_element_id=t.get_element_id;n.update=function(){t.update(!0)}});t.a=e},function(C,t,e){C=e(0);var R=e(56),V=e(9),n=e(13),y=e(1),d=e(6);e=Object(C.a)("armature",function(e,t){var k=Object(V.a)(e),r=Object(n.a)(e),p=Object(y.a)(e);t.get_bone_tsr=function(e,a,n){if(!k.is_armature(e))return null;
if(!R.a(e,a))return p.error('There is no bone: "',a,'" in "',e.name,'".'),null;n||(n=d.b());R.b(e,a,!1,!1,n);return n};t.get_bone_tsr_rel=function(e,a,n){if(!k.is_armature(e))return null;if(!R.a(e,a))return p.error('There is no bone: "',a,'" in "',e.name,'".'),null;n||(n=d.b());R.b(e,a,!1,!0,n);return n};t.set_bone_tsr=function(d,a,e){k.is_armature(d)&&(R.a(d,a)?(R.c(d,a,e,!1),r.update_transform(d)):p.error('There is no bone: "',a,'" in "',d.name,'".'))};t.set_bone_tsr_rel=function(d,a,e){k.is_armature(d)&&
(R.a(d,a)?(R.c(d,a,e,!0),r.update_transform(d)):p.error('There is no bone: "',a,'" in "',d.name,'".'))}});t.a=e},function(C,t,e){C=e(0);var R=e(44);e=Object(C.a)("assets",function(e,n){var t=Object(R.a)(e);n.AT_ARRAYBUFFER=t.AT_ARRAYBUFFER;n.AT_ARRAYBUFFER_ZIP=t.AT_ARRAYBUFFER_ZIP;n.AT_JSON=t.AT_JSON;n.AT_JSON_ZIP=t.AT_JSON_ZIP;n.AT_TEXT=t.AT_TEXT;n.AT_AUDIOBUFFER=t.AT_AUDIOBUFFER;n.AT_IMAGE_ELEMENT=t.AT_IMAGE_ELEMENT;n.AT_AUDIO_ELEMENT=t.AT_AUDIO_ELEMENT;n.AT_VIDEO_ELEMENT=t.AT_VIDEO_ELEMENT;n.AT_SEQ_VIDEO_ELEMENT=
t.AT_SEQ_VIDEO_ELEMENT;n.enqueue=function(d,e,n,y){d.length&&t.enqueue(d,e,n,y)}});t.a=e},function(C,t,e){C=e(0);var R=e(16),V=e(20),n=e(1),y=e(22),d=e(36);e=Object(C.a)("geometry",function(e,t){var k=Object(R.a)(e),r=Object(V.a)(e),p=Object(n.a)(e),u=Object(y.a)(e);t.extract_vertex_array=function(a,d,e){if(!r.has_dyn_geom(a))return p.error("Wrong object:",a.name),null;if(a=k.find_batch_material(a,d,"MAIN")){if((d=a.bufs_data)&&d.pointers&&("a_normal"==e&&d.pointers.a_tbn||d.pointers[e]))return r.extract_array_float(d,
e);p.error("Attribute not found:"+e);return null}p.error("Wrong material:",d);return null};t.extract_index_array=function(a,d){if(!r.has_dyn_geom(a))return p.error("Wrong object:",a.name),null;var e=k.find_batch_material(a,d,"MAIN");if(e){if((e=e.bufs_data)&&e.pointers)return e.ibo_array;p.error("Buffer data not found");return null}p.error("Wrong material:",d);return null};t.update_vertex_array=function(a,d,e,c){if(r.has_dyn_geom(a))for(var l=["MAIN","SHADOW","COLOR_ID"],b=0;b<l.length;b++){var f=
k.find_batch_material(a,d,l[b]);f&&(f=f.bufs_data)&&f.pointers&&("a_normal"==e&&f.pointers.a_tbn||f.pointers[e])&&r.update_bufs_data_array(f,e,0,c)}else p.error("Wrong object:",a.name)};t.override_geometry=function(a,e,l,c,m){if(r.has_dyn_geom(a))if(l instanceof Uint16Array||l instanceof Uint32Array)if(c instanceof Float32Array)for(var b=["MAIN","SHADOW","COLOR_ID"],f=0;f<b.length;f++){var n=k.find_batch_material(a,e,b[f]);if(n){var t=n.bufs_data;if(t){r.update_bufs_data_index_array(t,n.draw_mode,
l);var z={},y;for(y in t.pointers){var A=t.pointers[y],A=c.length/3*A.num_comp,B=r.get_vbo_type_by_attr_name(y);z[B]||(z[B]=0);z[B]+=A}B=r.init_vbo_source_data(z);t.vbo_source_data=B;z={};for(y in t.pointers)switch(A=t.pointers[y],B=r.get_vbo_type_by_attr_name(y),z[B]||(z[B]=0),y){case "a_position":r.vbo_source_data_set_attr(t.vbo_source_data,"a_position",c,z[B]);A.offset=z[B];A.length=c.length;z[B]+=A.length;break;case "a_tbn":var C;m&&(C=r.calc_shared_indices(l,c,c));var F=r.calc_normals(l,c,C);
A.length=c.length/3*A.num_comp;for(var I=new Float32Array(A.length),K=0;K<I.length;K+=4)I[K]=1,I[K+3]=1;F=d.d(F,I);r.vbo_source_data_set_attr(t.vbo_source_data,"a_tbn",F,z[B]);A.offset=z[B];z[B]+=A.length;break;default:A.offset=z[B],A.length=c.length/3*A.num_comp,F=new (r.get_constructor_by_type(B))(A.length),r.vbo_source_data_set_attr(t.vbo_source_data,y,F,z[B]),z[B]+=A.length}r.update_gl_buffers(t);u.assign_attribute_setters(n);(n=k.find_batch_material_forked(a,n))&&n.bufs_data&&(n.bufs_data=t)}}}else p.error("Wrong positions_array type");
else p.error("Wrong ibo_array type");else p.error("Wrong object:",a.name)};t.set_shape_key_value=function(a,d,e){r.check_shape_keys(a)?r.has_shape_key(a,d)?(e=parseFloat(e),r.apply_shape_key(a,d,e)):p.error("Wrong key name:",d):p.error("Wrong object:",a.name)};t.check_shape_keys=function(a){return r.check_shape_keys(a)};t.get_shape_keys_names=function(a){return r.check_shape_keys(a)?r.get_shape_keys_names(a):(p.error("Wrong object:",a.name),[])};t.get_shape_key_value=function(a,d){return r.check_shape_keys(a)?
r.has_shape_key(a,d)?r.get_shape_key_value(a,d):(p.error("Wrong key name:",d),0):(p.error("Wrong object:",a.name),0)};t.draw_line=function(a,d,e){e=e||!1;if(d instanceof Float32Array){if(a=k.get_first_batch(a))r.draw_line(a,d,e),u.assign_attribute_setters(a)}else p.error("Wrong positions type")}});t.a=e},function(C,t,e){C=e(0);var R=e(51),V=e(1);e=Object(C.a)("hud",function(e,t){var d=Object(R.a)(e),k=Object(V.a)(e);t.draw_mixer_strip=function(e,n,r,p,t,a,y){k.error_deprecated("draw_mixer_strip",
"screen.draw_mixer_strip");d.draw_mixer_strip(e,n,r,p,t,a,y)};t.plot_array=function(e,n,r,p,t,a,y){k.error_deprecated("plot_array","screen.plot_array");d.plot_array(e,n,r,p,t,a,y)}});t.a=e},function(C,t,e){C=e(0);var R=e(57),V=e(12),n=e(9),y=e(1),d=e(8),k=e(10),I=e(13),A=e(6),r=e(2),p=e(3);e=Object(C.a)("lights",function(e,a){function t(a){for(var d=f.get_active(),e=c.get_scene_objs(d,"LAMP",c.DATA_ID_ALL),k=0;k<e.length;k++){var l=e[k];if("SUN"==l.light.type){var m=l;break}}if(!m)b.error("There is no sun on the scene");
else if("number"==typeof a.hor_position&&"number"==typeof a.vert_position){e=r.T(180-a.hor_position);a=r.T(90-a.vert_position);k=m.render;u.set_rotation_euler(m,[a,0,e]);e=new Float32Array(3);l=A.g(k.world_tsr,F);r._34(l,r.f,e);k=A.j(k.world_tsr,M);k=p.length(k);p.copy(e,C);p.scale(C,k,C);u.set_translation(m,C);u.update_transform(m);e=m.light;if(e.dynamic_intensity){k=d.world.horizon_color;l=d.world.zenith_color;a=Math.cos(Math.abs(a));var n=Math.max(a,.1)*d.world.light_settings.environment_energy;
R.d(e,Math.max(Math.min(3*a,1),0)*e.default_energy);f.set_environment_colors(d,n,k,l)}f.update_lamp_scene(m,d)}}function l(a){if(m.is_lamp(a))return a.light.type;b.error("get_light_type(): Wrong object");return""}var c=Object(V.a)(e),m=Object(n.a)(e),b=Object(y.a)(e),f=Object(k.a)(e),u=Object(I.a)(e),C=new Float32Array(3),z,G,E,J=60,M=p.create(),F=d.create();a.get_lamps=function(a){var b=f.get_active(),b=c.get_scene_objs(b,"LAMP",c.DATA_ID_ALL);if(!a)return b;for(var d=[],e=0;e<b.length;e++){var k=
b[e];k.light.type===a&&d.push(k)}return d};a.get_sun_params=function(){for(var a=f.get_active(),a=c.get_scene_objs(a,"LAMP",c.DATA_ID_ALL),b=null,d=0;d<a.length;d++){var e=a[d];if("SUN"==e.light.type){b=e;break}}return b?(b=b.light.direction,a=r._39(Math.atan2(-b[1],b[0]))+90,180<a&&(a-=360),b=r._39(Math.atan2(b[2],Math.sqrt(b[0]*b[0]+b[1]*b[1]))),d={},d.hor_position=a,d.vert_position=b,d):null};a.set_sun_params=t;a.set_day_time=function(a){for(var d=f.get_active(),d=c.get_scene_objs(d,"LAMP",c.DATA_ID_ALL),
e=0;e<d.length;e++){var k=d[e];if("SUN"==k.light.type){var l=k;break}}l?(l=-Math.cos(a/12*Math.PI)*J,d={},d.hor_position=12>a?15*a:15*(a-24),d.vert_position=l,t(d)):b.error("There is no sun on the scene")};a.set_date=function(a){z=a.getFullYear();G=a.getMonth();E=a.getDate();z?1582==z&&9==G&&4<E&&15>E&&b.error("The dates 5 through 14 October, 1582, do not exist in the Gregorian system!"):b.error("There is no year 0 in the Julian system!")};a.set_max_sun_angle=function(a){J=Math.min(Math.max(a,0),
90)};a.get_light_params=function(a){if(m.is_lamp(a))var c=a.light;else return b.error("get_light_params(): Wrong object"),null;if(a=l(a))switch(a){case "SPOT":var d={light_type:a,light_color:new Float32Array(3),light_energy:c.energy,light_spot_blend:c.spot_blend,light_spot_size:c.spot_size,light_distance:c.distance};d.light_color.set(c.color);break;case "POINT":d={light_type:a,light_color:new Float32Array(3),light_energy:c.energy,light_distance:c.distance};d.light_color.set(c.color);break;default:d=
{light_type:a,light_color:new Float32Array(3),light_energy:c.energy},d.light_color.set(c.color)}return d?d:null};a.get_light_type=l;a.set_light_params=function(a,c){if(m.is_lamp(a)){var d=a.light,e=f.get_active(),k=!1;"number"==typeof c.light_energy&&R.d(d,c.light_energy);"object"==typeof c.light_color&&R.b(d,c.light_color);"number"==typeof c.light_spot_blend&&(R.e(d,c.light_spot_blend),k=!0);"number"==typeof c.light_spot_size&&(R.f(d,c.light_spot_size),k=!0);"number"==typeof c.light_distance&&(R.c(d,
c.light_distance),k=!0);f.update_lamp_scene(a,e);k&&f.update_all_mesh_shaders(e)}else b.error("set_light_params(): Wrong object")};a.get_light_energy=function(a){return m.is_lamp(a)?a.light.energy:(b.error("get_light_energy(): Wrong object"),0)};a.set_light_energy=function(a,c){if(m.is_lamp(a)){var d=f.get_active();R.d(a.light,c);f.update_lamp_scene(a,d)}else b.error("set_light_energy(): Wrong object")};a.get_light_color=function(a,c){if(!m.is_lamp(a))return b.error("get_light_color(): Wrong object"),
null;c=c||new Float32Array(3);c.set(a.light.color);return c};a.set_light_color=function(a,c){if(m.is_lamp(a)){var d=f.get_active();R.b(a.light,c);f.update_lamp_scene(a,d)}else b.error("set_light_color(): Wrong object")}});t.a=e},function(C,t,e){C=e(0);var R=e(59);e=Object(C.a)("logic_nodes",function(e,n){var t=Object(R.a)(e);n.append_custom_callback=function(d,e){t.append_custom_cb(d,e)};n.remove_custom_callback=function(d){t.remove_custom_cb(d)};n.run_entrypoint=function(d,e){t.run_ep(d,e)}});t.a=
e},function(C,t,e){C=e(0);var R=e(16),V=e(4),n=e(20),y=e(12),d=e(9),k=e(1),I=e(34),A=e(2),r=e(10);e=Object(C.a)("material",function(e,t){var a=Object(R.a)(e),p=Object(V.a)(e),l=Object(n.a)(e),c=Object(y.a)(e),m=Object(d.a)(e),b=Object(k.a)(e),f=Object(I.a)(e),u=Object(r.a)(e),C=p.defaults;t.inherit_material=function(a,d,e,f){if(l.has_dyn_geom(e)&&l.has_dyn_geom(a)){var k=a.mat_inheritance_data.original_mat_names.indexOf(d);if(-1==k)b.error('inherit_material(): material "'+d+'" not found on the object "'+
a.origin_name+'".');else{var m=e.mat_inheritance_data.original_mat_names.indexOf(f);-1==m?b.error('inherit_material(): material "'+f+'" not found on the object "'+e.origin_name+'".'):(0==e._bpy_obj.data.submeshes[m].shade_tangs.length&&a.materials[k].use_tangent_shading&&b.warn('The target material "'+f+'" was exported without tangent shading data. However, the "'+d+'" material requires it. It\'s needed to enable the "Tangent Shading" option on the target material for correct rendering.'),c.inherit_material(a,
d,e,f))}}else b.error('inherit_material(): both objects "'+a.origin_name+'" and "'+e.origin_name+'" must have the "Dynamic Geometry & Materials" flag enabled.')};t.get_materials_names=function(a){var c=[];if(!m.is_dynamic_mesh(a))return b.error('get_materials_names(): Object "'+a.name+'" is not a dynamic MESH.'),c;a=a.scenes_data;for(var d=0;d<a.length;d++)for(var e=a[d].batches,f=0;f<e.length;f++){var k=e[f];if("MAIN"==k.type)for(var l=0;l<k.material_names.length;l++)-1==c.indexOf(k.material_names[l])&&
c.push(k.material_names[l])}return c};t.set_diffuse_color=function(c,d,e){if(m.is_dynamic_mesh(c)){var f=a.find_batch_material(c,d,"MAIN");f?f.has_nodes?b.error("set_diffuse_color(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead."):(f.diffuse_color.set(e),(c=a.find_batch_material_forked(c,d,"MAIN"))&&c.diffuse_color.set(e)):b.error('set_diffuse_color(): Material "'+d+'" wasn\'t found on the object "'+c.name+'".')}else b.error('set_diffuse_color(): Object "'+
c.name+'" is not a dynamic MESH.')};t.get_diffuse_color=function(c,d){var e=new Float32Array(4);if(!m.is_dynamic_mesh(c))return b.error('get_diffuse_color(): Object "'+c.name+'" is not a dynamic MESH.'),e;var f=a.find_batch_material(c,d,"MAIN");if(!f)return b.error('get_diffuse_color(): Material "'+d+'" wasn\'t found on the object "'+c.name+'".'),e;if(f.has_nodes)return b.error("get_diffuse_color(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),e;e.set(f.diffuse_color);
return e};t.set_diffuse_intensity=function(c,d,e){if(m.is_dynamic_mesh(c)){var f=a.find_batch_material(c,d,"MAIN");if(f)if(f.has_nodes)b.error("set_diffuse_intensity(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");else{if(f.diffuse_intensity=e,c=a.find_batch_material_forked(c,d,"MAIN"))c.diffuse_intensity=e}else b.error('set_diffuse_intensity(): Material "'+d+'" wasn\'t found on the object "'+c.name+'".')}else b.error('set_diffuse_intensity(): Object "'+
c.name+'" is not a dynamic MESH.')};t.get_diffuse_intensity=function(c,d){if(!m.is_dynamic_mesh(c))return b.error('get_diffuse_intensity(): Object "'+c.name+'" is not a dynamic MESH.'),0;var e=a.find_batch_material(c,d,"MAIN");return e?e.has_nodes?(b.error("get_diffuse_intensity(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):e.diffuse_intensity:(b.error('get_diffuse_intensity(): Material "'+d+'" wasn\'t found on the object "'+c.name+'".'),0)};t.set_specular_color=
function(c,d,e){if(m.is_dynamic_mesh(c)){var f=a.find_batch_material(c,d,"MAIN");f?f.has_nodes?b.error("set_specular_color(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead."):(f.specular_color.set(e),(c=a.find_batch_material_forked(c,d,"MAIN"))&&c.specular_color.set(e)):b.error('set_specular_color(): Material "'+d+'" wasn\'t found on the object "'+c.name+'".')}else b.error('set_specular_color(): Object "'+c.name+'" is not a dynamic MESH.')};t.get_specular_color=
function(c,d){var e=new Float32Array(3);if(!m.is_dynamic_mesh(c))return b.error('get_specular_color(): Object "'+c.name+'" is not a dynamic MESH.'),e;var f=a.find_batch_material(c,d,"MAIN");if(!f)return b.error('get_specular_color(): Material "'+d+'" wasn\'t found on the object "'+c.name+'".'),e;if(f.has_nodes)return b.error("get_specular_color(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),e;e.set(f.specular_color);return e};t.set_specular_color_factor=
function(c,d,e){if(m.is_dynamic_mesh(c)){var f=a.find_batch_material(c,d,"MAIN");if(f)if(f.has_nodes)b.error("set_specular_color_factor(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");else{if(f.specular_color_factor=e,c=a.find_batch_material_forked(c,d,"MAIN"))c.specular_color_factor=e}else b.error('set_specular_color_factor(): Material "'+d+'" wasn\'t found on the object "'+c.name+'".')}else b.error('set_specular_color_factor(): Object "'+c.name+'" is not a dynamic MESH.')};
t.get_specular_color_factor=function(c,d){if(!m.is_dynamic_mesh(c))return b.error('get_specular_color_factor(): Object "'+c.name+'" is not a dynamic MESH.'),0;var e=a.find_batch_material(c,d,"MAIN");return e?e.has_nodes?(b.error("get_specular_color_factor(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):e.specular_color_factor:(b.error('get_specular_color_factor(): Material "'+d+'" wasn\'t found on the object "'+c.name+'".'),0)};t.set_specular_intensity=
function(c,d,e){if(m.is_dynamic_mesh(c)){var f=a.find_batch_material(c,d,"MAIN");f?f.has_nodes?b.error("set_specular_intensity(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead."):(f.specular_params[0]=e,(c=a.find_batch_material_forked(c,d,"MAIN"))&&(c.specular_params[0]=e)):b.error('set_specular_intensity(): Material "'+d+'" wasn\'t found on the object "'+c.name+'".')}else b.error('set_specular_intensity(): Object "'+c.name+'" is not a dynamic MESH.')};t.get_specular_intensity=
function(c,d){if(!m.is_dynamic_mesh(c))return b.error('get_specular_intensity(): Object "'+c.name+'" is not a dynamic MESH.'),0;var e=a.find_batch_material(c,d,"MAIN");return e?e.has_nodes?(b.error("get_specular_intensity(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):e.specular_params[0]:(b.error('get_specular_intensity(): Material "'+d+'" wasn\'t found on the object "'+c.name+'".'),0)};t.check_specular_intensity=function(c,d){b.error_once("check_specular_intensity() is deprecated, not needed anymore");
var e=a.find_batch_material(c,d,"MAIN");return!(!e||!e.specular_params[0])};t.set_specular_hardness=function(c,d,e){if(m.is_dynamic_mesh(c)){var f=a.find_batch_material(c,d,"MAIN");f?f.has_nodes?b.error("set_specular_hardness(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead."):(f.specular_params[1]=e,(c=a.find_batch_material_forked(c,d,"MAIN"))&&(c.specular_params[1]=e)):b.error('set_specular_hardness(): Material "'+d+'" wasn\'t found on the object "'+c.name+
'".')}else b.error('set_specular_hardness(): Object "'+c.name+'" is not a dynamic MESH.')};t.get_specular_hardness=function(c,d){if(!m.is_dynamic_mesh(c))return b.error('get_specular_hardness(): Object "'+c.name+'" is not a dynamic MESH.'),0;var e=a.find_batch_material(c,d,"MAIN");return e?e.has_nodes?(b.error("get_specular_hardness(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):e.specular_params[1]:(b.error('get_specular_hardness(): Material "'+d+'" wasn\'t found on the object "'+
c.name+'".'),0)};t.check_specular_hardness=function(c,d){b.error_once("check_specular_hardness() is deprecated, not needed anymore");var e=a.find_batch_material(c,d,"MAIN");return!(!e||!e.specular_params[1])};t.set_emit_factor=function(c,d,e){if(m.is_dynamic_mesh(c)){var f=a.find_batch_material(c,d,"MAIN");if(f)if(f.has_nodes)b.error("set_emit_factor(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");else{if(f.emit=e,c=a.find_batch_material_forked(c,d,"MAIN"))c.emit=
e}else b.error('set_emit_factor(): Material "'+d+'" wasn\'t found on the object "'+c.name+'".')}else b.error('set_emit_factor(): Object "'+c.name+'" is not a dynamic MESH.')};t.get_emit_factor=function(c,d){if(!m.is_dynamic_mesh(c))return b.error('get_emit_factor(): Object "'+c.name+'" is not a dynamic MESH.'),0;var e=a.find_batch_material(c,d,"MAIN");return e?e.has_nodes?(b.error("get_emit_factor(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):e.emit:
(b.error('get_emit_factor(): Material "'+d+'" wasn\'t found on the object "'+c.name+'".'),0)};t.set_ambient_factor=function(c,d,e){if(m.is_dynamic_mesh(c)){var f=a.find_batch_material(c,d,"MAIN");if(f)if(f.has_nodes)b.error("set_ambient_factor(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");else{if(f.ambient=e,c=a.find_batch_material_forked(c,d,"MAIN"))c.ambient=e}else b.error('set_ambient_factor(): Material "'+d+'" wasn\'t found on the object "'+c.name+
'".')}else b.error('set_ambient_factor(): Object "'+c.name+'" is not a dynamic MESH.')};t.get_ambient_factor=function(c,d){if(!m.is_dynamic_mesh(c))return b.error('get_ambient_factor(): Object "'+c.name+'" is not a dynamic MESH.'),0;var e=a.find_batch_material(c,d,"MAIN");return e?e.has_nodes?(b.error("get_ambient_factor(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):e.ambient:(b.error('get_ambient_factor(): Material "'+d+'" wasn\'t found on the object "'+
c.name+'".'),0)};t.set_diffuse_color_factor=function(c,d,e){if(m.is_dynamic_mesh(c)){var f=a.find_batch_material(c,d,"MAIN");if(f)if(f.has_nodes)b.error("set_diffuse_color_factor(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");else{if(f.diffuse_color_factor=e,c=a.find_batch_material_forked(c,d,"MAIN"))c.diffuse_color_factor=e}else b.error('set_diffuse_color_factor(): Material "'+d+'" wasn\'t found on the object "'+c.name+'".')}else b.error('set_diffuse_color_factor(): Object "'+
c.name+'" is not a dynamic MESH.')};t.get_diffuse_color_factor=function(c,d){if(!m.is_dynamic_mesh(c))return b.error('get_diffuse_color_factor(): Object "'+c.name+'" is not a dynamic MESH.'),0;var e=a.find_batch_material(c,d,"MAIN");return e?e.has_nodes?(b.error("get_diffuse_color_factor(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):e.diffuse_color_factor:(b.error('get_diffuse_color_factor(): Material "'+d+'" wasn\'t found on the object "'+c.name+'".'),
0)};t.set_alpha_factor=function(c,d,e){if(m.is_dynamic_mesh(c)){var f=a.find_batch_material(c,d,"MAIN");if(f)if(f.has_nodes)b.error("set_alpha_factor(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");else{if(f.alpha_factor=e,c=a.find_batch_material_forked(c,d,"MAIN"))c.alpha_factor=e}else b.error('set_alpha_factor(): Material "'+d+'" wasn\'t found on the object "'+c.name+'".')}else b.error('set_alpha_factor(): Object "'+c.name+'" is not a dynamic MESH.')};
t.get_alpha_factor=function(c,d){if(!m.is_dynamic_mesh(c))return b.error('get_alpha_factor(): Object "'+c.name+'" is not a dynamic MESH.'),0;var e=a.find_batch_material(c,d,"MAIN");return e?e.has_nodes?(b.error("get_alpha_factor(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):e.alpha_factor:(b.error('get_alpha_factor(): Material "'+d+'" wasn\'t found on the object "'+c.name+'".'),0)};t.get_material_extended_params=function(c,d){if(!m.is_dynamic_mesh(c))return b.error('get_material_extended_params(): Object "'+
c.name+'" is not a dynamic MESH.'),null;var e=a.find_batch_material(c,d,"MAIN");if(!e)return b.error('get_material_extended_params(): Material "'+d+'" wasn\'t found on the object "'+c.name+'".'),null;if(e.has_nodes)return b.error("get_material_extended_params(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),null;var f={};f.reflect_factor=e.reflect_factor;f.fresnel=e.fresnel_params[0];f.fresnel_factor=5*(1-e.fresnel_params[1]);f.parallax_scale=e.parallax_scale;
f.parallax_steps=parseFloat(a.get_batch_directive(e,"PARALLAX_STEPS")[1]);return f};t.set_material_extended_params=function(c,d,e){if(m.is_dynamic_mesh(c)){var k=a.find_batch_material(c,d,"MAIN");if(k)if(k.has_nodes)b.error("set_material_extended_params(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");else{var l=[k];(k=a.find_batch_material_forked(c,d,"MAIN"))&&l.push(k);for(c=0;c<l.length;c++)k=l[c],"number"==typeof e.reflect_factor&&(k.reflect_factor=e.reflect_factor),
"number"==typeof e.fresnel&&(k.fresnel_params[0]=e.fresnel),"number"==typeof e.fresnel_factor&&(k.fresnel_params[1]=1-e.fresnel_factor/5),"number"==typeof e.parallax_scale&&(k.parallax_scale=e.parallax_scale),"number"==typeof e.parallax_steps&&(a.set_batch_directive(k,"PARALLAX_STEPS",f.glsl_value(e.parallax_steps)),a.update_shader(k),u.recalculate_draw_data(k))}else b.error('set_material_extended_params(): Material "'+d+'" wasn\'t found on the object "'+c.name+'".')}else b.error('set_material_extended_params(): Object "'+
c.name+'" is not a dynamic MESH.')};t.get_water_material_params=function(c,d){if(!m.is_dynamic_mesh(c))return b.error('get_water_material_params(): Object "'+c.name+'" is not a dynamic MESH.'),null;var e=a.find_batch_material(c,d,"MAIN");if(!e||!e.water)return b.error('get_water_material_params(): Material "'+d+'" wasn\'t found on the object "'+c.name+"\" or it's not a water material."),null;if(e.has_nodes)return b.error("get_water_material_params(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),
null;var f={};f.shore_smoothing=C.shore_smoothing&&e.water_shore_smoothing&&!!parseFloat(a.get_batch_directive(e,"SHORE_SMOOTHING")[1]);f.absorb_factor=parseFloat(a.get_batch_directive(e,"ABSORB")[1]);f.foam_factor=e.foam_factor;f.shallow_water_col=new Float32Array(3);f.shore_water_col=new Float32Array(3);f.shallow_water_col_fac=0;f.shore_water_col_fac=0;C.shore_distance&&(f.shallow_water_col.set(e.shallow_water_col),f.shore_water_col.set(e.shore_water_col),f.shallow_water_col_fac=e.shallow_water_col_fac,
f.shore_water_col_fac=e.shore_water_col_fac);f.norm_uv_velocity=e.water_norm_uv_velocity;f.water_dynamic=C.water_dynamic&&e.water_dynamic&&!!parseFloat(a.get_batch_directive(e,"DYNAMIC")[1]);f.sss_strength=parseFloat(a.get_batch_directive(e,"SSS_STRENGTH")[1]);f.sss_width=parseFloat(a.get_batch_directive(e,"SSS_WIDTH")[1]);f.waves_height=parseFloat(a.get_batch_directive(e,"WAVES_HEIGHT")[1]);f.waves_length=parseFloat(a.get_batch_directive(e,"WAVES_LENGTH")[1]);f.dst_noise_scale0=parseFloat(a.get_batch_directive(e,
"DST_NOISE_SCALE_0")[1]);f.dst_noise_scale1=parseFloat(a.get_batch_directive(e,"DST_NOISE_SCALE_1")[1]);f.dst_noise_freq0=parseFloat(a.get_batch_directive(e,"DST_NOISE_FREQ_0")[1]);f.dst_noise_freq1=parseFloat(a.get_batch_directive(e,"DST_NOISE_FREQ_1")[1]);f.dir_min_shore_fac=parseFloat(a.get_batch_directive(e,"DIR_MIN_SHR_FAC")[1]);f.dir_freq=parseFloat(a.get_batch_directive(e,"DIR_FREQ")[1]);f.dir_noise_scale=parseFloat(a.get_batch_directive(e,"DIR_NOISE_SCALE")[1]);f.dir_noise_freq=parseFloat(a.get_batch_directive(e,
"DIR_NOISE_FREQ")[1]);f.dir_min_noise_fac=parseFloat(a.get_batch_directive(e,"DIR_MIN_NOISE_FAC")[1]);f.dst_min_fac=parseFloat(a.get_batch_directive(e,"DST_MIN_FAC")[1]);f.waves_hor_fac=parseFloat(a.get_batch_directive(e,"WAVES_HOR_FAC")[1]);return f};t.set_water_material_params=function(c,d,e){if(m.is_dynamic_mesh(c)){var k=a.find_batch_material(c,d,"MAIN");if(k&&k.water)if(k.has_nodes)b.error("set_water_material_params(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");
else{var l=[k];(k=a.find_batch_material_forked(c,d,"MAIN"))&&l.push(k);for(c=0;c<l.length;c++)k=l[c],"boolean"==typeof e.shore_smoothing&&(C.shore_smoothing&&k.water_shore_smoothing&&e.shore_smoothing?a.set_batch_directive(k,"SHORE_SMOOTHING",1):a.set_batch_directive(k,"SHORE_SMOOTHING",0)),"number"==typeof e.absorb_factor&&(d=f.glsl_value(parseFloat(e.absorb_factor)),a.set_batch_directive(k,"ABSORB",d)),"number"==typeof e.foam_factor&&C.foam&&(k.foam_factor=e.foam_factor),C.shore_distance&&("object"==
typeof e.shallow_water_col&&k.shallow_water_col.set(e.shallow_water_col),"number"==typeof e.shallow_water_col_fac&&(k.shallow_water_col_fac=e.shallow_water_col_fac),"object"==typeof e.shore_water_col&&k.shore_water_col.set(e.shore_water_col),"number"==typeof e.shore_water_col_fac&&(k.shore_water_col_fac=e.shore_water_col_fac)),"number"==typeof e.norm_uv_velocity&&(k.water_norm_uv_velocity=e.norm_uv_velocity),C.water_dynamic&&k.water_dynamic&&("boolean"==typeof e.water_dynamic&&(e.water_dynamic?a.set_batch_directive(k,
"DYNAMIC",1):a.set_batch_directive(k,"DYNAMIC",0)),"number"==typeof e.sss_strength&&(d=f.glsl_value(parseFloat(e.sss_strength)),a.set_batch_directive(k,"SSS_STRENGTH",d)),"number"==typeof e.sss_width&&(d=f.glsl_value(parseFloat(e.sss_width)),a.set_batch_directive(k,"SSS_WIDTH",d)),"number"==typeof e.waves_height&&(d=f.glsl_value(parseFloat(e.waves_height)),a.set_batch_directive(k,"WAVES_HEIGHT",d)),"number"==typeof e.waves_length&&(d=f.glsl_value(parseFloat(e.waves_length)),a.set_batch_directive(k,
"WAVES_LENGTH",d)),"number"==typeof e.dst_noise_scale0&&(d=f.glsl_value(parseFloat(e.dst_noise_scale0)),a.set_batch_directive(k,"DST_NOISE_SCALE_0",d)),"number"==typeof e.dst_noise_scale1&&(d=f.glsl_value(parseFloat(e.dst_noise_scale1)),a.set_batch_directive(k,"DST_NOISE_SCALE_1",d)),"number"==typeof e.dst_noise_freq0&&(d=f.glsl_value(parseFloat(e.dst_noise_freq0)),a.set_batch_directive(k,"DST_NOISE_FREQ_0",d)),"number"==typeof e.dst_noise_freq1&&(d=f.glsl_value(parseFloat(e.dst_noise_freq1)),a.set_batch_directive(k,
"DST_NOISE_FREQ_1",d)),"number"==typeof e.dir_min_shore_fac&&(d=f.glsl_value(parseFloat(e.dir_min_shore_fac)),a.set_batch_directive(k,"DIR_MIN_SHR_FAC",d)),"number"==typeof e.dir_freq&&(d=f.glsl_value(parseFloat(e.dir_freq)),a.set_batch_directive(k,"DIR_FREQ",d)),"number"==typeof e.dir_noise_scale&&(d=f.glsl_value(parseFloat(e.dir_noise_scale)),a.set_batch_directive(k,"DIR_NOISE_SCALE",d)),"number"==typeof e.dir_noise_freq&&(d=f.glsl_value(parseFloat(e.dir_noise_freq)),a.set_batch_directive(k,"DIR_NOISE_FREQ",
d)),"number"==typeof e.dir_min_noise_fac&&(d=f.glsl_value(parseFloat(e.dir_min_noise_fac)),a.set_batch_directive(k,"DIR_MIN_NOISE_FAC",d)),"number"==typeof e.dst_min_fac&&(d=f.glsl_value(parseFloat(e.dst_min_fac)),a.set_batch_directive(k,"DST_MIN_FAC",d)),"number"==typeof e.waves_hor_fac&&(d=f.glsl_value(parseFloat(e.waves_hor_fac)),a.set_batch_directive(k,"WAVES_HOR_FAC",d))),a.update_shader(k),u.recalculate_draw_data(k)}else b.error('set_water_material_params(): Material "'+d+'" wasn\'t found on the object "'+
c.name+"\" or it's not a water material.")}else b.error('set_water_material_params(): Object "'+c.name+'" is not a dynamic MESH.')};t.set_line_params=function(c,d){if(m.is_line(c)){var e=a.get_first_batch(c);e?(A._17(d.color)&&e.diffuse_color.set(d.color),A._17(d.width)&&(e.line_width=d.width)):b.error("set_line_params(): Couldn't set line parameters!")}else b.error('set_line_params(): Object "'+c.name+'" is not a LINE object.')};t.get_line_params=function(c){if(!m.is_line(c))return b.error('get_line_params(): Object "'+
c.name+'" is not a LINE object.'),null;c=a.get_first_batch(c);return c?{color:new Float32Array(c.diffuse_color),width:c.line_width}:(b.error("get_line_params(): Couldn't get line parameters!"),null)};t.set_nodemat_value=function(d,e,f){var k=m.is_dynamic_mesh(d),l=m.is_world(d),n=l?c.get_world_name(d):d.name;if(k||l){if(k){var p=e[0],r=1,k=a.find_batch_material_any(d,p,"MAIN")||a.find_batch_material_any(d,p,"PARTICLES");if(!k){b.error('set_nodemat_value(): Material "'+p+'" wasn\'t found on the object "'+
n+'".');return}}else if(l&&(k=u.get_active(),p="",r=0,k=a.get_batch_by_type(d,"SKY",k),!k)){b.error("set_nodemat_value(): Sky node material wasn't found on the world object \""+n+'".');return}r=a.name_list_to_node_name(e,r);c.set_nodemat_value(d,p,r,f)||b.error('set_nodemat_value(): Value node "'+e[e.length-1]+'" was not found in the object "'+n+'".')}else b.error('set_nodemat_value(): Object "'+n+'" is not a dynamic MESH or WORLD.')};t.get_nodemat_value=function(d,e){var f=m.is_dynamic_mesh(d),k=
m.is_world(d),l=k?c.get_world_name(d):d.name;if(!f&&!k)return b.error('get_nodemat_value(): Object "'+l+'" is not a dynamic MESH or WORLD.'),0;if(f){var n=e[0],p=1,f=a.find_batch_material_any(d,n,"MAIN")||a.find_batch_material_any(d,n,"PARTICLES");if(!f)return b.error('get_nodemat_value(): Material "'+n+'" wasn\'t found on the object "'+l+'".'),0}else if(k&&(f=u.get_active(),n="",p=0,f=a.get_batch_by_type(d,"SKY",f),!f))return b.error("get_nodemat_value(): Sky node material wasn't found on the world object \""+
l+'".'),0;p=a.name_list_to_node_name(e,p);n=c.get_nodemat_value(d,n,p);null===n&&b.error('get_nodemat_value(): Value node "'+e[e.length-1]+'" was not found in the object "'+l+'".');return n};t.set_nodemat_rgb=function(d,e,f,k,l){var n=m.is_dynamic_mesh(d),p=m.is_world(d),r=p?c.get_world_name(d):d.name;if(n||p){if(n){var t=e[0],v=1,n=a.find_batch_material_any(d,t,"MAIN")||a.find_batch_material_any(d,t,"PARTICLES");if(!n){b.error('set_nodemat_rgb(): Material "'+t+'" wasn\'t found on the object "'+r+
'".');return}}else if(p&&(n=u.get_active(),t="",v=0,n=a.get_batch_by_type(d,"SKY",n),!n)){b.error("set_nodemat_rgb(): Sky node material wasn't found on the world object \""+r+'".');return}v=a.name_list_to_node_name(e,v);c.set_nodemat_rgb(d,t,v,f,k,l)||b.error('set_nodemat_rgb(): RGB node "'+e[e.length-1]+'" was not found in the object "'+r+'".')}else b.error('set_nodemat_rgb(): Object "'+r+'" is not a dynamic MESH or WORLD.')};t.get_nodemat_rgb=function(d,e,f){var k=m.is_dynamic_mesh(d),l=m.is_world(d),
n=l?c.get_world_name(d):d.name;if(!k&&!l)return b.error('get_nodemat_rgb(): Object "'+n+'" is not a dynamic MESH or WORLD.'),null;if(k){var p=e[0],r=1,k=a.find_batch_material_any(d,p,"MAIN")||a.find_batch_material_any(d,p,"PARTICLES");if(!k)return b.error('get_nodemat_rgb(): Material "'+p+'" wasn\'t found on the object "'+n+'".'),null}else if(l&&(k=u.get_active(),p="",r=0,k=a.get_batch_by_type(d,"SKY",k),!k))return b.error("get_nodemat_rgb(): Sky node material wasn't found on the world object \""+
n+'".'),null;f||(f=new Float32Array(3));r=a.name_list_to_node_name(e,r);(f=c.get_nodemat_rgb(d,p,r,f))||b.error('get_nodemat_rgb(): RGB node "'+e[e.length-1]+'" was not found in the object "'+n+'".');return f};t.is_node_material=function(c,d){if(!m.is_dynamic_mesh(c))return b.error('is_node_material(): Object "'+c.name+'" is not a dynamic MESH.'),!1;var e=a.find_batch_material(c,d,"MAIN");return e?e.has_nodes:(b.error('is_node_material(): Material "'+d+'" wasn\'t found on the object "'+c.name+'".'),
!1)};t.is_water_material=function(c,d){if(!m.is_dynamic_mesh(c))return b.error('is_water_material(): Object "'+c.name+'" is not a dynamic MESH.'),!1;var e=a.find_batch_material(c,d,"MAIN");return e?e.water&&!e.has_nodes:(b.error('is_water_material(): Material "'+d+'" wasn\'t found on the object "'+c.name+'".'),!1)}});t.a=e},function(C,t,e){C=e(0);var R=e(3),V=e(2),n=e(42);e=Object(C.a)("math",function(e,d){var k=new Float32Array(3);d.create_pline_from_points=function(d,e){var r=new Float32Array(6);
n.R(r,d);R.subtract(e,d,k);n.Q(r,k);return r};d.create_pline_from_point_vec=function(d,e){var k=new Float32Array(6);n.R(k,d);n.Q(k,e);return k};d.create_pline=function(){return new Float32Array(6)};d.get_pline_directional_vec=n.M;d.get_pline_initial_point=n.N;d.set_pline_initial_point=n.R;d.set_pline_directional_vec=n.Q;d.line_plane_intersect=V._22;d.calc_pline_point=n.f;d.point_plane_dist=n.P;d.linear_tween=n.O;d.ease_in_quad=n.x;d.ease_out_quad=n.H;d.ease_in_out_quad=n.t;d.ease_in_cubic=n.k;d.ease_out_cubic=
n.E;d.ease_in_out_cubic=n.q;d.ease_in_quart=n.y;d.ease_out_quart=n.I;d.ease_in_out_quart=n.u;d.ease_in_quint=n.z;d.ease_out_quint=n.J;d.ease_in_out_quint=n.v;d.ease_in_sine=n.A;d.ease_out_sine=n.K;d.ease_in_out_sine=n.w;d.ease_in_expo=n.m;d.ease_out_expo=n.G;d.ease_in_out_expo=n.s;d.ease_in_circ=n.j;d.ease_out_circ=n.D;d.ease_in_out_circ=n.p;d.ease_in_elastic=n.l;d.ease_out_elastic=n.F;d.ease_in_out_elastic=n.r;d.ease_in_back=n.h;d.ease_out_back=n.B;d.ease_in_out_back=n.n;d.ease_in_bounce=n.i;d.ease_out_bounce=
n.C;d.ease_in_out_bounce=n.o});t.a=e},function(C,t,e){C=e(0);var R=e(52),V=e(18),n=e(1),y=e(2);e=Object(C.a)("nla",function(d,e){var k=Object(R.a)(d),t=Object(V.a)(d),r=Object(n.a)(d);e.set_frame=function(d){d=y.M(d,k.get_frame_start(),k.get_frame_end());k.check_logic_nodes()?r.error("The active scene is using the Logic Editor."):k.set_frame(d,t.get_timeline())};e.get_frame=function(){return k.get_frame(t.get_timeline())};e.stop=function(){k.check_logic_nodes()&&r.warn("The active scene is using the Logic Editor. It may conflicts with your JS-code.");
k.stop_nla()};e.play=function(d){k.check_logic_nodes()&&r.warn("The active scene is using the Logic Editor. It may conflicts with your JS-code.");k.play_nla(d)};e.is_play=function(){return k.is_play()};e.get_frame_start=function(){return k.get_frame_start()};e.get_frame_end=function(){return k.get_frame_end()};e.check_nla=function(){return k.check_nla()};e.check_logic_nodes=function(){return k.check_logic_nodes()};e.set_range=function(d,e){k.check_logic_nodes()?r.error("The active scene is using the Logic Editor."):
(e=parseFloat(e)||k.get_frame_end(),d=parseFloat(d)||k.get_frame_end(),e=y.M(e,k.get_frame_start(),k.get_frame_end()),d=y.M(d,k.get_frame_start(),e),k.set_range(d,e))};e.reset_range=function(){k.check_logic_nodes()?r.error("The active scene is using the Logic Editor."):k.reset_range()};e.set_cyclic=function(d){k.check_logic_nodes()?r.error("The active scene is using the Logic Editor."):k.set_cyclic(d)};e.clear_callback=function(){k.check_logic_nodes()?r.error("The active scene is using the Logic Editor."):
k.clear_callback()}});t.a=e},function(C,t,e){C=e(0);var R=e(20),V=e(12),n=e(16),y=e(9),d=e(1),k=e(10),I=e(6),A=e(2);e=Object(C.a)("objects",function(e,p){var r=Object(R.a)(e),a=Object(V.a)(e),t=Object(n.a)(e),l=Object(y.a)(e),c=Object(d.a)(e),m=Object(k.a)(e);p.get_meta_tags=function(b){if(b)return a.get_meta_tags(b)};p.get_custom_prop=function(b){if(b)return a.get_custom_prop(b)};p.copy=function(b,d,e){if(!l.is_mesh(b)&&!l.is_empty(b))return c.error('object "'+b.name+'" is not of type "MESH".'),
!1;if(!l.is_dynamic(b))return c.error('object "'+b.name+'" is not dynamic.'),!1;if(!r.has_dyn_geom(b)&&!r.check_shape_keys(b)&&e)return c.error('object "'+b.name+'" has not dynamic geometry for deep copying.'),!1;var f=a.get_scene_objs(m.get_active(),"MESH",a.DATA_ID_ALL);return-1==f.indexOf(b)&&(f=a.get_scene_objs(m.get_active(),"EMPTY",a.DATA_ID_ALL),-1==f.indexOf(b))?(c.error('object "'+b.name+'" does not belong to the active scene.'),!1):a.copy(b,d||"",e)};p.update_boundings=function(b){l.is_mesh(b)?
r.has_dyn_geom(b)||r.check_shape_keys(b)?a.update_boundings(b):c.error('object "'+b.name+'" has not dynamic geometry.'):c.error('The type of the object "'+b.name+'" is not "MESH".')};p.get_parent=l.get_parent;p.get_dg_parent=l.get_dg_parent;p.is_mesh=l.is_mesh;p.is_armature=l.is_armature;p.is_speaker=l.is_speaker;p.is_camera=l.is_camera;p.is_lamp=l.is_lamp;p.is_empty=l.is_empty;p.is_line=l.is_line;p.is_world=l.is_world;p.get_selectable_objects=function(){return a.get_selectable_objects()};p.get_outlining_objects=
function(){return a.get_outlining_objects()};p.is_dynamic=l.is_dynamic;p.set_wind_bending_params=function(b,d){if(l.is_dynamic_mesh(b)){var e=b.render;if(e.wind_bending){if("number"==typeof d.angle){var f=t.wb_angle_to_amp(A.T(d.angle),e.bb_original,I.i(e.world_tsr));e.wind_bending_amp=f}"number"==typeof d.main_frequency&&(e.wind_bending_freq=d.main_frequency);"number"==typeof d.detail_frequency&&(e.detail_bending_freq=d.detail_frequency);"number"==typeof d.detail_amplitude&&(e.detail_bending_amp=
d.detail_amplitude);"number"==typeof d.branch_amplitude&&(e.branch_bending_amp=d.branch_amplitude);a.set_hair_particles_wind_bend_params(b)}else c.error('The "'+b.name+"\" object doesn't have wind bending parameters.")}else c.error('The type of the object "'+b.name+'" is not "MESH" or it is not dynamic.')};p.get_wind_bending_params=function(a){a=a.render;if(!a.wind_bending)return null;var b={},c=A._39(t.wb_amp_to_angle(a.wind_bending_amp,a.bb_original,I.i(a.world_tsr)));b.angle=c;b.main_frequency=
a.wind_bending_freq;b.detail_frequency=a.detail_bending_freq;b.detail_amplitude=a.detail_bending_amp;b.branch_amplitude=a.branch_bending_amp;return b};p.create_line=function(b){return a.create_line(b)};p.create_empty=function(b){return a.create_empty(b)};p.hide_all_by_data_id=function(b){b=a.get_all_objects("ALL",b);for(var c=0;c<b.length;c++)m.change_visibility(b[c],!0)};p.show_all_by_data_id=function(b){b=a.get_all_objects("ALL",b);for(var c=0;c<b.length;c++)m.change_visibility(b[c],!1)}});t.a=
e},function(C,t,e){C=e(0);var R=e(47),V=e(1);e=Object(C.a)("particles",function(e,t){var d=Object(R.a)(e),k=Object(V.a)(e);t.set_size=function(e,n,r){d.obj_has_psys(e,n)?d.set_size(e,n,r):k.error('set_size(): Object "'+e.name+'" has not a particle system named "'+n+'"')};t.set_normal_factor=function(e,n,r){d.obj_has_psys(e,n)?d.set_normal_factor(e,n,r):k.error('set_normal_factor(): Object "'+e.name+'" has not a particle system named "'+n+'"')};t.set_factor=function(e,n,r){d.obj_has_psys(e,n)?(r=Math.min(r,
1),r=Math.max(r,0),d.set_factor(e,n,r)):k.error('set_factor(): Object "'+e.name+'" has not a particle system named "'+n+'"')}});t.a=e},function(C,t,e){C=e(0);var R=e(2);e=Object(C.a)("rgb",function(e,n){var t=new Float32Array(3);n.create=function(){return new Float32Array(3)};n.from_values=function(d,e,n){var k=new Float32Array(3);k[0]=d;k[1]=e;k[2]=n;return k};n.set=function(d,e,n,t){t[0]=d;t[1]=e;t[2]=n;return t};n.css_to_rgb=function(d,e,n,t){t=t||new Float32Array(3);t[0]=d/255;t[1]=e/255;t[2]=
n/255;R._57(t,t);return t};n.rgb_to_css=function(d){d=R._21(d,t);return[Math.round(255*d[0]),Math.round(255*d[1]),Math.round(255*d[2])]};n.rgb_to_css_hex=function(d){var e=function(d){d=Math.round(255*d).toString(16);return 1==d.length?"0"+d:d};d=R._21(d,t);return"#"+e(d[0])+e(d[1])+e(d[2])}});t.a=e},function(C,t,e){C=e(0);var R=e(1),V=e(10),n=e(17),y=e(9),d=e(44),k=e(48);e=Object(C.a)("textures",function(e,t){var r=Object(R.a)(e),p=Object(V.a)(e),u=Object(n.a)(e),a=Object(y.a)(e),A=Object(d.a)(e);
t.play_video=function(a,c){c||(c=0);var d=u.get_video_texture(a,c);d?p.get_active().b4w_use_nla&&u.video_allow_nla(d)?r.error("NLA texture can't be controlled directly through API."):u.play_video(d):r.error('Texture with name "'+a+'" not found!')};t.pause_video=function(a,c){c||(c=0);var d=u.get_video_texture(a,c);d?p.get_active().b4w_use_nla&&u.video_allow_nla(d)?r.error("NLA texture can't be controlled directly through API."):u.pause_video(d):r.error('Texture with name "'+a+'" not found!')};t.reset_video=
function(a,c){c||(c=0);var d=u.get_video_texture(a,c);d?p.get_active().b4w_use_nla&&u.video_allow_nla(d)?r.error("NLA texture can't be controlled directly through API."):u.reset_video(d):r.error('Texture with name "'+a+'" not found!')};t.get_canvas_ctx=function(d,c){if(a.is_mesh(d)){var e=u.get_canvas_context_by_object(d,c);if(e)return e;r.error("Couldn't find canvas texture with this name: "+c)}else r.error("Object must be type of mesh.");return null};t.update_canvas_ctx=function(d,c){if(!a.is_mesh(d))return r.error("Object must be type of mesh."),
!1;var e=u.get_texture_by_name(d,c);if(!e||"CANVAS"!=e.source)return r.error("Couldn't find canvas texture \""+c+'" in object "'+d.name+'".'),!1;u.update_texture_canvas(e);return!0};t.change_image=function(a,c,d,b){r.error_deprecated("change_image","replace_image");b=b||function(){};var e=u.get_texture_by_name(a,c);if(e)if(e.is_movie)r.error("Changing video textures is forbidden."),b(!1);else{var l=Object(k.b)(d);e.img_full_filepath==l?b(!0):A.enqueue([{id:d,type:A.AT_IMAGE_ELEMENT,url:d,request_method:"GET"}],
function(f,k,l,m){f?(u.change_image(a,e,c,f,d),b(!0)):b(!1)},null,null)}else r.error("Couldn't find texture \""+c+'" in object "'+a.name+'".'),b(!1)};t.replace_image=function(a,c,d,b){b=b||function(){};var e=u.get_texture_by_name(a,c);if(e)if(e.is_movie)r.error("Changing video textures is forbidden."),b(!1);else if("src"in d){var k=d.src;if(d.complete)u.change_image(a,e,c,d,k),b(!0);else{var l=d.onload,m=d.onerror;d.onload=function(){l&&l.call(d);u.change_image(a,e,c,d,k);b(!0)};d.onerror=function(){m&&
m.call(d);b(!1)}}}else r.error("Incorrect image."),b(!1);else r.error("Couldn't find texture \""+c+'" in object "'+a.name+'".'),b(!1)};t.get_texture_names=function(d){if(a.is_mesh(d))return u.get_texture_names(d);r.error("Object must be type of mesh.");return[]}});t.a=e},function(C,t,e){C=e(0);var R=e(37);e=Object(C.a)("version",function(e,n){n.version=R.e;n.version_str=R.f;n.type=R.d;n.date=R.a;n.date_str=R.b;n.get_build_version=R.c});t.a=e}]);
